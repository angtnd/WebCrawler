// Generated by CoffeeScript 1.7.1
define(['jquery', 'modules/core/uri', 'modules/clean/ajax', 'modules/clean/gandalf_util', 'modules/clean/unity/versions'], function($j, URI, ajax, GandalfUtil, UnityVersions) {
  var UnityConnectionLogger;
  UnityConnectionLogger = (function() {
    function UnityConnectionLogger() {
      this._data = {
        logging_source: 'web',
        web_unity_version: UnityVersions.LATEST
      };
    }

    UnityConnectionLogger.prototype.update = function(client_data) {
      return $j.extend(this._data, client_data);
    };

    UnityConnectionLogger.prototype.report_event = function(event_name, extra) {
      if (extra == null) {
        extra = null;
      }
      this._data.event_name = event_name;
      this._data.local_ts = (new Date().getTime()) / 1000;
      this._data.extra = JSON.stringify(extra || {});
      ajax.WebRequest({
        url: URI({
          path: '/unity_connection_log'
        }),
        data: this._data
      });
      if (GandalfUtil.getGandalfRule("unity-web-debug")) {
        return console.log(this._data);
      }
    };

    UnityConnectionLogger.prototype.get_log_data_for_client = function() {
      return {
        web_unity_version: this._data.web_unity_version,
        user_agent: window.navigator.userAgent
      };
    };

    UnityConnectionLogger.prototype.unity_session_id = function() {
      return this._data.unity_session_id;
    };

    return UnityConnectionLogger;

  })();
  return UnityConnectionLogger;
});

//# sourceMappingURL=logger.map
