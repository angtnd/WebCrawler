function loginAjaxModal(){$j.ajax({type:"POST",url:"/front/login_json",cache:false,dataType:"json",data:$j(".js-loginFormModal").serialize(),success:function(a){if(a.premium_redirect_cookie=="0"){if(a.redirect){$j("#signinLoggingin").show();$j(".signinError").hide();document.location.assign(a.redirect)}else{$j(".signinError").show().text(a.message)}}else{$j.ajax({url:premiumRedirectCookieURL,cache:false,crossDomain:true,xhrFields:{withCredentials:true},success:function(){if(a.redirect){$j("#signinLoggingin").show();$j(".signinError").hide();document.location.assign(a.redirect)}else{$j(".signinError").show().text(a.message)}}})}},error:function(){location.reload()}});return false}var signinbox={logCount:0,doingLogin:false,inputFocused:false,containerWidth:889,show:function(a){if(navigator.userAgent){if(navigator.userAgent.match(/PLAYSTATION/)){document.location.assign("http://"+location.hostname+"/login");return false}}if(!$j("#signinModal").is(":visible")&&$j("a#headerLoginLink")[0]){openModal(a)}},hide:function(){$j(".signinError").hide();$j("input.js-signinUsernameModal").val("");$j("input#.js-signinPasswordModal").val("");$j("input#js-redirect").val("")}};function openModal(b){var a=document.getElementById("signinModal");if(a){var d=b;var c=new MG_Modal({content:a});if(typeof c!=="undefined"){c.openModal(function(f,e){$j(e).find(".txtname").text(d);$j(e).find(".js-signinUsernameModal").focus()})}$j("body").on("click",".js_closeModal",function(){if(typeof c!=="undefined"){c.closeModal()}})}}head.ready(document,function(){if($j("#signinModal")[0]){var a=false;$j(document).on("focus","#signinModal input",function(){signinbox.inputFocused=true});$j("#signinRemember").on("click",function(){$j('input[name="remember_me"]').val($j(this).prop("checked")?1:0)});$j(document).on("blur","#signinModal input",function(){signinbox.inputFocused=false});$j(document).on("click",".js-loginSubmitModal",function(b){b.preventDefault();loginAjaxModal()});$j(document).on("keydown","input.js-signinUsernameModal, input.js-signinPasswordModal",function(b){if(!a){if(b.which==13){loginAjaxModal()}a=true}});$j(document).on("keyup","input.js-signinUsernameModal, input.js-signinPasswordModal",function(b){if(a){a=false}});if(document.location.search.match(/showSigninBox=true/i)&&$j("a#headerLoginLink")[0]){signinbox.show()}}});