window.pp.allAds=[],window.pp.Ad=function(a){this.options=a,this.FrameStatus={JS:0,IFRAME:1,IFRAME_BREAKOUT:2,DOUBLE_IFRAME:3},this.errorStep="",this.adRect=this.parseAdSize(),this.maEnabled=null!=this.adRect&&this.options.hasOwnProperty("maOpts")&&this.options.maOpts.enabled,this.maSeqNum=0,this.adNum=window.pp.allAds.length,window.pp.allAds.push(this)},window.pp.Ad.prototype={loopingPrefix:"cwl_",kvPrefix:"cwkv_",display:function(){try{this.setState(),this.getAd()}catch(a){-1==this.getAdUrl.indexOf("?")&&this.buildGetAdUrlFromOptions(this.options),document.write("<script language='javascript' src='"+this.getAdUrl+(this.getAdUrl.indexOf("?")>-1?"&":"?")+"jserr="+this.exMsg(a)+"&errSt="+this.errorStep+"'></script>")}},setState:function(){try{this.evalQueryString(),this.storage=navigator,this.getAdUrl=this.options.cu,this.isDefined(this.options.cwif)||(this.options.cwif=!1),this.smartFileLocation=this.getSmartFileLocation(),this.frameStatus=this.getDisplayType(),this.tile=this.getTile(this.frameStatus,this.storage,this.kvPrefix),this.isOpera=this.isOpera(),this.isInternetExplorer9orLess=this.isInternetExplorer9orLess(),this.position=this.getPosition()}catch(a){throw this.setErrorStep("setSt"),a}},isDefined:function(a){return"undefined"!=typeof a},getAd:function(){try{var a=this;this.isInIFrame()||(this.isDefined(this.getAdUrl)?(this.attachUnloadHandler(function(){a.onUnload(a.loopingPrefix,a.kvPrefix,a.storage)}),this.buildGetAdUrl(),this.writeAd()):document.write("Thank you, your file's location is:  "+window.location))}catch(b){throw this.setErrorStep("getAd"),b}},getDisplayType:function(){try{return window==top?this.FrameStatus.JS:document.location.host==top.document.location.host?this.FrameStatus.IFRAME_BREAKOUT:this.FrameStatus.IFRAME}catch(a){try{if(top&&parent==top)return this.FrameStatus.IFRAME;if(parent.document.referrer)return this.FrameStatus.IFRAME}catch(a){}return this.FrameStatus.DOUBLE_IFRAME}},getTile:function(a,b,c){try{if(!this.isJSOrIFrameBreakout())return-1;var d=c+"tile";return null==b[d]&&(b[d]=0),++b[d]}catch(e){return-1}},isInIFrame:function(){return this.options.cwif||this.isJSOrIFrameBreakout()||!this.smartFileLocation?!1:this.breakOutFromFrames()},evalQueryString:function(){var query=location.search.slice(1);!this.isEmpty(query)&&this.strContains(query,"this.options.cwif")&&eval(unescape(query))},isEmpty:function(a){return!a||null==a||"string"==typeof a&&("null"==a||!this.isDefined(a)||""==a.replace(/\s*/,""))},breakOutFromFrames:function(){var a=this.smartFileLocation+"?this.options.cwif=true;";for(var b in this.options)a+=this.getKeyValueString("this.options."+b,this.options[b]);var c=this.getBreakOutFrame(this.smartFileLocation);return c?(c.location.replace(a),!0):!1},getKeyValueString:function(a,b){return this.isEmpty(b)?"":a+"='"+b+"';"},getBreakOutFrame:function(a){var b=window;try{var c=a.split("//")[1].split("/")[0],d=b.location.host;if(d==c)return null;for(;b.parent.window!=b.top&&(d=b.parent.location.host,!this.strContains(d,c));)b=b.parent.window}catch(e){}return b},attachUnloadHandler:function(a){try{var b=window;if(this.isDefined(b.addEventListener)&&!this.isOpera)b.addEventListener("beforeunload",a,!1);else if(this.isDefined(b.attachEvent)&&!this.isOpera)b.attachEvent("onbeforeunload",a);else{var c=b.onload;"function"!=typeof c?b.onload=a:b.onload=function(){c(),a()}}}catch(d){throw this.setErrorStep("unload"),d}},onUnload:function(a,b,c){try{var d;for(d in c)0==d.indexOf(a)&&(c[d]=0),0==d.indexOf(b)&&(c[d]=0)}catch(e){}},buildGetAdUrl:function(){this.buildGetAdUrlFromOptions(this.options),this.getAdUrl+="&rq="+this.getLoopingCount(),this.getAdUrl+="&dw="+this.getWidth(),this.getAdUrl+="&cwu="+this.processUrlForQSValue(this.getUrl()),this.getAdUrl+="&cwr="+this.processUrlForQSValue(this.getReferrer()),this.getAdUrl+="&mrnd="+this.getRandomNumber(),this.getAdUrl+="&if="+this.frameStatus,this.getAdUrl+="&tl="+this.tile,this.getAdUrl+="&pxy="+this.position,this.getAdUrl+="&cxy="+this.getClientDimensions(),this.getAdUrl+="&dxy="+this.getDocumentDimensions(),this.getAdUrl+="&tz="+(new Date).getTimezoneOffset(),this.getAdUrl+="&ln="+this.getLanguage()},buildGetAdUrlFromOptions:function(a){this.getAdUrl+="?tagver=1",this.getAdUrl+=this.safeQs("ca",a.ca),this.getAdUrl+=this.safeQs("cp",a.cp),this.getAdUrl+=this.safeQs("ct",a.ct),this.getAdUrl+=this.safeQs("cwod",a.cwod),this.getAdUrl+=this.safeQs("epid",a.epid),this.getAdUrl+=this.safeQs("esid",a.esid),this.getAdUrl+=this.safeQs("ifurl",a.ifurl),this.getAdUrl+=this.safeQs("tppg",this.processUrlForQSValue(a.tppg)),this.getAdUrl+=this.safeQs("brk",a.brk),this.getAdUrl+=this.safeQs("ccid",a.ccid),this.getAdUrl+=this.safeQs("wp",a.wp),this.getAdUrl+=this.safeQs("cf",this.processUrlForQSValue(a.cf)),this.getAdUrl+=this.safeQs("asv",a.asv),this.getAdUrl+=this.addPubTokens(a.PPTOKEN)},addPubTokens:function(a){var b="";if(this.isDefined(a)&&null!=a)for(attr in a)b+=this.safeQs("PPTOKEN_"+attr,a[attr]);return b},safeQs:function(a,b){return this.isDefined(b)?"&"+a+"="+b:""},processUrlForQSValue:function(a){var b=escape(a);return b=b.replace(/\+/g,"%2B"),b=b.replace(/\//g,"%2F")},getLoopingCount:function(){try{var a=this.loopingPrefix+this.options.ct+"_"+this.options.cf+"_"+this.options.esid+"_"+this.position;return this.storage[a]?this.storage[a]++:this.storage[a]=1,this.storage[a]}catch(b){return this.setErrorStep("loop"),1}},getWidth:function(){var a=0;try{document.body||document.write('<div id="cwViz1" style="width:0px; height:0px; display:none; visibility:hidden;">o</div>'),self.innerWidth?a=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?a=document.documentElement.clientWidth:document.body&&(a=document.body.clientWidth)}catch(b){a=-1}return a},getUrl:function(){var a="",b="",c="",d=window;try{if(this.isJSOrIFrameBreakout())return top.location}catch(e){}try{if(b=document.location,b==top.location)a=b;else for(;;){if(a=d.document.location,d.document.referrer&&(c=d.document.referrer),d==d.parent)break;d.document.referrer&&(a=c),d=d.parent}(""==a||null==a)&&(a=c?c:b)}catch(e){c&&""!=c?a=c:""==a&&(a=b)}return a},getReferrer:function(){try{if(this.isJSOrIFrameBreakout())return top.document.referrer}catch(a){}return""},getPosition:function(){var a=[0,0];try{var b="cw_td_"+this.getRandomNumber();document.write('<div id="'+b+'" style="height:0;width:0;"></div>');var c=document.getElementById(b),a=this.getOffsetPosition(c);if(c.style.display="none",window!=top){var d=this.getIFramePosition();a[0]+=d[0],a[1]+=d[1]}}catch(c){}return a},getRandomNumber:function(){return Math.floor(1e8*Math.random())},getOffsetPosition:function(a){var b=[0,0];if(null!=a){var c=a.getBoundingClientRect();b=[Math.round(c.left),Math.round(c.top)]}return b},getIFramePosition:function(){var a=this.getTopFrame();if(null==a)throw-15;try{return this.getOffsetPosition(a.frameElement)}catch(b){}for(var c=top.document.getElementsByTagName("IFRAME"),d=0;d<c.length;d++){var e=c[d].contentWindow.location;if(e==a.location)return this.getOffsetPosition(c[d])}},getTopFrame:function(){try{for(var a=[],b=window,c=20;--c>0;){if(a.push(b),b==top||null==b.parent)return a[a.length-2];b=b.parent}return null}catch(d){return null}},getClientDimensions:function(){try{var a=window.innerWidth||top.document.documentElement.clientWidth||top.document.body.clientWidth,b=window.innerHeight||top.document.documentElement.clientHeight||top.document.body.clientHeight;return[a,b]}catch(c){return""}},getDocumentDimensions:function(){try{return[top.window.document.body.offsetWidth,top.window.document.body.offsetHeight]}catch(a){return""}},getLanguage:function(){try{if(navigator){var a=[];return navigator.language&&a.push(navigator.language),navigator.userLanguage&&a.push(navigator.userLanguage),navigator.browserLanguage&&a.push(navigator.browserLanguage),navigator.systemLanguage&&a.push(navigator.systemLanguage),a.join(",")}}catch(b){}return""},writeAd:function(){this.maEnabled?(document.writeln(this.wrapWith("","div","id='"+this.getAdWrapId()+"'")),this.writeMA()):document.writeln(this.getAdScriptTag())},parseAdSize:function(){try{var a=this.options.cf.split(/x/i);return{width:a[0],height:a[1]}}catch(b){}return null},wrapWith:function(a,b,c){return"<"+b+("undefined"==typeof c?">":" "+c+">")+a+"</"+b+">"},getAdScriptTag:function(){var a=this.getAdUrl;return this.maSeqNum>0&&(a+="&ma="+this.maSeqNum),this.wrapWith("","script","type='text/javascript' src=\""+a+'"')},getAdWrapId:function(){return"pp_getad_"+this.adNum},scheduleIsAllowed:function(){return this.options.maOpts.periodMax>0&&this.options.maOpts.periodMin>0&&this.options.maOpts.periodMax>=this.options.maOpts.periodMin&&this.maSeqNum<this.options.maOpts.maxSeqNum},scheduleMA:function(){if(this.scheduleIsAllowed()){var a=this;setTimeout(function(){a.maSeqNum++,a.writeMA()},Math.round(1e3*(a.options.maOpts.periodMin+Math.random()*(a.options.maOpts.periodMax-a.options.maOpts.periodMin))))}},writeMA:function(){var a=document.getElementById(this.getAdWrapId()),b=document.createElement("iframe");b.setAttribute("marginwidth",0),b.setAttribute("marginheight",0),b.setAttribute("allowtransparency",!0),b.setAttribute("frameborder",0),b.setAttribute("frameBorder",0),b.setAttribute("scrolling","no"),b.setAttribute("height",this.adRect.height),b.setAttribute("width",this.adRect.width),a.firstChild&&a.removeChild(a.firstChild),a.appendChild(b);var c=b.contentWindow||b.contentDocument;c.document&&(c=c.document),this.isInternetExplorer9orLess||c.open(),c.write(this.wrapWith(this.wrapWith(this.wrapWith("window.pp = parent.pp;","script","type='text/javascript'")+this.getAdScriptTag(),"body","style='margin:0;padding:0;overflow:hidden;background-color:transparent;'"),"html")),this.isInternetExplorer9orLess||c.close(),this.scheduleMA()},isJSOrIFrameBreakout:function(){return this.frameStatus==this.FrameStatus.JS||this.frameStatus==this.FrameStatus.IFRAME_BREAKOUT},exMsg:function(a){try{if("object"==typeof a)return this.isDefined(JSON)&&this.isDefined(JSON.stringify)?escape(JSON.stringify(a)):escape(a.toString())}catch(b){}return escape(a)},strContains:function(a,b){return a&&b&&-1!=a.toLowerCase().indexOf(b.toLowerCase())},getSmartFileLocation:function(){try{if(this.isDefined(this.options.cwfl)&&this.options.cwfl.length>0)return this.options.cwfl;if(this.isDefined(window.cwfl))return window.cwfl}catch(a){this.setErrorStep("smartFile")}return!1},isOpera:function(){try{return this.strContains(navigator.userAgent,"opera")}catch(a){return this.setErrorStep("opera"),!1}},isInternetExplorer9orLess:function(){try{return this.strContains(navigator.userAgent,"msie")}catch(a){return this.setErrorStep("msie"),!1}},setErrorStep:function(a){this.errorStep+="|"+a}},"undefined"!=typeof pp_display_ad&&"undefined"!=typeof pp_options&&new pp.Ad(pp_options).display();