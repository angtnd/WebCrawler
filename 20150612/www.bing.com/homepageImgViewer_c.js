var ImgViewer=function(){function dr(){var n=_ge("hp_cellCenter");return n&&n.className.indexOf("hp_hd")!=-1&&typeof g_img!==u&&hp_defined(g_img.hdurl)&&g_img.url==g_img.hdurl?!0:!1}function fr(n,t,i){var r=sj_gx(),u=hp_pushparams(["format=js","idx="+n,"n="+t,"nc="+sb_gt(),"pid=hp"]),f;_w.g_vidOn&&u.push("video=1"),f="/HPImageArchive.aspx?"+u.join("&"),r.open("GET",f,!0),sj_be(r,"readystatechange",function(){r.readyState==4&&r.status==200&&(a=nu(r.responseText),ct=Math.min(ei,n+(a&&a.images&&a.images.length)||0),i(!!a))}),r.send(null)}function nu(n){if(typeof n!="string"||!n)return null;if(_w.JSON&&_w.JSON.parse)try{return _w.JSON.parse(n)}catch(t){}try{return new Function("return "+n)()}catch(t){return null}}function tu(){for(var n=0,t=a.images.length;n<t;n++)gt(n,n)}function gt(n,i){var e;if(t[n]=a.images[i]||null,er){var r=Math.max(screen.height,screen.width),u=Math.min(screen.height,screen.width),f="//"+window.location.host+"/iod/";t[n].url=f+r+"/"+u+"/"+t[n].fullstartdate,t[n].portraiturl=f+u+"/"+r+"/"+t[n].fullstartdate}else kr&&(e="_1920x1080.jpg",t[n].url=t[n].urlbase+e)}function rr(i){var r=n+1;st[r]||r>=ei?lt():t[r]?nr(r):fr(r,1,function(n){n?(gt(r,0),nr(r)):lt(),typeof i=="function"&&i(n)})}function ou(){var n=g_prefetch;n&&(n.Im&&su(n.Im),n.Vid&&br(n.Vid))}function su(n){var t=new Image;t.onload=function(){var t=sj_cook.get("_SS","bIm");t=t&&t.length>=3?t.substring(t.length-3)+n.hash:n.hash,sj_cook.set("_SS","bIm",t,0,"/")},t.src=n[et]}function br(n){var t=sj_ce("video","prefVid"),i,u,r;try{t.setAttribute("preload","auto")}catch(f){}for(t.width=956,t.height=512,i=0,u=n.length;i<u;i++)r=sj_ce("source"),r.src=n[i][2],r.type=n[i][1],t.appendChild(r);t.style.display="none",sj_b.appendChild(t),sj_be(t,"canplaythrough",function(){var n=_ge("prefVid");n&&sj_b.removeChild(n)})}function nr(n){if(!st[n]){lt();var i=t[n],r=new Image;r.onload=function(){sj_evt.fire("onHPIVImg"+n,n),st[n]=1},r.src=i.pano?i.pano.image:_w.g_vidOn&&i.vid?i.vid.image:i[et]}}function eu(){var i=_ge("audioElm"),n,t;i&&i.pause(),n=_ge("audioCont"),n&&(n.style.display=v),t=_ge("hp_audio_info"),t&&(t.style.display=v)}function bt(t){n==0||k||(n--,ki(),yi(1,n)),typeof t!==u&&t&&sj_pd(t)}function wt(t){if(n<ct-1&&!k&&!oi){var i=n+1;oi=1,st[i]||hu(),sj_evt.bind("onHPIVImg"+i,uu,1),yi(-1,i)}typeof t!==u&&t&&sj_pd(t)}function uu(t){t[1]==n+1&&(n++,oi=0,ki())}function lt(){var i=t[n],f=i[di]=="1"?ut:rt,o,h,c;i.vid&&(o=i.vid.dark,_ge("sh_pl").parentNode.className=o?"sh_pll":"sh_pld",_ge("sh_ps").parentNode.className=o?"sh_psl":"sh_psd",f=o?ut:rt),h=f+"dis",w.className=f,c=w.href===it?ui:ii,w.style.cursor=c,r.firstChild.className=n===ct-1?h:f,e.firstChild.className=n==0?h:f,r.title=y.previous,e.title=y.next,sj_evt.fire("updateHpImg",i),s&&typeof hpWall!==u&&(i.wp&&!i.vid?(hpWall.enabled=!0,hpWall.hash=i.hsh,s.firstChild.className=f,s.title=y.walls,s.style.cursor=ii):(hpWall.hash="",hpWall.enabled=!1,hpWall.tB(0),s.firstChild.className=h,s.title=y.walle,s.style.cursor=ui))}function hu(){r.title=y.loading}function ki(){var n,t,r;if(k=1,ni&&clearTimeout(ni),rr(),p&&p.disable(),n=_ge("vid"),_w.g_vidOn&&(VM.InFoc=0,n&&n.style.opacity!="0"&&(n.onended=null,VM.hideControls())),_ge("sh_iga")&&eu(),i&&i.style.opacity!="0"){_ge("panoControls").style.visibility=ft,f.style.backgroundImage="url()",t=_ge("sh_pps"),r=_ge("sh_ppl"),t&&r&&(t.style.display=v,t.tabIndex="-1",r.style.display=v,r.tabIndex="-1"),ht.down(function(){f.removeChild(i),ht=i=null,bi()});return}vt.down(bi)}function bi(){var s;f.style.display=v;var i=t[n],r=_ge("vid"),e=_ge("sc_mktb"),o=t[n].fullstartdate,h=o.substr(0,8)+"_"+o.substr(8,4),u;if(r&&_w.g_vidOn&&VM&&(r.pause&&!r.paused&&r.pause(),r.style.display="none",sj_so(r,0),VM.Loaded=!1,_w.g_vid=null,i.vid)){if(pt(i.vid.caption,i.copyrightlink),u="url('"+i.vid.image+"')",f.style.backgroundImage=u,f.style.display=ur,i.vid.loop){r.onended=VM.play;try{r.setAttribute("loop","true")}catch(c){}}else{r.onended=VM.end;try{r.removeAttribute("loop")}catch(c){}}_w.g_vid=i.vid.sources,VM.InFoc=1,VM.sa_vid_ld(gr),vt.up(pi)}i.pano&&kt(i.pano,!1),i.vid||(pt(i.copyright,i.copyrightlink),u=i[et],i.pano&&(u=i.pano.image),u="url('"+u+"')",f.style.backgroundImage=u,f.style.filter=sb_i8l?"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i[et]+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity=0);":"",f.style.display=ur,vt.up(pi)),sj_evt.fire("onHPImgViewerNavigation",h),e&&(s=_ge("hp_husb"),e.style.display=!!s||i.vid||i.pano?"none":"block")}function pt(n,t){var i=typeof t==u||t==""||t==it,r=_ge("musCard");r?w.href=it:(w.title=n,w.href=i?it:t,w.style.cursor=i?ui:ii)}function gr(){var n=_ge("vid");n&&VM&&VM.InFoc&&(VM._autoPlay===!1?VM.pause():VM.play(),VM.Loaded=!0,n.style.display="block",sj_so(n,100))}function pi(){var e,s,l,r,a,h,v,w,i,o,f,c;if(k=0,e=t[n],_w.g_hot&&(!e.pano||e.pano.hs===!0)){for(s=e.hs,i=0,c=s.length;i<c;i++){if(i>=s.length){typeof g_triggerElems!==u&&(g_triggerElems[i].isHotSpotDisabled=!0);continue}else typeof g_triggerElems!==u&&(g_triggerElems[i].isHotSpotDisabled=!1);l=i+1,r=s[i],a=_ge("sc_hst"+l),a.style.left=r.locx+"%",a.style.top=r.locy+"%",h=_ge("sc_hs"+l),h.href=r.link,h.firstChild.innerHTML=r.desc,h.firstChild.nextSibling.innerHTML=r.query}p&&p.intro(1)}var b=_ge("hp_pgNav"),d=b?2:0,y=_ge("hp_pgbar");if(y)for(v=y.getElementsByTagName("h3"),w=e.msg,i=0,c=v.length;i<c;i++){if(o=w[i],!o)break;if(f=v[i+d],!f)break;f.parentNode.id!==vr&&(f.innerHTML=o.title,f.nextSibling.innerHTML=o.text,f.nextSibling.href=o.link)}}function yi(n){if(typeof hpl!==u){if(hpl&&(b=hpl),b&&b.ssd){var i=b.ssd,r=new Date(parseInt(i.substr(0,4),10),i.substr(4,2)-1,parseInt(i.substr(6,2),10)+n);b.ssd=r.getFullYear().toString()+vi(r.getMonth()+1)+vi(r.getDate())+"_"+i.substr(9,4)}b&&(hpl=b)}}function vi(n){return(n<10?"0":"")+n}function wr(n){var t,u,r;if(pt(n.cap,n.caplink),n.spots)for(t=0,u=n.spots.length;t<u;t++)r=n.spots[t],Pano.CreateHotspot(r[0],r[1],r[2]);k=1,i.style.opacity=0,f.style.opacity=1,i.style.visibility=l,ht.up(function(){var t,i,r,u,f,e;_ge("panoControls").style.visibility=l,t="hpVideoPause",sj_evt.bind(fi,function(){Pano.StopAnimation()}),i=!0,n.an===!0&&(r=sj_cook&&sj_cook.get("SRCHHPGUSR","HAP"),r&&r!="0"&&(i=!1),_w.g_hpLocal&&(u=localStorage.getItemE(t),u!=null&&u===1&&(i=!1)),i?ni=sb_st(function(){Pano.IdleAnimate()},500):Pano.StopAnimation()),f=_ge("panoPause"),e=_ge("panoPlay"),f&&e&&(sj_be(f,c,function(){_w.g_hpLocal&&localStorage.setItemE(t,1,1440),Pano.StopAnimation()}),sj_be(e,c,function(){_w.g_hpLocal&&localStorage.removeItem(t),Pano.IdleAnimate(!0)})),k=0})}function o(n){return sj_ce(iu,n)}function yr(){var l,r,h,s,e,nt,n,k;if(_ge("panoDiv")||(i=o("panoDiv"),f.appendChild(i),ht=_anim.fadeE(i,hi)),l=_ge("hp_ctrls"),l&&!_ge("panoControls")){var w=o("panoLeft"),p=o("panoRight"),y=o("panoUp"),v=o("panoDown"),a=o("panoZoomIn"),b=o("panoZoomOut"),u=o("panoPosition");u.appendChild(y),u.appendChild(w),u.appendChild(p),u.appendChild(v),r=o("panoControlSet"),r.appendChild(b),r.appendChild(u),r.appendChild(a),h=o("panoControls"),h.appendChild(r),s=[w,p,y,v,a,b];function t(n,t){Pano.SetCameraFidelity(!1),ri=!1,d(n,t)}function d(n,t){ri==!1?(Pano.MovePano(n,t),sb_st(sj_wf(d,n,t),25)):Pano.SetCameraFidelity(!0)}function g(n){ri=!0;var t=sj_et(n);i&&t.id!="sh_ppl"&&t.id!="sh_pps"&&Pano.StopAnimation()}for(e=0,nt=s.length;e<nt;e++)sj_be(s[e],wi,g);sj_be(_d,wi,g),sj_be(a,c,sj_wf(t,"z",1)),sj_be(b,c,sj_wf(t,"z",-1)),sj_be(_w,ru,function(){i&&Pano.StopAnimation()}),n=.05,k=_G&&_G.RTL===!0,sj_be(w,c,sj_wf(t,"x",k?-n:n)),sj_be(p,c,sj_wf(t,"x",k?n:-n)),sj_be(y,c,sj_wf(t,"y",n)),sj_be(v,c,sj_wf(t,"y",-n)),sj_be(_w,"blur",function(){i&&Pano.StopAnimation()}),l.appendChild(h)}}function kt(n,t){function r(){yr(),n.hs===!1&&p&&p.disable();var t=_w.location.search.indexOf("debug=1")!=-1,r="?h="+_w.location.host,u=sb_gt();Pano.InitializePano(n.url,i,function(){wr(n),_w.hp_llog&&hp_llog("Pano",sb_gt()-u)},t,n.pos,n.maxfov,r),sj_evt.fire("onPanoComplete")}_H.startTm&&t&&_w.hp_llog&&hp_llog("PanoStart",sb_gt()-_H.startTm),typeof Pano===u?(sj_evt.bind("onPanoLoad",function(){r()}),sj_jb("HomepagePano_c"),sj_be(_w,"resize",function(){i&&typeof Pano!==u&&typeof Pano.SetViewportSize===ar&&Pano.SetViewportSize(i.offsetWidth,i.offsetHeight)})):r()}function dt(){sj_evt&&sj_evt.fire(fi)}function lr(){var n=sj_cook&&sj_cook.get("_UR","D"),t=sj_cook&&sj_cook.get("_UR","DHP");return n&&n!="0"&&n!="1"||t&&t!="0"?!0:!1}function cr(){var t="isHomepage",i="http://"+_d.domain+"/",r=i.replace(/www\./i,""),n=sr();return n?ai(n,t,i)||ai(n,t,r):0}function ai(n,t,i){try{return n[t](i)}catch(r){return 0}}function sr(){var n=_ge("dhp_detect");return n||(n=sj_ce("span","dhp_detect"),n.style.behavior="url(#default#homepage)",sj_b.appendChild(n)),n}function li(){if(lr()||cr())h&&(h.style.display=v),yt&&(yt.style.display=v);else if(at&&h&&h.style.display!=v){var n=h.offsetLeft;(!tt||tt&&tt.clientWidth<ir)&&(n-=ir),h.style.visibility=n<at.offsetLeft+at.clientWidth?ft:l}}var ii="pointer",ui="default",u="undefined",ar="function",l="visible",ft="hidden",vr="hp_pgps",g="focus",nt="click",pr="keydown",c="mousedown",wi="mouseup",ot="mouseover",ru="mousewheel",tr="touchstart",fi="hpsbact",iu="div",hr="dhplink",ur="block",v="none",ei=8,hi=500,ct=0,n=0,oi=0,b=null,t=[],st=[],p,et="url",di="bot",f=_ge("bgDiv"),er=_ge("bgDivPortrait"),r=_ge("sh_igl"),e=_ge("sh_igr"),s=_ge("sh_igw"),k=0,w=_ge("sh_cp"),ut="sc_light",rt="sc_dark",it="javascript:void(0)",a=null,ri=!0,fu="ontouchstart"in _w,i=null,ni=null,d=_ge("sb_form_q"),gi=d&&d.parentNode,y,vt=_anim.fadeE(f,hi),ht,at=_ge("sc_hdu"),h=_ge("dhp"),yt=_ge("dhplink"),tt=_ge("id_h"),ir=300,kr=dr();if(r&&e&&(_w.hpPanoLoad=function(n){kt(n,!0)},!_w.g_IMVL)){typeof _w.g_IMVL!==u&&(_w.g_IMVL=1),sj_evt.bind("onHPHS",function(n){p=n[1]},1),d&&(sj_be(d,g,dt),sj_be(d,pr,dt),gi&&sj_be(gi,nt,dt)),sj_evt.bind("onRBComplete",function(){var n=_w.sched;_w.g_hptse&&n&&n.schedule({ns:"H",task:function(){n.complete("H")}}),ou()},1),at&&(h||yt)&&tt&&(sj_evt.bind(hr,li,1),sj_be(_w,"resize",li,!1));var or=new RegExp("[\\?&]ssd=([^&#]*)"),ti=or.exec(_w.location.href),ci=1,si;ti!=null&&ti[1]!=null&&(si=ti[1].replace("_",""),ci=ei),fr(0,ci,function(i){function u(n){sb_st(sj_wf(rr,n),1),sj_ue(r,ot,u),sj_ue(e,ot,u),sj_ue(r,g,u),sj_ue(e,g,u)}var f,h,c,v,o,p,w;if(i){if(n=0,si!=null)for(tu(),f=0;f<ct;f++)t[f].fullstartdate==si&&(n=f);else gt(0,0);y=y||a.tooltips,sj_be(r,nt,wt),sj_be(e,nt,bt),r.firstChild.style.visibility=l,e.firstChild.style.visibility=l,h=_ge("sh_igf"),h&&(h.firstChild.style.visibility=l),c=_ge("sh_pl"),v=_ge("sh_ps"),lt(),r.firstChild.className=t[n][di]=="1"?ut:rt,t[n].pano?kt(t[n].pano,!0):t[n].vid&&(o=t[n].vid.dark,c.parentNode.className=o?"sh_pll":"sh_pld",v.parentNode.className=o?"sh_psl":"sh_psd",r.firstChild.className=o?ut:rt),p=function(i){sj_pd(i),n==0&&t&&t.length==1?u(sj_wf(wt,i)):wt(i)},w=function(i){sj_pd(i),n==0&&t&&t.length==1?u(sj_wf(bt,i)):bt(i)},fu&&(sj_be(r,tr,p),sj_be(e,tr,w)),sj_be(r,ot,u),sj_be(e,ot,u),sj_be(r,g,u),sj_be(e,g,u),s&&hpWall&&(_G.Mkt=="zh-CN"?sj_be(s,nt,hpWall.dLFree):sj_be(s,nt,hpWall.dL))}}),function(){var o="px",it="click",w="block",tt="none",p="height",y="HPTBD",n=400,v=35,nt=1,d=.5,b=_ge("sh_igf"),e=_ge("hp_sw_hdr"),t=e.style,a=_ge("sb_foot"),c=_ge("sb_form_q"),h=c&&c.parentNode,s=_ge("sh_fu"),f,u,r,i=!1;if(b&&e&&a&&h){var rt=function(){f=_anim.animE(e,p,0,v,{duration:n,unit:o}),u=_anim.animE(a,p,0,v,{duration:n,unit:o}),r=_anim.fadeE(h,n,n,d,nt),sj_be(b,it,ot),sj_evt.bind(fi,k)},ut=function(){t.display=tt,t.overflow=l,i=!0,sj_evt.fire(y)},et=function(){t.overflow=l,i=!1,sj_evt.fire(y)},ot=function(n){i?k():g(),sj_pd(n)},g=function(){i||(t.display=w,t.overflow=ft,_w.bhptb&&bhptb.hide&&bhptb.hide(n),_w.bhppgb&&bhppgb.hide&&bhppgb.hide(n),_w.bhpnav&&bhpnav.hide&&bhpnav.hide(),f.revert(ut),u.revert(),r.down(),s.className="hpcSmall")},k=function(){i&&(t.display=w,t.overflow=ft,_w.bhptb&&bhptb.show&&bhptb.show(n),_w.bhppgb&&bhppgb.show&&bhppgb.show(n),_w.bhpnav&&bhpnav.show&&bhpnav.show(),f.start(et),u.start(),r.up(),s.className="hpcFull")};rt()}}()}};sj_evt.bind("onBgSet",ImgViewer,1)