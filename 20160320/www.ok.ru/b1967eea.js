define("OK/utils/utils",["jquery"],function(e){var c=e("#hook_Cfg_GwtExperimentsCfg");var g=c?OK.util.parseJSON(c.html()):{};var b=document.getElementById("pointerOverlay");function a(i,k){var j=false;if(b&&OK.css.hasClass(b,"__auto")){j=true;OK.css.removeClass(b,"__auto");}var h=document.elementFromPoint(i,k);if(j){OK.css.addClass(b,"__auto");}return h;}function f(m,j,l){var h=m.split(OK.navigation.SPLITER);for(var k=0;k<h.length;k++){if(l[k]){OK.hookModel.setHookContent(l[k],h[k]);}}}function d(k,i,j,h){var l=e.ajax(k);h.fail(function(){l.abort();});l.done(function(m,q,p){var o=p.getResponseHeader("TKN");if(o){OK.tkn.set(o);}var n=p.getResponseHeader("Redirect-Location");if(n){i(n);h.reject(p,q,"Redirect");return;}h.resolve(m,q,p);});l.fail(function(m,o,n){if(j>0){d(k,i,--j,h);}else{h.reject(m,o,n);}});return h;}return{ajax:function(i,h,j){if(arguments.length>1){if(typeof arguments[1]!=="function"){j=h;h=undefined;}}j=j||0;h=h||function(l){if(OK.navigation.redirect){OK.navigation.redirect(l);}else{document.location.href=decodeURIComponent(l);}};var k=i.data||{};k["gwt.requested"]=window.pageCtx.gwtHash;i.type=i.type||"POST";i.data=k;i.beforeSend=function(m,l){m.setRequestHeader("TKN",OK.tkn.get());};return d(i,h,j,e.Deferred());},updateBlockModelCallback:function(j,h,k){var i=k.getResponseHeader(OK.navigation.HEADER).split(",");f(j,h,i);},updateBlocks:f,gwtExperimentsCfg:g,encodeHtml:function(h){return e("<div/>").text(h).html();},isElementInViewport:function(h){var i=h.getBoundingClientRect();if(i.top<0||i.left<0||i.bottom>(window.innerHeight||document.documentElement.clientHeight)||i.right>(window.innerWidth||document.documentElement.clientWidth)){return false;}return(h.contains(a(i.left,i.top))||h.contains(a(i.right,i.top))||h.contains(a(i.right,i.bottom))||h.contains(a(i.left,i.bottom)));},isElementPartiallyInViewport:function(l,i){if(!i){return this.isElementInViewport(l);}var m=l.getBoundingClientRect(),h=Math.min(m.bottom,window.innerHeight||document.documentElement.clientHeight)-Math.max(0,m.top),j=Math.min(m.right,window.innerWidth||document.documentElement.clientWidth)-Math.max(0,m.left),k=l.offsetHeight,n=l.offsetWidth;return k*i<=h&&n*i<=j;}};});define("OK/registration/Registration",["jquery","OK/utils/utils"],function(b,a){return{activate:function(f){var j=f.getAttribute("data-modal")==="true",h=j?"m-":"",d=document.getElementById(h+"login-nav"),e=document.getElementById(h+"registrationContentBlock"),g=document.getElementById(h+"loginContentBlock"),c=document.getElementById(h+"enterHeader"),i=document.getElementById(h+"registration");f.getElementsByClassName("js-st.field_fJS")[0].value="on";f.getElementsByClassName("js-field_st.screenSize")[0].value=screen.width+" x "+screen.height;f.getElementsByClassName("js-field_st.browserSize")[0].value=OK.util.getVpHeight();f.getElementsByClassName("js-field_st.flashVer")[0].value=(okFlashVersion||[]).join(".");if(j){OK.loader.use(["OKCustomJs"],function(){OK.Layers.register("registration",function(){OK.hookModel.setHookContent("PopLayer","");},null,false,null,null);});}d.addEventListener("click",function(n){var m=(n.target===c)?g:e,k=(n.target===c)?i:c,l=(n.target===c)?e:g;k.classList.remove("__active");l.classList.add("invisible");n.target.classList.add("__active");m.classList.remove("invisible");OK.historyManager.replaceState(n.target.getAttribute("href"));n.preventDefault();});},activateLoginForm:function(c){b(c).submit(function(f){var d={};b(f.currentTarget).find("input").each(function(){d[this.name]=this.value;});a.ajax({url:f.currentTarget.action,data:d}).done(a.updateBlockModelCallback);return false;});}};});define("OK/capture",["OK/logger"],function(p){var m=document,e,b,q="h-mod",g="href",l="data-module",j="data-activate",d="activate",i="OK/",o=[],f=function(r){var u,s,t;if(r.id&&r.id.indexOf("hook_")===0){s=r.id.substr(5);t=s.substr(0,s.indexOf("_"));if(t!=="Block"){p.success("capture.gwt",t,e);}}u=r.firstChild;while(u){f(u);u=u.nextSibling;}},a=function(v){var t,r,s;try{t=Array.prototype.slice.call(v);}catch(u){s=v.length;if(s>0){t=new Array(s);for(r=0;r<s;r+=1){t[r]=v[r];}}else{t=[];}}return t;},k=function(r){var t=r.getAttribute(j)||d;return function s(v){var u;if(typeof v==="function"){u=new v(r.id);}else{u=v;}u[t](r);o.push(u);};},c=function(t,r){var u,s;r=i+r;u=k(t);if(require.defined(r)){s=require(r);u(s);}else{require([r],u);}},h=function(x){var y,A,r,u,z,v,t,s,w;x=x||m;y=x.getElementsByClassName(q);r=a(y);u=r.length;for(z=0;z<u;z+=1){t=r[z];s=t.getAttribute(l);if(s){c(t,s);}}if(b){A=x.getElementsByTagName("a");r=a(A);u=r.length;for(z=0;z<u;z+=1){t=r[z];w=t.getAttribute(g);if(w){for(v=0;v<b.length;v+=1){s=b[v];if(w&&(w.indexOf("cmd="+s)!==-1)){c(t,s);}}}}}if(e){f(x);}},n=function(r){if(m.readyState==="interactive"||m.readyState==="complete"){h(r);}else{m.addEventListener("DOMContentLoaded",h);}};return{activate:n,activateDocument:function(r,s){b=r;e=s;n();}};});define("OK/registration/Utils",["OK/utils/utils","OK/capture"],function(c,e){var b="data-",f="st.r.",a=document.getElementById("generalErrorHook"),d=a.getAttribute("data-general");a.parentNode.removeChild(a);return{lastSmsTimeCookieName:"_lastSmsForCodeTime",addSubmitHook:function(g,h){g.addEventListener("keyup",function(i){if(i.keyCode==13){h();}});},getAttributesFromHook:function(k,h){if(typeof k==="string"){k=document.getElementById(k);}var l={};for(var j=0;j<k.attributes.length;j++){var g=k.attributes[j];if(g.name.indexOf(b)==0){l[g.name.substring(b.length)]=g.value;}}if(h){k.parentNode.removeChild(k);}return l;},proceed:function(k,g){var j={};for(var h in k){j[f+h]=k[h];}var i={data:j,url:"/dk"};i.data["st.cmd"]="anonymMain";i.data.cmd="AnonymRegistration";c.ajax(i).done(function(m,l,n){if(m!=""){g.innerHTML=m;e.activate(g);}}).fail(function(m,o,n){if(n!="Redirect"){var l=document.getElementById("general-error");l.classList.remove("invisible");l.textContent=d;}});},toggleClass:function(h,g,i){if(i){h.classList.add(g);}else{h.classList.remove(g);}},hideFieldError:function(g,h){if(g){g.classList.remove("form_i__error");}if(h){h.classList.remove("invisible");}},showFieldError:function(i,j,h,g){if(h){h.textContent=g;}if(i){i.classList.add("form_i__error");}if(j){j.classList.add("invisible");}}};});define("OK/registration/enterPhone",["OK/registration/Utils"],function(a){return{activate:function(d){var c=d.parentNode,i=d.getElementsByClassName("js-country")[0],f=d.getElementsByClassName("js-phone-code")[0],b=d.getElementsByClassName("js-phone")[0],e=d.getElementsByClassName("js-proceed-registration")[0],h=function(){f.textContent=i.value;},g=function(){var j=i.options[i.selectedIndex].getAttribute("data-id"),k={countryId:j,countryCode:i.value,phone:b.value,registrationAction:"ValidatePhoneNumber"};OK.cookie.clearCookie(a.lastSmsTimeCookieName,"/");a.proceed(k,c);};i.addEventListener("change",h);i.addEventListener("input",h);e.addEventListener("click",g);f.addEventListener("click",b.focus);a.addSubmitHook(b,g);}};});define("OK/registration/enterCode",["OK/registration/Utils"],function(a){return{activate:function(h){var c=h.parentNode,k=h.getElementsByClassName("js-back-to-enter-phone")[0],e=h.getElementsByClassName("js-proceed-registration")[0],f=h.getElementsByClassName("js-proceed-registration-container")[0],l=h.getElementsByClassName("js-resend-sms-code")[0],m=h.getElementsByClassName("js-resend-sms-code-disabled")[0],i=h.getElementsByClassName("js-resend-sms-code-container")[0],g=h.getElementsByClassName("js-sms-code")[0],b=m.value,j=function(){var n={smsCode:g.value,registrationAction:"ValidateCode"};a.proceed(n,c);},d=function(){var o=parseInt(OK.cookie.readCookie(a.lastSmsTimeCookieName),10),p=Date.now(),q,n;if(!o){o=p;OK.cookie.setCookie(a.lastSmsTimeCookieName,o,1,"/");}q=Math.round((p-o)/1000);m.value=b.replace("%d",20-q);if(q<=20){m.classList.remove("invisible");l.classList.add("invisible");n=window.setInterval(function(){p=Date.now();q=Math.round((p-o)/1000);if(q<=20){m.value=b.replace("%d",20-q);}else{window.clearInterval(n);m.classList.add("invisible");l.classList.remove("invisible");}},300);}else{m.classList.add("invisible");l.classList.remove("invisible");}};l.classList.remove("__disabled");k.addEventListener("click",function(){var n={registrationAction:"BackToEnterPhone"};a.proceed(n,c);});e.addEventListener("click",j);a.addSubmitHook(g,function(){if(!f.classList.contains("invisible")){j();}});l.addEventListener("click",function(){var n={registrationAction:"ResendCode"};a.proceed(n,c);OK.cookie.clearCookie(a.lastSmsTimeCookieName,"/");d();});g.addEventListener("keyup",function(){var n=(g.value==="");a.toggleClass(f,"invisible",n);a.toggleClass(i,"invisible",!n);});d();}};});define("OK/registration/chooseUser",["OK/registration/Utils"],function(a){return{activate:function(e){var b=e.parentNode,k=e.getElementsByClassName("js-its-not-me-button")[0],h=b.getElementsByClassName("chooseUserButton"),d=a.getAttributesFromHook(e.getElementsByClassName("js-action-hook")[0],true)["action"],f,c,j=function(m){var l=m.target.getAttribute("data-value"),i={userId:l,registrationAction:"RecoverUser"};a.proceed(i,b);},g=function(){var i={registrationAction:d};a.proceed(i,b);};if(h){for(f=0,c=h.length;f<c;f++){h[f].addEventListener("click",j);}}k.addEventListener("click",g);}};});define("OK/registration/authorize",["OK/registration/Utils"],function(a){return{activate:function(f){var p=f.parentNode,m=f.getElementsByClassName("js-proceed")[0],c=f.getElementsByClassName("js-enter-password")[0],t=f.getElementsByClassName("js-enter-login")[0];if(t){var j=a.getAttributesFromHook(f.getElementsByClassName("js-login-restrictions-hook")[0],true),x=new RegExp(j["allowed-symbols-pattern"]),A=j["min-length"],y=f.getElementsByClassName("js-login-hint")[0],l=f.getElementsByClassName("js-login-form")[0],w=f.getElementsByClassName("js-login-error")[0],k=a.getAttributesFromHook(f.getElementsByClassName("js-hook-login-msg")[0],true);var u=function(C){var D=t.value;if(!x.test(D)){a.showFieldError(l,y,w,k["invalid-characters"]);}else{if(!C){if(D==""){a.showFieldError(l,y,w,k.empty);}else{if(D.length<A){a.showFieldError(l,y,w,k["short"]);}else{a.hideFieldError(l,y);return true;}}}else{a.hideFieldError(l,y);return true;}}return false;};t.addEventListener("keyup",function(){u(true);});}var o=a.getAttributesFromHook(f.getElementsByClassName("js-password-restrictions-hook")[0],true);var e=o["min-length"];var n=new RegExp(o["allowed-symbols-pattern"]);var g=new RegExp(o["must-contain-pattern"]);var v=f.getElementsByClassName("js-password-error")[0];var b=f.getElementsByClassName("js-password-form")[0];var s=f.getElementsByClassName("js-password-indicator-container")[0];var B=f.getElementsByClassName("js-password-rate")[0];var d=B.getElementsByClassName("progress-rate_bar");var z=f.getElementsByClassName("js-password-indicator-hint")[0];var r=a.getAttributesFromHook(f.getElementsByClassName("js-hook-pwd-msg")[0],true);var h=function(F,E,D){B.className="progress-rate mt-2x "+F;if(E>0){for(var C=0;C<E;C++){d[C].classList.add("__full");}}if(E<3){for(C=E;C<d.length;C++){d[C].classList.remove("__full");}}a.toggleClass(b,"form_i__error",D);a.toggleClass(z,"reg_error_txt",D);};var i=function(C,D){if(v){a.toggleClass(b,"form_i__error",!D);v.parentNode.removeChild(v);a.toggleClass(s,"invisible",!D);}if(C==""){z.textContent=r.empty;h("",0,D);}else{if(!n.test(C)){h("__weak",3,true);z.textContent=r.invalid;}else{if(C.length<e||!g.test(C)){if(C.length<e&&!g.test(C)){h("__weak",1,true);}else{h("__normal",2,true);}if(C.length<e){z.textContent=r["short"];}else{z.textContent=r["must-contain"];}}else{z.textContent=r.ok;h("__strong",3,false);return true;}}}return false;};c.addEventListener("keyup",function(){i(c.value,true);});var q=function(){var D=true;if(t){D=u();}if(!i(c.value,true)||!D){return;}var C={password:c.value,registrationAction:"Authorize"};if(t){C.login=t.value;}a.proceed(C,p);};m.addEventListener("click",q);a.addSubmitHook(c,q);i(c.value,false);}};});define("b/registration",["require","OK/registration/Registration","OK/registration/Utils","OK/registration/enterPhone","OK/registration/enterCode","OK/registration/chooseUser","OK/registration/authorize"],function(a){a("OK/registration/Registration");a("OK/registration/Utils");a("OK/registration/enterPhone");a("OK/registration/enterCode");a("OK/registration/chooseUser");a("OK/registration/authorize");return function(){};});