(function(parentWindow,currentWindow){var window;try{window=setWindow()}catch(e){window=parentWindow}var document=window.document;var ISM=window.InSkin||(window.InSkin={}),ns=ISM.PublisherCode||(ISM.PublisherCode={}),LIB={},tests={},util,$,kwExclude={},kwInclude={};var SCRIPT_ID="124520/default";var BUILD_DATETIME="20150812092449";if(!ns.loadedPublisherScripts){ns.loadedPublisherScripts={}}(function(){util={};util.extend=function(dst){dst=dst||{};for(var i=1;i<arguments.length;i++){var obj=arguments[i];if(!obj){continue}for(var key in obj){if(typeof obj[key]=="object"){util.extend(dst[key],obj[key])}else{dst[key]=obj[key]}}}return dst};util.getURLParams=function(){try{var r={};var s=window.location.search.substring(1);var a=s.split("&");for(var i=0;i<a.length;i++){if(!a[i]){continue}var b=a[i].split("=");r[b[0]]=b[1]?decodeURIComponent(b[1]):""}return r}catch(e){}return{}};util.getScriptParams=function(re,sep){if(!sep){sep="&"}var scripts=currentWindow.document.getElementsByTagName("script");var matches;for(var i=0;i<scripts.length;i++){if(!(matches=scripts[i].src.match(re)))continue;var params={};var str;if(matches.length==3){sep=matches[1];str=matches[2]}else{str=matches[1]}var a=str.split(sep);for(var j=0;j<a.length;j++){if(a[j]=="")continue;var b=a[j].split("=");params[b[0]]=b[1]?decodeURIComponent(b[1]):""}return params}return null};util.jsonp=function(params){var callbackName="ism_jsonp_"+util.random(),win=params.window||window,el;var url=params.url;url+=(url.indexOf("?")>=0?"&":"?")+"callback="+callbackName;if(params.data){for(var key in params.data){var p=params.data[key],type=Object.prototype.toString.call(p);switch(type){case"[object Array]":for(var i=0;i<p.length;i++){url+="&"+key+"="+encodeURIComponent(p[i])}break;case"[object Object]":var prefix=!params.flatten?key+".":"";for(var k in p){url+="&"+prefix+k+"="+encodeURIComponent(p[k])}break;case"[object Boolean]":url+="&"+key+"="+p.toString();break;default:url+="&"+key+"="+encodeURIComponent(p)}}}win[callbackName]=function(json){if(el){el.parentNode.removeChild(el)}delete win[callbackName];if(params.callback){params.callback(json)}};el=util.loadJS(url,win.document,params.async)};util.loadJS=function(url,doc,async){if(!doc){doc=document}if(!async&&doc.readyState=="loading"){doc.write("<scr"+'ipt src="'+url+'"></scr'+"ipt>")}else{var el=doc.createElement("script");el.setAttribute("type","text/javascript");el.setAttribute("src",url);var hd=doc.getElementsByTagName("head")[0];if(hd){hd.appendChild(el);return el}}};util.runJS=function(code,window){if(window.document.readyState=="loading"){window.document.write(code)}else{var re=/^\s*<script[^>]+src\s*=\s*("|')(.+)\1[^>]*>/i;var matches=code.match(re);if(matches){util.loadJS(matches[2],window.document,true)}else{eval(code.replace(/^\s*<script[^>]*>|<\/script>\s*$/gi,""))}}};util.loadCSS=function(url,doc){if(!doc){doc=document}var el=doc.createElement("link");el.setAttribute("type","text/css");el.setAttribute("rel","stylesheet");el.setAttribute("href",url);var hd=doc.getElementsByTagName("head")[0];if(hd){hd.appendChild(el)}};util.getFrameDoc=function(el,doc){if(!doc){doc=document}if(typeof el=="string"){el=doc.getElementById(el)}try{if(el){if(el.contentDocument){return el.contentDocument}else if(el.contentWindow){return el.contentWindow.document}else{return el.document}}}catch(e){}return null};util.getPageKeywords=function(prefix){if(prefix==undefined){prefix="meta-"}var keywords=[];var metas=document.getElementsByTagName("meta");for(var i=0;i<metas.length;i++){if(metas[i].name&&metas[i].name.toLowerCase()=="keywords"){if(metas[i].content){var kws=metas[i].content.split(",");for(var j=0;j<kws.length;j++){var kw=kws[j].toLowerCase().replace(/[^a-z0-9]/g,"");if(kw.length>1){keywords.push(prefix+kw)}}}}}return keywords};util.getURLPathKeywords=function(depth){var keywords=[];var path=window.location.pathname.split("/"),keyword="url",i=1,d=0;while(d<depth&&i<path.length){keyword+="-"+path[i];keywords.push(keyword);i++;d++}return keywords};util.ensureBooleans=function(obj,keys){var key;for(var i=0;i<keys.length;i++){key=keys[i];if(typeof obj[key]!="undefined"){obj[key]=String(obj[key]).toLowerCase()=="true"?true:false}}};util.ensureIntegers=function(obj,keys){var key;for(var i=0;i<keys.length;i++){key=keys[i];if(typeof obj[key]!="undefined"){obj[key]=parseInt(obj[key])}}};util.random=function(){return Math.floor(Math.random()*1e17)};util.extendCSV=function(csv,value){if(!csv){csv=""}return csv+(csv.length?",":"")+value};util.setCookie=function(name,value,expires,path,domain,secure){if(expires){var now=new Date;now.setTime(now.getTime()+expires*1e3);expires=now}var cookie=name+"="+escape(value)+(expires?"; expires="+expires.toGMTString():"")+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+(secure?"; secure":"");document.cookie=cookie};util.getCookie=function(name){var dc=document.cookie;var prefix=name+"=";var begin=dc.indexOf("; "+prefix);if(begin==-1){begin=dc.indexOf(prefix);if(begin!=0)return null}else{begin+=2}var end=document.cookie.indexOf(";",begin);if(end==-1){end=dc.length}return unescape(dc.substring(begin+prefix.length,end))};util.delCookie=function(name,path,domain){if(this.getCookie(name)){document.cookie=name+"="+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT"}};util.setISAPCookies=function(json){var cookies={Session:1800,Persistent:1*365*24*60*60};try{for(var type in cookies){var value=json[type+"Cookies"];if(!value){continue}var currentValue=util.getCookie("ISAP"+type),currentValueObj=currentValue?JSON.parse(currentValue):{},newValueObj=util.extend({},currentValueObj,value),newValue=JSON.stringify(newValueObj),expire=cookies[type];util.setCookie("ISAP"+type,newValue,expire,"/")}}catch(e){}};util.getISAPCookies=function(){try{var ISAPSession=util.getCookie("ISAPSession"),ISAPSessionObj=ISAPSession?JSON.parse(ISAPSession):{},ISAPPersistent=util.getCookie("ISAPPersistent"),ISAPPersistentObj=ISAPPersistent?JSON.parse(ISAPPersistent):{},obj=util.extend({},ISAPSessionObj,ISAPPersistentObj),data=[];for(var key in obj){data.push(key+"=="+obj[key])}return data.length?{vstrCookieData:data.join("&&")}:{}}catch(e){}};util.loadURL=function(url){var img=new Image;img.src=url};util.semvercmp=function(a,b){var pa=a.split(".");var pb=b.split(".");for(var i=0;i<3;i++){var na=parseInt(pa[i]);var nb=parseInt(pb[i]);if(na>nb)return 1;if(nb>na)return-1;if(!isNaN(na)&&isNaN(nb))return 1;if(isNaN(na)&&!isNaN(nb))return-1}return 0}})();(function(){if(!ISM.Callbacks){ISM.Callbacks={callbacks:{}}}var _self=ISM.Callbacks;_self.add=function(name,callback){if(typeof _self.callbacks[name]=="undefined"){_self.callbacks[name]=[]}_self.callbacks[name].push(callback)};_self.del=function(name,callback){if(name){if(_self.callbacks[name]){if(callback){_self.lastCallbackRemoved=callback;for(var i=_self.callbacks[name].length-1;i>=0;i--){if(_self.callbacks[name][i]===callback){_self.callbacks[name].splice(i,1)}}}else{delete _self.callbacks[name]}}}else{_self.callbacks={}}};_self.run=function(name){var fn=[];if(typeof window[name]=="function")fn.push(window[name]);if(_self.callbacks[name])fn=fn.concat(_self.callbacks[name]);var args=[],i;for(i=1;i<arguments.length;i++)args.push(arguments[i]);var sw=false;for(i=0;i<fn.length;i++){try{fn[i].apply(null,args);sw=true}catch(e){}}return sw}})();(function(){var fnTest=/xyz/.test(function(){var xyz})?/\b_super\b/:/.*/,initializing=false;LIB.BaseClass=function(){};LIB.BaseClass.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this;initializing=false;for(var name in prop){if(typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])){prototype[name]=function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret}}(name,prop[name])}else{prototype[name]=prop[name]}}function NewClass(){if(!initializing&&this.construct){this.construct.apply(this,arguments)}}NewClass.prototype=prototype;NewClass.constructor=NewClass;NewClass.extend=arguments.callee;return NewClass}})();(function(){LIB.EventDispatcher=LIB.BaseClass.extend({construct:function(){this.listeners={}},addEventListener:function(name,fn,thisObj){if(!this.listeners[name]){this.listeners[name]=[]}this.listeners[name].push({fn:fn,thisObj:thisObj})},removeEventListener:function(name,fn,thisObj){if(!arguments.length){this.listeners={};return}if(!this.listeners[name]){return}if(!fn){this.listeners[name]=[]}else{var l=this.listeners[name];for(var i=l.length-1;i>=0;i--){if(l[i].fn===fn&&l[i].thisObj===thisObj){l.splice(i,1)}}}},dispatchEvent:function(name,data,target){var l=[].concat(this.listeners[name]||[]);l=l.concat(this.listeners["*"]||[]);if(!l.length){return}var e={name:name,data:data,target:target||this};var fn;for(var i=0;i<l.length;i++){if(l[i].thisObj&&typeof l[i].fn=="string"){fn=l[i].thisObj[l[i].fn]}else{fn=l[i].fn}if(typeof fn=="function"){if(fn.apply(l[i].thisObj,[e])===false){return false}}}},forwardEvent:function(e){return this.dispatchEvent(e.name,e.data)}})})();(function(){var servePassbackCalled=false;LIB.Integration=LIB.EventDispatcher.extend({construct:function(){this._super();this.id=this.id||SCRIPT_ID;this.meta={};this.params={};this.testParams={};this.failedTests={};this.flaggedTests=[];this.custom={};this.async=true;this.telemetry=new LIB.Telemetry(this)},init:function(){this.dispatchEvent("init");this._updateParams();this.dispatchEvent("parametersSet");this.telemetry.recordImpression();if(this._runIntegrationTests()==false){this._servePassback()}var _self=this;this._makeAdCall(function(response){_self.telemetry.recordAdCallResponse(response);if(!this.invalid&&response){_self.params.plr_CachedISAPResponse=response;_self._loadBase(function(){$=ISM.$;window.InSkinParams[_self.params.plr_InSkinID]=_self.params;_self.base=new ISM.Base(_self.params.plr_InSkinID);_self.base.loadCSS("base.css");_self.base.addEventListener("*",function(e){if(e.name=="ready"){_self.telemetry.recordBaseReady()}if(e.name=="adServed"){_self.telemetry.recordAdServed()}_self.dispatchEvent(e.name,e.data,e.target)});_self.base.init()})}else{_self._servePassback()}})},on:function(name,fn){this.addEventListener(name,fn,this)},off:function(name,fn){this.removeEventListener(name,fn,this)},once:function(name,fn){var f=function(e){this.removeEventListener(name,f,this);fn.call(this,e)};this.addEventListener(name,f,this)},_runIntegrationTests:function(){var ok=true;var result;for(var test in tests){if(this.testParams[test]===false){continue}try{result=tests[test].apply(null,this.testParams[test]||[])}catch(e){result=false}if(result!==true){ok=false;this.invalid=true;if(typeof this.params.srv_Invalid=="undefined"){this.params.srv_Invalid=true}this.failedTests[test]=result;this.telemetry.recordFailedTest(test,result)}}return ok},_servePassback:function(){if(servePassbackCalled){return}servePassbackCalled=true;var tag;if(this.params.passback){tag=this.params.passback}else if(typeof window.ISMPassback=="function"){tag=window.ISMPassback()}if(tag){tag=tag.replace(/<\\script>/gi,"</script>");var win=this.params.servePassbackInParent?window:currentWindow;var doc=win.document;if(this.params.servePassbackInIframe){setTimeout(function(){var iframe=win.document.createElement("iframe");iframe.style.display="none";var bd=win.document.getElementsByTagName("body")[0];if(bd){bd.appendChild(iframe)}var iframeDoc=util.getFrameDoc(iframe,win.document);if(iframeDoc){var html="<!doctype html><html><body>"+tag+"</body></html>";iframeDoc.open();iframeDoc.write(html);iframeDoc.close()}},0)}else{util.runJS(tag,win)}}},_makeAdCall:function(callback){var data={};if(this.params.plr_DirectAdCall){if(this.params.plr_AdvertID){data.method="GetCampaignInformationFromAdvertID";data.vintAdvertID=this.params.plr_AdvertID}else if(this.params.plr_CreativeID){data.method="GetCampaignInformationFromCreativeID";data.vintCreativeID=this.params.plr_CreativeID}}else{data.method="GetCampaignInformationFromUserData";if(this.params.srv_AdvertIDs=="NETWORK"&&!this.disableKWFilters){this.keywordMatches=this._keywordFilters()}var params=[];for(var k in this.params){if(k.match(/^srv_/i)){params.push(k+"="+this.params[k])}}data.vstrCampaignData=params.join("&")}util.extend(data,util.getISAPCookies());var url;if(this.params.plr_UAT){url="//staging.inskinad.com/ISAPAdServer/AdS.aspx"}else{url="//www.inskinad.com/ISAPAdServer/AdS.aspx"}util.jsonp({window:currentWindow,url:url,async:this.async,data:data,callback:function(response){if(response){util.setISAPCookies(response)}if(callback){callback(response)}}});this.telemetry.recordAdCall()},_loadBase:function(callback){if(!this.params.plr_ContentType){return}var light=false;if(!this.params.plr_UseFullVersion){if(typeof jQuery!="undefined"){var v=jQuery.fn.jquery;if(util.semvercmp(v,"1.4")>=0&&util.semvercmp(v,"1.7.2")<=0){light=true}}}var url=[this.params.BASE_URL+"/js/base/api/",this.params.plr_ContentType.toLowerCase(),light?"-light":"",".js?_="+BUILD_DATETIME].join("");var _self=this;var onLoaded=function(apiName){if(apiName!=_self.params.plr_ContentType){return}ISM.Callbacks.del("InSkinLoaded",onLoaded);callback()};ISM.Callbacks.add("InSkinLoaded",onLoaded);util.loadJS(url,null,true)},_updateParams:function(){var adtagParams=util.getScriptParams(new RegExp(this.id.replace("/","\\/")+"\\.js\\?autoload([^A-Za-z0-9]+)(.*)$"));if(adtagParams&&adtagParams.id&&currentWindow[adtagParams.id]){util.extend(adtagParams,currentWindow[adtagParams.id]);delete adtagParams.id;this.v2AdTag=true}var urlParams=util.getURLParams();for(var k in urlParams){if(k!="BASE_URL"&&k!="DEBUG"&&!k.match(/^(srv|plr)_/)){delete urlParams[k]}}this.params=util.extend({BASE_URL:"//cdn.inskinmedia.com/isfe/4.1",srv_ResWidth:screen.width,srv_ResHeight:screen.height,plr_InSkinID:"myInSkin_"+util.random()},adtagParams,this.params,urlParams);util.ensureBooleans(this.params,["srv_Invalid","plr_DirectAdCall","plr_UAT","plr_UseFullVersion"]);util.ensureIntegers(this.params,["plr_URLKeywords"]);if(!this.params.srv_Keywords){var kw=util.getPageKeywords().join(",");this.params.srv_Keywords=kw}if(this.params.plr_URLKeywords){var kw=util.getURLPathKeywords(this.params.plr_URLKeywords).join(",");this._addKeywords(kw)}},_addKeywords:function(){var kw=Array.prototype.join.call(arguments,",");this.params.srv_Keywords=util.extendCSV(this.params.srv_Keywords,kw)},_keywordFilters:function(){var data,matches,match,seen={};var text=[document.title].concat(util.getPageKeywords(""));for(var i=0;i<text.length;i++){text[i]=text[i].toLowerCase().replace(/[^a-z0-9]/g,"")}text=text.join(" ");data=compileKWFilters(kwExclude);matches=search(data.trie,text);if(matches){match=matches[0];if(data.hash[match]===false){this.params.srv_Invalid=true}else if(data.hash[match]){this._addKeywords(data.hash[match]);seen[data.hash[match]]=true}return seen}data=compileKWFilters(kwInclude);matches=search(data.trie,text,true);if(matches){for(var i=0;i<matches.length;i++){match=matches[i];if(data.hash[match]&&!seen[data.hash[match]]){this._addKeywords(data.hash[match]);seen[data.hash[match]]=true}}}return seen}});function search(trie,s,allMatches){var current=trie;var state="";var split=s.split("");var j=0;var matches=[];while(1){for(i=j;i<split.length;i++){var r=current.hasChild(split[i])?current.getChild(split[i]):null;if(r){state+=split[i];current=r;if(trie.getWordCount(state)!=0){if(allMatches){matches.push(state);current=trie;state=""}else{return[state]}}}else{current=trie;i=i-state.length;state=""}}if(state==""){return matches.length?matches:false}else{current=trie;j=i-state.length+1;state=""}}}function compileKWFilters(kw){var result={trie:new Trie,hash:{}};var k,keyword;for(var key in kw){if(typeof kw[key]=="object"){if(kw[key].from&&kw[key].from.getTime()>(new Date).getTime()){continue}if(kw[key].to&&kw[key].to.getTime()<(new Date).getTime()){continue}keyword=kw[key].keyword}else{keyword=kw[key]}k=key.toLowerCase().replace(/[^a-z0-9]/g,"");result.trie.add(k);result.hash[k]=keyword}return result}})();(function(){LIB.Telemetry=Telemetry;var serverUrl="//t.inskinad.com";function Telemetry(integration){this.integration=integration;this._timers={};this.startTimer("since-load");this._features={custom:true,impression:false,"failed-test":false,"ad-call":false,"ad-call-response":false,"base-ready":false,"ad-served":false,keywords:false,url:false}}var proto=Telemetry.prototype;proto.setup=function(options){util.extend(this._features,options);if(this._features.keywords||this._features.url){this._features.impression=true}};proto.send=function(){for(var i=0;i<arguments.length;i++){var evt=arguments[i];if(!this._features[evt.type]){continue}evt.pubfileId=this.integration.id;evt.platform=this.integration.meta.platform||"unknown";evt.ua=navigator.userAgent;util.jsonp({url:serverUrl+"/record",data:evt,flatten:true,async:true})}};proto.recordCustom=function(label,value){this.send({type:"custom",label:label,value:value||0})};proto.recordImpression=function(){var evt={type:"impression"};if(this._features.keywords){evt.keywords=util.getPageKeywords()}if(this._features.url){evt.url=window.location.href}this.send(evt)};proto.recordFailedTest=function(name,reason){this.send({type:"failed-test",name:name,reason:reason})};proto.recordAdCall=function(){var p=this.integration.params;this.adCallData={direct:p.plr_DirectAdCall&&p.plr_DirectAdCall.toString()=="true",invalid:this.integration.invalid,sectionId:p.srv_SectionID||"",advertId:p.srv_AdvertIDs||""};this.isapResponse={};var evt={type:"ad-call",i_delay:this.getTimer("since-load")};this.addAdCallData(evt);this.send(evt)};proto.recordAdCallResponse=function(response){this.isapResponse=parseISAPResponse(response);var evt={type:"ad-call-response",i_delay:this.getTimer("since-load")};this.addAdCallData(evt);this.addISAPResponse(evt);if(!this.integration.invalid){this.send(evt)}var cp10;if(this.adCallData.invalid){cp10="invalid"}else{cp10=response?"adreturned":"noad"}var cp12=[];var cp13=[];for(var k in this.integration.failedTests){if(indexOf(this.integration.flaggedTests,k)>=0){cp13.push(k)}else{cp12.push(k)}}cp12=cp12.join(";");cp13=cp13.join(";");var cp18="";if(window.innerWidth){var winArea=window.innerWidth*window.innerHeight;cp18=screen.width*screen.height*.85<=winArea;cp18=cp18.toString()}ISM.wtAdCallLogged=true;var wtData={sectionId:evt.sectionId||"",cp5:this.isapResponse.campaignId||"none",cp6:this.isapResponse.advertId||this.adCallData.advertId||"",cp7:this.isapResponse.creativeId||"",cp8:this.isapResponse.productType||"",cp10:cp10,cp11:this.isapResponse.vertical||"",cp12:cp12,cp13:cp13,cp18:cp18};if(this.integration.keywordMatches){var cp2=[];for(var k in this.integration.keywordMatches){cp2.push(k.toLowerCase().replace(/[^a-z0-9]/g,""))}if(cp2.length){wtData.cp2=cp2.join(";")}}this.wt(wtData)};proto.recordBaseReady=function(){var evt={type:"base-ready",i_delay:this.getTimer("since-load")};this.addAdCallData(evt);this.addISAPResponse(evt);this.send(evt)};proto.recordAdServed=function(){var evt={type:"ad-served",i_delay:this.getTimer("since-load")};this.addAdCallData(evt);this.addISAPResponse(evt);this.send(evt)};proto.addAdCallData=function(evt){if(!this.adCallData){return}if(this.adCallData.invalid){evt.b_invalid=true}if(this.adCallData.direct){evt.b_direct=true}if(this.adCallData.sectionId){evt.sectionId=this.adCallData.sectionId}};proto.addISAPResponse=function(evt){var exclude=["vertical"];for(var k in this.isapResponse){if(indexOf(exclude,k)>=0){continue}evt[k]=this.isapResponse[k]}};proto.startTimer=function(name){var timer=this._timers[name]||(this._timers[name]={total:0});if(!timer.started){timer.started=true;timer.since=(new Date).getTime()}};proto.stopTimer=function(name){var timer=this._timers[name]||null;if(timer&&timer.started){timer.started=false;timer.total+=(new Date).getTime()-timer.since}return this.getTimer(name)};proto.getTimer=function(name){var timer=this._timers[name]||null,total=0;if(timer){total=timer.total;if(timer.started){total+=(new Date).getTime()-timer.since}}return total};proto.wt=function(params,isEvent){var p=["326",params.sectionId?params.sectionId:"","1",screen.width+"x"+screen.height,screen.colorDepth,"1",(new Date).getTime(),isEvent?"2":"0",window.innerWidth?window.innerWidth+"x"+window.innerHeight:"",navigator.javaEnabled?"1":"0"].join(",");var url="//inskin01.wt-eu02.net/288029354352268/wt?p="+p;delete params.sectionId;if(!isEvent){params.cp1=window.location.hostname}var userLanguage=navigator.language||navigator.userLanguage||"";params.la=userLanguage.split("-")[0];params.tz=-((new Date).getTimezoneOffset()/60);params.tz=params.tz<0?Math.floor(params.tz):Math.ceil(params.tz);params.tz=params.tz.toString();params.pu=window.location.href;params.eor=1;for(var k in params){if(params[k]!=""){url+="&"+k+"="+encodeURIComponent(params[k])}}var img=document.createElement("img");img.setAttribute("src",url)};function parseISAPResponse(response){if(!response){return{}}var key;switch(response.AdType){case"PageSkin2":key="PageSkinAd";break}if(!key){return{}}return{sectionId:response.SectionID,campaignId:response[key].CampaignID,advertId:response[key].AdvertID,creativeId:response[key].CreativeID,productType:response[key].ProductType,vertical:response[key].Vertical}}function indexOf(arr,item){for(var i=0;i<arr.length;i++){if(arr[i]==item){return i}}return-1}function guid(){var ts=(new Date).getTime();var id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";id.replace(/[xy]/g,function(c){var r=(ts+Math.random()*16)%16|0;ts=Math.floor(ts/16);return(c=="x"?r:r&3|8).toString(16)});return id}})();var Trie=function(){function Trie(stem,sorting){this.stem=stem||"";this.nstem=this.stem.charCodeAt(0);this.sorting=sorting||Trie.SORT_DESC;this.wordCount=0;this.prefixCount=0;this.children=[];this.meta=[]}Trie.SORT_ASC=1;Trie.SORT_DESC=2;Trie.SORT_NONE=4;var STATIC_PROPS=["stem","nstem","sorting","wordCount","prefixCount","meta"];Trie.prototype={add:function(word,meta){if(word){var t,s=this.sorting,i=0,k=word.charAt(0),c=this.children,l=c.length;meta=meta||{};if(!meta.word)meta.word=word;for(;i<l;++i){if(c[i].stem==k){t=c[i];break}}if(!t){++this.prefixCount;t=new Trie(k,s);if(!s||!c.length||s&Trie.SORT_NONE){c.push(t)}else if(s&Trie.SORT_DESC){i=l;do{if(--i<0){c.unshift(t);break}}while(c[i].stem>k);if(i>=0)c.splice(i+1,0,t)}else{i=0,--l;do{if(++i>l){c.unshift(t);break}}while(c[i].stem>k);if(i<=l)c.splice(i,0,t)}}t.add(word.substring(1),meta)}else{this.meta.push(meta);++this.wordCount}},update:function(sOld,sNew,meta){this.remove(sOld);this.add(sNew,meta)},remove:function(word){walker(word,this,function(trie,idx){trie.children.remove(idx)})},find:function(prefix){return walker(prefix,this,function(trie,idx){return trie.children[idx]})},findPrefix:function(prefix){return this.find(prefix)},getChild:function(prefix){var i=0,c=this.children,l=c.length;for(;i<l;++i){if(c[i].stem==prefix)return c[i]}return null},hasChild:function(prefix){return this.getChild(prefix)!==null},sort:function(direction){if(typeof direction=="undefined")direction=Trie.SORT_DESC;if(!this.prefixCount||this.sorting===direction)return;this.sorting=direction;if(direction&Trie.SORT_NONE)return;var c=this.children,i=c.length-1,m=direction&Trie.SORT_ASC?sortAsc:sortDesc;c.sort(m);for(;i>=0;--i)c[i].sort(direction)},getWords:function(){var words=[],c=this.children,i=0,l=c.length;for(;i<l;++i){if(c[i].wordCount){words=words.concat(c[i].meta.map(function(meta){return meta.word}))}words=words.concat(c[i].getWords())}return words},getPrefixCount:function(word){return walker(word,this,function(trie,idx){return trie.children[idx].prefixCount})||0},getWordCount:function(word){return walker(word,this,function(trie,idx){return trie.children[idx].wordCount})||0},toString:function(){return"[Trie] '"+this.stem+"': {\n"+"    stem: "+this.stem+",\n"+"    prefixCount: "+this.prefixCount+",\n"+"    wordCount: "+this.wordCount+",\n"+"    metadata: "+JSON.stringify(this.meta)+",\n"+"    children: [Array]{"+this.children.length+"}\n"+"}"},fromJSON:function(json){STATIC_PROPS.forEach(function(prop){this[prop]=json[prop]}.bind(this));this.children=json.children.map(function(data){var child=new Trie;child.fromJSON(data);return child})},toJSON:function(){var json={children:this.children.map(function(child){return child.toJSON()})};STATIC_PROPS.forEach(function(prop){json[prop]=this[prop]}.bind(this));return json}};function walker(word,trie,method){if(!word||!trie||!method)return null;var ch,c,l,i,prev;while(word.length>0){ch=word.charAt(0),c=trie.children,l=c.length,i=0;for(;i<l;++i){if(ch==c[i].stem)break}if(i==l)return null;word=word.substring(1),prev=trie,trie=c[i]}return method(prev,i)}function sortAsc(a,b){var s1=a.nstem,s2=b.nstem;return s1<s2?1:s1>s2?-1:0}function sortDesc(a,b){var s1=a.nstem,s2=b.nstem;return s1>s2?1:s1<s2?-1:0}return Trie}();tests["explicitContent"]=function(){if(window.DM_Context.video_is_explicit==true){return false}else{return true}};tests["newContent"]=function(){if(window.DM_Context.video_lifetime_in_days<14){return false}else{return true}};tests["desktop_platform"]=function(){var reg_win2000=/Windows\sNT\s([5]{1,}([\.][0]{1,}))/gim;var reg_winXP=/Windows\sNT\s([5]{1,}([\.][1-2]{1,}))/gim;var reg_winVista=/Windows\sNT\s([6]{1,}([\.][0]{1,}))/gim;var reg_win7=/Windows\sNT\s([6]{1,}([\.][1]{1,}))/gim;var reg_win8Desk=/(?!.*Touch)Windows\sNT\s([6]{1,}([\.][2-3]{1,}))/gim;var reg_mac=/^(?=.*Macintosh)(?!.*(android|Silk)).*$/gim;var reg_linux=/^(?=.*(Linux))(?!.*(android|Silk)).*$/gim;if(reg_win2000.test(navigator.userAgent)||reg_winXP.test(navigator.userAgent)||reg_winVista.test(navigator.userAgent)||reg_win7.test(navigator.userAgent)||reg_win8Desk.test(navigator.userAgent)||reg_mac.test(navigator.userAgent)||reg_linux.test(navigator.userAgent)){return true}else{return false}};tests["desktop_browser"]=function(){var reg_opera=/(Opera|OPR)[/\s](\d{1,}([\.][\.A-Za-z0-9]{1,}))/gim;var reg_firefox=/(?!.*(Navigator|Opera))(Firefox[/\s](\d{1,}([\.][\.A-Za-z0-9]{1,})))/gim;var reg_chrome=/(?!.*OPR).(?=.*Safari)((Chrome|CriOS)[/\s](\d{1,}([\.][\.A-Za-z0-9]{1,})))/gim;var reg_ie9=/(?!.*AOL)(MSIE\s([9]{1,}([\.]\d{1,})))/gim;var reg_ie10=/(?!.*AOL)(MSIE\s([10]{1,}([\.]\d{1,})))/gim;var reg_ie11=/(?=Trident).+(rv(:|\s)([11]{1,}([\.]\d{1,})))/gim;var reg_safari=/^(?=.*(Safari))(?!.*(Chrome|CriOS)).*$/gim;var reg_safariExclude=/^(?=.*windows).*$/gim;if(reg_opera.test(navigator.userAgent)||reg_firefox.test(navigator.userAgent)||reg_chrome.test(navigator.userAgent)||reg_ie9.test(navigator.userAgent)||reg_ie10.test(navigator.userAgent)||reg_ie11.test(navigator.userAgent)||reg_safari.test(navigator.userAgent)&&reg_safariExclude.test(navigator.userAgent)==false){return true}else{return false}};tests["desktop_resolution"]=function(threshold){if(threshold===undefined){threshold=1260}if(screen.width>=threshold){return true}else{return screen.width+"x"+screen.height}};var integration=new LIB.Integration;integration.meta={sectionID:"124520",siteName:"Daily Motion",publisher:"dailymotion",platform:"desktop"};integration.async=false;integration.disableTelemetry=true;integration.testParams={desktop_resolution:[1230]};integration.params={plr_ContentType:"PAGESKINEXPRESS",plr_ContentW:970,plr_AnchorParent:"#topwrapper",plr_HideElementsByID:"[id^=div-gpt-ad-], player_container",plr_UseCreativeSettings:true,plr_UseFullVersion:true};integration.on("adCallResult",function(e){if(e.data.hasSkin){$("#ticker").hide();$("#footer_centered").css({paddingRight:"0px"});$("#footer, .sd_footer").css({"max-width":"970px",left:"50%","margin-left":"-485px"});if(window.location.pathname.indexOf("/video/")!=-1){$("#wrapper").css({"max-width":"1130px"});$("#content").css({"margin-left":"10px"});$("#footer, .sd_footer").css({"max-width":"1140px",left:"50%","margin-left":"-570px"});integration.base.setCfg({plr_ContentW:1140});$(".sd_header__navigation").on("click",function(){if($(window).width()>1230){if($(".sd_header__navigation").hasClass("active")){$(".ism-frame").parent().animate({left:"130px"},300);$("#wrapper").css({"max-width":"1360px"});$("#footer, .sd_footer").css({left:"57%"})}else{$(".ism-frame").parent().animate({left:"0px"},300);$("#wrapper").css({"max-width":"1130px"});$("#footer, .sd_footer").css({left:"50%"})}}})}else{$(".sd_header__navigation").on("click",integration.custom.SideBarSlide)}footerheight=$("#footer").height();if(footerheight<200){integration.custom.InSkinTopNav();$(document).scroll(function(){integration.custom.InSkinTopNav()})}}});integration.on("adServed",function(e){integration.custom.SideBarSlide()});integration.custom.InSkinTopNav=function(){var scrollPos=$(document).height()-($(document).scrollTop()+$(window).height());if(scrollPos<=90){var toAdd=90-scrollPos;if(toAdd<0){toAdd=0}$("#footer").css("marginBottom",toAdd+"px")}else{$("#footer").css("marginBottom","0px")}};integration.custom.SideBarSlide=function(){if($(window).width()>1230){if($(".sd_header__navigation").hasClass("active")){$(".ism-frame").parent().animate({left:"130px"},100);$("#footer, .sd_footer").css({left:"57%"})}else{$(".ism-frame").parent().animate({left:"0px"},100);$("#footer, .sd_footer").css({left:"50%"})}}};if(ns.loadedPublisherScripts[integration.id]){integration.telemetry.recordCustom("adtag-already-loaded");return}ns.loadedPublisherScripts[integration.id]=true;integration.once("parametersSet",function(e){if(this.params.plr_ImpressionURL){util.loadURL(this.params.plr_ImpressionURL)}});integration.init()})(window.parent,window);