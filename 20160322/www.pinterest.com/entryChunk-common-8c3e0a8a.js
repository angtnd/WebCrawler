webpackJsonp([54],[function(t,e,i){function n(t){return JSON.parse(t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"))}function s(t){if(t.user=JSON.parse(JSON.stringify(t.context.user)),t.userExtraData)for(_ in t.userExtraData)t.user[_]=t.userExtraData[_]}function o(t){if(t._dv){var e=t._dv,i=t._cf;delete t._dv,delete t._cf;for(var n in e)e[n]=JSON.stringify(e[n]);var s=function(t){if("[object Array]"===Object.prototype.toString.call(t))for(var n=0;n<t.length;n++)"object"==typeof t[n]&&t[n]&&t[n]._did?t[n]=JSON.parse(e[t[n]._did]):s(t[n]);else{for(var o in t)"object"==typeof t[o]&&t[o]&&-1!==i.indexOf(o)&&s(t[o]);t.data&&"object"==typeof t.data&&t.data._did&&(t.data=JSON.parse(e[t.data._did]))}};s(t)}}var a=window.Pw={},r=function(t){i(86),i(110),t()};a.loadTemplates=function(t){i.e(51,function(){i(1161),t()})};var l=Pc.locale?Pc.locale:"en-US";l=l.replace("-","_");var h=i(952)("./"+l+"/index.js"),d=function(){var t=i(39),e=i(1164);t.register(e)};if(a.loadEverything=function(t){d(),r(function(){h(function(e){var n=i(14);n.setLocaleCode(Pc.locale),n.__addLocaleData(e),t()})})},void 0!==document){if(void 0===P.startArgs){var c=document.getElementById("jsInit1");if(c){P.startArgs=n(c.textContent);var u=document.getElementById("jsInit2");if(u){var p=JSON.parse(u.textContent);for(var _ in p)P.startArgs[_]=p[_];u.innerHTML=""}o(P.startArgs),s(P.startArgs),c.innerHTML=""}}var g=document.getElementById("staticFileUrls");g&&(P.staticFileUrls.add(JSON.parse(g.textContent)),g.innerHTML="")}a.loadEverything(function(){i(1158).start(P.startArgs)})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){i(111),i(112),i(113),i(114),i(118),i(119),i(122),i(123),i(124),i(251),i(252),i(253),i(255),i(256),i(257),i(259),i(260),i(261),i(262),i(263),i(264),i(310),i(313),i(332),i(333),i(334),i(335),i(336),i(338),i(363),i(364),i(365),i(366),i(367),i(368),i(370),i(371),i(372),i(373),i(374),i(375),i(376),i(377),i(378),i(379),i(380),i(381),i(387),i(388),i(389),i(390),i(391),i(392),i(393),i(394),i(396),i(397),i(398),i(399),i(400),i(401),i(402),i(404),i(407),i(408),i(409),i(411),i(412),i(413),i(414),i(415),i(416),i(417),i(418),i(419),i(420),i(421),i(422),i(423),i(424),i(425),i(426),i(427),i(428),i(429),i(430),i(431),i(432),i(433),i(434),i(435),i(436),i(437),i(438),i(439),i(440),i(441),i(442),i(443),i(444),i(445),i(446),i(451),i(452),i(453),i(455),i(456),i(457),i(458),i(459),i(460),i(463),i(464),i(465),i(470),i(473),i(474),i(475),i(476),i(477),i(478),i(479),i(487),i(488),i(489),i(490),i(493),i(494),i(495),i(496),i(497),i(498),i(500),i(501),i(502),i(503),i(504),i(505),i(507),i(508),i(510),i(511),i(512),i(513),i(514),i(515),i(516),i(521),i(522),i(523),i(530),i(531),i(532),i(533),i(534),i(535),i(536),i(537),i(538),i(539),i(540),i(541),i(542),i(543),i(544),i(545),i(569),i(572),i(573),i(574),i(575),i(579),i(582),i(586),i(589),i(590),i(594),i(596),i(597),i(598),i(599),i(600),i(601),i(602),i(604),i(605),i(607),i(609),i(611),i(612),i(613),i(614),i(616),i(617),i(618),i(620),i(621),i(622),i(624),i(628),i(629),i(631),i(632),i(633),i(635),i(636),i(637),i(638),i(639),i(643),i(644),i(646),i(647),i(648),i(651),i(652),i(655),i(657),i(658),i(659),i(660),i(663),i(664),i(667),i(668),i(669),i(677),i(678),i(680),i(681),i(687),i(688),i(689),i(690),i(691),i(693),i(694),i(695),i(696),i(704),i(705),i(707),i(708),i(709),i(710),i(711),i(712),i(713),i(714),i(715),i(716),i(717),i(718),i(719),i(727),i(728),i(731),i(732),i(733),i(734),i(736),i(737),i(738),i(739),i(741),i(742),i(746),i(747)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="Echo",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="PintreeEst",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="AppealConfirmationPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(115),a=i(50),r=i(18),l=i(8),h=i(104);i(116),i(117);var d=a.extend({onContentReady:function c(){var t={email:[h.Email({}),h.Required()],type:[h.Required()]},e={prevalidate:!0};this.$form=this.$("form"),this.form=new o(this.$form,t,e),this.formListener&&this.removeListener(this.formListener),this.formListener=this.listen(this.form,n.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function u(t){t.errors[0]||this.submitAppeal()},submitAppeal:function p(){var t=this.getChildById("submitButton");t.showLoading();var e=this.form.getData(),i=l.create("AppealResource",e);i.options=e,i.callCreate({showError:!0}).then(function(){t.hideLoading();var e={name:"ConfirmDialog",options:{template:"appeal"}};r.load(e).then(function(t){this.showInModal(t)}.bind(this))}.bind(this)).fin(function(){t.hideLoading()})}});d.prototype.className="AppealForm",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(3),a=i(11),r=i(9),l=i(35),h=i(16),d=i(104),c=h.getLogger("Form"),u="hasError",p="hasWarning",_="disabled",g="[type=submit]",m=["button","file","image","reset","submit"],f=100,C=function E(t,e,i){i=i||{},this.$el=t,this.validators={},this.errorFields={},this.warningFields={},this.fastValidateFields={},this.hideErrors=!!i.hideErrors,this.prevalidating=!!i.prevalidate,this.disableAutoValidation=!!i.disableAutoValidation,this.onFieldBlur=this.onFieldBlur.bind(this),this.onFieldChange=this.onFieldChange.bind(this),this.onFieldKeyup=this.onFieldKeyup.bind(this),this.onFieldValidated=this.onFieldValidated.bind(this),this.onSubmit=this.onSubmit.bind(this),n.each(e,function(t,e){var i=this.getField(e);if(i[0]){var n=new d.Validator(i,t);this.validators[e]=n,n.on(d.EVENT_VALIDATED,this.onFieldValidated),i.on("blur",this.onFieldBlur),i.on("change",this.onFieldChange),i.on("keyup",this.onFieldKeyup)}else c.debug(e+" wasn't found in the form")}.bind(this)),this.prevalidating&&this.validate(function(){this.prevalidating=!1}.bind(this)),t.submit(this.onSubmit),t.find("[placeholder]").placeholder()};n.extend(C.prototype,o.Events),n.extend(C.prototype,{validate:function v(t){return d.createValidatorPromise(this,this.validators,function(t){return t.validate()},t)},getField:function I(t){var e=this.$el.find("[name="+t+"]");return"radio"===e.attr("type")&&(e=this.$el.find("[name="+t+"]:checked")),e},getFieldLabels:function T(t){var e=t.attr("id"),i=this.$el.find('label[for="'+e+'"]'),n=t.closest("label",this.$el);return i.add(n)},validateField:function N(t,e){var i=t.attr("name");return this.validators[i].validate(e)},getValue:function S(t){var e=this.getField(t);return"checkbox"===e.attr("type")?e.is(":checked"):e.val()},getSubmitButtons:function b(){return this.$el.find(g)},disableSubmitButtons:function y(){this.getSubmitButtons().prop(_,!0).addClass(_)},enableSubmitButtons:function P(){this.getSubmitButtons().not(".loading").prop(_,!1).removeClass(_)},hasErrors:function B(t){return!(!n.find(this.errorFields,function(t){return t})&&!this.$el.find("."+u)[0])},hasWarnings:function A(t){return!(!n.find(this.warningFields,function(t){return t})&&!this.$el.find("."+p)[0])},setFieldErrorsAndWarnings:function R(t,e,i){this.clearFieldErrorAndWarningMessages(t);var n=!!e[0],s=!!i[0];if(this.errorFields[t.attr("name")]=n,this.warningFields[t.attr("name")]=s,!this.prevalidating&&!this.hideErrors){var o=this.getFieldLabels(t),a=o.add(t);a.toggleClass(u,n),a.toggleClass(p,s),this.appendFieldErrorMessages(t,e),this.appendFieldWarningMessages(t,i)}},appendFieldErrorMessages:function w(t,e){e&&e.length&&t.parent().children().last().after('<p class="formFieldMessage formErrorMessage">'+e.join(" ")+"</p>")},appendFieldWarningMessages:function O(t,e){e&&e.length&&t.parent().children().last().after('<p class="formFieldMessage formWarningMessage">'+e.join(" ")+"</p>")},clearFieldErrorAndWarningMessages:function D(t){t.nextAll(".formErrorMessage, .formWarningMessage").remove()},clearAllErrorAndWarning:function x(){var t=n.keys(this.errorFields),e=n.keys(this.warningFields),i=n.uniq(n.union(t,e)),s;n.each(i,function(t){(this.errorFields[t]||this.warningFields[t])&&(s=this.getField(t),this.setFieldErrorsAndWarnings(s,[],[]))}.bind(this))},enableFastValidateOnField:function L(t){this.fastValidateFields[t]=1},onSubmit:function k(t){return t.preventDefault(),t.stopPropagation(),this.trigger("submitStarted",this.$el),this.validate(function(t,e){this.trigger(a.EVENT_SUBMIT_VALIDATED,t,e)}.bind(this))},onFieldValidated:function U(t){var e=t.$el,i=t.errors,n=t.warnings;(i[0]||n[0])&&this.enableFastValidateOnField(e.attr("name")),this.setFieldErrorsAndWarnings(e,i,n),this.hasErrors()?this.disableSubmitButtons():this.enableSubmitButtons()},onFieldKeyup:function M(t){if(t.keyCode!==a.KeyCode.TAB){var e=s(t.target);this.fastValidateFields[e.attr("name")]&&!this.disableAutoValidation&&this.validateField(e)}},onFieldBlur:function F(t){if(!this.disableAutoValidation){var e=s(t.target);n.delay(function(){this.validateField(e)}.bind(this),f)}},onFieldChange:function $(t){if(!this.disableAutoValidation){var e=s(t.target);this.validateField(e)}},getData:function H(t){for(var e=this.$el.find("input,select,textarea"),i=e.length,o,a,r={},l,h,d,c=0;i>c;++c)o=s(e[c]),l=o.attr("name"),void 0===l||!t&&o.is(":disabled")||(a=o.attr("type"),n.contains(m,a)||"radio"===a&&!o.is(":checked")||(h="checkbox"===a?o.is(":checked"):o.val(),n.has(r,l)?(d=r[l],n.isArray(d)||(d=[d],r[l]=d),d.push(h)):r[l]=h));return r}}),l.wrap(C.prototype,["onSubmit"]),t.exports=r.expose("Form",C)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(79),l={ATTR_DISABLED:"disabled",SELECTOR_BUTTON_TEXT:".buttonText",SELECTOR_BUTTON_BADGE:".buttonBadge",SELECTOR_ACCESSIBILITY_TEXT:".accessibilityText"},h=a.extend({events:{click:"onClick"},CssClassName:{ACTIVE:"active",BADGED:"badged",DISABLED:"disabled",HIGHLIGHTED:"highlighted",SELECTED:"selected"},onContentReady:function d(){this.options.state_badgeValue="",this.options.state_accessibilityText=this.options.text,this.options.state_disabled=this.options.disabled},onClick:function c(t){return t&&this.isDisabled()?(t.preventDefault(),!1):void this.triggerEvent(s.EVENT_BUTTON_CLICK,null,!0)},disable:function u(){this.updateOptionsAndDom({state_disabled:!0})},enable:function p(){this.updateOptionsAndDom({state_disabled:!1})},setEnabled:function _(t){t?this.enable():this.disable()},setHighlight:function g(t){this.updateOptionsAndDom({is_highlighted:t})},isDisabled:function m(){return this.$el.is(":disabled")},isCancelButton:function f(){return this.options.cancelButton},isSegmentedControlButton:function C(){return this.options.segmented_control_button},getText:function E(){var t=this.$(l.SELECTOR_BUTTON_TEXT).text();return t.trim()},setText:function v(t){this.updateOptionsAndDom({state_buttonText:t.trim()})},setAccessibilityText:function I(t){this.updateOptionsAndDom({state_accessibilityText:t.trim()})},getLoadingSpinnerOptions:function T(){return n.extend(a.prototype.getLoadingSpinnerOptions.call(this),{size:r.Size.SMALL})},setBadge:function N(t){this.updateOptionsAndDom({state_badgeValue:String(t).trim()})},getBadgeCount:function S(){var t=this.options.state_badgeValue;return t&&void 0!==t||(t=0),parseInt(t,10)},clearBadge:function b(){this.updateOptionsAndDom({state_badgeValue:""})},setBadgeCount:function y(t){0>=t?this.clearBadge():this.setBadge(t)},setActive:function P(t){this.updateOptionsAndDom({is_active:t})},setSelected:function B(t){this.updateOptionsAndDom({is_selected:t})},isSelected:function A(){return!!this.options.is_selected},updateDom:function R(){this.$el.toggleClass(this.CssClassName.ACTIVE,!!this.options.is_active),this.$el.toggleClass(this.CssClassName.SELECTED,!!this.options.is_selected),this.$el.toggleClass(this.CssClassName.HIGHLIGHTED,!!this.options.is_highlighted),this.$(l.SELECTOR_BUTTON_BADGE).text(this.options.state_badgeValue),this.$el.toggleClass(this.CssClassName.BADGED,!!this.options.state_badgeValue),this.$(l.SELECTOR_ACCESSIBILITY_TEXT).text(this.options.state_accessibilityText),this.options.state_disabled?this.$el.attr(l.ATTR_DISABLED,!0):this.$el.removeAttr(l.ATTR_DISABLED),this.$el.toggleClass(this.CssClassName.DISABLED,!!this.options.state_disabled),this.$(l.SELECTOR_BUTTON_TEXT).text(this.options.state_buttonText)},isActive:function w(){return!!this.options.is_active},_shouldShowSpinner:function O(){var t=this.options.show_spinner;return void 0!==t?t:this.options.borderless&&this.options.show_text===!1?!1:!0},showLoading:function D(){this.disable(),this._shouldShowSpinner()&&a.prototype.showLoading.call(this)},hideLoading:function x(){this.enable(),this._shouldShowSpinner()&&a.prototype.hideLoading.call(this)},getLoggingObjectIdStr:function L(){return this.parent?this.parent.getLoggingObjectIdStr():null},_getLabelModule:function k(){return this.getChildById("label")}});h.prototype.className="Button",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="Select",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="BoardPickerSpinnerBlock",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50);i(120),i(121);var r=a.extend({onContentReady:function l(){this.childListen(s.EVENT_CHANGE,this.onInputChange),this.checkboxModules=this.getChildrenByModuleName("Checkbox");var t={};n.each(this.options.items,function(e){var i=e.name;t[i]={name:i,label:e.label}}),this._checkboxes=t},onInputChange:function h(t){t.stopPropagation(),this.triggerEvent(s.EVENT_CHANGE,null,!0)},getValue:function d(){var t=[],e=this._checkboxes,i=0;return n.each(this.checkboxModules,function(n){var s=n.getCheckboxName();n.isChecked()&&(t[i++]={name:s,label:e[s].label})}),t}});r.prototype.className="CheckboxGroup",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50);i(120);var r="checked",l=a.extend({CssClassName:{IS_DISABLED:"disabled",IS_ON:"on"},onContentReady:function h(){this.$input=this.$el,this.options.state_checked=this.options.checked||!1,this.options.state_disabled=this.options.disabled||!1,"fancyToggle"===this.options.view_type||"fancyCheckbox"===this.options.view_type||"flatToggle"===this.options.view_type?(this.$input=this.$("input"),this.$el.on("click",this.onFancyToggleCheckboxClick.bind(this))):this.$el.on("change",this.toggle.bind(this)),this.options.disabled===!0&&this.setDisabled(!0)},onFancyToggleCheckboxClick:function d(t){var e=n(t.currentTarget).parent()[0].tagName,i="label"===e.toLowerCase(),s=!i||i&&n(t.target).is(":checkbox");s&&this.toggle()},toggle:function c(){this.setChecked(!this.options.checked,!0)},setChecked:function u(t,e){void 0===e&&(e=!0),t===this.options.checked||this.options.disabled||(this.updateOptionsAndDom({state_checked:t}),this.options.checked=t,e&&this.triggerEvent(s.EVENT_CHANGE,{checked:t},!0))},updateDom:function p(){this.$el.toggleClass(this.CssClassName.IS_ON,this.options.state_checked),this.$input.prop(r,this.options.state_checked),this.$el.toggleClass(this.CssClassName.IS_DISABLED,this.options.state_disabled),this.$input.prop(this.CssClassName.IS_DISABLED,this.options.state_disabled)},setDisabled:function _(t,e){void 0===e&&(e=!0),void 0!==this.$input&&(this.updateOptionsAndDom({state_disabled:t}),e&&this.triggerEvent(s.EVENT_CHANGE,{disabled:t},!0))},isChecked:function g(){return!!this.options.checked},getCheckboxName:function m(){return this.options.name},disable:function f(){this.setDisabled(!0)}});l.prototype.className="Checkbox",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="FormItemGroup",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="Collage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="GridReactWrapper",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(125);var o=n.extend({});o.prototype.className="HelpMenu",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(62),l=i(126);i(128),i(143),i(146),i(147),i(149),i(150),i(247);var h=4,d=a.extend({events:{"click li":"onItemClick"},onCreated:function c(){this.options.is_scrollable&&(this.itemsViewed=0,this.scrollTop=0,this.viewableHeight=null)},onContentReady:function u(){this.options.is_scrollable&&(this.setPageSize(this._getPageSize()),this.scrollableElement=this.getScrollableElement(),this._setScrollListener())},onAddedToDom:function p(){this.options.is_scrollable&&this.isReady()&&this._onViewUpdate()},_getPageSize:function _(){return 0},_getScrollThrottleDelay:function g(){return s.SCROLL_THROTTLE_DELAY_DEFAULT},_getScrollBuffer:function m(){return h},_onViewUpdate:function f(){this._needsMoreItems()&&this._requestMoreItems()},isReady:function C(){return this.inDom&&this.contentReady},_setScrollListener:function E(){var t=n.throttle(this._onViewUpdate,this._getScrollThrottleDelay());this.listen(this.scrollableElement,s.EVENT_SCROLL,t)},_computeHeightAndScrollPositions:function v(){this.viewableHeight=l.height,this.scrollBottom=this.scrollableElement.scrollTop()+this.viewableHeight,this.offsetFromScrollElement=this.$el.positionAncestor(this.scrollableElement).top},_getFilledHeight:function I(){return this.$el.height()},_needsMoreItems:function T(){if(this.isReady()&&!this.pendingMoreRequest&&this.hasMoreItems()){this._computeHeightAndScrollPositions();var t=this.offsetFromScrollElement+this._getFilledHeight(),e=this.viewableHeight/this._getScrollBuffer(),i=t-this.scrollBottom-e;return i<this.viewableHeight}},onItemClick:function N(t){this.triggerEvent(s.EVENT_LIST_ITEM_CLICK,t.target,!1)},onChildRemoved:function S(t,e){e.remove()},hasMoreItems:function b(){return this.resource&&!this.resource.atEnd()},requestMoreItems:function y(){this._requestMoreItems()},_requestMoreItems:function P(t){this.pendingMoreRequest||(n.isUndefined(t)&&(t=2),this.triggerEvent(s.EVENT_ITEMS_REQUEST_START,null,!0),this.pendingMoreRequest=!0,this.renderAdditional(r.APPEND).then(function(){this.pendingMoreRequest=!1,this.triggerEvent(s.EVENT_ITEMS_REQUEST_SUCCESS,null,!0)}.bind(this),function(){t>0&&this._requestMoreItems(t-1),this.triggerEvent(s.EVENT_ITEMS_REQUEST_ERROR,null,!0)}.bind(this)))},setPageSize:function B(t){this.resource&&this.resource.set("page_size",t)}});d.prototype.className="List",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(3),a=i(11),r=i(127),l=function d(){this.height=0,this.width=0};n.extend(l.prototype,{init:function c(){this.on(a.EVENT_RESIZE,this._onResize,this),s(window).on("resize",n.debounce(this._cacheWindowSize.bind(this),200)),this._cacheWindowSize(),this.updateBodyColumns()},_cacheWindowSize:function u(){var t=s(window),e=t.height(),i=t.width();(e!==this.height||i!==this.width)&&(this.height=e,this.width=i,this.trigger(a.EVENT_RESIZE))},_onResize:function p(){this.updateBodyColumns()},updateBodyColumns:function _(){this.setBodyColumns(r.getBodyColumnsNeeded())},setBodyColumns:function g(t){t!==this.numColumns&&(this.numColumns=t,r.setNumColumns(t),this.trigger(a.EVENT_BODY_COLUMN_CHANGE))}});var h=new l;n.extend(h,o.Events),t.exports=h},function(t,e,i){"use strict";var n=i(30),s={getBodyWidth:function o(){return document.documentElement.clientWidth||window.innerWidth},getBodyColumnsNeeded:function a(){var t=n.siteConst.PIN_WIDTH+n.siteConst.PIN_MARGIN,e=s.getBodyWidth();return Math.min(Math.max(Math.floor(e/t),n.siteConst.MIN_COLUMNS),n.siteConst.MAX_COLUMNS)},setNumColumns:function r(t){var e=document.documentElement,i;i=t?t:s.getBodyColumnsNeeded();var n=e.className,o=n.replace(/ columns-\d+/,""),a=" columns-"+i,r=o+a;e.className=r}};t.exports=s},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(79);i(116),i(129),i(130),i(136),i(137);var l="followFriendsItem",h="gridItem",d="homefeedBuilderView",c=a.extend({events:{"click .dismiss":"onDismissClick",click:"onClick"},CssClassName:{CONTACT_CONFIRMED:"contactConfirmed",IS_CHECKED:"checked",HIDDEN:"hidden",VISIBLE:"visible"},getLoadingSpinnerOptions:function u(){var t=a.prototype.getLoadingSpinnerOptions.call(this);return this.options.view_type===l?n.extend(t,{size:r.Size.SMALL}):t},getProfileImage:function p(){var t;switch(this.options&&this.options.view_type){case"userSelect":t=this.$(".profileImage");break;default:return}return t.attr("src")},updateDom:function _(){if("userCheckableSelectView"===this.options.view_type&&this.$(".selectCheck").toggleClass("this.CssClassName.IS_CHECKED",this.options.state_isChecked),this.options.view_type===l&&this.$el.toggleClass(this.CssClassName.CONTACT_CONFIRMED,this.options.state_contactConfirmed),this.options.view_type===d&&this.$(".followMask").toggleClass(this.CssClassName.VISIBLE,this.options.state_userFollowed),this.options.state_isShownOverflowMask){var t=this.$(".overflowMask");if(t&&this.options.state_overflowMaskText){var e=t.find(".text");e&&e.text(this.options.state_overflowMaskText)}t.show(),this.$(".profile").css("box-shadow","none")}},onContentReady:function g(){this.options.state_userFollowed=!1;var t={};t[s.PUBSUB_TOPIC_USER_FOLLOW]=this.onUserFollow,t[s.PUBSUB_TOPIC_USER_UNFOLLOW]=this.onUserUnfollow;var e=this.getUserId();this.pubsubSubscribe(e,t),this.options.state_contactConfirmed=this.options.view_type===l?!1:!0,this.options.state_isChecked=!!this.options.is_checked,this.options.state_isShownOverflowMask=!1,this.options.state_overflowMaskText="..."},onUserFollow:function m(t){this.updateOptionsAndDom({state_contactConfirmed:!0,state_userFollowed:!0}),this.triggerEvent(s.EVENT_USER_FOLLOW,null,!0),this.updateFollowCounts()},onUserUnfollow:function f(t){this.updateOptionsAndDom({state_userFollowed:!1}),this.triggerEvent(s.EVENT_USER_UNFOLLOW,null,!0),this.updateFollowCounts()},updateFollowCounts:function C(){this.options.view_type&&this.options.view_type!==h||this.render()},onDismissClick:function E(){this.triggerEvent(s.EVENT_DISMISS,null,!0)},getUserId:function v(){return this.data&&this.data.id},setChecked:function I(t){this.updateOptionsAndDom({state_isChecked:t})},isChecked:function T(){return"userCheckableSelectView"===this.options.view_type?this.options.state_isChecked:!1},showOverflowMask:function N(t){this.updateOptionsAndDom({state_isShownOverflowMask:!0,state_overflowMaskText:t})},onClick:function S(t){if("userSelect"===this.options.view_type&&this.triggerEvent(s.EVENT_USER_CLICK,null,!0),"userCheckableSelectView"===this.options.view_type){this.updateOptionsAndDom({state_isChecked:!this.options.state_isChecked});var e={user_id:this.getUserId(),is_following:this.options.state_isChecked};this.triggerEvent(s.EVENT_USER_CLICK,e,!0)}}});c.prototype.className="User",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({onContentReady:function r(){this.updateDom()},updateDom:function l(){var t=this.$el.find("img");if(this.options.lazy_load&&t.attr("src",this.options.src),this.options.error_notification)switch(t.data("load-state")){case"pending":t.on("error",function(){this._onImageError()}.bind(this));break;case"error":this._onImageError()}},_onImageError:function h(){this.triggerEvent(n.EVENT_IMAGE_LOAD_ERROR,null,!0)}});a.prototype.className="Image",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(29),r=i(131),l=i(31),h=i(27),d=n.extend({CssClassName:n.prototype.CssClassName,getNavigateUrl:function c(t){return this.options.url},onClick:function u(t){this.options.ga_category&&a.trackEvent(this.options.ga_category,o.GA_ACTION_CLICK),this._logContextEvent(t),t.stopPropagation(),t.preventDefault();var e=this.getNavigateUrl();if(e&&-1!==e.indexOf("/login")&&"home_page"!==h.getInitModuleName()&&"login_page"!==h.getInitModuleName()&&"landing_page_analytics"!==h.getInitModuleName())return r.showInlineSignupModalOnButtonClick("LoginButton");if(e&&-1!==e.indexOf("/login")&&(e=l.appendQueryString(e,{referrer:h.getInitModuleName()})),n.prototype.onClick.call(this,t),this.options.force_refresh===o.GEN.ForceRefreshType.PAGE)return void h.changeWindowLocation(e,!1);var i={useNewTab:this.options.use_new_tab};this.options.csr_id?i.csrId=this.options.csr_id:this.options.safe_link_pin_id&&(i.pinId=this.options.safe_link_pin_id),this.navigate(e,this.$el,this.options.force_refresh,i)},getLoggingObjectIdStr:function p(){return this.options.log_obj_id?this.options.log_obj_id:n.prototype.getLoggingObjectIdStr.call(this)}});d.prototype.className="NavigateButton",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(21),o=i(11),a=i(132),r=i(40),l=i(14),h=i(23),d={modalsEnabled:!0,dismissible:!1,wasDismissed:!1};d.disableModals=function(){d.modalsEnabled=!1},d.naggingAllowed=function(){return s.get(o.COOKIE_GIFT_WRAP_DISABLED)?!1:!this.dismissible||!(this.wasDismissed||"1"===s.get(o.COOKIE_SIGNUP_WAS_DISMISSED))},d.notifyWasDismissed=function(){this.wasDismissed=!0,"1"!==s.get(o.COOKIE_SIGNUP_WAS_DISMISSED)&&s.set(o.COOKIE_SIGNUP_WAS_DISMISSED,"1",12)},d.ENTICING_CATEGORIES=["food_drink"],d.showInlineSignupModalOnButtonClick=function(t){var e={LikeButton:l._("Sign up to get more details about this Pin"),ShowModalButton:l._("Sign up to get more details about this Pin"),ContinueButton:l._("Sign up for free!"),InterestFollowButton:l._("Sign up to see more Pins"),UserFollowButton:l._("Sign up to get more details about this Pinner"),BoardFollowButton:l._("Sign up to get more details about this board"),ContinueSignupButton:l._("Sign up to see more Pins"),SignupButton:l._("Sign up to see more Pins"),LoginButton:l._("Log in to see more Pins"),WebResult:l._("To save ideas for later, create an account")},i={extra_class:"redesign",can_dismiss:this.dismissible,dismiss_on_mask:this.dismissible,prev:window.location.pathname,next:window.location.pathname};"LoginButton"===t&&(i.login=!0),["InterestFollowButton","UserFollowButton","BoardFollowButton"].indexOf(t)>-1&&(i.auto_follow=!0);var n=e[t];n&&(i.tagline=e[t],h.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_HIDE_UNAUTH_BANNER),a.showSignupModal("PlainSignupModal",null,i))},d.showInlineSignupModal=function(t,e){var i=!1;if(this.naggingAllowed()){var h=s.get(o.COOKIE_SEND_PIN_UNAUTH_BROWSING_ALLOWANCE);(h&&parseInt(h,10)>0||s.get(o.COOKIE_GIFT_WRAP_HOLDOUT))&&(i=!0)}else i=!0;var d=l._("Sign up to see more Pins"),c={BoardPage:l._("Sign up to get more details about this board"),UserProfilePage:l._("Sign up to get more details about this Pinner"),DomainFeedPage:l._("Sign up to see more Pins from this website"),Closeup:l._("Sign up to get more details about this Pin"),PaddedPin:l._("Sign up to get more details about this Pin"),SearchPage:d,InterestFeedPage:d,CategoriesPage:d,FeedPage:d},u=["Closeup","PaddedPin"],p={extra_class:"redesign",can_dismiss:this.dismissible,dismiss_on_mask:this.dismissible,prev:window.location.pathname,next:window.location.pathname},_=c[t.className];_&&!i&&(p.tagline=_,n.contains(u,t.className)&&!r.instance.is_mobile_agent?(e.options.bookmarks&&delete e.options.bookmarks,e.callGet({showError:!1}).then(function(t){a.showSignupModal("CloseupSignupModal",e,p)})):a.showSignupModal("PlainSignupModal",null,p))},t.exports=d},function(t,e,i){"use strict";var n=i(21),s=i(1),o=i(11),a=i(133),r=i(40),l=i(80),h=i(81),d=i(35),c=i(47),u=i(29),p=i(16),_=i(135),g=i(18),m=i(23),f=i(8),C=i(54),E=i(31),v=i(46),I=i(27),T=p.getLogger("UserRegistration"),N=0,S={fastTrackSocialRegistration:function b(t,e){if(t===a.FACEBOOK)return S.fetchNetworkData(t).then(function(t){return t.email?S.sendImmediateFbRegisterRequest(t,e):Promise.reject(new d.NoEmailProvidedError)});if(t===a.RAKUTEN){var i={rakuten_id:C.sessionStorage.getItem(o.SESSION_RAKUTEN_ID),rakuten_token:C.sessionStorage.getItem(o.SESSION_RAKUTEN_TOKEN),rakuten_refresh_token:C.sessionStorage.getItem(o.SESSION_RAKUTEN_REFRESH_TOKEN),first_name:C.sessionStorage.getItem(o.SESSION_RAKUTEN_FIRST_NAME),email:C.sessionStorage.getItem(o.SESSION_RAKUTEN_EMAIL),gender:C.sessionStorage.getItem(o.SESSION_RAKUTEN_GENDER),country:null};return"rakuten"===E.getQueryStringParams().cmp&&(i.follow_rakuten=!0),S.register(a.RAKUTEN,i)}return Promise.resolve(void 0)},sendImmediateFbRegisterRequest:function y(t,e){var i={first_name:t.first_name,last_name:t.last_name,email:t.email,gender:t.gender,image_url:t.image_url,facebook_id:t.id,facebook_token:t.access_token,country:null};return e&&s.extend(i,e),S.addExtraSocialParams(a.FACEBOOK,i),S.register(a.FACEBOOK,i)},addExtraSocialParams:function P(t,e){var i=C.sessionStorage.getItem(o.SESSION_FACEBOOK_ID),n=C.sessionStorage.getItem(o.SESSION_FACEBOOK_TOKEN);i&&(e.facebook_id||(e.facebook_id=i),C.sessionStorage.removeItem(o.SESSION_FACEBOOK_ID)),n&&(e.facebook_token||(e.facebook_token=n),C.sessionStorage.removeItem(o.SESSION_FACEBOOK_TOKEN));var s=C.sessionStorage.getItem(o.SESSION_KEY_INVITE_FOLLOW);s&&(s.invite_follow_board&&(e.board_to_follow=s.invite_follow_board),s.invite_follow_user&&(e.user_to_follow=s.invite_follow_user))},fetchNetworkData:function B(t){return t===a.FACEBOOK?(I.trackRegisterAction("register_facebook"),new Promise(function(t,e){c.ensureInit(function(i){i.getLoginStatus(function(n){if(n.authResponse){var s=["picture.type(large)","id","first_name","last_name","email","gender"],o="/me?fields="+s.join(",");i.api(o,function(i){i&&!i.error?(i.picture&&i.picture.data&&i.picture.data.url&&!i.picture.data.is_silhouette&&(i.image_url=i.picture.data.url),t(i)):e(new Error("FB.api errored: "+i.error))})}else e(new Error("not authed"))},!0)},v)})):Promise.reject(new Error("Unsupported social network: "+t))},register:function A(t,e){var i=C.localStorage.getItem(o.LOCALSTORAGE_VISITED_PAGES);i&&(e.visited_pages=JSON.stringify(i));var a=S.getResource(e);return a.callCreate().then(function(t){u.trackEvent("user_signup",o.GA_ACTION_SUCCESS),C.sessionStorage.removeItem(o.SESSION_KEY_INVITE_FOLLOW),T.debug("Login, successful",t),n.set(o.COOKIE_USER_JUST_REGISTERED,"1"),S.trackRegister(e)},function(i){u.trackEvent("user_signup",o.GA_ACTION_ERROR),i.api_error_code===o.API_ERROR_UNDERAGE_REGISTER_ATTEMPT&&(I.trackRegisterAction("multi_step_set_age_restrict_cookie"),n.set(o.COOKIE_REGISTER_RESTRICT,"1",87600),n.set(o.COOKIE_PERSONALIZE_FROM_OFFSITE_BROWSING_COOKIE_NAME,"disabled"));var a=s.isEmpty(i.api_error_code)||s.contains([o.API_SERVER_ERROR,o.API_REQUEST_TIMEOUT],i.api_error_code);if(a&&3>N)return N++,S.register(t,e);throw i})},trackRegister:function R(t){var e;switch(t.container){case"home_page":e=l.fromEventType(o.GEN.EventType.HOME_PAGE_SIGNUP),I.trackRegisterAction("signup_home_page");break;case"plain_signup_modal":e=l.fromEventType(o.GEN.EventType.PLAIN_MODAL_SIGNUP),I.trackRegisterAction("signup_plain_modal");break;case"closeup_signup_modal":e=l.fromEventType(o.GEN.EventType.CLOSEUP_MODAL_SIGNUP),I.trackRegisterAction("signup_closeup_modal");break;case"widescreen_signup_modal":e=l.fromEventType(o.GEN.EventType.WIDESCREEN_MODAL_SIGNUP),I.trackRegisterAction("signup_widescreen_modal");break;case"pinit_button_landing":e=l.fromEventType(o.GEN.EventType.PIN_IT_BUTTON_LANDING_SIGNUP),I.trackRegisterAction("signup_pinit_button_landing");break;case"inspired_banner":I.trackRegisterAction("signup_inspired_banner");break;case"send_pin_banner":e=l.fromEventType(o.GEN.EventType.SENT_PIN_LANDING_SIGNUP),I.trackRegisterAction("send_pin_banner");break;default:e=l.fromEventType(o.GEN.EventType.UNKNOWN_PLACEMENT_SIGNUP),I.trackRegisterAction("signup_unknown_placement")}e&&h.getInstance().addEvent(e);var i=document.referrer,n;n=i?i.indexOf("/t.co/")>-1?"twitter":i.indexOf("google.")>-1?"google":i.indexOf("bing.")>-1?"bing":i.indexOf("facebook.")>-1?"facebook":"other":"direct",I.trackRegisterAction("signup_referrer."+n);var s=E.getQueryStringParams().referrer||I.getInitModuleName();I.trackRegisterAction("signup_referrer_module."+s);var a=r.instance.user_agent_platform;a===o.USER_AGENT_PLATFORM_IOS?I.trackRegisterAction("signup_mweb.iphone_web"):a===o.USER_AGENT_PLATFORM_IPAD?I.trackRegisterAction("signup_mweb.ipad_web"):a===o.USER_AGENT_PLATFORM_ANDROID&&I.trackRegisterAction("signup_mweb.android_web");
},getResource:function w(t){return f.create("UserRegisterResource",t)},showSignupModal:function O(t,e,i){var n={name:t,options:i||{}};e&&(n.resource=e),_.get().hasModals()&&_.get().removeTopModal(),g.load(n).then(function(t){_.get().createAndShowModal(t,{mask_type:"dark",modal_style:i.modal_style,can_dismiss:i.can_dismiss,dismiss_on_mask:i.dismiss_on_mask})}).fin(function(){m.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_HIDE_UNAUTH_BANNER)})}};t.exports=S},function(t,e,i){"use strict";function n(){}var s=i(1),o=i(3),a=i(134),r=i(35),l=i(47),h=i(14),d=i(34),c=i(46),u=i(9),p;s.extend(n.prototype,o.Events),s.extend(n.prototype,{connect:function _(t,e){e=s.extend({},{success:function g(){},error:function m(){},complete:function f(){}},e);var i=null,o=null;t===n.RAKUTEN&&(i=800,o=600);var u=a.getWindowOptions(i,o);if(e.rerequest_facebook_email)l.ensureInit(function(t){t.login(function(t){var i=t.authResponse,n,o;i&&(n=i.grantedScopes,n&&(n=n.split(",")),o=i.userID);var a=s.find(n,function(t){return"email"===t}),r={id:o};"connected"===t.status&&a?e.success(r):e.error(r),e.complete()},{scope:"email",auth_type:"rerequest",return_scopes:!0})},c);else{var p=window.open("/connect/"+t+"/","",u);if(!p)return r.showError(h._("You must enable popups!")),void e.error({network:t,alertedUpstream:!0});var _=d.setInterval(function(){p.closed&&(clearInterval(_),this.handleComplete({network:t,error_message:"Window closed."}))}.bind(this),1e3);this.once("connect:"+t,function(t){clearInterval(_),t.error_message?e.error(t):e.success(t),e.complete()})}},complete:function g(t){this.handleComplete(t)},handleComplete:function m(t){var e="connect:"+t.network,i=t.network;if("facebook"===i){var n=t.id;n&&"string"!=typeof n&&(t.error_message="Facebook id must be of string type")}this.trigger(e,t)}}),s.extend(n,{instance:function f(){return p||(p=new n),p},FACEBOOK:"facebook",TWITTER:"twitter",GOOGLE:"google",GPLUS:"gplus",YAHOO:"yahoo",RAKUTEN:"rakuten",MICROSOFT:"microsoft"}),window.addEventListener("message",function(t){var e=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");t.origin===e&&"social-connect-complete"===t.data.type&&n.instance().complete(t.data)}),t.exports=u.expose("SocialConnect",n)},function(t,e,i){"use strict";var n=i(1),s=i(9),o=i(40),a=i(47),r=i(8),l=i(31),h=i(46),d=20,c=580,u=400,p={open:function _(t){var e=n.pick(t,p._validParams),i=p._getDialogType(t),s=p.generateFbRef(),o=t.object_type&&t.object_id&&"feed"===i,d=l.absolutify(t.path),_=l.getQueryStringParams();if(_.ptrf&&(d=l.appendQueryString(d,{ptrf:_.ptrf})),o&&(d=l.appendQueryString(d,{fb_ref:s})),"feed"===i){var g=p.getWindowOptions(t.width||c,t.height||u);window.open("http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(d),"sharer",g)}else e.method=i,"send"===i?e.link=d:"share"===i&&(e.href=d),a.ensureInit(function(i){i.getLoginStatus(function(){i.ui(e,function(e){if(o&&e&&e.post_id){var i=r.create("LogFacebookFeedShare",{});i.options={object_type:t.object_type,object_id:t.object_id,fb_ref:s},i.callCreate({showError:!1})}t.callback&&t.callback(e)})})},h)},_validParams:["description","name","picture","to","href"],_validOptions:["send","feed","share"],generateFbRef:function g(){for(var t="";t.length<d;)t+=Math.floor(65535*Math.random()).toString(16);return(h.id||o.instance.unauth_id)+":"+t},_getDialogType:function m(t){var e=n.contains(p._validOptions,t.type),i=e?t.type:"feed";return i},getWindowOptions:function f(t,e){var i=t?t:c,n=e?e:u,s=screen.width,o=screen.height,a=Math.round((s-i)/2),r=o>n?Math.round((o-n)/2):0;return"scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+i+",height="+n+",left="+a+",top="+r}};t.exports=s.expose("FacebookDialog",p)},function(t,e){"use strict";var i=null,n={};n.get=function(){return i},n.set=function(t){i=t},t.exports=n},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="ContactTile",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(138),a=i(142),r=i(40),l=i(23),h=i(8),d=i(131),c=i(46),u=a.extend({getResourceId:function p(){return this.options.user_id},getFollowResource:function _(){return h.create("UserFollowResource",{user_id:this.getResourceId()})},getFollowClass:function g(){return this.options.follow_class},getAuthRedirectUrl:function m(){return c.isAuthenticated()?void 0:d.showInlineSignupModalOnButtonClick("UserFollowButton")},toggleState:function f(){if(a.prototype.toggleState.call(this),l.instance.publish(n.PUBSUB_CHANNEL_CURRENT_USER,this.options.followed?n.PUBSUB_TOPIC_USER_FOLLOW:n.PUBSUB_TOPIC_USER_UNFOLLOW,!0),this.options.followed&&this.options.suggested_users_menu&&!r.instance.is_mobile_agent){this._dropdown&&this._dropdown.destroy();var t={anchor:this.$el.closest(".userFollowButtonWrapper"),anchored:!0,largeCaret:!0,fixed:!0,position_point:"BOTTOM_CENTER",force_in_viewport:!0,class_name:"suggestedUsersDropdown",module:this.options.suggested_users_menu};this._dropdown=new o({options:t}),this._dropdown.initHovering(),this._dropdown.slideIn(200)}},onContentReady:function C(){this.showMemo()},getContextualResource:function E(){return h.create("UserResource",{user_id:this.getResourceId(),field_set_key:"grid_item"})}});u.prototype.className="UserFollowButton",t.exports=s.register(u)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(102),a=i(11),r=i(52),l=i(139),h=i(30),d=i(140),c=i(79),u=i(126),p=i(18),_=i(19),g=i(23),m=i(20),f="dropdownContainer",C=d.extend({events:{keyup:"_onKeyUp"},CssClassName:n.extend(d.prototype.CssClassName,{FADE_IN:"fadeIn",HIDE:"hideModule",IS_ACTIVE:"active",IS_EMPTY:"isEmpty",IS_EMPTY_WITHOUT_FRIENDS:"isEmptyWithoutFriends",MODAL:"Modal",SLIDE_IN:"slideIn"}),_onKeyUp:function E(t){switch(t.keyCode){case a.KeyCode.ESCAPE:t.stopPropagation(),t.stopImmediatePropagation(),this.hide(),this.triggerEvent(a.EVENT_ESCAPE_DROPDOWN,this)}},onCreated:function v(){d.prototype.onCreated.apply(this,arguments),this.renderPromise=null,this.showing=!1,this._setAllowPositioning(!1),this.childListen(a.EVENT_DISMISS,this.hide),this.childListen(a.EVENT_DROPDOWN_HIDE,this.hide),this.childListen(a.EVENT_DROPDOWN_HIDE_NOT_PROPAGATE,this.hideWithoutTriggering),this.childListen(a.EVENT_CONVERSATIONS_IS_EMPTY_WITHOUT_FRIENDS,this.onIsEmptyWithoutFriends),this.childListen(a.EVENT_CONVERSATIONS_IS_EMPTY,this.onIsEmpty),this.options.persist_through_navigate||(this.childListen(a.EVENT_NAVIGATE,this.hide),this.listen(m.instance,a.EVENT_ROUTE_MATCHED,this.hide)),this.childListen(a.EVENT_EXTERNAL_CLICK,this.hide),this.childListen(a.EVENT_CONTENT_CHANGED,this.positionModule),this.childListen(a.EVENT_CHANGE,this.positionModule)},onIsEmpty:function I(t){this.$el.addClass(this.CssClassName.IS_EMPTY)},onIsEmptyWithoutFriends:function T(t){this.$el.addClass(this.CssClassName.IS_EMPTY_WITHOUT_FRIENDS)},_positionIfReady:function N(){this.inDom&&this.contentReady&&(this.positionModule(),this.ensureHoverIntent(),this.getPositionAnchor().initHovering())},onAdded:function S(){this.options.prefetch&&(this.options.prefetch=!1,this.render())},onAddedToDom:function b(){this._positionIfReady()},onContentReady:function y(){this._positionIfReady()},onOptionsChanged:function P(){this.renderPromise=null},getLoadingSpinnerOptions:function B(){return n.extend(d.prototype.getLoadingSpinnerOptions.call(this),{size:c.Size.SMALL})},render:function A(){var t=this._renderInternal2();return this.renderPromise=t,t},_renderInternal2:function R(){return new Promise(function(t,e){this.renderContainer();var i=this.$el;this.options.append_to_closeup?s(".Closeup").append(i):s("body").append(i);var n=function(){this.contentReady=!0,this.onContentReady(),t()}.bind(this);(this.options.log_component_type||0===this.options.log_component_type)&&i.attr("data-component-type",this.options.log_component_type);var o=this.getPositionElement();this.options.title&&o.append('<h2 class="dropdownTitle">'+this.options.title+"</h2>"),this.options.text&&o.append('<p class="dropdownText">'+this.options.text+"</p>"),this.options.module?p.load(this.options.module).then(function(t){this.setContentModule(t);var e=t.data?t.renderExistingData():t.render();e.then(n),this.options.display_while_loading&&n()}.bind(this)):n(),this.triggerEvent(a.EVENT_DROPDOWN_SHOW,null,!0)}.bind(this))},setSticky:function w(t){var e=n.clone(this.options);e.sticky=t,this.setOptions(e)},turnOnFixed:function O(t){this.toggleFixed(),this.$el.css("top",t)},turnOffFixed:function D(t){this.toggleFixed(),this.$el.css("top",t)},getTopOffset:function x(){return this.$el.position().top},ensureHoverIntent:function L(){this.parent.isClickButton&&!this.parent.isClickButton()&&(this._hoverIntent||this.options.manually_close||(this._hoverIntent=new l(this.$el,{exitDelay:500}),this.listen(this._hoverIntent,a.EVENT_HOVERINTENT_OUT_COMPLETE,function(){this.getPositionAnchor().isHovering()||this.hide()})))},_hide:function k(){this.showing=!1,this._setAllowPositioning(!1),this.$el.removeClass(this.CssClassName.IS_ACTIVE).removeClass(this.CssClassName.SLIDE_IN),this._bodyListener&&(this.removeListener(this._bodyListener),this._bodyListener=null)},hideWithoutTriggering:function U(){this._hide()},hide:function M(){if(this.showing&&(this._hide(),this.triggerEvent(a.EVENT_DROPDOWN_HIDE,null,!0),this.children.length)){var t=this.getContentModule();t.trigger(a.EVENT_DROPDOWN_CONTAINER_HIDDEN,null)}},_ensureModule:function F(){return this.renderPromise||(this.renderPromise=this.render()),this.renderPromise},ensureOpenListeners:function $(){this.options.sticky||(this._bodyListener=this.listen(s(document),"mousedown touchstart",this._onMouseDown))},_onMouseDown:function H(t){var e=this.options.mouse_close_mode;switch(e){case"never":return;case"always":return void this.hide();case"ignore_modal_click":if(s(t.target).parents(".Modal").length>0||s(t.target).hasClass(this.CssClassName.MODAL))return}var i=s(t.target).closest(this.$el).length>0||s(t.target).closest(this.options.anchor).length>0;i||this.hide()},isShowing:function V(){return this.showing},updateMaxHeight:function G(){if(this.children.length){var t=this.getContentModule(),e=t.getHeight(!0);if(this.options.constrain_height){var i=parseInt(this.$el.css("top"),10)||0,n=Math.max(u.height-i-h.siteConst.PIN_MARGIN,0);e>n&&t.getContent().css({"max-height":n,"overflow-y":"auto"})}else this.options.wrap_parent_max_height&&this.$el.css("max-height",e)}},show:function W(t){return this.showing?void 0:(this.showing=!0,this._setAllowPositioning(!0),this.ensureOpenListeners(),this._ensureModule().then(function(){if(this.showing){this.$el.addClass(this.CssClassName.IS_ACTIVE),this.positionModule(),this.updateMaxHeight();var e=this.getContentModule();e&&r.deferDomManipulation(function(){e.trigger(a.EVENT_DROPDOWN_CONTAINER_SHOWN,null),e.focus()}),t&&r.deferWrite().then(t)}this.triggerEvent(a.EVENT_DROPDOWN_SHOW,null,!0),g.instance.publish(a.PUBSUB_CHANNEL_TUTORIAL,a.PUBSUB_TOPIC_VIEW_CHANGE,{moduleName:"Dropdown",action:a.ViewActions.OPEN,options:this.options})}.bind(this)))},reposition:function K(t){this.showing&&(this.$el.addClass(this.CssClassName.IS_ACTIVE),this.positionModule(),this.updateMaxHeight(),t&&t())},fadeIn:function j(t){this.show(function(){this.$el.addClass(this.CssClassName.FADE_IN),t&&t()}.bind(this))},slideIn:function Y(t){return this.$el.addClass(this.CssClassName.HIDE),new Promise(function(t,e){this.show(function(){o.csstransforms3d?this.$el.addClass(this.CssClassName.SLIDE_IN):this.$el.removeClass(this.CssClassName.HIDE),t(void 0)}.bind(this))}.bind(this))},getDropdown:function q(){return this.$("."+f)},isVisible:function z(){return this.$el.hasClass(this.CssClassName.IS_ACTIVE)},setVisible:function X(t){return this.$el.toggleClass(this.CssClassName.IS_ACTIVE,t)},isHovering:function Q(){return this.$el.isHovering()},initHovering:function Z(){this.$el.initHovering()},getContentModule:function J(){return this.children[0]},getContentModulePromise:function tt(){return this._ensureModule().then(function(){return this.getContentModule()}.bind(this))},setContentModule:function et(t){var e=this.getContentModule();e&&e.destroy(),this.insertChild(t,this.getPositionElement())}});C.prototype.className="Dropdown",t.exports=_.register(C)},function(t,e,i){"use strict";var n=i(1),s=i(3),o=i(11),a=i(34),r=function l(t,e){this.$el=t,this.options=n.extend({sensitivity:10,enterDelay:0,exitDelay:0,interval:40},e),this.$el.on("mouseenter mouseleave",this._handleHover.bind(this))};n.extend(r.prototype,s.Events,{_checkMouseEnter:function h(){this._clearTimeout(),this._isMouseStill()?this._onMouseEnterComplete():(this._setPreviousXY(this._currX,this._currY),this._timeout=a.setTimeout(this._checkMouseEnter.bind(this),this.options.interval))},_clearTimeout:function d(){this._timeout&&(this._timeout=clearTimeout(this._timeout))},_handleHover:function c(t){this._clearTimeout(),"mouseenter"===t.type?(this._onMouseEnterStart(),this.options.enterDelay?(this._setPreviousXY(t.pageX,t.pageY),this.$el.on("mousemove.HoverIntent",function(t){this._setCurrentXY(t.pageX,t.pageY)}.bind(this)),this._isEntered||(this._timeout=window.setTimeout(function(){this._checkMouseEnter()}.bind(this),this.options.enterDelay))):this._onMouseEnterComplete()):(this._onMouseOutStart(),this._isEntered&&(this._timeout=window.setTimeout(function(){this._onMouseOutComplete()}.bind(this),this.options.exitDelay)))},_isMouseStill:function u(){var t=Math.abs(this._prevX-this._currX),e=Math.abs(this._prevY-this._currY);return t||e||(t=0,e=0),t+e<this.options.sensitivity},_onMouseEnterStart:function p(){this.trigger(o.EVENT_HOVERINTENT_ENTER_START)},_onMouseEnterComplete:function _(){this.$el.off("mousemove.HoverIntent"),this._isEntered=1,this.trigger(o.EVENT_HOVERINTENT_ENTER_COMPLETE)},_onMouseOutStart:function g(){this.$el.off("mousemove.HoverIntent"),this.trigger(o.EVENT_HOVERINTENT_OUT_START)},_onMouseOutComplete:function m(){this._clearTimeout(),this._isEntered=0,this.trigger(o.EVENT_HOVERINTENT_OUT_COMPLETE)},_setCurrentXY:function f(t,e){this._currX=t,this._currY=e},_setPreviousXY:function C(t,e){this._prevX=t,this._prevY=e}}),t.exports=r},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(141),h=i(126),d=i(52),c="positionModuleCaret",u=5,p=o.PositionPoint,_=o.PositionPointFlag,g={};g[_.FLAG_HORIZONTAL_LEFT]="positionLeft",g[_.FLAG_HORIZONTAL_RIGHT]="positionRight",g[_.FLAG_VERTICAL_TOP]="positionTop",g[_.FLAG_VERTICAL_BOTTOM]="positionBottom",g[_.FLAG_VERTICAL_CENTER]="positionCenter";var m=r.extend({CssClassName:{ABSOLUTE_CENTER:"absoluteCenter",BIG_CARET:"bigCaret",DEFAULT_CARET:"defaultCaret",POSITION_FIXED:"positionFixed",POSITION_MODULE:"PositionModule",POSITION_MODULE_ELEMENT:"positionModuleElement",POSITION_MODULE_FIXED:"positionModuleFixed"},positionMode:o.PositionMode.ANCHORED,onCreated:function f(){this._allowPositioning=!0;var t=this.positionModule.bind(this);this.childListen(o.EVENT_CONTENT_CHANGED,t),this.listen(this,o.EVENT_DIMS_CHANGED,t),this.listen(this,o.EVENT_NAVIGATE,t),this.listen(h,o.EVENT_RESIZE,t),this.listen(h,o.EVENT_BODY_COLUMN_CHANGE,t)},getPositionMode:function C(){return o.PositionMode[this.options.position_mode]||this.positionMode},onOptionsChanged:function E(){this.updateFixed()},getPositionElement:function v(){return this.$el},getPositionAnchor:function I(){return s(this.options.anchor)},getPositionPoint:function T(){return p[this.options.position_point]||p.BOTTOM_LEFT},getPositionFixed:function N(){return!!this.options.fixed},getPositionCaret:function S(){return this.getCaret()},getCaret:function b(){return this.$("."+c)},_getPositionType:function y(){return this.getPositionFixed?"fixed":"absolute"},positionModuleAtAnchor:function P(t,e){d.deferDomManipulation(function(){var i=this.getPositionElement();i.addClass(this.CssClassName.POSITION_MODULE_ELEMENT),i.toggleClass(this.CssClassName.POSITION_FIXED,this.getPositionFixed()),n.each(g,function(t){i.removeClass(t)}),e=l.positionElementAtAnchor(i,t,e,this.getPositionFixed(),this.options.force_in_viewport,!1),n.each(g,function(t,n){e&n&&i.addClass(g[n])})}.bind(this)),this.positionCaret(t,e)},positionCaret:function B(t,e){d.deferDomManipulation(function(){var i=this.$("."+c);if(i.length){var n=o.PositionPointFlag,s=this.getPositionElement();if(this.options.largeCaret?s.addClass(this.CssClassName.BIG_CARET):s.addClass(this.CssClassName.DEFAULT_CARET),this.options.caret_style?i.addClass(this.options.caret_style+"CaretStyle"):i.attr("class",c),this.options.right_position_caret)return void i.css("right","7px");var a="left",r="outerWidth",l="width";e&n.FLAG_HORIZONTAL&&(a="top",r="outerHeight",l="height");var h=0,d=e&(n.FLAG_HORIZONTAL_CENTER|n.FLAG_VERTICAL_CENTER),p=i[l]()>t[l]()-u;p&&!d&&(h=(i[l]()-t[l]())/2+u,(e&n.FLAG_VERTICAL_RIGHT||e&n.FLAG_HORIZONTAL_BOTTOM)&&(h=-h));var _=s.offset()[a],g=_+s[r](),m=t.offset()[a],f=m+t[r](),C=_;m>C&&(C=m);var E=g;E>f&&(E=f);var v=(C+E)/2-i[r]()/2+h,I={};if(I[a]=v,i.offset(I),h){var T=parseInt(s.css(a),10);s.css(a,T-h)}}}.bind(this))},_setAllowPositioning:function A(t){this._allowPositioning&&t&&this._positionModule(),this._allowPositioning=t},positionModule:function R(){this._allowPositioning&&this._positionModule()},_positionModule:function w(){this.cleanPositionModuleElement();var t=!1;this.getPositionMode()===o.PositionMode.MANUAL?this._positionManually():this.getPositionMode()===o.PositionMode.ANCHORED?this.positionModuleAtAnchor(this.getPositionAnchor(),this.getPositionPoint()):t=!0,this._positionAbsoluteCenter(t)},_positionAbsoluteCenter:function O(t){this.$el.toggleClass(this.CssClassName.ABSOLUTE_CENTER,t)},_positionManually:function D(){d.deferDomManipulation(function(){var t=this.getPositionElement();t.addClass(this.CssClassName.POSITION_MODULE_ELEMENT),t.toggleClass(this.CssClassName.POSITION_FIXED,this.getPositionFixed())}.bind(this))},cleanPositionModuleElement:function x(){d.deferDomManipulation(function(){var t=this.getPositionElement();t.removeClass(this.CssClassName.POSITION_MODULE_ELEMENT),t.css({top:"",left:"",margin:""})}.bind(this))},updateFixed:function L(){d.deferDomManipulation(function(){this.$el.toggleClass(this.CssClassName.POSITION_MODULE_FIXED,this.getPositionFixed())}.bind(this))},toggleFixed:function k(){d.deferDomManipulation(function(){var t=this.getPositionElement();t.toggleClass(this.CssClassName.POSITION_MODULE_FIXED,!t.hasClass(this.CssClassName.POSITION_MODULE_FIXED))}.bind(this))},renderContainer:function U(){this.empty();var t=this.$el;if(t.addClass(this.CssClassName.POSITION_MODULE),t.addClass(this.options.class_name),this.updateFixed(),this.options.view_type&&t.addClass(this.options.view_type),!this.options.hide_caret){var e=s('<span class="'+c+'"></span>');t.prepend(e)}}});m.prototype.className="PositionModule",t.exports=a.register(m)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(126),a={positionElementAtAnchor:function r(t,e,i,o,l,h){var d=s.PositionPointFlag,c=e.offset();h&&(c=e.position());var u=t.outerWidth(),p=e.outerWidth();if(c){var _=0,g=0;if(i&d.FLAG_VERTICAL_BOTTOM||i&d.FLAG_VERTICAL_TOP?(_=i&d.FLAG_VERTICAL_BOTTOM?c.top+e.outerHeight():c.top-t.outerHeight(),g=i&d.FLAG_VERTICAL_LEFT?c.left:i&d.FLAG_VERTICAL_RIGHT?c.left+p-u:c.left+(p-u)/2):i&d.FLAG_HORIZONTAL_LEFT||i&d.FLAG_HORIZONTAL_RIGHT?(g=i&d.FLAG_HORIZONTAL_LEFT?c.left-u:c.left+p,_=i&d.FLAG_HORIZONTAL_TOP?c.top:i&d.FLAG_HORIZONTAL_BOTTOM?c.top+e.outerHeight()-t.outerHeight():c.top+(e.outerHeight()-t.outerHeight())/2):i&d.FLAG_VERTICAL_CENTER&&i&d.FLAG_HORIZONTAL_CENTER&&(g=c.left+(p-u)/2,_=c.top+(e.outerHeight()-t.outerHeight())/2),o){var m=_-n(window).scrollTop();m>0&&(_=m)}else{var f=t.parents().filter(function(){return"fixed"===n(this).css("position")});f[0]&&(_+=f.scrollTop(),_-=n(window).scrollTop())}var C={left:g,top:_};return l&&(C=a.checkIfInViewportAndAdjustAccordingly(t,C,i)),t.css(C),i}},checkIfInViewportAndAdjustAccordingly:function l(t,e,i){var n=t.width(),s=e.left,a=e.top,r=s+n,l=7,h,d;r>o.width?h=s-(r-o.width+l):l>s&&(h=l);var c={};return c.left=h?h:s,c.top=d?d:a,c}};t.exports=a},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(138),r=i(29),l=i(23),h=i(34),d=i(31),c="dim",u="primary",p="memoDropdown",_=n.extend({events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",click:"onClick"},onMouseEnter:function g(){this.options.unfollow_hover_text&&this.options.followed&&this.setText(this.options.unfollow_hover_text)},onMouseLeave:function m(){this.options.unfollow_hover_text&&this.options.followed&&this.setText(this.options.unfollow_text)},getResourceId:function f(){return null},getFollowResource:function C(){return null},getFollowClass:function E(){return u},getUnfollowClass:function v(){return c},toggleState:function I(){this.setState(!this.options.followed),this.trigger("toggleFollow"),this.getResourceId()&&l.instance.publish(this.getResourceId(),this.options.followed?o.PUBSUB_TOPIC_USER_FOLLOW:o.PUBSUB_TOPIC_USER_UNFOLLOW,!0)},setState:function T(t){this.options.text=this.options[t?"unfollow_text":"follow_text"],this.options.followed=t,this.setText(this.options.text),this.renderExistingData()},getState:function N(){return this.options.followed},toggleFollow:function S(){var t=this.getFollowResource();if(!t)return void this.log.error("No resource returned in `getFollowResource()`");this.showLoading();var e=this.options.followed?this.options.unfollow_ga_category:this.options.follow_ga_category;(this.options.followed?t.callDelete():t.callCreate()).then(function(){e&&r.trackEvent(e,o.GA_ACTION_SUCCESS),this.toggleState()}.bind(this),function(){e&&r.trackEvent(e,o.GA_ACTION_ERROR)}).fin(function(){this.hideLoading()}.bind(this))},onClick:function b(){if(this.ensureAuthentication()&&!this.options.is_me){var t=this.options.followed?this.options.unfollow_ga_category:this.options.follow_ga_category;return t&&r.trackEvent(t,o.GA_ACTION_CLICK),this.toggleFollow(),!1}},getAuthRedirectUrl:function y(){return d.getRegisterUrl({action:"follow"})},hideMemo:function P(){if(this.options.memo){var t=this.getChildById(p);t&&t.fadeOut(function(){t.destroy()})}},showMemo:function B(){var B=this.options.memo&&this.options.memo.show;if(B&&!this.getChildById(p)){this.isClickButton=function(){return!1};var t=this.options.memo.position_point?this.options.memo.position_point:"RIGHT_CENTER",e={title:this.options.memo.title,anchor:this.$el,position_point:t,class_name:"autoFollowMemo",largeCaret:!1},i=new a({id:p,options:e});this.appendChild(i),i.fadeIn(function(){h.setTimeout(function(){this.hideMemo()}.bind(this),5e3)}.bind(this))}}});_.prototype.className="FollowButton",t.exports=s.register(_)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(8);i(144),i(145);var l="homefeedBuilderView",h=a.extend({events:{"click .interestWrapper":"onInterestImageClick","click .wholeInterestMask":"onInterestImageClick"},CssClassName:{IS_CHECKED:"checked",HIDDEN:"hidden",VISIBLE:"visible"},onContentReady:function d(){this.options.state_interestFollowed=!1,n.size(this.data)<=2&&this.data.id&&this.renderResourceWithNewData(),this.followButton=this.getChildByModuleName("InterestFollowButton"),this.homefeedSetupViewFollowButton=this.getChildByModuleName("MockInterestFollowButton"),this.isFollowed=this.data.is_followed,this.followButton&&this.listen(this.followButton,s.EVENT_BUTTON_CLICK,this.onFollowButtonClick),this.homefeedSetupViewFollowButton&&this.listen(this.homefeedSetupViewFollowButton,s.EVENT_BUTTON_CLICK,this.onHomefeedSetupViewFollowButtonClick);var t=this.data.id;if(t){var e={};e[s.PUBSUB_TOPIC_USER_FOLLOW]=this.onInterestFollowOrUnfollow,e[s.PUBSUB_TOPIC_USER_UNFOLLOW]=this.onInterestFollowOrUnfollow,this.pubsubSubscribe(t,e)}this.options.state_showOverflowMask=!1,this.options.state_overflowMaskText="...",this.options.state_isFollowed=!!this.data.is_followed},updateDom:function c(){if(this.options.state_showOverflowMask){var t=this.$(".overflowMask");if(t&&this.options.state_overflowMaskText){var e=t.find(".text");e&&e.text(this.options.state_overflowMaskText)}t.show();var i=this.$(".interestWrapper");i.addClass(this.CssClassName.HIDDEN),i.css("box-shadow","none")}this.options.show_mask&&this.$(".wholeInterestMask").toggle(this.options.state_isFollowed),this.options.checkable&&this.$(".selectCheck").toggleClass(this.CssClassName.IS_CHECKED,this.options.state_isFollowed),this.options.view_type===l&&this.$(".followMask").toggleClass(this.CssClassName.VISIBLE,this.options.state_interestFollowed)},onFollowButtonClick:function u(){this.triggerEvent(s.EVENT_ITEM_CLICK,this.data,!0),this.toggleVisualState()},onHomefeedSetupViewFollowButtonClick:function p(){this.triggerEvent(s.EVENT_ITEM_CLICK,this.data,!0),this.toggleVisualState()},onInterestImageClick:function _(){this.triggerEvent(s.EVENT_ITEM_CLICK,this.data,!0),this.toggleVisualState();var t=this.$(".interestWrapper");t.is("div")&&(this.followButton&&this.followButton.toggleFollow(),this.homefeedSetupViewFollowButton&&this.homefeedSetupViewFollowButton.toggleState())},onInterestFollowOrUnfollow:function g(t,e){if(this.followButton&&"homefeedSetupView"!==this.options.view_type){var i=this.followButton.options.followed;this.setVisualState(i)}this.updateOptionsAndDom({state_interestFollowed:i})},setVisualState:function m(t){this._updateFollowState(t),this.updateOptionsAndDom({state_isFollowed:t})},showOverflowMask:function f(t){this.updateOptionsAndDom({state_showOverflowMask:!0,state_overflowMaskText:t})},_updateFollowState:function C(t){this.isFollowed=t;var e=this.isFollowed?s.EVENT_INTEREST_FOLLOW:s.EVENT_INTEREST_UNFOLLOW,i=n.extend({},this.data,{is_followed:this.isFollowed});this.triggerEvent(e,i,!0)},toggleVisualState:function E(){this.setVisualState(!this.isFollowed)},renderResourceWithNewData:function v(){var t=r.create("InterestResource",{interest:this.data.id});t.callGet().then(function(t){this.data=t.resource_response.data,this.render()}.bind(this))}});h.prototype.className="Interest",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=n.extend({toggleState:function a(){this.setState(!this.options.followed),this.trigger("toggleFollow")},setState:function r(t){this.options.text=this.options[t?"unfollow_text":"follow_text"],this.options.followed=t,this.renderExistingData()},getState:function l(){return this.options.followed},onClick:function h(t){return n.prototype.onClick.call(this,t),this.toggleState(),!1}});o.prototype.className="MockInterestFollowButton",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(142),r=i(40),l=i(29),h=i(8),d=i(131),c=i(46),u=a.extend({getResourceId:function p(){return this.options.interest_id},getFollowResource:function _(){var t={interest_list:o.INTEREST_LIST_FAVORITED,interest_id:this.getResourceId()};return this.options.referrer&&(t.referrer=this.options.referrer),h.create("InterestFollowResource",t)},getFollowClass:function g(){return this.options.follow_class},onContentReady:function m(){this.showMemo()},onClick:function f(t){if(n.prototype.onClick.call(this,t),!r.instance.is_mobile_agent||this.ensureAuthentication()){if(!c.isAuthenticated())return d.showInlineSignupModalOnButtonClick("InterestFollowButton");var e=this.options.followed?this.options.unfollow_ga_category:this.options.follow_ga_category;e&&l.trackEvent(e,o.GA_ACTION_CLICK),this.toggleFollow()}}});u.prototype.className="InterestFollowButton",t.exports=s.register(u)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19);i(120);var a=s.extend({events:{"click .check":"_onClickCheck",click:"_onClick"},CssClassName:{DISABLED:"disabled"},_onClickCheck:function r(t){t.stopPropagation()},_onClick:function l(){this.getChildById("check").setChecked(!this.isChecked(),!0)},setChecked:function h(t){this.getChildById("check").setChecked(t,!1)},isChecked:function d(){return this.getChildById("check").isChecked()},setDisabled:function c(t){this.getChildById("check").setDisabled(t,!1),n(this.el).toggleClass(this.CssClassName.DISABLED,t)},getEmail:function u(){return this.options.email_contact.id}});a.prototype.className="EmailContact",t.exports=o.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(148),a=i(50);i(116);var r=a.extend({events:{click:"_onClick"},_onClick:function l(t){this.getChildById("invite").showLoading(),o.userInviteFacebook(this.options.facebook_contact.id,this._onInvite.bind(this))},_onInvite:function h(t){this.getChildById("invite").hideLoading(),t&&this.triggerEvent(n.EVENT_INVITE_USER,null,!0)}});r.prototype.className="FacebookContact",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(9),o=i(134),a=i(40),r=i(47),l=i(29),h=i(8),d=i(46),c={trackInvite:function u(t,e){e?l.trackCategoryEvent("user_invite",t,n.GA_ACTION_SUCCESS):l.trackCategoryEvent("user_invite",t,n.GA_ACTION_ERROR)},_createFacebookInvite:function p(){var t=h.create("FacebookInviteCreateResource",{});return t.callCreate()},_showFacebookDialog:function _(t,e){return c._createFacebookInvite().then(function(i){var s=i.resource_response.data,a=s.url,r=s.invite_code;o.open({type:"send",name:"name",path:a,to:t,callback:function d(t){if(t&&t.success){c.trackInvite("facebook",!0);var i=h.create("FacebookInviteSentResource",{invite_code:r});i.callCreate()}e&&e(t&&t.success)}}),l.trackCategoryEvent("user_invite","facebook",n.GA_ACTION_OPEN_MODAL)},function(){c.trackInvite("facebook",!1)})},userInviteFacebook:function g(t,e){return r.ensureLoggedIn(function(){c._showFacebookDialog(t,e)},d)},userInviteEmail:function m(t,e){var i=h.create("EmailInviteSentResource",{email:t,type:"email"});i.callCreate().then(function(t){c.trackInvite("email",!0),e&&e(!0)},function(t){c.trackInvite("email",!1),e&&e(!1)})},trackInviteFunnelAction:function f(t,e){var i=a.instance.invite_code;if(i){e="undefined"!=typeof e?e:!1;var n={action:t,is_recipient_funnel:e,invite_code:i};h.create("TrackInviteFunnelActionResource",n).callCreate({showError:!1})}}};t.exports=s.expose("Invite",c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(148),a=i(50);i(116),i(129);var r=a.extend({events:{"click .dismiss":"onDismissClick","click .contactWrapper":"onAction"},CssClassName:{CONTACT_CONFIRMED:"contactConfirmed"},onDismissClick:function l(){this.triggerEvent(n.EVENT_DISMISS,null,!0)},getUserId:function h(){return this.user.hash_id},onContentReady:function d(){this.user=this.options.contact_info},onInviteSuccess:function c(t){t&&(this.triggerEvent(n.EVENT_INVITE_USER,null,!0),this.$el.addClass(this.CssClassName.CONTACT_CONFIRMED))},onAction:function u(){return"facebook"===this.user.network?o.userInviteFacebook(this.user.id,this.onInviteSuccess.bind(this)):"email"===this.user.id_type&&o.userInviteEmail(this.user.id,this.onInviteSuccess.bind(this)),!1}});r.prototype.className="UserContact",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(138),l=i(139),h=i(50);i(151),i(130),i(173),i(128),i(244),i(236),i(245),i(246);var d="follow_view",c="boardPinsGrid",u="boardCoverImage",p="homefeedBuilderView",_=h.extend({events:{"click .dismiss":"onDismissClick"},CssClassName:{NOT_NAVIGATABLE:"notNavigatable",NO_SHADOW:"noShadow",FOLLOW_CONFIRMED:"followConfirmed",VISIBLE:"visible"},getOwnedScrollables:function g(){return this.$(".pinGridWrapper")},onContentReady:function m(){this.options.state_boardFollowed=!1;var t=this.getId();if(t){var e={};e[o.PUBSUB_TOPIC_BOARD_COVER_UPDATED]=this.onBoardCoverUpdated,e[o.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,e[o.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,e[o.PUBSUB_TOPIC_PIN_DELETED]=this.onPinDeleted,e[o.PUBSUB_TOPIC_BOARD_FOLLOW]=this.onBoardFollow,this.pubsubSubscribe(t,e);var i={};i[o.PUBSUB_TOPIC_BOARD_UNFOLLOW]=this.onBoardUnfollow,this.pubsubSubscribe(o.PUBSUB_CHANNEL_CURRENT_USER,i)}if(this.options.view_type===c){var n=this.getChildById("pinGrid");this.listen(n,o.EVENT_CONTENT_CHANGED,this.updateDom)}this.options.view_type===d&&this.initHoverListeners()},onDismissClick:function f(){this.dismissed=!0,this.triggerEvent(o.EVENT_DISMISS,null,!0);
},onBoardHoverEnter:function C(){this.$el.isHovering()&&this._dropdown.show()},onBoardHoverExit:function E(){this._dropdown.isHovering()||this._dropdown.hide()},onBoardFollow:function v(t,e,i){this.options.view_type===d&&this.$el.addClass(this.CssClassName.FOLLOW_CONFIRMED),this.updateOptionsAndDom({state_boardFollowed:!0})},onBoardUnfollow:function I(t,e,i){this.updateOptionsAndDom({state_boardFollowed:!1})},onPinDeleted:function T(t,e,i){this.options.view_type===u&&this.onBoardUpdated()},onBoardCoverUpdated:function N(t,e,i){this.setBoardCover(i)},positionBoardPinsGrid:function S(){var t=this.getChildById("pinGrid"),e=document.activeElement;t.$(".activeItem").focus(),e&&s(e).focus()},toggleFollow:function b(){this.getChildByModuleName("BoardFollowButton").toggleFollow()},initHoverListeners:function y(){!this._hoverIntent&&this.options.use_flyout&&(this._hoverIntent=new l(this.$el,{enterDelay:500,exitDelay:200}),this.listen(this,o.EVENT_NAVIGATE,this.onBoardHoverExit),this.listen(this._hoverIntent,o.EVENT_HOVERINTENT_ENTER_COMPLETE,this.onBoardHoverEnter),this.listen(this._hoverIntent,o.EVENT_HOVERINTENT_OUT_COMPLETE,this.onBoardHoverExit),this.isClickButton=function(){return!1},this._dropdown=new r({options:{anchor:this.$el,class_name:"followViewHover underneathHeader",position_point:"RIGHT_TOP",module:{name:"Board",options:{view_type:"boardPinsGrid",scrollable:!0,prevent_default_scroll:!0,board_follow_button_options:{board_id:this.resource.options.board_id}},resource:{name:"BoardResource",options:{board_id:this.resource.options.board_id}}}}}),this.appendChild(this._dropdown),this.$el.initHovering(),this._dropdown.initHovering())},setBoardCover:function P(t){var e=t.url,i=t.crop_x,n=t.crop_y,s=t.nativeHeight,o=t.nativeWidth,a=t.scale,r=this.$(".boardCoverWrapper img");r.attr("src",e).css({height:s*a,left:-i,"max-width":"none",position:"absolute",top:-n,width:o*a})},disabledButtons:[],disable:function B(){this.$el.find(".hoverMask").addClass(this.CssClassName.NOT_NAVIGATABLE),this.disabledButtons=[],n.each(this.getChildrenByModuleName("ShowModalButton"),function(t){t.isDisabled()||(t.disable(),this.disabledButtons.push(t))}.bind(this))},enable:function A(){this.$el.find(".hoverMask").removeClass(this.CssClassName.NOT_NAVIGATABLE),n.each(this.disabledButtons,function(t){t.enable()})},setFollowButtonState:function R(t){var e=this.getChildByModuleName("BoardFollowButton");e&&e.setState(t)},getId:function w(){return this.data&&this.data.id},onBoardDeleted:function O(){this.triggerEvent(o.EVENT_BOARD_DELETED,this,!0),this.destroy()},onBoardUpdated:function D(){this.render()},getLoggingObjectIdStr:function x(){return this.getId()},updateBoardPinsGrid:function L(t,e){this.updatePinGrid(t.id,e),this.updateUser(t.name,t.url,(t.owner||{}).id)},updateBoardGridActiveItem:function k(t){var e=this.getChildById("pinGrid");e&&t&&e.updateActiveGridItem(t)},updateBoardDetails:function U(t){this.data.id=t.id,this.updateBoardIcons(t),this.updateBoardButtons(t)},updateBoardIcons:function M(t){var e=this.getChildByModuleName("BoardIcons");e&&t&&(e.data=t,e.render())},updateDom:function F(){var t=this.$el.css("max-height")||"0";t=t.replace(/[^0-9]/g,""),this.$el.outerHeight()<t&&this.$el.addClass(this.CssClassName.NO_SHADOW),this.options.view_type===p&&this.$(".followMask").toggleClass(this.CssClassName.VISIBLE,this.options.state_boardFollowed)},updateUser:function $(t,e,i){var n=this.getChildByModuleName("User");n&&t&&i&&(n.options.title_text=t,n.options.url=e,n.options.spinner={enable:!1},n.resource.set("user_id",i),n.render())},updatePinGrid:function H(t,e){var i=this.getChildById("pinGrid");i&&t&&e&&(i.options.active_item_id=e,i.options.spinner={enable:!1},i.resource.set("board_id",t),i.render())},updateBoardButtons:function V(t){var e=this.getChildById("boardButtons");if(e&&t){var i={board_access:t.access||[],board_followed_by_me:t.followed_by_me,board_owner:(t.owner||{}).id,board_id:t.id};e.options.button_options=i,e.options.url=t.url,e.render()}}});_.prototype.className="Board",t.exports=a.register(_)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(21),a=i(11),r=i(50),l=i(30),h=i(152),d=i(59),c=i(19),u=i(34),p=i(46);i(159),i(160);var _=2,g=240,m=r.extend({events:{"click .navigator.left em":"onLeftNavigatorClick","click .navigator.right em":"onRightNavigatorClick"},CssClassName:{ERROR:"hasError",LOADING:"loading"},DRAGGING_ENABLED:"draggingEnabled",DRAGGING_DISABLED:"draggingDisabled",onContentReady:function f(){if(this.options.show_grid_footer&&(this.childListen(a.EVENT_ERROR,this.onError),this.childListen(a.EVENT_ERROR_RESOLVED,this.onErrorResolved),this.childListen(a.EVENT_BUTTON_CLICK,this.onButtonClick)),this.childListen(a.EVENT_ITEMS_REQUEST_START,this.onItemsRequestStart),this.childListen(a.EVENT_ITEMS_REQUEST_SUCCESS,this.onItemsRequestSuccess),this.childListen(a.EVENT_ITEMS_END,this.onItemsEnd),this.childListen(a.EVENT_SEE_MORE_BUTTON_CLICKED,this.onSeeMoreButtonClicked),"boardPinsGrid"!==this.options.view_type){var t={};t[a.PUBSUB_TOPIC_CLOSE_CLOSEUP]=this.onCloseupClose,this.pubsubSubscribe(a.PUBSUB_CHANNEL_SITE,t)}this.items=this.getChildByModuleName("GridItems"),this.footer=this.getChildByModuleName("GridFooter"),this.seeMoreButton=this.getChildByModuleName("SeeMoreButton"),this._initializeDragManagerIfPossible(),this.footer&&this.hasItems()&&this.footer.show();var e=!1,i=o.get(a.COOKIE_SEND_PIN_UNAUTH_BROWSING_ALLOWANCE);if((i&&parseInt(i,10)>0||o.get(a.COOKIE_GIFT_WRAP_HOLDOUT))&&(e=!0),p.isAuthenticated()){var n={};n[a.PUBSUB_TOPIC_CONVERSATION_ADDED]=this.onConversationAdded,n[a.PUBSUB_TOPIC_CONVERSATION_NO_ACTIVE_CONVERSATIONS]=this.onNoActiveConversations,this.pubsubSubscribe(a.PUBSUB_CHANNEL_MESSAGES,n),h.hasActiveConversations()||this.onNoActiveConversations(),!this.hasMoreItems()&&this.options.see_more_button&&this.seeMoreButton.hideModule()}else this.showingPageTwoSneakPeek=!1,this.options.scrollable&&"row_layout"!==this.options.layout?e||this.attachScrollListener():this.hasMoreItems()?(this.requestMoreItemsAndBlock(),this.childListen(a.EVENT_CONTENT_CHANGED,this.requestMoreItemsAndBlock)):this.options.show_grid_footer&&this.addNegativeSpace();this.options.scrollable&&"row_layout"===this.options.layout&&this.attachRowSliderScrollListener(),this.triggerEvent(a.EVENT_GRID_CONTENT_READY,null,!0)},attachScrollListener:function C(){this.scrollListener&&this.removeListener(this.scrollListener),this.scrollListener=this.listen(this.getScrollableElement(),a.EVENT_SCROLL,this.onScroll)},attachRowSliderScrollListener:function E(){this.scrollListener&&this.removeListener(this.scrollListener),this.$gridContainer=this.$(".gridContainer"),this.$gridItems=this.$(".GridItems.rowLayout"),this.$leftNav=this.$(".navigator.left"),this.$rightNav=this.$(".navigator.right"),this.scrollListener=this.listen(this.$gridContainer,a.EVENT_SCROLL,this._onSliderScroll),this._onSliderScroll()},hasItems:function v(){return this.items.hasItems()},hasItemsOfType:function I(t){return!!this.items.getChildrenByModuleName(t).length},hasMoreItems:function T(){return this.items.hasMoreItems()},getGridItemsChildren:function N(){var t=this.getGridItems();return t.getChildren()},requestMoreItems:function S(){this.items.requestMoreItems()},requestMoreItemsIfNeeded:function b(){this.items.requestMoreItemsIfNeeded()},emptyItems:function y(){this.items.empty()},renderItems:function P(t,e){this.items.render().then(t,e)},setPageSize:function B(t){this.items.setPageSize(t)},getItemsResource:function A(){return this.items.resource},setItemsResource:function R(t){this.setResource(t),this.items&&this.items.setResource(t)},onCloseupClose:function w(t,e,i){var n=this.getGridItemsChildren(),s=this._getPinByPinId(i,n);if(s){var o=s.getPinWrapperElement(),r=o.offset().top<window.pageYOffset+window.innerHeight;r||this.triggerEvent(a.EVENT_SCROLL_TO_ELEMENT,{$el:o},!0)}},_getPinByPinId:function O(t,e){return n.find(e,function(e){return"Pin"===e.className&&e.data&&e.getId()===t})},onConversationAdded:function D(){this.setDragState(this.DRAGGING_ENABLED)},onNoActiveConversations:function x(){d.instance.v2InGroup("rearrange_pins_internal","employees")||this.setDragState(this.DRAGGING_DISABLED)},onError:function L(){this.hasError=!0,this.$el.addClass(this.CssClassName.ERROR),this.footer&&(this.footer.showError(),this.footer.hideGridLoading())},onErrorResolved:function k(){this.hasError&&(this.hasError=!1,this.$el.removeClass(this.CssClassName.ERROR))},onButtonClick:function U(t){return"gridFooter"===t.target.id&&this.requestMoreItems(),!1},onItemsRequestStart:function M(){this.footer&&this.footer.showGridLoading(),this.$rightNav&&this.$rightNav.addClass(this.CssClassName.LOADING)},_initializeDragManagerIfPossible:function F(){p.isAuthenticated()&&(this.items.initializeDragManager({}),this.dragState&&this.setDragState(this.dragState,!0))},setDragState:function $(t,e){(this.dragState!==t||e)&&(this.dragState=t,this.dragState===this.DRAGGING_DISABLED?this.items.disableDragging():this.items.enableDragging())},onItemsRequestSuccess:function H(){this.footer&&this.footer.hideError(),this.$rightNav&&(this.$rightNav.removeClass(this.CssClassName.LOADING),this.$rightNav.show())},forceDragState:function V(){this.setDragState(this.dragState,!0)},onItemsEnd:function G(){this.footer&&this.footer.hideGridLoading(),this.$rightNav&&this.$rightNav.removeClass(this.CssClassName.LOADING),this.seeMoreButton&&this.seeMoreButton.hideModule()},prependChildItem:function W(t){this.getGridItems().prependChildItem(t)},prependNewItems:function K(t,e){return this.getGridItems().prependNewItems(t,e)},getGridItems:function j(){return this.items},getFirstGridItem:function Y(t){return this.getGridItems().getChildByModuleName(t)},requestMoreItemsAndBlock:function q(){var t=this.getGridItems();if(t&&t.isReady()&&!this.showingPageTwoSneakPeek){var e=this.$el.height();this.showingPageTwoSneakPeek=!0,this.requestMoreItems(),this.$el.height(e),this.$el.css("overflow-y","hidden"),this.$el.css("margin-bottom",0)}},addNegativeSpace:function z(){this.$(".GridFooter").hide(),this.$el.css("padding-bottom",g)},onScroll:function X(){var t=this.getScrollableElement().scrollTop(),e=s(document).height()-this.getScrollableElement().height();t>=e-_&&(this.addNegativeSpace(),this.removeListener(this.scrollListener))},_onSliderScroll:function Q(t){this.scrollLeft=t?t.target.scrollLeft:0,this.updateNavigators(),this.updateActiveItem(),this.scrollLeft>.9*this.$(".gridContainer").width()&&this.requestMoreItemsIfNeeded()},updateNavigators:function Z(){0===this.scrollLeft?this.hideLeftNavigator():this.showLeftNavigator(),this.scrollLeft<this.$gridItems.width()-this.$gridContainer.width()?this.showRightNavigator():this.$rightNav.hasClass(this.CssClassName.LOADING)||this.hideRightNavigator()},updateActiveItem:function J(){if(this.currentlyActiveItem&&!this._inScrollTransition){var t=this.currentlyActiveItem.getContent(),e=t.offset().left,i=this.$gridContainer.width();(e<this.$leftNav.width()||e>i-t.width())&&(this.triggerEvent(a.EVENT_ROW_ITEM_DEACTIVATED,null,!0),this.currentlyActiveItem=null)}},hideLeftNavigator:function tt(){this.$leftNav.hide()},showLeftNavigator:function et(){this.$leftNav.show()},hideRightNavigator:function it(){this.$rightNav.hide()},showRightNavigator:function nt(){this.$rightNav.show()},onLeftNavigatorClick:function st(t){this.scrollSliderByPageOfItems(!0)},onRightNavigatorClick:function ot(t){this.scrollSliderByPageOfItems(!1)},scrollSliderByPageOfItems:function at(t){var e=this._getSliderValues(),i=t?1-e.numberOfItemsPerPage:e.numberOfItemsPerPage+1,n=e.marginLeftOffset-e.sideMarginWidth+i*e.widthPerItem;0===e.numberOfItemsPerPage&&(n=t?e.marginLeftOffset-e.widthPerItem:e.marginLeftOffset+e.widthPerItem),this.$gridContainer.animate({scrollLeft:this.scrollLeft+n},200)},scrollToItem:function rt(t){var e=t.getContent().offset().left,i=this._getSliderValues(),n=function(){this.currentlyActiveItem=t,this.triggerEvent(a.EVENT_SCROLL_GRID_TO_ITEM_END,t,!0)}.bind(this),s=0;if(e<i.sideMarginWidth)s=e-i.containerLeftOffset-i.sideMarginWidth;else{if(!(e>i.sliderWidth-i.sideMarginWidth-i.widthPerItem))return void n();s=e-i.containerLeftOffset-i.sliderWidth+i.widthPerItem+i.sideMarginWidth}this._inScrollTransition=!0,this.$gridContainer.animate({scrollLeft:s},300,"swing",function(){u.setTimeout(function(){n(),this._inScrollTransition=!1}.bind(this),100)}.bind(this))},_getSliderValues:function lt(){var t=this.$gridItems.offset().left,e=this.$gridContainer.width(),i=this.getGridItemsChildren()[0].getWidth()+l.siteConst.PIN_MARGIN,n=Math.floor(.9*e/i),s=(e-n*i)/2,o=(this.$gridItems.offset().left-this.$gridContainer.offset().left)%i;return{containerLeftOffset:t,sliderWidth:e,widthPerItem:i,numberOfItemsPerPage:n,sideMarginWidth:s,marginLeftOffset:o}},increaseRowContainerHeight:function ht(t){var e=this.getGridItems().getContent(),i=this.getHeight(),n=i+t,s=i-n;this.$gridContainer.css({height:n,y:s}),e.css("y",-s),this.$el.css("height",i)},resetRowContainerHeight:function dt(){var t=this.getGridItems().getContent();this.$gridContainer.css({height:"",transform:""}),t.css("transform",""),this.$el.css({height:"",transform:""})},updateActiveGridItem:function ct(t){var e=this.getGridItems();e.setActiveItemById(t)},onSeeMoreButtonClicked:function ut(t){this.requestMoreItems()}});m.prototype.className="Grid",t.exports=c.register(m)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(3),a=i(11),r=i(153),l=i(155),h=i(157),d=i(158),c=i(80),u=i(81),p=i(16),_=i(135),g=i(18),m=i(23),f=i(72),C=i(8),E=i(54),v=i(31),I=i(46),T=5,N="activeConversations",S=72,b=function y(){this.activeConversationsContainer=null,this.conversations={},this.conversationIdToLastMessageId={},this.conversationIds=[],this._openConversation=null,this._logger=p.getLogger("ConversationsManager"),this.conversationsUpdater=new h(this)};n.extend(b.prototype,o.Events),n.extend(b.prototype,{_fetchingConversations:!1,_pendingRequest:null,getContainer:function P(){return this.activeConversationsContainer},setContainer:function B(t){this.activeConversationsContainer=t},listenForConversations:function A(){I.isAuthenticated()&&!I.isLimitedLogin()&&this.listenTo(d.instance(),"conversations_unseen_count",this.onUnseenConversationsCount)},onUnseenConversationsCount:function R(t){t>0||this._shouldUpdateConversations?this._fetchConversations().then(function(e){this._shouldUpdateConversations=!1,this._updateActiveConversations(e),m.instance.publish(a.PUBSUB_CHANNEL_SITE,a.PUBSUB_TOPIC_CONVERSATION_UNREAD_COUNT,t)}.bind(this)):m.instance.publish(a.PUBSUB_CHANNEL_SITE,a.PUBSUB_TOPIC_CONVERSATION_UNREAD_COUNT,t)},_fetchConversations:function w(){if(!this._fetchingConversations){var t=C.create("ConversationsResource",{});this._pendingRequest=f.instance.callGet(t),this._pendingRequest.then(function(){this._conversationsBookmarks=t.get("bookmarks")}.bind(this)).fin(function(){this._fetchingConversations=!1}.bind(this)),this._fetchingConversations=!0}return this._pendingRequest},getConversationsBookmarks:function O(){return this._conversationsBookmarks},_updateActiveConversations:function D(t){n.each(t,function(t){var e=t.id,i=t.last_message,s=this.conversationIdToLastMessageId[e];i&&i.id!==s&&(n.isUndefined(s)&&t.unread<=0||(n.contains(this.conversationIds,e)?this.conversations[e].updateConversation(t):i.sender.id!==I.get("id")&&this.addConversation(t,!1),this.conversationIdToLastMessageId[e]=i.id))}.bind(this))},deleteConversationBadgeCount:function x(){var t=C.create("ConversationBadgeResource",{});t.callDelete({showError:!1})},sendMessageToUsers:function L(t,e,i){var n={user_ids:t||[],emails:e||[]},s=this._sendNewMessage("ConversationsResource",n,i);return s.then(function(t){var e=t.resource_response.data;this.addConversation(e)}.bind(this)),s},sendMessageToConversation:function k(t,e){var i={conversation_id:t};return this._sendNewMessage("ConversationMessagesResource",i,e)},_sendNewMessage:function U(t,e,i){i.text&&(e.text=i.text),i.object_id&&(e[i.object_type]=i.object_id);var n=C.create(t,e),s=n.callCreate({error:this._handleSendMessageError.bind(this)});return s.then(function(){this._shouldUpdateConversations=!0}.bind(this)),s},_handleSendMessageError:function M(t){var e=t.extra_data;if(243===t.api_error_code&&e.objects){var i=e.objects;g.load({name:"ConfirmDialog",options:{template:"message_object_auth_error",attached_object:i.object,users:i.users,emails:i.emails}}).then(function(t){_.get().createAndShowModal(t)})}},logContextEvent:function F(t,e,i,n){var s=c.fromEventType(t);if(i&&s.setObjectIdStr(i),n){if(n.attr("data-element-type")){var o=parseInt(n.attr("data-element-type"),10);s.setElement(o)}var a=n.closest("[data-component-type]");if(a.length){var r=parseInt(a.attr("data-component-type"),10);s.setComponent(r)}}s.updateAuxData({conversation_id:e}),u.getInstance().addEvent(s)},_addConversationToDom:function $(t,e,i){var s=this.getContainer();if(!s)return Promise.resolve(void 0);var o=t.id;this.conversationIds.push(o),this.cacheActiveConversations();var a={id:o};(!I.isAuthenticated()||I.isLimitedLogin())&&(a.unauth=!0),t.users=n.reject(t.users,function(t){return t.id===I.get("id")}),e&&(a.peek=!1);var l=new r({options:a,data:t}),h=l.renderExistingData().then(function(){this.conversations[o]=l,this.resetConversationHeadTransforms(),s.appendChild(l),i&&l.setInactive(),l.setBadgeCount(t.unread),e?this.openConversation(l):this._openConversation&&this._openConversation.adjustPopup(),l.focus(),this._ensureWithinMaxNumberOfConversations()}.bind(this));return h},_animateAddConversation:function H(t,e,i){var s=n.reject(t.users,function(t){return t.id===I.get("id")}),o=function(){this._addConversationToDom(t,e)}.bind(this);e&&this._openConversation&&this._openConversation.closePopup();var a;if(i&&i.length)a=this._makeAnimatedElement(i),this._animateShowConversationHead(a,o);else{var r=new l({options:{users:s,emails:t.emails}});r.render().then(function(){a=this._makeAnimatedElement(r.$el),this._animateShowConversationHead(a,o)}.bind(this))}},_makeAnimatedElement:function V(t){var e=t.clone();return e.addClass("cloned").offset({left:-1e3,top:-1e3}).appendTo(s("body")),e},_animateShowConversationHead:function G(t,e){var i=this.getContainer(),n=i.getContent(),o=n.offset(),r=o.left,l=o.top,h=i.getHeight(!0),d=n.find(".ConversationHead");d.transition({y:-S},280,"ease"),t.addClass("normal opening"),t.removeClass("medium small"),t.width(a.ACTIVE_CONVERSATION_HEAD_DIMENSION).height(a.ACTIVE_CONVERSATION_HEAD_DIMENSION).css("visibility","hidden"),t.offset({left:r,top:l+h-a.ACTIVE_CONVERSATION_HEAD_DIMENSION-3}),t.transition({scale:0,duration:1},function(){s(this).css("visibility","")}).transition({scale:1.2,duration:180}).transition({scale:1,duration:100},function(){e(),t.remove()})},cacheActiveConversations:function W(){E.localStorage.setItem(N,this.conversationIds)},_ensureWithinMaxNumberOfConversations:function K(){if(this.conversationIds.length>T){var t=this.conversationIds[0];this.removeOverboundsConversation(t)}},removeOverboundsConversation:function j(t){var e=this.conversations[t],i=e.getContent();i.transition({scale:.8},200).transition({scale:2,opacity:0},200,"ease",function(){this.resetConversationHeadTransforms(),this.removeConversationById(t)}.bind(this))},loadInitialConversations:function Y(t){var e=E.localStorage.getItem(N);e&&e.length||(e=[],this._publishNoActiveConversationsIfNeeded());var i=[].concat(e);this._fetchConversations().then(function(e){var s=!!t,o=n.map(e,function(e){var o=e.id===t;return o?(s=!1,this._addConversationToDom(e,!0)):n.contains(i,e.id)?this._addConversationToDom(e,!1):void 0}.bind(this));Promise.all(o).then(function(){this._updateActiveConversations(e),s&&this.addConversationById(t,!0)}.bind(this)),this.cacheActiveConversations()}.bind(this))},addConversation:function q(t,e,i){n.isUndefined(e)&&(e=!0);var s=t.id,o=this.conversations[s];o?(o.updateConversation(t),e&&this.openConversation(o)):this._animateAddConversation(t,e,i),m.instance.publish(a.PUBSUB_CHANNEL_MESSAGES,a.PUBSUB_TOPIC_CONVERSATION_ADDED)},addConversationById:function z(t,e){if(n.contains(this.conversationIds,t))return void(e&&this.openConversation(this.conversations[t]));var i=C.create("ConversationResource",{conversation_id:t});i.callGet({showError:!1}).then(function(t){var i=t.resource_response.data;this.addConversation(i,e)}.bind(this))},addConversationForUnauthUser:function X(t){var e=v.getQueryStringParams(),i=e.user_id,n=e.od;if(i&&n){var s=C.create("UnauthConversationResource",{conversation_id:t,user_id:i,od:n});s.callGet().then(function(t){var e=t.resource_response.data;this._unauthUserEmail=e.unauth_user_email;var i=e.conversation;this.addConversation(i,!0)}.bind(this))}},getUnauthUserEmail:function Q(){return this._unauthUserEmail},listenForActiveConversationUpdates:function Z(){I.isAuthenticated()&&!I.isLimitedLogin()&&(d.instance().setMinPoll(a.UPDATES_WITH_ACTIVE_CONVERSATIONS_MIN_POLL),this.conversationsUpdater.activate(),this.activeConversationsListener||(this.activeConversationsListener=this.listenTo(this.conversationsUpdater,"active_conversations",this.onActiveConversationsUpdate)))},getOpenConversationId:function J(){return this._openConversation?this._openConversation.data.id:!1},onActiveConversationsUpdate:function tt(t){this._updateActiveConversations(t)},stopListeningForActiveConversationUpdates:function et(){I.isAuthenticated()&&!I.isLimitedLogin()&&(this.conversationsUpdater.deactivate(),d.instance().setMinPoll(a.UPDATES_MIN_POLL),this.activeConversationsListener&&(this.stopListening(this.activeConversationsListener),this.activeConversationsListener=null))},getConversationIds:function it(){return this.conversationIds},hasActiveConversations:function nt(){return this.getConversationIds().length>0},resetConversationHeadTransforms:function st(){var t=this.getContainer();t&&t.$(".ConversationHead").css("transform","")},scaleConversationDownAndRemove:function ot(t){var e=this.conversations[t],i=e.getContent(),s=n.indexOf(this.conversationIds,t),o=this.getContainer().getConversationHeads(),a=o.slice(0,s);i.transition({scale:1.1},120,function(){a.length&&a.transition({y:S},140)}).transition({scale:0},140,"ease",function(){this.resetConversationHeadTransforms(),this.removeConversationById(t)}.bind(this))},removeConversationById:function at(t){if(this.conversationIds=n.without(this.conversationIds,t),this.conversations[t]){this._openConversation&&(this._openConversation.getConversationId()===t?this.closeConversation(this._openConversation):this._openConversation.adjustPopup());var e=this.conversations[t];e.destroy(),delete this.conversations[t],this.cacheActiveConversations(),this._publishNoActiveConversationsIfNeeded()}},_publishNoActiveConversationsIfNeeded:function rt(){0===this.conversationIds.length&&m.instance.publish(a.PUBSUB_CHANNEL_MESSAGES,a.PUBSUB_TOPIC_CONVERSATION_NO_ACTIVE_CONVERSATIONS)},closeAllConversations:function lt(){n.each(this.conversations,function(t){this.closeConversation(t)}.bind(this))},closeConversation:function ht(t){this.stopListeningForActiveConversationUpdates(),this.setAllActive(),t.closePopup(),this._openConversation===t&&(this._openConversation=null,m.instance.publish(a.PUBSUB_CHANNEL_MESSAGES,a.PUBSUB_TOPIC_CONVERSATION_CLOSED,null))},setAllActive:function dt(){n.each(this.conversations,function(t){t.setActive()})},setAllInactive:function ct(t){n.each(this.conversations,function(t){t!==this._openConversation&&t.setInactive()}.bind(this))},closeConversationById:function ut(t){var e=this.conversations[t];e&&this.closeConversation(e)},openConversation:function pt(t){this.conversations[t.getConversationId()]&&(this._openConversation?(this._openConversation.setInactive(),this._openConversation.closePopup()):this.setAllInactive(t),this._openConversation=t,this._openConversation.setActive(),t.showPopup(),m.instance.publish(a.PUBSUB_CHANNEL_MESSAGES,a.PUBSUB_TOPIC_CONVERSATION_OPEN,null),this.listenForActiveConversationUpdates())}}),t.exports=new b},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(154),l=i(138),h=i(50),d=i(14),c=i(23),u=i(34);i(155);var p=h.extend({CssClassName:{UI_STATE_CONVERSATION:"ui-state-conversation",UI_STATE_HOVER:"ui-state-hover"},onCreated:function _(){this.childListen(o.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(o.EVENT_CONVERSATION_HEAD_READY,this.onConversationHeadReady)},onEscape:function g(){this.closeConversation()},onContentReady:function m(){this._attachPopup()},onConversationHeadReady:function f(t){var e=t.target;n.contains(this.children,e)&&(this._headClickListener||(this._headClickListener=this.listen(e,o.EVENT_CONVERSATION_HEAD_CLICKED,this.onConversationHeadClick)),e.getContent().droppable({activeClass:"ui-state-highlight",tolerance:"pointer",over:function i(t,e){s(e.helper).transition({scale:.24},230,"ease").transition({scale:.25,duration:20}),s(this).transition({scale:1.3,duration:150}).transition({scale:1.2,duration:100})},out:function a(t,e){s(e.helper).transition({scale:1,duration:250}),s(this).transition({scale:1,duration:250})},drop:function(t,e){var i=this.getConversationPopup(),n=r.getDraggedObject();i.sendMessage(null,n),this.openConversation(),s(e.helper).transition({scale:1,duration:0})}.bind(this)}))},onConversationHeadClick:function C(t){if(this._popup)if(this._popup.isShowing()){if(this.getConversationHeadBadgeCount())return void this.getConversationPopup().scrollToLatest();this.closeConversation()}else this.openConversation();else this._attachPopup()},onDropdownShow:function E(t){var e=this.getConversationPopup();this.focusInput();var i=this._popup.getContent();i.droppable({activeClass:"ui-state-highlight",tolerance:"pointer",activate:function n(t,i){r.getDraggedObject()&&e.showDropTarget()},deactivate:function o(t,i){e.hideDropTarget()},over:function(t,n){r.getDraggedObject()&&(s(n.helper).addClass(this.CssClassName.UI_STATE_CONVERSATION),e.setDropTargetText(d._("Drop here to send!")),n.helper.transition({scale:.5,duration:130}).transition({scale:.53,duration:50}),i.addClass(this.CssClassName.UI_STATE_HOVER))}.bind(this),out:function(t,n){s(n.helper).removeClass(this.CssClassName.UI_STATE_CONVERSATION),e.setDropTargetText(d._("Drag here to send!")),i.removeClass(this.CssClassName.UI_STATE_HOVER),n.helper.animate({scale:1},150)}.bind(this),drop:function(t,n){if(r.getDraggedObject()){var o=r.getDraggedObject();e.sendMessage(null,o),s(n.helper).transition({scale:1,duration:0}),u.setTimeout(function(){s(n.helper).removeClass(this.CssClassName.UI_STATE_CONVERSATION)}.bind(this),100),i.addClass(this.CssClassName.UI_STATE_HOVER)}}.bind(this)}),this._shouldScrollToBottom&&e.scrollToLatest(),this._shouldScrollToBottom=!1},_attachPopup:function v(){var t={module:this.getPopupModuleLoadOptions(),anchor:this.getContent(),mouse_close_mode:"never",persist_through_navigate:!0,fixed:!0,caret_style:"lightGray lightGrayConversations",position_point:"RIGHT_BOTTOM",class_name:"aboveModal activeConversationDropdown",prefetch:!0};this._popup=new l({options:t,id:"popup"}),this.addChild(this._popup),this._shouldScrollToBottom=!0,this.listen(this._popup,o.EVENT_DROPDOWN_SHOW,this.onDropdownShow),this.listen(this._popup,o.EVENT_ESCAPE_DROPDOWN,this.onEscape),this.childListen(o.EVENT_CONVERSATION_DECREMENT_BADGE,this.onDecrementBadge)},onDecrementBadge:function I(t){var e=this._getConversationHead(),i=this.getConversationHeadBadgeCount(),n=Math.max(i-1,0);e.setBadgeCount(n)},getPopupModuleLoadOptions:function T(){var t=n.clone(this.options);return t.peek=!0,n.isUndefined(this.options.peek)||(t.peek=this.options.peek),t.popup_log_component_type=o.GEN.ComponentType.CONVERSATION_MESSAGES,{name:"ConversationPopup",options:t,data:this.data}},focusInput:function N(){var t=this.getConversationPopup();t&&t.focus()},updateConversation:function S(t){this.data=t;var e=t.unread,i=this.getConversationPopup();if(this.popupIsVisible()){if(!i.isScrolledToBottom()){var n=this.getConversationHeadBadgeCount(),s=n+e;i.setUnseenMessageCount(s),this.setBadgeCount(s)}i.fetchNewMessages(e)}else this.setBadgeCount(e),i.fetchNewMessages(e,!0)},getConversationPopup:function b(){return this._popup.getContentModule()},focus:function y(){this.focusInput()},onDestroyed:function P(){this.closePopup()},showPopup:function B(){var t=this.getConversationHeadBadgeCount();t&&c.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_CONVERSATION_UNREAD_COUNT_DECREASE,t),this.setBadgeCount(0),this._popup.show(),this.focusInput()},adjustPopup:function A(){this._popup.reposition()},getConversationHeadBadgeCount:function R(){var t=this._getConversationHead();return t.getBadgeCount()},closePopup:function w(){this._popup.hide()},setBadgeCount:function O(t){var e=this._getConversationHead();e.setBadgeCount(t)},setActive:function D(){var t=this._getConversationHead();t.setActive()},setInactive:function x(){var t=this._getConversationHead();t.setInactive()},popupIsVisible:function L(){return this._popup.isVisible()},_getConversationHead:function k(){return this.getChildById("conversationHead")},onButtonClick:function U(t){var e=t.target;e.isCancelButton()&&(this.closePopup(),this.scaleConversationDownAndRemove())},scaleConversationDownAndRemove:function M(){this.parent.scaleConversationDownAndRemove(this.getConversationId())},closeConversation:function F(){this.parent.closeConversation(this)},openConversation:function $(){this.parent.openConversation(this)},getConversationId:function H(){return this.options.id}});p.prototype.className="Conversation",t.exports=a.register(p)},function(t,e,i){"use strict";var n=i(31),s={};s.getConversationFromUrl=function(){var t=n.getQueryStringParams(),e=window.location.pathname,i="/conversation/",s,o=0===e.indexOf(i);if((t.conversation||o)&&(s=t.conversation,!s)){var a=e.split(i),r=a[1];s=r.split("/")[0]}return s};var o=null;s.getDraggedObject=function(){return o},s.setDraggedObject=function(t){o=t},t.exports=s},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(156);i(116);var r=a.extend({events:{"click .headWrapper":"onClick"},CssClassName:n.extend(a.prototype.CssClassName,{DROPPABLE_HOVER:s.CLASS_DROPPABLE_HOVER,INACTIVE:"inactive",TOUCH:"touch"}),onContentReady:function l(){"ontouchstart"in window&&this.$el.addClass(this.CssClassName.TOUCH);var t=this.$el;this.options.inactive?window.setTimeout(function(){t.addClass(this.CssClassName.INACTIVE)}.bind(this),100):this.$el.removeClass(this.CssClassName.INACTIVE),this.triggerEvent(s.EVENT_CONVERSATION_HEAD_READY,null,!0)},getBadgeCount:function h(){return this.options.badge_count},setBadgeCount:function d(t){this.options.badge_count=t,this.render()},setActive:function c(){this.options.inactive=!1,this.$el.removeClass(this.CssClassName.INACTIVE)},setInactive:function u(){this.options.inactive=!0,this.$el.addClass(this.CssClassName.INACTIVE)},getUsers:function p(){return this.options.users||[]},toggleDroppableHover:function _(t){this.$el.toggleClass(this.CssClassName.DROPPABLE_HOVER,t)},getUserIds:function g(){return n.pluck(this.getUsers(),"id")},getExternalEmails:function m(){return this.options.emails||[]},getAllUserIds:function f(){return this.getUserIds().concat(this.getExternalEmails())},getFirstUserId:function C(){return this.getAllUserIds()[0]},onClick:function E(t){this.triggerEvent(s.EVENT_CONVERSATION_HEAD_CLICKED,null,!1)}});r.prototype.className="ConversationHead",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({getTokenData:function a(){return{}}});o.prototype.className="Token",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(3),o=i(11),a=i(8),r=function l(t){this.conversationsManager=t,this.conversationsUpdatesResource=a.create("ConversationsUpdatesResource",{}),this.poller=null,this._numRetries=0,this._requestConversationId=null,this._pollInterval=null};n.extend(r.prototype,s.Events),n.extend(r.prototype,{fetch:function h(){if(!this.pendingRequest){var t=this.conversationsManager.getOpenConversationId();t&&(this.pendingRequest=!0,this._requestConversationId!==t&&(this._requestConversationId=t,
this.conversationsUpdatesResource.resetBookmark(),this.conversationsUpdatesResource.setOptions({conversation_ids:[this._requestConversationId]})),this.conversationsUpdatesResource.callGet({showError:!1}).then(function(t){this.pendingRequest=!1,this._numRetries=0;var e=t.resource_response.data,i=e.updated_conversations||[];this._activated&&e.wait&&this._setNextPoll(1e3*e.wait),i.length>0&&this.trigger("active_conversations",i)}.bind(this),function(){this.pendingRequest=!1,this.deactivateIfNecessary()}.bind(this)))}},deactivateIfNecessary:function d(){this._numRetries++,this._numRetries>5&&this.deactivate()},deactivate:function c(){this._resetPoller(),this.pendingRequest=!1,this._activated=!1},activate:function u(){this._setNextPoll(o.OPEN_CONVERSATION_MIN_POLL),this._numRetries=0,this._activated=!0},_setNextPoll:function p(t){this.pendingRequest||(t&&this._pollInterval===t||this._resetPoller(),t&&this._pollInterval!==t&&(this.poller=window.setInterval(function(){this.fetch()}.bind(this),t)),this._pollInterval=t)},_resetPoller:function _(){this.poller&&clearInterval(this.poller),this.poller=null,this._pollInterval=null},isActive:function g(){return this._activated}}),t.exports=r},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(3),a=i(11),r=i(8),l=i(34),h="mousemove.updater",d=function c(){this.decay=0,this.lastFetchTime=0,this.timeout=null,this.recentPinId=null,this._minPoll=a.UPDATES_MIN_POLL,this._numRetries=0,this.updatesResource=r.create("UpdatesResource",{}),s(document).on(h,n.throttle(function(){this.wake()}.bind(this),1e3)),this.deferredFetch()};n.extend(d.prototype,o.Events),n.extend(d.prototype,{getUpdatesResourceOptions:function u(){var t={};return this.recentPinId&&(t.last_pin_id=this.recentPinId),t},setRecentPinId:function p(t){this.recentPinId=t},setMinPoll:function _(t){this._minPoll=t},wake:function g(){this.msSinceLastFetch()>this._minPoll&&(this._numRetries=0,this.decay=0,this.fetch())},fetch:function m(){clearTimeout(this.timeout),this.lastFetchTime=(new Date).getTime(),this.updatesResource.setOptions(this.getUpdatesResourceOptions()),this.updatesResource.callGet({showError:!1}).then(function(t){var e=t.resource_response.data;this._numRetries=0,n.each(e,function(t,e){this.trigger(e,t)}.bind(this)),this.deferredFetch()}.bind(this),function(){this.attemptDeferredFetch()}.bind(this))},attemptDeferredFetch:function f(){this._numRetries++,this._numRetries<5?this.deferredFetch():s(document).off(h)},deferredFetch:function C(){this.decay=Math.min(2*(this.decay||1e3),a.UPDATES_MAX_POLL),this.timeout=l.setTimeout(function(){this.fetch()}.bind(this),this._minPoll+this.decay)},msSinceLastFetch:function E(){return(new Date).getTime()-this.lastFetchTime}}),d.instance=function(){return d._instance||(d._instance=new d),d._instance},t.exports=d},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({events:{"click .gridError .Button":"onTryAgainClick"},CssClassName:{SHOW_GRID_LOADING:"showGridLoading"},onContentReady:function r(){this.options.state_isShown=!1,this.options.state_isGridLoading=!1,this.options.state_isGridError=!1},updateDom:function l(){this.options.state_isShown&&this.$el.css("display","block"),this.$el.toggleClass(this.CssClassName.SHOW_GRID_LOADING,this.options.state_isGridLoading),this.options.state_isGridError?this.$el.find(".gridError").css("display","block"):this.$el.find(".gridError").css("display","none")},onTryAgainClick:function h(t){this.triggerEvent(n.EVENT_BUTTON_CLICK,t,!0)},show:function d(){this.updateOptionsAndDom({state_isShown:!0})},showError:function c(){this.updateOptionsAndDom({state_isGridError:!0})},hideError:function u(){this.updateOptionsAndDom({state_isGridError:!1})},showGridLoading:function p(){this.updateOptionsAndDom({state_isGridLoading:!0})},hideGridLoading:function _(){this.updateOptionsAndDom({state_isGridLoading:!1})}});a.prototype.className="GridFooter",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(154),r=i(52),l=i(16),h=i(50),d=i(62),c=i(30),u=i(8),p=i(126),_=i(80),g=i(81),m=i(19),f=i(161),C=i(23),E=i(34);i(162),i(128),i(163),i(143),i(164),i(150),i(165),i(166),i(216);var v=l.getLogger("SortManager"),I=c.siteConst.MIN_COLUMNS,T=3e3,N=1e3,S=1e3,b="gridSortable",y="Pin",P=1e4,B={UP:0,DOWN:1},A=function F(t){var e=parseInt(t.replace("px",""),10);return isNaN(e)?0:e},R=function $(t){this.childModule=t,this.top=null,this.height=null,this.bottom=null,this.$itemWrapper=t.getParentElement().closest(".item"),this.columnIndex=null,this.inDom=!0,this.impressionReported=!1,this.impressionStart=null};R.prototype={log:l.getLogger("ItemInfo"),_logHeightError:n.throttle(function(){},1e3),_logHeightRecovery:n.throttle(function(){this.log.warn("recovered from unexpected height value")},1e3),_calculateHeight:function H(){this.height=this.$itemWrapper.height(),this.height<=0&&(this.$itemWrapper.appendTo(this.$itemWrapper.parent()),this.height=this.$itemWrapper.height(),this.height<=0?this._logHeightError():this._logHeightRecovery())},ensureHeightCalculated:function V(){null===this.height&&this._calculateHeight()},recalculateHeight:function G(){this.inDom?this._calculateHeight():this.log.debug("Cannot calculate height because this item is not inDom")},setPosition:function W(t,e){this.top=t,this.bottom=e},hasPosition:function K(){return null!==this.top}};var w=function j(){};w.prototype={resizeGrid:function Y(){},onChildContentChanged:function q(t){},onChildDimsChanged:function z(t){},onChildRendered:function X(t){},onChildAdded:function Q(t){},positionGridChildren:function Z(t){},empty:function J(){},recalculateItemMeasurements:function tt(){},positionGrid:function et(){},hideAndShowItems:function it(t,e,i,n,s){},onChildRemoved:function nt(t,e){},getFilledHeight:function st(){},logImpressions:function ot(t,e){},flushImpressions:function at(){},logInitialImpressions:function rt(t,e){}};var O=function lt(t,e){this.gridItems=t,this.options=e,this.shortestColumnIndex=0,this.columnLengths=[],this.childCidToItemInfo={},n.each(this.gridItems.children,function(t){this.childCidToItemInfo[t.cid]=new R(t)}.bind(this)),this._flushItemsToShow=this._flushItemsToShow.bind(this),this._flushItemsToHide=this._flushItemsToHide.bind(this),this.lastKnownItemInfosInViewport=[],this._itemsToHide={},this._itemsToShow={},this._ITEMS_TO_HIDE_THRESHOLD=50,this.viewableHeightMultiplier=e.viewableHeightMultiplier||2};O.prototype={getFilledHeight:function ht(){return this.columnLengths[this.shortestColumnIndex]},onChildRendered:function dt(t){this._reflowOnChildChanged(t)},onChildAdded:function ct(t){this.childCidToItemInfo[t.cid]=new R(t)},onChildRemoved:function ut(t,e){if(!this.gridItems.isEmptying){e.remove();var i=this.childCidToItemInfo[t.cid],n=i.columnIndex;delete this.childCidToItemInfo[t.cid],this._reflowColumnContent(n)}},empty:function pt(){this.childCidToItemInfo={}},recalculateItemMeasurements:function _t(){for(var t in this.childCidToItemInfo)this.childCidToItemInfo[t].recalculateHeight()},onChildContentChanged:function gt(t){this._reflowOnChildChanged(t)},onChildDimsChanged:function mt(t){this._reflowOnChildChanged(t,!1)},_reflowOnChildChanged:function ft(t,e){var i=this.childCidToItemInfo[t.cid];i.recalculateHeight(),this._reflowColumnContent(i.columnIndex,e)},_reflowColumnContent:function Ct(t,e){void 0===e&&(e=this.gridItems.extraData.reflow_all),e?this.positionGrid():this._repositionItemsInColumn(t)},_calculateNumColumns:function Et(){var t=this.options.minimum_num_columns||I;if(!this.itemWidth)return t;this.gridItems.extraData.centered||this.gridItems.$el.css("width","auto");var e=this.gridItems.getWidth(!1),i=Math.floor((e+1)/this.itemWidth),n=Math.max(t,i),s=this.options.maximum_num_columns||i;return Math.min(n,s)},_positionItemInColumn:function vt(t,e){if(this.gridItems.isReady()){var i=this.childCidToItemInfo[t.cid],n=i.$itemWrapper;e=Math.max(0,e),e=Math.min(this.columnLengths.length-1,e);var s=this.columnLengths[e];n.css({top:s+"px",left:e*this.itemWidth+"px",visibility:"visible"}),i.columnIndex=e;var o=i.height+this.topBuffer+this.bottomBuffer,a=s+o;i.setPosition(s,a),this.columnLengths[e]=a,this._setShortestColumnIndex()}},_positionItem:function It(t){var e;if(this.gridItems.isReady()){if(0===this.columnLengths.length){if(!this.itemWidth){var i=this.childCidToItemInfo[t.cid],n=i.childModule.$el,s=i.$itemWrapper,o=["padding-left","padding-right","border-left-width","border-right-width","margin-left","margin-right"],a=n.css(o),r=s.css(o),l=n.width();for(e=0;e<o.length;e++){var h=o[e];l+=A(a[h]),l+=A(r[h])}this.itemWidth=l;var d=s.css("margin-top"),c=s.css("padding-top"),u=s.css("margin-bottom"),p=s.css("padding-bottom");this.topBuffer=A(d)+A(c),this.bottomBuffer=A(u)+A(p)}var _=this._calculateNumColumns();this.gridItems.extraData.centered||this.gridItems.$el.css("width",_*this.itemWidth),this.columnLengths=new Array(_);var g=this.options.initial_column_lengths;if(g)for(e=0;e<g.length;e++)this.columnLengths[e]=g[e];this._setShortestColumnIndex()}var m=this.shortestColumnIndex;this._positionItemInColumn(t,m)}},_setShortestColumnIndex:function Tt(){this.shortestColumnIndex=0;for(var t=0;t<this.columnLengths.length;t++)this.columnLengths[t]=this.columnLengths[t]||0,this.columnLengths[t]<this.columnLengths[this.shortestColumnIndex]&&(this.shortestColumnIndex=t)},_repositionItemsInColumn:function Nt(t){if(this.gridItems.isReady()){this.columnLengths[t]=0;var e=n.filter(this.childCidToItemInfo,function(e){return e.columnIndex===t}),i=n.sortBy(e,function(t){return t.top});n.each(i,function(e){this._positionItemInColumn(e.childModule,t)}.bind(this)),this.resizeContainer()}},resizeGrid:function St(){var t=this.columnLengths.length,e=this._calculateNumColumns();t!==e&&(this.positionGridChildren(),this.gridItems.rearrangeItems(!0),this.gridItems.scheduleImpressionLogging())},resizeContainer:function bt(){var t=Math.max.apply(Math,this.columnLengths);this.gridItems.$el.css("height",t+"px"),this.gridItems.triggerEvent(o.EVENT_CONTENT_CHANGED,null,!0)},positionGrid:function yt(){this.gridItems.contentReady&&(this.positionGridChildren(),this.gridItems.rearrangeItems(),this.gridItems.scheduleImpressionLogging())},positionGridChildren:function Pt(t){this.gridItems.contentReady&&(t||(this.columnLengths=[]),n.each(this.gridItems.children,function(t){var e=this.childCidToItemInfo[t.cid];e.ensureHeightCalculated()}.bind(this)),n.each(this.gridItems.children,function(e){var i=this.childCidToItemInfo[e.cid];t&&i.hasPosition()||this._positionItem(i.childModule)}.bind(this)),this.resizeContainer())},hideAndShowItems:function Bt(t,e,i,n,s){var o;for(o in this.childCidToItemInfo){var a=this.childCidToItemInfo[o],l=a.$itemWrapper[0];a.bottom<n?t&&a.inDom&&(e||i!==B.DOWN||(this._itemsToHide[o]=l,delete this._itemsToShow[o],a.inDom=!1)):a.top>s?t&&a.inDom&&(e||i!==B.UP||(this._itemsToHide[o]=l,delete this._itemsToShow[o],a.inDom=!1)):a.inDom||(this._itemsToShow[o]=l,delete this._itemsToHide[o],a.inDom=!0)}Object.keys(this._itemsToShow).length&&r.deferDomManipulation(this._flushItemsToShow),Object.keys(this._itemsToHide).length>this._ITEMS_TO_HIDE_THRESHOLD&&r.deferDomManipulation(this._flushItemsToHide)},_flushItemsToShow:function At(){var t;this.gridItems.log.debug("_flushItemsToShow: showing ",Object.keys(this._itemsToShow).length);var e=document.createDocumentFragment();for(t in this._itemsToShow)e.appendChild(this._itemsToShow[t]);this.gridItems.$el[0].appendChild(e),this._itemsToShow={}},_flushItemsToHide:function Rt(){var t;this.gridItems.log.debug("_flushItemsToHide: hiding ",Object.keys(this._itemsToHide).length);for(t in this._itemsToHide){var e=this._itemsToHide[t];e.parentNode&&e.parentNode.removeChild(e)}this._itemsToHide={}},logImpressions:function wt(t,e){var i=this._getItemsInViewport(t,e),s=n.difference(this.lastKnownItemInfosInViewport,i);this.lastKnownItemInfosInViewport=i,this._reportImpressions(s)},logInitialImpressions:function Ot(t,e){var i=this._getItemsInViewport(t,e),s=n.intersection(this.knownItemInfosInLastInterval,i);this.knownItemInfosInLastInterval=i,this._reportImpressions(s)},_getItemsInViewport:function Dt(t,e){var i=[];return n.each(this.childCidToItemInfo,function(n){var s=n.top+this.topBuffer,o=n.bottom-this.bottomBuffer,a=!(s>=e||t>=o);a&&(i.push(n),null===n.impressionStart&&(n.impressionStart=Date.now()))}.bind(this)),i},flushImpressions:function xt(){this._reportImpressions(this.lastKnownItemInfosInViewport)},_reportImpressions:function Lt(t){function e(t){if(void 0!==t&&null!==t){var e=new Image;e.src=t.url,e.onload=function(){e=null}}}if(!this.options.disable_impression_logging){for(var i=n.filter(t,function(t){return!t.impressionReported}),s=[],a=0;a<i.length;a++){var r=i[a],l=r.childModule.data?r.childModule.data.view_tags:[],h=r.childModule.data?null!==r.childModule.data.buyable_product:!1;if(r.childModule.className===y){var d=r.childModule.getLoggingObjectIdStr();if(d){var c=r.childModule.getGridIndex(),u={time:1e6*r.impressionStart,pinIdStr:d,endTime:1e6*Date.now(),yPosition:r.top,columnIndex:r.columnIndex,slotIndex:c};h&&(u.richTypes=[o.GEN.PinImpressionRichType.BUYABLE]),s.push(u),r.impressionReported=!0}l?l.forEach(e):r.log.debug("view_tags field is missing")}}if(s.length){var p=this.options.impression_event_type||o.GEN.EventType.PIN_IMPRESSION_ONE_PIXEL,m=_.fromEventType(p);m.setPinImpressions(s),this.options.impression_component_type&&m.setComponent(this.options.impression_component_type),this.options.impression_metadata&&m.updateAuxData(this.options.impression_metadata),g.getInstance().addEvent(m)}}}};var D=function kt(t,e){this.gridItems=t,this.options=e,this.viewableHeightMultiplier=2};D.prototype={resizeGrid:function Ut(){},onChildContentChanged:function Mt(){},onChildDimsChanged:function Ft(){},onChildRendered:function $t(){},onChildAdded:function Ht(t){},positionGridChildren:function Vt(){},empty:function Gt(){},recalculateItemMeasurements:function Wt(){},positionGrid:function Kt(){this.gridItems.isReady()&&this.gridItems._requestMoreItemsIfNeeded()},hideAndShowItems:function jt(t,e,i,n,s){},onChildRemoved:function Yt(t,e){e.remove(),this.gridItems.triggerEvent(o.EVENT_CONTENT_CHANGED,null,!0)},getFilledHeight:function qt(){var t=this.gridItems.getWidth(!1),e=this.gridItems.children.length;if(0===e)return 0;var i=this.gridItems.children[0],n=i.$el.outerWidth(!0),s=i.$el.outerHeight(!0),o=Math.floor(t/n),a=Math.ceil(e/o),r=e%o!==0,l=a*s;return r&&(l-=s),l},logImpressions:function zt(){},flushImpressions:function Xt(){},logInitialImpressions:function Qt(){}};var x=function Zt(t,e){this.gridItems=t,this.options=e,this.childCidToItemInfo={},n.each(this.gridItems.children,function(t){this.childCidToItemInfo[t.cid]=new R(t)}.bind(this))};x.prototype={resizeGrid:function Jt(){},onChildContentChanged:function te(){},onChildDimsChanged:function ee(){},onChildRendered:function ie(){},onChildAdded:function ne(t){this.childCidToItemInfo[t.cid]=new R(t),this.resizeContainer()},onChildRemoved:function se(t,e){this.resizeContainer()},positionGridChildren:function oe(){this.gridItems.isReady()&&this.resizeContainer()},empty:function ae(){},recalculateItemMeasurements:function re(){},positionGrid:function le(){this.gridItems.isReady()&&(this.resizeContainer(),this.resetGridChildrenPosition(),this.gridItems._requestMoreItemsIfNeeded())},resizeContainer:function he(){var t=0;n.each(this.gridItems.children,function(e){var i=this.childCidToItemInfo[e.cid],n=i.childModule;n.data&&!n.$el.is(":hidden")&&(t+=n.getWidth()+c.siteConst.PIN_MARGIN)}.bind(this)),this.gridItems.$el.css("width",t+"px")},hideAndShowItems:function de(t,e,i,n,s){},getFilledHeight:function ce(){},getFilledWidth:function ue(){return this.gridItems.getWidth(!1)},resetGridChildrenPosition:function pe(){n.each(this.gridItems.children,function(t){var e=this.childCidToItemInfo[t.cid];this._resetItemPosition(e.childModule)}.bind(this))},_resetItemPosition:function _e(t){var e=this.childCidToItemInfo[t.cid],i=e.$itemWrapper;i.css({left:"",top:""})},logImpressions:function ge(){},flushImpressions:function me(){},logInitialImpressions:function fe(){}};var L=function Ce(t,e){var i=this;this.gridItems=t,e||(e={}),this.draggableOptions=n.extend({appendTo:s(".App"),cursor:"move",distance:3,handle:".draggable",helper:"clone",opacity:.35,scroll:!1,revert:!1,zIndex:N,drag:function o(t,e){var i=parseInt(s(this).data("startingScrollTop"),10);e.position.top-=i;var n=t.clientX-e.position.left,o=window.pageYOffset+t.clientY-e.position.top,a=e.helper.height(),r=e.helper.width(),l=n/r*100,h=o/a*100,d=""+l+"% "+h+"%";e.helper.css("transformOrigin",d)},start:function r(t,e){var n=i.gridItems.getChildByElement(s(t.target).find(".Module"));n&&a.setDraggedObject(n),s(this).data("startingScrollTop",window.pageYOffset-c.siteConst.PIN_MARGIN)},stop:function l(t,e){var i=parseInt(s(this).data("startingScrollTop"),10);a.setDraggedObject(null),e.position.top-=i}},e),this.gridItems.$(".item").draggable(this.draggableOptions)};L.prototype={enable:function Ee(){void 0!==s.fn.draggable&&this.gridItems.$(".item").draggable("enable")},disable:function ve(){void 0!==s.fn.draggable&&this.gridItems.$(".item").draggable("disable")},disableForModule:function Ie(t){void 0!==s.fn.draggable&&t.getParentElement().draggable("disable")},onChildAdded:function Te(t){t.getParentElement().draggable(this.draggableOptions)}};var k=function Ne(t,e){this.gridItems=t,e||(e={}),this.droppableOptions=n.extend({tolerance:"pointer"},e),this.gridItems.$(".item").droppable(this.droppableOptions)};k.prototype={enable:function Se(){void 0!==s.fn.droppable&&this.gridItems.$(".item").droppable("enable")},disable:function be(){void 0!==s.fn.droppable&&this.gridItems.$(".item").droppable("disable")},disableForModule:function ye(t){void 0!==s.fn.droppable&&t.getParentElement().droppable("disable")},onChildAdded:function Pe(t){var e=t.getParentElement();e.droppable(this.droppableOptions)}};var U=function Be(t,e,i,s){this.gridItems=t,e||(e={}),e=n.extend({containment:"parent",cursor:"move",helper:"clone",items:"."+b,tolerance:"pointer",zIndex:S},e),this.gridItems.$el.sortable(e),this.childModuleName=i,this.idFn=s,this._setSortableMetadata(),this._hasNewElements=!0};U.prototype={_setSortableMetadata:function Ae(){n.each(this.gridItems.getChildrenByModuleName(this.childModuleName),function(t){this._addSortableItemClass(t)}.bind(this))},_addSortableItemClass:function Re(t){var e=t.getParentElement();e.addClass(b)},onChildAdded:function we(t){this._addSortableItemClass(t),this._hasNewElements=!0},getSortOrder:function Oe(){var t=this.idFn,e=[];return this._hasNewElements&&(n.each(this.gridItems.getChildrenByModuleName(this.childModuleName),function(e){e.$el.attr("data-sort-id")||e.$el.attr("data-sort-id",t(e))}),this._hasNewElements=!1),n.each(this.gridItems.$el.find("."+this.childModuleName),function(t){var i=s(t).attr("data-sort-id");i?e.push(i):v.error("child module's data-sort-id is null or undefined",{boardHtml:t.parentNode.innerHTML})}),e}};var M=h.extend({events:{"click .trackActiveItem .item":"onTrackItemClick","click .itemClickMask":"onItemMaskClick"},CssClassName:{ACTIVE_ITEM:"activeItem",HAS_SCROLL:"hasScroll",ITEM:"item",LOADING_ITEMS:"loadingItems"},mixins:[f],onChildNavigate:function De(t){var e=t.currentTarget;this.updateActiveItem(e.getParentElement())},onItemMaskClick:function xe(t){this.options.item_click_mask_options.log_element_type&&this._logContextEvent(t);var e=s(t.currentTarget),i=e.next(),n=this.getChildByElement(i[0]);return n?void this.triggerEvent(o.EVENT_GRID_ITEM_SELECTED,{module:n},!0):void this.log.error("cannot find selected child module.")},onTrackItemClick:function Le(t){var e=t.currentTarget;this.updateActiveItem(s(e))},updateActiveItem:function ke(t){var e=this.$(".activeItem");e.removeClass(this.CssClassName.ACTIVE_ITEM),t.addClass(this.CssClassName.ACTIVE_ITEM)},setActiveItemById:function Ue(t){for(var e=this.children||[],i=0;i<e.length;i++){var n=e[i];n.data&&n.data.id===t&&this.updateActiveItem(n.$el.parent())}},onCreated:function Me(){this._scrollListener=null,this._scrollStopListener=null,this.alreadyInitialized=!1,this.scrollTop=0,this.lastScrollTop=null,this.viewableHeight=null,this.lastTopBorder=null,this.lastBottomBorder=null,this.layoutManager=null,this.initialImpressionLoggingInterval=null,this.childListen(o.EVENT_CONTENT_CHANGED,this.onChildContentChanged),this.childListen(o.EVENT_DIMS_CHANGED,this.onChildDimsChanged);var t={};t[o.PUBSUB_TOPIC_NAVIGATE_STARTED]=function(){this.layoutManager&&this.layoutManager.flushImpressions()}.bind(this),this.pubsubSubscribe(o.PUBSUB_CHANNEL_SITE,t),this.maxSize=n.isUndefined(this.options.max_size)?null:this.options.max_size,this.maxSize&&this.maxSize<o.DEFAULT_PAGE_SIZE&&this.setPageSize(this.maxSize)},initializeSortManager:function Fe(t,e,i){this.sortManager=new U(this,t,e,i)},initializeDragManager:function $e(t){this.dragManager=new L(this,t)},enableDragging:function He(){this.dragManager&&this.dragManager.enable()},disableDragging:function Ve(){this.dragManager&&this.dragManager.disable()},disableDraggingForChildModule:function Ge(t){this.dragManager&&this.dragManager.disableForModule(t)},initializeDropManager:function We(t){this.dropManager=new k(this,t)},enableDropping:function Ke(){this.dropManger&&this.dropManager.enable()},disableDropping:function je(){this.dropManger&&this.dropManager.disable()},disableDroppingForChildModule:function Ye(t){this.dropManager&&this.dropManager.disableForModule(t)},getSortOrder:function qe(t,e){return this.sortManager?this.sortManager.getSortOrder(t,e):void 0},getChildModuleAtIndex:function ze(t,e){var i=this.children[t];return i&&i.className===e?i:null},getChildren:function Xe(){return this.children},onOptionsChanged:function Qe(t,e){this._setScrollableElement(),this.alreadyInitialized=!1},onResourceChanged:function Ze(t,e){this.alreadyInitialized=!1},prependChildItem:function Je(t){var e=0;this.children.length>0&&this.children[0].options.anchored&&(e=1);var i;this.children.length>e&&(i=this.children[e].$el.parent()),this.insertChildBefore(t,this.$el,e,i),this.layoutManager.positionGrid()},prependNewItems:function ti(t,e){var i=0,s=u.clone(this.resource);s.resetBookmark(),s.set("prepend",!1),s.set("page_size",t);var o=new M({resource:s});this.children.length>0&&this.children[0].options.anchored&&(i=1),o.options=this.options,o.render().then(function(){n.each(o.children.reverse(),function(t){t.remove(),this.insertChild(t,this.$el,i)}.bind(this)),this.layoutManager.positionGrid(),e&&e()}.bind(this))},requestMoreItems:function ei(){this.isReady()&&this._requestMoreItems()},requestMoreItemsIfNeeded:function ii(){this.isReady()&&this._requestMoreItemsIfNeeded()},hasMoreItems:function ni(){var t=this.resource&&!this.resource.atEnd(),e=n.isNull(this.maxSize)?!0:this.children.length<this.maxSize;return e&&t},_triggerIfItemsEnd:function si(){this.hasMoreItems()||this.triggerEvent(o.EVENT_ITEMS_END,null,!0)},setPageSize:function oi(t){this.resource&&this.resource.set("page_size",t)},setHasScroll:function ai(t){this.$el.toggleClass(this.CssClassName.HAS_SCROLL,t)},onAddedToDom:function ri(){this.resizeListener=this.listen(p,o.EVENT_RESIZE,this.onResize),this.navigateListener=this.childListen(o.EVENT_NAVIGATE,this.onChildNavigate),this._setUpGrid(),this.isReady()&&this.layoutManager.recalculateItemMeasurements(),this.onResize()},onResize:function li(){this.isReady()&&this.layoutManager.resizeGrid()},hasItems:function hi(){return this.children.length>0},onContentReady:function di(){this.$el.removeClass(this.CssClassName.LOADING_ITEMS);var t=this.options.layout;"fixed_height"===t?this.layoutManager=new D(this,this.options):"row_layout"===t?this.layoutManager=new x(this,this.options):this.layoutManager=new O(this,this.options),this._setUpGrid(),this._triggerIfItemsEnd(),this.initialImpressionLoggingInterval=E.setInterval(this.scheduleInitialImpressions.bind(this),P)},onRemovedFromDom:function ci(){this.pubsubUnsubscribe(o.PUBSUB_CHANNEL_SITE),E.clearInterval(this.initialImpressionLoggingInterval),this.initialImpressionLoggingInterval=null,this._scrollListener&&(this.removeListener(this._scrollListener),this._scrollListener=null),this._scrollStopListener&&(this.removeListener(this._scrollStopListener),this._scrollStopListener=null),this.stopPreventScroll(),this.layoutManager&&this.layoutManager.flushImpressions(),this.navigateListener&&this.removeListener(this.navigateListener),this.resizeListener&&this.removeListener(this.resizeListener)},onChildContentChanged:function ui(t){t.stopPropagation();var e=t.currentTarget;this.isReady()&&(this.layoutManager.onChildContentChanged(e),this.rearrangeItems(!0),this.scheduleImpressionLogging())},onChildDimsChanged:function pi(t){t.stopPropagation();var e=t.currentTarget;this.isReady()&&this.layoutManager.onChildDimsChanged(e)},onChildRendered:function _i(t){this.isReady()&&this.layoutManager.onChildRendered(t)},onChildAdded:function gi(t){t&&t.data&&(t.data.grid_index=this.children.length-1);var e=t.getParentElement();if(!e.hasClass(this.CssClassName.ITEM)){var i=s("<div></div>").addClass(this.CssClassName.ITEM);i.insertBefore(t.$el),i.append(t.$el),e=i}this.layoutManager&&this.layoutManager.onChildAdded(t),this.dragManager&&this.dragManager.onChildAdded(t),this.dropManager&&this.dropManager.onChildAdded(t),this.sortManager&&this.sortManager.onChildAdded(t)},onChildRemoved:function mi(t,e){this.layoutManager&&this.layoutManager.onChildRemoved(t,e)},empty:function fi(){this.isEmptying=!0,h.prototype.empty.call(this),this.alreadyInitialized=!1,this.contentReady=!1,this.layoutManager&&this.layoutManager.empty(),this.isEmptying=!1},handleError:function Ci(t){this.pendingMoreRequest?this.$(".errorMessage").remove():h.prototype.handleError.call(this,t)},_setUpGrid:function Ei(){this._setScrollableElement(),this.isReady()&&!this.alreadyInitialized&&(this.layoutManager.positionGrid(),this.alreadyInitialized=!0,this._computeScrollableHeightAndOffset())},_setScrollableElement:function vi(){var t=n.throttle(this._onScroll,16),e=n.debounce(this._onScrollStop,2e3);this._scrollListener&&(this.removeListener(this._scrollListener),this._scrollListener=null),this._scrollStopListener&&(this.removeListener(this._scrollStopListener),this._scrollStopListener=null),this.scrollableElement=this.getScrollableElement(),this.options.scrollable&&(this._scrollListener=this.listen(this.scrollableElement,"scroll",t),this._scrollStopListener=this.listen(this.scrollableElement,"scroll",e)),this._preventDefaultIfNeeded()},isReady:function Ii(){return this.inDom&&this.contentReady},rearrangeItems:function Ti(t){this._requestMoreItemsIfNeeded(),this._hideAndShowItems(t)},positionGrid:function Ni(){this.layoutManager.positionGrid()},_onScroll:function Si(t){this.lastScrollTop=this.scrollTop,this.scrollTop=this.getScrollableElement().scrollTop(),this.lastScrollTop!==this.scrollTop&&(this.rearrangeItems(!0),this.scheduleImpressionLogging(),C.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_WINDOW_SCROLL_CHANGE))},_onScrollStop:function bi(t){this.layoutManager._flushItemsToHide&&r.deferDomManipulation(this.layoutManager._flushItemsToHide)},scheduleImpressionLogging:function yi(){this._impressionLoggingScheduled||(this._impressionLoggingScheduled=!0,r.deferDomManipulation(function(){this._impressionLoggingScheduled=!1;var t=this.scrollTop-this.offsetFromScrollElement,e=t+this.viewableHeight;this.layoutManager.logImpressions(t,e)}.bind(this)))},scheduleInitialImpressions:function Pi(){var t=this.scrollTop-this.offsetFromScrollElement,e=t+this.viewableHeight;this.layoutManager.logInitialImpressions(t,e)},_hideAndShowItems:function Bi(t){if(this.extraData.virtualize){t=t||!1;var e=!this.lastScrollTop||this.scrollTop>=this.lastScrollTop?B.DOWN:B.UP,i=this.scrollTop-this.offsetFromScrollElement,n=i+this.viewableHeight,s=i-T,o=n+T,a=null===this.lastTopBorder||null===this.lastBottomBorder||i<this.lastTopBorder||n>this.lastBottomBorder;(a||t)&&(this.layoutManager.hideAndShowItems(t,this.pendingMoreRequest,e,s,o),this.lastTopBorder=s,this.lastBottomBorder=o)}},onRendered:function Ai(){this._requestMoreItemsIfNeeded(),h.prototype.onRendered()},_computeScrollableHeightAndOffset:function Ri(){this.viewableHeight=this.scrollableElement.height(),this.offsetFromScrollElement=this.$el.positionAncestor(this.scrollableElement).top},_requestMoreItemsIfNeeded:function wi(){if(this.isReady()&&this.options.scrollable&&!this.pendingMoreRequest&&!this.hasError&&this.hasMoreItems()){if(this._computeScrollableHeightAndOffset(),this.layoutManager instanceof O||this.layoutManager instanceof D){var t=this.offsetFromScrollElement+this.layoutManager.getFilledHeight();if(t-(this.viewableHeight+this.scrollTop)>this.layoutManager.viewableHeightMultiplier*this.viewableHeight)return}else if(this.layoutManager instanceof x){var e=this.layoutManager.getFilledWidth(),i=this.parent.scrollLeft,n=p.width;if(e>i+n)return}this._requestMoreItems()}},_requestMoreItems:function Oi(t){if(n.isUndefined(t)&&(t=2),!this.pendingMoreRequest){if(this.maxSize&&this.children){var e=this.maxSize-this.children.length;if(0>=e)return;e<o.DEFAULT_PAGE_SIZE&&this.setPageSize(e)}this.triggerEvent(o.EVENT_ITEMS_REQUEST_START,null,!0),this.pendingMoreRequest=!0,this.renderAdditional(d.APPEND).then(function(){this.layoutManager.positionGridChildren(!0),this.pendingMoreRequest=!1,this.hasError&&(this.triggerEvent(o.EVENT_ERROR_RESOLVED,null,!0),this.hasError=!1),this.triggerEvent(o.EVENT_ITEMS_REQUEST_SUCCESS,null,!0),this._requestMoreItemsIfNeeded(),this._triggerIfItemsEnd(),this.scheduleImpressionLogging()}.bind(this),function(){t>0?this._requestMoreItems(t-1):(this.hasError=!0,this.triggerEvent(o.EVENT_ERROR,null,!0),this._triggerIfItemsEnd())}.bind(this))}},_preventDefaultIfNeeded:function Di(){this.options.prevent_default_scroll&&this.startPreventScroll(this.scrollableElement,this.$el)},switchLayoutManager:function xi(t){this.$el.css({height:"",width:""}),"fixedHeightLayout"===t?this.layoutManager=new D(this,this.options):"rowLayout"===t?this.layoutManager=new x(this,this.options):this.layoutManager=new O(this,this.options),this.positionGrid()},reorderChildModule:function Li(t,e){var i=this.children.indexOf(t);this.children.splice(i,1);var n=this.children.indexOf(e);this.children.splice(n,0,t),this.layoutManager.positionGridChildren()}}),M=M;M.prototype.className="GridItems",t.exports=m.register(M)},function(t,e){"use strict";var i=function s(){};i.prototype.listen=function(t){};var n={startPreventScroll:function o(t,e){this.stopPreventScroll(),this._preventScrollListener=this.listen(t,"mousewheel",function(i){var n=i.originalEvent.wheelDeltaY<0?"down":"up",s=t.scrollTop();if("down"===n){var o=t.outerHeight()+s;o>=e.outerHeight()&&i.preventDefault()}else 0===s&&i.preventDefault()})},stopPreventScroll:function a(){this._preventScrollListener&&(this.removeListener(this._preventScrollListener),this._preventScrollListener=null)}};t.exports=n},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="ImportantImage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="Category",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="Product",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(29),r=i(18),l=i(23),h=i(8);i(116),i(128);var d=5e3,c=o.extend({onContentReady:function u(){this.declineButton=this.getChildById("declineButton"),this.removeButton=this.getChildById("removeButton"),this.acceptButton=this.getChildById("acceptButton"),this.approveButton=this.getChildById("approveButton"),this.declineButton&&this.listen(this.declineButton,n.EVENT_BUTTON_CLICK,this.onClickDecline),this.removeButton&&this.listen(this.removeButton,n.EVENT_BUTTON_CLICK,this.onClickRemove),this.acceptButton&&this.listen(this.acceptButton,n.EVENT_BUTTON_CLICK,this.onClickAccept),this.approveButton&&this.listen(this.approveButton,n.EVENT_BUTTON_CLICK,this.onClickApprove);
},getConfirmBoardInvite:function p(){return"boardEdit"===this.options.view_type},deleteBoardInvite:function _(t){var e=this._getCurrentUserIsInvitedUser(),i;i=e?"collaborator_decline_invite":"collaborator_delete_invite",a.trackEvent(i,n.GA_ACTION_CLICK),this.removeButton&&this.removeButton.showLoading();var s=!1;if(t){var o=t.data.formData;s=o&&o.ban}var r=this._getRemoveResource(s);r.callDelete({showError:!1}).then(function(){a.trackEvent(i,n.GA_ACTION_SUCCESS);var t=this.data.board.id;this.fadeOut(function(){this.destroy(),l.instance.publish(t,n.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED),s&&this.extraData.has_delete_permission&&l.instance.publish(t,n.PUBSUB_TOPIC_BOARD_BANNED_COLLABORATOR)}.bind(this)),e&&(l.instance.publish(n.PUBSUB_CHANNEL_CURRENT_USER,n.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF),l.instance.publish(t,n.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF))}.bind(this),function(){a.trackEvent(i,n.GA_ACTION_ERROR)}).fin(function(){this.removeButton.hideLoading()}.bind(this))},onClickDecline:function g(t){},onClickRemove:function m(t){var e=this.options.view_type;"boardCreate"===e?(this.triggerEvent(n.EVENT_BOARD_CREATE_USER_REMOVED,{type:"pinner",identifier:this.options.identifier},!0),this.destroy()):"email"===e?(this.triggerEvent(n.EVENT_BOARD_CREATE_USER_REMOVED,{type:"email",identifier:this.options.identifier},!0),this.destroy()):"facebook"===e?(this.triggerEvent(n.EVENT_BOARD_CREATE_USER_REMOVED,{type:"facebook",identifier:this.options.identifier},!0),this.destroy()):this.getConfirmBoardInvite()?this.confirmDeleteBoardInvite():this.deleteBoardInvite()},confirmDeleteBoardInvite:function f(){var t=this._getCurrentUserIsInvitedUser(),e=this._getInvitedUserFullName(),i={name:"RemoveUserFromBoardDialog",options:{template:"delete_board_invite",current_user_is_invited_user:t,invited_user_first_name:this.extraData.invitedUserFirstName,invited_user_full_name:e}};r.load(i).then(function(t){this.showInModal(t),this.listen(t,n.EVENT_CONFIRM,this.deleteBoardInvite)}.bind(this))},onClickAccept:function C(t){var e="collaborator_invite_accept";a.trackEvent(e,n.GA_ACTION_CLICK),this.acceptButton&&this.acceptButton.showLoading();var i=h.clone(this.resource);i.callUpdate().then(function(){a.trackEvent(e,n.GA_ACTION_SUCCESS);var t=this.$(".pending"),i=this.$(".success");if(this.data.board){var s=this.data.board.id;l.instance.publish(s,n.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED)}t.fadeOut(function(){i.fadeIn(function(){i.delay(d).fadeOut(function(){this.destroy()}.bind(this))}.bind(this))}.bind(this))}.bind(this),function(){a.trackEvent(e,n.GA_ACTION_ERROR)}).fin(function(){this.acceptButton.hideLoading()}.bind(this))},onClickApprove:function E(t){var e="collaborator_approve_invite",i=h.create("BoardInviteResource",this.resource.copyOptions(!0));this.approveButton&&this.approveButton.showLoading(),i.callUpdate().then(function(){a.trackEvent(e,n.GA_ACTION_SUCCESS),this.fadeOut(function(){this.destroy()}.bind(this));var t=this.data.board.id;l.instance.publish(t,n.PUBSUB_TOPIC_BOARD_APPROVED_COLLABORATOR_INVITE,{userId:this._getInviteUserId()})}.bind(this),function(){a.trackEvent(e,n.GA_ACTION_ERROR)}).fin(function(){this.approveButton.hideLoading()}.bind(this))},_getRemoveResource:function v(t){var e=this.extraData.accepted,i=e?"BoardCollaboratorResource":"BoardInviteResource",n=this.resource.copyOptions(!0);e&&this.getConfirmBoardInvite()&&(n.ban=t);var s=h.create(i,n);return s},_getInviteUserId:function I(){return this.extraData.invitedUserId},_getCurrentUserIsInvitedUser:function T(){return this.extraData.currentUserIsInvitedUser},_getInvitedUserFullName:function N(){return this.extraData.invitedUserFullName}});c.prototype.className="BoardInvite",t.exports=s.register(c)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(167),r=i(57),l=i(50),h=i(30),d=i(168),c=i(169),u=i(8),p=i(126),_=i(40),g=i(80),m=i(81),f=i(59),C=i(170),E=i(14),v=i(135),I=i(19),T=i(23),N=i(34),S=i(31),b=i(27);i(116),i(171),i(129),i(130),i(173),i(174),i(128),i(181),i(182),i(183),i(190),i(150),i(191),i(210),i(211),i(213),i(214);var y="editButton",P="mapPage",B="mouseenter."+P,A="mouseleave."+P,R={BOARD_PINS_GRID:"boardPinsGrid",DETAILED:"detailed",SUMMARY:"summary",VISUAL_OBJECT_GRID:"visualObjectGrid",PLAIN_IMAGE_GRID:"plainImageGrid",SENT_PIN:"sentPin",SENT_PIN_AS_BOARD:"sentPinAsBoard",SENT_PIN_AS_PIN:"sentPinAsPin"},w=[".likeEditButtonWrapper",".repinSendButtonWrapper"],O=[".hoverMask",".pinImageActionButtonWrapper"],D=l.extend({events:{"mouseleave .pinImageSourceWrapper":"onPinMouseout","click .bulkEditPinWrapper":"onBulkEditPinWrapperClick","click .placePinActivateWrapper":"onPlacePinActivateWrapperClick","click .playIndicatorPill.gifType":"onGifClick","click .richPinMeta.hasMapButton":"onRichPinMetaWithMapClick","click .vaseButton":"onVaseToggleClick","focus .pinImageActionButtonWrapper > a":"onPinImageActionButtonFocus","focus .pinImageActionButtonWrapper button":"onPinImageActionButtonFocus","blur .pinImageActionButtonWrapper a":"onPinImageActionButtonBlur","blur .pinImageActionButtonWrapper button":"onPinImageActionButtonBlur","focus .pinDescriptionInput":"onPinDescriptionInputFocus","blur .pinDescriptionInput":"onPinDescriptionInputBlur","click .pinDescription":"onPinDescriptionParagraphClick","click .pinImageActionButtonWrapper":"onPinClick"},CssClassName:{ACTION_BUTTON_FOCUSSED:"actionButtonFocussed",CLONED:"cloned",COLLAPSED:"collapsed",EDITING_DESCRIPTION:"editingDescription",HIDDEN:"hidden",MAP_FOCUS:"mapFocus",PIN_BLURRED:"blurred",PIN_BULK_EDIT:"bulkEditMode",PIN_CREDIT_HOVER:"creditHover",PIN_VISIBLE:"visible",PLACE_SUMMARY:"placeSummary",PLAYING:"playing",SELECTED:"selected",SQUISHED:"squished"},onPinMouseout:function x(t){var e=this.getChildById("sendPinButton");if(e){var i=e.getDropdown();i&&i.isVisible()&&(this.toggleActionButtons(!0),this.toggleBlurredPin(!0))}},onPinClick:function L(t){this.triggerEvent(o.EVENT_PIN_IMAGE_CLICK,this,!0)},onPinDescriptionParagraphClick:function k(t){this.isCloneForRepin()&&(this.$el.addClass(this.CssClassName.EDITING_DESCRIPTION),this.getPinDescriptionInput().is(":focus")||this.getPinDescriptionInput().focus())},onRendered:function U(){this.inDesktopPlaceBoard()&&this.triggerEvent(o.EVENT_PIN_CONTENT_CHANGED,this,!0)},isCloneForRepin:function M(){return this.options.is_clone_for_repin},inDesktopPlaceBoard:function F(){return this.options.in_desktop_place_board},setPinImages:function $(t){var e=this.data;e.image_url=t;var i=e.images;i["236x"].url=t,i["474x"].url=t},getPinDescriptionInput:function H(){return this.$(".pinDescriptionInput")},getPinDescriptionElement:function V(){return this.$(".pinDescription")},getDescriptionText:function G(){var t=this.data.description;if(!this._clamp)return t;var e=s("<div>");return t=this._clamp.original,f.instance.v2InGroup("web_aggregated_pins",["employees","enabled"])&&""===t&&(t=this.data.description),e.html(t.replace(/<br\s*[\/]?>/gi,"\n")),e.text()},toggleActionButtonsVisibility:function W(t){this.$(".pinImageActionButtonWrapper").toggleClass(this.CssClassName.ACTION_BUTTON_FOCUSSED,t)},onPinImageActionButtonFocus:function K(t){this.toggleActionButtonsVisibility(!0)},onPinImageActionButtonBlur:function j(t){this.toggleActionButtonsVisibility(!1)},onPinDescriptionInputFocus:function Y(t){if(this.isCloneForRepin()&&(this.$el.addClass(this.CssClassName.EDITING_DESCRIPTION),!this.getPinDescriptionInput().is(":focus"))){var e=this._clamp.original.trim();this.getPinDescriptionInput().html(e.replace(/<br\s*[\/]?>/gi,"\n"))}},onPinDescriptionInputBlur:function q(t){this.isCloneForRepin()&&N.setTimeout(function(){var t=this.getPinDescriptionInput().val();t=n.escape(this.getPinDescriptionInput().val()),this.$el.toggleClass(this.CssClassName.EDITING_DESCRIPTION,!t.length),this.getPinDescriptionElement().html(t.replace(/\n/g,"<br />")),this.clampDescription()}.bind(this),50)},toggleActionButtons:function z(t){this.$(w.join(", ")).toggleClass(this.CssClassName.PIN_VISIBLE,t)},toggleBlurredPin:function X(t){this.$(O.join(", ")).toggleClass(this.CssClassName.PIN_BLURRED,t),this.$(".pinCreditWrapper").toggleClass(this.CssClassName.PIN_CREDIT_HOVER,t)},onRichPinMetaWithMapClick:function Q(t){var e=this.getPinId();this.inDesktopPlaceBoard()||(this._forceSeeOnMap=!0),this.getPlaceData()&&this.triggerEvent(o.EVENT_PIN_PLACE_CLICK,e,!0)},getLoggingObjectIdStr:function Z(){return this.getPinId()},getPlaceData:function J(){return this.data.place_summary||this.data.place||null},getPinId:function tt(){return this.data&&this.data.id||this.resource.get("id")},isInFacebookTrendingExperiment:function et(){return this.data.is_in_facebook_trending_experiment},getPlaceProvider:function it(){var t=this.getPlaceData();return t?t.source_name:null},getPlaceProviderImage:function nt(){var t=this.getPlaceData();return t?t.source_icon:null},beginEditingDescription:function st(){this.$el.addClass(this.CssClassName.EDITING_DESCRIPTION),this.getPinDescriptionInput().focus().select()},onButtonClick:function ot(t){var e=t.target,i=e.id;switch(i){case"expandGiraffe":this.onExpandGiraffeClick(t),e.destroy(),this.$(".navLinkOverlay").removeClass(this.CssClassName.SQUISHED);break;case"addToMap":this.triggerEvent(o.EVENT_BOARD_CACHE_PIN_ID_TO_ADD_TO_MAP,this,!0);break;case"seeOnMap":e.setHighlight(!0);break;case"pinItToMapButton":var s=this.extraData.image;this.showLoading(!0),this.triggerEvent(o.EVENT_PINIT_BUTTON_CLICKED,s,!0);break;case"editDescription":this.beginEditingDescription();break;case"pinItButton":if(this._getViewType()===R.SUMMARY){var a=n.extend({},this.options,{is_clone_for_repin:!0}),l=new D({id:"pin",options:a,data:this.data});l.renderExistingData().then(function(){var t=l.getContent(),e=this.$el.parent(".item"),i=e.offset();t.css({opacity:"0",position:"absolute",top:i.top,left:i.left}),t.addClass(this.CssClassName.CLONED);var n=o.GEN.Placement.WEB_REPIN_DIALOG_TAKEOVER,s=o.GEN.Experience.WEB_SEO_NUX_CREATE_BOARD;r.instance.isPlacedExperience(n,s)||this.triggerEvent(o.EVENT_APPEND_CLONED_PIN,l,!0),v.get().setAnimatedModule(l)}.bind(this))}b.trackRegisterAction("pin_it_button_click")}},getId:function at(){return this.data.id},onExpandGiraffeClick:function rt(t){this.$(".pinImageWrapper").removeClass(this.CssClassName.COLLAPSED),this.triggerEvent(o.EVENT_DIMS_CHANGED,null,!0)},getSummaryImageUrl:function lt(){return this.data.images["236x"].url},getLink:function ht(){return this.data.link||null},getPlaceName:function dt(){var t=this.getPlaceData();return t?t.name:null},getBoardUrl:function ct(){return this.data.board.url},showEditModal:function ut(){var t=this.getChildById(y);return t?(t.showModalSubmodule(),!0):!1},getPinMedia:function pt(){var t=this._getViewType();switch(t){case R.DETAILED:case R.SENT_PIN:return this.isBuyablePin()?this.$(".CloseupBuyableProductCarousel img.pinImage"):this.isEmbed()&&!this.isGif()?this.$("iframe"):this.$(".PaddedPin img.pinImage");case R.BOARD_PINS_GRID:case R.VISUAL_OBJECT_GRID:case R.PLAIN_IMAGE_GRID:case R.SENT_PIN_AS_BOARD:case R.SENT_PIN_AS_PIN:return this.$("img");case R.SUMMARY:return this.$(".pinHolder .pinImg");default:return this.log.error("requesting pin media for unsupported view_type:"+t),null}},isBuyablePin:function _t(){return this.data.buyable_product},isEmbed:function gt(){return this.data.embed&&this.data.embed.src},isPinStory:function mt(){return this.data.embed&&"pinstory"===this.data.embed.subtype},isGif:function ft(){return this.data.embed&&"gif"===this.data.embed.type},isVideo:function Ct(){return this.data.is_video},getDominantColor:function Et(){return this.data.dominant_color||"#eee"},_getViewType:function vt(t){return this.options.view_type?this.options.view_type:R.SUMMARY},setDescriptionInputHeight:function It(){this.getPinDescriptionInput().height(this.getPinDescriptionElement().height())},clampDescription:function Tt(){var t=this.getPinDescriptionElement();t.length&&(t.html(t.html().trim()),this._clamp=window.$clamp(t[0],{clamp:6,useNativeClamp:!1}))},renderDescription:function Nt(){var t=this.$(".descriptionJS"),e=this.$(".richPinGridTitle"),i=this.extraData.description_html,n=this.extraData.richTitleTruncated;t&&i&&t.html(i),e&&n&&e.html(n)},onContentReady:function St(){l.prototype.onContentReady.call(this);var t=this.data.id;if(t){var e={};e[o.PUBSUB_TOPIC_PIN_HIDDEN]=this.onPinHidden,e[o.PUBSUB_TOPIC_PIN_HIDDEN_STOP_THROUGH_BOARD]=this.onPinHiddenStopThroughBoard,e[o.PUBSUB_TOPIC_PIN_HIDDEN_STOP_THROUGH_PIN]=this.onPinHiddenStopThroughPin,e[o.PUBSUB_TOPIC_PIN_HIDDEN_STOP_THROUGH_INTEREST]=this.onPinHiddenStopThroughInterest,e[o.PUBSUB_TOPIC_PIN_HIDDEN_UNFOLLOW]=this.onPinHiddenUnfollow,e[o.PUBSUB_TOPIC_PIN_HIDDEN_INTEREST_PAGE]=this.onPinHiddenUnfollow,e[o.PUBSUB_TOPIC_PIN_COMMENT_CREATED]=this.onPinCommentCreated,e[o.PUBSUB_TOPIC_PIN_COMMENT_DELETED]=this.onPinCommentDeleted,e[o.PUBSUB_TOPIC_PIN_REPINNED]=this.onPinRepinned,e[o.PUBSUB_TOPIC_PIN_DELETED]=this.onPinDeleted,e[o.PUBSUB_TOPIC_PIN_LIKED]=this.onPinLiked,e[o.PUBSUB_TOPIC_PIN_UNLIKED]=this.onPinUnliked,e[o.PUBSUB_TOPIC_PIN_UPDATED]=this.onPinUpdated,e[o.PUBSUB_TOPIC_PIN_FLAGGED]=this.onPinFlagged,e[o.PUBSUB_TOPIC_TOGGLE_BULK_EDIT]=this.toggleBulkEditMode,e[o.PUBSUB_TOPIC_BULK_PIN_UNSELECTED]=this.togglePinSelected,this.pubsubSubscribe(t,e)}this.listen(this,o.EVENT_NAVIGATE,this.onNavigate),this.childListen(o.EVENT_NAVIGATE,this.onNavigate),this.childListen(o.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(o.EVENT_DROPDOWN_SHOW,this.onDropdownShow),this.childListen(o.EVENT_DROPDOWN_HIDE,this.onDropdownHide),this.childListen(o.EVENT_MESSAGE_SENT,this.onMessageSent),this.childListen(o.EVENT_REQUIRES_AUTHENTICATION,function(t){t.data.contextualResource||(t.data.contextualResource=this.getContextualResource())}),this.listen(this,o.ADD_HOVER_LISTENER_FOR_MAP_MARKER,this.addHoverListenerForMapMarker),this.listen(this,o.REMOVE_HOVER_LISTENER_FOR_MAP_MARKER,this.removeHoverListenerForMapMarker),this._commentList=this.getChildById("comment_list"),this.getPinMedia().load(this.hideBackgroundText.bind(this)).each(function(){this.complete&&this.width<h.siteConst.PIN_WIDTH&&s(this).trigger("load")}),this.isCloneForRepin()&&this.clampDescription(),this.options.render_desc_with_js&&this.renderDescription()},onMessageSent:function bt(t){"sendPinButton"===t.currentTarget.id&&t.currentTarget.resetDropdown()},closeAddToMapModalIfNeeded:function yt(){var t=this.getChildById("addToMap");t&&v.get().removeTopModal()},onPinHidden:function Pt(t,e,i){var n=this.data,s=n.recommendation_reason,a={pin_id:n.id,feedback_type:o.GEN.PinFeedbackTypes.BLOCK_SINGLE_PFY_PIN},r={pin_id:n.id,feedback_type:o.GEN.PinFeedbackTypes.BLOCK_SINGLE_PFY_PIN,feedback_type_name:i,is_asking_for_feedback:!0};s?(a.promoted=!1,s.board?a.through_id=s.board.id:s.pin?a.through_id=s.pin.id:s.interest&&(a.through_id=s.interest.id),a.recommendation_reason_id=o.GEN.ReasonToChoose[s.reason]):a.promoted=!0,this._sendHidePinFeedback(a),this._showRemovePinDialog(r)},onPinHiddenStopThroughBoard:function Bt(t,e,i){this.onPinHiddenStopThroughObject("board",o.GEN.PinFeedbackTypes.BLOCK_PFY_THROUGH_BOARD,i)},onPinHiddenStopThroughPin:function At(t,e,i){this.onPinHiddenStopThroughObject("pin",o.GEN.PinFeedbackTypes.BLOCK_PFY_THROUGH_PIN,i)},onPinHiddenStopThroughInterest:function Rt(t,e,i){this.onPinHiddenStopThroughObject("interest",o.GEN.PinFeedbackTypes.BLOCK_PFY_THROUGH_INTEREST,i)},downvoteInterestPin:function wt(t,e,i){var n=this.getId(),s=o.FeedbackType.DOWNVOTE,a=this.data.source_interest?this.data.source_interest.id:"",r="/explore/"+this.data.source_interest.url_name,l=u.create("TopicPinFeedbackResource",{feedback_type:s,interest:a,interest_url_name:r,pin_id:n});l.callUpdate({showError:!0})},onPinHiddenUnfollow:function Ot(t,e,i){var n=this.data,s=i,a=null,r=null,l=null;switch(i){case o.FeedbackType.UNFOLLOW_INTEREST:a=n.source_interest.name,r="/explore/"+n.source_interest.url_name,l=n.source_interest.id;break;case o.FeedbackType.UNFOLLOW_BOARD:a=n.board.name,r=n.board.url,l=n.board.id;break;case o.FeedbackType.UNFOLLOW_PINNER:a=n.pinner.full_name,r="/"+n.pinner.username,l=n.pinner.id;break;case o.FeedbackType.DOWNVOTE:this.downvoteInterestPin();break;default:s=null}var h={pin_id:n.id,feedback_type_name:s,is_asking_for_feedback:!1,object_name:a,object_url_name:r,object_id:l};this._showRemovePinDialog(h)},onPinHiddenStopThroughObject:function Dt(t,e,i){var n=this.data,s=n.recommendation_reason,a=s[t]||{},r=o.GEN.ReasonToChoose[s.reason],l=null;switch(t){case"pin":l=a.title;break;case"board":case"interest":l=a.name}var h={pin_id:n.id,feedback_type:e,through_id:a.cacheable_id||a.id,recommendation_reason_id:r,promoted:!1},d={pin_id:n.id,feedback_type:e,feedback_type_name:i,is_asking_for_feedback:!1,recommendation_reason:n.recommendation_reason,promoter:n.promoter,through_id:a.cacheable_id||a.id,object_name:l};this._sendHidePinFeedback(h),this._showRemovePinDialog(d)},_sendHidePinFeedback:function xt(t){var e=u.create("PinFeedbackResource",t);e.callUpdate({showError:!0})},_showRemovePinDialog:function Lt(t){if(this.options.show_feedback_tool){var e=!1,i=f.instance.v2GetGroup("web_pin_feedback");["employee","enabled","rollout"].indexOf(i)>-1&&(e=!0);var s=null;s=e?new d({options:n.extend(t,{pin_height:this.$el.height(),background_color:this.data.dominant_color})}):new c({options:t}),s.render().then(function(){s.getContent().insertBefore(this.getContent()),s.parent=this.parent,e?"IE"===_.instance.browser_name?(this.$el.transition({transform:"rotateY(180deg)"},500),s.animateIn()):this.$el.parent().transition({transform:"rotateY(180deg)"},500):this.getContent().hide(),this.triggerEvent(o.EVENT_CONTENT_CHANGED,null,!0)}.bind(this))}},getImageUrl:function kt(t){if(!t)return"";var e=this.data.images;return e[t]?e[t].url:t===o.IMAGE_SIZE_ORIG&&e.originals?e.originals.url:""},getCoordinates:function Ut(){var t=this.getPlaceData();return t?[t.latitude,t.longitude]:null},getContextualResource:function Mt(){return u.create("PinResource",{id:this.getId()})},scrollIntoView:function Ft(){this._forceSeeOnMap=!0;var t=this.$el,e=t.offset().top,i=t.height(),n=p.height,o=s(".Header").height(),a;a=i>=n-o?e-i/2+p.height/2-o-1.5*h.siteConst.PIN_MARGIN:e-n/2-o/2+i/2,this.$el.addClass(this.CssClassName.MAP_FOCUS);var r=this.getChildById("seeOnMap");r&&r.setHighlight(!0),this._highlightMarkerOnMap();var l=function(){this._highlightMarkerOnMap()}.bind(this);b.scrollToTop({$scroller:null,newScrollOffset:a,callback:l})},resetShowOnMapButton:function $t(){var t=this.getChildById("seeOnMap");this.$el.removeClass(this.CssClassName.MAP_FOCUS),t&&(t.setHighlight(!1),this._forceSeeOnMap=!1)},hideBackgroundText:function Ht(){this.$(".pinDomain").addClass(this.CssClassName.HIDDEN),this.$(".pinCanonicalDescription").addClass(this.CssClassName.HIDDEN)},onGifClick:function Vt(t){t.preventDefault(),this.originalSrc||(this.originalSrc=this.$(".pinImg").attr("src"));var e=this.$(".playIndicatorPill.gifType");return this.isPlaying?(this.$(".pinImg").attr("src",this.originalSrc),e.removeClass(this.CssClassName.PLAYING)):(this.$(".pinImg").attr("src",this.data.embed.src),e.addClass(this.CssClassName.PLAYING)),this.isPlaying=!this.isPlaying,!1},onPinRepinned:function Gt(){this.incrementRepinCount()},addHoverListenerForMapMarker:function Wt(){var t=this.$el,e=this.getId(),i=this.getChildById("seeOnMap");this.removeHoverListenerForMapMarker(),t.on(B,function(t){this.triggerEvent(o.EVENT_PIN_MOUSE_IN,e,!0),i&&i.setHighlight(!0)}.bind(this)),t.on(A,function(t){this._forceSeeOnMap||(this.triggerEvent(o.EVENT_PIN_MOUSE_OUT,e,!0),i&&i.setHighlight(!1))}.bind(this))},getLocality:function Kt(){var t=this.getPlaceData();if(!t)return null;var e=t.address;return e?e.locality:null},_highlightMarkerOnMap:function jt(){var t=this.getPinId();this.triggerEvent(o.EVENT_PIN_PLACE_CLICK,t,!0)},removeHoverListenerForMapMarker:function Yt(){var t=this.$el;t.off(B+" "+A)},onDropdownShow:function qt(t){var e=t.target.options.view_type;"pickedForYou"===e?C.log("pickedForYouHoverShow",.01):"pinFeedbackTool"===e?this.toggleBlurredPin(!0):this.toggleActionButtons(!0)},onDropdownHide:function zt(t){this.toggleActionButtons(!1),this.toggleBlurredPin(!1)},isPinComment:function Xt(t){return"PinDescriptionComment"===t.target.className&&t.target.options.is_description===!1?!0:!1},onNavigate:function Qt(t){if(S.isOffsiteUrl(t.data.url)&&!this.isPinComment(t)){if(this.options.is_csr){t.data.csrId=this.data.id;var e={event_type:o.GEN.EventType.PIN_CLICKTHROUGH,view_type:o.GEN.ViewType.PIN,object_id_str:this.data.id},i=g.fromPlainObject(e);m.getInstance().addEvent(i)}if(this.data.buyable_product){var e={event_type:o.GEN.EventType.PIN_CLICKTHROUGH,view_type:o.GEN.ViewType.PIN,object_id_str:this.data.id},n=a.getCommerceAuxData(this.data),i=g.fromPlainObject(e);i.updateAuxData(n),m.getInstance().addEvent(i)}else t.data.pinId=this.data.id}this.hideDropdowns()},hideDropdowns:function Zt(){var t=this.getChildrenByModuleName("DropdownButton");n.each(t,function(t){t.getDropdown().hide()})},onBulkEditPinWrapperClick:function Jt(){var t=this.options.can_bulk_edit||!1,e=n.contains(this.data.access,"write");if(e||t){this.togglePinSelected();var i=this.data.id;i&&T.instance.publish(o.PUBSUB_CHANNEL_BULK_EDIT,o.PUBSUB_TOPIC_BULK_PIN_SELECTED,i)}},togglePinSelected:function te(){this.$(".bulkEditCheckbox").toggleClass(this.CssClassName.SELECTED)},changePinBulkEditMode:function ee(t){t?this.$el.addClass(this.CssClassName.PIN_BULK_EDIT):(this.$el.removeClass(this.CssClassName.PIN_BULK_EDIT),this.$(".bulkEditCheckbox").removeClass(this.CssClassName.SELECTED))},toggleBulkEditMode:function ie(t,e,i){this.changePinBulkEditMode(i===o.ENTER_BULK_EDIT)},onPlacePinActivateWrapperClick:function ne(t){this.triggerEvent(o.EVENT_PIN_PLACE_CLICK,this.getId(),!0)},focusPlacePin:function se(){var t=this.$el.height(),e=this.$el.parent(".item");this.$el.addClass(this.CssClassName.MAP_FOCUS);var i=t-this.$el.height()-h.siteConst.PIN_MARGIN;e.transition({y:i},300,"cubic-bezier(.19, 1, .48, 1)")},unfocusPlacePin:function oe(){var t=this.$el.parent(".item");t.transition({y:0},300,"cubic-bezier(.36, 0, .21, 1)",function(){this.$el.removeClass(this.CssClassName.MAP_FOCUS)}.bind(this))},onPinCommentCreated:function ae(){this._getViewType()===R.SUMMARY&&this.render()},onPinCommentDeleted:function re(){this._getViewType()===R.SUMMARY&&this.render()},onPinLiked:function le(){this.triggerEvent(o.EVENT_PIN_LIKED,null,!0);var t=this.getChildById("likeButton");t&&t.setState(!0),this.incrementLikeCount()},getSocialIconsCounts:function he(){return this.getChildById("socialIconsCounts")},onPinUnliked:function de(){this.triggerEvent(o.EVENT_PIN_UNLIKED,null,!0);var t=this.getChildById("likeButton");t&&t.setState(!1),this.decrementLikeCount()},incrementLikeCount:function ce(){var t=this.getSocialIconsCounts();t&&t.incrementLike()},incrementRepinCount:function ue(){var t=this.getSocialIconsCounts();t&&t.incrementRepin()},decrementLikeCount:function pe(){var t=this.getSocialIconsCounts();t&&t.decrementLike()},onPinFlagged:function _e(t,e,i){var n={pin_id:this.data.id,feedback_type_name:i,is_asking_for_feedback:!1};this._showRemovePinDialog(n)},onPinUpdated:function ge(t,e,i){this.triggerEvent(o.EVENT_PIN_UPDATED,i,!0),this.model&&this.model.set(i),this.render()},onPinDeleted:function me(t){this.triggerEvent(o.EVENT_PIN_DELETED,this,!0),this.destroy()},onVaseToggleClick:function fe(t){var e=this.getChildById("vaseButton");this.$(".vaseText.hidden")[0]?(e.setText(E._("Less")),this.$(".vaseText:not(.alwaysShow)").removeClass(this.CssClassName.HIDDEN)):(e.setText(E._("More")),this.$(".vaseText:not(.alwaysShow)").addClass(this.CssClassName.HIDDEN)),this.triggerEvent(o.EVENT_DIMS_CHANGED,null,!0)},getSourceUrl:function Ce(){return this.data.link||""},getFirstVisualObject:function Ee(){var t=this.getChildByModuleName("PaddedPin");return t?t.getFirstVisualObject():null},getPinWrapperElement:function ve(){return this.$(".pinWrapper")},updateSendPinDropdownPosition:function Ie(t){var e=this.getChildById("sendPinButton");e&&(e.getDropdownOptions().position_point=t)},configurePlacePinMode:function Te(t){t?(this.$el.addClass(this.CssClassName.PLACE_SUMMARY),this.$el.addClass(this.CssClassName.HIDDEN),this.getPlaceData()&&this.$el.removeClass(this.CssClassName.HIDDEN)):(this.$el.removeClass(this.CssClassName.PLACE_SUMMARY),this.$el.removeClass(this.CssClassName.HIDDEN))},emptyPaddedPin:function Ne(t,e){var i=this.getChildByModuleName("PaddedPin"),n=null;i&&(n=i.el.parentElement,i.empty(),n&&(n.style["padding-top"]=t))},isDescriptionValid:function Se(){var t=this.getChildById("pinDescriptionField");if(t){var e=t.options.maxlength,i=t.getUntrimmedValue();if(i&&e)return i.length<=e}return!0},getModuleAdditionalAuxData:function be(){var t=this.getGridIndex(),e={};n.isNumber(t)&&(e.grid_index=t);var i=a.getCommerceAuxData(this.data);return e=s.extend(e,i)}});D.prototype.className="Pin",t.exports=I.register(D)},function(t,e,i){"use strict";var n=i(11),s={};s.getCloseupRichTypes=function(t){if(t){var e=t.buyable_product;if(e){var i=[n.GEN.PinImpressionRichType.BUYABLE];return e.is_available&&i.push(n.GEN.PinImpressionRichType.AVAILABLE),i}}return null},s.getCommerceAuxData=function(t){if(t){var e=t.buyable_product;if(e){var i={commerce_is_available:e.is_available,commerce_is_buyable:!0,commerce_data:{pin_is_promoted:t.is_promoted,pin_min_price:e.active_min_price,pin_max_price:e.active_max_price,merchant_id:e.merchant_id,merchant_item_group_id:e.merchant_item_group_id}};return i}}return null},t.exports=s},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(40),a=i(8),r=230,l=240,h=n.extend({CssClassName:{DARKEN_BACKGROUND:"darkenBackground",DARKEN_BACKGROUND_DARKER:"darkenBackgroundDarker"},events:{"click .undoTextWrapper":"onUndoTextClick"},onContentReady:function d(){this.options.state_darkenBackground=!1,this.options.state_darkenBackgroundDarker=!1,this.editBackgroundColor()},updateDom:function c(){var t=this.$(".removePinWrapper");t.toggleClass(this.CssClassName.DARKEN_BACKGROUND,this.options.state_darkenBackground),t.toggleClass(this.CssClassName.DARKEN_BACKGROUND_DARKER,this.options.state_darkenBackgroundDarker)},animateIn:function u(){this.$el.transition({transform:"rotateY(0deg)"},500)},editBackgroundColor:function p(){for(var t=this.$(".heightWrapper").css("background"),e=t.match(/\d+/g),i=!0,n=!0,s=0;s<e.length;s++)parseInt(e[s])<=l&&(i=!1),parseInt(e[s])<=r&&(n=!1);i?this.updateOptionsAndDom({state_darkenBackgroundDarker:!0,state_darkenBackground:!1}):n&&this.updateOptionsAndDom({state_darkenBackgroundDarker:!1,state_darkenBackground:!0})},destroyModule:function _(){this.parent=null,this.destroy()},onUndoTextClick:function g(t){var e=this.options.feedback_type_name,i=null,n=null;switch(e){case"unfollowBoard":i={board_id:this.options.object_id},n="BoardFollowResource";break;case"unfollowInterest":i={interest_list:"favorited",interest_id:this.options.object_id},n="InterestFollowResource";break;case"unfollowPinner":i={user_id:this.options.object_id},n="UserFollowResource";break;default:return}var s=a.create(n,i);s.callCreate({showError:!1}).then(function(t){"IE"===o.instance.browser_name?(this.$el.transition({transform:"rotateY(360deg)"},500),this.$el.siblings().transition({transform:"rotateY(360deg)"},500,this.destroyModule.bind(this))):this.$el.parent().transition({transform:"rotateY(360deg)"},500,this.destroyModule.bind(this))}.bind(this))}});h.prototype.className="PinFeedbackConfirmation",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(18),r=o.extend({events:{"click .openPinFeedback":"openPinFeedback"},CssClassName:{SUBMITTED:"submitted"},openPinFeedback:function l(){var t={pin_id:this.options.pin_id,feedback_type:this.options.feedback_type},e=this.options.recommendation_reason,i=this.options.through_id;e&&i&&(t.through_id=i,t.recommendation_reason=e),t.promoter=this.options.promoter;var s={name:"PinFeedbackDialog",options:t};return a.load(s).then(function(t){this.showInModal(t),this.listen(t,n.EVENT_PIN_FEEDBACK_SUBMITTED,this.onFeedbackSubmitted)}.bind(this))},onFeedbackSubmitted:function h(){this.getContent().addClass(this.CssClassName.SUBMITTED)}});r.prototype.className="RemovePinDialog",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(8),o={log:function a(t,e){var i={event:t};n.isUndefined(e)||(i.sample_rate=e);var o=s.create("IncrementEventResource",i);o.callCreate({showError:!1})}};t.exports=o},function(t,e,i){"use strict";var n=i(1),s=i(116),o=i(19),a=i(11),r=i(138),l=i(172),h=i(57),d=i(139),c=i(13),u=i(46),p=i(83),_="tutorialDropdown",g="click",m="hover",f={};f[g]=g,f[m]=m;var C=s.extend({CssClassName:s.prototype.CssClassName,onClick:function E(t){if(this.options.check_write_banned&&u.isWriteBanned())p.showWriteBanned(this);else if(this.options.check_limited_login&&u.isLimitedLogin())c.showLogin(this);else{if(this.openStrategy===m)return!1;this._ensureDropdown();var e=this._dropdown.isVisible();e?this.hideDropdown():(this._dropdown=this._originalDropdown,this.showDropdown())}this._logContextEvent(t),t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault()},onCreated:function v(){this._dropdown=null,this._originalDropdown=null,this.openStrategy=this.options.show_dropdown_on_hover?f[m]:f[g]},getDropdown:function I(){return this._ensureDropdown(),this._dropdown},resetDropdown:function T(){this._dropdown=null},getDropdownOptions:function N(){return this.options.dropdown_options||{}},getContentModuleLoadOptions:function S(){return this.options.submodule},_ensureDropdown:function b(){if(!this._dropdown){var t=this.options.anchor_selector,e;t&&(e="."+t);var i={anchor:e?e:this.$el,module:this.getContentModuleLoadOptions()};n.extend(i,this.getDropdownOptions());var s=this.options.use_dropdown2?l:r;this._dropdown=new s({id:"dropdown",options:i}),this._originalDropdown=this._dropdown,this._dropdown.initHovering(),this.listen(this._dropdown,a.EVENT_DROPDOWN_HIDE,this.onDropdownHide),this.addChild(this._dropdown)}},onMouseEnterComplete:function y(){this.isHoverEnabled()&&this.$el.isHovering()&&this.showDropdown()},showDropdown:function P(t){-1===window.navigator.userAgent.indexOf("FBIOS")&&this.setActive(!0),this.hideTutorial(),this._ensureDropdown(),this._dropdown.slideIn(200).then(t)},hideDropdown:function B(){this._dropdown&&this._dropdown.hide()},onChangeDropdown:function A(t){this.hideDropdown(),this._dropdown=t.data.dropdown,this.showDropdown()},isDropdownVisible:function R(){return this._ensureDropdown(),this._dropdown.isVisible()},onMouseOutComplete:function w(){this._ensureDropdown(),this._dropdown.isHovering()||this.hideDropdown()},initListeners:function O(){this.openStrategy!==g&&(!this._hoverIntent||this._hoverIntent.isElement(this.$el))&&(this._hoverIntent=new d(this.$el,{enterDelay:5,exitDelay:200}),this.listen(this._hoverIntent,a.EVENT_HOVERINTENT_ENTER_COMPLETE,function(){this.onMouseEnterComplete()}),this.listen(this._hoverIntent,a.EVENT_HOVERINTENT_OUT_COMPLETE,function(){this.onMouseOutComplete()}))},onButtonClick:function D(t){t.stopPropagation()},onContentReady:function x(){var t=!!this.getDropdownOptions().prefetch;t&&this._ensureDropdown(),this.$el.initHovering(),this.childListen(a.EVENT_TUTORIAL_SHOW,this.showTutorial),this.childListen(a.EVENT_CHANGE_DROPDOWN,this.onChangeDropdown),this.initListeners(),this.options.tutorial&&this.options.tutorial.topic&&this.options.tutorial.show&&this.showTutorial()},onDropdownHide:function L(){this.setActive(!1),this.$el.focusWithoutScrolling()},ensureTutorialDropdown:function k(){if(!this.getChildById(_)){var t=n.extend({},this.options.dropdown_options,{title:this.options.tutorial.title,text:this.options.tutorial.text,anchor:this.$el,class_name:"tutorial",largeCaret:!1}),e=new r({id:_,options:t});this.appendChild(e)}return this.getChildById(_)},onShowTutorial:function U(t,e,i){this.showTutorial()},isClickButton:function M(){return this.openStrategy===g},showTutorial:function F(){if(this.options.tutorial){
var t=this.ensureTutorialDropdown();t.fadeIn(),this.setExperienceViewed()}},hideTutorial:function $(){if(this.options.tutorial){var t=this.getChildById(_);t&&t.destroy(),this.setExperienceCompleted()}},setExperienceViewed:function H(){if(this.options.tutorial.experienceId&&this.options.tutorial.placementId){var t=h.instance;t.viewPlacedExperience(this.options.tutorial.placementId,this.options.tutorial.experienceId)}},setExperienceCompleted:function V(){if(this.options.tutorial.experienceId&&this.options.tutorial.placementId){var t=h.instance;t.completePlacedExperience(this.options.tutorial.placementId,this.options.tutorial.experienceId)}},isHoverEnabled:function G(){return this.options.disabled!==!0&&this.openStrategy!==g}});C.prototype.className="DropdownButton",t.exports=o.register(C)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(52),l=i(18),h=a.extend({CssClassName:{VISIBLE:"visible"},onCreated:function d(){this._renderedContent=!1,this.options.state_visible=!1},initHovering:function c(){},slideIn:function u(){return this.show()},render:function p(){return Promise.resolve()},show:function _(){return this.updateOptionsAndDom({state_visible:!0}),this.triggerEvent(s.EVENT_DROPDOWN_SHOW,null,!0),this._removeBodyListener(),this._bodyListener=this.listen(n(document),"mousedown",this._onMouseDown),this._renderedContent?Promise.resolve():(this._renderedContent=!0,l.load(this.options.module).then(function(t){this.appendChild(t),t.render().then(function(){r.deferDomManipulation(function(){t.focus()})})}.bind(this)))},updateDom:function g(){var t=this.options.state_visible;t&&this.$el.insertBefore(this.options.anchor),this.$el.toggleClass(this.CssClassName.VISIBLE,t)},hide:function m(){this._removeBodyListener(),this.triggerEvent(s.EVENT_DROPDOWN_HIDE,null,!0),this.updateOptionsAndDom({state_visible:!1})},_removeBodyListener:function f(){this._bodyListener&&(this.removeListener(this._bodyListener),this._bodyListener=null)},_onMouseDown:function C(t){t.preventDefault(),t.stopPropagation();var e=this.options.mouse_close_mode;switch(e){case"never":break;case"always":this.hide();break;default:var i=n(t.target).closest(this.$el).length>0||n(t.target).closest(this.options.anchor).length>0;i||this.hide()}},getContentModule:function E(){return this.children[0]},isVisible:function v(){return this.options.state_visible},hideDropdown:function I(){},showDropdown:function T(){}});h.prototype.className="Dropdown2",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(116),o=i(19),a=i(13),r=i(131),l=i(31),h=i(46),d=i(27),c=i(83),u=s.extend({onClick:function p(t){if(h.isWriteBanned())c.showWriteBanned(this);else if(h.isLimitedLogin())a.showLogin(this);else{if(s.prototype.onClick.call(this,t),this.options.require_auth&&!this.ensureAuthentication())return t.preventDefault(),!1;if(this.showModalSubmodule(),"a"===this.options.element_type)return!1}}});n.extend(u.prototype,{showModalSubmodule:function _(){d.showModalSubmodule(this)},getAuthRedirectUrl:function g(){var t={};return this.options.require_auth_params&&n.extend(t,this.options.require_auth_params),h.isAuthenticated()?void d.changeWindowLocation(l.getRegisterUrl({}),!1):r.showInlineSignupModalOnButtonClick("ShowModalButton")},toString:function m(t){return this.className+"(module="+this.options.submodule.name+")"},getLoggingObjectIdStr:function f(){return this.parent?this.parent.getLoggingObjectIdStr():null}}),u.prototype.className="ShowModalButton",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(175),l=i(27);i(176);var h="<li data-value='${name}'><img src='${img}' /> <span class='username'>${name}</span> (${fullName})</li>",d=a.extend({events:{click:"_onClick","focus .content":"_onContentFocus","blur .content":"_onContentBlur","input .content":"_onContentInput","keydown .content":"_onContentKeydown","keyup .content":"_onContentKeyup","paste .content":"_onContentPaste"},CssClassName:{ACTIVE:"active",HAS_VALUE:"has-value",MAX_HEIGHT:"maxheight",ERROR:"error"},onContentReady:function c(){this.options.mentions&&this.initAtMentions(),this.$el.removeClass(this.CssClassName.ERROR),this._getContent().placeholder()},initAtMentions:function u(){this.typeahead=new r({tags:"mentions",pin_id:this.options.pin_id}),i.e(4,function(t){i(179),this._getContent().atwho("@",{data:"/",tpl:h,callbacks:{remote_filter:this.onAtMentionFilter.bind(this)}}),this.atwho=this._getContent().data("atwho")}.bind(this))},onAtMentionFilter:function p(t,e,i){t.q&&this.typeahead.search(t.q,function(t){var e=n.map(t.items,function(t){return{name:l.stripTags(t.username),fullName:l.stripTags(t.label),img:t.image}});i(e),this.atwho.settings["@"].data="/"}.bind(this))},_getContent:function _(){return this.$content||(this.$content=this.$(".content")),this.$content},getValue:function g(){var t=this._getContent(),e=t.val().trim();return this.log.debug("value:",e,t),e},reset:function m(){this.$el.removeClass(this.CssClassName.ERROR),this.setValue("")},getUntrimmedValue:function f(){return this._getContent().val()},setValue:function C(t){this._getContent().val(t)},focus:function E(){this._getContent().focus()},_onClick:function v(){this.focus()},_onContentFocus:function I(){this.$el.addClass(this.CssClassName.ACTIVE),this.triggerEvent(s.EVENT_FOCUS,null,!0)},_onContentBlur:function T(){var t=this.getValue().length;this.$el.toggleClass(this.CssClassName.HAS_VALUE,t),this.$el.removeClass(this.CssClassName.ACTIVE),this.triggerEvent(s.EVENT_BLUR,{hasValue:t},!0)},_onContentInput:function N(){this.options.autogrow&&this._updateInputSize(),this.triggerEvent(s.EVENT_CONTENT_CHANGED,null,!0)},_shouldListenToKeyup:function S(){return"onpropertychange"in this.$el[0]&&!("oninput"in this.$el[0])},_onContentKeydown:function b(t){var e=t.keyCode;e===s.KeyCode.ENTER?(this.triggerEvent(s.EVENT_ENTER_PRESSED,null,!0),this.options.prevent_default_on_enter&&(t.preventDefault(),this._onContentInput()),this.options.stop_propagation_on_enter&&t.stopPropagation()):(e===s.KeyCode.LEFT||e===s.KeyCode.RIGHT)&&t.stopPropagation(),this._validateMaxLength(this.options.maxlength)},_onContentKeyup:function y(){this._shouldListenToKeyup()&&this._onContentInput()},_updateInputSize:function P(){var t=this._estimateInputSize(),e=this._getContent();if(e.height()!==t){var i=this.options.maxheight;i&&t>i?(e.height(i),e.addClass(this.CssClassName.MAX_HEIGHT)):(e.removeClass(this.CssClassName.MAX_HEIGHT),e.height(this._estimateInputSize())),this.triggerEvent(s.EVENT_TEXT_INPUT_RESIZED,null,!0)}},_estimateInputSize:function B(){var t=this._getContent();if(!this.$_mirrorInput){var e='<div class="invisibleElemContainer"><textarea class="content invisibleElem"></textarea></div>';this.$el.append(e),this.$_mirrorInput=this.$(".invisibleElem"),this.$_mirrorInput.width(t.width()),t.attr("rows")&&this.$_mirrorInput.attr("rows",t.attr("rows")),this._initInputHeight=t.height()}var i=this._getContent().val();this.$_mirrorInput.val(i);var n=parseInt(t.css("padding-top"),10)||0,s=Math.max(this.$_mirrorInput[0].scrollHeight-2*n,this._initInputHeight);return this.$_mirrorInput.val(""),s},_validateMaxLength:function A(t){if(!this.options.should_validate_maxlength||!t)return!0;var e=this.getValue();return t&&e.length>=t?(this.$el.addClass(this.CssClassName.ERROR),!1):(this.$el.removeClass(this.CssClassName.ERROR),!0)},_onContentPaste:function R(){this.triggerEvent(s.EVENT_PASTE,null,!0),this._validateMaxLength(this.options.maxlength)}});d.prototype.className="TextField",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(3),o=i(11),a=i(25),r=i(8),l=i(46),h=5,d=function c(t){t=t||{},this.tags=t.tags,this.enable_recent_queries=!!t.enable_recent_queries,this.minimum_term_character_length=t.minimum_term_character_length||0,this.bypass_lru_cache=t.bypass_lru_cache;var e={tags:t.tags,pin:t.pin_id},i=t.num_places;i?e.num_places=i:e.count="count"in t?t.count:h,t.should_geocode&&(e.should_geocode=!0),t.exclude_non_followers&&(e.exclude_non_followers=!0),t.field_set_key&&(e.field_set_key=t.field_set_key);var n="TypeaheadResource";t.resource_name&&(n=t.resource_name),this.searchResource=r.create(n,e),this.itemsCache=new a};n.extend(d.prototype,s.Events),n.extend(d.prototype,{search:function u(t,e){var i;if(t=t.trim(),!t&&"pinners_and_contacts"===this.tags)return this.abortSearch(),this.publishData(t,[],{},e);if(!t&&l.isLimitedLogin())return this.abortSearch(),this.publishData(t,[],{},e);if(!t&&this.enable_recent_queries&&l&&l.isAuthenticated())i="recent_search";else{var n=this.bypass_lru_cache?{}:this.itemsCache.get(t);if(n){var s=n.items;if(s&&s.length){this.abortSearch();var o=n.hint;return void this.publishData(t,s,o,e)}}}t.length>=this.minimum_term_character_length?this.fetch(t,i,e):this.publishData(t,[],{},e)},getResource:function p(){return this.searchResource},abortSearch:function _(){this.getResource().abort()},publishData:function g(t,e,i,n){var s={term:t,items:e,hint:i};this.trigger(o.EVENT_DATA,s),n&&n(s)},setAutocompleteScope:function m(t){this.getResource().set("autocompleteScope",t)},fetch:function f(t,e,i){var n=this.getResource();if(n.isCalling()){var s=n.get("term");if(t===s)return;this.abortSearch()}""!==this.tags&&(this.trigger(o.EVENT_TYPEAHEAD_SEARCH_START,t),n.set("term",t),n.set("tags",e||this.tags),n.resetBookmark(),n.callGet({showError:!1}).then(function(e){var n=e.resource_response.data,s=n.items,o=n.hint||{},a={hint:o,items:s};this.cacheData(t,a),this.publishData(t,s,o,i)}.bind(this),function(t){this.trigger("fetchError",t)}.bind(this)),this.warm=!0)},removeCacheForTerm:function C(t){this.itemsCache.remove(t)},cacheData:function E(t,e){this.itemsCache.set(t,e)},prefetch:function v(){if(!this.warm){var t=r.create("TypeaheadPrepareResource");t.callGet({showError:!1}),this.warm=!0}}}),t.exports=d},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(177);i(178);var l=a.extend({events:{"focus input":"onInputFocus","blur input":"onInputBlur","keyup input":"onInputKeyup","keydown input":"onInputKeydown","textchange input":"onTextchange"},onContentReady:function h(){this.$input=this.$("input"),this._value=this.options.value||"",this._field=this.getChildById("input"),this.options.currency_symbol&&this.formatAsCurrency()},onInputFocus:function d(t){if(this.options.currency_symbol){var e=n(t.currentTarget);e.length&&e.val((this._value||"").toString())}},onInputBlur:function c(t){this.options.currency_symbol&&this.formatAsCurrency()},formatAsCurrency:function u(){if(this.$input.length){var t=this.$input.val(),e=parseFloat(t),i=r.quantize(e,2);this._value=i,this.$input.val(i?i.toFixed(2):t)}},disable:function p(){this.$input.attr({disabled:""})},enable:function _(){this.$input.removeAttr("disabled")},isDisabled:function g(){return this.$input.is(":disabled")},onInputKeydown:function m(t){},onInputKeyup:function f(t){},onTextchange:function C(t){this.triggerEvent(s.EVENT_INPUT_TEXT_CHANGED,{value:this._field.getValue()},!0)},setValue:function E(t){this._field.setValue(t),this.options.currency_symbol&&(this._value=t)},getValue:function v(){return this.options.currency_symbol?this._value.toString()||"0":this._field.getValue()},setPlaceholder:function I(t){this.$input.attr("placeholder",t)}});l.prototype.className="Field",t.exports=o.register(l)},function(t,e){"use strict";var i={};i.quantize=function(t,e){var i=t*Math.pow(10,e),n=Math.round(10*(i-parseInt(i,10)))/10;return n===-.5&&(n=-.6),i=Math.round(parseInt(i,10)+n)/Math.pow(10,e)},i.toRadians=function(t){return t*Math.PI/180},i.dollarToMicrodollar=function(t){var e=parseInt(100*t,10);return 1e4*e},i.microdollarToDollar=function(t){return t/1e6},i.formatUSD=function(t){return t.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")},t.exports=i},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({onContentReady:function a(){this._value=this.options.value||"",this.options.select&&this.$el.select(),this.options.placeholder&&this.$el.placeholder()},setValue:function r(t){this.$el.val(t)},getValue:function l(){return this.$el.val()},focus:function h(){this.$el.focus()},clear:function d(){this.setValue("")},clearPlaceholder:function c(){this.options.placeholder&&(this.$el.attr("placeholder",""),this.$el.val(""))},restorePlaceholder:function u(){this.options.placeholder&&this.$el.attr("placeholder",this.options.placeholder)},setCursorPosition:function p(t){this.$el[0].setSelectionRange(t,t)}});o.prototype.className="Input",t.exports=s.register(o)},,,function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(131),r=i(46),l=i(31),h=o.PIN_IT_DOMAIN+"/webresult?",d=n.extend({onClick:function c(t){if(!r.isAuthenticated())return a.showInlineSignupModalOnButtonClick("WebResult");var e={iframeurl:this.options.link,description:this.options.description,imageurl:this.options.image_url,parentcsrid:this.options.parent_csr_id};window.open(h+l.getQueryStringFromObject(e))}});d.prototype.className="ShowCSRSaveButton",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(81);i(128);var r=o.extend({onContentReady:function l(){a.getInstance().setupModuleViewContextLogging(this,n.GEN.ComponentType.PIN_CLOSEUP_LINK,{})}});r.prototype.className="CloseupLinkModule",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(81);i(184),i(185);var r=o.extend({getLoggingObjectIdStr:function l(){return this.data.id},onContentReady:function h(){var t=n.GEN.ComponentType.PIN_CLOSEUP_SOURCE_DESCRIPTION;this.$el.attr("data-component-type")&&(t=parseInt(this.$el.attr("data-component-type"),10));var e={},i=this.data.rich_metadata;i&&(i.movie&&i.movie.from_aggregated_data||i.recipe&&i.recipe.from_aggregated_data)&&(e.from_aggregated_data=!0),a.getInstance().setupModuleViewContextLogging(this,t,e)}});r.prototype.className="CloseupSourceDescription",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({CssClassName:{HOURS_EXPANDED:"expanded",DISPLAYED_PLACE_INFO:"displayed"},events:{"click .hoursCollapsedSection":"_expandHours"},onRendered:function a(){this.updateOptionsAndDom({state_hours_expanded:!1})},_showExpandedPlaceInformation:function r(){this.updateOptionsAndDom({state_display_place_info:!0})},_expandHours:function l(){this.updateOptionsAndDom({state_hours_expanded:!0})},updateDom:function h(){this.$el.addClass(this.CssClassName.DISPLAYED_PLACE_INFO),this.options.state_hours_expanded&&(this.$(".placeInfoToggleIcon").toggleClass(this.CssClassName.HOURS_EXPANDED),this.$(".hoursExpandedSection").toggleClass(this.CssClassName.HOURS_EXPANDED),this.options.state_hours_expanded=!1)}});o.prototype.className="ExpandedPlaceInformation",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(50),r=i(30),l=i(40),h=i(59),d=i(19),c=i(66),u=i(75),p=i(31),_="pk.eyJ1IjoicGludGVyZXN0IiwiYSI6ImdQSE45XzgifQ.4HhVEoWGNG2ZXxTC1x56kQ",g="focusOn",m="app/common/modules/do/rich-pins/place/Map/",f=m+"markerPopup.nunjucks",C=m+"markerCluster.nunjucks",E=m+"marker.nunjucks",v=m+"addToMapToast.nunjucks",I=17,T=20,N=-1e3,S=15,b=13,y=a.extend({CssClassName:{FADE_OUT_NOT_ACTIONABLE:"fadeOut notActionable",FADE_OUT_UP:"fadeOutUp",HIGHLIGHTED_MARKER_ICON:"highlightedMarkerIcon",TOP_ZINDEX:"topZIndex"},setup:function P(){this.showPinsWithPlaces=h.instance.v2InGroup("web_pins_with_places",["employees","enabled"]),this.map?this.triggerEvent(o.EVENT_MAP_READY,null,!0):this._prepareMap(this.options.map_id,null)},_prepareMap:function B(t,e){this._generateMap(t,e),this._initializeMapHandlers(),this._paddingTopLeft=L.point(0,0),this.showPinsWithPlaces&&this._addNearbyPlaces(),this.triggerEvent(o.EVENT_MAP_READY,null,!0)},addMarkerToCloseupMap:function A(t){u.promise.then(function(){var e={pin:t,highlighted:!this.showPinsWithPlaces,animated:!1};if(this.marker=this._generateMarker(e),this.options.show_popup_marker){var i=this._generatePopup(e),n={closeButton:!!e.animated,autoPan:!0,maxWidth:o.PIN_WIDTH,minWidth:o.PIN_WIDTH};this.showPinsWithPlaces&&(n.autoPanPaddingTopLeft=new L.Point(0,20),n.offset=new L.Point(0,-25)),this.marker.bindPopup(i,n)}else this.marker.on("click",function(e){var i={};i[g]=t.getPinId();var n=t.getBoardUrl(),s=p.appendQueryString(n,i);this.navigate(s,null,o.GEN.ForceRefreshType.PAGE,i)}.bind(this));var s=this.map;this.marker.addTo(s);var a=this.marker.getLatLng(),r=this.showPinsWithPlaces?b:S;s.setView(a,r),this.showPinsWithPlaces&&this.marker.on("click",function(){this._logCustomContextEvent(o.GEN.EventType.CLICK,o.GEN.ElementType.PLACE_VIEW_MAP_MARKER,o.GEN.ComponentType.PLACE_VIEW_MAP,{})}.bind(this))}.bind(this))},addMarkerToMap:function R(t){u.promise.then(function(){var e=this._generateMarker(t),i=t.placeholder?this.placeholderMarkerLayer:this.markerLayer;if(!t.placeholder){t.animated&&(t.template=v),n.extend(e.options,t);var s=this._generatePopup(t);e.bindPopup(s,{closeButton:!!t.animated,autoPan:!1,maxWidth:r.siteConst.PIN_WIDTH,minWidth:r.siteConst.PIN_WIDTH})}e.addTo(i),t.placeholder?e._bringToFront():this.map.fire("moveend")}.bind(this))},_generateMarker:function w(t){var e=t.pin,i=t.highlighted,n=t.animated,s=t.coordinates||e.getCoordinates&&e.getCoordinates(),o=t.name,a=t.placeholder,r={highlighted:i,animated:n,placeholder:a,pin:e};o&&(r.name=o);var l,h;if(e){l=e.getPinId();var d=e.getPlaceData();d&&(h=d.id)}"place"in t&&(h=t.place.id);var c=this._generateDivIcon(r),u=L.marker(s,{icon:c,riseOnHover:!0,pin_id:l,place:h});return l&&(u.pin_id=l),u},_generatePopup:function O(t){var e=t.pin,i=t.name||e.getPlaceName(),n=t.place||e.getPlaceData()||t,s=t.template||f,o={name:i,place:n,url:n.url,is_modular_closeup:this.options.is_modular_closeup,is_nearby_pin:t.is_nearby_pin,is_pins_with_places:this.showPinsWithPlaces};return t.is_nearby_pin&&(o.pin_image=t.pin&&t.pin.images&&t.pin.images["236x"]&&t.pin.images["236x"].url,o.pin_id=t.pin&&t.pin.id),c.render(l.instance.locale,s,{options:o})},_generateDivIcon:function D(t){var e=this._getDivIconOptions(t),i=L.divIcon(e);return i},_initializeMapHandlers:function x(){this.showPinsWithPlaces&&this.map.on("dragend",function(t){this._logCustomContextEvent(o.GEN.EventType.DRAG,o.GEN.ElementType.PLACE_VIEW_LARGE_MAP,o.GEN.ComponentType.PLACE_VIEW_MAP,{})}.bind(this))},_addNearbyPlaces:function k(){this.showPinsWithPlaces&&this.data&&this.data.slice(0,T).forEach(function(t){var e=t.place;e&&L.circleMarker([e.latitude,e.longitude],{color:"#fff",fillColor:"#2b9615",fillOpacity:1,opacity:1,weight:1}).setRadius(5).addTo(this.map)}.bind(this))},_addNearbyPlacesExpanded:function U(){if(this.showPinsWithPlaces&&this.data){var t="<div class='nearbyPlaceExpandedMarker'><img src='",e="'/></div>";this.data.slice(0,T).forEach(function(i){var n=i.place;n&&u.promise.then(function(){var s=[n.latitude,n.longitude],a=L.divIcon({html:t+i.images["236x"].url+e,iconSize:[30,30]}),r={icon:a,zIndexOffset:N},l=L.marker(s,r);l.on("click",function(){this.map.setView(s),this._logCustomContextEvent(o.GEN.EventType.CLICK,o.GEN.ElementType.PLACE_VIEW_MAP_MARKER,o.GEN.ComponentType.PLACE_VIEW_MAP,{})}.bind(this)),l.addTo(this.map);var h={pin:i,name:n.name,place:n,highlighted:!1,animated:!1,is_nearby_pin:!0},d=this._generatePopup(h),c={closeButton:!!h.animated,autoPan:!0,maxWidth:o.PIN_WIDTH,minWidth:o.PIN_WIDTH,autoPanPaddingTopLeft:new L.Point(0,20),offset:new L.Point(0,-25)};l.bindPopup(d,c)}.bind(this))}.bind(this))}},_generateMap:function M(t,e){var i="mapbox_closeup",n=this.$("#"+i)[0],o=this.getMinZoom(document.getElementById(i)),a={detectRetina:!0};s(".ielt9").length||(a.format="png64"),L.mapbox.accessToken=_,this.map=L.mapbox.map(n,t,{maxZoom:I,minZoom:o,worldCopyJump:!0,keyboard:!1,zoomControl:!1,attributionControl:!1,inertiaThreshold:75,inertiaDeceleration:5e3,tileLayer:a}),this.markerLayerPromise=u.promise.then(function(){this.markerLayer=new L.MarkerClusterGroup({mapModule:this,showCoverageOnHover:!1,removeOutsideVisibleBounds:!1,maxClusterRadius:65,iconCreateFunction:function t(e){e=e;var i=e.getAllChildMarkers(),n=i[0].options.pin,s=null,o=e.getChildCount();n&&(s=n.getImageUrl("236x"));var a={};return a.markerClusterPinImage=s,a.clusterChildCount=o,new L.DivIcon({html:c.render(l.instance.locale,C,a),iconSize:[52,74],iconAnchor:[24,66]})}}).addTo(this.map),this.placeholderMarkerLayer=L.featureGroup().addTo(this.map)}.bind(this)),this.map.scrollWheelZoom.disable(),e&&this.fitLocation(e)},onAddedToDom:function F(){var t=this.setup.bind(this);i.e(5,function(){i(186),t()})},_getDivIconOptions:function $(t){var e=t.highlighted,i=t.animated,n=t.placeholder,s=[0,-55],o="markerIconWrapper";i&&(o+=" animated");var a="markerIcon";this.showPinsWithPlaces&&(a+=" pinsWithPlaces"),e&&(a+=" highlightedMarkerIcon");var r,h,d,u;n?(a+=" placeholder",r=9,h=9,d=[r/2,h/2]):(a+=" pin",this.showPinsWithPlaces?(r=36,h=45,d=[r/2,.7*h]):(r=52,h=70,d=[r/2,h]),u=t.pin);var p={iconSize:[r,h],iconAnchor:d,popupAnchor:s,pin:u},_=null;u&&!n&&(_="getImageUrl"in u?u.getImageUrl("236x"):u.images["236x"].url);var g={};return g.markerWrapperClassName=o,g.markerClassName=a,g.pinImage=[_],p.html=c.render(l.instance.locale,E,g),p},getMinZoom:function H(t){var e=s(t),i=e.width(),n=e.height();return this.getMinZoomToCover(i,n)},getMinZoomToCover:function V(t,e){for(var i=L.CRS.EPSG3857,n=1;I>=n;n++){var s=L.latLng(90,-180),o=L.latLng(-90,180),a=i.latLngToPoint(s,n),r=i.latLngToPoint(o,n),l=r.x-a.x,h=r.y-a.y,d=l>t&&h>e;if(d)return n}return I},openPopupForPin:function G(t){var e=this.getMarkerForPin(t);this.openPopupForMarker(e)},getMarkerForPin:function W(t){if(this.markerLayer){var e=n.find(this.markerLayer.getLayers(),function(e){return e.pin_id===t});return e}},openPopupForMarker:function K(t){var e=this.markerLayer.getVisibleParent(t);if(e&&"getChildCount"in e&&e.getChildCount()>1){var i=this.map.latLngToLayerPoint(t._latlng);i.y+=10;var n=e._generatePointsCircle(1,i);e._animationSpiderfy([t],n),this._singleMarkerSpiderfied=t}t.openPopup()},expandPlacesMap:function j(){this.enteredExpandedView=!0,this._logCustomContextEvent(o.GEN.EventType.CLICK,o.GEN.ElementType.PLACE_MODULE_MAP,o.GEN.ComponentType.PIN_CLOSEUP_PLACE,{}),this.$(".hoverMask").addClass("transitionRemove"),this.$el.addClass("fadeOutCollapsedMap"),this.$el.addClass("expandMapTransition"),this.$el.on("animationend",this._expandPlacesMapLayout.bind(this))},_expandPlacesMapLayout:function Y(){this.$(".hoverMask").remove();var t=this.$(".mapboxCloseup");t.removeClass("halfWidth");var e=this.getChildByModuleName("Collage");e&&e.destroy(),this.$el.removeClass("fadeOutCollapsedMap"),t.addClass("expandedHeight"),this.$el.on("animationend",this._expandPlacesMapMarkersAndPopup.bind(this))},_expandPlacesMapMarkersAndPopup:function q(){this.resizeMap(),new L.Control.Zoom({position:"bottomright"}).addTo(this.map),this._addNearbyPlacesExpanded(this.options.map_id);var t=[this.options.pin_geo.latitude,this.options.pin_geo.longitude];this.map.setView(t),this.$el.addClass("fadeInExpandedMap"),this.$el.off("animationend")},resizeMap:function z(){var t=this.$el,e=this.map.getSize().x,i=this.map.getSize().y;(t.width()>e||t.height()>i)&&this.map.invalidateSize({pan:!1})}});y.prototype.className="Map",t.exports=d.register(y)},,,,,function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(81),r=o.extend({onContentReady:function l(){a.getInstance().setupModuleViewContextLogging(this,n.GEN.ComponentType.PIN_CLOSEUP_TITLE,{})}});r.prototype.className="CloseupTitleCard",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(2),s=i(1),o=i(2),a=i(11),r=i(154),l=i(50),h=i(30),d=i(40),c=i(152),u=i(59),p=i(14),_=i(18),g=i(19),m=i(131),f=i(46),C=i(27);i(129),i(130),i(192),i(209);var E=l.extend({events:{"mouseenter .visualSearchObjectTagClickTarget":"visualSearchToolTipShow","mouseleave .visualSearchObjectTagClickTarget":"visualSearchToolTipHide","mousemove .paddedPinLink":"onLinkMousemove","click .pinImage":"showContextualSignup"},onCreated:function v(){this._hasBeenSetDraggable=!1,this._draggablePin=null,this._isDraggable=!1,this.childListen(a.EVENT_UNAUTH_FLASHLIGHT_CONTAINER_CLICK,this._onFlashlightContainerClick)},onLinkMousemove:function I(t){c.getConversationIds().length&&!this._draggablePin&&this.generateAndSetDraggablePin()},_onFlashlightContainerClick:function T(t){this.$(".paddedPinLink").removeAttr("href")},detatchDraggable:function N(){this.$(".paddedPinLink").draggable({disabled:!0}),this._isDraggable=!1,this._draggablePin=null},attachDraggable:function S(){var t=this;this._hasBeenSetDraggable&&!this._isDraggable?this.$(".paddedPinLink").draggable("enable"):this._isDraggable||this.$(".paddedPinLink").draggable({appendTo:o(".App"),cursor:"move",cursorAt:{left:h.siteConst.PIN_WIDTH/2,top:50},helper:function e(){return t._draggablePin.getContent()},drag:function i(t,e){var i=parseInt(o(this).data("startingScrollTop"),10);e.position.top-=i;var n=t.clientX-e.position.left,s=window.pageYOffset+t.clientY-e.position.top,a=e.helper.height(),r=e.helper.width(),l=n/r*100,h=s/a*100,d=""+l+"% "+h+"%";e.helper.css("transformOrigin",d)},scroll:!1,revert:!1,start:function n(e,i){r.setDraggedObject(t._draggablePin),o(this).data("startingScrollTop",window.pageYOffset-h.siteConst.PIN_MARGIN)},stop:function s(t,e){r.setDraggedObject(null);var i=parseInt(o(this).data("startingScrollTop"),10);e.position.top-=i}}),this._isDraggable=!0,this._hasBeenSetDraggable=!0},generateAndSetDraggablePin:function b(){var t=this,e=i(166),n=new e({data:this.data,options:{show_comments:!1,squish_giraffe_pins:!1}});n.renderExistingData().then(function(){t._draggablePin=n,t.attachDraggable()})},getLoggingObjectIdStr:function y(){return this.resource.options.id},onAddedToDom:function P(){this._setupClickIfReady()},onContentReady:function B(){this._setupClickIfReady();var t={};if(t[a.PUBSUB_TOPIC_CONVERSATION_ADDED]=this.onConversationAdded,t[a.PUBSUB_TOPIC_CONVERSATION_NO_ACTIVE_CONVERSATIONS]=this.onNoActiveConversations,this.pubsubSubscribe(a.PUBSUB_CHANNEL_MESSAGES,t),this.data.images["736x"].height<1e3&&!d.instance.is_mobile_agent&&!f.isAuthenticated()&&u.instance.v2InGroup("unauth_web_flashlight",["enabled","enabled2"])){var e=this.getChildByModuleName("FlashlightEnabledImage");e._setupCropper(),C.trackRegisterAction("unauth_flashlight_loaded")}},onButtonClick:function A(t){var e=t.target,i=e.id;switch(i){case"flashlightButton":this.onFlashlightClick()}},onFlashlightClick:function R(){var t=this.getChildByModuleName("Image").getWidth(),e={name:"CloseupFlashlight",options:{pin:this.data,img_width:t}},i={modal_style:"flashlightModal",can_dismiss:!0};_.load(e).then(function(t){this.showInModal(t,i)}.bind(this))},onConversationAdded:function w(t,e,i){this.attachDraggable()},onNoActiveConversations:function O(){this.detatchDraggable()},showContextualSignup:function D(){f.isAuthenticated()||m.showInlineSignupModal(this,this.resource)},_setupClickIfReady:function x(){if(this.contentReady&&this.inDom){var t=this;this.createToolTips(),this.$(".visualSearchObjectTagClickTarget").click(function(){t.triggerEvent(a.EVENT_VISUAL_SEARCH_OBJECT_SELECTED,o(this).data("visualobjectid").toString(),!0)})}},visualSearchToolTipHide:function L(t){this.dropdown[o(t.currentTarget).data("visualobjectid")].hide()},visualSearchToolTipShow:function k(t){this.dropdown[o(t.currentTarget).data("visualobjectid")].show(function(){})},createToolTips:function U(){this.dropdown={},n.each(this.$(".visualSearchObjectTagClickTarget"),function(t,e){this.createVisualSearchDropdown(o(e))}.bind(this))},createVisualSearchDropdown:function M(t){var e={name:"Dropdown",options:{anchor:t,class_name:"large aboveModal",position_point:"BOTTOM_CENTER",text:p._("Click the red dot to see similar looks"),append_to_closeup:!0}};_.load(e).then(function(e){var i=e;this.dropdown[t.data("visualobjectid")]=i,i.render().then(function(){s.defer(function(){i.positionModule()})})}.bind(this))},getFirstVisualObject:function F(){var t=this.$(".visualSearchObjectTagClickTarget");return t.length?t.first():null}});E.prototype.className="PaddedPin",t.exports=g.register(E)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(193),l=i(129),h=i(126),d=i(40),c=i(59),u=i(18),p=i(23),_=i(203),g=i(46),m=i(27);i(116);var f=35,C=10,E=58,v=200,I=l.extend({events:{"click .flashlightContainer":"onFlashlightContainerClick"},CssClassName:n.extend(l.prototype.CssClassName,{HIDDEN:"hidden",VISIBLE:"visible"}),onContentReady:function T(){var t=this.options.is_flashlight,e={};if(t){var i={name:"CloseupFlashlight",options:{has_animation:!0},data:this.data,resource:{name:"PinResource",options:{id:this.data.id,field_set_key:"detailed",fetch_visual_search_objects:!0}}},n={modal_style:"flashlightModal",can_dismiss:!0};u.load(i).then(function(t){this.childListen(o.EVENT_BUTTON_CLICK,function(e){this.showInModal(t,n)})}.bind(this)),e[o.EVENT_PULSER_CLICKED]=this.onPulserFlashlightButton,this.pubsubSubscribe(o.GEN.Experience.WEB_FLASHLIGHT_ED_PULSER,e)}else e[o.EVENT_PULSER_MOUSEDOWN]=this.onPulserCropperCorner,this.pubsubSubscribe(o.PUBSUB_CHANNEL_TUTORIAL,e);this.options.has_animation&&this.updateOptionsAndDom({state_setup:!0,state_startCropperAnimation:!1,state_finishCropperAnimation:!1})},onAddedToDom:function N(){this.$window=s(window),this.$flashlightButton=this.$(".flashlightContainer");var t=this.options.is_flashlight;t&&(this.scrollListener=this.listen(this.getScrollableElement(),o.EVENT_SCROLL,this.onScroll),this.listen(h,o.EVENT_RESIZE,this.onScroll),this.onScroll())},updateDom:function S(){var t=this.$(".visualLiveSearchOverlayOuterWrapper"),e=this.$(".flashlightAnimationContainer");this.options.state_setup&&e.hide(),this.options.state_startCropperAnimation&&(t.addClass(this.CssClassName.HIDDEN),e.show(),this.$(".flashlightAnimationOverlay").show(v)),this.options.state_finishCropperAnimation&&(t.removeClass(this.CssClassName.HIDDEN),t.addClass(this.CssClassName.VISIBLE),e.hide())},onFlashlightContainerClick:function b(t){d.instance.is_mobile_agent||g.isAuthenticated()||!c.instance.v2InGroup("unauth_web_flashlight",["enabled3","employees"])?(t.preventDefault(),t.stopPropagation()):(this.triggerEvent(o.EVENT_UNAUTH_FLASHLIGHT_CONTAINER_CLICK,null,!0),this.$(".flashlightContainer").remove(),this.showLoading(),this._setupCropper(),m.trackRegisterAction("unauth_flashlight_loaded"))},onButtonClick:function y(t){var e=t.target,i=e.id;switch(i){case"flashlightButton":this.onFlashlightClick()}},onScroll:function P(){if(!_.isTutorialActive()){var t=this.getScrollableElement(),e=t.scrollTop(),i=this.$el.height(),n=this.$el.offset().top,s=this.$el.closest(this.options.flashlight_button_outer_container),o=s.offset().top,a=parseInt(s.css("margin-top")),r=n-o-E+a,l=f+2*C;r>e?this.$flashlightButton.css("top",C):i+r-l>e?this.$flashlightButton.css("top",e+C-r+"px"):this.$flashlightButton.css("top",i-C-f)}},_publishFlashlightCropperChanged:function B(t,e){var i={pinId:this.data.id,crop:t,origCrop:e,image_signature:this.options.image_signature,buyable_product:this.options.buyable_product};p.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_FLASHLIGHT_CROPPER_CHANGED,i)},_setupCropper:function A(t){i.e(6,function(){i(207);var t=this.$el;!t.height()&&this.data.images&&this.data.images.orig&&t.css({height:t.width()/this.data.images.orig.width*this.data.images.orig.height}),this.$(".visualLiveSearchOverlayOuterWrapper").show();var e=0,n=this.getStartingLocation();return n.w&&n.h?(this.jcropCrop=this.$(".visualLiveSearchOverlay").Jcrop({keySupport:!1,setSelect:[n.x,n.y,n.x+n.w,n.y+n.h],onSelect:function(i){e+=1;var n=t.width(),s=t.height(),o=i.x,a=i.x2,r=i.y,l=i.y2,h={x:o,y:r,w:a-o,h:l-r},d={x:o/n,y:r/s,w:(a-o)/n,h:(l-r)/s,num_crop_actions:e};this._publishFlashlightCropperChanged(d,h)}.bind(this),onRelease:function(){var i=t.width(),n=t.height(),s={x:0,y:0,w:i,h:n,num_crop_actions:e};this._publishFlashlightCropperChanged(s,s)}.bind(this)}),this.$(".jcrop-holder").css({"background-color":""}),this.hideLoading(),!1):void 0}.bind(this))},getStartingLocation:function R(){var t=this.$el,e,i,n,s;if((this.options.startX||0===this.options.startX)&&(this.options.startY||0===this.options.startY)&&this.options.startWidth&&this.options.startHeight)return{
x:this.options.startX,y:this.options.startY,w:this.options.startWidth,h:this.options.startHeight};if(this.data.visual_objects&&this.data.visual_objects.length){var o=this.data.visual_objects[0];e=o.x*t.width(),i=o.y*t.height(),n=o.w*t.width(),s=o.h*t.height()}else e=t.width()/6,i=t.height()/6,n=t.width()-2*e,s=t.height()-2*i;return{x:Math.max(e,.1),y:Math.max(i,.1),w:n,h:s}},setupCropper:function w(){this.options.has_animation&&this.updateOptionsAndDom({state_setup:!1,state_startCropperAnimation:!0,state_finishCropperAnimation:!1});var t=this.getStartingLocation(),e=this.$el;this._setupCropper(),this.options.has_animation?(this.$(".flashlightContainer").hide(v),this.$(".flashlightAnimationWrapper").animate({width:t.w,height:t.h,top:t.y,right:e.width()-(t.x+t.w)},{duration:300,complete:this._onCropperComplete.bind(this)})):this._onCropperComplete()},_onCropperComplete:function O(){this.updateOptionsAndDom({state_setup:!1,state_startCropperAnimation:!1,state_finishCropperAnimation:!0}),this.addTutorials()},onPulserCropperCorner:function D(){this.$(".ord-nw").mousedown()},onPulserFlashlightButton:function x(){this.$(".flashlightIcon").click()},addTutorials:function L(){r.launchPlacedExperience(o.GEN.Placement.WEB_FLASHLIGHT,{})}});I.prototype.className="FlashlightEnabledImage",t.exports=a.register(I)},function(t,e,i){"use strict";var n=i(1),s=i(194),o=i(11),a=i(57),r=i(195),l=i(204),h=i(205),d=i(135),c=i(18),u=i(23),p=i(206),_=i(203),g=i(27),m={};m.launchPlacedExperience=function(t,e,i){var f=a.instance;return f.getPlacedExperienceWithContext(t,e).then(function(e){if(e){if(e.placement_id=t,r.instance().canSupportExperience(e))return r.instance().startTutorial(e).then(function(){return f.viewPlacedExperience(t,e.experience_id),Promise.resolve(!0)});if(e.type===o.GEN.ExperienceType.TOOLTIP){var a=new l({options:{anchor:e.display_data.anchor,append_to:e.display_data.append_to,experience:e,tooltip_options:n.extend({},e.display_data)}});return a.render().then(function(){return u.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_APPEND_TO_MAIN_MODULE,{module:a}),Promise.resolve(!0)})}if(e.experience_id===o.GEN.Experience.WEB_USER_NEWS_APP_UPSELL){var C={name:"AppInstallModal",options:{placedExperienceId:e.id}};if(!_.isTutorialActive())return c.load(C).then(function(t){return d.get().createAndShowModal(t,{only_modal:!0}),Promise.resolve(!0)})}else{if(n.contains([o.GEN.Experience.WEB_SEO_NUX_HOMEFEED_WELCOME,o.GEN.Experience.WEB_SEO_NUX_HOMEFEED_PIN_SUCCESS_BANNER],e.experience_id)){var E=new s({options:{banner_text:e.display_data.banner_text,placed_experience_id:e.id}});return E.render().then(function(){return u.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_APPEND_TO_MAIN_MODULE,{module:E}),Promise.resolve(!0)})}if(e.type===o.GEN.ExperienceType.SURVEY){if(i){var v={name:"ConfirmDialog",options:e.display_data};return c.load(v).then(function(n){return d.get().createAndShowModal(n,{mask_type:"dark",can_dismiss:!1}),f.viewPlacedExperience(t,e.experience_id),g.trackRegisterAction("web_survey_viewed"),i.listen(n,o.EVENT_CONFIRM,function(){window.open(e.display_data.uri),f.completePlacedExperience(t,e.experience_id),g.trackRegisterAction("web_survey_completed")}),i.listen(n,o.EVENT_CLOSE,function(){f.dismissPlacedExperience(t,e.experience_id),g.trackRegisterAction("web_survey_dismissed")}),Promise.resolve(!0)})}}else{if(e.type===o.GEN.ExperienceType.TOAST)return e.display_data.module?(f.viewPlacedExperienceId(e.id),c.load({name:e.display_data.module}).then(function(t){return p.addToast(t),Promise.resolve(!0)})):Promise.resolve(!1);var I=m.Tutorials[e.experience_id];if(I)return h.instance().startTutorial(I,{display_data:e.display_data}).then(function(){return f.viewPlacedExperience(t,e.experience_id),Promise.resolve(!0)})}}}return Promise.resolve(!1)})},m.Tutorials={},m.Tutorials[o.GEN.Experience.WEB_FIRST_PIN_USER_ED]="firstPinIntro",m.Tutorials[o.GEN.Experience.WEB_YOUR_BOARDS_USER_ED]="yourBoards",m.Tutorials[o.GEN.Experience.WEB_MOBILE_NUX_INTERESTS]="interestsNuxMweb",m.Tutorials[o.GEN.Experience.ANALYTICS_HOME_USER_ED]="analyticsHomeUserEd",m.Tutorials[o.GEN.Experience.ANALYTICS_AUDIENCE_SELECTOR_USER_ED]="analyticsAudienceSelectorUserEd",m.Tutorials[o.GEN.Experience.WEB_EMPTY_BOARD_ED]="emptyBoardIntro",m.Tutorials[o.GEN.Experience.WEB_EMPTY_BOARD_ED_MANUAL]="emptyBoardIntro",m.Tutorials[o.GEN.Experience.WEB_REPIN_ED]="repin",m.Tutorials[o.GEN.Experience.WEB_REPIN_ED_MANUAL]="repin",m.Tutorials[o.GEN.Experience.WEB_FLASHLIGHT_ED]="flashlightGuide",m.Tutorials[o.GEN.Experience.WEB_FLASHLIGHT_ED_PULSER]="flashlightPulser",t.exports=m},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(57),a=i(50),r=i(28),l=a.extend({CssClassName:{HIDDEN:"hidden",DONE:"done"},onContentReady:function h(){this.$bannerContainer=this.$(".bannerContainer"),this.$nextButton=this.$(".nextBannerButton"),this.$banner=this.$(".bannerText");var t={};t[n.PUBSUB_TOPIC_VIEW_CHANGE]=this.destroyBannerSmart,t[n.PUBSUB_TOPIC_CLOSE_CLOSEUP]=this.destroyBannerSmart,this.pubsubSubscribe(n.PUBSUB_CHANNEL_TUTORIAL,t),this.pubsubSubscribe(n.PUBSUB_CHANNEL_SITE,t),this.options.state_buttonHidden=!0,this.options.state_isDone=!1,this.options.state_bannerText="",this.options.state_hideText=!1,this.hideFooter()},updateDom:function d(){this.$nextButton.toggleClass(this.CssClassName.HIDDEN,!!this.options.state_buttonHidden),this.$bannerContainer.toggleClass(this.CssClassName.DONE,!!this.options.state_isDone),this.$banner.text(this.options.state_bannerText),this.$banner.toggleClass(this.CssClassName.HIDDEN,!!this.options.state_hideText),this.$bannerContainer.hide(),this.$bannerContainer.outerHeight(this.$bannerContainer.outerHeight()),this.$bannerContainer.show()},destroyBanner:function c(t,e,i){t===n.PUBSUB_CHANNEL_TUTORIAL?"Modal"===i.moduleName&&this.destroy():this.destroy()},destroyBannerSmart:function u(t,e,i){this.options.keep_on_action===!0?this.hideFooter():this.destroyBanner(t,e,i)},onDestroyed:function p(){this.options.placed_experience_id&&o.instance.completePlacedExperienceId(this.options.placed_experience_id)},onAdded:function _(){this.options.placed_experience_id&&o.instance.viewPlacedExperienceId(this.options.placed_experience_id)},hideFooter:function g(){var t=r.instance.getChildById("footerButtons");t&&(t.options.hidden=!0,t.options.hiddenFlag=!0,t.setVisible(!1))},setText:function m(t){var e=t.trim();this.updateOptionsAndDom({state_bannerText:e})},hideText:function f(){this.updateOptionsAndDom({state_hideText:!0})},showButton:function C(){this.updateOptionsAndDom({state_buttonHidden:!1})},hideButton:function E(){this.updateOptionsAndDom({state_buttonHidden:!0,state_hideText:!1})},isDone:function v(){this.updateOptionsAndDom({state_isDone:!0})},notDone:function I(){this.updateOptionsAndDom({state_isDone:!1})}});l.prototype.className="BottomBanner",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(9),o=i(11),a=i(51),r=i(196),l=i(197),h=i(198),d=i(199),c=i(202),u=i(16),p=i(41),_=i(23),g=i(54),m=i(203),f=i(27),C=u.getLogger("ExperienceTutorialManager"),E=function I(){this.TUTORIAL_MAP={},this.TUTORIAL_MAP[o.GEN.ExperienceType.NOOP]=r,this.TUTORIAL_MAP[o.GEN.ExperienceType.GUIDE]=c,this.TUTORIAL_MAP[o.GEN.ExperienceType.NUX]=d,this.TUTORIAL_MAP[o.GEN.ExperienceType.TOOLTIP]=h,m.setExperienceTutorialManager(this),this.init()};E.prototype={init:function T(){this._isActive=!1,this.experience=null,this.tutorial=null,this.currentStep=0,this.steps=null},startTutorial:function N(t){if(m.isTutorialActive())return Promise.reject(new Error("another tutorial is already active"));var e=this._getStoredData();return!e||t&&e.experience.id!==t.id||(t=e.experience,this.currentStep=e.step),t&&void 0!==t.type&&n.has(this.TUTORIAL_MAP,t.type)?(this._isActive=!0,this.experience=t,this.tutorial=new this.TUTORIAL_MAP[this.experience.type](this.experience,this),_.instance.subscribe(o.PUBSUB_CHANNEL_TUTORIAL,o.PUBSUB_TOPIC_TUTORIAL_GO_TO_STEP,function(t,e,i){this._setStep(i)}.bind(this)),this.tutorial.onStart().then(function(){return this.steps=this.experience.display_data.steps,this._funnelPrefix="tutorial_"+this.experience.id,this._setStep(this.currentStep)}.bind(this),function(){this._isActive=!1}.bind(this))):Promise.reject(new Error("invalid placedExperience or no placedExperience to be resumed"))},_next:function S(){return!this.steps||this.currentStep>=this.steps.length-1?this._endTutorial(!0,!0):this._setStep(this.currentStep+1)},_previous:function b(){return this.currentStep<=0?this._endTutorial(!1):this._setStep(this.currentStep-1)},_dismiss:function y(){this._endTutorial(!1)},_endTutorial:function P(t,e){var n=function(){var n=this.experience.experience_id,s=this.experience.display_data,r=s.nextUrlInfo,h=r?r.url:null,d=r?r.forceRefresh:!1,c=r?r.forceFullPageRefresh:!1,u=!!s.relaunchPlacement,g=u?this.experience.placement_id:null;this.clearStoredData(),this.init();var m=Promise.resolve();if(t&&h){var C=new p;c?f.changeWindowLocation(h):d&&(C.evt=new a("",null,{forceRefresh:1})),l.navigate(h,C)}else if(u&&g){var E=i(193);m=E.launchPlacedExperience(g)}return m.then(function(){e&&_.instance.publish(n,o.EVENT_PULSER_CLICKED,{})})}.bind(this),s=t?this.tutorial.completePlacedExperience():this.tutorial.dismissPlacedExperience();return t&&f.trackRegisterAction(this._funnelPrefix+"_complete"),s.fin(this.tutorial.onExit.bind(this.tutorial)).then(n)},_setStep:function B(t){return C.debug("set step from",this.currentStep,"to",t),f.trackRegisterAction(this._funnelPrefix+"_step"+t),0>t||t>=this.steps.length?this._endTutorial(!0).then(function(){throw new Error("step is out of range")}):(this.currentStep=t,this._saveCurrentStep(),this.tutorial.nextStep(t))},isRunningTutorial:function A(){return this._isActive},setTutorialActive:function R(t){this._isActive=t},_getStoredData:function w(){var t=g.sessionStorage.getItem(o.TUTORIAL_SESSION_KEY);return t&&t.experienceTutorial?t:null},canSupportExperience:function O(t){return n.has(this.TUTORIAL_MAP,t.type)&&n.has(t.display_data,"steps")},_saveCurrentStep:function D(){this.experience&&n.contains([o.GEN.Experience.WEB_SEO_NUX_FIRST_CLICKTHROUGH_TOOLTIP,o.GEN.Experience.WEB_SEO_NUX_FIRST_PIN_TOOLTIP],this.experience.experience_id)||g.sessionStorage.setItem(o.TUTORIAL_SESSION_KEY,{experience:this.experience,step:this.currentStep,experienceTutorial:!0})},clearStoredData:function x(){g.sessionStorage.removeItem(o.TUTORIAL_SESSION_KEY)}};var v=null;E.instance=function(){return v||(v=new E),v},t.exports=s.expose("ExperienceTutorialManager",E)},function(t,e,i){"use strict";var n=i(2),s=i(9),o=i(57),a=i(18),r=function l(t,e){this.placedExperience=t,this.displayData=this.placedExperience.display_data,this.tutorialManager=e,this.storage={}};r.prototype={onStart:function h(){return new Promise(function(t,e){t(void 0)})},nextStep:function d(t){return new Promise(function(e,i){this._removeStepModule().then(function(){this.loadStepModule(t),e(void 0)}.bind(this))}.bind(this))},loadStepModule:function c(t){var e=this.getModuleArgs(t);a.load(e).then(function(t){var e=this.currentModule;this.currentModule=t;var i=t;i.onEnter(function(){this.renderStepModule(t,e)}.bind(this))}.bind(this))},renderStepModule:function u(t,e){},_removeStepModule:function p(){var t=this.currentModule;return new Promise(function(e){t&&t.onExit(function(){t.onRemoved()}),e(void 0)})},getModuleArgs:function _(t){var e=this.displayData.steps,i=e[t].moduleName,s={tutorial_name:this.displayData.tutorialName,current_step:t,total_steps:e.length,can_exit:this.displayData.can_exit||!1,experienceID:this.placedExperience.experience_id,placementID:this.placedExperience.placement_id};return n.extend(s,e[t].options),{name:i,options:s}},onExit:function g(){return this._removeStepModule().then(function(){return this.currentModule&&this.currentModule.destroy(),Promise.resolve()}.bind(this))},dismissTutorial:function m(){this.tutorialManager&&this.tutorialManager.isRunningTutorial()&&this.tutorialManager._dismiss()},completePlacedExperience:function f(){return this.currentModule?this.currentModule.completePlacedExperience():this.placedExperience&&this.placedExperience.id?o.instance.completePlacedExperienceId(this.placedExperience.id):Promise.resolve()},dismissPlacedExperience:function C(){return this.currentModule?this.currentModule.dismissPlacedExperience():this.placedExperience&&this.placedExperience.id?o.instance.dismissPlacedExperienceId(this.placedExperience.id):Promise.resolve()},getStorage:function E(t){return this.storage[t]},setStorage:function v(t,e){this.storage[t]=e}},t.exports=s.expose("ExperienceTutorial",r)},function(t,e,i){"use strict";var n=i(9),s=i(20),o={navigate:function a(t,e){s.instance.navigate(t,e)}};t.exports=n.expose("HistoryNavigator",o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(9),r=i(196),l=i(16),h=i(135),d=i(46),c=l.getLogger("ModalTutorial"),u=function p(t,e){r.call(this,t,e),this.modal=null,this.loadModalSlowly=!1};u.prototype=Object.create(r.prototype),u.prototype.onStart=function(){return new Promise(function(t,e){return this.displayData.anchor&&!this._isOnScreen(s(this.displayData.anchor))?void e(new Error("Highlighted element is not on screen.")):void t(void 0)}.bind(this))},u.prototype.onExit=function(){this.modal&&(this.modal.destroy(),this.modal=null),r.prototype.onExit.call(this)},u.prototype.renderStepModule=function(t,e){var i;if(this.modal){var s=function r(){e&&e.destroy()};i=this.modal.setSubmodule(t).then(s,s)}else{var a=(this.displayData.modalStyle+" "||"")+d.attributes.gender;i=h.get().createAndShowModalCorrect(t,{mask_type:"dark",can_dismiss:!1,load_slowly:this.loadModalSlowly,modal_style:a}).then(function(e){this.modal=e,t.modal=e,this.modal.childListen(o.EVENT_NEXT,this.tutorialManager._next.bind(this.tutorialManager)),this.modal.childListen(o.EVENT_PREVIOUS,this.tutorialManager._previous.bind(this.tutorialManager))}.bind(this))}return i.then(function(){n.isUndefined(t.setModalPosition)||t.setModalPosition(),t.onShow()})["catch"](function(t){c.debug(t)})},u.prototype._isOnScreen=function(t){if(t.length){var e=s(window),i=e.scrollTop(),n=i+e.height(),o=t.offset().top,a=o+t.height();return n>=a&&o>=i}return!1},t.exports=a.expose("ModalTutorial",u)},function(t,e,i){"use strict";var n=i(196),s=i(200),o=i(201),a=function r(t,e){n.call(this,t,e),this.SUB_TUTORIAL_MAP={modal:o,homefeed_truncate:s},this._subTutorial=null;var i;this.displayData.modal?i=o:this.SUB_TUTORIAL_MAP[this.displayData.sub_type]&&(i=this.SUB_TUTORIAL_MAP[this.displayData.sub_type]),i&&(this._subTutorial=new i(this.placedExperience,this.tutorialManager))};a.prototype=Object.create(n.prototype),a.prototype.onStart=function(){return this._subTutorial.onStart()},a.prototype.onExit=function(){return this._subTutorial.onExit()},a.prototype.nextStep=function(t){return this._subTutorial.nextStep(t)},t.exports=a},function(t,e,i){"use strict";var n=i(1),s=i(21),o=i(194),a=i(11),r=i(196),l=i(28),h=i(80),d=i(81),c=i(23),u=i(27),p=function _(t,e){r.call(this,t,e),this._bottomBanner=null,this._embeddedStep=null,this._nuxContainerModule=null,this._transitioned=!1};p.prototype=Object.create(r.prototype),p.prototype.DEFAULT_GRID_LIMIT=25,p.prototype.onStart=function(){return c.instance.subscribe(a.PUBSUB_CHANNEL_NAVIGATE,a.PUBSUB_TOPIC_NAVIGATE_STARTED,this.stopTutorial.bind(this)),l.instance.getChildByModuleName("HomePage")?Promise.resolve():Promise.reject(new Error("not on home page"))},p.prototype.stopTutorial=function(t,e,i){"HomePage"===l.instance.getChildById("mainModule").toString()&&this.tutorialManager.setTutorialActive(!1)},p.prototype._modify=function(t){var e=this.getModuleArgs(this._embeddedStep);n.isUndefined(t.disable_scroll)||(e.options.disable_scroll=t.disable_scroll);var i={name:"NuxHomefeedTruncateContainer",options:{embedded_module:e,trigger_next_when_visible:!!t.grid_limit}};return new Promise(function(e,s){var o=function(t){t?(t.setTutorialManager(this.tutorialManager),this._nuxContainerModule=t):this._nuxContainerModule=null,e()}.bind(this),r={callbackOnEmbeddedModule:o,options:{module_to_embed:i}};n.extend(r.options,t||{}),c.instance.publish(a.PUBSUB_CHANNEL_CURRENT_USER,a.PUBSUB_TOPIC_HOMEFEED_NUX_MODIFICATIONS,r)}.bind(this))},p.prototype._bottomBannerSetupAfterStepLoad=function(t){if(t.bottom_banner_text){var e=new o({options:{banner_text:t.bottom_banner_text,keep_on_action:!0}});return this._bottomBanner=e,e.render().then(function(){l.instance.getChildByModuleName("HomePage").appendChild(e)})}this._bottomBanner&&(this._bottomBanner.destroy(),this._bottomBanner=null);var i=this._nuxContainerModule.getChildById("containedModule");i.addBanner&&i.addBanner()},p.prototype.nextStep=function(t){if(!l.instance.getChildByModuleName("HomePage"))return Promise.reject(new Error("not on home page"));var e,i=this.displayData.steps[t];if(this._transitioned||n.isNull(this._embeddedStep)&&t>0)this._transitioned=!0,this._embeddedStep=t,e=this._modify({grid_limit:null});else if(i.embed_step){this._embeddedStep=i.embed_step||t;var o=i.grid_limit||this.DEFAULT_GRID_LIMIT;e=this._modify({grid_limit:o,disable_scroll:!0}).then(function(){this._transitioned=!1}.bind(this))}else e=this._scrollToContainerModule();return e.then(function(){return this._bottomBannerSetupAfterStepLoad(i)}.bind(this)).then(function(){this._transitioned?s.set(a.GEN.CookieName.NUX_HOMEFEED_TRUNCATE_TRANSITIONED,this._transitioned.toString(),24):s.unset(a.GEN.CookieName.NUX_HOMEFEED_TRUNCATE_TRANSITIONED)}.bind(this))},p.prototype._scrollToContainerModule=function(){return new Promise(function(t,e){var i=this._nuxContainerModule.$el.offset().top,n=function(){var e={event_type:a.GEN.EventType.SCROLL,view_type:a.GEN.ViewType.FEED,view_parameter:a.GEN.ViewParameterType.USER_INTERESTS,component:a.GEN.ComponentType.INTEREST_PICKER},i=h.fromPlainObject(e);i.updateAuxData({value:"seo_nux_interestpicker"}),d.getInstance().addEvent(i),window.removeEventListener("DOMMouseScroll",this.preventScroll,!1),window.onmousewheel=document.onmousewheel=null,window.onwheel=null,this._transitioned=!0;var n={clearGrid:!0,clearGridCallback:t};c.instance.publish(a.PUBSUB_CHANNEL_CURRENT_USER,a.PUBSUB_TOPIC_HOMEFEED_NUX_MODIFICATIONS,n),l.instance.hideHeader();var s=this._nuxContainerModule.getChildById("containedModule");s.allowScroll&&s.allowScroll(),c.instance.publish(a.PUBSUB_CHANNEL_TUTORIAL,a.PUBSUB_TOPIC_TUTORIAL_SEO_HOMEFEED,{})}.bind(this);window.addEventListener("DOMMouseScroll",this.preventScroll,!1),window.onwheel=this.preventScroll,window.onmousewheel=document.onmousewheel=this.preventScroll,u.scrollToTop({callback:n,duration:1e3,newScrollOffset:i})}.bind(this))},p.prototype.onExit=function(){return s.unset(a.GEN.CookieName.NUX_HOMEFEED_TRUNCATE_TRANSITIONED),Promise.resolve()},p.prototype.preventScroll=function(t){t.preventDefault(),t.returnValue=!1},t.exports=p},function(t,e,i){"use strict";var n=i(198),s=i(135),o=function a(t,e){n.call(this,t,e),t.display_data.launch_experience_bottom_grid&&(this.loadModalSlowly=!0)};o.prototype=Object.create(n.prototype),o.prototype.onExit=function(){var t=this.modal;return t?(this.modal=null,s.get().removeModalWithAnimation(t,".flexibleSetup",500)):Promise.resolve()},t.exports=o},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(196),r=i(126),l=i(18),h=i(23),d="userEducationGuideBackgroundImage",c=function u(t,e){a.call(this,t,e)};c.prototype=Object.create(a.prototype),c.prototype.onStart=function(){return new Promise(function(t,e){return window.self!==window.top?void e(new Error("window is not the topmost window")):(this.trigger=this.displayData.trigger,this.setUpPubSub(),void("automatic"===this.trigger?this.moduleContainer?(this._prefetchAllImages(),t(void 0)):l.load({name:"UserEducationGuide"}).then(function(e){e.render().then(function(){s("body").append(e.$el),this.moduleContainer=e,this._prefetchAllImages(),t(void 0)}.bind(this))}.bind(this)):(this.tutorialManager.setTutorialActive(!1),t(void 0))))}.bind(this))},c.prototype.nextStep=function(t){return new Promise(function(e,i){if("automatic"!==this.trigger)return e(void 0),void this.tutorialManager.clearStoredData();var n=this._getStepInfo(t)||{};if(n.backgroundImage?this._showBackgroundImage(n.backgroundImage):this._hideBackgroundImages(),n.options&&n.options.zoomed_in&&!this.isZoomedIn)this._enterZoomedInMode();else if(n.options&&!n.options.zoomed_in&&this.isZoomedIn)return this._exitZoomedInMode().then(this.loadStepModule.bind(this,t)),void e(void 0);this.loadStepModule(t),e(void 0)}.bind(this))},c.prototype.onExit=function(){return new Promise(function(t,e){this._hideBackgroundImages(),this.isZoomedIn&&this._exitZoomedInMode(),this.moduleContainer.$el.empty(),this.viewChangeSubscriber&&(h.instance.getChannel(o.PUBSUB_CHANNEL_TUTORIAL).removeSubscriber(this.viewChangeSubscriber,[o.PUBSUB_TOPIC_VIEW_CHANGE]),this.viewChangeSubscriber=null),this.navigationSubscriber&&(h.instance.getChannel(o.PUBSUB_CHANNEL_SITE).removeSubscriber(this.navigationSubscriber,[o.PUBSUB_TOPIC_DEEP_LINK]),this.navigationSubscriber=null),t(void 0)}.bind(this))},c.prototype.loadStepModule=function(t){this._isCurrentCardStacked()||(this.getModuleArgs(t),l.load(this.moduleArgs).then(function(e){var i=this.currentModule;this.currentModule=e;var n=e;n.onEnter(function(){this._renderUserEducationGuide(e,i,t)}.bind(this))}.bind(this)))},c.prototype._renderUserEducationGuide=function(t,e,i){var n=this._getStepInfo(i);t.render().then(function(){e&&e.destroy(),n&&n.options&&n.options.attach_to?this.moduleContainer.$el.appendTo(n.options.attach_to):this.moduleContainer.$el.appendTo(s("body")),this.moduleContainer.prependChild(t),t.onShow()}.bind(this))},c.prototype.setUpPubSub=function(){n.contains(["automatic","manual"],this.trigger)?h.instance.publish(o.PUBSUB_CHANNEL_TUTORIAL,o.PUBSUB_TOPIC_TUTORIAL_TRIGGER_ACTIVE,this.placedExperience):h.instance.publish(o.PUBSUB_CHANNEL_TUTORIAL,o.PUBSUB_TOPIC_TUTORIAL_TRIGGER_ACTIVE,s.extend({},this.placedExperience,{showFlyout:!0})),"automatic"===this.trigger&&(this.viewChangeSubscriber=h.instance.subscribe(o.PUBSUB_CHANNEL_TUTORIAL,o.PUBSUB_TOPIC_VIEW_CHANGE,this.onViewChange.bind(this)),this.navigationSubscriber=h.instance.subscribe(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_DEEP_LINK,this.dismissTutorial.bind(this)))},c.prototype.onViewChange=function(t,e,i){if(this.viewChangeSubscriber){var n=this._getStepInfo(this.tutorialManager.currentStep)||{};i=i||{};var s=i.options||{},o=n.options&&n.options.viewChangeFilter||{};(i.moduleName!==o.moduleName||s.view_type!==o.view_type)&&this.dismissTutorial()}},c.prototype._isCurrentCardStacked=function(){var t=this._getStepInfo(this.tutorialManager.currentStep),e=this._getStepInfo(this.tutorialManager.currentStep)-1;return t&&t.options&&this.moduleArgs&&t.options.step_type!==o.StepTypes.TOOLTIP?e&&e.options.step_type===o.StepTypes.TOOLTIP?!1:!0:!1},c.prototype._getStackedCardGroup=function(t,e,i){var s=[];return n.each(t,function(t,n){t.options.stacked_group===i&&n>e&&s.push(t.options)}),s},c.prototype._enterZoomedInMode=function(){var t=s("body");t.addClass("userEducationGuideZoomedIn");var e=s('<div class="userEducationGuideOverlay" />');t.append(e),e.transition({scale:.8}),s(".App").transition({scale:.8}),this.isZoomedIn=!0},c.prototype._exitZoomedInMode=function(){return new Promise(function(t,e){var i=function(){s("body").removeClass("userEducationGuideZoomedIn"),s(".App").css("transform",""),this.isZoomedIn=!1,t(void 0)}.bind(this),n=function o(){s(".App").transition({scale:1},500,"ease",i)};s(".userEducationGuideOverlay").remove(),window.setTimeout(n,200)}.bind(this))},c.prototype._prefetchAllImages=function(){var t=s("body");n.each(this.displayData.steps,function(e){if(e.backgroundImage){var i=e.backgroundImage;i+=r.width<1400?" small":" big",t.append(s('<div class="'+d+" "+i+'" />'))}})},c.prototype._showBackgroundImage=function(t){if(t){var e=s("."+d+"."+t),i=s("."+d+".active");e&&e.length&&(i.length?(e.addClass("visible"),i.transition({opacity:0},function(){i.removeClass("active"),e.addClass("active").removeClass("visible")})):(e.addClass("visible"),s(".App").transition({opacity:0},function(){e.addClass("active").removeClass("visible")})))}},c.prototype._hideBackgroundImages=function(){var t=s("."+d+".active");s(".App").css({opacity:1}),t.transition({opacity:0},function(){t.remove()})},c.prototype.getModuleArgs=function(t){this.moduleArgs=a.prototype.getModuleArgs.call(this,t),this.moduleArgs.name||(this.moduleArgs.name="UserEducationGuideStepBase");var e=this._getStepInfo(t);e&&(this.moduleArgs.options.stacked_cards=this._getStackedCardGroup(this.displayData.steps,this.moduleArgs.options.current_step,e.options.stacked_group))},c.prototype._getStepInfo=function(t){return this.displayData.steps&&this.displayData.steps[t]},t.exports=c},function(t,e){"use strict";var i,n,s={setTutorialManager:function o(t){i=t},setExperienceTutorialManager:function a(t){n=t},isTutorialActive:function r(){return i&&i.isRunningTutorial()||n&&n.isRunningTutorial()}};t.exports=s},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(57),l=i(50),h=i(135),d=i(18),c=i(46),u=l.extend({onContentReady:function p(){this.options.anchor&&s(this.options.anchor).length>=1&&(this.loadPulser(),this.childListen(o.EVENT_PULSER_CLICKED,function(){this.currentPulser&&(this.currentPulser.destroy(),this.currentPulser=null),this.showTooltip().then(function(){this.destroy()})}))},loadPulser:function _(){var t={name:"TwoCirclesPulser",options:{anchor:this.options.anchor}};return s(this.options.anchor).hasClass("pinActionBarButton")?(this.options.append_to=".PinActionBar",n.extend(t.options,{fixed:!0,append_to:this.options.append_to})):t.options.fixed=!1,this.currentPulser&&this.currentPulser.destroy(),d.load(t).then(function(t){return this.appendChild(t),this.currentPulser=t,t.render()}.bind(this)).then(function(){r.instance.viewPlacedExperienceId(this.options.experience.id)}.bind(this))},_fetchToolTipArgs:function g(){var t=this.options.experience,e=t.display_data.tooltip;return{name:e.moduleName,options:e.options}},_ensureModal:function m(){if(this._toolTipModal)return Promise.resolve();var t=n.has(this.options,"modalStyle")?this.options.modalStyle+" ":"";t+=c.attributes.gender;var e={name:"Modal",options:{mask_type:"dark",can_dismiss:!1,modal_style:t}};return d.load(e).then(function(t){return t.render().then(function(){this._toolTipModal=t;var e=this.options.experience;this._toolTipModal.childListen(o.EVENT_NEXT,function(){r.instance.completePlacedExperienceId(e.id),this.destroy()}),this._toolTipModal.childListen(o.EVENT_DISMISS,function(){r.instance.dismissPlacedExperienceId(e.id),this.destroy()}),h.get().showModal(this._toolTipModal,null)}.bind(this))}.bind(this))},showTooltip:function f(){return d.load(this._fetchToolTipArgs()).then(function(t){return this._renderToolTip(t)}.bind(this))},_renderToolTip:function C(t){return this._ensureModal().then(function(){return this._toolTipModal.setSubmodule(t).then(function(){n.isUndefined(t.setModalPosition)||t.setModalPosition(),t.onShow()})}.bind(this))}});u.prototype.className="ToolTipPulser",t.exports=a.register(u)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(9),a=i(11),r=i(51),l=i(197),h=i(28),d=i(170),c=i(43),u=i(16),p=i(18),_=i(41),g=i(54),m=i(203),f=i(27),C=u.getLogger("TutorialManager"),E=function T(t,e){this.url=t,this.forceRefresh=!!e},v=function N(){this.TUTORIAL_CONFIG={testTutorial:{stepNames:[],nextUrlInfo:function t(){return new E(null,!1)},canExit:!1,onUserExit:function e(){}},rebuildHomeFeedSteps:{stepNames:["NewUserInterestPicker","InitializeHomeFeedSpinner"],expiredSteps:{},canExit:!1,stepExtraData:{InitializeHomeFeedSpinner:{moduleName:"BuildingHomeFeedSpinner",options:{is_nux:!1}}},nextUrlInfo:function i(){return new E("/?allow_nux=no",!0)},onUserExit:function n(){}},interestsNuxMweb:{stepNames:["NewUserWelcome","NewUserInterestPicker","NewUserSetupSpinner"],expiredSteps:{},canExit:!1,nextUrlInfo:function s(){return new E("/",!0)},onUserExit:function o(){}}},this.init()};v.prototype={init:function S(){this._isActive=!1,this.moduleContainer=null,this.renderModule=!0,this.progressModule=null,s("body").removeClass(this.tutorialClassName),this.tutorialName=null,this.tutorialClassName=null,this.tutorial=null,this.allStepNames=null,this.numTotalSteps=null,this.currentStep=null,this.isZoomedIn=!1,m.setTutorialManager(this)},startTutorial:function b(t,e){if(e=e||{},m.isTutorialActive())return Promise.reject(new Error("another tutorial is already active"));var i=this.TUTORIAL_CONFIG[t];return i?(this.moduleContainer=e.moduleContainer,this.renderModule=e.renderModule,this.progressModule=e.progressModule||this.progressModule,this._isActive?(this.renderModule===!1||this.currentModule||this._loadModuleForStep(this.currentStep),Promise.resolve()):(this._start(t,!0),Promise.resolve())):Promise.reject(new Error("tutorial config does not exist"))},setProgressModule:function y(t){this.progressModule!==t&&(this.progressModule=t,this.progressModule.listen(this.progressModule,a.EVENT_NEXT,this._next.bind(this)),this.progressModule.listen(this.progressModule,a.EVENT_PREVIOUS,this._previous.bind(this)),this._updateProgressModuleStep())},stopTutorial:function P(){this._isActive&&this.init()},resumeTutorial:function B(){if(!m.isTutorialActive()){var t=this._getStoredData();t&&t.name&&this._start(t.name,!1)}},_start:function A(t,e){var i=this.TUTORIAL_CONFIG[t];i&&(this._clear(e),this._isActive=!0,this.tutorialName=t,this.tutorialClassName=this.tutorialName+a.TUTORIAL_POSTFIX,s("body").addClass(this.tutorialClassName),this.tutorial=i,this.expiredSteps=this.tutorial.expiredSteps,this.allStepNames=this.tutorial.stepNames,this.numTotalSteps=this.tutorial.stepNames.length,this._funnelPrefix="tutorial_"+t,this.renderModule=this.renderModule===!1?!1:!0,(this.moduleContainer||!this.renderModule)&&this._setStep(this._getStoredStep()||this.allStepNames[0]),d.log("tutorial."+t+"_started"))},isRunningTutorial:function R(){return this._isActive},_next:function w(){var t=this._getStepIndex(this.currentStep);return this.currentStep===n.last(this.allStepNames)?void this._endTutorial(!0):void this._setStep(this.allStepNames[t+1])},_previous:function O(){var t=this._getStepIndex(this.currentStep);return 0===t?(c.logToServer(c.SERVER_LOG_TYPE.LOG,c.HTTP_METHOD.GET,{type:"tutorial",tutorial:this.tutorialName,step:this.currentStep,step_number:t,action:"exit"}),this.tutorial.onUserExit(t),void this._endTutorial(!1)):void this._setStep(this.allStepNames[t-1])},_dismiss:function D(){this._endTutorial(!1)},_endTutorial:function x(t){var e=function(){var e=this.tutorial.nextUrlInfo().url,i=this.tutorial.nextUrlInfo().forceRefresh;if(this._clear(!0),t&&e){var n=new _;i&&(n.evt=new r("",null,{forceRefresh:1})),l.navigate(e,n)}}.bind(this),i=function(){return this.progressModule?this.progressModule.endMandatoryFlow().then(function(){this.progressModule&&this.progressModule.remove();var t=h.instance;t.updateNavigationBar()}.bind(this)):Promise.resolve()}.bind(this),n=function(){var e;if(this.currentModule){var i=t?this.currentModule.completePlacedExperience():this.currentModule.dismissPlacedExperience();e=i.fin(function(){return new Promise(function(t){this.currentModule.onExit(t)}.bind(this))}.bind(this)),this.currentModule.onTutorialComplete()}else e=Promise.resolve();return e}.bind(this);n().then(i).then(e),t&&f.trackRegisterAction(this._funnelPrefix+"_complete")},_setStep:function L(t){return f.trackRegisterAction(this._funnelPrefix+"_"+t),C.debug("set step from",this.currentStep,"to",t),t!==this.currentStep?(n.contains(this.allStepNames,t)||this.expiredSteps[t]||this._endTutorial(!0),this.expiredSteps[t]&&(t=this.expiredSteps[t]),this.currentStep=t,this._saveCurrentStep(),this.currentModule?void this.currentModule.onExit(function(){this.currentModule.onRemoved(),this._loadModuleForStep(t)}.bind(this)):void(this.renderModule&&this._loadModuleForStep(this.currentStep))):void 0},_setNextStepClass:function k(t){var e=s("body"),i=null,n=this._getStepIndex(t);
n>0&&(i=this.allStepNames[n-1],e.removeClass(i+a.TUTORIAL_STEP_POSTFIX)),e.addClass(t+a.TUTORIAL_STEP_POSTFIX)},_updateProgressModuleStep:function U(){if(this.currentStep){var t=this._getStepIndex(this.currentStep);this._setNextStepClass(this.currentStep),this.progressModule&&this.progressModule.nextStep(t+1)}},_loadModuleForStep:function M(t){this.renderStepModule(t)},renderStepModule:function F(t){var e=this.getModuleArgs(t);t=t?t:this.tutorial.stepNames[0],p.load(e).then(function(t){var e=this.currentModule;this.currentModule=t;var i=t;i.onEnter(function(){this._renderStepModule(t,e)}.bind(this))}.bind(this))},_renderStepModule:function $(t,e){t.render().then(function(){var e=this.moduleContainer.children[0];this.moduleContainer.prependChild(t),e&&e.destroy(),t.onShow(this._updateProgressModuleStep())}.bind(this))},getModuleArgs:function H(t){var e=t,i={tutorial_name:this.tutorialName,current_step:this._getStepIndex(t),total_steps:this.numTotalSteps,can_exit:this.tutorial.canExit};return this.tutorial.stepExtraData&&this.tutorial.stepExtraData[t]&&(e=this.tutorial.stepExtraData[t].moduleName,s.extend(i,this.tutorial.stepExtraData[t].options||{})),{name:e,options:i}},_getStepIndex:function V(t){var e=n.indexOf(this.allStepNames,t);return-1!==e?e:0},_getStoredStep:function G(){var t=this._getStoredData();return t&&t.name!==this.tutorialName&&(this._clearStoredData(),t=null),t&&t.step||null},_getStoredData:function W(){var t=g.sessionStorage.getItem(a.TUTORIAL_SESSION_KEY);return t&&t.experienceTutorial?null:t},_saveCurrentStep:function K(){g.sessionStorage.setItem(a.TUTORIAL_SESSION_KEY,{name:this.tutorialName,step:this.currentStep,experienceTutorial:!1})},_clear:function j(t){this.tutorial&&(this.stopTutorial(),t&&this._clearStoredData())},_clearStoredData:function Y(){g.sessionStorage.removeItem(a.TUTORIAL_SESSION_KEY)}};var I=null;v.instance=function(){return I||(I=new v),I},t.exports=o.expose("TutorialManager",v)},function(t,e,i){"use strict";var n=i(1),s=i(3),o=i(34),a=function r(){this.container=null,this.toasts=[]};n.extend(a.prototype,s.Events),n.extend(a.prototype,{setContainer:function l(t){this.container=t},getContainer:function h(){return this.container},addToast:function d(t,e){e=e||50,t.renderExistingData().then(function(){var i=this.getContainer();i.children.length?o.setTimeout(function(){i.appendChild(t)},e):i.appendChild(t)}.bind(this))},removeAllToasts:function c(){this.getContainer().$el.empty()}}),t.exports=new a},,,function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="IframeEmbed",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(29),r=i(23),l=i(72),h=i(8);i(116),i(129),i(174);var d=o.extend({events:{"focus .content":"onFocusCommentInput","keypress .content":"onKeypressCommentInput","click .addComment":"addComment"},getPinCommentInputValue:function c(){return this.getChildById("pinCommentField").getValue()},getAddCommentButton:function u(){return this.getChildById("addCommentButton")},addComment:function p(t){a.trackEvent("comment_create",n.GA_ACTION_CLICK_SUBMIT);var e=this.getPinCommentInputValue(),i=this._getCommentFieldMaxLength();if(!(e&&i&&e.length>i)){var s=this.options.pin_id,o=h.create("PinCommentResource",{pin_id:s,text:e}),d=this.getAddCommentButton();d.showLoading(),this.getChildById("pinCommentField").reset(),l.instance.callCreate(o).then(function(){a.trackEvent("comment_create",n.GA_ACTION_SUCCESS),r.instance.publish(s,n.PUBSUB_TOPIC_PIN_COMMENT_CREATED)}).fin(function(){d.hideLoading()})}},onFocusCommentInput:function _(){var t=this.$el.find(".addComment");this.options.type&&"closeup"===this.options.type?t.css("display","block"):t.show(),this.triggerEvent(n.EVENT_DIMS_CHANGED,null,!0)},onKeypressCommentInput:function g(t){t.which===n.KeyCode.ENTER&&(this.addComment(),t.preventDefault())},_getCommentFieldMaxLength:function m(){var t=this.getChildByModuleName("TextField");return t.options.maxlength}});d.prototype.className="PinDescriptionComment",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(212),a=i(29),r=i(23),l=i(8),h=o.extend({getLikeResource:function d(t){var e="PinLikeResource2";return l.create(e,{pin_id:this.options.pin_id,source_interest_id:this.options.source_interest_id})},_getGACategory:function c(t){return t?"pin_like":"pin_unlike"},onClick:function u(){var t=!this.options.liked;o.prototype.onClick.call(this);var e=this._getGACategory(t);a.trackEvent(e,n.GA_ACTION_CLICK)},onToggleSuccess:function p(t){var e=this._getGACategory(t),i=t?n.PUBSUB_TOPIC_PIN_LIKED:n.PUBSUB_TOPIC_PIN_UNLIKED;a.trackEvent(e,n.GA_ACTION_SUCCESS),r.instance.publish(this.options.pin_id,i)}});h.prototype.className="PinLikeButton",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(116),o=i(19),a=i(14),r=i(131),l=i(31),h=i(46),d=i(27),c=s.extend({CssClassName:n.extend(s.prototype.CssClassName,{UNLIKE:"unlike",LIKE:"like"}),onClick:function u(){this.ensureAuthentication()&&this._toggle()},getAuthRedirectUrl:function p(){return h.isAuthenticated()?void d.changeWindowLocation(l.getRegisterUrl({action:"like"}),!1):r.showInlineSignupModalOnButtonClick("LikeButton")},setState:function _(t){var e=this.$el;this.options.liked=t,e.toggleClass(this.CssClassName.UNLIKE,t);var i=t?a._("Unlike"):a._("Like");this.options.show_text&&(this.options.text=i),this.setAccessibilityText(i),this.render()},getLikeResource:function g(t){throw new Error("must be overridden")},onOptimisticToggle:function m(t){},onToggleSuccess:function f(t){},_toggle:function C(){var t=!this.options.liked,e=this.getLikeResource(t);if(e){var i=t?e.callCreate():e.callDelete();this.options.optimistic?(this.setState(t),this.onOptimisticToggle(t),i.then(function(){this.onToggleSuccess(t)}.bind(this),function(){this.setState(!t)}.bind(this))):(this.showLoading(),i.then(function(){this.setState(t),this.onToggleSuccess(t)}.bind(this)).fin(function(){this.hideLoading()}.bind(this)))}}});c.prototype.className="LikeButton",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({incrementLike:function a(){this.data.liked_by_me=!0,this._alterAttribute("like_count",1)},decrementLike:function r(){this.data.liked_by_me=!1,this._alterAttribute("like_count",-1)},incrementRepin:function l(){this._alterAttribute("repin_count",1)},_alterAttribute:function h(t,e){if(this.model){var i=this.data,n=i[t]||0,s=Math.max(n+e,0);i[t]=s,this.model.set(i),this.renderExistingData()}}});o.prototype.className="SocialIconsCounts",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23);i(210),i(215);var r=o.extend({events:{"click .showMore":"onShowMore","mousedown .content":"onTextAreaMouseDown","keydown .content":"onTextAreaPossiblyResized","mouseup .content":"onTextAreaPossiblyResized","click .pinUserCommentBox textarea":"showCommenter","click .toggleComments":"_toggleComments"},CssClassName:{HIDDEN:"hidden",COLLAPSED:"collapsed"},onCreated:function l(){this.commentContentHeight=null,this.options.state_hideShowMoreLink=!1},onContentReady:function h(){var t=this.options.pin_id;if(t){var e={};e[n.PUBSUB_TOPIC_PIN_COMMENTS_LAST_PAGE_REACHED]=this.onLastPageReached,this.pubsubSubscribe(t,e)}this._visible=!0},onAddedToDom:function d(){this.options.in_gator&&this.updateOptionsAndDom({state_hideComments:!0})},updateDom:function c(){this.$(".showMore").toggleClass(this.CssClassName.HIDDEN,this.options.state_hideShowMoreLink),this.options.in_gator&&(this.$(".commentList").toggleClass(this.CssClassName.HIDDEN,this.options.state_hideComments),this.$(".pinUserCommentBox").toggleClass(this.CssClassName.HIDDEN,this.options.state_hideComments),this.$(".commentDropdownIcon").toggleClass(this.CssClassName.COLLAPSED,this.options.state_hideComments))},onLastPageReached:function u(){this.updateOptionsAndDom({state_hideShowMoreLink:!0})},toggle:function p(){this._visible?this.hide():this.show(),this._visible=!this._visible},onShowMore:function _(t){this._requestComments(t)},_toggleComments:function g(t){this.loadedComments?this.updateOptionsAndDom({state_hideComments:!this.options.state_hideComments}):(this._requestComments(t),this.loadedComments=!0,this.updateOptionsAndDom({state_hideComments:!1}))},_requestComments:function m(t){t.stopPropagation(),t.preventDefault(),a.instance.publish(this.options.pin_id,n.PUBSUB_TOPIC_PIN_COMMENTS_NEXT_PAGE_REQUESTED)},onTextAreaMouseDown:function f(){this.commentContentHeight=this.$(".content").height()},onTextAreaPossiblyResized:function C(){if(null!==this.commentContentHeight){var t=this.$(".content").height();this.commentContentHeight!==t&&(this.triggerEvent(n.EVENT_DIMS_CHANGED,null,!0),this.commentContentHeight=t)}},showCommenter:function E(){this.options.is_modular_closeup&&this.$(".pinUserCommentBox .commenterWrapper").addClass("show")}});r.prototype.className="PinCommentsPage",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(62),r=i(23),l=i(8);i(125);var h=o.extend({events:{},onCreated:function d(){},onContentReady:function c(){var t=this.options.pin_id;if(t){var e={};e[n.PUBSUB_TOPIC_PIN_COMMENT_CREATED]=this.onPinCommentCreated,e[n.PUBSUB_TOPIC_PIN_COMMENTS_NEXT_PAGE_REQUESTED]=this.fetchMore,this.pubsubSubscribe(t,e)}},fetchMore:function u(){this.resource||(this.resource=l.create("PinCommentListResource",{field_set_key:this.options.field_set_key,pin_id:this.options.pin_id})),this.resource.options.page_size=n.GEN.Settings.API_MAX_PAGE_SIZE,this.resource.getLatestBookmark()||this.resource.setBookmarks([this.options.bookmark]),this.renderAdditional(a.PREPEND).then(function(){this.resource.atEnd()&&r.instance.publish(this.options.pin_id,n.PUBSUB_TOPIC_PIN_COMMENTS_LAST_PAGE_REACHED)}.bind(this))},populateComment:function p(t){var e=this.getChildById("pinCommentField");e.setValue(t),e.focus()},onPinCommentCreated:function _(){this.options.count++,this.render()}});h.prototype.className="PinCommentList",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(217);i(173);var l="add_to_map",h=a.extend({events:{"click a.pinImageWrapper":"onClick",click:"onClick"},CssClassName:{DISABLED:"disabled",SELECTED:"selected"},onCreated:function d(){this.onImageLoad=this.onImageLoad.bind(this),this.onImageError=this.onImageError.bind(this),this.options.state_isSelected=!1,this.options.state_disabled=!!this.options.disabled},onAdded:function c(){this.updateImage()},updateDom:function u(){this.$el.toggleClass(this.CssClassName.SELECTED,this.options.state_isSelected),this.$el.toggleClass(this.CssClassName.DISABLED,this.options.state_disabled)},updateImage:function p(){var t=this.$(".pinImageWrapper"),e=this.$img=n("<img>");e.on("load",this.onImageLoad),e.on("error",this.onImageError),e.attr("src",this.options.url),t.append(e)},onImageLoad:function _(){this.$img.width()<s.MIN_PINNABLE_IMAGE_WIDTH||this.$img.height()<s.MIN_PINNABLE_IMAGE_HEIGHT?(this.log.debug("Too small!",this.$img.width(),this.$img.height()),this.destroy()):this.$el.css("visibility","visible"),this.triggerEvent(s.EVENT_CONTENT_CHANGED,null,!0)},onImageError:function g(){this.destroy()},enable:function m(){this.updateOptionsAndDom({state_disabled:!1})},disable:function f(){this.updateOptionsAndDom({state_disabled:!0})},select:function C(){this._setSelected(!0)},_setSelected:function E(t){this.updateOptionsAndDom({state_isSelected:t})},deselect:function v(){this._setSelected(!1)},onClick:function I(t){if(this.options.view_type===l){var e=this.$("img").attr("src");this.triggerEvent(s.EVENT_PLACE_IMAGE_SELECTED,e,!0),this.select()}else if("hoverMask"===t.target.className)return this.createPin(),!1},createPin:function T(){var t=this.options.link,e=this.options.url,i={action:"create",method:"scraped",render_existing_pin:!0,hide_pin_credits:!0,is_clone_for_repin:!0,image_url:e},n={container_class:"webNewContentNewRepin",mask_type:"webNewContentNewRepin",modal_style:"webNewContentNewRepin",custom_entrance_animation:!0,custom_exit_animation:!0},s=new r({id:"pinCreate",options:i,resource:{name:"FakePinResource",options:{description:"",image_url:e,link:t}}});this.showInModal(s,n)}});h.prototype.className="Pinnable",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(218),a=i(232),r=i(167),l=i(11),h=i(57),d=i(193),c=i(50),u=i(30),p=i(234),_=i(8),g=i(133),m=i(206),f=i(40),C=i(80),E=i(81),v=i(52),I=i(35),T=i(29),N=i(14),S=i(135),b=i(18),y=i(19),P=i(23),B=i(72),A=i(34),R=i(46);i(116),i(237),i(238),i(166),i(242);var w=490,O=47,D=12,x=660,L=200,k="ease-out",U="extension_access",M=c.extend({CssClassName:{ANIMATE_OUT:"animateOut",CAPPED_MAX_HEIGHT:"cappedMaxHeight",PINIT_BUTTON_LOADING:"loading",PINIT_BUTTON_SUCCESS:"success",PINIT_ITEM_ACTIVE:"activeItem",PINIT_PINNING:"pinning",SHOWING_CREATE_BOARD:"showingCreateBoard"},onCreated:function F(){this.childListen(l.EVENT_CHANGE,this.onChildChange),this.childListen(l.EVENT_BOARD_CREATED,this.onBoardCreated),this.childListen(l.EVENT_DUPE_DETECTED,this.onDupeDetected),this.childListen(l.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(l.EVENT_CONTENT_CHANGED,this.onChildContentChanged),this._shouldAnimatePinBackToGrid=!0,this.removeClickJackStyle()},onDupeDetected:function $(t){this.adjustHeight(!0)},onChildContentChanged:function H(t){this.addCreateBoardStaticItems(),this.adjustHeight()},setImage:function V(t){var e=this.getChildById("pin");e.setPinImages(t),e.renderExistingData()},onButtonClick:function G(t){var e=t.target;if(e.isCancelButton()){var i=this.getChildById("boardCreate");i?(t.stopPropagation(),this.getCloseButton().fadeOut(),this.hideCreateBoard()):("closeButton"===e.id&&this._logCustomContextEvent(l.GEN.EventType.WEB_PIN_CREATE_CLOSE_MODAL_BEFORE_PINNING,l.GEN.ElementType.WEB_PIN_CREATE_BOARD_FILTER,l.GEN.ComponentType.MODAL_REPIN,{}),this.options.is_csr&&window.parent.postMessage("navigate",l.PIN_IT_DOMAIN),this.modal||this.destroy())}},removeClickJackStyle:function W(){var t=window.location.hostname,e=new RegExp(/^[a-z]{2}\.pinterest\.com$/);if(t===l.GEN.Settings.CANONICAL_MAIN_DOMAIN||t.match(e)){var i=s(".antiClickJack");i.removeClass("antiClickJack")}},animateEntranceToModal:function K(){this.modal&&(this.modal.setVisible(!0),this.$el.transition({duration:0,opacity:0},function(){this.animatePinToModal(),this.adjustHeight()}.bind(this)).transition({duration:0,scale:.95}).transition({opacity:1,scale:1,duration:L}))},_onAnimateModalOutComplete:function j(){S.get().setAnimatedModule(null),this._pinGridOffset=0,this.modal&&this.modal.destroy()},_animateModalOut:function Y(){if(this.modal){var t=this.modal.getMask();if(t.addClass(this.CssClassName.ANIMATE_OUT),this.shouldAnimatePinBackToGrid()){this.animatePinBackToGrid();var e=this.modal.getContent();e.transition({duration:L,opacity:0,scale:.95,easing:k},function(){this._onAnimateModalOutComplete()}.bind(this))}else{var i=this.$el.outerHeight(),n=this.modal.getPositionElement(),s=this.modal.getContent(),o=0;s.length&&(o=s.offset().top-this.getScrollableElement().scrollTop()),n.transition({y:o+i+O,duration:L},function(){this._onAnimateModalOutComplete()}.bind(this))}}},animateExitFromModal:function q(){this._animateModalOut()},shouldAnimatePinBackToGrid:function z(){return this._shouldAnimatePinBackToGrid},adjustHeight:function X(t){var e=S.get(),i=e&&e.getAnimatedModule();i||(i=this.getChildById("pin"));var n=i.getContent(),o=this.$(".socialShareWrapper").height();if(f.instance.is_mobile_agent&&i)this.$el.height(s(window).height());else if(i){var a=n.height();a+=2*O;var r;if(o&&(o+=u.siteConst.PIN_MARGIN),w>a)r=w;else if(a>x-O-o){n.addClass(this.CssClassName.CAPPED_MAX_HEIGHT);var l=n.find(".pinImageActionButtonWrapper"),h=a-l.height(),d=x-h-o;r=x-o,t||l.css("maxHeight",d+"px")}else r=a;t||this.$el.height(r)}else{var c=o?u.siteConst.PIN_MARGIN+o:0;this.$el.height(x-c)}var p=this.getBoardpicker().getList().getContent(),_=this.$el.height()-p.position().top;if(f.instance.is_mobile_agent){var g=o?D+o:0;_=_-D-g}if(p.height(_),f.instance.is_mobile_agent){if(n&&n.hasClass("compact")){var m=i.getChildById("pinDescriptionField").getContent().find("textarea"),C=n.find(".pinImageWrapper"),E=i.getPinDescriptionElement(),v=E.outerHeight(!0)-E.height();m.height(C.height()-v)}}else{var I=this.$el.find(".titleContainer").height();this.$el.find(".boardsWrapper").css("padding-top",I+"px")}},animatePinToModal:function Q(){var t=S.get().getAnimatedModule();if(t){t.setDescriptionInputHeight();var e=t.getContent(),i=e.offset(),n=this.$el.offset().left;n+=(this.$el.width()/2-u.siteConst.PIN_WIDTH)/2,this._pinGridOffset=i;var s=Math.round((this.$el.height()-2*O-e.height())/2),o=this.$el.offset().top-i.top+s+O;e.transition({x:n-i.left,y:o,duration:L,easing:"cubic-bezier(0,0.9,0.3,1)",opacity:1},function(){e.detach(),this.insertChild(t,this.$(".pinModuleHolder")),e.transition({x:0,y:0,duration:0}).css({top:0,position:"static",left:0})}.bind(this))}},hideDupPinWarning:function Z(){var t=this.getPinDupWarning();t&&t.fadeOut(function(){t.hide()})},showPinDupWarning:function J(){var t=this.getPinDupWarning();t&&t.fadeIn(function(){t.show()})},onChildChange:function tt(t){switch(t.target.id){case"boardPicker":var e=t.data,i=e.id,n=e.name;i||n?(i||n)&&(i?A.setTimeout(function(){this.createPin(e)}.bind(this),50):this.showCreateBoard(n)):this.showCreateBoard("")}},getPinDupWarning:function et(){return this.getChildById("pinDupWarning")},getCloseButton:function it(){return this.getChildById("closeButton")},showCreateBoard:function nt(t){if(!this._showingCreateBoard){this._showingCreateBoard=!0,this.hideDupPinWarning();var e={board_name:t,form_class:"modalPinCreate",class_name:"pinCreate",custom_board_create_success_destroy:!0,close_typeahead_on_selection:!0,link_to_users_profiles:!1,add_collaborators_after_creating:!0,navigate_on_success:!1,show_secret_boards_learn_more:!1,show_collaborators_learn_more:!1,show_map_learn_more:!1,typeahead_overflow_visible:!1,prevent_default_on_enter_collabs:!0};this.getCloseButton().fadeOut();var i=new o({id:"boardCreate",options:e});i.render().then(function(){var t=i.getContent();t.transition({opacity:0,duration:1}),this.insertChild(i,this.$(".boardsWrapper")),i.animateIn(function(){this.getCloseButton().fadeIn(),i.setCollabsMaxHeight(),this.$el.addClass(this.CssClassName.SHOWING_CREATE_BOARD)}.bind(this))}.bind(this))}},hideCreateBoard:function st(t){this._showingCreateBoard=!1,this.showPinDupWarning(),this.$el.removeClass(this.CssClassName.SHOWING_CREATE_BOARD);var e=this.getChildById("boardCreate");e&&e.animateOut(function(){this.getCloseButton().fadeIn()}.bind(this))},getPinResource:function ot(){var t="PinResource",e={},i,n=S.get(),s=n&&n.getAnimatedModule();s&&(i=s);var o=this.getChildById("pin");o&&(i=o);var a=i.data,r=i.getDescriptionText();this.isRepin()&&(e.pin_id=a.id,e.is_buyable_pin=!!this.data.buyable_product,t="RepinResource"),this.options.is_csr&&(e.is_csr=!0,e.parent_csr_id=this.options.parent_csr_id);var l=this.options.method;l&&(e.method=l),e.description=r;var h=a.link;if(e.link=h,e.is_video=a.is_video,e.guid=this.options.guid,!this.isRepin()){var d=a.image_url;d=this.prependSchemeIfNeeded(d,h),e.image_url=d}if(this.getSocialShare()){var c=this.getSocialShare().getNetworkChecked(g.TWITTER);""!==c&&(e.share_twitter=c),c=this.getSocialShare().getNetworkChecked(g.FACEBOOK),""!==c&&(e.share_facebook=c)}return _.create(t,e)},prependSchemeIfNeeded:function at(t,e){if(!e)return t;var i=new RegExp(/http(s?):/);if(!i.test(t)){var n=i.exec(e);if(n&&n.length){var s=n[0];t=s+t}}return t},showPinItLoadingForBoardId:function rt(t){this.$el.addClass(this.CssClassName.PINIT_PINNING);var e=this.getBoardpicker(),i=e.getSelectedElement(),n=i.find(".Button");i.addClass(this.CssClassName.PINIT_ITEM_ACTIVE),this._$button=n,n.addClass(this.CssClassName.PINIT_BUTTON_LOADING)},showPinItSuccess:function lt(){return this.options.is_csr&&window.parent.postMessage("showToast",l.PIN_IT_DOMAIN),new Promise(function(t,e){this._removeButtonLoadingClass().addClass(this.CssClassName.PINIT_BUTTON_SUCCESS),setTimeout(t,500)}.bind(this))},_removeButtonLoadingClass:function ht(){var t=this.getBoardpicker(),e=t.getSelectedElement();return e.removeClass(this.CssClassName.PINIT_ITEM_ACTIVE),this._$button.removeClass(this.CssClassName.PINIT_BUTTON_LOADING)},_hideSocialCheckboxes:function dt(){this.getSocialShare()&&this.getSocialShare().hide()},createPin:function ct(t){if(!this.requestPending&&this._isPinDescriptionValid()){var e=t.id;this.showPinItLoadingForBoardId(e);var i=t.privacy===l.BoardPrivacy.SECRET;i&&this._hideSocialCheckboxes();var n=this.getPinResource();n.options.board_id=e,this.requestPending=!0,n.callCreate({showError:!1}).then(function(t){this._onPinCreateSuccess(t)}.bind(this),function(t){if(T.trackEvent(this.GACategory,l.GA_ACTION_ERROR),this._removeButtonLoadingClass(),this.$el.removeClass(this.CssClassName.PINIT_PINNING),"create"===this.options.action&&t.api_error_code===l.API_SERVER_SPAM_CONTENT){var e={name:"ConfirmDialog",options:{fluid:!0,template:"blocked_source"}};b.load(e).then(function(t){t.render().then(function(){this.parent.appendChild(t),this.destroy()}.bind(this))}.bind(this))}else I.showError(t.message)}.bind(this)).fin(function(){this.requestPending=!1,this.hideLoading()}.bind(this))}},onBoardCreated:function ut(t){var e=t.data,i=this.getBoardpicker(),s=n.clone(i.resource);return s.callGet(s).then(function(t){if(t&&!t.error){var i=this.getBoardpicker();i.options.select_first_board=!1,i.model.set(t.resource_response.data),i.renderExistingData().then(function(){this.hideCreateBoardModuleAndHighlightBoard(e)}.bind(this))}}.bind(this))},hideCreateBoardModuleAndHighlightBoard:function pt(t){this.hideCreateBoard(),this.adjustHeight(!0),v.deferDomManipulation(function(){var e=t.id;this.hightlightBoardWithId(e),this.createPin(t)}.bind(this))},hightlightBoardWithId:function _t(t){var e=this.getBoardpicker(),i=e.getAllBoards(),s=n.find(i,function(e){return e.id===t}),o=n.indexOf(i,s);o>=0&&e.selectBoardAtIndex(o)},_onPinCreateSuccess:function gt(t){if(this.options.is_csr&&this.options.parent_csr_id){var e={event_type:l.GEN.EventType.PIN_REPIN,view_type:l.GEN.ViewType.SAVE,view_parameter:l.GEN.ViewParameterType.PIN_CREATE,object_id_str:t.resource_response.data.id},i=C.fromPlainObject(e);i.updateAuxData({csr_id:this.options.parent_csr_id}),E.getInstance().addEvent(i)}if(this.isRepin()&&this.data.buyable_product){var n=r.getCloseupRichTypes(this.data),s=r.getCommerceAuxData(this.data),e={event_type:l.GEN.EventType.PIN_REPIN,view_type:l.GEN.ViewType.PIN,view_parameter:l.GEN.ViewParameterType.PIN_CREATE_REPIN,object_id_str:this.data.id},i=C.fromPlainObject(e);i.setCloseupRichTypes(n),i.updateAuxData(s),E.getInstance().addEvent(i)}T.trackEvent(this.GACategory,l.GA_ACTION_SUCCESS),this._shouldAnimatePinBackToGrid=!1;var o=this.getBoardpicker();this.pinForm&&(o=this.pinForm.getBoardPicker());var c=_.clone(o.resource);B.instance.callGet(c),h.instance.refreshPlacedExperiences(),this.showPinItSuccess().then(function(){var e=t.resource_response.data;if(this.modal&&this.isRepin()){var i={pin:e};M.prototype.triggerCommonPinCreateEvents(this,e,{isRepin:this.isRepin(),originalPinId:this.data.id}),this._animateModalOut(),m.removeAllToasts();var n=new p({data:i}),s=a.isExtensionInstalled(),o={is_extension_installed:!!s,pinned_with_bookmarklet:!this.isRepin()};return void d.launchPlacedExperience(l.GEN.Placement.WEB_PIN_SUCCESS,o).then(function(t){if(!t&&this._suggestedBoard){i.suggested_board=this._suggestedBoard;var e=new p({options:{is_recommendation:!0},data:i});m.addToast(e)}m.addToast(n,0)}.bind(this))}this.modal&&(this.modal.options.custom_exit_animation=!1);var r=e.board,h=r.url,c=r.category,u=r.id,_=this.options.action,g=r.name,f=r.privacy,C=r.is_collaborative,E={id:"pinSuccess",name:"PinCreateSuccess",options:{action:_,board_name:g,board_category:c,board_id:u,board_url:h,domain:e.domain,pin_id:e.id,is_collaborative:C,is_extension_installed:!!a.isExtensionInstalled(),privacy:f,method:this.options.method,auto_close:!0,is_csr:this.options.is_csr}};"pin_create_ignition"===this.options.action?E.options.auto_close=!1:this._createdBoardToEdit&&this._createdBoardToEdit.id===r.id&&(E={id:"pinSuccess",name:"PinCreateSuccessBoardEdit",resource:{name:"BoardResource",options:{board_id:r.id,field_set_key:"basic"}},options:{pinCreateInfo:E}}),this.showLoading(),b.load(E).then(function(t){this.modal?this.modal.setSubmodule(t):"pin_create_ignition"===this.options.action?this.showInModal(t,{}):t.render().then(function(){this.parent.appendChild(t),this.destroy()}.bind(this))}.bind(this)),M.prototype.triggerCommonPinCreateEvents(this,e,{isRepin:this.isRepin(),originalPinId:this.data.id})}.bind(this))},isRepin:function mt(){return!(!this.data||!this.data.id)},animatePinBackToGrid:function ft(){var t=S.get().getAnimatedModule();if(t){var e=t.getContent(),i=e.offset(),n=this._pinGridOffset.left-i.left,o=this._pinGridOffset.top-i.top;e.detach().appendTo(s(".App")).css({position:"absolute",top:i.top+"px",left:i.left+"px"}).transition({x:0,y:0,duration:0}).transition({x:n,y:o,duration:L,easing:"cubic-bezier(0,0.1,0.7,1)",opacity:0},function(){e.css("zIndex",""),t.destroy(),this.modal.destroy(),S.get().setAnimatedModule(null)}.bind(this))}},onContentReady:function Ct(){if(this.isRepin()){if(this.data&&this.data.id){var t=_.create("RelatedBoardForPinRandomFeedResource",{pin:this.data.id,page_size:1});t.callGet({showError:!1}).then(function(t){t.resource_response.error||(this._suggestedBoard=t.resource_response.data[0])}.bind(this))}this.addQuickPicksLoadingStaticItem(),x=Math.min(660,s(window).height()-2*O)}this.addCreateBoardStaticItems(),this.options.is_csr||this.adjustHeight(!1),this.focus()},addCreateBoardStaticItems:function Et(){var t=this.getBoardpicker();if(this.getBoardpicker()&&this.getBoardpicker().getAllBoards().length&&!this.$el.find(".PickerItemCreate").length){var e={type:"module",name:"PickerItemCreate",options:{display_text:N._("Create a Board"),view_type:"pinCreate createBoard allBoardsStaticItem"},data:{is_create_suggestion:!0,name:""}};t.appendModuleToList(e,-1)}},addQuickPicksLoadingStaticItem:function vt(){if(this.isRepin()){var t=this.getBoardpicker();if(t&&t.getBoardsShortList().length&&t.getAllBoards().length&&t.shouldRenderQuickPicks()){var e={type:"module",name:"BoardPickerSpinnerBlock"};t.appendModuleToList(e,0)}}},getBoardpicker:function It(){return this.getChildById("boardPicker")},getSocialShare:function Tt(){return this.getChildById("socialShare")},focus:function Nt(){this.getBoardpicker().focus()},triggerCommonPinCreateEvents:function St(t,e,i){t.triggerEvent(l.EVENT_PIN_CREATE,e,!1),P.instance.publish(l.PUBSUB_CHANNEL_CURRENT_USER,l.PUBSUB_TOPIC_PIN_CREATED,e),P.instance.publish(e.board.id,l.PUBSUB_TOPIC_PIN_CREATED,{pin:e,gridPrependCallback:i.gridPrependCallback}),P.instance.publish(R.id,l.PUBSUB_TOPIC_PIN_CREATED),i.isRepin&&P.instance.publish(i.originalPinId,l.PUBSUB_TOPIC_PIN_REPINNED,e)},_isPinDescriptionValid:function bt(){var t=this.getChildByModuleName("Pin");return t&&t.isDescriptionValid()},_getExtensionAccess:function yt(){var t="method"in this.options&&this.options.method;if(t&&"bookmarklet"===t){var e=_.create("ExtensionAccessResource");e.callGet().then(function(t){var e={detail:{access_token:t.resource_response.data.access_token}},i=new window.CustomEvent(U,e);document.dispatchEvent(i)})}}});M.prototype.className="PinCreate",t.exports=y.register(M)},function(t,e,i){"use strict";var n=i(1),s=i(219),o=i(19),a=i(11),r=i(40);i(116),i(225);var l=150,h=s.extend({CssClassName:n.extend(s.prototype.CssClassName,{HAS_MAX_HEIGHT:"hasMaxHeight"}),_clearInviteForm:function d(){var t=this.getChildById("boardInviteForm");t.clearTypeahead()},onChildInviteUser:function c(t){var e=this.getChildById("boardInvites"),i=t.data.userId,n=t.data.type,s=t.data.attributes;if(n===a.TYPEAHEAD_TYPE_FB_NON_PINNER)e.addInvitee({type:"facebook",identifier:i,attributes:s});else if("user"===n)e.addInvitee({type:"pinner",identifier:i});else{var o=t.data.userId;e.addInvitee({type:"email",identifier:o})}this._clearInviteForm()},setCollabsMaxHeight:function u(){this.updateDom()},updateDom:function p(){var t=this.$(".boardEditCollaborators"),e=t.position().top,i=this.$(".formFooter").outerHeight(),n=parseInt(this.$(".boardCollaboratorsWrapper").css("padding-bottom"),10),s=this.$(".collaboratorInvitesEnabledToggleWrapper").outerHeight()||0,o=i+e+s+n,a=this.getHeight()-o;t.addClass(this.CssClassName.HAS_MAX_HEIGHT).css("max-height",a)},animateOut:function _(t){var e=this.getWidth();this.$el.transition({x:e,duration:l},function(){t&&t(),this.destroy()}.bind(this))},animateIn:function g(t){var e=this.getWidth();this.$el.transition({x:e,opacity:1,duration:1}).transition({x:0,duration:l,easing:"ease-out"},function(){this.focusDescription(),t&&t()}.bind(this))},focusDescription:function m(){r.instance.is_mobile_agent||this.$(".boardEditDescription").focus()},onChildInviteEmail:function f(t){var e=this.getChildById("boardInvites"),i=t.data.email;e.addInvitee({type:"email",identifier:i}),this._clearInviteForm()}});h.prototype.className="BoardCreate",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(220),a=i(19),r=i(11),l=i(134),h=i(115),d=i(29),c=i(135),u=i(18),p=i(23),_=i(72),g=i(8),m=i(104);i(120),i(173),i(128),i(221),i(222);var f=o.extend({CssClassName:n.extend(o.prototype.CssClassName,{INLINE_ERROR:"inlineError"}),onCreated:function C(){o.prototype.onCreated.call(this),this.childListen(r.EVENT_BUTTON_CLICK,this.onButtonClick)},setupForm:function E(){this.$form=this.$("form");var t={},e=this.extraData;if(this._isOwner()){var i=e.errorMessages.boardName.required;t={boardName:[m.Required({message:i}),m.Length({max:r.MAX_CHARS_FOR_BOARD_TITLE})],description:[m.Length({max:r.MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION})]}}this.form=new h(this.$form,t),this.listen(this.form,r.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onContentReady:function v(){this.setupForm()},onButtonClick:function I(t){var e=t.target;if(e){var i=this._getGACategory();"submitButton"===e.id?d.trackEvent(i,r.GA_ACTION_CLICK_SUBMIT):"cancelButton"===e.id&&d.trackEvent(i,r.GA_ACTION_CLICK_CANCEL)}},onSubmitValidated:function T(t){t.errors[0]||this.saveBoard()},getBoardId:function N(){return this.data&&this.data.id},_getGACategory:function S(){return this.getBoardId()?"board_edit":"board_create"},isPrivacyChanged:function b(t){return this.data&&this.data.privacy!==t},getFieldValues:function y(){var t=this.$("form"),e={},i=t.find("[name=boardName]");i.length&&(e.name=i.val());var n=this.getChildById("boardEditCategory");n&&(e.category=n.getValue());var s=t.find("[name=description]");s.length&&(e.description=s.val());var o=this.getChildById("secretCheckbox");o&&(e.privacy=o.isChecked()?"secret":"public");var a=this.getChildById("emailCheckbox");a&&(e.collab_board_email=a.isChecked());var r=this.getChildById("collaboratorInvitesEnabledCheckbox");return r&&(e.collaborator_invites_enabled=r.isChecked()),this.extraData&&this.extraData.isProtected&&(e["protected"]=1),e},_isOwner:function P(){return this.extraData&&this.extraData.isOwner},saveBoard:function B(){var t=this.getChildById("submitButton");t.showLoading();var e=this.getFieldValues(),i=this.getBoardId(),s=n.clone(e);i&&(s.board_id=i);var o;if(this._isOwner()){o=g.create("BoardResource",s);var a={showError:!1},r=i?o.callUpdate(a):o.callCreate(a);r.then(this.onSaveSuccess.bind(this),this.onSaveError.bind(this)).fin(function(){t.hideLoading()})}else o=g.create("BoardSettingsResource",s),o.callUpdate().fin(function(){this.updateBoardPickerBoardsResource(),t.hideLoading(),this.destroy()}.bind(this))},updateBoardPickerBoardsResource:function A(){var t=g.create("BoardPickerBoardsResource",{filter:"all",field_set_key:"board_picker",allow_stale:!0});_.instance.callGet(t)},onSaveError:function R(t){d.trackEvent(this._getGACategory(),r.GA_ACTION_ERROR);var e=this.$(".formFooter"),i=this.$(".inlineError");
i.length?i.empty():i=s("<p></p>").addClass(this.CssClassName.INLINE_ERROR),i.text(t.message),i.insertBefore(e)},_isNewBoard:function w(){var t=this.getBoardId();return!t},onSaveSuccess:function O(t){var e=this.getChildById("boardInvites"),i,n,s;e&&(i=e.getSelectedInvitees("pinner"),n=e.getSelectedInvitees("email"),s=e.getSelectedInvitees("facebook"));var o=this.getBoardId(),a=this._isNewBoard();d.trackEvent(this._getGACategory(),r.GA_ACTION_SUCCESS),this.updateBoardPickerBoardsResource();var l=t.resource_response.data;if(o){if(p.instance.publish(o,r.PUBSUB_TOPIC_BOARD_UPDATED,l),this.isPrivacyChanged(l.privacy)&&(p.instance.publish(r.PUBSUB_CHANNEL_CURRENT_USER,r.PUBSUB_TOPIC_BOARD_UPDATED,r.PUBSUB_MESSAGE_BOARD_PRIVACY_CHANGED),"secret"===l.privacy)){var h={name:"ConfirmDialog",options:{template:"make_board_private"}};u.load(h).then(function(t){c.get().createAndShowModal(t)})}}else p.instance.publish(r.PUBSUB_CHANNEL_CURRENT_USER,r.PUBSUB_TOPIC_BOARD_CREATED,l),this.triggerEvent(r.EVENT_BOARD_CREATED,l,!0);a&&(i&&this.inviteUsers(l.id,i),n&&this.inviteEmail(l.id,n),s&&s.length>0&&this.inviteFacebook(l.id,s));var _="navigate_on_success"in this.options?this.options.navigate_on_success:a||!this.isInModal();_?this.navigate(l.url,null,a?r.GEN.ForceRefreshType.PAGE:null):this.options.custom_board_create_success_destroy||this.destroy()},displayFacebookDialog:function D(t,e,i){l.open({type:"send",path:e,to:t,callback:i})},inviteUsers:function x(t,e){var i={board_id:t,invited_user_ids:e};if(e&&e.length>0){var n=g.create("BoardInviteResource",i);n.callCreate()}},inviteEmail:function L(t,e){var i={board_id:t,emails:e};if(e&&e.length>0){var n=g.create("BoardEmailInviteResource",i);n.callCreate()}},inviteFacebook:function k(t,e){var i=g.create("BoardFacebookInviteResource",{board_id:t});i.callGet().then(function(i){var n=i.resource_response.data;this._inviteFacebookRecursive(t,e,n.invite_code,n.url)}.bind(this))},_inviteFacebookRecursive:function U(t,e,i,n){if(e.length>0){var s=e.pop();this.displayFacebookDialog(s,n,function(s){if(this._inviteFacebookRecursive(t,e,i,n),s&&s.success){var o=g.create("BoardFacebookInviteResource",{board_id:t,invite_code:i});o.callUpdate()}}.bind(this))}}});f.prototype.className="BoardEditBase",t.exports=a.register(f)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(134),r=i(50),l=i(35),h=i(14),d=i(8),c=i(17),u=r.extend({onCreated:function p(){this.childListen(s.EVENT_INVITE_USER,this.onChildInviteUser),this.childListen(s.EVENT_INVITE_EMAIL,this.onChildInviteEmail)},onInviteAdded:function _(t,e){},onChildInviteUser:function g(t){var e,i=this.getChildById("boardInviteForm");i.showLoading();var n=t.data.userId,o=t.data.type,r=this.getBoardId();"user"===o?(e=d.create("BoardInviteResource",{board_id:r,invited_user_id:n}),e.callCreate().then(function(e){this.onInviteAdded(t.data.pending,{invitee:n,type:"pinner"}),i.clearTypeahead()}.bind(this)).fin(function(t){i.hideLoading()})):o===s.TYPEAHEAD_TYPE_FB_NON_PINNER?(e=d.create("BoardFacebookInviteResource",{board_id:r}),e.callGet({showError:!1}).then(function(t){var s=t.resource_response.data;i.hideLoading(),a.open({type:"send",path:s.url,to:n,callback:function(t){t&&t.success&&(e=d.create("BoardFacebookInviteResource",{board_id:this.getBoardId(),invite_code:s.invite_code}),e.callUpdate())}.bind(this)})}.bind(this),function(t){i.hideLoading(),l.showError(t.message)})):this._inviteEmail(n,t.data.pending)},_inviteEmail:function m(t,e){var i=this.getChildById("boardInviteForm"),s={board_id:this.getBoardId(),emails:[t]},o=d.create("BoardEmailInviteResource",s);o.callCreate().then(function(){this.onInviteAdded(e,{invitee:t,type:"email"}),i.clearTypeahead();var s=c.format(h.commonStrings.successInviteSentToEmail,{email:t}),o=n("<div class='alert'>"+s+"</div>").hide();this.insertAfterModule(o,i),o.fadeIn(function(){o.delay(5e3).fadeOut(function(){o.remove()})})}.bind(this)).fin(function(){i.hideLoading()})},getBoardId:function f(){return this.resource.options.board_id},onChildInviteEmail:function C(t){var e=this.getChildById("boardInviteForm");e.showLoading();var i=t.data.email,n=t.data.pending;this._inviteEmail(i,n)}});u.prototype.className="BoardCollaboratorInvitesBase",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(117);var o=n.extend({getValue:function a(){return this.$("option:selected").val().trim()}});o.prototype.className="CategoriesSelect",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(165),o=i(19),a=i(11),r=i(50),l=i(14),h=i(18);i(223);var d=r.extend({onContentReady:function c(){if(!this.options.pending){var t=this.resource.options.board_id,e={};e[a.PUBSUB_TOPIC_BOARD_APPROVED_COLLABORATOR_INVITE]=this.onApprovedCollaboratorInvite,this.pubsubSubscribe(t,e)}this.childListen(a.EVENT_BOARD_CREATE_USER_REMOVED,this.onInviteeRemoved),this.boardCreateInvitees=[]},onApprovedCollaboratorInvite:function u(t,e,i){this.addInvitee({type:"pinner",userId:i.userId})},onInviteeRemoved:function p(t){var e=t.data.type,i=t.data.identifier;this.boardCreateInvitees=n.filter(this.boardCreateInvitees,function(t){return e!==t.type||i!==t.identifier})},getSelectedInvitees:function _(t){var e=n.filter(this.boardCreateInvitees,function(e){return t===e.type});return n.pluck(e,"identifier")},hasSelectedInvitee:function g(t){var e=!1;return n.each(this.boardCreateInvitees,function(i){i.type===t.type&&i.identifier===t.identifier&&(e=!0)}),e},_createPinnerBoardEditInvite:function m(t){var e=t.identifier,i={resource:{name:"BoardInviteResource",options:{board_id:this.resource.options.board_id,invited_user_id:e,invite_type:t.type,field_set_key:"boardEdit"}},options:{link:this.options.link_to_users_profiles}};return new s(i)},_createEmailBoardInvite:function f(t){var e=t.identifier;return new s({options:{view_type:this.options.view_type,invite_type:t.type,identifier:e}})},_createPinnerBoardCreateInvite:function C(t){var e=t.identifier,i={resource:{name:"UserResource",options:{user_id:e,field_set_key:"board_invite"}},options:{view_type:"boardCreate",invite_type:t.type,link:this.options.link_to_users_profiles,identifier:e}};return new s(i)},_createFacebookBoardInvite:function E(t){var e=t.attributes,i=t.identifier,n=e.name,o=e.send_pin_image;return new s({options:{invite_type:t.type,identifier:i,name:n,image:o,view_type:this.options.view_type}})},addInvitee:function v(t){var e=this.options.view_type,i=this.getChildById("boardInvitesPagedGrid"),n=t.type,s;if(this.hasSelectedInvitee(t)){var o={name:"ConfirmDialog",options:{message:l._("That user has already been invited to add Pins on this board!")}};h.load(o).then(function(t){this.showInModal(t)}.bind(this))}else"boardCreate"===e?(s="email"===n?this._createEmailBoardInvite(t):"facebook"===n?this._createFacebookBoardInvite(t):this._createPinnerBoardCreateInvite(t),this.boardCreateInvitees.push({type:n,identifier:t.identifier})):"pinner"===n?s=this._createPinnerBoardEditInvite(t):"email"===n&&(s=this._createEmailBoardInvite(t));s&&s.render().then(function(){i.prependChildItem(s)})}});d.prototype.className="BoardInvites",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(224);i(151);var r=9,l=a.extend({CssClassName:n.extend(a.prototype.CssClassName,{HIDE:"hide"}),onAddedToDom:function h(){this.contentReady&&this._setUpGrid()},onContentReady:function d(){a.prototype.onContentReady.call(this),this.inDom&&this._setUpGrid()},_getGrid:function c(){return this.getChildById("grid")},prependChildItem:function u(t){var e=this._getGrid();e.prependChildItem(t)},_setUpGrid:function p(){var t=this._getGrid(),e=this.options.ajax_page_size||r;t.setPageSize(e),t.hasMoreItems()||this.getMoreItemsButton().getContent().addClass(this.CssClassName.HIDE),this.childListen(s.EVENT_CONTENT_CHANGED,this.onChildContentChanged),this.childListen(s.EVENT_ERROR,this.onChildError)},hasItems:function _(){var t=this._getGrid();return t.hasItems()},requestMore:function g(){if(this.contentReady){this.showMoreItemsLoading();var t=this._getGrid();t.requestMoreItems()}},onChildContentChanged:function m(){this.hideMoreItemsLoading();var t=this.getMoreItemsButton();if(t){if(this.gridHasError)return t.hide(),void(this.gridHasError=!1);var e=this._getGrid();e.hasMoreItems()?t.show():t.destroy()}},onChildError:function f(t){this.log.debug("Child error!",t),t.target===this._getGrid()&&(this.gridHasError=!0)}});l.prototype.className="PagedGrid",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(79);i(116);var r=o.extend({CssClassName:{LOADING:"loading"},onContentReady:function l(){this.options.state_loading=this.options.loading||!1,this._moreItemsButtonClickListener&&this.removeListener(this._moreItemsButtonClickListener),this._moreItemsButtonClickListener=this.listen(this.getMoreItemsButton(),n.EVENT_BUTTON_CLICK,this._onMoreItemsButtonClick)},_onMoreItemsButtonClick:function h(t){t.stopPropagation(),this.requestMore()},getMoreItemsContainer:function d(){return this.$el.children(".moreItemsContainer")},getMoreItemsButton:function c(){return this.getChildById("moreItems")},_hasBorderedButton:function u(){var t=this.getMoreItemsButton();return t&&!t.options.borderless},showMoreItemsLoading:function p(){if(this._hasBorderedButton())this.getMoreItemsButton().showLoading();else if(!this._moreItemsSpinner){var t=this.getMoreItemsContainer();this.updateOptionsAndDom({state_loading:!0}),this._moreItemsSpinner=new a({size:a.Size.SMALL}),this._moreItemsSpinner.spin(t)}},updateDom:function _(){var t=this.getMoreItemsContainer();t.toggleClass(this.CssClassName.LOADING,this.options.state_loading)},hideMoreItemsLoading:function g(){this._hasBorderedButton()?this.getMoreItemsButton().hideLoading():this._moreItemsSpinner&&(this.updateOptionsAndDom({state_loading:!1}),this._moreItemsSpinner.stop(),this._moreItemsSpinner=null)},requestMore:function m(){}});r.prototype.className="PagedCollection",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(29),r=i(104);i(116),i(226),i(231);var l=o.extend({onCreated:function h(){this.childListen(n.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen(n.EVENT_ENTER_PRESSED,this.onChildEnterPressed),this.childListen(n.EVENT_BUTTON_CLICK,this.onClickInviteButton),this.childListen(n.EVENT_CONTENT_CHANGED,this.onChildContentChanged),this.childListen(n.EVENT_CONTACT_SELECTED,this.onRecentContactSelected)},onChildItemSelected:function d(t){a.trackEvent("collaborator_invite_user",n.GA_ACTION_SELECT_SUBMIT);var e=t.data.item,i=e.attributes;this._inviteUser(i),t.stopPropagation()},onRecentContactSelected:function c(t){var e=t.data.type;"emailcontact"===e?(a.trackEvent("collaborator_invite_email",n.GA_ACTION_SELECT_SUBMIT),this._inviteEmail(t.data.email_address)):"user"===e&&(a.trackEvent("collaborator_invite_user",n.GA_ACTION_SELECT_SUBMIT),this._inviteUser({type:t.data.type,id:t.data.id,username:t.data.username})),t.stopPropagation()},onChildEnterPressed:function u(t){a.trackEvent("collaborator_invite_email",n.GA_ACTION_ENTER_SUBMIT),this.submit(),t.stopPropagation()},onClickInviteButton:function p(t){a.trackEvent("collaborator_invite_email",n.GA_ACTION_CLICK_SUBMIT),this.submit(),t.stopPropagation()},onChildContentChanged:function _(t){t.stopPropagation()},submit:function g(){var t=this.getChildById("typeaheadField"),e=t.getValue(),i=t.getField();if(this.options.email_supported){var n=new r.Validator(i,[r.Length({min:1}),r.Email()]);n.validate(function(t){t.errors.length>0?this.log.debug(t.errors):this._inviteEmail(e)}.bind(this))}return!1},setTypeaheadFieldValue:function m(t){var e=this.getChildById("typeaheadField");e.setValue(t)},clearTypeahead:function f(){var t=this.getChildById("typeaheadField");t.clear()},_inviteEmail:function C(t){this.triggerEvent(n.EVENT_INVITE_EMAIL,{email:t,pending:this.options.pending},!0)},_inviteUser:function E(t){var e=t.type,i=t.email?t.email:t.id;this.triggerEvent(n.EVENT_INVITE_USER,{userId:i,type:e,pending:this.options.pending,attributes:t},!0)}});l.prototype.className="BoardInviteForm",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(133),r=i(227),l=i(228),h=i(23),d=i(17),c=i(46),u=l.extend({onCreated:function p(){l.prototype.onCreated.apply(this),this.showSocialConnectCta=this.options.show_social_connect_cta,this.allowedSocialNetworks=this.options.allowed_social_networks||this.DEFAULT_ALLOWED_SOCIAL_NETWORKS,this._updateNetworks()},DEFAULT_ALLOWED_SOCIAL_NETWORKS:[a.FACEBOOK,a.TWITTER,a.GPLUS,a.YAHOO],onContentReady:function _(){l.prototype.onContentReady.apply(this),this.childListen(s.EVENT_TYPEAHEAD_HINT,this.updateTypeaheadStaticItems),this.childListen(s.EVENT_ITEM_SELECTED,this.onItemSelected),h.instance.subscribe(s.PUBSUB_CHANNEL_CURRENT_USER,s.PUBSUB_TOPIC_SOCIAL_NETWORK_UPDATED,function(){this._updateNetworks(),this.updateTypeaheadStaticItems(),this.render()}.bind(this))},onItemSelected:function g(t){var e=t.data.item,i=e.attributes;i.network?(this.connectToNetwork(i.network),this.options.bubble_network_item_click||t.stopPropagation()):"connectCta"===i.template&&(this.triggerEvent(s.EVENT_SHOW_SOCIAL_CONNECT_PANEL,t,!0),t.stopPropagation())},_updateSocialConnectItems:function m(){this._socialConnectItems=n.map(this._networksToConnect,function(t){return{template:"socialConnect",selectable:!0,network:t}})},_updateNetworks:function f(){var t=c;this._networksToConnect=[];for(var e=0;e<this.allowedSocialNetworks.length;e++){var i=this.allowedSocialNetworks[e];t.get("connected_to_"+i)||t.get(i+"_url")||this._networksToConnect.push(i)}this._updateSocialConnectItems()},updateTypeaheadStaticItems:function C(){var t=[];if(this.options.allow_email){var e=this.getValue();if(e){var i=d.isEmailAddress(e),s=this.options.email_options||{};s.template||(s.template="emailSelect"),t=[n.extend(s,{selectable:i,email:e,id:e,is_valid:i,type:"email_share_suggestion"})]}}var o;if(this.showSocialConnectCta){var a={template:"connectCta",selectable:!0};o=t.concat(a)}else o=t.concat(this._socialConnectItems);this.setAppendedStaticItems(o)},_markNetworkAsConnected:function E(t){this._networksToConnect=n.without(this._networksToConnect,t),this._updateSocialConnectItems(),this.updateTypeaheadStaticItems(),this.render()},connectToNetwork:function v(t){var e={success:function(){this._markNetworkAsConnected(t)}.bind(this)};r.instance().handleConnect(t,!0,e)}});u.prototype.className="SocialTypeaheadField",t.exports=o.register(u)},function(t,e,i){"use strict";function n(){}var s=i(1),o=i(11),a=i(133),r=i(23),l=i(8),h=i(34),d=i(46),c=i(9),u=1e3,p=110;s.extend(n.prototype,{handleConnect:function g(t,e,i){if(e&&!d.isLimitedLogin()){var n={success:function(n){var s={network:t,data:n};this._internalConnectNetwork(e,s,i)}.bind(this),error:function o(t){i.error&&i.error(t)},complete:function a(){i.complete&&i.complete()}};this._externalConnectNetwork(t,e,n)}else{var s={network:t};this._internalConnectNetwork(e,s,i)}},updateConnectStatus:function m(){var t=l.create("UserResource",{user_id:d.get("id"),username:d.get("username"),field_set_key:"social_connect"});t.callGet().then(function(t){var e=t.resource_response.data;d.set(e),r.instance.publish(o.PUBSUB_CHANNEL_CURRENT_USER,o.PUBSUB_TOPIC_SOCIAL_NETWORK_UPDATED)})},_externalConnectNetwork:function f(t,e,i){return e?void a.instance().connect(t,i):void(i.success&&i.success({}))},_internalConnectNetwork:function C(t,e,i){var n=l.create("UserSocialNetworkResource",e);(t?n.callCreate():n.callDelete()).then(function(t){this.updateConnectStatus(),i.success&&i.success(t)}.bind(this),function(t){i.error&&t instanceof Object&&i.error(t)}).fin(function(){i.complete&&i.complete()})},_getResourceNameForNetworkFriends:function E(t){var e=null;switch(t){case a.FACEBOOK:e="UserFacebookFriendsResource";break;case a.TWITTER:e="UserTwitterFriendsResource";break;case a.GOOGLE:e="UserGmailFriendsResource";break;case a.YAHOO:e="UserYahooFriendsResource";break;case a.MICROSOFT:e="UserMicrosoftFriendsResource";break;default:return}return e},_handleFriendsImported:function v(t,e,i){var n={resource:e,network:t,error:i};r.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_FRIEND_IMPORT_COMPLETED,n)},pollForFriends:function I(t,e){e=e||{};var i=e.resourceOptions||{},n=this._getResourceNameForNetworkFriends(t);if(n){var s=l.create(n,i);s.callGet({showError:!1}).then(function(){var i=e.success;i&&i(s),this._handleFriendsImported(t,s,null)}.bind(this),function(i){if(i.api_error_code===p)h.setTimeout(function(){this.pollForFriends(t,e)}.bind(this),u);else{var n=e.error;n&&n(),this._handleFriendsImported(t,s,i)}}.bind(this))}}});var _=null;n.instance=function(){return _||(_=new n),_},t.exports=c.expose("SocialNetworkSettingsManager",n)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(138),r=i(50),l=i(40);i(178),i(174),i(229),i(230);var h=r.extend({events:{"input .field":"onFieldInput","blur .field":"onFieldBlur","focus .field":"onFieldFocus","keyup .field":"onFieldKeyup","keydown .field":"onFieldKeydown","textchange .field":"onFieldTextChange"},CssClassName:{DISABLED:"disabled",VISIBLE:"visible"},onCreated:function d(){this.valueFromHighlight=!1,this.showNewTypeahead=!!this.options.support_advanced_typeahead,this.showGuidedSearch=!!this.options.support_guided_search},getTypeahead:function c(){return this.showNewTypeahead?this.getChildById("typeaheadDropdown").getContentModule():this.getChildById("typeahead")},onFieldTextChange:function u(t){this.isFocussed()&&this.search()},initTypeahead:function p(){this.showNewTypeahead?(this.initTypeaheadDropdown(),this.childListen(s.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen(s.EVENT_ITEM_HIGHLIGHTED,this.onChildItemHighlighted),this.childListen(s.EVENT_TYPEAHEAD_HIDDEN,this.onTypeaheadHidden),this.childListen(s.EVENT_TYPEAHEAD_SHOWN,this.onTypeaheadShown),this.childListen(s.EVENT_TYPEAHEAD_MOUSEDOWN,this.onTypeaheadMousedown)):(this.childListen(s.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen(s.EVENT_ITEM_HIGHLIGHTED,this.onChildItemHighlighted),this.childListen(s.EVENT_TYPEAHEAD_MOUSEDOWN,this.onTypeaheadMousedown),this.options.show_caret&&(this.childListen(s.EVENT_TYPEAHEAD_RESULTS_RETURNED,this.onTypeaheadResultsReturned),this.childListen(s.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,this.onTypeaheadNoResultsReturned),this.childListen(s.EVENT_TYPEAHEAD_HIDDEN,this.onTypeaheadHidden),this.childListen(s.EVENT_TYPEAHEAD_SHOWN,this.onTypeaheadShown)))},initTypeaheadDropdown:function _(){this.typeaheadDropdown=new a({id:"typeaheadDropdown",options:{class_name:"typeaheadDropdown",fixed:!0,hide_caret:!0,position_mode:s.PositionMode.MANUAL,prefetch:!0,mouse_close_mode:"never",submodule:{name:"Typeahead",options:{bypass_lru_cache:this.options.bypass_lru_cache,bypass_maxheight:!0,class_name:"centeredWithinWrapper",enable_recent_queries:this.options.enable_recent_queries,exclude_non_followers:this.options.exclude_non_followers,minimum_term_character_length:this.options.minimum_term_character_length,num_places:this.options.num_places,resource_name:this.options.resource_name,should_geocode:this.options.should_geocode,tags:this.options.tags,template:this.options.template,use_tab_index:this.options.use_tab_index,view_type:"expanded"}}}}),this.addChild(this.typeaheadDropdown)},hideTypeaheadUnlessPreserved:function g(){this.options.preserve_typeahead||this.getTypeahead().hide()},enableInput:function m(){this._setInputEnabled(!0)},_setInputEnabled:function f(t){var e="disabled";this.$field.toggleClass(this.CssClassName.DISABLED,!t),t?this.$field.removeAttr(e):this.$field.attr(e,e)},disableInput:function C(){this._setInputEnabled(!1)},onChildItemSelected:function E(t){var e=t.data.item,i=e&&!e.get("ignoreLabel")?e.get("label"):this.getValue(),n=this.options.set_input_value_on_selection;void 0===n&&(n=!0),i&&n&&(this.valueFromHighlight=!1,this.setValue(i)),this.blur()},onChildItemHighlighted:function v(t){var e=t.data.item,i=e&&!e.get("ignoreLabel")?e.get("highlightLabel")||e.get("label"):this.getTypeahead().getLastTerm();this.options.populate_on_result_highlight&&(this.valueFromHighlight=!!e,this.setValue(i))},onTypeaheadResultsReturned:function I(t){this.showCaret()},onTypeaheadHidden:function T(t){this.hideCaret(),this.typeaheadDropdown&&this.typeaheadDropdown.hide()},onTypeaheadShown:function N(t){this.showCaret(),this.typeaheadDropdown&&!this.typeaheadDropdown.isShowing()&&this.typeaheadDropdown.show()},onTypeaheadNoResultsReturned:function S(t){this.hideCaret()},showCaret:function b(){this._setCaretVisible(!0)},hideCaret:function y(){this._setCaretVisible(!1)},_setCaretVisible:function P(t){this.$(".typeaheadCaret").toggleClass(this.CssClassName.VISIBLE,t)},highlightTypehaeadUp:function B(){this.getTypeahead().highlightUp()},highlightTypeaheadDown:function A(){this.getTypeahead().highlightDown()},onContentReady:function R(){this.initTypeahead(),this.$field=this.$(".field"),this.$field.placeholder()},onFieldInput:function w(){this.isFocussed()&&this.search()},_focusHighlightedIfNeeded:function O(){this.options.use_tab_index&&(this.getTypeahead().focusHighlighted(),this.focus())},onFieldKeydown:function D(t){var e=this.getTypeahead(),i=s.KeyCode;if(e.isOpen())switch(t.keyCode){case i.UP:e.highlightUp(),this._focusHighlightedIfNeeded(),t.preventDefault();break;case i.DOWN:e.highlightDown(),this._focusHighlightedIfNeeded(),t.preventDefault();break;case i.ENTER:this.options.is_multiobject_search&&e.highlightedItem&&e.highlightedItem.get("selectable")!==!1&&this.triggerEvent(s.EVENT_ITEM_SELECTED,{item:e.highlightedItem},!0),this.valueFromHighlight&&(this.cancelBlur=!0,window.setTimeout(function(){this.cancelBlur=!1}.bind(this),500)),(this.options.prevent_default_on_enter||this.options.close_typeahead_on_selection)&&t.preventDefault();break;case i.BACKSPACE:this.valueFromHighlight=!1}},focus:function x(){this.getField().focusWithoutScrolling()},onFieldKeyup:function L(t){var e=this.getTypeahead(),i=s.KeyCode;if(e.isOpen())switch(t.keyCode){case i.ENTER:case i.NUMPAD_ENTER:case i.TAB:var n={};if(e.highlightedItem){var o="pins",a=e.highlightedItem.get("type");"pin_search"===a&&(a="query"),"board_search"===a&&(o="boards",a="query"),"people_search"===a&&(o="users",a="query"),n={entered_query:e.getLastTerm(),selected_query:e.highlightedItem.get("label"),result_index:e.highlightedItem.get("resultIndex"),autocomplete_type:a,search_mode:o}}var r=e.select();this._logCustomContextEvent(s.GEN.EventType.CLICK,s.GEN.ElementType.AUTOCOMPLETE_SUGGESTION,s.GEN.ComponentType.TYPEAHEAD_SUGGESTIONS,n),r&&(this.abortSearch(),t.preventDefault()),this.options.close_on_selection&&this.closeTypeahead();break;case i.ESCAPE:this.blur(),t.preventDefault();break;default:this.valueFromHighlight=!1}else switch(t.keyCode){case i.ENTER:case i.NUMPAD_ENTER:this.abortSearch(),this.triggerEvent(s.EVENT_ENTER_PRESSED,{},!0)}},getTypeaheadItemsToRender:function k(){return this.getTypeahead().itemsToRender},getTypeaheadHighlightedItem:function U(){return this.valueFromHighlight?this.getTypeahead().getHighlightedItem():null},getTypeaheadSelectedItem:function M(){return this.getTypeahead().getSelectedItem()},removeCacheForTerm:function F(t){this.getTypeahead().removeCacheForTerm(t)},removeCacheForCurrentTerm:function $(){var t=this.getValue();this.removeCacheForTerm(t)},closeTypeahead:function H(){this.abortSearch(),this.getTypeahead().hide()},toggleClass:function V(t,e){this.$el.toggleClass(t,e)},onFieldBlur:function G(){return this.cancelBlur?(this.cancelBlur=!1,this.cancelFocus=!0,void this.$(".field").focus()):(this.valueFromHighlight?(this.valueFromHighlight=!1,this.reset()):this.showGuidedSearch&&(this.abortSearch(),this.setValue("")),this.hideTypeaheadUnlessPreserved(),void this.triggerEvent(s.EVENT_BLUR,null,!0))},onFieldFocus:function W(){return this.cancelFocus?void(this.cancelFocus=!1):(this.$field.trigger("mousedown"),this.options.search_on_focus&&this.search(),this.options.prefetch_on_focus&&this.getTypeahead().prefetch(),void this.triggerEvent(s.EVENT_FOCUS,null,!0))},onTypeaheadMousedown:function K(t){this.cancelBlur=!0,window.setTimeout(function(){this.cancelBlur=!1}.bind(this),300)},replacePlaceholderText:function j(t){n(this.$field.placeholder().attr("placeholder",t))},getValue:function Y(){if("tokenized"===this.options.type){var t=this.getChildById("tokenizedInput");return this.showGuidedSearch?t.getTokenInputValue():t.getInputValue()}return this.$field.val()},getField:function q(){return this.$field},reset:function z(){this.abortSearch(),this.setValue(""),this.getTypeahead().emptyResults(),this.getTypeahead().hide()},setValue:function X(t){if("tokenized"===this.options.type){var e=this.getChildById("tokenizedInput");e.setInputValue(t)}else this.$field.val(t);this.triggerEvent(s.EVENT_CONTENT_CHANGED,{value:t},!0)},getTypeaheadResultCount:function Q(){return this.getTypeahead().getItemCount()},setAutocompleteScope:function Z(t){this.getTypeahead().setAutocompleteScope(t)},clear:function J(){if("tokenized"===this.options.type){var t=this.getChildById("tokenizedInput");t.clearTokens(),t.clearSavedTokens()}this.setValue("")},abortSearch:function tt(){this.searchTimer&&window.clearTimeout(this.searchTimer),this.getTypeahead().abortSearch()},setResourceOptionForTypeahead:function et(t,e){var i=this.getTypeahead().getResource();i.set(t,e)},setPrependedStaticItems:function it(t){this.getTypeahead().setPrependedStaticItems(t)},setAppendedStaticItems:function nt(t){this.getTypeahead().setAppendedStaticItems(t)},resetPrependedStaticItems:function st(){this.getTypeahead().resetPrependedStaticItems()},resetAppendedStaticItems:function ot(){this.getTypeahead().resetAppendedStaticItems()},search:function at(t){var e=t;e||(e=this.getValue()),e&&""!==e||!this.options.is_multiobject_search||l.instance.user_agent_platform!==s.USER_AGENT_PLATFORM_IPAD||window.scrollTo(0,0),this.searchTimer&&window.clearTimeout(this.searchTimer);var i=function(){this.getTypeahead().search(e)}.bind(this),n=this.options.search_delay;n?this.searchTimer=window.setTimeout(i,n):i()},updateContactSelection:function rt(t){this.getTypeahead().updateContactSelection(t)},blur:function lt(){this.$field.blur()},isFocussed:function ht(){return this.$field.is(":focus")}});h.prototype.className="TypeaheadField",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(3),a=i(11),r=i(50),l=i(30),h=i(8),d=i(175),c=i(126),u=i(40),p=i(14),_=i(19),g=i(66),m=i(58);i(116);var f="cid",C="highlighted",E="selected",v={search:"default_item",searchV2:"default_item_2",userSelect:"send_pin",title:"title",map:"add_pin_to_map",place:"place",hint_no_city:"hint_no_city",hint_specific_city:"hint_specific_city",user_circle_avatar:"user_circle_avatar",interest:"interest",emailSelect:"send_to_email",socialConnect:"social_connect",sendShareUserCircleAvatar:"send_share_user_circle_avatar",connectCta:"connect_cta"},I=o.View.extend({CssClassName:{HIGHLIGHTED:"highlighted",SELECTED:"selected"},tagName:"li",initialize:function N(t){this.options=t,this.$el.attr("tabindex",this.options.tabIndex?1:!1);var e=this.options.template;this.templateName=e,this.model.bind("change",this.onChange,this)},appendToElement:function S(t){this.render(),t.append(this.$el)},onChange:function b(){return this.render(),this.model.attributes.type===a.TYPEAHEAD_TYPE_GPLUS_NON_PINNER&&this.options.container.triggerEvent(a.EVENT_TYPEAHEAD_RENDER_DONE,this.model.attributes.id,!0),this},_getTemplateFilePath:function y(){return"app/common/modules/components/Typeahead/"+this.templateName+".nunjucks"},render:function P(){var t=this._getTemplateFilePath(),e=g.render(u.instance.locale,t,this.model.toJSON());return this.$el.html(e).toggleClass(this.CssClassName.SELECTED,!!this.model.get(E)).toggleClass(this.CssClassName.HIGHLIGHTED,!!this.model.get(C)).data(f,this.model.cid),this}}),T=r.extend({events:{"click .results li":"onResultClick","click .results .remove":"onRemoveResult",mousedown:"onMousedown","mouseenter .results li":"onResultMouseEnter",mouseleave:"onMouseleave",onchange:"onChange"},CssClassName:{BUTTON_TEXT:"buttonText",HIGHLIGHTED:"highlighted",OPEN:"open",SHOW_RECENT_QUERIES:"showRecentQueries"},_isOpen:!1,items:[],appendedStaticItems:[],prependedStaticItems:[],onCreated:function B(){this.typeahead=new d(this.options),this.listen(this.typeahead,a.EVENT_DATA,this.onTypeaheadData),this.listen(this.typeahead,a.EVENT_TYPEAHEAD_SEARCH_START,this.onSearchStart),this.listen(c,a.EVENT_RESIZE,this.onResize),this.VALID_SECTIONS={board:{title:p._("BOARDS"),getUrl:function t(e){return"/search/boards/?q="+e},getQuery:function e(t){return t}},user:{title:p._("PINNERS"),getUrl:function i(t){return"/search/people/?q="+t},getQuery:function n(t){return t}},recent_query:{title:p._("RECENT SEARCHES"),getUrl:function s(t){return null},getQuery:function o(t){return" "}},trending:{title:p._("TRENDING ON PINTEREST"),getUrl:function r(t){return null},getQuery:function l(t){return" "}}},this.selectedContactsSet=new m},onChildButtonClick:function A(t){var e=t.target;e&&e.isCancelButton()&&(t.stopPropagation(),this.hide())},onSearchStart:function R(t){this.triggerEvent(a.EVENT_TYPEAHEAD_SEARCH_START,t,!0)},removeCacheForTerm:function w(t){this.typeahead.removeCacheForTerm(t)},getResource:function O(){return this.typeahead.getResource()},setPrependedStaticItems:function D(t,e){this.prependedStaticItems=t,this._updateItemsToRender(),e&&this.renderResults()},resetPrependStaticItems:function x(t){this.setPrependedStaticItems([],t)},setAppendedStaticItems:function L(t,e){this.appendedStaticItems=t,this._updateItemsToRender(),e&&this.renderResults()},resetAppendedStaticItems:function k(t){this.setAppendedStaticItems([],t)},onContentReady:function U(){this.$results=this.$(".results")},getItemCount:function M(){return this.itemsToRender.count},highlightItemWithAttributeAndValue:function F(t,e){var i=this.itemsToRender,s=n.find(i,function(i){return i.get(t)===e});s&&this.highlight(s)},focusHighlighted:function $(){this.$("."+this.CssClassName.HIGHLIGHTED).focus()},getHighlightedItem:function H(){return this.highlightedItem},search:function V(t){this.lastTerm=t,this.typeahead.search(t)},setAutocompleteScope:function G(t){this.typeahead.setAutocompleteScope(t)},renderResults:function W(){var t=[];if(t=n.map(this.itemsToRender,function(t){return this.createItemView(t)}.bind(this)),!t.length)return void this.hideNoResults();if(this.$results.empty(),n.each(t,function(t){t.appendToElement(this.$results)}.bind(this)),!this.options.bypass_maxheight){var e=this.getScrollableElement().scrollTop(),i=c.height-l.siteConst.PIN_MARGIN-this.$results.offset().top+e;this.$results.css({"max-height":i,"overflow-y":"auto"})}this.show()},updateContactSelection:function K(t){this.selectedContactsSet=new m(t.map(function(t){return t.id}))},emptyResults:function j(){this.itemsToRender=[],this.$results.empty()},createItemView:function Y(t){var e=this.options.is_multiobject_search?v.searchV2:v.search,i=this.options.template?v[this.options.template]:e,n=this.options.use_tab_index;t.attributes&&t.attributes.template&&(i=v[t.attributes.template]);var s=new I({model:t,container:this,template:i,tabIndex:n});return s},beforeHide:function q(){this._isOpen=!1,this.highlightedItem=null,this.select(null),this.$el.removeClass(this.CssClassName.OPEN)},hide:function z(){this.beforeHide(),this.triggerEvent(a.EVENT_TYPEAHEAD_HIDDEN,{enable_overlay:this.options.enable_overlay},!0)},hideNoResults:function X(){this.beforeHide(),this.triggerEvent(a.EVENT_TYPEAHEAD_HIDDEN,{noResults:!0},!0)},show:function Q(){this._isOpen=!0,this.$el.addClass(this.CssClassName.OPEN),this.triggerEvent(a.EVENT_TYPEAHEAD_SHOWN,{enable_overlay:this.options.enable_overlay},!0)},isOpen:function Z(){return this._isOpen},getLastTerm:function J(){return this.lastTerm},selectElement:function tt(t){var e=this.getItemByElement(t);return this.select(e)},getSelectedItem:function et(){return this.selectedItem},select:function it(t){return t=t||this.highlightedItem,t&&t.get("selectable")===!1?null:(t&&(t.set(E,!t.get(E)),
this.triggerEvent(a.EVENT_ITEM_SELECTED,{item:t},!0)),this.selectedItem=t,t)},highlightUp:function nt(){var t=this.highlightedItem,e=this.itemsToRender,i=t?n.indexOf(e,t)-1:e.length-1,s=e[i];return s&&s.get("selectable")===!1&&(--i,0>i&&(i=e.length-1)),this.highlight(e[i])},highlightDown:function st(){var t=this.highlightedItem,e=this.itemsToRender,i;if(t){var s=n.indexOf(e,t);i=s===e.length-1?0:s+1}else i=0;var o=e[i];return o&&o.get("selectable")===!1&&++i,this.highlight(e[i])},highlightElement:function ot(t){var e=null;return t&&t[0]&&(e=this.getItemByElement(t)),this.highlight(e)},highlight:function at(t){return t=t||null,t===this.highlightedItem?t:(this.highlightedItem&&this.highlightedItem.set(C,!1),this.highlightedItem=t,t&&t.set(C,!0),this.triggerEvent(a.EVENT_ITEM_HIGHLIGHTED,{item:t},!0),t)},getItemByElement:function rt(t){var e=t.data(f);return n.find(this.itemsToRender,function(t){return t.cid===e})},abortSearch:function lt(){this.typeahead.abortSearch()},prefetch:function ht(){this.typeahead.prefetch()},onMousedown:function dt(t){s(t.target).is("."+this.CssClassName.BUTTON_TEXT)?t.stopPropagation():this.triggerEvent(a.EVENT_TYPEAHEAD_MOUSEDOWN,null,!0)},onMouseleave:function ct(t){this.isOpen()&&this.highlightElement()},onRemoveResult:function ut(t){t.stopPropagation(),t.preventDefault();var e=s(t.currentTarget),i=e.parents("li").data(f),n=e.attr("data-query");if(n){var o=h.create("TypeaheadClearRecentResource",{query:n});o.callDelete(),e.parents("li").remove(),this.items=this.items.filter(function(t){return t.query!==n}),this.itemsToRender=this.itemsToRender.filter(function(t){return t.cid!==i}),0===this.itemsToRender.length&&this.hideNoResults()}},onRemoveAllResults:function pt(t){t.stopPropagation(),t.preventDefault();var e=h.create("TypeaheadClearRecentResource",{query:null});e.callDelete().then(function(){this.items=this.items.filter(function(t){return"recent_query"!==t.type}),this._updateItemsToRender(),this.renderResults()}.bind(this))},onResultClick:function _t(t){this.selectElement(s(t.currentTarget)),t.stopPropagation()},onResultMouseEnter:function gt(t){this.highlightElement(s(t.currentTarget))},_updateItemsToRender:function mt(){var t=this.getLastTerm(),e=this.prependedStaticItems.concat(this.items,this.appendedStaticItems),i=[],s={};e.forEach(function(t){var e=t.type,n=this.VALID_SECTIONS[e];if(n&&!s[e]&&this.options.is_multiobject_search){var o={type:"title",label:n.title,url:n.getUrl(this.getLastTerm()),highlightLabel:n.getQuery(this.getLastTerm()),class_name:"titleItem",selectable:!1};i.push(o),s[e]=!0}i.push(t)}.bind(this)),this.itemsToRender=n.map(i,function(e,i){e.tag=e.tag||"",e.resultIndex=e.resultIndex||i,e.enteredQuery=t,e.label=e.label||"";var n=t?t.toLowerCase():"";0===e.label.indexOf(n)?(e.boldedLabelText=n,e.unboldedLabelText=e.label.slice(n.length)):e.unboldedLabelText=e.label;var s=new o.Model(e);return s.set(E,this.selectedContactsSet.has(e.id)),s}.bind(this))},onTypeaheadData:function ft(t){this.items=t.items,this._updateItemsToRender();var e=t.hint;this.hint=e,this.triggerEvent(a.EVENT_TYPEAHEAD_HINT,e,!0),this.renderResults(),this._triggerEvents()},_triggerEvents:function Ct(){var t=this.getLastTerm(),e=0;t&&(e=t.length);var i=this.options.enable_recent_queries;if(0===this.itemsToRender.length||0===e){if(i)return void this.renderResults();this.hideNoResults(),this._triggerNoResultsReturned()}else this._triggerResultsReturned(),this.renderResults()},_renderEmptyState:function Et(){var t=[],e={},i=a.TYPEAHEAD_ATTRIBUTE_EMPTY_STATE;e[i]=!0,t.push(e),this.items=t,this._updateItemsToRender(),this._triggerEvents(),this.renderResults()},_triggerNoResultsReturned:function vt(t){this.triggerEvent(a.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,null,!0),t&&this._renderEmptyState()},_triggerResultsReturned:function It(){var t={count:this.itemsToRender.length,items:this.itemsToRender};this.triggerEvent(a.EVENT_TYPEAHEAD_RESULTS_RETURNED,t,!0)},focus:function Tt(){},onResize:function Nt(){this._isOpen&&this.renderResults()}});T.prototype.className="Typeahead",t.exports=_.register(T)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(126),h=i(40),d=i(18);i(178);var c=100,u=r.extend({events:{"keyup input":"onInputKeyup","keydown input":"onInputKeydown","click .tokenWrapper":"onTokenModuleWrapperClick","click .inputToken":"onInputTokenClick","click .removeAll":"onRemoveAll"},CssClassName:{TOKEN_SELECTED:"tokenSelected"},onCreated:function p(){this.options.handled_by_parent||this.childListen(o.EVENT_ITEM_SELECTED,this.onTypeaheadItemSelected),this.tokens=[],this.savedTokens=[],this.selectedToken=null,this.removingToken=!1,this.childListen(o.EVENT_REMOVE_TOKEN,this.onRemoveToken),this.listen(l,o.EVENT_BODY_COLUMN_CHANGE,this.onBodyColumnChange);var t={};t[o.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED]=this.onSearchQueryUpdated,t[o.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED_FORCE_UPDATE]=this.onSearchQueryUpdated,this.pubsubSubscribe(o.PUBSUB_CHANNEL_SITE,t),this.updateTokenizedInputView=this.updateTokenizedInputView.bind(this),this.state={scrollLeft:0}},onSearchQueryUpdated:function _(t,e,i){this.removingToken=!1},onRemoveToken:function g(t){if(!this.removingToken){this.removingToken=!0;var e=t.data,i=n.indexOf(this.tokens,e),s=this.tokens[i].getTokenData();this.removeToken(e),this.triggerEvent(o.EVENT_TOKEN_REMOVED_BY_USER,s,!0)}},onInputTokenClick:function m(){this.selectedToken&&this.unselectSelectedToken(),this.options.hide_tokens_on_focus&&this.setEditingTokenText()},setEditingTokenText:function f(){var t=this.getTokens();if(t.length>0){var e=this.constructTokenTextLeftToRight();this.savedTokens=s.extend(!0,[],t);var i=n.clone(t);n.each(i,function(t){this.removeToken(t)}.bind(this)),this.getInputField().setValue(e),n.defer(function(){this.getInputField().setCursorPosition(e.length)}.bind(this))}},onBodyColumnChange:function C(){this.updateTokenizedInputView()},constructTokenText:function E(){return"prioritized"===this.options.token_text_strategy?this.constructTokenTextBasedOnPriority():this.constructTokenTextLeftToRight()},_getTokensWidth:function v(t,e){for(var i=this.getTokens(),n=0,s=t;e>=s;s++)n+=i[s].getWidth(!0);return n},updateTokenizedInputView:function I(){var t=this.getWidth(),e=this.getTokens(),i=this._getTokensWidth(0,e.length-1),s=this.$(".inputToken"),o=this.$(".tokensWrapper"),a=this.$(".scrollWrapper"),r=t-i,l=this.state.scrollLeft;if(r>=c)o.css("width",t+"px"),s.css("width",r+"px"),a.css("overflow-x","hidden");else{var d=i+c;if(s.css("width",c+"px"),h.instance.is_mobile_agent&&a.css("overflow-x","scroll"),this.selectedToken){var u=n.indexOf(e,this.selectedToken),p=this._getTokensWidth(0,u-1);p-l>=0?p-l>t&&(l=t-d):l=0}else l=t-d;o.css("width",d-l+"px"),a.scrollLeft(-1*l),this.state.scrollLeft=l}},constructTokenTextBasedOnPriority:function T(){var t=this.getTokens(),e="";return n.each(t,function(t){var i=t.getTokenData(),n=i.text,s=i.priority;"0"===s?e=n+" "+e:e+=" "+n,e=e.trim()}),e},constructTokenTextLeftToRight:function N(){var t=this.getTokens(),e="";return n.each(t,function(t){var i=t.getTokenData(),n=i.text;e+=" "+n,e=e.trim()}),e},getTokenInputValue:function S(){var t=this.constructTokenText();return(t+" "+this.getInputValue()).trim()},getInputValue:function b(){return this.getInputField().getValue().trim()},setTokenValue:function y(t){var e=t;if(this.savedTokens.length>0)return this.clearTokens(),this.addTokensAndUpdateInputView(this.savedTokens),this.clearSavedTokens(),"";var i=this.getTokens(),s=n.clone(i);return n.each(s,function(t){var i=t.getTokenData(),n=i.text,s=new RegExp("(^|\\s)"+n+"(?=\\s|$)");e.match(s)?e=e.replace(n,""):this.removeToken(t),e=e.trim()}.bind(this)),e.trim()},setInputValue:function P(t){this.getInputField().setValue(t)},onTokenModuleWrapperClick:function B(t){var e=s(t.currentTarget),i=e.find(".Module").first(),o=this.getChildByElement(i);if(o&&(o===this.selectedToken?this.unselectSelectedToken():this.selectToken(o),t.stopPropagation()),this.options.hide_tokens_on_focus){var a=this._findIndexSelectedToken();this.setEditingTokenText(),a>=0&&(n.defer(function(){this.getInputField().focus(),this.getInputField().setCursorPosition(a)}.bind(this)),this.unselectSelectedToken())}},getTokens:function A(){return this.tokens},onInputKeydown:function R(t){var e=t.keyCode,i=s(t.target),a=i[0].selectionEnd,r=n.indexOf(this.tokens,this.selectedToken);switch(e){case o.KeyCode.LEFT:if(0!==a)break;if(!this.tokens.length)break;this.selectedToken?0!==r?this.selectAdjacentToken(!0):this.unselectSelectedToken():this._handleNoSelectedTokenKeydown(!1);break;case o.KeyCode.RIGHT:this.selectedToken&&(r!==this.tokens.length-1?this.selectAdjacentToken(!1):this.unselectSelectedToken(),t.preventDefault());break;case o.KeyCode.BACKSPACE:if(0===a)if(t.preventDefault(),this.selectedToken){var l=this.selectedToken;this.unselectSelectedToken(),this.removeToken(l),this._shouldSelectOnBackspaceKeydown=!1,this.getInputField().focus()}else this.removeToken(n.last(this.tokens))}},onInputKeyup:function w(t){var e=t.keyCode;return e!==o.KeyCode.LEFT&&e!==o.KeyCode.RIGHT&&e!==o.KeyCode.BACKSPACE?void this.unselectSelectedToken():(t.preventDefault(),this._shouldSelectOnBackspaceKeydown=!0,void t.stopPropagation())},_handleNoSelectedTokenKeydown:function O(t){var e;e=t?n.first(this.tokens):n.last(this.tokens),this.selectToken(e)},selectAdjacentToken:function D(t){var e=n.indexOf(this.tokens,this.selectedToken),i;i=-1!==e?t?this.tokens[e-1]:this.tokens[e+1]:t?n.last(this.tokens):n.first(this.tokens),i||(i=null),this.selectToken(i)},getInputFieldValue:function x(){var t=this.getInputField(),e=t.getValue();return e},selectToken:function L(t){this.selectedToken&&this.selectedToken.getContent().removeClass(this.CssClassName.TOKEN_SELECTED),this.selectedToken=t,t&&this.selectedToken.getContent().addClass(this.CssClassName.TOKEN_SELECTED),this.updateTokenizedInputView()},_findIndexSelectedToken:function k(){if(this.selectedToken){for(var t=n.indexOf(this.tokens,this.selectedToken),e="",i=0;t>=i;i++)e+=" "+this.tokens[i].getTokenData().text;return e.trim().length}return-1},unselectSelectedToken:function U(){this.selectedToken&&(this.selectedToken.getContent().removeClass(this.CssClassName.TOKEN_SELECTED),this.selectedToken=null,this.updateTokenizedInputView())},getInputField:function M(){return this.getChildById("input")},onTypeaheadItemSelected:function F(t){var e=s.extend(!0,{},this.options.token_module),i=t.data.item.attributes;if(e.data=i,!e)throw new Error("TokenizedInput module needs a `token_module` option.");d.load(e).then(function(t){t.renderExistingData(),this.addToken(t);var e=this.getInputField();e.clear(),e.focus()}.bind(this))},updateInputPlaceholder:function $(){this.tokens&&this.tokens.length>0?this.getInputField().clearPlaceholder():this.getInputField().restorePlaceholder()},addTokensAndUpdateInputView:function H(t){var e=t.map(function(t){return this.addToken(t)}.bind(this));Promise.all(e).then(this.updateTokenizedInputView)},addToken:function V(t){var e=s('<li class="tokenizedItem tokenWrapper"></li>'),i=this.$(".inputToken");return e.insertBefore(i),this.insertChild(t,e),this.tokens.push(t),this.triggerEvent(o.EVENT_TOKEN_ADDED,t,!0),this.updateInputPlaceholder(),this.options.show_remove_all&&this.updateRemoveAll(),t.render()},removeToken:function G(t){var e=n.indexOf(this.tokens,t);this.triggerEvent(o.EVENT_TOKEN_REMOVED,t,!0),-1!==e&&(this.tokens.splice(e,1),this.$(".tokenWrapper").eq(e).remove(),t.destroy()),this.updateInputPlaceholder(),this.updateTokenizedInputView(),this.options.show_remove_all&&this.updateRemoveAll()},clearTokens:function W(){var t=this.getTokens();if(t.length>0){var e=n.clone(t);n.each(e,function(t){this.removeToken(t)}.bind(this))}},clearSavedTokens:function K(){this.savedTokens=[]},onRemoveAll:function j(t){this.clearTokens(),this.clearSavedTokens(),this.getInputField().clear(),this.triggerEvent(o.EVENT_TOKEN_REMOVED_BY_USER,null,!0),t.stopPropagation()},updateRemoveAll:function Y(){this.tokens.length>0?this.$(".removeAll").show():this.$(".removeAll").hide()}});u.prototype.className="TokenizedInput",t.exports=a.register(u)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(50),a=i(19),r=i(227);i(125);var l=o.extend({onCreated:function h(){this.childListen(s.EVENT_IMAGE_BLOCK_CLICKED,this.onListItemClick);var t={};t[s.PUBSUB_TOPIC_SOCIAL_NETWORK_UPDATED]=this.onSocialNetworkUpdated,this.pubsubSubscribe(s.PUBSUB_CHANNEL_CURRENT_USER,t)},onContentReady:function d(){void 0===this.originalData&&(this.originalData=this.data,this.originalData.forEach(function(t){!t.id&&t.email&&(t.id=t.email)}))},numContacts:function c(){return this.data.length},onListItemClick:function u(t){var e=n(t.target),i=t.data.network,o=t.data.connectCta;if(i){var a={success:function l(){e.parents("li").remove()}};r.instance().handleConnect(i,!0,a)}else"1"===o?this.triggerEvent(s.EVENT_SHOW_SOCIAL_CONNECT_PANEL,t.data,!0):this.triggerEvent(s.EVENT_CONTACT_SELECTED,t.data,!0)},updateContactSelection:function p(t){var e=new Set(t.map(function(t){return t.id})),i=function s(t){return!e.has(t.id)},n=this.originalData.filter(i);this.data=t.concat(n),this.renderExistingData()},onSocialNetworkUpdated:function _(){this.renderExistingData()}});l.prototype.className="ContactsList",t.exports=a.register(l)},function(t,e,i){"use strict";function n(){var t=l.getBrowser();return t?m[t].newWindow:void 0}function s(){var t=l.getBrowser();return t?m[t].url:void 0}function o(t,e){if(f.isExtensionInstalled()===!1){var i=s();chrome.webstore.install(i,t,e)}}var a=i(1),r=i(2),l=i(233),h=i(9),d=i(11),c=i(43),u=i(23),p=i(27),_,g=100,m=a.object([[d.BrowserType.CHROME,{url:d.GEN.BrowserExtensionUrls.EXTENSION_PINIT_CHROME_URL,newWindow:!0}],[d.BrowserType.FIREFOX,{url:d.GEN.BrowserExtensionUrls.EXTENSION_PINIT_FIREFOX_URL,newWindow:!1}],[d.BrowserType.SAFARI,{url:d.GEN.BrowserExtensionUrls.EXTENSION_PINIT_SAFARI_URL,newWindow:!1}],[d.BrowserType.IE,{url:d.GEN.BrowserExtensionUrls.EXTENSION_PINIT_IE_URL,newWindow:!1}],[d.BrowserType.OPERA,{url:d.GEN.BrowserExtensionUrls.EXTENSION_PINIT_OPERA_URL,newWindow:!0}]]),f={};f={handleExtensionInstall:function C(t,e){var i=s();if(i){var a=e||function(){p.changeWindowLocation(i,n())};f.isChrome()?o(t,a):a()}},isExtensionInstalled:function E(){return _},isChrome:function v(){return l.getBrowser()===d.BrowserType.CHROME}},r(window).on("load",function(){setTimeout(function(){_=void 0!==r("body").attr("data-pinterest-extension-installed"),u.instance.publish(d.PUBSUB_CHANNEL_BROWSER_EXTENSION,d.PUBSUB_TOPIC_BROWSER_EXTENSION_STATE_UPDATED),c.logToServer(c.SERVER_LOG_TYPE.BROWSER_EXTENSION,c.HTTP_METHOD.GET,{browser_extension_installed:_})},g)}),t.exports=h.expose("BrowserExtension",f)},function(t,e,i){"use strict";var n=i(11),s=i(9),o={getBrowser:function a(){var t=!!window.opera||window.navigator.userAgent.indexOf(" OPR/")>=0,e="InstallTrigger"in window,i=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,s=!!window.chrome&&!t,o=!!document.documentMode;return e?n.BrowserType.FIREFOX:t?n.BrowserType.OPERA:s?n.BrowserType.CHROME:o?n.BrowserType.IE:i?n.BrowserType.SAFARI:n.BrowserType.OTHER}};t.exports=s.expose("BrowserDetector",o)},function(t,e,i){"use strict";var n=i(235),s=i(19),o=n.extend({});o.prototype.className="RepinSuccessToast",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(34);i(236);var a=4e3,r=n.extend({CssClassName:{VISIBLE:"visible"},onAdded:function l(){var t=this;this.$el.transition({y:200,opacity:0,duration:1},function(){t.$el.addClass(t.CssClassName.VISIBLE)}).transition({y:0,easing:"cubic-bezier(.19, 1.15, .48, 1)",opacity:1,duration:450})},animateOut:function h(){this.$el.transition({scale:1.1,opacity:0,duration:200},function(){this.destroy()}.bind(this))},attachTimer:function d(t){this._timer=o.setTimeout(function(){return"ontouchstart"in window||!this.$el.isHovering()?void this.animateOut():(clearTimeout(this._timer),void this.$el.on("mouseleave",function(){this.attachTimer(a/2)}.bind(this)))}.bind(this),t)},onContentReady:function c(){this.$el.initHovering(),this.attachTimer(a)}});r.prototype.className="ToastBase",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(138),a=i(142),r=i(40),l=i(59),h=i(23),d=i(8),c=i(131),u=i(46),p=a.extend({getResourceId:function _(){return this.options.board_id},getFollowResource:function g(){return d.create("BoardFollowResource",{board_id:this.getResourceId()})},getFollowClass:function m(){return this.options.follow_class},getContextualResource:function f(){return d.create("BoardResource",{board_id:this.getResourceId(),field_set_key:"grid_item"})},getAuthRedirectUrl:function C(){return u.isAuthenticated()?void 0:c.showInlineSignupModalOnButtonClick("BoardFollowButton")},onContentReady:function E(){if(this.options.user_id){var t={};t[n.PUBSUB_TOPIC_USER_FOLLOW]=this.onFollowUser,t[n.PUBSUB_TOPIC_USER_UNFOLLOW]=this.onUnfollowUser,this.pubsubSubscribe(this.options.user_id,t)}var e={};e[n.PUBSUB_TOPIC_USER_FOLLOW]=this._onFollow,e[n.PUBSUB_TOPIC_USER_UNFOLLOW]=this._onUnfollow,e[n.PUBSUB_TOPIC_BOARD_UNFOLLOW]=this._onUnfollow,this.pubsubSubscribe(this.getResourceId(),e),this.showMemo()},_onFollow:function v(){this.setState(!0);var t={board_id:this.getResourceId()};if(this.triggerEvent(n.EVENT_BOARD_FOLLOW,t,!0),h.instance.publish(this.getResourceId(),n.PUBSUB_TOPIC_BOARD_FOLLOW,!0),this.options.suggested_boards_menu&&!r.instance.is_mobile_agent){var e=l.instance.v2ActivateExperiment("recommend_boards_on_board_follow"),i=["enabled2","employee","employees"].indexOf(e)>-1;if(i){this._dropdown&&this._dropdown.destroy();var s={anchor:this.$el.closest(".boardFollowButtonWrapper"),anchored:!0,largeCaret:!0,fixed:!0,position_point:"BOTTOM_CENTER",force_in_viewport:!0,class_name:"suggestedBoardsDropdown",module:this.options.suggested_boards_menu};this._dropdown=new o({options:s}),this._dropdown.initHovering(),this._dropdown.slideIn(200)}}},_onUnfollow:function I(){this.setState(!1);var t={board_id:this.getResourceId()};this.triggerEvent(n.EVENT_BOARD_UNFOLLOW,t,!0),h.instance.publish(n.PUBSUB_CHANNEL_CURRENT_USER,n.PUBSUB_TOPIC_BOARD_UNFOLLOW,!0),this.options.suggested_boards_menu&&!r.instance.is_mobile_agent&&this.dropdown&&this._dropdown.destroy()},onFollowUser:function T(){this.setState(!0)},onUnfollowUser:function N(){this.setState(!1)}});p.prototype.className="BoardFollowButton",t.exports=s.register(p)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=a.extend({onContentReady:function l(){a.prototype.onContentReady.apply(this,arguments);var t=this.data&&this.data.pinned_to_board&&!n.isEmpty(this.data.pinned_to_board);t?this.triggerDupeDetected():this.model&&this.listenToOnce(this.model,"change:pinned_to_board",function(){this.renderExistingData().then(function(){this.triggerDupeDetected()}.bind(this))}.bind(this))},triggerDupeDetected:function h(){this.triggerEvent(s.EVENT_DUPE_DETECTED,null,!0)},isDupe:function d(){return this.data&&n.keys(this.data).length}});r.prototype.className="PinDupWarning",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(239),r=i(23),l=i(8),h=a.extend({_SHOW_BOARD_SUGGESTIONS_THRESHOLD:3,onCreated:function d(){a.prototype.onCreated.call(this)},onContentReady:function c(){a.prototype.onContentReady.call(this),this.shouldRenderQuickPicks()&&this._renderQuickPicksItems(),this.options.select_first_board&&this.selectFirstBoard(),this.options.default_board_id&&this.selectBoardById(this.options.default_board_id),this.model&&this.model.on("change",function(){this.renderExistingData()}.bind(this))},_renderQuickPicksItems:function u(){var t=l.create("QuickPicksSuggestionResource",{pin_id:this.options.pin_id});t.callGet({showError:!1}).then(function(t){var e=this.getList(),i=t.resource_response&&t.resource_response.data,s=n.uniq(i,!1,function(t){return t.id});if(this.data.boards_shortlist&&this.data.boards_shortlist.length){var o=this.data.boards_shortlist[0].id===s[0].id;this._removeQuickPicksSpinner(),o||e.emptySectionAtIndex(0);var a=o?s.slice(1):s;a.forEach(function(t){e.appendItem({type:"module",name:"BoardLabel",item_module:"BoardLabel",data:t,options:{view_type:"pinCreate",show_pin_it_button:!0}},!1,0)}),this.data.boards_shortlist=s}}.bind(this))},selectBoardAtIndex:function p(t){var e=this._list.$(".allBoards"),i=e.find(".item").eq(t);this._list._selectItem(i)},selectBoardById:function _(t){var e=-1;this.getAllBoards().forEach(function(i,n){i.id===t&&(e=n)}),e>0&&this.selectBoardAtIndex(e)},selectFirstBoard:function g(){this._list.selectFirstVisibleItem()},_create:function m(t){var e="compact"===this.options.view_type;if(t&&e){var i=l.create("BoardResource",{name:t});return i.callCreate().then(function(t){var e=t.resource_response.data,i=e.id;return this.triggerEvent(s.EVENT_BOARD_CREATED,i,!0),r.instance.publish(s.PUBSUB_CHANNEL_CURRENT_USER,s.PUBSUB_TOPIC_BOARD_CREATED,e),e}.bind(this))}return Promise.resolve({name:t})},getSelectedElement:function f(){return this._list.getSelectedItemElement()},getSelectedBoardData:function C(){return this._list.getSelectedItemData()},getAllBoards:function E(){return this.data.all_boards},getBoardsShortList:function v(){return this.data.boards_shortlist},getCreateSuggestions:function I(){return this.data.create_suggestions},_onNameTextChange:function T(){if(a.prototype._onNameTextChange.call(this),this.options.hide_all_boards_heading_on_filter){var t=this._getNameInputText(),e=this.$(".allBoards .sectionHeading");t.length?e.hide():e.show()}},hasBoards:function N(){return this.extraData.hasBoards},appendModuleToList:function S(t,e){var i=this.getList();i.appendItem(t,!1,e)},shouldRenderQuickPicks:function b(){return this.options.async&&this.getBoardsShortList().length},_removeQuickPicksSpinner:function y(){var t=this.getList().getChildByModuleName("BoardPickerSpinnerBlock");t&&(this.getList().removeItem(t.getParentElement()),t.destroy())}});h.prototype.className="BoardPicker",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(40),r=i(52),l=i(240);i(116),i(178),i(241);var h=o.extend({events:{keydown:"_onKeydown","textchange .name":"_onNameTextChange"},onCreated:function d(){this.childListen(n.EVENT_BUTTON_CLICK,this._onChildButtonClick),this.childListen(n.EVENT_ITEM_CLICK,this._onChildItemClick),this._list=null,this._addedCreateItem=!1},onContentReady:function c(){this._list=this.getChildById("list"),this._addedCreateItem=!1},focus:function u(){r.deferDomManipulation(function(){a.instance.is_mobile_agent||this.$(".name").focusWithoutScrolling(),this._list.scrollSelectedItemElementIntoView()}.bind(this))},getList:function p(){return this._list},clearName:function _(){this.$(".name").val(""),this._onNameTextChange()},_create:function g(t){return Promise.reject(new Error("subclasses must override this"))},_createAndSubmit:function m(t){this.showLoading(),this._create(t).then(function(t){return t&&(this._submit(t),!this.options.skip_append_created_item)?this._list.appendItem(t,!0):void 0}.bind(this)).fin(function(){this.hideLoading()}.bind(this))},_createFromInputNameAndSubmit:function f(){var t=this._getNameInputText();this._createAndSubmit(t)},_getNameInputText:function C(){return this.$(".name").val().trim()},_handleChoice:function E(t){if(t.is_create)this._createFromInputNameAndSubmit();else if(t.is_create_suggestion){var e=t.name,i=e.toString();this._createAndSubmit(i)}else this._submit(t)},_onChildButtonClick:function v(t){var e=t.target;e&&"createButton"===e.id&&this._createFromInputNameAndSubmit()},_onChildItemClick:function I(t){var e=t.target,i=t.data;e&&"list"===e.id&&this._handleChoice(i)},_logArrowEvent:function T(t){"pinCreate"===this.options.view_type&&this._logCustomContextEvent(t?n.GEN.EventType.WEB_PIN_CREATE_BOARD_FILTER_KEYDOWN_ARROW_UP:n.GEN.EventType.WEB_PIN_CREATE_BOARD_FILTER_KEYDOWN_ARROW_DOWN,n.GEN.ElementType.WEB_PIN_CREATE_BOARD_FILTER,n.GEN.ComponentType.MODAL_REPIN,{})},_logEnterEvent:function N(){"pinCreate"===this.options.view_type&&this._logCustomContextEvent(n.GEN.EventType.WEB_PICKER_ENTER,n.GEN.ElementType.WEB_PIN_CREATE_BOARD_FILTER,n.GEN.ComponentType.MODAL_REPIN,{})},_onKeydown:function S(t){if(this._list.hasVisibleItems())switch(t.keyCode){case n.KeyCode.UP:t.preventDefault(),t.stopPropagation(),this._logArrowEvent(!0),this._list.highlightUp();break;case n.KeyCode.DOWN:t.preventDefault(),t.stopPropagation(),this._logArrowEvent(!1),this._list.highlightDown();break;case n.KeyCode.ENTER:case n.KeyCode.NUMPAD_ENTER:t.preventDefault(),t.stopPropagation(),this._logEnterEvent();var e=this._list.getSelectedItemData();e?this._handleChoice(e):this._handleChoice({name:this._getNameInputText(),is_create:!0})}},_onNameTextChange:function b(){var t=void 0!==this.options.allow_create?this.options.allow_create:!0;if(t&&!this._addedCreateItem){var e={};this.options.create_item_label&&(e.create_item_label=this.options.create_item_label),"pinCreate"===this.options.view_type&&(e.view_type="pinCreate",this._logCustomContextEvent(n.GEN.EventType.WEB_PIN_CREATE_BOARD_FILTER_KEYDOWN,n.GEN.ElementType.WEB_PIN_CREATE_BOARD_FILTER,n.GEN.ComponentType.MODAL_REPIN,{})),this._list.appendItem({type:"module",name:"PickerItemCreate",options:e,data:{is_create:!0}}),this._addedCreateItem=!0}var i=this._getNameInputText(),s=function(t){var e=!!i;if(e){var n=t.filter(function(t){return!t.data||t.data.is_spinner||t.data.is_create||t.data.recommendation_reason||t.data.is_create_suggestion||t.data.skip_filter?!1:!0}),s=n.map(function(t){return t.data.name}),o=l.match(i,s),a={};s.forEach(function(t,e){a[t]=o.itemMatched[e]})}var r=t.map(function(t){var n=t.data;if(!n)return!1;if(n.is_spinner)return!0;if(n.is_create){var s=e&&!o.hasExactMatch,r=t;return r.setCreateName(i),s}if(n.recommendation_reason||n.is_create_suggestion)return!e;if(n.skip_filter)return!0;if(e){var l=n.name;return this.options.highlight_matched_text&&(a[l]?t.highlightMatchedText(i):t.unHighlightMatchedText()),a[l]}return this.options.highlight_matched_text&&t.unHighlightMatchedText(),!0}.bind(this));return r}.bind(this);this._list.setItemVisibilityCallback(s)},_submit:function y(t){this.triggerEvent(n.EVENT_CHANGE,t,!0)}});h.prototype.className="Picker",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(1),s=function h(){this.hasExactMatch=!1,this.itemMatched=[]},o=function d(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},a=function c(t){var e=t.split(" "),i=n.without(e,""),s=n.map(i,o),a=new RegExp(s.join(".*"),"i");return function(t){return a.test(t)}},r=function u(t){return new RegExp("^"+o(t)+"$","i")},l={match:function p(t,e){var i=a(t),o=new s;o.itemMatched=n.map(e,i);var l=r(t);return o.hasExactMatch=n.some(e,function(t){return l.test(t)}),o}};t.exports=l},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(52),l=i(18),h=a.extend({events:{"click .item":"_onClickItem","mouseenter .item":"_onHoverItemStart","mouseleave .item":"_onHoverItemEnd",keydown:"_onKeydown"},CssClassName:{IS_HIDDEN:"hidden",IS_SELECTED:"selected",ITEM:"item"},onCreated:function d(){this._itemVisibilityFn=null},onContentReady:function c(){var t=this.getSelectedItemElement();t.length>0&&this._selectItem(t)},appendItem:function u(t,e,i){return void 0===i&&(i=-1),this._appendItem(t,!!e,i)},removeItem:function p(t){var e=this._getItemModule(t);t.remove(),e&&e.remove()},emptySection:function _(t){var e=t.find(".sectionItems");e&&e.length&&e.empty()},emptySectionAtIndex:function g(t){var e=this.$(".sectionItems");t=Math.min(t,e.length-1),e.eq(t).empty()},hasVisibleItems:function m(){return this.$(".item:not(.hidden)").length>0},highlightUp:function f(){this._highlightDirection(!0)},highlightDown:function C(){this._highlightDirection(!1)},getSelectedItemData:function E(){var t=this.getSelectedItemElement();return t.length>0?this._getItemData(t):null},scrollSelectedItemElementIntoView:function v(){var t=this.getSelectedItemElement();if(0!==t.length){var e=this.$el;r.scrollIntoView(t,e)}},setItemVisibilityCallback:function I(t){this._itemVisibilityFn=t,this.updateItemVisibility()},_appendItem:function T(t,e,i){var s=this.options.item_module||{name:"Label"},o=null;return o="module"===t.type?t:{name:s.name,options:s.options,data:t},l.load(o).then(function(t){return t.renderExistingData().then(function(){var s=n('<li class="item"></li>');this.$(".sectionItems").eq(i).append(s),this.insertChild(t,s),e&&this._selectItem(s),this.updateItemVisibility(this.options.select_first_item_after_update)}.bind(this))}.bind(this))},getSelectedItemElement:function N(){var t=this.$(".item.selected:not(.hidden)");return t},_getItemData:function S(t){var e=this._getItemModule(t);return e?e.data:null},_getItemModule:function b(t){var e=t.children()[0];return this.getChildByElement(e)},_highlightDirection:function y(t){var e=this.getSelectedItemElement();if(0===e.length)t?this.selectLastVisibleItem():this.selectFirstVisibleItem();else{var i=e;do{if(i=t?i.prev():i.next(),i.is(".item:not(.hidden)")){this._selectItem(i);break}if(0===i.length){var n;t?(n=e.parents(".section").prev(),n.length||(n=this.$(".section").last())):(n=e.parents(".section").next(),n.length||(n=this.$(".section").first()));var s=n.find(".item:not(.hidden)"),o=t?s.last():s.first();this._selectItem(o)}}while(i.length>0)}},_onClickItem:function P(t){t.stopPropagation();var e=n(t.currentTarget);this._selectItem(e);var i=this._getItemData(e);i&&this.triggerEvent(s.EVENT_ITEM_CLICK,i,!0)},_onHoverItemStart:function B(t){if(!this.options.suppress_hover_events){var e=n(t.currentTarget);this._selectItem(e)}},_onHoverItemEnd:function A(t){this.options.suppress_hover_events||this._selectItem(null)},_onKeydown:function R(t){if(this.hasVisibleItems())switch(t.keyCode){case s.KeyCode.UP:t.preventDefault(),t.stopPropagation(),this.highlightUp();break;case s.KeyCode.DOWN:t.preventDefault(),t.stopPropagation(),this.highlightDown()}},selectFirstVisibleItem:function w(){this._selectItemAtEnd(!0)},_selectItemAtEnd:function O(t){var e=this.$(".item:not(.hidden)"),i=t?e.first():e.last();i.length>0&&this._selectItem(i)},selectLastVisibleItem:function D(){this._selectItemAtEnd(!1)},_selectItem:function x(t){var e=this.$(".item.selected");t&&(e=e.add(t)),e.each(function(e,i){var s=t?i===t[0]:!1,o=n(i);o.toggleClass(this.CssClassName.IS_SELECTED,s);var a=this._getItemModule(o);a&&a.setSelectedState&&a.setSelectedState(s)}.bind(this)),this.options.scroll_selected_item_into_view&&this.scrollSelectedItemElementIntoView()},updateItemVisibility:function L(t){if(this._itemVisibilityFn){void 0===t&&(t=!0);var e=[],i=[];this.children.forEach(function(t){var n=t.$el.parent();n.hasClass(this.CssClassName.ITEM)&&(e.push(t),i.push(n))}.bind(this));for(var s=this._itemVisibilityFn(e),o=0;o<s.length;o++){var a=s[o],r=i[o];r.toggleClass(this.CssClassName.IS_HIDDEN,!a)}this.$(".section").each(function(t,e){var i=n(e),s=i.find(".item:not(.hidden)").length>0;i.find(".sectionHeading").toggleClass(this.CssClassName.IS_HIDDEN,!s)}.bind(this)),t&&this.selectFirstVisibleItem()}}});h.prototype.className="SelectList",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(243),o=i(50),a=i(133),r=i(19),l=i(46),h=o.extend({events:{'change [name="share_facebook"]':"onFacebookCheckboxChanged"},onCreated:function d(){this.networkToSelectorMap={},this.networkToSelectorMap[a.FACEBOOK]='[name="share_facebook"]',this.networkToSelectorMap[a.TWITTER]='[name="share_twitter"]'},onFacebookCheckboxChanged:function c(t){var e=this.getNetworkChecked(a.FACEBOOK);l.set(n.FB_PUBLISH_KEY,e),e&&s.maybeRequestFbTimelinePermission({error:function(){this.setNetworkChecked(a.FACEBOOK,!1),l.set(n.FB_PUBLISH_KEY,!1)}.bind(this)})},setNetworkChecked:function u(t,e){var i=this.networkToSelectorMap[t];i&&this.$(i).prop("checked",e)},getNetworkChecked:function p(t){var e=this.networkToSelectorMap[t];if(e){var i=this.$(e);return i.length?i.is(":checked"):""}}});h.prototype.className="PinCreateShare",t.exports=r.register(h);
},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(134),a=i(80),r=i(81),l=i(35),h=i(47),d=i(29),c=i(14),u=i(46),p=i(27),_="publish_actions",g={};g.checkFbTimelinePermission=function(t){var e=function i(e){e.api("/me/permissions",function(e){var i=e.data,s=!1;if(i){var o=n.find(i,function(t){return t.permission===_&&"granted"===t.status});s=!!o}s?t.success&&t.success():t.error&&t.error()})};h.ensureInit(e,u)},g.fbConnectedAccountMatchesLoggedInAccount=function(t,e){if(!e)return!0;var i=t.getAuthResponse();return i?e===i.userID:!0},g.maybeRequestFbTimelinePermission=function(t,e){h.ensureInit(function(i){var n=g.fbConnectedAccountMatchesLoggedInAccount(i,e);return n?void g.checkFbTimelinePermission({success:function s(){t.success&&t.success(),t.complete&&t.complete()},error:function o(){g.fbLogin(t)}}):(l.showError(c._("Oops! Your account is linked to a different Facebook account than the one you're logged into now.")),t.error&&t.error(),void(t.complete&&t.complete()))},u)},g.fbLogin=function(t){h.ensureInit(function(e){e.login(function(e){e.authResponse?g.checkFbTimelinePermission(t):t.error&&t.error(),t.complete&&t.complete()},{scope:_})},u)},g.shareFb=function(t){var e=t.ga_category||"share_facebook";d.trackEvent(e,s.GA_ACTION_CLICK);var i=t.dialog_options||{};i.callback=function(){var e=a.fromEventType(s.GEN.EventType.PIN_SHARE_FACEBOOK);t.object_id&&e.setObjectIdStr(t.object_id),r.getInstance().addEvent(e)};var n=i.object_type;n&&p.trackRegisterAction("facebook_share_dialog_open_"+n),o.open(i)},t.exports=g},function(t,e,i){"use strict";var n=i(50),s=i(19);i(173),i(236);var o=n.extend({});o.prototype.className="BoardButtons",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({CssClassName:{LIGHT:"light"},setLightColor:function a(t){this.$el.toggleClass(this.CssClassName.LIGHT,t)}});o.prototype.className="BoardIcons",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({onContentReady:function r(){if(this.options.can_update_count&&this.data.id){var t={};"UserResource"===this.resource.name&&(t[n.PUBSUB_TOPIC_BOARD_DELETED]=this.onCountUpdated),t[n.PUBSUB_TOPIC_PIN_CREATED]=this.onCountUpdated,t[n.PUBSUB_TOPIC_PIN_DELETED]=this.onCountUpdated,this.pubsubSubscribe(this.data.id,t)}},onCountUpdated:function l(t,e,i){var s=1e3;e===n.PUBSUB_TOPIC_PIN_DELETED&&(s=0),setTimeout(this.render.bind(this),s)}});a.prototype.className="PinCount",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(210),i(248),i(250);var o=n.extend({onCreated:function a(){this.childListen("commentDeleteSuccess",this.onPinCommentDelete)},onPinCommentDelete:function r(){this.$el.slideUp(300,function(){this.destroy()}.bind(this))}});o.prototype.className="PinComment",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(249),a=i(29),r=i(18),l=i(23),h=i(8),d=o.extend({events:{click:"onClick"},showConfirmation:function c(){var t={name:"ConfirmDialog",options:{template:"delete_comment"}};r.load(t).then(function(t){this.showInModal(t),this.listen(t,n.EVENT_CONFIRM,this.onDeleteConfirm)}.bind(this))},onDeleteConfirm:function u(){a.trackEvent("comment_delete",n.GA_ACTION_CLICK_SUBMIT);var t={pin_id:this.options.pin_id,comment_id:this.options.comment_id},e=h.create("PinCommentResource",t);e.callDelete().then(function(){a.trackEvent("comment_delete",n.GA_ACTION_SUCCESS),this.triggerEvent("commentDeleteSuccess",this,!0),l.instance.publish(this.options.pin_id,n.PUBSUB_TOPIC_PIN_COMMENT_DELETED)}.bind(this),function(){a.trackEvent("comment_delete",n.GA_ACTION_ERROR)})},onClick:function p(){a.trackEvent("comment_delete",n.GA_ACTION_OPEN_MODAL),this.showConfirmation()}});d.prototype.className="PinDeleteCommentButton",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(116);var o=n.extend({});o.prototype.className="InlineHoverButton",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(249),a=i(29),r=i(18),l=o.extend({events:{click:"onClick"},showReasonModal:function h(){var t={name:"FlagComment",options:{pin_id:this.options.pin_id,comment_id:this.options.comment_id,user_id:this.options.user_id,commenter:this.options.commenter}};r.load(t).then(function(t){this.showInModal(t)}.bind(this))},onClick:function d(){a.trackEvent("comment_flag",n.GA_ACTION_OPEN_MODAL),this.showReasonModal()}});l.prototype.className="PinFlagCommentButton",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(50),o=i(19),a=i(59),r=s.extend({CssClassName:{SELECTED:"selected"},events:{click:"onClick"},onCreated:function l(){this.isGroupBoardCreation=a.instance.v2InGroup("web_group_board_creation",["enabled","employee"]),this.updateDom()},updateDom:function h(){this.$(".left").toggleClass(this.CssClassName.SELECTED,!!this.options.is_selected)},onClick:function d(){this.isGroupBoardCreation&&this._toggleSelection(),this.triggerEvent(n.EVENT_IMAGE_BLOCK_CLICKED,this.data,!0)},_toggleSelection:function c(){this.updateOptionsAndDom({is_selected:!this.options.is_selected})}});r.prototype.className="ImageBlock",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="Label",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(254),a=i(19),r=i(11),l=i(57),h=i(50),d=i(140),c=i(40),u=i(52),p=i(35),_=i(29),g=i(14),m=i(23);i(116);var f=300,C="Chrome Mobile iOS",E=d.extend({events:{"mousedown .modalScroller":"onModalDown","touchstart .modalScroller":"onModalDown","click .modalScroller":"onModalScrollerClick","touchmove .modalScroller":"onModalScrollerTouchMoveOrMouseWheel","mousewheel .modalScroller":"onModalScrollerTouchMoveOrMouseWheel","click .closeModal":"onCloseModalClick","blur .modalScroller":"onKeyboardClose"},CssClassName:n.extend(d.prototype.CssClassName,{SHOW:"show",SLOW:"slow"}),positionMode:r.PositionMode.VIEWPORT_MIDDLE,onCreated:function v(){this.options.state_isVisible=!1,this.options.showCloseModal=!1,this.options.state_mouseDownInModal=!1,this.options.state_showModalMask=!1,this.options.state_showContainer=!1,this.options.state_showPositionElement=!1,this.options.state_slow=!1,d.prototype.onCreated.call(this),this.childListen(r.EVENT_BUTTON_CLICK,this.onChildButtonClick)},_addSubmoduleToContainer:function I(t){t.id="submodule",t.errorStrategy=r.ErrorStrategy.SHOW,this.insertChild(t,this.getModuleContainer());var e=t.render().then(function(){t.setModal(this)}.bind(this));return this.listen(t,r.EVENT_ERROR,function(t,e){var i=g.commonStrings.defaultErrorMessage;this.options.show_api_error&&t.data.message&&(i=t.data.message),p.showError(i),this.animateOutAndDestroy()}),e},onContentReady:function T(){var t=this.getSubmodule();t&&t.setModal(this)},setVisible:function N(t){this.updateOptionsAndDom({state_isVisible:t})},_isPanel:function S(){return this.options.presentation_type===r.GEN.ModalPresentationType.PANEL},_isPanelRight:function b(){var t=this.options.presentation_options||{};return t.panel_direction===r.GEN.ModalPanelDirection.PANEL_RIGHT},onRendered:function y(){this.positionMode=this._isPanel()?r.PositionMode.MANUAL:r.PositionMode.VIEWPORT_MIDDLE},onChildRendered:function P(){this.updateOptionsAndDom({showCloseModal:!0})},updateDom:function B(){var t=this.$(".modalMask");this.$el.toggleClass(this.CssClassName.SLOW,this.options.state_slow),t.toggleClass(this.CssClassName.SLOW,this.options.state_slow),this.$(".closeModal").toggleClass(this.CssClassName.SHOW,this.options.showCloseModal),this.$el.toggleClass(this.CssClassName.SHOW,this.options.state_isVisible),t.toggleClass(this.CssClassName.SHOW,this.options.state_showModalMask),this.$(".modalModule").toggleClass(this.CssClassName.SHOW,this.options.state_showContainer),this.$(".modalContainer").toggleClass(this.CssClassName.SHOW,this.options.state_showPositionElement)},show:function A(t){if(this.positionModule(),this.updateOptionsAndDom({state_slow:!(!t||!t.load_slowly),state_isVisible:!0}),this.options.custom_entrance_animation)u.deferWrite().then(function(){this.getSubmodule().animateEntranceToModal()}.bind(this));else{var e=this.getSubmodule(),i=this.getModuleContainer();u.deferWrite().then(function(){this.updateOptionsAndDom({state_showModalMask:!0})}.bind(this)),e&&e.triggerEvent(r.EVENT_MODAL_ANIMATE_SHOW_START,null,!1);var n=this._isPanel()?{x:(this._isPanelRight()?1:-1)*i.width(),duration:1}:{duration:0},s=this._isPanel()?{x:0,easing:"cubic-bezier(.19, 1.15, .48, 1)",duration:f}:{duration:0};i.transition(n,function(){this.updateOptionsAndDom({state_showPositionElement:!0})}.bind(this)).transition(s,function(){u.deferWrite().then(function(){e&&e.triggerEvent(r.EVENT_MODAL_ANIMATE_SHOW_END,null,!1)})})}},animateOutAndDestroy:function R(){var t=this.getSubmodule();if(this.options.custom_exit_animation&&t)t.animateExitFromModal();else{var e=this.getModuleContainer(),i=this.getSubmodule();u.deferWrite().then(function(){this.updateOptionsAndDom({state_showModalMask:!1})}.bind(this)),i&&i.triggerEvent(r.EVENT_MODAL_ANIMATE_HIDE_START,null,!1);var n=this._isPanel()?{x:(this._isPanelRight()?1:-1)*e.width(),easing:"cubic-bezier(.36, -.15, .21, 1)",duration:f}:{duration:0};e.transition(n,function(){var t=this.getSubmodule();t&&t.triggerEvent(r.EVENT_MODAL_ANIMATE_HIDE_END,null,!1),u.deferWrite().then(function(){this.updateOptionsAndDom({state_showContainer:!1})}.bind(this)),this.destroy()}.bind(this))}this.el.classList&&this.el.classList.contains("campbellDrawerSideNav")&&this._finishCampbellDrawerNUX(),m.instance.publish(r.PUBSUB_CHANNEL_TUTORIAL,r.PUBSUB_TOPIC_VIEW_CHANGE,{moduleName:"Modal",action:r.ViewActions.CLOSE})},_finishCampbellDrawerNUX:function w(){var t=r.GEN.Placement.CAMPBELL_SIDE_NAV,e=r.GEN.Experience.CAMPBELL_SIDE_NAV_USER_ED;l.instance.isPlacedExperience(t,e)&&(m.instance.publish(r.PUBSUB_CHANNEL_CAMPBELL,r.PUBSUB_TOPIC_DRAWER_SIDE_NAV_CLOSE,null),l.instance.completePlacedExperience(t,e))},onAddedToDom:function O(){o.pushScrolling(!1)},onRemovedFromDom:function D(){o.pop()},getSubmodule:function x(){return this.getChildById("submodule")||null},getContent:function L(){return this.$(".modalContent")},getModuleContainer:function k(){return this.$(".modalModule")},getMask:function U(){return this.$(".modalMask")},getModalScroller:function M(){return this.$(".modalScroller")},getFullName:function F(){var t=h.prototype.getFullName.call(this);return this.moduleOpener&&(t=this.moduleOpener.getFullName()+"#"+t),t},getPositionElement:function $(){return this.$(".modalContainer")},setSubmodule:function H(t){var e=this.getChildById("submodule");return e&&(e.id="",e.remove()),this._addSubmoduleToContainer(t)},onChildRemoved:function V(t,e){this.getChildById("submodule")||this.destroy()},onChildButtonClick:function G(t){var e=t.target;if(e&&e.isCancelButton()){var i=this.getSubmodule(),n=i.GACategory;n||(n=i.options.ga_category),n&&_.trackEvent(n,r.GA_ACTION_CLICK_CANCEL),t.stopPropagation(),i.triggerEvent(r.EVENT_DISMISS,null,!0),this.animateOutAndDestroy()}},onModalScrollerClick:function W(t){var e=s(t.target).closest(".modalContent").length>0,i=e||this.options.state_mouseDownInModal;if(!i&&(t.stopPropagation(),this.getCanDismiss())){var n=this.getSubmodule();n&&(n.triggerEvent(r.EVENT_DISMISS,null,!0),this.options.grey_area_dismiss_log_element_type&&this._logCustomContextEvent(r.GEN.EventType.CLICK,this.options.grey_area_dismiss_log_element_type,this.options.log_component_type,null)),this.animateOutAndDestroy()}this.options.state_mouseDownInModal=!1},onModalDown:function K(t){this.options.state_mouseDownInModal=s(t.target).closest(".modalContent").length>0},onModalScrollerTouchMoveOrMouseWheel:function j(t){var e=s(t.target).closest(".modalContent").length>0;e||(t.preventDefault(),t.stopPropagation())},onCloseModalClick:function Y(){this.triggerEvent(r.EVENT_DISMISS,null,!1),this.getSubmodule().triggerEvent(r.EVENT_DISMISS,null,!1),this.destroy()},onKeyboardClose:function q(t){c.instance.browser_name===C&&window.scrollTo(0,1)},getCanDismiss:function z(){var t=this.options.can_dismiss;return void 0===t||t}});E.prototype.className="Modal",t.exports=a.register(E)},function(t,e,i){"use strict";function n(){this.scrollStack=[!0]}var s=i(2),o=i(16),a=i(30),r=o.getLogger("Body"),l="noScroll";n.prototype={pushScrolling:function d(t){return this.push().setScrolling(t),this},pop:function c(){return this.scrollStack.length<=1?void r.error("Tried to pop with only one item on stack.  Mismatched push and pops?"):(this.scrollStack.pop(),this.updateElement(),this)},setScrolling:function u(t){return this.scrollStack[this.scrollStack.length-1]=t,this.updateElement(),this},push:function p(){return this.scrollStack.push(this.peek()),this},peek:function _(){return this.scrollStack[this.scrollStack.length-1]},updateElement:function g(){var t=this.peek();s("body").toggleClass(l,!t)}};var h=new n;a.IS_TEST_MODE&&(h.constructor=n),t.exports=h},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50);i(171);var r=a.extend({onContentReady:function l(){this._button=this.getChildById("button"),this.childListen(s.EVENT_CHANGE,this.onCheckboxChanged)},onCheckboxChanged:function h(t){var e=t.target,i=e.getValue(),o=[];n.each(i,function(t){o.push(t.label)}),this._button.setText(o.join(", ")),t.stopPropagation(),this.triggerEvent(s.EVENT_CHANGE,i,!0)}});r.prototype.className="MultipleSelectButton",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({onContentReady:function a(){this.options.state_name=this.data.name||""},updateDom:function r(){this.$(".createName").text(this.options.state_name)},setCreateName:function l(t){this.updateOptionsAndDom({state_name:t})}});o.prototype.className="PickerItemCreate",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50);i(121),i(258);var r=a.extend({onContentReady:function l(){this.childListen(s.EVENT_CHANGE,this.onChildChanged),this.childListen(s.EVENT_BUTTON_CLICK,this.onChildClicked)},onChildClicked:function h(t){t.stopPropagation(),this.triggerEvent(s.EVENT_BUTTON_CLICK,t,!0)},onChildChanged:function d(t){t.stopPropagation();var e=this.getChildrenByModuleName("RadioButton");n.each(e,function(t){t.refreshLayout()}),this.triggerEvent(s.EVENT_CHANGE,null,!0)},getCurrentLabel:function c(){var t=this.getCheckedRadioButton();return t?t.parents("label").find(".labelContent").text():null},getCheckedRadioButton:function u(){return this.$("input:checked")},val:function p(){var t=this.getCheckedRadioButton();return t?t.attr("value"):void 0}});r.prototype.className="RadioGroup",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({CssClassName:{FANCY_SELECTED:"fancySelected"},onContentReady:function r(){this.$input=this.$("input"),this.input=this.$input[0],this.listen(this.$input,"change",this._onChange),this.listen(this.$input,"click",this._onClick)},_onClick:function l(t){this._logContextEvent(t),this.triggerEvent(n.EVENT_BUTTON_CLICK,t,!0)},_onChange:function h(t){this.triggerEvent(n.EVENT_CHANGE,t,!0),this.refreshLayout()},refreshLayout:function d(){this.updateOptionsAndDom({state_checked:this.input.checked})},updateDom:function c(){this.options.fancy&&this.$el.toggleClass(this.CssClassName.FANCY_SELECTED,this.options.state_checked)}});a.prototype.className="RadioButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(171);var a=o.extend({onContentReady:function r(){this.buttonModule=this.getChildById("button"),this.selectedValue=this.options.value,this.childListen(n.EVENT_BUTTON_CLICK,this.onChange),this.childListen(n.EVENT_CHANGE,this.onChange)},onChange:function l(t){var e=t.target,i=e.getCurrentLabel()||this.options.text;this.selectedValue=e.val()||this.options.value,this.buttonModule.setText(i),this.buttonModule.getDropdown().hide()},disable:function h(){this.buttonModule.disable()},enable:function d(){this.buttonModule.enable()}});a.prototype.className="SelectButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({CssClassName:{HIDDEN:"hidden"},events:{click:"_onClick"},enable:function r(){this.updateOptionsAndDom({state_isEnabled:!0})},onContentReady:function l(){this.options.state_isEnabled=!1},updateDom:function h(){this.$(".skipToContentContainer").toggleClass(this.CssClassName.HIDDEN,!this.options.state_isEnabled)},_onClick:function d(){this.triggerEvent(n.EVENT_SKIP_TO_CONTENT,null,!0)}});a.prototype.className="SkipToContent",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(29),r=n.extend({onClick:function l(t){return this.options.ga_category&&a.trackEvent(this.options.ga_category,o.GA_ACTION_CLICK),this._logContextEvent(t),t.stopPropagation(),t.preventDefault(),this.isSelected()?!1:void n.prototype.onClick.call(this,t)}});r.prototype.className="TabButton",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(18),l=a.extend({events:{"click .tab":"onTabSelected"},CssClassName:{ACTIVE:"active",DISABLED:"disabled"},onCreated:function h(){this.childListen(s.EVENT_DATA_EMPTY,this._onNoData)},onContentReady:function d(){a.prototype.onContentReady.apply(this,arguments),this.modulePromises={};var t=this.getChildById("selectedTabModule"),e=this.options.selected_tab_index||0;t&&(this.modulePromises[e]=Promise.resolve(t),this.setSelectedTabIndex(e)),this.options.prefetch&&this.prefetchTabsContent()},getTabCount:function c(){return this.options.tabs.length},prefetchTabsContent:function u(){for(var t=function(t){this.insertChild(t,this.$(".content")),t.render().then(function(){t.hide()})}.bind(this),e=0;e<this.getTabCount();e++)if(!this.modulePromises[e]){var i=this.options.tabs[e].content_module,n=r.load(i);this.modulePromises[e]=n,n.then(t)}},setSelectedTabIndex:function p(t){if(this.modulePromises[t])return this._setNewIndex(t),this.modulePromises[this.currentIndex].then(function(t){t.show()});var e=this.options.tabs[t].content_module,i=r.load(e);return this.modulePromises[t]=i,i.then(function(e){this.insertChild(e,this.$(".content")),this._setNewIndex(t),e.showLoading(),e.render().then(function(){e.hideLoading(),t===this.currentIndex?e.show():e.hide()}.bind(this))}.bind(this))},_setNewIndex:function _(t){void 0!==this.currentIndex&&this.modulePromises[this.currentIndex].then(function(t){t.hide()}),this._setTabActive(t)},_onNoData:function g(t){var e=t.data;void 0!==this.currentIndex&&(this.currentIndex=0);var i=this._getTabLabels();return i.eq(this.currentIndex).addClass(this.CssClassName.DISABLED),this.setSelectedTabIndex(e)},onTabSelected:function m(t){if(!n(t.target).hasClass(this.CssClassName.DISABLED)){var e=t.currentTarget.getAttribute("data-tab-index");this.setSelectedTabIndex(e)}},_setTabActive:function f(t){this.currentIndex=t;var e=this._getTabLabels();e.removeClass(this.CssClassName.ACTIVE),e.eq(t).addClass(this.CssClassName.ACTIVE),this.modulePromises[t].then(function(e){e.triggerEvent(s.EVENT_TAB_SELECTED,t,!1)})},_getTabLabels:function C(){return this.$(".header > .tab > div")}});l.prototype.className="Tabs",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="TextContainer",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(21),a=i(265),r=i(11),l=i(154),h=i(266),d=i(281),c=i(8),u=i(206),p=i(40),_=i(152),g=i(35),m=i(18),f=i(19),C=i(72),E=i(20),v=i(46),I=i(27);i(282),i(284),i(295),i(296),i(301),i(302),i(303),i(305),i(308),i(309);var T=a.extend({events:{dragenter:"_onDragEnter",dragover:"_eventPreventDefault",dragdrop:"_eventPreventDefault",drop:"_eventPreventDefault",dragleave:"_eventPreventDefault"},CssClassName:n.extend(a.prototype.CssClassName,{INVISIBLE:"invisible",NO_SHOW:"doNotShow",SHOW_CLOSEUP:"showingCloseup",SHOW_PLACE_BOARD:"showingPlaceBoard",HAS_SPELL_CHECK:"hasSpellCheck"}),onCreated:function N(){a.prototype.onCreated.apply(this),this.hasReturnInterstitial=!1,this.childListen(r.EVENT_CLEAR_HAS_RETURN_INTERSTITIAL,this._onClearHasReturnInterstitial),this.childListen(r.EVENT_SHOW_RETURN_INTERSTITIAL,this.returnInterstitialExperiment),this.childListen(r.EVENT_SKIP_TO_CONTENT,this.skipToContent);var t={};t[r.PUBSUB_TOPIC_SEARCH_SPELL_CHECK_UPDATED]=this._updateSpellCheckClass,this.pubsubSubscribe(r.PUBSUB_CHANNEL_SEARCH_AUTOCORRECT,t)},onAddedToDom:function S(){a.prototype.onAddedToDom.apply(this,arguments);var t=this.extraData?this.extraData.deepLinkTracking:null;h.setup(p.instance.ios_deep_link,"pinterest://",t,p.instance.deep_link_action),this.childListen(r.EVENT_APPEND_CLONED_PIN,this._onAppendClonedPin)},_onClearHasReturnInterstitial:function b(t){this.hasReturnInterstitial=!1},_onAppendClonedPin:function y(t){var e=t.data,i=e.getContent();i.appendTo(this.$el),e.clampDescription&&e.clampDescription()},_adjustScrollToTopPositionIfNeeded:function P(){var t=this._getCurrentMainModule();if(t){var e="Closeup"===t.className;this.$el.toggleClass(this.CssClassName.SHOW_CLOSEUP,e)}},_scrollMainModuleIfNeeded:function B(){var t=this._getCurrentMainModule();t&&t.initScroll()},isContentOnly:function A(){return"content_only"===this.options.view_type},returnInterstitialExperiment:function R(t){this.hasReturnInterstitial||(this.userAgentPlatform===r.USER_AGENT_PLATFORM_ANDROID&&"fromSeamless"===t?(setTimeout(this.showInterstitial.bind(this,"image_v2",t),1500),this.hasReturnInterstitial=!0,this.hideInterstitialHeader()):this.userAgentPlatform===r.USER_AGENT_PLATFORM_IOS&&(setTimeout(this.showInterstitial.bind(this,"image"),3e3),this.hasReturnInterstitial=!0,this.hideInterstitialHeader()))},onChildNavigate:function w(t){var e=t.data.url,i=p.instance.user_agent_can_use_native_app,n=v.isAuthenticated(),s;return this._shouldDeepLinkInsteadOfNavigate(n,i,this.userAgentPlatform,e)&&(s=E.instance.resolve(e)),s&&s.extraContent?p.instance.user_agent_is_ios_9_2_or_above?void h.navigateToDeepLink(this.userAgentPlatform,s.extraContent):(this.seamlessOverlay=this.getChildByModuleName("Nags").getChildByModuleName("SeamlessOverlay"),this.seamlessOverlay.showOverlay(),void setTimeout(function(){I.trackRegisterAction("seamless."+this.appTypeString),h.navigateToDeepLink(this.userAgentPlatform,s.extraContent),this.seamlessOverlay.hideOverlay(),(p.instance.is_mobile_agent||p.instance.deep_link_action&&p.instance.is_tablet_agent)&&this.hideInterstitialHeader(),t.stopPropagation(),n||this.returnInterstitialExperiment("fromSeamless")}.bind(this),3e3)):(p.instance.is_mobile_agent&&this.hideInterstitialHeader(),void a.prototype.onChildNavigate.apply(this,arguments))},onContentReady:function O(){a.prototype.onContentReady.apply(this,arguments),this.userAgentPlatform=this.extraData.userAgentPlatform,p.instance.is_mobile_agent?this.userAgentPlatform===r.USER_AGENT_PLATFORM_IOS?this.appTypeString="iphone":this.userAgentPlatform===r.USER_AGENT_PLATFORM_ANDROID?this.appTypeString="android":this.appTypeString="mobile_other":this.appTypeString="desktop",this.logTraffic(),this.setupInterstitialAndAppRedirect(),p.instance.is_mobile_agent&&(this.CLOSEUP_NAME=null),d.request();var t=l.getConversationFromUrl();if(v.isAuthenticated()){var e=this.getChildById("toasts");u.setContainer(e)}!v.isAuthenticated()&&!t||v.isLimitedLogin()||this.isContentOnly()||(_.setContainer(this.getChildById("activeConversations")),v.isAuthenticated()?(_.loadInitialConversations(t),_.listenForConversations()):_.addConversationForUnauthUser(t));var i={};if(i[r.PUBSUB_TOPIC_WINDOW_VISIBILITY_FOCUS]=this.onWindowFocus,this.pubsubSubscribe(r.PUBSUB_CHANNEL_SITE,i),this.$('[role="main"]').length){var n=this.getChildById("skipToContent");n.enable()}this.childListen(r.EVENT_TYPEAHEAD_HIDDEN,this.onTypeaheadHidden),this.childListen(r.EVENT_TYPEAHEAD_SHOWN,this.onTypeaheadShown),this.childListen(r.EVENT_HEADER_INTERSTITIAL_DISMISSED,function(){this.$el.removeClass("hasInterstitialHeader")})},updateDom:function D(){this.$(".appContent").toggleClass(this.CssClassName.HAS_SPELL_CHECK,this.options.state_hasSpellCheck)},_updateSpellCheckClass:function x(t,e,i){this.updateOptionsAndDom({state_hasSpellCheck:i.hasSpellCheck})},onWindowFocus:function L(){if(v.isAuthenticated()){var t=c.create("BoardPickerBoardsResource",{filter:"all",field_set_key:"board_picker",allow_stale:!0});C.instance.callGet(t)}},onTypeaheadHidden:function k(t){t.data.enable_overlay&&this.$(".mainContainer .typeaheadOverlay").remove()},onTypeaheadShown:function U(t){t.data.enable_overlay&&0===this.$(".mainContainer .typeaheadOverlay").length&&this.$(".mainContainer").append('<div class="typeaheadOverlay" />')},logTraffic:function M(){if(!o.get(r.COOKIE_SESSION_FUNNEL_EVENT_LOGGED)){o.set(r.COOKIE_SESSION_FUNNEL_EVENT_LOGGED,"1",12);var t=document.referrer,e=document.domain||"unknown",i;i=t?t.indexOf("/t.co/")>-1?"twitter":t.indexOf("google.")>-1?"google":t.indexOf("bing.")>-1?"bing":t.indexOf("facebook.")>-1?"facebook":"other":"direct";var n=navigator.userAgent.toLowerCase(),s=null;n&&(n.indexOf("googlebot")>-1||n.indexOf("google web preview")>-1||n.indexOf("google page speed insights")>-1?s="google_bot":n.indexOf("msnbot")>-1||n.indexOf("bingbot")>-1?s="ms_bot":n.indexOf("applebot")>-1?s="apple_bot":n.indexOf("yahoo")>-1||n.indexOf("slurp")>-1?s="yahoo_bot":n.indexOf("yandex")>-1&&(s="yandex"));var a=this._getCurrentMainModule().className,l=v.isAuthenticated()?"auth":"unauth";I.trackRegisterAction("traffic."+this.appTypeString+"."+i+"."+a+"."+l),I.trackRegisterAction("traffic_subdomain."+e+"."+i+"."+a+"."+l),I.trackRegisterAction("traffic_subdomain."+e+"."+this.appTypeString+"."+i+"."+a+"."+l),s&&I.trackRegisterAction("traffic_bot."+s+"."+a)}},hideInterstitialHeader:function F(){this.$(".AppInterstitial").fadeOut(),this.$el.removeClass("hasInterstitialHeader")},onScroll:function $(){var t=this.getScrollableElement().scrollTop();if(!(0>t)){var e=t>1e3;e^this._isShowingOverlay&&(this._isShowingOverlay=e,this.toggleSignupOverlay())}},toggleSignupOverlay:function H(){this.$(".Header").toggleClass(this.CssClassName.INVISIBLE),this.$(".BoardHeader").toggleClass(this.CssClassName.INVISIBLE),this.$(".UserProfileHeader").toggleClass(this.CssClassName.INVISIBLE),this.$(".inspiredWallOverlay").toggleClass(this.CssClassName.NO_SHOW)},hideHeader:function V(){this.$el.removeClass("full"),this.$(".Header").addClass(this.CssClassName.INVISIBLE)},closeSignupOverlay:function G(){this.toggleSignupOverlay()},setupInterstitialAndAppRedirect:function W(){(p.instance.is_mobile_agent||p.instance.is_tablet_agent)&&(h.setup(p.instance.deep_link,p.instance.deep_link_default,p.instance.deep_link_tracking,p.instance.deep_link_action),navigator.userAgent.indexOf("FBAN/FBIOS")<0&&p.instance.deep_link_action&&h.redirectToApp(this.userAgentPlatform,"branchAutoDeeplink"))},_shouldDeepLinkInsteadOfNavigate:function K(t,e,i,n){if(!e)return!1;if(i===r.USER_AGENT_PLATFORM_IPAD)return!1;var s=/^\/(join|login)\//;return n&&s.test(n)?!1:t?o.get(r.GEN.CookieName.HAS_BEEN_AUTH_REDIRECTED_TO_APP_ON_NAVIGATE)?!1:(o.set(r.GEN.CookieName.HAS_BEEN_AUTH_REDIRECTED_TO_APP_ON_NAVIGATE,"true",24),!0):!0},showInterstitial:function j(t,e){var i=this.extraData.isTablet||!1,n={name:"AppInterstitial",options:{interstitial_data:this.extraData.appInterstitialData,is_tablet:i,type:t,source:e,on_home_page:"/"===window.location.pathname}};m.load(n).then(function(t){this._modalManager.createAndShowModal(t,{can_dismiss:!1,modal_style:"fullScreen"})}.bind(this))},_getScrollToTopModule:function Y(){var t=this.getChildById("scrollToTop");return t},updateScrollWatchers:function q(t){var e=this._getScrollToTopModule();e&&e.setScroller(t.getScrollableElement())},_eventPreventDefault:function z(t){t.preventDefault()},_checkDataTransferTypes:function X(t,e){return n.every(t,function(t){return n.contains(e,t)})},_onDragEnter:function Q(t){t.preventDefault();var e=t.originalEvent.dataTransfer.types;if(e){var i=n.values(e),s=this._checkDataTransferTypes(["text/uri-list","text/html"],i),o=this._checkDataTransferTypes(["Files"],i)&&!!t.originalEvent.dataTransfer.files;if((s||o)&&(!this.dragOverlayModule||this.dragOverlayModule.destroyed)&&v&&v.isAuthenticated()){var a={name:"PinDragAndDrop",options:{file_drop:o,image_drop:s}};m.load(a).then(function(t){this.dragOverlayModule=t,t.render().then(function(){this.appendChild(t)}.bind(this))}.bind(this))}}},getHeader:function Z(){return this.getChildById("header")},skipToContent:function J(){this.$('[role="main"]').attr("tabindex",-1).on("blur focusout",function(){s(this).removeAttr("tabindex")}).focus()}});g.wrap(T.prototype,["initialize","onAddedToDom","onContentReady"]),T.prototype.className="App",t.exports=f.register(T)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(21),a=i(22),r=i(233),l=i(11),h=i(266),d=i(57),c=i(195),u=i(197),p=i(50),_=i(41),g=i(30),m=i(8),f=i(267),C=i(205),E=i(203),v=i(126),I=i(28),T=i(254),N=i(40),S=i(80),b=i(81),y=i(35),P=i(59),B=i(29),A=i(18),R=i(19),w=i(269),O=i(23),D=i(20),x=i(131),L=i(34),k=i(42),U=i(31),M=i(46),F=i(27);i(270),i(271),i(273);var $=500,H={REPLACE:0,REPLACE_TOP:1,APPEND:2,CLOSE:3,IGNORE:4},V=p.extend({MAIN_MODULE_ID:"mainModule",CLOSEUP_NAME:"Closeup",AGGREGATED_FEED_NAME:"AggregatedActivityFeed",CssClassName:{HAS_KLP_BAR:"hasKLPBar"},onCreated:function G(){if(!M.isAuthenticated()){if(M.attemptLogin(),"AU"===N.instance.country||N.instance.is_internal_ip){var t=P.instance.v2ActivateExperiment("ao_dismissible_signup2");x.dismissible="string"==typeof t&&(0===t.indexOf("enabled")||0===t.indexOf("rollout"))}else"NZ"===N.instance.country&&P.instance.v2ActivateExperiment("ao_nz_comparison");var e=U.getQueryStringParams();e.nogw&&(x.dismissible=!1,o.set(l.COOKIE_GIFT_WRAP_DISABLED,"true",2))}this.backgroundModule=null,this.bottomBackgroundModule=null,this.canUpdatePageInfo=!1,this.browser=r.getBrowser();var i={};i[l.PUBSUB_TOPIC_WINDOW_LOCATION_CHANGE]=this._onWindowLocationChange,i[l.PUBSUB_TOPIC_APPEND_TO_MAIN_MODULE]=this._appendChildToMainModule,this.pubsubSubscribe(l.PUBSUB_CHANNEL_SITE,i);var n={};n[l.PUBSUB_TOPIC_KLP_BAR_HIDDEN]=this.removeHasKLPBarClass,n[l.PUBSUB_TOPIC_KLP_BAR_SHOWN]=this.addHasKLPBarClass,this.pubsubSubscribe(l.PUBSUB_CHANNEL_KLP_BAR,n),this._modalManager=null,this.router=D.instance},onAddedToDom:function W(){this.router.start(),a.setup(N.instance.app_version),this.childListen(l.EVENT_NAVIGATE,this.onChildNavigate),this.childListen(l.EVENT_SCROLL_TO_ELEMENT,this._onChildScrollToElement),this.listen(this.router,l.EVENT_ROUTE_MATCHED,this.onRouteMatched),this.listen(this.router,l.EVENT_ROUTE_NO_MATCH,this.onRouteNoMatch),this.childListen(l.EVENT_REQUIRES_AUTHENTICATION,this.onChildEventRequiresAuthentication),this.childListen(l.EVENT_CLOSE,this._onChildClose);var t={};t[l.PUBSUB_TOPIC_PAGE_INFO]=this.onPageInfoChange,this.pubsubSubscribe(l.PUBSUB_CHANNEL_SITE,t),this.childListen(l.EVENT_MODAL,this._onChildModal),f.init()},onChildAdded:function K(t){this._adjustScrollToTopPositionIfNeeded()},onChildEventRequiresAuthentication:function j(t){var e=t.data.authRedirectUrl;e&&this.navigate(t.data.authRedirectUrl)},_onChildClose:function Y(t){this.router.getHistoryManager().closeCurrentModule()},_onChildScrollToElement:function q(t){var e=t.data,i=e.$el,n={scrollOffset:e.scrollOffset,callback:e.callback};this._scrollToElement(i,n)},_onWindowLocationChange:function z(){this.router.setStatus(D.NavStatus.READY)},_getCurrentMainModule:function X(){var t=this.getChildById(this.MAIN_MODULE_ID);return t?t:this.children[this.children.length-1]},debugGetCurrentMainModuleName:function Q(){return this._getCurrentMainModule().className},_scrollToElement:function Z(t,e){var i=this._getCurrentMainModule(),n=t.positionAncestor(i.getScrollableElement()).top,s=F.normalizeScroller(i.getScrollableElement()),o=0===e.scrollOffset?0:e.scrollOffset||l.SCROLL_TO_ELEMENT_OFFSET,a={newScrollOffset:Math.max(n-o,0),$scroller:s,callback:e.callback};F.scrollToTop(a)},setUpContextLogging:function J(){var t=this._getCurrentMainModule();if(!t.getHasError()){var e=window.location.pathname+window.location.search,i=this.router.resolve(e);
if(i){var n=i.extraContent.log;if(n){var s=S.fromPlainObject(n);s.setEventType(l.GEN.EventType.VIEW),s.setRequestIdentifier(g.PAGE_LOAD_REQUEST_IDENTIFIER);var o=t.getLoggingObjectIdStr();o&&s.setObjectIdStr(o);var a=t.getCloseupRichTypes();a&&s.setCloseupRichTypes(a),b.getInstance().addEvent(s)}}else this.log.error("Router couldn't resolve url for context logging",{url:e})}},onRemovedFromDom:function tt(){this._removeListeners()},onRouteMatched:function et(t){var e;this.userAgentPlatform&&t.extraContent&&(e=h.getLinkForUserAgent(this.extraData.userAgent,t.extraContent)),O.instance.publish(l.PUBSUB_CHANNEL_SITE,l.PUBSUB_TOPIC_DEEP_LINK,e);var i=t.module,n=t.options,s=t.resource&&t.resource.name?m.createFromPlainObject(t.resource):null;this.removeAllModals();var o=this._getCurrentMainModule();t.navigateData.currentModule=o,A.getConstructor(i).then(function(e){var i=this.router.getHistoryManager().getModule(e,t.navigateData);if(!this._getCurrentMainModule())return void window.location.reload();var o=null,a=t.extraContent.log;a?(a.event_type=l.GEN.EventType.VIEW,o=S.fromPlainObject(a)):b.getInstance().clearContext(),O.instance.publish(l.PUBSUB_CHANNEL_NAVIGATE,l.PUBSUB_TOPIC_NAVIGATE_STARTED),this.updateMainModule(i,n,s,t,o).then(void 0,function(t){this.router.setStatus(D.NavStatus.CANCELED)}.bind(this)),M.isAuthenticated()||F.trackRegisterAction("unauth_navigate."+i.module.className)}.bind(this));var a=this.router.getHistoryManager().getPageInfo();a&&this.setPageInfo(a),this.canUpdatePageInfo=!a},onRouteNoMatch:function it(t){window.location.reload()},onPageInfoChange:function nt(t,e,i){this.canUpdatePageInfo&&(this.router.getHistoryManager().setPageInfo(i),this.setPageInfo(i),this.canUpdatePageInfo=!1)},setPageInfo:function st(t){t.title&&s(document).attr("title",t.title),s("head meta[data-app]").remove();var e=[];n.each(t.meta,function(t,i){e.push(s("<meta>").prop({name:i,property:i,content:t,"data-app":1}))}),s("head").append(e)},startModuleTransition:function ot(t){this.userAgentPlatform===l.USER_AGENT_PLATFORM_ANDROID||this.browser===l.BrowserType.SAFARI?t.hideModule():t.fadeOut(),clearTimeout(this._loaderTimeout),this._loaderTimeout=L.setTimeout(function(){this.loadingShown=!0,this.showLoading()}.bind(this),$,"App loader")},stopModuleTransition:function at(t){clearTimeout(this._loaderTimeout),this.userAgentPlatform===l.USER_AGENT_PLATFORM_ANDROID||this.browser===l.BrowserType.SAFARI?t.showModule():t.fadeIn(),this.loadingShown&&(this.hideLoading(),this.loadingShown=!1)},updateMainModule:function rt(t,e,i,n,o){return new Promise(function(a,r){var h=function(t,e,i){this.pubsubUnsubscribe(l.PUBSUB_CHANNEL_NAVIGATE),this.router.getStatus()!==D.NavStatus.READY&&r()}.bind(this),d={};d[l.PUBSUB_TOPIC_NAVIGATE_STARTED]=h,this.pubsubSubscribe(l.PUBSUB_CHANNEL_NAVIGATE,d);var c=n.navigateData,u=t.module,p=t.backgroundModule,_=this._getCurrentMainModule();_.saveExtraState(!0),this.log.debug("Current:",_.className,"New:",u.className);var g=this._getNextAction(_,u,p,c),m=g===H.REPLACE&&_.className!==this.CLOSEUP_NAME&&u.className!==this.CLOSEUP_NAME;this.router.setStatus(D.NavStatus.TRANSITIONING),m&&this.startModuleTransition(_),u.clearFades();var f=this._getCanClose(_,t,g);null!==f&&(e.can_close=f,this._isAggregatedOverlayNavigation(_,u,p)?e.origin_location=u.options.origin_location||c.fromHistoryUid:e.origin_location=_.options.origin_location||c.fromHistoryUid||u.options.origin_location,e.source_data=_.options.source_data||this.getChildInfoByModuleName("GridItems"));var C=null===f||f===!1;if(T.setScrolling(C),o){var E=function(t,e,i){var n=i;o.setRequestIdentifier(n),this.pubsubUnsubscribe(l.PUBSUB_CHANNEL_REQUEST)}.bind(this);d={},d[l.PUBSUB_TOPIC_REQUEST_IDENTIFIER]=E,this.pubsubSubscribe(l.PUBSUB_CHANNEL_REQUEST,d)}var v=function(){if(m&&this.stopModuleTransition(u),g!==H.IGNORE&&g!==H.CLOSE&&u.showModule(),this.updateScrollWatchers(u),o&&!u.getHasError()){var t=u.getLoggingObjectIdStr();t&&o.setObjectIdStr(t);var e=u.getCloseupRichTypes();if(e&&o.setCloseupRichTypes(e),n.extraContent.perf_log){var i=k.end(n.module,"NavigateToRender");i&&o.updateAuxData({interaction_wait:i.elapsedTime})}b.getInstance().addEvent(o),O.instance.clearChannel(l.PUBSUB_CHANNEL_REQUEST)}this.router.setStatus(D.NavStatus.READY)}.bind(this);return u.errorStrategy=l.ErrorStrategy.SHOW,u.setAsMainModule(e,i,c).then(function(){return this.router.getStatus()===D.NavStatus.CANCELED?Promise.reject():(g!==H.IGNORE&&g!==H.CLOSE&&u.hideModule(),this._performNextAction(g,_,t,c),O.instance.publish(l.PUBSUB_CHANNEL_MAIN_MODULE,l.PUBSUB_TOPIC_MAIN_MODULE_NEW,this._getCurrentMainModule()),this._adjustScrollToTopPositionIfNeeded(),this._scrollMainModuleIfNeeded(),void a())}.bind(this),function(t){this.router.getHistoryManager().cancelNavigation(),r(t)}).fin(function(){v(),!M.isAuthenticated()&&c.fromNavigate&&x.modalsEnabled&&(s(".Pulser").remove(),s(".UserEducationGuideTooltip").remove(),x.showInlineSignupModal(u,u.resource))})}.bind(this))},_hideSignupModal:function lt(){x.disableModals()},_getNextAction:function ht(t,e,i,n){var s=null;return s=t===e?H.IGNORE:e.className!==this.CLOSEUP_NAME?t.className===this.CLOSEUP_NAME&&t.options.can_close&&this.backgroundModule&&e===this.backgroundModule?H.CLOSE:H.REPLACE:n.fromNavigate?t.className===this.CLOSEUP_NAME?t.options.can_close?H.REPLACE_TOP:H.REPLACE:H.APPEND:t===i&&e.className===this.CLOSEUP_NAME?H.APPEND:H.REPLACE,e.className===this.AGGREGATED_FEED_NAME&&(s=t.className===this.CLOSEUP_NAME?H.APPEND:H.REPLACE),t.className===this.AGGREGATED_FEED_NAME&&e.className===this.CLOSEUP_NAME&&(s=H.REPLACE),s},_getCanClose:function dt(t,e,i){var n=e.module,s=e.backgroundModule;if(!this._isViewOverlay(n.className))return null;var o=t.className===this.CLOSEUP_NAME,a=!!t.options.can_close,r=e.module.className===this.AGGREGATED_FEED_NAME;switch(i){case H.REPLACE:return!!s;case H.REPLACE_TOP:return a;case H.APPEND:return!o||a||r;case H.IGNORE:return a}return null},_isViewOverlay:function ct(t){return t===this.CLOSEUP_NAME||t===this.AGGREGATED_FEED_NAME},_isAggregatedBackNavigation:function ut(t,e,i){return this.bottomBackgroundModule&&!this._isViewOverlay(t.className)&&e.className===this.AGGREGATED_FEED_NAME&&i&&i.className===this.CLOSEUP_NAME},_isAggregatedOverlayNavigation:function pt(t,e,i){var n=e.className===this.AGGREGATED_FEED_NAME&&t.className===this.CLOSEUP_NAME,s=t.className===this.AGGREGATED_FEED_NAME&&e.className===this.CLOSEUP_NAME;return n||s||this._isAggregatedBackNavigation(t,e,i)},_performNextAction:function _t(t,e,i,n){var o=i.module,a=i.backgroundModule,r=o.$el,l=t!==H.IGNORE,h=this.getChildById("header"),d=0,c=this._isAggregatedBackNavigation(e,o,a);if(h&&(d=h.getHeight()),t===H.IGNORE)this.backgroundModule&&this.router.getHistoryManager().updateBackgroundModule(this.backgroundModule,n);else if(t===H.CLOSE)this.backgroundModule=null,this.bottomBackgroundModule=null,e.detachElement(),this.removeChildId(e);else if(t===H.REPLACE){this.backgroundModule!==a&&(this.backgroundModule&&(this.backgroundModule.detachElement(),this.backgroundModule=null),this.bottomBackgroundModule&&this.bottomBackgroundModule.detachElement(),a&&(a===e||c||(a.appendToElement(this.$(".mainContainer")),this.addChild(a)),this.backgroundModule=a,c&&(this.bottomBackgroundModule&&a.can_close?(this.bottomBackgroundModule.appendToElement(this.$(".mainContainer")),this.addChild(this.bottomBackgroundModule),a.appendToElement(this.$(".appendedContainer")),this.addChild(a)):(a.appendToElement(this.$(".appendedContainer")),this.addChild(a))))),e!==a&&(this.removeChildId(e),e.detachElement()),this.removeChildId(e),r.css("min-height",v.height-d);var u=s(this.backgroundModule?".appendedContainer":".mainContainer");u.append(r),this.addChild(o)}else t===H.REPLACE_TOP?(e.detachElement(),r.css("min-height",v.height-d),s(".appendedContainer").append(r),this.addChild(o),this.router.getHistoryManager().updateBackgroundModule(this.backgroundModule,n)):t===H.APPEND&&(this.backgroundModule=e,this._isViewOverlay(e.className)||o.className!==this.CLOSEUP_NAME||(this.bottomBackgroundModule=e),this.removeChildId(e),r.css("min-height",v.height-d),s(".appendedContainer").append(r),this.addChild(o),this.router.getHistoryManager().updateBackgroundModule(this.backgroundModule,n));(l||this._forceRefreshRequested(n))&&(this.setChildId(o,this.MAIN_MODULE_ID),o.restoreExtraState(!0))},onContentReady:function gt(){this._modalManager=this.getChildById("modalManager"),this.setUpContextLogging();var t=this._getCurrentMainModule();this.initModule=t,B.trackPageview(t.className),n.defer(this._startTutorials.bind(this)),O.instance.publish(l.PUBSUB_CHANNEL_MAIN_MODULE,l.PUBSUB_TOPIC_MAIN_MODULE_NEW,t),this._startCampbellDrawerNUX(),this.setChildId(t,this.MAIN_MODULE_ID),this.router.getHistoryManager().start(t),this.router.getHistoryManager().setPageInfo(w.get()),this.setPageInfo(w.get()),this.updateScrollWatchers(t),this._setDevicePixelRatioCookie(),this._adjustScrollToTopPositionIfNeeded(),this._scrollMainModuleIfNeeded(),O.instance.publish(l.PUBSUB_CHANNEL_MAIN_MODULE,l.PUBSUB_TOPIC_APPBASE_CONTENT_READY,t)},_startCampbellDrawerNUX:function mt(){var t=l.GEN.Placement.CAMPBELL_SIDE_NAV,e=l.GEN.Experience.CAMPBELL_SIDE_NAV_USER_ED;d.instance.isPlacedExperience(t,e)&&O.instance.publish(l.PUBSUB_CHANNEL_CAMPBELL,l.PUBSUB_TOPIC_DRAWER_SIDE_NAV_SHOW,null)},_setDevicePixelRatioCookie:function ft(){var t=(window.devicePixelRatio||1)+"";o.set(l.COOKIE_DEVICE_PIXEL_RATIO,t)},onChildNavigate:function Ct(t){this._adjustScrollToTopPositionIfNeeded();var e=t.data.url;this.log.debug("App got navigate event from child",t.target,"for url:",e);var i=new _;i.evt=t,i.reuseLast=!!t.data.handled,D.instance.getHistoryManager().populateNavigateData(i),u.navigate(e,i),t.stopPropagation()},_adjustScrollToTopPositionIfNeeded:function Et(){},_scrollMainModuleIfNeeded:function vt(){},_startTutorials:function It(){C.instance().resumeTutorial(),c.instance().startTutorial()},isTutorialActive:function Tt(){return E.isTutorialActive()},_appendChildToMainModule:function Nt(t,e,i){this._getCurrentMainModule().appendChild(i.module)},updateScrollWatchers:function St(t){},addHasKLPBarClass:function bt(){var t=this.CssClassName.HAS_KLP_BAR;this.$(".appContent").addClass(t),this.$(".message.messageUnauth").addClass(t)},removeHasKLPBarClass:function yt(){this.$(".appContent").removeClass(this.CssClassName.HAS_KLP_BAR),this.$(".message.messageUnauth").removeClass(this.CssClassName.HAS_KLP_BAR)},updateNavigationBar:function Pt(){var t=I.instance.getChildByModuleName("Nags");t&&t.render();var e=I.instance.getChildById("header");e&&(delete e.options.class_name,e.render()),this._showFooterButtons()},_showFooterButtons:function Bt(){var t=I.instance.getChildById("footerButtons");t&&t.setVisible(!0)},_onChildModal:function At(t){this.log.debug("Got modal event from child",t.target,"for module:",t.data.module),t.stopPropagation(),this._modalManager.createAndShowModal(t.data.module,t.data.showModalOptions||{},t.target)},_isTutorialActive:function Rt(){return E.isTutorialActive()},removeAllModals:function wt(){this._isTutorialActive()||this._modalManager.removeAllModals(!0)},debugNumGridItems:function Ot(){for(var t=[],e=[this],i;e.length>0;)i=e.pop(),"GridItems"===i.className&&t.push(i),e=e.concat(i.children);return n.each(t,function(t,e){for(var i=t.parent,n=t.className+" has "+t.children.length+" children";i;)n=i.className+"->"+n,i=i.parent;this.log.debug(e+1+": "+n)}.bind(this)),0===t.length&&this.log.debug("There are no grids in the page."),":)"}});y.wrap(V.prototype,["_onChildModal"]),V.prototype.className="AppBase",t.exports=R.register(V)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(40),r=i(80),l=i(81),h=i(59),d=i(23),c=i(31),u=i(27),p=function g(){this.tracking=null,this.url=null};n.extend(p.prototype,{blacklist:/^\/(join|login)\//,deeplinkUrls:{yozio:{interstitialOpenInApp:"https://r.yozio.com/lp.c.z",authUpsellOpenInApp:"https://r.yozio.com/lp.c.B",onNavigateOpenInApp:"https://r.yozio.com/lp.c.W",autoRedirect:"https://r.yozio.com/lp.c.C","default":"https://r.yozio.com/lp.c.D"},branch:{interstitialOpenInApp:"https://bnc.lt/interstitial",authUpsellOpenInApp:"https://bnc.lt/auth-upsell",onNavigateOpenInApp:"https://bnc.lt/unauth-navigate",autoRedirect:"https://bnc.lt/auto-redirect","default":"https://bnc.lt/mweb-default"}},redirectToApp:function m(t,e){if(!window.location||!this.blacklist.test(window.location.pathname)){var i="branch",s=this.getTrackedUrl();if(s){e=e||"default";var o=this.deeplinkUrls[i][e];u.trackRegisterAction("mweb_launch_branch_deeplinking");var r={$deeplink_path:s.substring(s.indexOf("://")+3),install_id:a.instance.unauth_id},l=c.getEntryUrl();if(l){var h=l.indexOf("?");h>=0&&n.extend(r,c.getQueryStringParams(l.substring(h)))}return"branchAutoDeeplink"===e?void this.branchSendToAppOnLoad(this.deeplinkUrls[i].autoRedirect,r):void this.branchSendToAppOrStoreOnClick(o,r)}}},branchCraftUrl:function f(t,e){var i=t+"?";if(e)for(var n in e)e.hasOwnProperty(n)&&(i+=encodeURIComponent(n)+"="+encodeURIComponent(e[n])+"&");return this._base_url=i,i},branchAddScript:function C(t){t+="&js_embed=true";var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=t,document.getElementsByTagName("head")[0].appendChild(e)},branchSendToAppOnLoad:function E(t,e){var i=this.branchCraftUrl(t,e);i+="passive_load=true",this.branchAddScript(i)},branchSendToAppOrStoreOnClick:function v(t,e){if(t){var i=h.instance.v2ActivateExperiment("deeplink_decider");if("enabled"===i||"employees"===i){var n=navigator.userAgent;if((n.indexOf("iPad")>-1||n.indexOf("iPhone")>-1||n.indexOf("iPod")>-1)&&n.indexOf("OS 9")>-1)window.location=this.branchCraftUrl("https://bnc.lt/a/key_live_eifqPbvhIRnKEb1T0MSFpipgsCenSDRu",e);else{var s=this.branchCraftUrl(t,e);s+="passive_load=false",this.branchAddScript(s)}}else{var o=this.branchCraftUrl(t,e);o+="passive_load=true",this.branchAddScript(o),setTimeout(function(){"function"==typeof window.__branchRedirectToStore?window.__branchRedirectToStore():this._base_url&&(window.location=this._base_url)}.bind(this),500)}}else"function"==typeof window.__branchRedirectToStore?window.__branchRedirectToStore():this._base_url&&(window.location=this._base_url)},updateUrl:function I(t){this.url=t||this.url},setTracking:function T(t){this.tracking=t},setup:function N(t,e,i,n){this.updateUrl(t||e),this.setTracking(i),d.instance.subscribe(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_DEEP_LINK,function(t,e,i){this.updateUrl(i)}.bind(this))},getTrackedUrl:function S(){return this.tracking?c.appendQueryString(this.url,this.tracking):this.url},redirectUsingIframe:function b(t,e){var i=document.createElement("IFRAME");if(t=t.indexOf("?")>-1?t.replace("?","?yozio_web_sdk_version=1.0.3&"):t+"?yozio_web_sdk_version=1.0.3",e){var n="";for(n in e)e.hasOwnProperty(n)&&(t+="&"+encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}i.setAttribute("src",t),i.style.display="none",document.body.appendChild(i)},attemptIOSDeepLink:function y(t,e){var i=this.getTrackedUrl(),n=encodeURI(i),o={yozio_iphone_deeplink_url:n,yozio_ipad_deeplink_url:n},a=t.substring(t.indexOf("?")),r=s.extend(o,c.getQueryStringParams(a));this.redirectUsingIframe(t,r)},attemptAndroidDeepLink:function P(t){var e=this.getTrackedUrl(),i=encodeURI(e),n={yozio_android_deeplink_url:i},o=t.substring(t.indexOf("?")),a=s.extend(n,c.getQueryStringParams(o));this.redirectUsingIframe(t,a)},redirectToDeepLink:function B(t,e,i){e===o.USER_AGENT_PLATFORM_IOS||e===o.USER_AGENT_PLATFORM_IPAD?this.attemptIOSDeepLink(t,i):e===o.USER_AGENT_PLATFORM_ANDROID&&this.attemptAndroidDeepLink(t)},logDownloadClick:function A(t,e,i,n){if(e||i){u.trackRegisterAction("mobile_app_nag_click");var s=r.fromEventType(o.GEN.EventType.REFERRER_APP_INSTALL_ATTEMPT);s.updateAuxData({utm_medium:n,utm_source:t}),l.getInstance().addEvent(s)}},getLinkForUserAgent:function R(t,e){var i;return t===o.USER_AGENT_PLATFORM_IOS||t===o.USER_AGENT_PLATFORM_IPAD?i=e.ios_deep_link:t===o.USER_AGENT_PLATFORM_ANDROID&&(i=e.android_deep_link),i&&e.deep_link_tracking&&(i=c.appendQueryString(i,e.deep_link_tracking)),i},navigateToDeepLink:function w(t,e){this.updateUrl(this.getLinkForUserAgent(t,e)),this.redirectToApp(t,"onNavigateOpenInApp")}});var _=new p;t.exports=_},function(t,e,i){"use strict";function n(){a.load({name:"LanguageDropdown",options:{selected:"Choose Language"},resource:{name:"LocalesResource"}}).then(function(t){c.id&&(t.onClick=function(t){var e=t.currentTarget,i=e.dataset.url.split("=")[1];l.create("UserSettingsResource",{locale:i}).callUpdate().fin(function(){window.location.reload()})}),r.get().createAndShowModal(t)})}function s(){c.id&&l.create("UserSessionResource",{disable_auth_failure_redirect:!0}).callDelete().then(function(){u.trackRegisterAction("logout"),d.sessionStorage.clear(),d.localStorage.clear(),c.logout().then(function(){u.navigateAfterLoginStatusChange("/?logged_out=true")})})}function o(t){h.init(),h.add("ctrl+l",n),h.add("ctrl+esc",s)}var a=i(18),r=i(135),l=i(8),h=i(268),d=i(54),c=i(46),u=i(27),p={init:o};t.exports=p},function(t,e,i){"use strict";function n(t){return l[t]||t>=48&&90>=t}function s(t){var e=t.which;return l[e]?l[e]:e>=40&&90>=e?String.fromCharCode(e).toLowerCase():void 0}var o=i(16),a=o.getLogger("Shortcuts"),r={back:8,enter:13,shift:16,ctrl:17,alt:18,esc:27,space:32,left:37,up:38,right:39,down:40},l=Object.keys(r).reduce(function(t,e){return t[r[e]]=e,t},{}),h={shortcuts:[],keyStrokes:[],init:function d(){document.addEventListener("keydown",this._handleKeyDown.bind(this)),document.addEventListener("keyup",this._handleKeyUp.bind(this))},add:function c(t,e){var i=t.split("+").every(function(t){return n(t.length>1?r[t]:t.toUpperCase().charCodeAt(0))});i?this.shortcuts.push({match:t,callback:e}):a.error("Invalid shortcut match: ",t)},_handleKeyUp:function u(t){var e=s(t);if(void 0!==e){var i=this.keyStrokes.indexOf(e);this.keyStrokes.splice(i,1)}},_handleKeyDown:function p(t){var e=s(t);if(void 0!==e){this.keyStrokes.push(e);var i=this.keyStrokes.join("+");this.shortcuts.forEach(function(t){t.match===i&&t.callback()})}}};t.exports=h},function(t,e){"use strict";var i=null,n={};n.set=function(t){i=t},n.get=function(){return i},t.exports=n},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(135),l=i(18),h=i(23),d=a.extend({onCreated:function c(){r.set(this),this._onKeyup=this._onKeyup.bind(this),this._animatedElement=null,this.childListen(s.EVENT_DESTROYED,this._onModalDestroyed),this.childListen(s.EVENT_DISMISS,this._onModalDismiss)},showModal:function u(t,e,i){e&&e.only_modal&&this.hasModals()||(t.moduleOpener=i,this.appendChild(t),t.show(e),1===this.children.length&&this._addListeners(),h.instance.publish(s.PUBSUB_CHANNEL_TUTORIAL,s.PUBSUB_TOPIC_VIEW_CHANGE,{moduleName:"Modal",action:s.ViewActions.OPEN}))},hasModals:function p(){return this.children.length>=1},removeModal:function _(t){t.animateOutAndDestroy()},removeAllModals:function g(t){this.children.forEach(function(e){var i=e;(t||i.getCanDismiss())&&i.destroy()})},createAndShowModalCorrect:function m(t,e,i){if(e&&e.only_modal&&this.hasModals())return Promise.resolve();var n={name:"Modal",options:e};return l.load(n).then(function(n){return n.render().then(function(){return n.setSubmodule(t).then(function(){return r.get().showModal(n,e,i),t.focus(),n})})})},createAndShowModal:function f(t,e,i){if(e&&e.only_modal&&this.hasModals())return Promise.resolve();var n={name:"Modal",options:e};return l.load(n).then(function(n){return n.render().then(function(){n.setSubmodule(t).then(function(){t.focus()}),this.showModal(n,e,i)}.bind(this))}.bind(this))},_onModalDismiss:function C(t){h.instance.publish(s.PUBSUB_CHANNEL_TUTORIAL,s.PUBSUB_TOPIC_VIEW_CHANGE,{moduleName:"Modal",action:s.ViewActions.CLOSE});var e=t.target.parent;this.removeModal(e)},_onModalDestroyed:function E(t){this.children.length||this._removeListeners()},_addListeners:function v(){n(document).on("keyup",this._onKeyup)},_removeListeners:function I(){n(document).off("keyup",this._onKeyup)},getTopModal:function T(){if(!this.hasModals())return null;var t=this.children[this.children.length-1];return t||null},removeTopModal:function N(){if(this.hasModals()){var t=this.children.pop();t.animateOutAndDestroy()}},removeModalWithAnimation:function S(t,e,i){return new Promise(function(s,o){var a={queue:!1};i&&(a.duration=i);var r=t.$(".modalContent"),l=r.offset(),h=n(e),d=h.offset(),c=h.height(),u=h.width();if(!d||!l||!r)return t.destroy(),void s(void 0);var p=d.left+u/2,_=d.top+c/2,g=[r.css({left:l.left,position:"fixed",top:l.top}).animate({left:p,top:_,height:"0px",width:"0px",opacity:"0"},a),t.$(".inModal").animate({height:"0px",opacity:"0",width:"0px"},a)];n.when.apply(n,g).always(function(){t.destroy(),s(void 0)})})},_onKeyup:function b(t){if(t.keyCode===s.KeyCode.ESCAPE){var e=this.getTopModal();e&&e.getCanDismiss()&&this.removeModal(e)}},setAnimatedModule:function y(t){this._animatedModule&&this._animatedModule.destroy(),this._animatedModule=t,t&&t.getContent().addClass("animatingToModal")},getAnimatedModule:function P(){return this._animatedModule}});d.prototype.className="ModalManager",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(272);var o=n.extend({});o.prototype.className="NagNoScript",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(29);i(116);var l=a.extend({events:{"click .nagClose":"onCloseButtonClick"},clickHandler:function h(){return null},onCloseButtonClick:function d(){this.destroy(),r.trackEvent("nag",s.GA_ACTION_CLICK_CLOSE,"type",this.extraData.type)},onContentReady:function c(){var t={};t[s.PUBSUB_TOPIC_NAG_UPDATED]=this.onActionSaved,this.pubsubSubscribe(s.PUBSUB_CHANNEL_CURRENT_USER,t),this.updateOptionsAndDom({state_message:this.data.message})},updateDom:function u(){this.$(".message").html(this.options.state_message)},onCreated:function p(){this.options.state_message=""},onActionSaved:function _(t,e,i){this.updateNagMessage(i)},updateNagMessage:function g(t){this.updateOptionsAndDom({state_message:t})},resourceCall:function m(t,e,i){var s=i.success,o=i.error;this.xhr=n.ajax({cache:!1,url:t,data:{},dataType:"json",type:"get"===e?"get":"post",success:s,error:o})}});l.prototype.className="NagBase",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(21),s=i(11),o=i(19),a=i(50),r=i(18),l=i(23),h=i(131),d=i(46);i(274),i(275),i(272),i(278),i(279),i(280);var c=a.extend({onContentReady:function u(){this.nagHeight=0,this.visible=!1;var t={};t[s.PUBSUB_TOPIC_NAG_STATE]=this.onNagStateChange,this.pubsubSubscribe(s.PUBSUB_CHANNEL_SITE,t);var e={};if(e[s.PUBSUB_TOPIC_MAIN_MODULE_NEW]=this.onMainModuleChange,this.pubsubSubscribe(s.PUBSUB_CHANNEL_MAIN_MODULE,e),this.nagHeight=this.$el.height(),this.notifyNag(!0),this.noGiftWrap=!1,this.parent){var i=this.parent.getChildByModuleName("BoardPage")||this.parent.getChildByModuleName("InterestFeedPage");this.noGiftWrap=i&&i.data&&i.data.no_gift_wrap}this.pickNagLogic()},onDestroyed:function p(){this.notifyNag(!1)},pickNagLogic:function _(){var t=!d.isAuthenticated(),e=this.options.main_module_name,i=this.options.referrer;"Closeup"===e&&t&&i.indexOf("facebook")>-1||"SentPin"===e&&t||this._loadUnauthBannerIfNeeded()},_loadUnauthBannerIfNeeded:function g(){var t=!1,e=n.get(s.COOKIE_SEND_PIN_UNAUTH_BROWSING_ALLOWANCE);(e&&parseInt(e,10)>0||n.get(s.COOKIE_GIFT_WRAP_HOLDOUT)||n.get(s.COOKIE_GIFT_WRAP_DISABLED))&&(t=!0),!this.extraData.show_banner||this.noGiftWrap||t||this.loadUnauthBanner()},onNagStateChange:function m(t,e,i){this.$el.toggle(i),i?this.notifyNag(!0):this.notifyNag(!1)},onMainModuleChange:function f(t,e,i){var n=i;this.options.main_module_name!==n.className&&(this.options.main_module_name=n.className,this.render())},loadUnauthBanner:function C(){r.load({name:"UnauthBanner",id:"unauthBanner",options:{dismissible:h.dismissible},resource:{name:"InspiredWallResource",options:{pick_story_from_url:!0}}}).then(function(t){var e=this.appendChild.bind(this,t);t.render().then(e)}.bind(this))},notifyNag:function E(t){t!==this.visible&&(l.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_NAG_TOGGLE,{height:this.nagHeight,visible:t}),this.visible=t)}});c.prototype.className="Nags",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({showOverlay:function a(){this.$el.fadeIn()},hideOverlay:function r(){this.$el.fadeOut()}});o.prototype.className="SeamlessOverlay",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(57),r=i(276),l=i(277),h=i(81),d=i(18);i(116);var c=r.extend({events:{"click .nagClose":"onCloseButtonClick","click .message a":"onMessageLinkClick"},onContentReady:function u(){r.prototype.onContentReady.call(this),this.options.type=s.GEN.ExperienceReverse[String(this.experienceId)];var t=this.data;t&&!n.isEmpty(t.triggerable_placed_exps)&&a.instance.triggerPlacedExperienceIds(t.triggerable_placed_exps)},onCloseButtonClick:function p(){switch(this.data.experience_id){case s.GEN.Experience.WEB_NOTIFICATION_NAG_CHROME_PUSH:case s.GEN.Experience.WEB_NAG_CHROME_PUSH:case s.GEN.Experience.WEB_NAG_SUBDOMAIN_REDIRECT:this.dismiss();break;case s.GEN.Experience.WEB_NAG_PARTNER_CONFIRM_WEBSITE:this.dismiss();break;default:this.destroy()}},onMessageLinkClick:function _(){switch(this.data.experience_id){case s.GEN.Experience.WEB_NOTIFICATION_NAG_CHROME_PUSH:case s.GEN.Experience.WEB_NAG_CHROME_PUSH:l.instance().subscribe(),this.complete(!1);break;case s.GEN.Experience.WEB_NAG_PARTNER_CONFIRM_WEBSITE:this._handleConfirmWebsiteClick()}},_handleConfirmWebsiteClick:function g(){this.showLoading();var t={name:"DomainVerify",options:{prepend_main_url:!0},resource:{name:"DomainVerifyResource",options:{}}};d.load(t).then(function(t){this.hideLoading(),this.complete();var e={show_api_error:!0};this.showInModal(t,e)}.bind(this)),h.getInstance().logCustomViewEvent(s.GEN.ViewType.SETTINGS,s.GEN.ViewParameterType.CONFIRM_WEBSITE_BY_NAG)},showLoading:function m(){}});c.prototype.className="ExperienceNag",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(57),a=i(50),r=i(29),l=i(34);i(116);var h="close",d=1e3,c=a.extend({onContentReady:function u(){this.childListen(n.EVENT_BUTTON_CLICK,this._onButtonClick),this.resource?(this.placementId=this.resource.options.placement_id,this.experienceId=this.resource.options.experience_id):(this.placementId=this.options.placement_id,this.experienceId=this.options.experience_id);var t=this.data;t&&(t.experience_id&&(this.experienceId=t.experience_id),t.id&&(this.placedExperienceId=t.id)),this.setExperienceViewed()},hide:function p(){this.fadeOut(function(){this.destroy()}.bind(this))},dismiss:function _(t){r.trackEvent("hero_helper_"+this.options.type,n.GA_ACTION_CLICK_CLOSE),this.dismissPlacedExperience(),t||this.hide()},complete:function g(t){r.trackEvent("hero_helper_"+this.options.type,n.GA_ACTION_CLICK_CONFIRM),this.completePlacedExperience(),t||(this.options.delay_hide?l.setTimeout(function(){this.hide()}.bind(this),d):this.hide())},setExperienceViewed:function m(){r.trackEvent("hero_helper_"+this.options.type,"viewed");var t=o.instance;this.placedExperienceId?t.viewPlacedExperienceId(this.placedExperienceId):t.viewPlacedExperience(this.placementId,this.experienceId)},completePlacedExperience:function f(){var t=o.instance;return this.placedExperienceId?t.completePlacedExperienceId(this.placedExperienceId):t.completePlacedExperience(this.placementId,this.experienceId)},dismissPlacedExperience:function C(){var t=o.instance;return this.placedExperienceId?t.dismissPlacedExperienceId(this.placedExperienceId):t.dismissPlacedExperience(this.placementId,this.experienceId)},onButtonClick:function E(t){},_onButtonClick:function v(t){this.onButtonClick(t);var e=t.target;e.id===h&&this.dismiss()}});c.prototype.className="HeroHelperBase",t.exports=s.register(c)},function(t,e,i){"use strict";var n=i(1),s=i(21),o=i(16),a=i(30),r=i(8),l=i(46),h=o.getLogger("WebPushManager"),d=function c(){};n.extend(d.prototype,{sendSubscriptionToServer:function u(t){h.debug("Calling: sendSubscriptionToServer"),s.set("cm_sub","allowed",8760,"/");var e=t.subscriptionId;if(!e){var i=t.endpoint.split("/");e=i[i.length-1]}var n={registration_id:e},o=r.create("WebPushDeviceResource",{});return o.callGet({showError:!1}).then(function(t){var i=t.resource_response.data;if(!(e in i)){var s=r.create("WebPushDeviceResource",n);return s.callCreate()}h.debug("subscription id already exists")})},subscribe:function p(){return navigator.serviceWorker.ready.then(function(t){t.pushManager.subscribe({userVisibleOnly:!0}).then(function(t){return this.sendSubscriptionToServer(t)}.bind(this),function(t){"denied"===Notification.permission?(s.set("cm_sub","denied",8760,"/"),h.debug("subscribe: Notification.permission === denied")):h.debug("subscribe: exception")})}.bind(this))},initializeState:function _(){if(!l.isAuthenticated())return h.debug("User not authenticated"),void s.set("cm_sub","denied",8760,"/");if(!("showNotification"in ServiceWorkerRegistration.prototype))return h.debug("Service doesn't support notification"),void s.set("cm_sub","denied",8760,"/");if("denied"===Notification.permission)return h.debug("User denied notification from Pinterest"),void s.set("cm_sub","denied",8760,"/");if(!("PushManager"in window))return h.debug("Push messaging is not supported"),void s.set("cm_sub","denied",8760,"/");var t=r.create("UserSettingsResource",{});return t.callGet({showError:!1}).then(function(t){var e=t.resource_response.data;if(e.web_push_notification)return navigator.serviceWorker.ready;throw s.set("cm_sub","denied",8760,"/"),new Error}).then(function(t){return t.pushManager.getSubscription()}).then(function(t){if(t)return this.sendSubscriptionToServer(t);throw s.set("cm_sub","none",8760,"/"),new Error}.bind(this),function(t){h.debug("initialiseState: exception: ",t)})}}),d.instance=function(){return d._instance||(d._instance=new d),d._instance},window.addEventListener("load",function(){"serviceWorker"in navigator&&window.location.hostname===a.canonicalMainDomain?navigator.serviceWorker.register("/sw.js").then(function(){d.instance().initializeState()}):h.debug("service worker is not supported")}),t.exports=d},function(t,e,i){"use strict";var n=i(272),s=i(19),o=i(14),a=i(18),r=i(8),l=n.extend({events:{"click .message a":"handleLinkClick"},onCreated:function h(){this.successMessage=o._("Thanks! You should receive a confirmation email soon.")},handleLinkClick:function d(t){switch(t.target.id){case"cancelEmailUpdate":this.cancelEmailUpdate();break;case"editEmail":this.updateEmail();break;case"removeBounce":this.removeBounce();break;case"resendEmail":this.resendConfirmEmail();break;case"resendEmailUpdate":this.resendUpdatedEmailAddressEmail()}return!1},removeBounce:function c(t){var e=r.create("UserSettingsResource",{email_bounced:!1});e.callUpdate().then(function(t){var e=o._("Got it! Make sure your inbox isn't full so that our emails can find their way to you.");this.updateNagMessage(e)}.bind(this))},updateEmail:function u(t){this.showLoading();var e={name:"UserEditEmail",resource:{name:"UserSettingsResource",options:{}}};a.load(e).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this))},cancelEmailUpdate:function p(t){var e=r.create("CancelEmailUpdateResource");e.callCreate().then(function(){this.updateNagMessage(o._("Thanks! Your email address change was cancelled."))}.bind(this))},resendUpdatedEmailAddressEmail:function _(t){var e=r.create("ResendEmailUpdateEmailResource");e.callCreate().then(function(){this.updateNagMessage(this.successMessage)}.bind(this))},resendConfirmEmail:function g(t){var e=r.create("ResendVerificationEmailResource");e.callCreate().then(function(){this.updateNagMessage(this.successMessage)}.bind(this))}});l.prototype.className="NagEmail",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(272),a=i(14),r=i(18),l=i(8),h=i(34),d=o.extend({
events:{"click .policy":"clickHandler"},clickHandler:function c(t){var e={name:"ConfirmDialog",options:{template:"pin_policy"}};return r.load(e).then(function(t){this.showInModal(t),this.listen(t,n.EVENT_CONFIRM,function(){this.savePolicyConfirmation()})}.bind(this)),!1},onActionSaved:function u(t,e,i){o.prototype.onActionSaved.apply(this,arguments),h.setTimeout(function(){this.parent.render()}.bind(this),2e3)},savePolicyConfirmation:function p(){var t=l.create("ConfirmGuidelinesResource",{});t.callUpdate().then(function(){this.updateNagMessage(a._("Thanks for confirming!"))}.bind(this),function(t){this.log.debug(t)}.bind(this))}});d.prototype.className="NagPolicy",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(272),s=i(19),o=i(14),a=i(8),r=i(46),l=i(83),h=n.extend({onContentReady:function d(){this.showWriteBanned()},events:{"click .resetPassword":"clickHandler"},clickHandler:function c(t){var e=function(t){var e=o._("Thanks! You should receive a password reset email soon.");this.updateNagMessage(e)}.bind(this),i=a.create("UserResetPasswordResource",{username_or_email:r.attributes.username});return i.callCreate({showError:!1}).then(e),!1},showWriteBanned:function u(){r.isWriteBanned()&&l.showWriteBanned(this)}});h.prototype.className="NagSecurity",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(46),s="web.com.pinterest.www",o={request:function a(){if(n.isAuthenticated()&&window.safari&&window.safari.pushNotification)try{var t=window.safari.pushNotification.permission(s);"default"===t.permission&&window.safari.pushNotification.requestPermission("https://"+window.location.hostname+"/_/_/push",s,{},function(){})}catch(e){}}};t.exports=o},function(t,e,i){"use strict";var n=i(1),s=i(21),o=i(232),a=i(11),r=i(195),l=i(50),h=i(14),d=i(18),c=i(19),u=i(23);i(283);var p=10,_=l.extend({CssClassName:{GUIDE_IS_RECOMMENDED:"guideIsRecommended",GUIDE_WAS_RECOMMENDED:"guideWasRecommended",HAS_GUIDES:"hasGuides",TRIGGER_ACTIVE:"triggerActive",VISIBLE:"visible",HIDE:"hide",SHOW:"show"},onContentReady:function g(){this.options.hidden||window.setTimeout(function(){var t=this.$(".addButtonWrapper");t&&0===t.children().length?this.appendAddPinButton():this.setVisible(!0)}.bind(this),2e3);var t={};t[a.PUBSUB_TOPIC_TUTORIAL_TRIGGER_ACTIVE]=this.onTutorialTriggerActive,this.pubsubSubscribe(a.PUBSUB_CHANNEL_TUTORIAL,t);var e={};e[a.PUBSUB_TOPIC_MAIN_MODULE_NEW]=this.onMainModuleChange,this.pubsubSubscribe(a.PUBSUB_CHANNEL_MAIN_MODULE,e);var i={};i[a.PUBSUB_TOPIC_DEEP_LINK]=this.onNavigate,i[a.PUBSUB_TOPIC_IGNORE_EXTENSION_NAG]=this.resetAddPinButton,i[a.PUBSUB_TOPIC_APPEND_TO_MAIN_MODULE]=this.hideIfBottomBanner,this.pubsubSubscribe(a.PUBSUB_CHANNEL_SITE,i),this.childListen(a.EVENT_TRIGGER_FLYOUT_CLICKED,this.onTriggerFlyoutClicked),this.childListen(a.EVENT_TUTORIAL_TRIGGER_CLICKED,this.onTriggerClicked),this.listen(this.getScrollableElement(),a.EVENT_SCROLL,n.throttle(this.onScroll,100)),this.options.state_noDisplayPrivacy=!1,"HomePage"!==this.getParentByModuleName("App").getChildById("mainModule").className&&(this.options.state_noDisplayPrivacy=!0,this.onScroll())},hideIfBottomBanner:function m(t,e,i){"BottomBanner"===i.module.toString(!1,!1)&&(this.options.hidden=!0,this.options.hiddenFlag=!0,this.setVisible(!1))},resetAddPinButton:function f(){var t=this.getChildByModuleName("ShowModalButton");t&&(t.destroy(),this.appendAddPinButton())},appendAddPinButton:function C(){var t=o.isExtensionInstalled(),e=s.get(a.COOKIE_SUPPRESS_EXTENSION_NAG),i;i=t||e?{name:"DropdownButton",id:"addPinDropdownButton",options:{borderless:!0,has_icon:!0,class_name:"addPinFooter footerIcon",text:h._("Add Pin"),show_text:!1,log_element_type:a.GEN.ElementType.PIN_UPLOAD_BUTTON,dropdown_options:{fixed:!0,prefetch:!0,position_point:"LEFT_BOTTOM"},submodule:{name:"AddPin",options:{dropdown_style:!0}}}}:{name:"ShowModalButton",id:"addPinDropdownButton",options:{borderless:!0,has_icon:!0,class_name:"addPinFooter footerIcon",text:h._("Add Pin"),show_text:!1,log_element_type:a.GEN.ElementType.PIN_UPLOAD_BUTTON,submodule:{name:"BrowserButtonUpsell",options:{extension_installed:!1,suppress:!0}}}},i&&d.load(i).then(function(t){t.render().then(function(){this.insertChild(t,this.$(".addButtonWrapper")),this.setVisible(!0)}.bind(this))}.bind(this))},onTriggerClicked:function E(){this.tutorialInfo&&(this.$el.hasClass(this.CssClassName.GUIDE_IS_RECOMMENDED)&&this.$el.removeClass(this.CssClassName.GUIDE_IS_RECOMMENDED).addClass(this.CssClassName.GUIDE_WAS_RECOMMENDED),this.$el.find(".userEducationTutorialButton").addClass(this.CssClassName.TRIGGER_ACTIVE))},onTriggerFlyoutClicked:function v(){this.onTriggerClicked(),this.tutorialInfo.showFlyout=!1,this.tutorialInfo.display_data.trigger="automatic",r.instance().startTutorial(this.tutorialInfo)},onTutorialTriggerActive:function I(t,e,i){if(this.tutorialInfo=i,!this.tutorialInfo)return void this.$el.removeClass(this.CssClassName.HAS_GUIDES);if(this.$el.addClass(this.CssClassName.HAS_GUIDES),i.showFlyout){var n={name:"UserEducationTriggerCard",options:{guide:i}};this.flyout&&(this.flyout.destroy(),this.flyout=null),d.load(n).then(function(t){this.flyout=t,t.render().then(function(){this.appendChild(t),this.setVisible(!0),this.$el.removeClass(this.CssClassName.GUIDE_WAS_RECOMMENDED).addClass(this.CssClassName.GUIDE_IS_RECOMMENDED),window.setTimeout(function(){this.dismissOnScroll=!0}.bind(this),3e3)}.bind(this))}.bind(this))}else this.setVisible(!0)},onNavigate:function T(){this.$el.removeClass(this.CssClassName.GUIDE_IS_RECOMMENDED).removeClass(this.CssClassName.GUIDE_WAS_RECOMMENDED),this.dismissOnScroll=!1,this.$el.find(".moreFooter").removeClass(this.CssClassName.TRIGGER_ACTIVE),u.instance.publish(a.PUBSUB_CHANNEL_TUTORIAL,a.PUBSUB_TOPIC_TUTORIAL_TRIGGER_ACTIVE,null),this.options.hiddenFlag=!1,this.setVisible(!0)},onScroll:function N(){this.dismissOnScroll&&(this.onTriggerClicked(),this.dismissOnScroll=!1);var t=this.getScrollableElement().scrollTop();this.$(".privacyPolicyWrapper").length>0&&(this.options.state_noDisplayPrivacy?(this.$el.addClass(this.CssClassName.HIDE),this.$el.removeClass(this.CssClassName.SHOW)):t>p?(this.$el.addClass(this.CssClassName.HIDE),this.$el.removeClass(this.CssClassName.SHOW)):0===t&&(this.$el.removeClass(this.CssClassName.HIDE),this.$el.addClass(this.CssClassName.SHOW)))},onMainModuleChange:function S(t,e,i){"HomePage"===i.className?this.options.state_noDisplayPrivacy=!1:this.options.state_noDisplayPrivacy=!0,this.onScroll()},setVisible:function b(t){t&&!this.visible?this.options.hiddenFlag||(this.visible=!0,this.$el.addClass(this.CssClassName.VISIBLE)):!t&&this.visible&&(this.visible=!1,this.$el.removeClass(this.CssClassName.VISIBLE))}});_.prototype.className="FooterButtons",t.exports=c.register(_)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(171),r=i(23),l=a.extend({CssClassName:n.extend(a.prototype.CssClassName,{TRIGGER_ACTIVE:"triggerActive"}),onClick:function h(t){a.prototype.onClick.call(this,t),this.triggerEvent(s.EVENT_TUTORIAL_TRIGGER_CLICKED,null,!0)},onContentReady:function d(){a.prototype.onContentReady.call(this),r.instance.subscribe(s.PUBSUB_CHANNEL_TUTORIAL,s.PUBSUB_TOPIC_TUTORIAL_TRIGGER_ACTIVE,function(t,e,i){i&&!i.showFlyout&&this.setTriggerActiveState(!0)}.bind(this))},setTriggerActiveState:function c(t){this.$el.toggleClass(this.CssClassName.TRIGGER_ACTIVE,t)}});l.prototype.className="UserEducationDropdownButton",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(285),r=i(23),l=i(20),h=i(27);i(171),i(130),i(286),i(288),i(291),i(292),i(293),i(294);var d=a.extend({events:{"click .menuContainer":"toggleSlideout","click .closeMenu":"toggleSlideout","click .openInApp":"openInApp","click .circleLogo":"redirectToHomePage","click .mobileSignUpButton":"onMobileSignupButtonClick","click .loginButtonNew":"onLoginButtonClick","click .signupButtonNew":"onSignupButtonClick"},CssClassName:n.extend(a.prototype.CssClassName,{OPEN:"open",HAS_SPELL_CHECK:"hasSpellCheck"}),onCreated:function c(){var t={};t[s.PUBSUB_TOPIC_SEARCH_SPELL_CHECK_UPDATED]=this._updateSpellCheckClass,this.pubsubSubscribe(s.PUBSUB_CHANNEL_SEARCH_AUTOCORRECT,t)},onContentReady:function u(){a.prototype.onContentReady.call(this);var t={};this.pubsubSubscribe(s.PUBSUB_CHANNEL_SITE,t),this.listen(l.instance,s.EVENT_ROUTE_MATCHED,this.onRouteMatched)},updateDom:function p(){this.$el.toggleClass(this.CssClassName.HAS_SPELL_CHECK,this.options.state_hasSpellCheck)},_updateSpellCheckClass:function _(t,e,i){this.updateOptionsAndDom({state_hasSpellCheck:i.hasSpellCheck})},onRouteMatched:function g(t){var e=t.navigateData.currentModule||{},i=["SearchPage","Closeup"];if(!n.contains(i,t.module)&&n.contains(i,e.className)){var o=this.getChildById("mainSearchTextbox");o.clearTypeaheadField()}if("SearchPage"===e.className&&e.data.typo){var a={typo:null,scope:""},l={hasSpellCheck:!1,searchAutocorrectOptions:a};r.instance.publish(s.PUBSUB_CHANNEL_SEARCH_AUTOCORRECT,s.PUBSUB_TOPIC_SEARCH_SPELL_CHECK_UPDATED,l)}},getHeight:function m(){return this.$el.height()},getUserMenu:function f(){return this.getChildById("userMenu")},getHomeElement:function C(){return this.$(".logo")},toggleSlideout:function E(){this.$(".menuOverlay").toggleClass(this.CssClassName.OPEN)},openInApp:function v(){this.triggerEvent(s.EVENT_UNAUTH_BANNER_OPEN_IN_APP,null,!0)},redirectToHomePage:function I(){h.changeWindowLocation("/",!1)},onMobileSignupButtonClick:function T(){r.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_SIGNUP_BUTTON_CLICKED,null)},onLoginButtonClick:function N(){h.trackRegisterAction("header_login_button_click")},onSignupButtonClick:function S(){h.trackRegisterAction("header_signup_button_click")}});d.prototype.className="Header",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(46),l=a.extend({onContentReady:function h(){var t={};t[s.PUBSUB_TOPIC_MAIN_MODULE_NEW]=this.onMainModuleChange,this.pubsubSubscribe(s.PUBSUB_CHANNEL_MAIN_MODULE,t)},onMainModuleChange:function d(t,e,i){var s=i,o=["LoginPage","UserRegisterPage"],a=this.options.main_module.name;this.options.main_module.name=s.className,this.options.main_module.options=n.clone(s.options),(a===s.className||-1===o.indexOf(s.className)&&-1===o.indexOf(a))&&(r.isAuthenticated()||"HomePage"!==a&&"HomePage"!==s.className)||(a=s.className,this.render());var l=["InterestFeedPage","BoardPage","Closeup"];if(!r.isAuthenticated()&&(-1!==l.indexOf(a)||-1!==l.indexOf(s.className))){var h=this.getChildByModuleName("KLPBar");h&&h.render()}}});l.prototype.className="HeaderBase",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(287),h=i(52),d=i(135),c=i(23),u=i(20),p=i(31);i(228);var _=r.extend({events:{"submit > form":"onSubmit",click:"onClick"},CssClassName:{FOCUS:"focus"},onChildItemSelected:function g(t){var e=t.data.item,i=e.get("query")||"";this.showGuidedSearch&&this.updateSearchTokens(i,!0);var n=e.get("url");if(n){if(this.options.navigate_on_search){if(this.showGuidedSearch){var s=e.get("type");this.updateQueryStates(i,s,e.get("resultIndex")),"board"!==s&&"user"!==s&&(n+=this.constructQueryStatesParams())}this.navigate(n)}return this.typeaheadField.blur(),!1}},onContentReady:function m(){var t={};t[o.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED]=this.onSearchQueryUpdated,t[o.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED_FORCE_UPDATE]=this.onSearchQueryUpdatedForceUpdate,t[o.PUBSUB_TOPIC_SEARCH_SCOPE_UPDATED]=this.onSearchScopeUpdated,t[o.PUBSUB_TOPIC_SEARCH_BOOST_UPDATED]=this.onSearchBoostUpdated,t[o.PUBSUB_TOPIC_SEARCH_GUIDE_SELECTED]=this.onSearchGuideSelected,t[o.PUBSUB_TOPIC_SEARCH_LINK_CLICKED]=this.onSearchLinkClicked,this.pubsubSubscribe(o.PUBSUB_CHANNEL_SITE,t),this.typeaheadField=this.getChildById("searchField"),this.showGuidedSearch=this.options.support_guided_search,this.showGuidedSearch&&(this.tokenizedInput=this.typeaheadField.getChildById("tokenizedInput"),this.queryStates=[],this.queryStatesChange=null),this.selectedListener=this.childListen(o.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen(o.EVENT_TOKEN_REMOVED_BY_USER,this.onTokenRemovedByUser),this.childListen(o.EVENT_FOCUS,this.onTypeaheadFieldFocus),this.childListen(o.EVENT_BLUR,this.onTypeaheadFieldBlur),this.childListen(o.EVENT_TYPEAHEAD_HIDDEN,this.onTypeaheadHidden),this.listen(u.instance,o.EVENT_ROUTE_MATCHED,this.onRouteMatched),s(document).on("keydown",function(t){this.onKeydown(t)}.bind(this))},onRouteMatched:function f(t){if(this.showGuidedSearch){var e=t.options.query?t.options.query:"";e!==this.typeaheadField.getValue()&&this.updateSearchTokens(e)}},onTokenRemovedByUser:function C(t){if(this.showGuidedSearch&&t.data){var e=t.data.text;this.updateQueryStates(e,"remove_refine")}this.navigateWithTokens("remove")},onTypeaheadFieldFocus:function E(){this.$el.addClass(this.CssClassName.FOCUS),this.showGuidedSearch&&this.tokenizedInput.setEditingTokenText()},onTypeaheadFieldBlur:function v(){if(this.$el.removeClass(this.CssClassName.FOCUS),this.showGuidedSearch){var t=this.typeaheadField.getValue();this.tokenizedInput.setInputValue(""),this.updateSearchTokens(t,!1)}},onTypeaheadHidden:function I(t){if(this.showGuidedSearch&&(!t.data||!t.data.noResults)){var e=this.typeaheadField.getValue();this.tokenizedInput.setInputValue(""),this.updateSearchTokens(e,!1)}},navigateWithTokens:function T(t){var e=this.typeaheadField.getValue(),i=encodeURIComponent(e),n="/",s=this.currentScope||this.options.scope||"pins";i&&(n="/search/"+s+"/?q="+i,t&&(n+="&rs="+t),n+=this.constructQueryStatesParams()),this.options.navigate_on_search&&this.navigate(n)},tokenizeQuery:function N(t){var e=t.split(/\s+/),i=n.find(e,function(t){return n.contains(o.SEARCH_FILTER_CONJUNCTIONS,t.toLowerCase())});return i?[t]:e},updateSearchTokens:function S(t,e){var i;if(e?(this.clearTypeaheadField(),i=t):i=this.tokenizedInput.setTokenValue(t),i){var s=this.tokenizeQuery(i),o=n.map(s,function(t){return{term:t,position:"1"}});this.addSearchInputTokens(o)}},onSearchQueryUpdated:function b(t,e,i){this.updateSearchQuery(i,!1)},onSearchQueryUpdatedForceUpdate:function y(t,e,i){this.updateSearchQuery(i,!0)},updateSearchQuery:function P(t,e){t=t||"",this.showGuidedSearch?this.typeaheadField.isFocussed()||(this.tokenizedInput.setInputValue(""),this.updateSearchTokens(t,e)):this.setTypeaheadValue(t)},onSearchScopeUpdated:function B(t,e,i){var n=i||"pins";this.currentScope=n,this.typeaheadField.setAutocompleteScope(n)},onSearchBoostUpdated:function A(t,e,i){var n=i||"";this.currentBoost=n},onSearchGuideSelected:function R(t,e,i){var n=i.term||"",s=i.position,o=i.color,a=i.index;if(n){var r=[{term:n,position:s,color:o}];this.addSearchInputTokens(r),this.updateQueryStates(n,"add_refine",a)}this.navigateWithTokens("guide")},onSearchLinkClicked:function w(t,e,i){this.onChildItemSelected({data:i})},removeSearchInputToken:function O(t){this.tokenizedInput.removeToken(t)},addSearchInputTokens:function D(t){var e=n.map(t,function(t){return new l({options:{term:t.term,position:t.position,color:t.color}})});this.tokenizedInput.addTokensAndUpdateInputView(e)},setTypeaheadValue:function x(t){this.typeaheadField.setValue(t)},clearTypeaheadField:function L(){this.typeaheadField.clear()},_getTypeaheadHighlightedItem:function k(){return this.typeaheadField.getTypeaheadHighlightedItem()},focus:function U(){this.typeaheadField.focus()},onSubmit:function M(t){var e=this._getTypeaheadHighlightedItem();if(e)return!1;var i=this.typeaheadField.getValue();if(""===i.trim())return c.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED_WITH_EMPTY_QUERY,i),!1;this.showGuidedSearch&&(this.updateSearchTokens(i,!0),this.typeaheadField.abortSearch(),this.typeaheadField.blur());var n=encodeURIComponent(i),s=this.currentScope||this.options.scope||"pins";if(this.typeaheadField.setAutocompleteScope(s),this.options.navigate_on_search){var a="/search/"+s+"/?q="+n;"recent_week"===this.currentBoost&&(a="/search/pins/recent/?q="+n),this.showGuidedSearch&&(this.updateQueryStates(i,"typed"),a+="&rs=typed",a+=this.constructQueryStatesParams()),this.navigate(a)}return c.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED,i),this.typeaheadField.blur(),this.typeaheadField.abortSearch(),!1},constructSingleQueryStateParam:function F(t){var e="";return"typed"===t.type||"hashtag"===t.type||"typo_auto_original"===t.type?e+=t.term+"|"+t.type:"recentsearch"===t.type||"autocomplete"===t.type||"trending"===t.type?e+=t.term+"|"+t.type+"|"+t.index:"guide"===t.type&&(e+=t.term+"|"+t.type+"|"+t.filter_type+"|"+t.index),e},constructQueryStatesParams:function $(){var t="";if(this.queryStates.length>0){var e=[];n.each(this.queryStates,function(t){e.push(this.constructSingleQueryStateParam(t))}.bind(this));var i={term_meta:e};this.queryStatesChange&&(i[this.queryStatesChange.action]=this.constructSingleQueryStateParam(this.queryStatesChange),this.queryStatesChange=null),t="&"+p.getQueryStringFromObject(i)}return t},updateQueryStates:function H(t,e,i){var s;if("typed"===e||"hashtag"===e||"typo_auto_original"===e)this.queryStates=[],s=this.tokenizeQuery(t),n.each(s,function(t){this.queryStates.push({term:t,type:e})}.bind(this));else if("recent_query"===e)this.queryStates=[],s=this.tokenizeQuery(t),n.each(s,function(t){this.queryStates.push({term:t,type:"recentsearch",index:i})}.bind(this));else if("trending"===e)this.queryStates=[],s=this.tokenizeQuery(t),n.each(s,function(t){this.queryStates.push({term:t,type:"trending",index:i})}.bind(this));else if(n.contains(["query","pin_search","board_search","people_search"],e))this.queryStates=[],s=this.tokenizeQuery(t),n.each(s,function(t){this.queryStates.push({term:t,type:"autocomplete",index:i})}.bind(this));else if("add_refine"===e)this.queryStates.push({term:t,type:"guide",filter_type:"word",index:i}),this.queryStatesChange={action:"add_refine",term:t,type:"guide",filter_type:"word",index:i};else if("remove_refine"===e){var o=n.find(this.queryStates,function(e){return e.term===t});o&&(this.queryStates.splice(n.indexOf(this.queryStates,o),1),o.action="remove_refine",this.queryStatesChange=o)}},onClick:function V(){this.focus()},onKeydown:function G(t){var e=d.get();e.hasModals()||!h.body_is_active&&h.is_active_element(this.$el.find("input")[0])&&t.keyCode===o.KeyCode.TAB&&(this.typeaheadField.isFocussed()?this.typeaheadField.blur():this.typeaheadField.focus(),t.preventDefault())}});_.prototype.className="SearchForm",t.exports=a.register(_)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(156),r,l=a.extend({events:{"click .remove":"onRemoveClick"},onContentReady:function h(){this.bgColor||(this.options.color?this.bgColor=this.clampColorBrightness(this.options.color):this.bgColor=this.getRandomColor()),this.$(".tokenContainer").css("background-color",this.bgColor)},onRemoveClick:function d(t){this._logContextEvent(t),this.triggerEvent(s.EVENT_REMOVE_TOKEN,this,!0),t.stopPropagation()},getTokenData:function c(){var t=this.options.term,e=this.options.position;return{text:t,priority:e}},clampColorBrightness:function u(t){return this._isBright(t)?this._darken(t,.2):t},_isBright:function p(t){var e=this.hexToRgb(t);if(e){var i=Math.sqrt(e.r*e.r*.241+e.g*e.g*.691+e.b*e.b*.068);return i>200}return!1},_darken:function _(t,e){var i=this.hexToRgb(t),n=Math.round(i.r*(1-e)),s=Math.round(i.g*(1-e)),o=Math.round(i.b*(1-e));return n=Math.min(Math.max(0,n),255),s=Math.min(Math.max(0,s),255),o=Math.min(Math.max(0,o),255),"#"+n.toString(16)+s.toString(16)+o.toString(16)},hexToRgb:function g(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/,i=t.match(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null},getRandomColor:function m(){var t=n.random(1,360),e=n.random(20,90),i=n.random(20,75);return"hsl("+t+","+e+"%,"+i+"%)"}});l.prototype.className="SearchInputToken",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(289),i(290);var o=n.extend({});o.prototype.className="RightHeader",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(130);i(129);var a=o.extend({onContentReady:function r(){var t=this.data.id;if(t){var e={};e[n.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(t,e)}},onUserUpdated:function l(){this.render()}});a.prototype.className="UserNavigateButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(50),o=i(30),a=i(8),r=i(38),l=i(158),h=i(40),d=i(152),c=i(19),u=i(23),p=i(54),_=i(34),g=0,m=1,f=2,C=s.extend({onContentReady:function E(){var t={};t[n.PUBSUB_TOPIC_DROPDOWN_PREP_APP]=this.tryAutoDropdown,t[n.PUBSUB_TOPIC_DROPDOWN_PREP_HOME]=this.setAutoDropdown,t[n.PUBSUB_TOPIC_SEGMENTED_CONTROLLER_SHOW]=this.onSegmentedTabsShow,t[n.PUBSUB_TOPIC_NETWORK_STORY_DROPDOWN_SHOW]=this.onNetworkStoryView,t[n.PUBSUB_TOPIC_NOTIFICATION_DROPDOWN_SHOW]=this.onNotificationView,t[n.PUBSUB_TOPIC_CONVERSATION_DROPDOWN_SHOW]=this.onConversationView,t[n.PUBSUB_TOPIC_CONVERSATION_UNREAD_COUNT]=this.onConversationUnreadCount,t[n.PUBSUB_TOPIC_CONVERSATION_UNREAD_COUNT_DECREASE]=this.onConversationUnreadCountDecrease,this.pubsubSubscribe(n.PUBSUB_CHANNEL_SITE,t),this.childListen(n.EVENT_DROPDOWN_SHOW,this.onDropdownShow),this.childListen(n.EVENT_DROPDOWN_HIDE,this.onDropdownHide),this.unseenNetworkNotifCount=0,this.unseenNotificationsCount=0,this.unseenConversationsCount=0,this.data&&(this.unseenNetworkNotifCount=this.data.network_story_count,isNaN(this.unseenNetworkNotifCount)&&(this.unseenNetworkNotifCount=0),this.unseenNotificationsCount=this.data.notification_unseen_count,isNaN(this.unseenNotificationsCount)&&(this.unseenNotificationsCount=0),this.updateBadgeCount()),this.listen(l.instance(),"notifications_count",function(t){this.unseenNotificationsCount=t,this.updateBadgeCount()}),this.listen(l.instance(),"network_notifications_count",function(t){this.unseenNetworkNotifCount=t,this.updateBadgeCount()})},setAutoDropdown:function v(){this.autoDropdown=!0},tryAutoDropdown:function I(){this.autoDropdown&&this.children[0]&&this.children[0].showDropdown()},onDropdownShow:function T(t){var e=t.target.getContentModule()._getSegmentedController();e&&this.selectDefaultTabToShow(e)},onDropdownHide:function N(t){var e=t.target.getContentModule()._getSegmentedController(),i=e.getChildByModuleName("NetworkNotifications");i&&i.finishImpressionsTracking()},onSegmentedTabsShow:function S(t,e,i){this.isMobile()&&this.selectDefaultTabToShow(i)},onNetworkStoryView:function b(t,e,i){if(0!==this.unseenNetworkNotifCount){var s=a.create("NetworkStoryBadgeResource",{});s.callDelete({showError:!1})}this.unseenNetworkNotifCount=0,this.updateBadgeCount(),p.localStorage.setItem(n.LOCALSTORAGE_SELECTED_NOTIFICATION_TAB,0)},onNotificationView:function y(t,e,i){if(0!==this.unseenNotificationsCount){var s=a.create("NotificationBadgeResource",{});s.callDelete({showError:!1})}this.unseenNotificationsCount=0,this.updateBadgeCount(),p.localStorage.setItem(n.LOCALSTORAGE_SELECTED_NOTIFICATION_TAB,1)},onConversationView:function P(t,e,i){p.localStorage.setItem(n.LOCALSTORAGE_SELECTED_NOTIFICATION_TAB,2)},onConversationUnreadCount:function B(t,e,i){0!==this.unseenConversationsCount&&0===i&&d.deleteConversationBadgeCount(),this.unseenConversationsCount=i,this.updateBadgeCount()},onConversationUnreadCountDecrease:function A(t,e,i){var n=Math.max(0,this.unseenConversationsCount-i);this.onConversationUnreadCount(t,e,n)},updateBadgeCount:function R(){var t=this.unseenNotificationsCount+this.unseenNetworkNotifCount;this.isMobile()||(t+=this.unseenConversationsCount,u.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_CONVERSATION_SET_BADGE,this.unseenConversationsCount)),u.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NETWORK_STORY_SET_BADGE,this.unseenNetworkNotifCount),u.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NOTIFICATION_SET_BADGE,this.unseenNotificationsCount);var e=this.getButton();e&&e.setBadgeCount(t),r.getInstance().setPrefixCount(t)},getTabToShow:function w(){var t=-1;return!this.isMobile()&&this.unseenConversationsCount>0?t=f:this.unseenNotificationsCount>0?t=m:this.unseenNetworkNotifCount>0&&(t=g),-1===t&&(t=p.localStorage.getItem(n.LOCALSTORAGE_SELECTED_NOTIFICATION_TAB),null===t&&(t=g)),t===f&&this.isMobile()&&(t=g),t},isMobile:function O(){return h.instance.is_mobile_agent},getButton:function D(){if(!this._button){var t=this.getChildrenByModuleName(o.siteConst.PRESENTER_BUTTON_MODULE_NAME);t.length>0&&(this._button=t[0])}return this._button},selectDefaultTabToShow:function x(t){var e=this.getTabToShow();t.onButtonSelected(this.getTabToShow()),this.updateBadgeCount(),e===m?_.setTimeout(function(){u.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NOTIFICATION_DROPDOWN_SHOW,{})},1500):e===g&&_.setTimeout(function(){u.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NETWORK_STORY_DROPDOWN_SHOW,{})},1500)}});C.prototype.className="NotificationsConversationsButton",t.exports=c.register(C)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=o.extend({onContentReady:function l(){this.isEmpty()?a.instance.publish(n.PUBSUB_CHANNEL_KLP_BAR,n.PUBSUB_TOPIC_KLP_BAR_HIDDEN):(this.show(),a.instance.publish(n.PUBSUB_CHANNEL_KLP_BAR,n.PUBSUB_TOPIC_KLP_BAR_SHOWN))}});r.prototype.className="KLPBar",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(130),s=i(19),o=i(131),a=n.extend({onClick:function r(t){return o.showInlineSignupModalOnButtonClick("LoginButton")}});a.prototype.className="LoginButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(130),s=i(19),o=i(131),a=n.extend({getNavigateUrl:function r(t){return o.showInlineSignupModalOnButtonClick("SignupButton")}});a.prototype.className="SignupButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({onCreated:function r(){var t={};t[n.PUBSUB_TOPIC_SEARCH_SPELL_CHECK_UPDATED]=this._onSpellCheckUpdated,this.pubsubSubscribe(n.PUBSUB_CHANNEL_SEARCH_AUTOCORRECT,t)},_onSpellCheckUpdated:function l(t,e,i){this.updateOptionsAndDom(i.searchAutocorrectOptions),this.renderExistingData()}});a.prototype.className="SearchAutocorrect",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(152),a=n.extend({getConversationHeads:function r(){return this.$(".ConversationHead")},openConversation:function l(t){o.openConversation(t)},closeConversation:function h(t){o.closeConversation(t)},scaleConversationDownAndRemove:function d(t){o.scaleConversationDownAndRemove(t)},getConversationsManager:function c(){return o}});a.prototype.className="ActiveConversations",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(266),a=i(50),r=i(40),l=i(80),h=i(81),d=i(297),c=i(20),u=i(46),p=i(27);i(298),i(299),i(300);var _=a.extend({events:{"click .stayInBrowserLink":"onClickStayInBrowser","click .loginBrowserLink":"onClickLoginBrowser","click .continueBrowserLink":"onClickContinueBrowser","click .appInfo":"onClickOpenInApp","click .openInApp":"onClickOpenInApp","click .RelatedItemsSlideshow":"onClickOpenInApp","click .overlayTop":"onClickOpenInApp","click .boardWrapper":"onClickOpenInApp","click .interstitialHeaderLoginWithBrowserLink":"redirectToLogin"},onContentReady:function g(){var t=l.fromEventType(n.GEN.EventType.INTERSTITIAL_LOADED);h.getInstance().addEvent(t),r.instance.user_agent_platform===n.USER_AGENT_PLATFORM_IOS||r.instance.user_agent_platform===n.USER_AGENT_PLATFORM_IPAD?this.deviceString=r.instance.user_agent_platform:r.instance.user_agent_platform===n.USER_AGENT_PLATFORM_ANDROID?this.options.is_tablet?this.deviceString="android_tablet":this.deviceString=r.instance.user_agent_platform:this.deviceString="other",this.typeString=this.options.type||"regular",p.trackRegisterAction("interstitial."+this.typeString+".loaded."+this.deviceString)},removeInterstitial:function m(){var t=this.parent;t&&t.destroy()},onClickOpenInApp:function f(){d.setOpenInAppPreference(),p.trackRegisterAction("interstitial."+this.typeString+".open_in_app."+this.deviceString),this.triggerEvent(n.EVENT_SHOW_RETURN_INTERSTITIAL,{},!0),o.redirectToApp(this.userAgentPlatform,"interstitialOpenInApp");var t=l.fromEventType(n.GEN.EventType.INTERSTITIAL_OPEN_IN_APP);h.getInstance().addEvent(t),r.instance.user_agent_platform===n.USER_AGENT_PLATFORM_IOS&&(this.options.type||this.removeInterstitial())},onClickStayInBrowser:function C(){var t=l.fromEventType(n.GEN.EventType.INTERSTITIAL_OPEN_IN_BROWSER);d.setStayInBrowserPreference(!0,!1),h.getInstance().addEvent(t),p.trackRegisterAction("interstitial."+this.typeString+".open_in_browser."+this.deviceString),this.removeInterstitial()},onClickLoginBrowser:function E(){this.onClickStayInBrowser(),this.triggerEvent(n.EVENT_CLEAR_HAS_RETURN_INTERSTITIAL,{},!0),p.trackRegisterAction("interstitial."+this.typeString+".login_with_browser."+this.deviceString),u.isAuthenticated()||c.instance.navigate("/login/?next="+window.location.pathname)},onClickContinueBrowser:function v(){this.onClickStayInBrowser(),this.triggerEvent(n.EVENT_CLEAR_HAS_RETURN_INTERSTITIAL,{},!0),p.trackRegisterAction("interstitial."+this.typeString+".continue_in_browser."+this.deviceString)},redirectToLogin:function I(){c.instance.navigate("/login/?next="+window.location.pathname),this.$el.fadeOut(),this.triggerEvent(n.EVENT_HEADER_INTERSTITIAL_DISMISSED,null,!0)}});_.prototype.className="AppInterstitial",t.exports=s.register(_)},function(t,e,i){"use strict";var n=i(21),s=i(11),o={getOpenInAppPreference:function a(){return!!n.get(s.GEN.CookieName.OPEN_IN_APP)},setOpenInAppPreference:function r(){n.set(s.GEN.CookieName.OPEN_IN_APP,"1",8760)},getStayInBrowserPreference:function l(){return!!n.get(s.GEN.CookieName.STAY_IN_BROWSER)},setStayInBrowserPreference:function h(t,e){if(e===!0)return void n.unset(s.GEN.CookieName.STAY_IN_BROWSER);var i;i=t?72:24,n.set(s.GEN.CookieName.STAY_IN_BROWSER,"1",i)}};t.exports=o},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="RelatedItemsCarousel",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="GroupBoardUserAppJoin",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({CssClassName:{STATIC:"static"},stopAnimation:function r(){this.$(".pinInfo").fadeOut(),this.$el.addClass(this.CssClassName.STATIC)},onContentReady:function l(){var t={};t[n.PUBSUB_TOPIC_SIGNUP_CONTINUE_CLICKED]=this.stopAnimation,this.pubsubSubscribe(n.PUBSUB_CHANNEL_SITE,t)}});a.prototype.className="RelatedItemsSlideshow",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(266),a=i(50),r=i(27),l=a.extend({events:{click:"openInApp"},onContentReady:function h(){r.trackRegisterAction("blue_banner_loaded")},openInApp:function d(){r.trackRegisterAction("blue_banner_getapp_clicked"),this.triggerEvent(n.EVENT_SHOW_RETURN_INTERSTITIAL,{},!0),o.redirectToApp(this.userAgentPlatform,"authUpsellOpenInApp")}});l.prototype.className="BlueAppBanner",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(21),s=i(11),o=i(19),a=i(57),r=i(50),l=i(46),h=i(27),d=r.extend({events:{"click .cookieButton":"onClickGotIt","click .learnMore":"onClickLearnMore","click .privacyPolicy":"onClickPrivacy"},onClickGotIt:function c(t){l.isAuthenticated()?(a.instance.completePlacedExperience(s.GEN.Placement.WEB_HOME_TAKEOVER,s.GEN.Experience.WEB_EU_COOKIE_BANNER),h.trackRegisterAction("auth_eu_cookie_banner_dismissed")):(n.set(s.COOKIE_SUPPRESS_EU_COOKIE_BANNER,"true"),h.trackRegisterAction("unauth_eu_cookie_banner_dismissed")),this.hide()},onClickLearnMore:function u(t){l.isAuthenticated()?h.trackRegisterAction("auth_eu_cookie_banner_learnmore"):h.trackRegisterAction("unauth_eu_cookie_banner_learnmore")},onClickPrivacy:function p(t){h.trackRegisterAction("auth_eu_cookie_banner_privacy")}});d.prototype.className="EuCookieBar",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(57),a=i(304),r=i(28),l=i(14),h=i(17);
i(116);var d=a.extend({onCreated:function c(){a.prototype.onCreated.call(this);var t={};t[n.PUBSUB_TOPIC_TUTORIAL_MINI_NEXT]=this.updateFollowButton,this.pubsubSubscribe(n.PUBSUB_CHANNEL_TUTORIAL,t)},onContentReady:function u(){this.$progressWrapper=this.$(".nuxProgress"),this.$progressFooterWrapper=this.$(".progressFooterWrapper"),a.prototype.onContentReady.call(this)},endMandatoryFlow:function p(){return o.instance.isPlacedExperience(n.GEN.Placement.WEB_MOBILE_EVERYTHING_FEED_TAKEOVER,n.GEN.Experience.WEB_MOBILE_NUX_INTERESTS)?o.instance.completePlacedExperience(n.GEN.Placement.WEB_MOBILE_EVERYTHING_FEED_TAKEOVER,n.GEN.Experience.WEB_MOBILE_NUX_INTERESTS):Promise.resolve()},setStepTexts:function _(t){var e,i,n,s,o;if(this.progressData){var a=this.progressData[this.getNuxTutorialName()];if(a){var r=a.steps;if(r){var l=r[t];if(l){if(l.hideHeader)return this.$progressWrapper.hide(),void this.$progressFooterWrapper.hide();e=l.buttonText,i=l.header1,n=l.header2,s=l.skip_data,o=l.disableButton,this.$progressWrapper.show(),this.$progressFooterWrapper.show()}}}}this.$skip&&(this.$skip.unbind(),this._handleSkipButton(s)),e&&(o&&this.getNextButton().disable(),this.getNextButton().setText(e),this.getNextButton().show()),this._updateHeaders(i,n)},onRemoved:function g(){r.instance.showInterstitial()},updateFollowButton:function m(t,e,i){var n=i,s=n.total,o=5-s,a="";o>0?(a=h.format(l._("Follow {{ numToFollow }} more"),{numToFollow:o}),this.getNextButton().setText(a),this.getNextButton().disable()):(a=l._("Follow"),this.getNextButton().setText(a),this.getNextButton().enable())}});d.prototype.className="NuxProgressMweb",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(205),l=i(18),h=i(203),d=a.extend({CssClassName:{HIDDEN:"hidden"},onCreated:function c(){this.childListen(s.EVENT_BUTTON_CLICK,this.onButtonClick),this.options.auto_follow_interest&&this.autoFollowInterest(this.options.auto_follow_interest);var t={};t[s.PUBSUB_TOPIC_TUTORIAL_NEXT]=this.triggerNextEvent,this.pubsubSubscribe(s.PUBSUB_CHANNEL_TUTORIAL,t)},endMandatoryFlow:function u(){},setStepTexts:function p(t){},initializeProgress:function _(t){this.module=t?t.module:null,h.isTutorialActive()||this.tutorialManager.startTutorial(this.getNuxTutorialName(),{renderModule:!1}),this.tutorialManager.setProgressModule(this)},onContentReady:function g(){this.tutorialManager=r.instance(),this.$header1=this.$(".headerTitle1"),this.$header2=this.$(".headerTitle2"),this.$skip=this.$(".skip"),this.nextButton=this.getChildById("nextButton"),this.progressData=this.extraData?this.extraData.progressData:null,this.nextStep(1),this.initializeProgress()},nextStep:function m(t){this.currentStep=t,this.setStepTexts(t)},onButtonClick:function f(t){var e=t.target;e&&("previousButton"===e.id?(t.stopPropagation(),this.triggerPreviousEvent()):"nextButton"===e.id&&(t.stopPropagation(),this.triggerNextEvent()))},getNextButton:function C(){return this.nextButton},_handleSkipButton:function E(t){this.$skip&&(t&&!n.isEmpty(t)?(this.$skip.removeClass(this.CssClassName.HIDDEN),this.$skip.bind("click",function(){this._launchSkipConfirmDialog(t)}.bind(this))):this.$skip.addClass(this.CssClassName.HIDDEN))},_updateHeaders:function v(t,e){t&&this.$header1.html(t),e&&this.$header2.html(e)},_launchSkipConfirmDialog:function I(t){var e={name:"ConfirmDialog",options:{button_text:t.button_text,dismiss_button_text:t.dismiss_button_text,body_message:t.body_message,title:t.title,template:"generic"}};l.load(e).then(function(t){this.showInModal(t,{mask_type:"dark",can_dismiss:!1}),this.listen(t,s.EVENT_CONFIRM,function(){this.triggerEvent(s.EVENT_NEXT,null,!1)})}.bind(this))},getNuxTutorialName:function T(){return this.extraData?this.extraData.tutorialName:"interestsNuxMweb"},getNuxTutorialStep:function N(){return this.currentStep?this.currentStep:1},triggerPreviousEvent:function S(){this.triggerEvent(s.EVENT_PREVIOUS,null,!1)},triggerNextEvent:function b(){this.triggerEvent(s.EVENT_NEXT,null,!1)}});d.prototype.className="NuxProgressBase",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(171),i(286),i(306);var o=n.extend({onContentReady:function a(){}});o.prototype.className="DrawerNav",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(34);i(171),i(173),i(290),i(307);var r=o.extend({onContentReady:function l(){this.options.drawerIconActive=!1;var t={};t[n.PUBSUB_TOPIC_DRAWER_SIDE_NAV_SHOW]=this._loadDrawer,t[n.PUBSUB_TOPIC_DRAWER_SIDE_NAV_CLOSE]=this._flashDrawerIcon,this.pubsubSubscribe(n.PUBSUB_CHANNEL_CAMPBELL,t)},updateDom:function h(){this.$(".campbellDrawerButton").toggleClass("active",this.options.drawerIconActive)},_loadDrawer:function d(){var t=this.$(".campbellDrawerButton");t.trigger("click"),this.updateOptionsAndDom({drawerIconActive:!0})},_flashDrawerIcon:function c(){a.setTimeout(function(){this.updateOptionsAndDom({drawerIconActive:!1})}.bind(this),500)}});r.prototype.className="CampbellRightHeader",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(171),s=i(19);i(129);var o=n.extend({});o.prototype.className="CampbellUserMenu",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(171),i(286),i(306);var o=n.extend({});o.prototype.className="TopLevelNav",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="Toasts",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=i(311),l=i(46);i(151),i(312);var h=o.extend({onAddedToDom:function d(){a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_CURRENT_CATEGORY,this.options.feed)},_resetCategory:function c(){a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_CURRENT_CATEGORY,null)},onRemoved:function u(){this._resetCategory()},onEmpty:function p(){this._resetCategory()},onContentReady:function _(){l.isAuthenticated()||r.logUrl()}});h.prototype.className="FeedPage",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(54),o={logUrl:function a(){s.localStorage.getItem(n.LOCALSTORAGE_LAST_VISITED_PAGE)!==window.location.pathname&&(s.localStorage.prependItem(n.LOCALSTORAGE_VISITED_PAGES,{path:window.location.pathname,ts:Date.now()},n.MAX_STORED_VISITED_PAGES),s.localStorage.setItem(n.LOCALSTORAGE_LAST_VISITED_PAGE,window.location.pathname))}};t.exports=o},function(t,e,i){"use strict";var n=i(50),s=i(19);i(125);var o=n.extend({});o.prototype.className="RelatedInterestsSection",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151),i(314),i(319),i(321),i(331),i(320);var o=n.extend({});o.prototype.className="HomePage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(21),a=i(194),r=i(11),l=i(193),h=i(50),d=i(17),c=i(158),u=i(28),p=i(80),_=i(81),g=i(170),m=i(14),f=i(18),C=i(19),E=i(23),v=i(46);i(151),i(315),i(317),i(318),i(302);var I=h.extend({onContentReady:function T(){if(this.listen(this.getScrollableElement(),r.EVENT_SCROLL,this._onScroll),this.setAutoNotificationsDropdown(),this.options.nux_type){if(delete this.options.nux_type,this.options.grid_limit&&delete this.options.grid_limit,this.options.embed_module_above_grid&&delete this.options.embed_module_above_grid,this.options.bottom_banner){var t=new a({options:{banner_text:this.options.bottom_banner.banner_text,keep_on_action:this.options.bottom_banner.keep_on_action}});return t.render().then(function(){u.instance.getChildByModuleName("HomePage").appendChild(t)})}}else{var e=this._getFeedGrid();if(e&&!e.hasItems()){g.log("empty_home_feed",1);var i="Grid is empty";v.isAuthenticated()&&v.id&&(i+=" for user "+v.id),this.log.warn(i)}this.extraData&&this.extraData.emailUpdated&&this.showUpdateEmailSuccess(),this._setUpFastFollow(),this.setRecentPinId();var n={};n[r.PUBSUB_TOPIC_VIEW_EVENT_INITIALIZED]=this._logScreenSizeEvent,this.pubsubSubscribe(r.PUBSUB_CHANNEL_CONTEXT_LOGGING,n)}},_getFeedGrid:function N(){return this.getChildById("feedGrid")},showUpdateEmailSuccess:function S(){if(o.get(r.COOKIE_EMAIL_ADDRESS_UPDATED)){if(o.unset(r.COOKIE_EMAIL_ADDRESS_UPDATED),!this.extraData||!this.extraData.email)return;var t=d.format(m._("You updated your address! Now you just need to confirm it. Look for the message we sent to {{ new_email }}."),{new_email:this.extraData.email}),e={name:"ConfirmDialog",options:{button_text:m._("Ok"),body_message:t,title:m._("Email updated"),template:"generic"}};return void f.load(e).then(function(t){this.showInModal(t)}.bind(this))}},_setUpFastFollow:function b(){var t={};t[r.PUBSUB_TOPIC_HOMEFEED_REFRESH]=this.onBoardInteraction.bind(this),t[r.PUBSUB_TOPIC_HOMEFEED_NUX_MODIFICATIONS]=this.onNuxModifications.bind(this),this.pubsubSubscribe(r.PUBSUB_CHANNEL_CURRENT_USER,t)},addTutorials:function y(){(!this.options.launch_experience_bottom_grid||this._isScrolledToBottom())&&(delete this.options.launch_experience_bottom_grid,l.launchPlacedExperience(r.GEN.Placement.WEB_HOME_TAKEOVER,{},this))},onBoardInteraction:function P(t,e,i){var n=function s(){};i&&i.callback&&(n=i.callback),this.render().then(n)},onNuxModifications:function B(t,e,i){if(!n.isEmpty(i.options)){this.updateOptions(i.options);var s=function a(){};i&&i.callbackOnEmbeddedModule&&(s=i.callbackOnEmbeddedModule),this.render().then(function(){s(this._getEmbeddedChildModule())}.bind(this))}if(i.clearGrid){this._getFeedGrid().destroy();var o=function r(){};n.isUndefined(i.clearGridCallback)||(o=i.clearGridCallback),o()}},_getEmbeddedChildModule:function A(){return this.getChildById("embeddedModule")},onAddedToDom:function R(){n.defer(this.addTutorials.bind(this)),this._setUpFastFollow(),this.setRecentPinId()},setAutoNotificationsDropdown:function w(){this.inDom&&this.contentReady&&this.options.notifications_open&&E.instance.publish(r.PUBSUB_CHANNEL_SITE,r.PUBSUB_TOPIC_DROPDOWN_PREP_HOME)},onRemovedFromDom:function O(){c.instance().setRecentPinId(null)},_onScroll:function D(){var t=this.getScrollableElement().scrollTop();if(t>10?(this.$(".cookieBar").fadeOut(250),this.$(".cookieBarText").fadeOut(250),this.$(".nonEuPrivacyPolicy").fadeOut(250)):0===t&&(this.$(".cookieBar").fadeIn(1e3),this.$(".cookieBarText").fadeIn(1e3),this.$(".nonEuPrivacyPolicy").fadeIn(1e3)),this._isOnHomePage()){var e=this._getEmbeddedChildModule();e&&e.handleScroll&&e.handleScroll(),this.options.launch_experience_bottom_grid&&this._isScrolledToBottom()&&(delete this.options.launch_experience_bottom_grid,l.launchPlacedExperience(r.GEN.Placement.WEB_HOME_TAKEOVER,{},this))}},_isScrolledToBottom:function x(){var t=this.getScrollableElement().scrollTop(),e=s(document).height()-this.getScrollableElement().height();return t>=e},_isOnHomePage:function L(){return this.parent?"mainModule"===this.parent.id:!1},setRecentPinId:function k(){c.instance().setRecentPinId(this.getRecentPinId())},getRecentPinId:function U(){var t=this._getFeedGrid();if(!t)return null;var e=t.getFirstGridItem("Pin");return e?e.getPinId():void 0},_logScreenSizeEvent:function M(){var t={event_type:r.GEN.EventType.VIEW_SCREEN_SIZE,view_type:r.GEN.ViewType.FEED,view_parameter:r.GEN.ViewParameterType.FEED_HOME},e=p.fromPlainObject(t);e.updateAuxData({screen_size_height:String(window.innerHeight),screen_size_width:String(window.innerWidth),screen_res_height:String(screen.height),screen_res_width:String(screen.width)}),_.getInstance().addEvent(e)}});I.prototype.className="AuthHomePage",t.exports=C.register(I)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(316);var o=n.extend({});o.prototype.className="HeroBasicWrapper",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(276),a=i(27);i(116),i(130);var r=o.extend({onContentReady:function l(){o.prototype.onContentReady.call(this),this.options.type=n.GEN.ExperienceReverse[String(this.experienceId)],a.trackRegisterAction("web_hero_app_upsell_displayed_"+this.experienceId)},onButtonClick:function h(t){var e=t.target;if("close"===e.id)return void this.dismiss();if(e.options)switch(e.options.action){case n.GEN.ExperienceCompleteAction.COMPLETE:this.complete();break;case n.GEN.ExperienceCompleteAction.COMPLETE_AND_SHOW:this.complete(!0);break;case n.GEN.ExperienceCompleteAction.DONT_COMPLETE_AND_HIDE:this.hide();break;case n.GEN.ExperienceCompleteAction.DONT_COMPLETE_AND_SHOW:break;default:this.hide()}}});r.prototype.className="HeroBasic",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(276),r=i(232),l=i(81),h=i(8);i(116);var d="pinitButton",c=500,u=a.extend({onContentReady:function p(){a.prototype.onContentReady.call(this),n(window).on("load",setTimeout(this.toggleNagVisibility.bind(this),c))},toggleNagVisibility:function _(){r.isExtensionInstalled()?(this.setExtensionInstalledUserState(!0),this.dismiss()):(this.$el.fadeIn(),l.getInstance().logCustomViewEvent(s.GEN.ViewType.SAVE,s.GEN.ViewParameterType.EXTENSION_UPSELL_NAG))},setExtensionInstalledUserState:function g(t){var e={state:"INSTALLED_PIN_EXTENSION",value:t?1:0},i=h.create("UserStateResource",e);i.callCreate()},onButtonClick:function m(t){var e=t.target;e.id===d&&r.handleExtensionInstall(function(){this.setExtensionInstalledUserState(!0),this.complete()}.bind(this))}});u.prototype.className="HeroPinItButton",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(276),s=i(19),o=i(27);i(116);var a="pinitButton",r=n.extend({onButtonClick:function l(t){var e=t.target;e.id===a&&(o.changeWindowLocation(this.extraData.url,this.extraData.newWindow),this.complete(!0))}});r.prototype.className="HeroPinItWeb",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(320);var o=n.extend({});o.prototype.className="NuxTutorial",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(205),r=o.extend({onContentReady:function l(){this.manager=a.instance(),this.childListen(n.EVENT_NEXT,this.manager._next.bind(this.manager)),this.childListen(n.EVENT_PREVIOUS,this.manager._previous.bind(this.manager)),this.manager.startTutorial(this.options.tutorial_name,{moduleContainer:this})},onDestroyed:function h(){this.manager.stopTutorial()}});r.prototype.className="Tutorial",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(266),s=i(19),o=i(322),a=i(14),r=i(31),l=i(27),h=i(323);i(324),i(130),i(302),i(293),i(325);var d=o.extend({events:{"click .openInApp":"openInApp"},openInApp:function c(t){n.redirectToApp(this.userAgentPlatform,"default")},onContentReady:function u(){o.prototype.onContentReady.call(this),this.facebookTooltip=this.$(".facebookTooltip"),r.getQueryStringParams().reloadToLogin&&window.setTimeout(function(){l.changeWindowLocation("/")},1e3),"/"===window.location.pathname&&l.trackRegisterAction("unauth_home"),window.innerHeight<680&&h.resizeViewPort(window.innerWidth,680),this.extraData&&this.extraData.pinit_landing&&l.trackRegisterAction("unauth_pinit_landing");var t=this.data.story.story_id,e=this.options.container||"home_page";l.trackRegisterAction("inspired_wall."+e+"."+t),this.setMultiStepHeader(".title",{step1:this.data.story.title,step2:a._("Looking good! Just a few more details...")})},hideFacebookTooltip:function p(t){this.facebookTooltip.fadeOut(500)}});d.prototype.className="UnauthHomePage",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(133),r=i(132),l=i(170),h=i(8),d=i(31),c=i(27);i(130),i(292);var u=o.extend({onContentReady:function p(){this.multiStepSignupSetup(),this.loginButton=this.getChildById("loginButton"),this.facebookConnectButton=this.getChildById("facebookConnectButton"),this.facebookConnectButton&&this.listen(this.facebookConnectButton,n.FACEBOOK_LOGIN_FAILURE,this.onFacebookLoginFailure),this.childListen(n.EVENT_USER_REGISTER,this.onRegisterSuccess),this.childListen(n.EVENT_NAVIGATE,this.onChildNavigate),this.childListen(n.EVENT_FACEBOOK_REQUIRE_EMAIL,this.showFacebookTooltip),this.listen(this,n.EVENT_NAVIGATE,this.onChildNavigate)},multiStepSignupSetup:function _(){this.facebookTooltip=this.$(".facebookTooltip"),this.tosFooter=this.$(".outerTermsOfServiceFooter"),this.groupSeparatorDiv=this.$(".groupSeparatorDark"),this.step1Bottom=this.$(".step1Bottom"),this.childListen("toggleMultiStep",function(t){this.$el.toggleClass("secondStep"),this.titleText&&this.setHeader(t)}),this.groupSeparatorDiv.show(),this.step1Bottom.show(),this.tosFooter.show(),c.trackRegisterAction("register_multi_screen_username_pass_loaded")},setMultiStepHeader:function g(t,e){this.$title=this.$(t),this.titleText=e},setHeader:function m(t){this.$title.css({opacity:0}).html(t.data.step1?this.titleText.step1:this.titleText.step2).animate({opacity:1},n.TRANSITION_DELAY)},MAX_LANDING_PAGE_POLL_TRIES:6,onRegisterSuccess:function f(t){t.stopPropagation(),this.pollLandingPagePinsInjected(this.MAX_LANDING_PAGE_POLL_TRIES).fin(function(){this.options.open_new_window_on_success?(c.changeWindowLocation("/",!0),window.close()):c.changeWindowLocation("/")}.bind(this))},LANDING_PAGE_POLL_INTERVAL:500,pollLandingPagePinsInjected:function C(t){if(0>=t)return l.log("signup_landing_page_pins_injected_block_timeout",1),Promise.resolve();var e=h.create("UserStateResource",{state:"LANDING_PAGE_PINS_INJECTED"});return e.callGet({showError:!1}).then(function(e){return 1===e.resource_response.data?c.delay(this.LANDING_PAGE_POLL_INTERVAL).then(function(){return this.pollLandingPagePinsInjected(t-1)}.bind(this)):void 0}.bind(this),function(){return c.delay(this.LANDING_PAGE_POLL_INTERVAL).then(function(){return this.pollLandingPagePinsInjected(t-1)}.bind(this))}.bind(this))},onChildNavigate:function E(t){if(this.options.next&&t.data&&-1!==t.data.url.indexOf("/login/")){var e=d.getQueryStringParams();e.next=this.options.next,this.options.auto_follow&&(e.auto_follow=this.options.auto_follow),t.data.url=d.appendQueryString(t.data.url,e)}},showFacebookTooltip:function v(t){this.facebookTooltip.fadeIn(500)},onFacebookLoginFailure:function I(t){t.stopPropagation(),c.trackRegisterAction("contextual_signup_join_facebook"),this.facebookConnectButton.showLoading(),r.fetchNetworkData(a.FACEBOOK).then(function(t){this.log.debug("FB data:",t),this.facebookConnectButton.hideLoading()}.bind(this))}});u.prototype.className="InlineSignup",t.exports=s.register(u)},function(t,e,i){"use strict";var n=i(46),s=function r(t,e){var i=screen.width,n=screen.height,s=Math.round((i-t)/2),o=n>e?Math.round((n-e)/2):0;return"scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+t+",height="+e+",left="+s+",top="+o},o=function l(t){var e=document.documentElement,i=e.scrollWidth-e.clientWidth,s=e.scrollHeight-e.clientHeight;t&&(i=Math.max(i,0),s=Math.max(s,0)),n.isAuthenticated()||(s=340),window.resizeBy(i,s)},a={};a.open=function(t,e,i){var n=s(e,i);window.open(t,void 0,n)},a.shrinkWrap=function(){o(!1)},a.contain=function(){o(!0)},a.resizeViewPort=function(t,e){window.outerWidth?window.resizeTo(t+(window.outerWidth-window.innerWidth),e+(window.outerHeight-window.innerHeight)):(window.resizeTo(500,500),window.resizeTo(t+(500-document.body.offsetWidth),e+(500-document.body.offsetHeight)))},t.exports=a},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(27),a=n.extend({CssClassName:{LOADED:"loaded"},onContentReady:function r(){this.options.state_isLoaded=!1,o.preloadImage(this.options.image_url).then(function(){this.updateOptionsAndDom({state_isLoaded:!0})}.bind(this))},updateDom:function l(){this.$(".background").toggleClass(this.CssClassName.LOADED,this.options.state_isLoaded)}});a.prototype.className="BackgroundImage",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(326),i(292),i(293),i(330);var o=n.extend({onContentReady:function a(){this.childListen("toggleMultiStep",function(t){this.$el.toggleClass("secondStep")})}});o.prototype.className="SignupForm",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(327),r=i(23),l=i(54),h=i(31),d=i(46),c=i(27);i(116),i(130),i(328);var u=a.extend({events:{"focus input[name=username_or_email]":"onFocusEmail","click .forgotPassword":"onForgotPassword"},onFocusEmail:function p(){r.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_NAG_STATE,!1)},onContentReady:function _(){h.getQueryStringParams().auto_facebook_signup&&this.registerWithFacebook();var t={},e=this.options.invite_follow_board,i=this.options.invite_follow_user;return i&&(e?t.invite_follow_board=i+"/"+e:t.invite_follow_user=i,l.sessionStorage.setItem(s.SESSION_KEY_INVITE_FOLLOW,t)),!d.isAuthenticated()||d.get("autologin")||d.isLimitedLogin()?(a.prototype.onContentReady.apply(this,arguments),void(this.$inputEmail=this.$("input[name=username_or_email]"))):void this.redirect(t)},onForgotPassword:function g(t){c.changeWindowLocation(""+n(t.target).attr("href"))}});u.prototype.className="Login",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(115),r=i(50),l=i(133),h=i(132),d=i(35),c=i(29),u=i(14),p=i(8),_=i(20),g=i(54),m=i(31),f=i(46),C=i(27),E=i(104);i(116);var v=r.extend({events:{},onContentReady:function I(){var t=m.getQueryStringParams().message;if(t){var e;"reactivate"===t?e=u._("Your account has been reactivated! Please log in to continue."):"permanent_account_closure"===t&&(e=u._("Thanks for giving Pinterest a try. Your account will be closed soon.")),this.showError(e)}this.setupForm(),this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.getChildById("facebookLogin")&&this.listen(this.getChildById("facebookLogin"),s.EVENT_BUTTON_CLICK,this.facebookConnect),this.getChildById("twitterLogin")&&this.listen(this.getChildById("twitterLogin"),s.EVENT_BUTTON_CLICK,this.twitterConnect),this.getChildById("rakutenLogin")&&this.listen(this.getChildById("rakutenLogin"),s.EVENT_BUTTON_CLICK,this.rakutenConnect),this.getChildById("emailSignup")&&this.listen(this.getChildById("emailSignup"),s.EVENT_BUTTON_CLICK,this.onEmailSignup),this.getChildById("facebookSignup")&&this.listen(this.getChildById("facebookSignup"),s.EVENT_BUTTON_CLICK,this.onFacebookSignup),this.getChildById("twitterSignup")&&this.listen(this.getChildById("twitterSignup"),s.EVENT_BUTTON_CLICK,this.onTwitterSignup),this.getChildById("rakutenSignup")&&this.listen(this.getChildById("rakutenSignup"),s.EVENT_BUTTON_CLICK,this.onRakutenSignup),C.trackRegisterAction("register_landing")},setupForm:function T(){this.$form=this.$("form"),this.form=new a(this.$form,{username_or_email:[E.Required(),E.Email()],password:[E.Required()]},{})},onSubmitValidated:function N(t){if(!t["errors[0]"]){var e=this.form.getValue("username_or_email");this.login({username_or_email:e,password:this.form.getValue("password")}).then(void 0,function(t){if(this.showError(t.message),t.api_error_code===s.AUTO_PASSWORD_RESET_ERROR_CODE){var i=C.getResetPasswordOneClickUrl({username_or_email:e});this.navigate(i)}}.bind(this))}},twitterConnect:function S(t){t.stopPropagation(),this.connect(l.TWITTER,this.onTwitterConnectSuccess.bind(this))},facebookConnect:function b(t){t.stopPropagation(),this.connect(l.FACEBOOK,this.onFacebookConnectSuccess.bind(this))},rakutenConnect:function y(t){t.stopPropagation(),this.connect(l.RAKUTEN,this.onRakutenConnectSuccess.bind(this))},onEmailSignup:function P(t){C.trackRegisterAction("register_email")},onFacebookSignup:function B(t){t.stopPropagation(),C.trackRegisterAction("register_facebook_attempt"),this.facebookConnect(t)},onTwitterSignup:function A(t){t.stopPropagation(),C.trackRegisterAction("register_twitter_attempt"),this.twitterConnect(t)},onRakutenSignup:function R(t){t.stopPropagation(),C.trackRegisterAction("register_rakuten_attempt"),this.rakutenConnect(t)},onFacebookConnectSuccess:function w(t){this.login({facebook_id:t.id,facebook_token:t.access_token}).then(void 0,this.registerWithFacebook.bind(this))},registerWithFacebook:function O(t){if(this.options.register){var e=this.getChildById("facebookSignup");e.showLoading(),h.fastTrackSocialRegistration(l.FACEBOOK).then(function(){var t="/";this.options.auto_follow_interest&&(t=m.appendQueryString(t,{auto_follow_interest:this.options.auto_follow_interest})),C.changeWindowLocation(t,!1)}.bind(this),function(t){t instanceof d.NoEmailProvidedError?(this.rerequestFacebookEmail=!0,this.triggerEvent(s.EVENT_FACEBOOK_REQUIRE_EMAIL,null,!0)):this.navigate("/join/register/facebook/")}.bind(this)).fin(function(){e.hideLoading()})}else d.showError(t.message)},onTwitterConnectSuccess:function D(t){g.sessionStorage.setItem(s.SESSION_TWITTER_ID,t.id),g.sessionStorage.setItem(s.SESSION_TWITTER_TOKEN,t.oauth_token),g.sessionStorage.setItem(s.SESSION_TWITTER_TOKEN_SECRET,t.oauth_secret),g.sessionStorage.setItem(s.SESSION_TWITTER_FIRST_NAME,t.first_name),g.sessionStorage.setItem(s.SESSION_TWITTER_LAST_NAME,t.last_name),g.sessionStorage.setItem(s.SESSION_TWITTER_USERNAME,t.screen_name),g.sessionStorage.setItem(s.SESSION_TWITTER_IMAGE_URL,t.image_url),this.options.register?this.navigate("/join/register/twitter/"):this.login({twitter_id:t.id,twitter_token:t.oauth_token,twitter_token_secret:t.oauth_secret}).then(void 0,function(t){d.showError(t.message)})},onRakutenConnectSuccess:function x(t){g.sessionStorage.setItem(s.SESSION_RAKUTEN_ID,t.id),g.sessionStorage.setItem(s.SESSION_RAKUTEN_TOKEN,t.access_token),g.sessionStorage.setItem(s.SESSION_RAKUTEN_REFRESH_TOKEN,t.refresh_token),g.sessionStorage.setItem(s.SESSION_RAKUTEN_FIRST_NAME,t.first_name),g.sessionStorage.setItem(s.SESSION_RAKUTEN_GENDER,t.gender),g.sessionStorage.setItem(s.SESSION_RAKUTEN_EMAIL,t.email),this.login({rakuten_id:t.id,rakuten_token:t.access_token,rakuten_refresh_token:t.refresh_token}).then(void 0,function(t){if(this.options.register){var e=this.getChildById("rakutenSignup");e.showLoading(),h.fastTrackSocialRegistration(l.RAKUTEN).then(function(){C.changeWindowLocation("/",!1)},function(){this.navigate("/join/register/rakuten/")}.bind(this)).fin(function(){e.hideLoading()})}else d.showError(t.message)}.bind(this))},showError:function L(t){this.$("#errorMessage").html(n.escape(t)),this.$(".loginError").show()},connect:function k(t,e){return l.instance().connect(t,{success:function i(t){e(t)},error:function n(t){t.alertedUpstream||d.showError(u.commonStrings.connectError)},rerequest_facebook_email:"facebook"===t&&this.rerequestFacebookEmail}),!1},createAutoFollowResource:function U(t,e,i){var n=p.create(t,e);n.callCreate({showError:!1}).then(function(){c.trackEvent(i,s.GA_ACTION_SUCCESS)},function(){c.trackEvent(i,s.GA_ACTION_ERROR)})},autoFollow:function M(t){var e=_.instance.resolve(t);if(e){var i=e.resource.options,n={UserProfilePage:{resourceName:"UserAutoFollowResource",GACategory:"user_auto_follow",resourceOptions:{username:i.username}},BoardPage:{resourceName:"BoardAutoFollowResource",GACategory:"board_auto_follow",resourceOptions:{username_and_slug:i.username+"/"+i.slug}},InterestFeedPage:{resourceName:"InterestFollowResource",GACategory:"interest_auto_follow",resourceOptions:{interest_list:"favorited",interest_id:i.interest}}};if(e.module in n){var s=n[e.module];this.createAutoFollowResource(s.resourceName,s.resourceOptions,s.GACategory)}}},login:function F(t){var e=this.getChildById("loginButton");e&&e.showLoading();var i=g.sessionStorage.getItem(s.SESSION_KEY_INVITE_FOLLOW);return f.login(t).then(function(){this.showLoading(),this.options.auto_follow&&this.autoFollow(this.options.next),this.redirect(i)}.bind(this)).fin(function(){e&&e.hideLoading()})},redirect:function $(t){var e="/";t&&(t.invite_follow_user?e="/"+t.invite_follow_user+"/":t.invite_follow_board&&(e="/"+t.invite_follow_board+"/"),g.sessionStorage.removeItem(s.SESSION_KEY_INVITE_FOLLOW));var i=this.options.next||this.options.prev||e;this.options.auto_follow&&(i=m.appendQueryString(i,{auto_follow:"true"})),C.navigateAfterLoginStatusChange(i)}});v.prototype.className="LoginBase",t.exports=o.register(v)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(35),r=i(329),l=i(14),h=i(8),d=i(54),c=i(17),u=i(46),p=i(27),_=function E(){return l._("Oops! Log in with your Pinterest email and password first, then follow <a href='{{ help_link }}'>these instructions</a> to link your account to Google+.")},g=180,m="postmessage",f="signup",C=n.extend({events:{click:"onClick"},onContentReady:function v(){this.readyForConnect=!1,r.get(function(t){t.signin.render(this.$el.get(0),{scope:this.extraData.gplusScope,clientid:this.extraData.gplusClientId,apppackagename:this.extraData.gplusAppPackageName,redirecturi:m,accesstype:"offline",cookiepolicy:"single_host_origin",callback:function(t){this.readyForConnect&&this.onSignInCallback(t),this.readyForConnect=!0}.bind(this)})}.bind(this))},onClick:function I(){p.trackRegisterAction("register_gplus_click"),this.triggerEvent(o.EVENT_GPLUS_BUTTON_CLICKED,this,!0)},onSignInCallback:function T(t){var e={gplus_id_token:t.id_token},i=t.status;p.trackRegisterAction("register_gplus_attempt"),i.signed_in&&u.login(e).then(function(){this.showLoading(),this.onLoginSuccess(t)}.bind(this),function(e){this.onLoginError(e,t)}.bind(this))},onLoginSuccess:function N(t){p.trackRegisterAction("register_gplus_success"),window.location.reload()},onLoginError:function S(t,e){if(t.api_error_code===g){var i=c.format(_(),{help_link:this.extraData.gplusErrorLink});a.showHtmlError(i)}else this.options.action===f&&(d.sessionStorage.setItem(o.SESSION_GPLUS_CODE,e.code),d.sessionStorage.setItem(o.SESSION_GPLUS_REDIRECT_URI,m),h.create("UserRegisterResource",{gplus_code:e.code,gplus_redirect_uri:m}).callCreate({showError:!1}).then(this.onLoginSuccess))}});C.prototype.className="GplusConnectButton",t.exports=s.register(C)},function(t,e,i){"use strict";var n=i(48),s={get:function o(t){var e="gplus";n.load([],"https://apis.google.com/js/client:plusone.js",e),n.ready(e,function(){t(window.gapi)})}};t.exports=s},function(t,e,i){"use strict";var n=i(1),s=i(21),o=i(11),a=i(19),r=i(115),l=i(327),h=i(132),d=i(40),c=i(80),u=i(81),p=i(152),_=i(14),g=i(8),m=i(54),f=i(17),C=i(31),E=i(46),v=i(27),I=i(104);i(116);var T=l.extend({events:{"keyup .standardForm":"handleKeydown","keyup .userCustomGender":"handleEnterCustomGender","click .continueButton":"submitFirstStep","click .signup":"submitSecondStep","click .toggleStep > span":"toggleMultiStep","click .saveGender":"setCustomGender","click .removeCustomGender":"removeCustomGender","click .infoButton":"toggleGenderInfo","mouseleave .genderInfo":"hideGenderInfo"},CssClassName:n.extend(l.prototype.CssClassName,{ACTIVE:"active",HIDDEN:"hidden"}),user:E,onContentReady:function N(){if(this.user.isAuthenticated())return void this.redirect();if(s.get(o.COOKIE_REGISTER_RESTRICT))return v.changeWindowLocation("/restricted/age/",!1);this.setupForm(),this.logContainerViewType(),this.$emailInput=this.$("input[name='email']"),this.$passwordInput=this.$("input[name='password']"),this.$userFullNameInput=this.$("#userFullName"),this.$customGenderInput=this.$(".userCustomGender"),this.$genderReadout=this.$(".genderReadout"),this.$genderReadoutText=this.$(".genderReadout span"),this.$genderHiddenField=this.$("#custom_gender"),this.$genderSelectFields=this.$(".genderFormItem .fieldset"),this.$genderRadioButtons=this.$('input[name="gender"]'),this.$genderSaveButton=this.$(".saveGender"),this.$genderInfoBlurb=this.$(".genderInfo"),this.$userAgeInput=this.$("#userAge"),this.$userFullNameField=this.$("input[name='full_name']"),this.$userAgeField=this.$("input[name='age']"),this.$finalSignupButton=this.$(".signup"),this.$confirmedEmail=this.$(".confirmedEmail"),this.firstStepComplete=!1;var t=p.getUnauthUserEmail();!this.$emailInput.val()&&t&&this.$emailInput.val(t),d.instance.invite_code&&this.prefillEmailAddress(),this.options.register=!0},prefillEmailAddress:function S(){var t=g.create("InviteCodeMetadataResource",{invite_code:d.instance.invite_code});t.callGet({showError:!1}).then(function(t){t.resource_response.data&&t.resource_response.data.email_address&&this.$("input[name='email']").val(t.resource_response.data.email_address)}.bind(this))},setCustomGender:function b(){var t=this.$customGenderInput.val();
return""===t?void this.removeCustomGender():(this.$genderReadoutText.text(t),this.$genderHiddenField.val(t),this.$genderSelectFields.fadeOut(),this.$genderSelectFields.addClass(this.CssClassName.HIDDEN),this.$genderRadioButtons.prop("checked",!1),this.$genderReadout.fadeIn(),void this.$genderReadout.removeClass(this.CssClassName.HIDDEN))},removeCustomGender:function y(){this.$customGenderInput.val(""),this.$genderReadoutText.text(""),this.$genderHiddenField.val(""),this.$genderSelectFields.fadeIn(),this.$genderSelectFields.removeClass(this.CssClassName.HIDDEN),this.$genderReadout.fadeOut(),this.$genderReadout.addClass(this.CssClassName.HIDDEN)},logContainerViewType:function P(){if(this.options.container){this.user.setLoginContainer(this.options.container||"unknown");var t={home_page:o.GEN.EventType.HOME_PAGE_SIGNUP_VIEW,plain_signup_modal:o.GEN.EventType.PLAIN_MODAL_SIGNUP_VIEW,closeup_signup_modal:o.GEN.EventType.CLOSEUP_MODAL_SIGNUP_VIEW,widescreen_signup_modal:o.GEN.EventType.WIDESCREEN_MODAL_SIGNUP_VIEW,pinit_button_landing:o.GEN.EventType.PIN_IT_BUTTON_LANDING_SIGNUP_VIEW},e=t[this.options.container];if(e){var i=c.fromEventType(e);u.getInstance().addEvent(i)}}},setupForm:function B(){var t={first_name:[I.Required()],email:[I.Required({message:_._("<b>You missed a spot!</b> Don't forget to add your email.")}),I.Email({message:_._("<b>Hmm...</b>that doesn't look like an email address.")})],age:[I.Age({message:_._("Please enter a valid number.")})],password:[I.ContainsOnlyAscii({message:_._("<b>Oh @*&#!</b> No zany characters allowed.")}),I.Password({shortPassStr:_._("<b>Your password is too short!</b> You need 6+ characters."),badPassStyle:_._("Your password does not have the proper style."),samePasswordStr:_._("Please make your username and password different."),blackPassStr:_._("Please make a stronger password.")})],full_name:[I.Name({message:_._("<b>And your name is...?</b>")})]};this.form=new r(this.$("form"),t,{disableAutoValidation:!0}),this.listen(this.form,o.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},toggleGenderInfo:function A(){this.$genderInfoBlurb.fadeToggle()},hideGenderInfo:function R(){this.$genderInfoBlurb.fadeOut()},handleKeydown:function w(t){t.stopPropagation(),t.keyCode===o.KeyCode.ENTER&&(this.firstStepComplete?this.$finalSignupButton.click():this.$(".continueButton").click()),this.form.disableAutoValidation=!1},handleEnterCustomGender:function O(t){t.stopPropagation(),t.keyCode===o.KeyCode.ENTER&&this.$genderSaveButton.click(),this.form.disableAutoValidation=!1},validateInput:function D(t){return new Promise(function(e,i){this.form.validateField(t,function(t){0!==t.errors.length?i(t.errors):e()})}.bind(this))},validateEmailAvailable:function x(){var t=g.create("EmailExistsResource",{email:this.$emailInput.val()});t.callGet({showError:!1}).then(function(t){t.resource_response.data===!1?this.validateComplete({message:null,type:"emailError"}):this.login({username_or_email:this.form.getValue("email"),password:this.form.getValue("password")}).then(this.onLoginComplete.bind(this),function(t){this.onLoginError(t)}.bind(this))}.bind(this),function(){var t=_._("Hmm... that doesn't look like an email address.");this.validateComplete({message:t,type:"emailError"})}.bind(this))},submitFirstStep:function L(){return v.trackRegisterAction("multi_step_step_1_submit"),this.form.disableAutoValidation=!1,this.options.is_login_form?this.attemptLogin():void this.validateFirstStep()},validateFirstStep:function k(){return this.validateInput(this.$emailInput).then(function(){this.validateInput(this.$passwordInput).then(function(){this.validateEmailAvailable()}.bind(this),function(t){this.validateComplete({message:t[0],type:"passwordError"})}.bind(this))}.bind(this),function(t){this.validateComplete({message:t[0],type:"emailError"})}.bind(this))},submitSecondStep:function U(){return v.trackRegisterAction("multi_step_step_2_submit"),this.firstStepComplete?void this.validateSecondStep():this.submitFirstStep()},validateSecondStep:function M(){return this.validateInput(this.$userFullNameField).then(function(){""===this.$userAgeInput.val().trim()?this.secondStepComplete():this.validateInput(this.$userAgeField).then(function(){this.secondStepComplete()}.bind(this),function(t){this.validateComplete({message:t[0],type:"ageError"})}.bind(this))}.bind(this),function(t){this.validateComplete({message:t[0],type:"nameError"})}.bind(this))},secondStepComplete:function F(){this.$finalSignupButton.submit()},validateComplete:function $(t){if(!C.getQueryStringParams().email){var e,i;"emailError"===t.type||"passwordError"===t.type||"deactivatedUser"===t.type?(e=this.$("#firstStepTooltip"),i=".step1"):("nameError"===t.type||"ageError"===t.type)&&(e=this.$("#secondStepTooltip"),i=".step2"),t.message?(this.options.is_unauth_logout&&e.addClass(".leftToBox"),this.$(".errorIcon").hide(),this.$("input.hasError").siblings("em").fadeIn(),e.addClass(t.type),e.html(t.message).fadeIn(),this.$(".standardForm").height(this.$(i).height())):("emailError"===t.type||"passwordError"===t.type)&&(v.trackRegisterAction("multi_step_step_1_complete"),this.$confirmedEmail.text(this.$emailInput.val()),this.toggleMultiStep(),this.extraData.disableAutofocus||this.$("input[name='full_name']").focus(),this.extraData.show_personalize_field&&(this.$(".personalizeInput").prop("checked",!0),this.$(".personalizeField").removeClass(this.CssClassName.HIDDEN)))}},toggleMultiStep:function H(){this.firstStepComplete=!this.firstStepComplete,this.$el.toggleClass("secondStep"),this.triggerEvent("toggleMultiStep",{step1:!this.firstStepComplete},!0)},onLoginError:function V(t){if(t.api_error_code===o.LOGIN_VOLUNTARILY_DEACTIVATED_USER)this.validateComplete({message:t.message,type:"deactivatedUser"});else{var e=_._('<b>Deja vu!</b> That email\'s taken. <a href="{{ link }}">Forgot your password?</a>'),i=f.format(e,{link:"/password/reset/"});this.validateComplete({message:i,type:"emailError"})}},onLoginComplete:function G(){v.trackRegisterAction("multi_step_login"),this.redirect(m.sessionStorage.getItem(o.SESSION_KEY_INVITE_FOLLOW))},onSubmitValidated:function W(t){if(!t.errors[0]){if(this.extraData&&this.$userFullNameInput&&""===this.$userFullNameInput.val().trim())return;var e=this.getChildById("submitButton");e.showLoading();var i=this.getFormData();this.options.container&&(i.container=this.options.container),v.trackRegisterAction("multi_step_step_2_complete"),h.register(this.options.network,i).then(this.redirect.bind(this,!0),function(t){e.hideLoading(),t.api_error_code===o.API_ERROR_UNDERAGE_REGISTER_ATTEMPT&&v.changeWindowLocation("/restricted/age/",!1)})}},redirect:function K(t){var e;if(t){if(!this.triggerEvent(o.EVENT_USER_REGISTER,{},!0))return;e="/"}else e=this.options.next||"/";if(this.options.auto_follow)e=C.appendQueryString(e,{auto_follow:!0});else{var i=C.getQueryStringParams();i&&(e=C.appendQueryString(e,i))}v.navigateAfterLoginStatusChange(e)},getFormData:function j(){var t=this.$("form").serializeArray(),e={},i="";if(n.each(t,function(t){"full_name"===t.name?i=t.value.trim():e[t.name]="on"===t.value?!0:t.value}),i){var s=i.split(" ");""===s[0]&&s.shift(),s.length>0&&(e.first_name=s[0]||""),s.length>1&&(e.last_name=s[1]||"")}return e},attemptLogin:function Y(){var t=this.validateComplete.bind(this);return this.validateInput(this.$emailInput).then(function(){this.validateInput(this.$passwordInput).then(function(){this.login({username_or_email:this.form.getValue("email"),password:this.form.getValue("password")}).then(this.onLoginComplete.bind(this),function(e){t(78===e.api_error_code?{message:e.message,type:"passwordError"}:{message:e.message,type:"emailError"})})}.bind(this),function(e){t({message:e[0],type:"passwordError"})})}.bind(this),function(e){t({message:e[0],type:"emailError"})})}});T.prototype.className="UserRegister",t.exports=a.register(T)},function(t,e,i){"use strict";var n=i(322),s=i(19);i(292),i(325);var o=n.extend({});o.prototype.className="UnauthLoggedOutHomePage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(8),a=i(54),r=i(31),l=i(46),h=i(27),d=n.extend({events:{},onContentReady:function c(){this.logout()},logout:function u(){var t=o.create("UserSessionResource",{disable_auth_failure_redirect:!0}),e=this.options.next||"/";e=r.appendQueryString(e,{logged_out:!0}),t.callDelete().then(function(){h.trackRegisterAction("logout"),a.sessionStorage.clear(),a.localStorage.clear(),l.logout().then(function(){h.navigateAfterLoginStatusChange(e)})})}});d.prototype.className="LogoutPage",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(171),a=o.extend({onContentReady:function r(){var t=this.extraData.userId;if(t){var e={};e[n.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(this.extraData.userId,e)}o.prototype.onContentReady.apply(this,arguments)},onUserUpdated:function l(){this.render()},setSticky:function h(t){this.getDropdown().setSticky(t)}});a.prototype.className="UserMenu",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({getLoggingObjectIdStr:function a(){return this.data.id}});o.prototype.className="Domain",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({onContentReady:function a(){this.checkGridContent()},checkGridContent:function r(){var t=this.getChildById("feedGrid");t&&!t.hasItems()&&this.$(".noData").show()}});o.prototype.className="DomainFeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(337);var o=n.extend({});o.prototype.className="AnnotationResults",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=o.extend({events:{"click .selectedFlashlightAnnotation":"onClose","click .unselectedFlashlightAnnotation":"onSelect"},onClose:function l(t){a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_ANNOTATION_UNSELECTED,this),t.stopPropagation()},onSelect:function h(t){a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_ANNOTATION_SELECTED,this),t.stopPropagation()}});r.prototype.className="FlashlightAnnotation",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(126),l=i(81);i(339),i(192),i(340),i(341);var h=80,d=564,c=a.extend({events:{click:"_onClick",transitionend:"_onTransitionEnd",webkitTransitionEnd:"_onTransitionEnd"},CssClassName:{HIDDEN:"hidden",NO_DISPLAY:"noDisplay",HIDE_CLOSEUP:"hideCloseup",INITIAL:"initial",ANIMATE_PIN:"animatePin"},onCreated:function u(){this.options.state_inital=!0,this.options.state_movePin=!1,this.options.state_endMovePin=!1},onContentReady:function p(){this.options.has_animation?(this.updateOptionsAndDom({state_inital:!0,state_movePin:!1,state_endMovePin:!1}),this._movePin()):this._setFlashlightDetails(),this._changeViewType(),this.listen(r,s.EVENT_RESIZE,this.onResize)},_setFlashlightDetails:function _(){this.onResize(),this._setImageWidth(),this._setupCropper(),this._setupScrollBar()},_setImageWidth:function g(){var t=this.data.images,e;if(t){e=t["564x"]?t["564x"].width:t.orig.width,e=Math.min(e,d);var i=this.$(".flashlightImageContainer");i.width(e)}},updateDom:function m(){var t=this.$(".flashlightImageContainer"),e=this.$(".Closeup");this.options.state_movePin&&(e.addClass(this.CssClassName.HIDE_CLOSEUP),t.addClass(this.CssClassName.ANIMATE_PIN)),this.options.state_endMovePin&&(e.addClass(this.CssClassName.NO_DISPLAY),this.$(".closeupResultsContainer").removeClass(this.CssClassName.NO_DISPLAY),this.$(".flashlightHeaderContainer").removeClass(this.CssClassName.NO_DISPLAY),t.removeClass(this.CssClassName.ANIMATE_PIN)),this.$(".flashlightContentContainer").toggleClass(this.CssClassName.INITIAL,this.options.state_inital),t.toggleClass(this.CssClassName.INITIAL,this.options.state_inital),this.$(".flashlightImage").toggleClass(this.CssClassName.INITIAL,this.options.state_inital),this.$el.toggleClass(this.CssClassName.INITIAL,this.options.state_inital)},onRemoved:function f(){l.getInstance().addViewToContext(this.previousView)},_changeViewType:function C(){var t=l.getInstance();this.previousView=t.getViewFromContext();var e={view_type:s.GEN.ViewType.FLASHLIGHT,view_parameter:s.GEN.ViewParameterType.PIN_FLASHLIGHT_RESULTS};t.addViewToContext(e)},_setupCropper:function E(){var t=this.getChildByModuleName("FlashlightEnabledImage");t.setupCropper()},_movePin:function v(){this.updateOptionsAndDom({state_movePin:!0,state_inital:!0,state_endMovePin:!1})},_onTransitionEnd:function I(t){n(t.target).hasClass("animatePin")&&(this.updateOptionsAndDom({state_inital:!1,state_endMovePin:!0,state_movePin:!1}),this._setFlashlightDetails())},_onClick:function T(t){var e=t.target;!e||e!==this.$el[0]&&e!==this.$(".closeupFlashlightContainer")[0]||(t.stopPropagation(),this.triggerEvent(s.EVENT_CLOSE,this,!0))},getOwnedScrollables:function N(){var t=this.$(".closeupResultsContainer");return"undefined"!=typeof t.simplebar?t.simplebar("getScrollElement"):n()},_setupScrollBar:function S(){i.e(7,function(){i(361);var t=this.$(".flashlightImageContainer"),e=this.$(".closeupResultsContainer");t.simplebar(),e.simplebar()}.bind(this))},onResize:function b(t){var e=window.innerHeight,i=e-h;this.$el.height(e),this.$(".flashlightImageContainer").height(i),this.$(".closeupResultsContainer").height(i)}});c.prototype.className="CloseupFlashlight",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(18),r=o.extend({onContentReady:function l(){this.options.state_selectedAnnotations={},this.options.state_cropData=null,this.options.state_lockFlashlightResults=!1;var t={};t[n.PUBSUB_TOPIC_FLASHLIGHT_CROPPER_CHANGED]=this.onCropperChanged,t[n.PUBSUB_TOPIC_ANNOTATION_UNSELECTED]=this.onAnnotationRemovedByUser,t[n.PUBSUB_TOPIC_ANNOTATION_SELECTED]=this.onSelectAnnotation,t[n.PUBSUB_TOPIC_ANNOTATIONS_ADDED_ENDED]=this.onAnnotationAddedEnded,this.pubsubSubscribe(n.PUBSUB_CHANNEL_SITE,t)},_updateVisualModule:function h(t,e){if(this.$(".visuallySimilarContainer")){var i=this.getChildById("visuallySimilar");if(!t)return void(i&&i.fadeOut(function(){i.destroy()}));var n={name:"VisuallySimilar",id:"VisuallySimilar",options:t};this.showLoading(),a.load(n).then(function(t){t.render().then(function(){this.getChildrenByModuleName("VisuallySimilar").forEach(function(t){this.removeChild(t)}.bind(this)),this.hideLoading(),this.insertChild(t,this.$(".visuallySimilarContainer")),t.fadeIn()}.bind(this))}.bind(this))}},onCropperChanged:function d(t,e,i){if(!this.options.state_lockFlashlightResults){this.options.state_lockFlashlightResults=!0;var n=null;i&&(n={pin_id:i.pinId,crop:i.crop,image_signature:i.image_signature,buyable_product:i.buyable_product},this.options.state_cropData=i),this.options.state_selectedAnnotations={},this._updateVisualModule(n,"VisualLiveSearchResource")}},onAnnotationRemovedByUser:function c(t,e,i){if(!this.options.state_lockFlashlightResults){this.options.state_lockFlashlightResults=!0;var n=i;if(n){var s=n.options.annotation;delete this.options.state_selectedAnnotations[s]}var o=null,a=this.options.state_cropData;o=a?{pin_id:a.pinId,crop:a.crop,text_filters:Object.keys(this.options.state_selectedAnnotations),buyable_product:a.buyable_product,image_signature:a.image_signature}:{text_filters:this.options.state_selectedAnnotations},this._updateVisualModule(o,"VisualLiveSearchResource")}},onSelectAnnotation:function u(t,e,i){if(!this.options.state_lockFlashlightResults){this.options.state_lockFlashlightResults=!0;var n=i;if(n){var s=n.options.annotation;this.options.state_selectedAnnotations[s]=!0}var o=this.options.state_cropData,a;a=o?{pin_id:o.pinId,crop:o.crop,text_filters:Object.keys(this.options.state_selectedAnnotations),buyable_product:o.buyable_product,image_signature:o.image_signature}:{text_filters:this.options.state_selectedAnnotations},this._updateVisualModule(a,"VisualLiveSearchResource")}},onAnnotationAddedEnded:function p(t,e,i){this.hideLoading(),this.options.state_lockFlashlightResults=!1}});r.prototype.className="CloseupFlashlightResults",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(18),r=i(23),l=o.extend({onContentReady:function h(){var t={};t[n.PUBSUB_TOPIC_ANNOTATIONS_ADDED]=this.onAnnotationsAdded,this.pubsubSubscribe(n.PUBSUB_CHANNEL_SITE,t)},onAnnotationsAdded:function d(t,e,i){var s={name:"AnnotationResults",id:"annotationResults",options:{annotations:i.annotations,selected_annotations:i.query_filters,search_identifier:i.search_identifier}},o=this.getChildByModuleName("AnnotationResults");o?o.fadeOut(function(){o.destroy()}):this.addingAnnotations=!1,a.load(s).then(function(t){t.render().then(function(){this.hideLoading(),this.insertChild(t,this.$(".flashlightAnnotationsContainer")),r.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_ANNOTATIONS_ADDED_ENDED,!0)}.bind(this))}.bind(this))}});l.prototype.className="FlashlightHeader",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(21),a=i(11),r=i(19),l=i(342),h=i(344),d=i(343),c=i(345),u=i(167),p=i(57),_=i(346),g=i(16),m=i(50),f=i(347),C=i(351),E=i(352),v=i(132),I=i(126),T=i(40),N=i(81),S=i(52),b=i(59),y=i(135),P=i(23),B=i(8),A=i(20),R=i(311),w=i(31),O=i(46),D=i(27);i(19),i(353),i(354),i(358),i(360);var x=g.getLogger("Closeup"),L="actions",k="content",U="sidebar",M="bottom",F=".closeupActionBarContainer",$="pinsFromHere",H=736,V=564,G=57,W=40,K=14,j=m.extend({events:{click:"_onClick","click button.close":"onCloseButtonClick","click div.arrow-nav":"onNavArrowClick"},CssClassName:{CAN_CLOSE:"canClose",CLOSE_BUTTON_VISIBLE:"visible",LITE:"lite"},getOwnedScrollables:function Y(){return this.options.can_close?this.$el:s()},onCreated:function q(){if(this.closeDiv=s('<button class="Button borderless close"><em></em>&nbsp;</button>'),!this.options.is_csr&&-1===window.location.href.indexOf("web-result")){b.instance.v2ActivateExperiment("web_modular_closeup");var t=b.instance.v2InGroup("web_modular_closeup",["without-board-rep","employee"]);t&&this.$el.addClass("closeupRemoveBoardRep");var e=b.instance.v2InGroup("web_modular_closeup",["enabled","employee"]);e&&this.$el.addClass("modularCloseup")}},onKeydown:function z(t){var e=y.get();e.hasModals()||(this.options.can_close&&t.keyCode===a.KeyCode.ESCAPE&&this._close(),t.keyCode!==a.KeyCode.RIGHT&&t.keyCode!==a.KeyCode.LEFT||this.navigateStarted||this._shouldRenderAsLite()?t.keyCode===a.KeyCode.ENTER&&this._actionBar&&!this._actionBar.areDropdownsShowing()&&S.body_is_active()&&(this._logCustomContextEvent(a.GEN.EventType.KEYPRESS,a.GEN.ElementType.CLOSEUP_PINIT_SHORTCUT,a.GEN.ComponentType.CLOSEUP_SHORTCUT_BUTTON,{}),this._actionBar.triggerPinItButton()):(this._logCustomContextEvent(a.GEN.EventType.KEYPRESS,t.keyCode===a.KeyCode.RIGHT?a.GEN.ElementType.NEXT_CLOSEUP_BUTTON:a.GEN.ElementType.PREV_CLOSEUP_BUTTON,a.GEN.ComponentType.CLOSEUP_NAV_BUTTON,{}),this.triggerCloseupNav(t.keyCode)))},triggerCloseupNav:function X(t){this.sourceContentManager||this.setSourceContentManager(),this.navigateStarted=!0,this.sourceContentManager.setItemByKeyPress(t),this._removeTransitionContent(),this.clearBottomRenderInterval()},setNewCloseupPin:function Q(t){var e=this.getChildById(k);t&&e?e.changeCloseupContent(t):this._close()},setSourceContentManager:function Z(){this.options.source_data&&this.resource.options.id?this.sourceContentManager=new C(this.resource.options.id,this.options.source_data,this.setNewCloseupPin.bind(this)):this.sourceContentManager=null},_close:function J(){this._removeTransitionContent(),delete this.options.source_data,this.options.origin_location?this.options.force_refresh?this.navigate(this.options.origin_location,null,a.GEN.ForceRefreshType.PAGE):this.navigate(this.options.origin_location):this.triggerEvent(a.EVENT_CLOSE,this,!0)},_unsticky:function tt(){this._actionBar&&this._actionBar.unsticky()},_updateSticky:function et(){if(this.parent&&this.inDom&&this._actionBar){var t=this.$(".pinActionBarStickyContainer"),e=this.getScrollableElement(),i=0;this.options.can_close||T.instance.is_mobile_agent||(i=s(".Header").height()),this._actionBar.updateSticky({$boundTo:t,$scrollable:e,headerHeight:i})}},resetCloseButton:function it(){this.$close.removeClass(this.CssClassName.CLOSE_BUTTON_VISIBLE)},onAddedToDom:function nt(){if(this.hasError)return this.detachElement(),void this.destroy();this._positionActionBar(),this.options.can_close&&s("body").on("keydown.closeup",function(t){this.onKeydown(t)}.bind(this)),this.childListen(a.EVENT_NAVIGATE,this.onChildNavigate);var t=D.scrollbarWidth();this.$close||(this.$close=this.$(".close")),this.$close.css("right",t+K+"px").addClass(this.CssClassName.CLOSE_BUTTON_VISIBLE),T.instance.is_mobile_agent&&T.instance.deep_link_action&&T.instance.is_tablet_agent||this._focusOnContent();var e=this.getChildById(k);e&&n.defer(e.addTutorials.bind(e))},_positionActionBar:function st(){this._actionBar&&this.inDom&&this.contentReady&&this._updateSticky()},_focusOnContent:function ot(){this.$(".closeupContainer").attr("tabindex",-1).on("blur focusout",function(){s(this).removeAttr("tabindex")}).focus(),this.options.can_close?s(".Closeup").scrollTop(0):s(window).scrollTop(0)},onContentReady:function at(){if(O.isAuthenticated()||(o.set(a.COOKIE_LAST_UNAUTH_PIN_ID,this.data.id),R.logUrl()),this._actionBar=this.getChildById(L),this.options.show_repin){var t={};t[a.PUBSUB_TOPIC_APPBASE_CONTENT_READY]=this.showRepinModal,this.pubsubSubscribe(a.PUBSUB_CHANNEL_MAIN_MODULE,t)}else this.options.show_edit&&(this.extraData.canEdit&&this.showEditModal(),delete this.options.show_edit);this._positionActionBar(),this.extraData&&this.extraData.showContextualReg&&v.showSignupModal("CloseupSignupModal",this.resource,{sent_pin:!0,sender:this.options.sender,redirect_to_signup:!0}),this._sourceData={};var e=this.getChildById(k);e&&(n.defer(e.addTutorials.bind(e)),N.getInstance().setupViewContextLogging(this,e,a.GEN.ComponentType.PIN_CLOSEUP_BODY,{}));var i={};i[a.PUBSUB_TOPIC_PIN_DELETED]=this.onPinDeleted,i[a.PUBSUB_TOPIC_PIN_HIDDEN]=this.onPinHidden,this.pubsubSubscribe(this.resource.options.id,i),this.childListen(a.EVENT_SHOW_PINS_FROM_HERE,this._addPinsFromHereToRelatedPinsFeed),this.listen(A.instance,a.EVENT_ROUTE_MATCHED,this.onRouteMatched),this._focusOnContent()},onPinDeleted:function rt(t){this.options.can_close?this._close():(this.destroy(),this.navigate("/"))},onPinHidden:function lt(t){this.options.can_close&&this._close()},getCloseupRichTypes:function ht(){return u.getCloseupRichTypes(this.data)},_removeTransitionContent:function dt(){this._removeTransitionImage(),this._removeTransitionTitle()},_removeTransitionTitle:function ct(){this.transitionText&&(this.transitionText.remove(),this.transitionText=null)},_removeTransitionImage:function ut(){this.transitionPinImage&&(this.transitionPinImage.remove(),this.transitionPinImage=null)},removeTransitionImageAndTextOnLoad:function pt(t){var e=t.getPin(),i=e.getPinMedia(),n=i.attr("src");i.load(this._removeTransitionContent.bind(this)),i.error(this._removeTransitionContent.bind(this)),i.attr("src",n),i[0]&&i[0].complete&&this._removeTransitionContent()},onRemovedFromDom:function _t(){this._actionBar&&this._actionBar.removeDropdowns(),this._unsticky(),this.options.can_close&&s("body").off("keydown.closeup"),this._removeListeners();var t=this.getPin();if(t){var e=t.getId();e&&P.instance.publish(a.PUBSUB_CHANNEL_SITE,a.PUBSUB_TOPIC_CLOSE_CLOSEUP,e)}},_shouldRenderAsLite:function gt(){var t=p.instance.getPlacedExperience(a.GEN.Placement.WEB_PIN_CLOSEUP);return t&&(t.experience_id===a.GEN.Experience.WEB_PIN_CLOSEUP_LITE||t.display_data&&t.display_data.lite)},isPinInSourceData:function mt(){var t=this.resource.options.id,e=this.options.source_data;if(!e||!e.data)return!1;for(var i=0;i<e.data.length;i++)if(e.data[i]&&"pin"===e.data[i].type&&e.data[i].id===t)return!0;return!1},_getPinActionBarOptions:function ft(t,e,i){var n={is_csr:t,pin_id:e,is_board_collaborative:i&&i.board&&i.board.is_collaborative};return this.options.can_close&&(n.class_name="canClose"),n},render:function Ct(){if(!this.options.can_close)try{return m.prototype.render.apply(this,arguments)}catch(t){throw x.error(t),t}this.$el.empty().addClass(this.CssClassName.CAN_CLOSE);var e=this._shouldRenderAsLite();e&&this.$el.addClass(this.CssClassName.LITE);var i=this.options.is_csr;if(this.$el.append(this.closeDiv),!O.isAuthenticated()&&!T.instance.is_mobile_agent){var n=B.clone(this.resource);n.options.field_set_key="detailed";var s=new E({resource:n,options:{pin_overlay:!0}});return s.render().then(function(){this.insertChild(s,this.$el)}.bind(this))}var o=!i&&b.instance.v2InGroup("web_modular_closeup",["enabled","employee"]),r=i?'<div class="sidebarContainer"></div>':"";this.$el.append('<div class="closeupActionBarContainer" data-component-type="'+a.GEN.ComponentType.MODAL_PIN+'"></div><div class="closeupContainer">'+r+'</div><div class="closeupBottom"></div>');var d=this.$(".closeupContainer"),u=!!this.transitionText;u&&d.append(this.transitionText);var p=!!this.transitionPinImage;p&&d.append(this.transitionPinImage);var _=B.clone(this.resource);_.options.allow_stale=!0;var g=this.resource.options.id,C=B.clone(this.resource);C.options.field_set_key="detailed";var v=this.isPinInSourceData(),I={is_csr:i,show_comments:!i&&this.options.show_comments,is_modular_closeup:o,has_source_data:v};v&&this.setSourceContentManager();var y=this.sourceContentManager&&this.sourceContentManager.getCurrentPinData(),P=y&&y.promoter;!i&&P&&(I.show_promoted_pin_credit_detailed=!0,I.promoter_detailed_view=P);var A=new h({id:k,resource:C,options:I}),R=this.$(F),w=new f({id:L,options:this._getPinActionBarOptions(i,g,y),resource:_});if(w.errorStrategy=a.ErrorStrategy.BUBBLE,w.render(),this._actionBar=w,this.insertChild(w,R),i){var D=B.clone(this.resource);D.options.field_set_key="summary";var $=this.$(".sidebarContainer"),H=new c({id:U,resource:D,options:{force_render_remote:!0,is_csr:i}});H.render().then(function(){this.insertChild(H,$),$.removeClass("loading"),this._focusOnContent()}.bind(this))}var V=A.render().then(function(){this.insertChild(A,d),p&&this.removeTransitionImageAndTextOnLoad(A),this.contentReady=!0,this.onContentReady();var t=e?"firstPinnerRelatedPinsOnly":null,n=new l({id:M,options:{pin_id:this.resource.options.id,view_type:t,is_csr:i,domain:A.data.domain,search_query:this.searchQuery}}),s=this.$(".closeupBottom");n.render().then(function(){this.insertChild(n,s);var t=this.getChildById(M);N.getInstance().setupViewContextLogging(this,t,a.GEN.ComponentType.PIN_CLOSEUP_RELATED_PINS,{})}.bind(this)),S.blur();var o=!i&&b.instance.v2InGroup("web_modular_closeup",["without-board-rep","enabled","employee"]);o&&this._focusOnContent()}.bind(this));return p?Promise.resolve(void 0):V},handleError:function Et(t){t.api_error_code===a.API_ERROR_PIN_NOT_FOUND&&(this.hasError=!0),m.prototype.handleError.call(this,t)},setCloseupBottomMinHeight:function vt(){var t=this.$(".closeupContainer").height(),e=this.getScrollableElement().scrollTop(),i=this.getChildById(M);if(i){var n=I.height,s=e+n-t;i.setMinHeight(s)}},removeCloseupBottomMinHeight:function It(){var t=this.getChildById(M);t&&t.setMinHeight(null)},showRepinModal:function Tt(){this.options.show_repin&&this._actionBar&&O.isAuthenticated()&&(this._actionBar.showRepinModal(),delete this.options.show_repin)},showEditModal:function Nt(){var t=this.getChildById(k);return t.showEditModal()},setAsMainModule:function St(t,e,i){var s=this.getChildById(k),o=this.getChildById(U),a=this.getChildById(M),r=e.options.id,l=this.getUnauthCloseup(),h=this.options.is_csr,d=b.instance.v2InGroup("web_modular_closeup",["enabled","employee"]),c=!s||h&&!o||!a;if(c)return i.evt?h?i.evt.data.csrId=r:i.evt.data.pinId=r:l&&l.setResource({name:e.name,options:n.extend({},e.options)}),m.prototype.setAsMainModule.apply(this,arguments);if(t.can_close?(this.$el.scrollTop(0),0===this.closeDiv.parent().length&&(this.$el.prepend(this.closeDiv),this.$el.addClass(this.CssClassName.CAN_CLOSE))):this.closeDiv.parent().length>0&&(this.closeDiv.remove(),this.$el.removeClass(this.CssClassName.CAN_CLOSE)),this.options.can_close=t.can_close,this.hasSameOptions(t,e)&&this.contentReady&&!this._forceRefreshRequested(i))return Promise.resolve(void 0);this.setOptions(t),this.setResource(e);var u=this.sourceContentManager&&this.sourceContentManager.getCurrentPinData();u?(u.id!==r&&(this.sourceContentManager.setupSourceContentManager(this.options.source_data,r),u=this.sourceContentManager.getCurrentPinData()),this.transitionPinImage=this._getCloseupTransitionPinImage(),this.transitionPinImage&&(this.$(".closeupContainer").prepend(this.transitionPinImage),s.emptyCloseupImage(this.transitionPinImage[0].style.height,u)),d&&(this.transitionText=this._getTransitionPinTitle(),this.transitionText&&this.$(".closeupContainer").prepend(this.transitionText))):i.evt&&i.evt.currentTarget||s.empty();var p={name:e.name,options:n.extend({},e.options)},_=B.clone(this.resource);_.options.allow_stale=!0;var g=new f({id:L,options:this._getPinActionBarOptions(this.options.is_csr,r,u),resource:_});return p.options.field_set_key="detailed",s.setResource(p),u&&u.promoter?(s.options.show_promoted_pin_credit_detailed=!0,s.options.promoter_detailed_view=u.promoter):s.options.show_promoted_pin_credit_detailed=!1,this.transitionPinImage&&(s.options.spinner={enable:!1}),this.setCloseupBottomMinHeight(),g.render(),s.render().then(function(){var e=this.$(F);this._actionBar&&this._actionBar.destroy(),this.insertChild(g,e),this._actionBar=g,this._positionActionBar();var i=this.getChildByModuleName("ToolTipPulser");i&&i.loadPulser(),this.removeTransitionImageAndTextOnLoad(s),a.setOptions({pin_id:r}),t.is_csr?(a.updateOptions({is_csr:!0,domain:o.data.domain}),a.render().then(function(){this.removeCloseupBottomMinHeight()}.bind(this))):this.bottomRenderInterval=window.setInterval(function(){a.render().then(function(){this.removeCloseupBottomMinHeight()}.bind(this)),this.clearBottomRenderInterval()}.bind(this),1e3),this.navigateStarted=!1,S.blur()}.bind(this))},onRouteMatched:function bt(t){if(!t.navigateData.fromNavigate){this._sourceData[this.resource.options.id]=this.options.source_data;var e=t.resource&&t.resource.options&&t.resource.options.id,i=this._sourceData[e];i&&(this.updateOptions({source_data:i}),this.sourceContentManager.setupSourceContentManager(this.options.source_data,e))}},onChildNavigate:function yt(t){if(this.log.debug("Closeup got navigate event from child",t.target,"for url:",t.data.url),!w.isOffsiteUrl(t.data.url)){var e=t.target.data&&t.target.data.id,i=this.getUnauthCloseup();if("CloseupContent"===t.target.className&&this.navigateStarted)t.data.handled=!0;else if(t.target.$el.closest(".CloseupRelatedPins").length>0||i===t.currentTarget&&"Pin"===t.target.className){var n=this.getChildById(M)||i,s=t.data.url;if(!n||-1===s.indexOf("/pin/")||-1!==s.indexOf("/repins/")||-1!==s.indexOf("/likes/"))return;t.data.handled=!0,this._sourceData[this.resource.options.id]=this.options.source_data,this.updateOptions({source_data:n.getChildInfoByModuleName("GridItems")}),this.sourceContentManager&&this.sourceContentManager.setupSourceContentManager(this.options.source_data,e)}return!1}},onNavArrowClick:function Pt(t){var e=t.target;e&&(e.classList.contains("right-arrow")?this.triggerCloseupNav(a.KeyCode.RIGHT):e.classList.contains("left-arrow")&&this.triggerCloseupNav(a.KeyCode.LEFT))},onCloseButtonClick:function Bt(t){return this._close(),this.resetCloseButton(),!1},_onClick:function At(t){if(this.options.can_close){var e=t.target;(e&&(e===this.$el[0]||e===this.$(".closeupContainer")[0])||e===this.$(".closeupBottom")[0])&&(t.stopPropagation(),this._close())}},getUnauthCloseup:function Rt(){return this.getChildByModuleName("UnauthPinInGridCloseup")},performTransition:function wt(t){var e=t.evt&&t.evt.target||null,i=t.evt&&t.evt.currentTarget||null;return e&&"Pin"===e.className&&"summary"===e._getViewType()&&"Closeup"!==i.className&&!this.options.is_csr&&(this.transitionPinImage=this._getTransitionPinImage(e),
this.transitionText=this._getTransitionPinTitle(e),this.searchQuery=t.currentModule&&t.currentModule.searchOptions?t.currentModule.searchOptions.query:null),this.render()},calculateTransitionCSS:function Ot(t,e){var i=t.height,n=t.width,s=H,o,a,r,l=!this.options.is_csr&&b.instance.v2InGroup("web_modular_closeup",["enabled","employee"]);l?(s=V,n>s&&(i=s*i/n,n=s),o=G,a=32):(s>n?(r=Math.round((s-n)/2),o=W>r?r+G:W+G):o=G,a=(s-n)/2);var h={linkImageCSS:{height:i,padding:o+"px "+a+"px"+(o-G)+"px","z-index":10},imageCSS:{height:i,width:n}};return e&&(h.linkImageCSS.padding=G+"px 0px 0px"),h},_getTransitionPinTitle:function Dt(t){var e=b.instance.v2InGroup("web_modular_closeup",["enabled","employee"]);if(e){var i,n,s=t&&t.data||this.sourceContentManager&&this.sourceContentManager.getCurrentPinData();return s&&s.rich_summary&&(i=s.rich_summary.site_name,n=s.rich_summary.display_name),this._getTransitionPinTitleDOMElements(i,n)}},_getTransitionPinTitleDOMElements:function xt(t,e){var i=document.createElement("div");if(i.className="transitionTitle",t&&e){var n,o;n=document.createElement("div"),n.className="sourceWrapper";var a=document.createTextNode(t);n.appendChild(a),o=document.createElement("h2"),o.className="pinTitle";var r=document.createTextNode(e);o.appendChild(r),i.appendChild(n),i.appendChild(o)}else{var l=document.createElement("div");l.className="noTitle",i.appendChild(l)}return s(i)},_getTransitionPinImage:function Lt(t){var e=t.getPinMedia();if(!e||t.isPinStory())return null;var i=e.clone(),n;if(t.data&&t.data.embed&&t.data.embed.src)i=s("<div class='pinImg videoTransition noFade'></div>"),n=s("<a class='transitionImage isEmbeddedVideo'></a>").append(i),0===t.data.embed.src.indexOf("https://vine.co/")&&n.addClass("isVine");else{var o=t.getSourceUrl()||t.getImageUrl(a.IMAGE_SIZE_ORIG);n=s("<a class='transitionImage'></a>").append(i),n[0].onclick=function(){this._logCustomContextEvent(a.GEN.EventType.CLICK,a.GEN.ElementType.PIN_CLOSEUP_TRANSITION_IMAGE,a.GEN.ComponentType.PIN_CLOSEUP_TRANSITION_IMAGE,{}),this.navigate(o,null,!1,{pinId:t.getId()})}.bind(this),i.length&&(i[0].onload=null)}var r=this.calculateTransitionCSS(_.getDetailedImageDimensions(t.data),t.isVideo()&&t.data.attribution);return n.css(r.linkImageCSS),i.css(r.imageCSS),n},_getCloseupTransitionPinImage:function kt(){var t=this.sourceContentManager&&this.sourceContentManager.getCurrentPinData();if(!t||t.embed&&"pinstory"===t.embed.subtype)return null;var e,i=t.embed&&t.embed.src;i?(e=document.createElement("div"),e.className="pinImg videoTransition noFade",0===i.indexOf("https://vine.co/")&&(e.className+=" isVine")):(e=document.createElement("img"),e.src=t.images["236x"].url,e.className="pinImg fullBleed noFade"),e.alt=t.title,e.onload=null;var n=document.createElement("a");n.className="transitionImage",i&&(n.className+=" isEmbeddedVideo"),n.onclick=function(){this.navigate(t.link,null,null,{pinId:t.id})}.bind(this),n.appendChild(e);var o=this.calculateTransitionCSS(_.getDetailedImageDimensions(t),t.is_video&&t.attribution);return s(n).css(o.linkImageCSS),o.imageCSS.background=t.dominant_color||"#f8f8f8",s(e).css(o.imageCSS),s(n)},_getCloseupTransitionPinTitle:function Ut(){var t=this.sourceContentManager&&this.sourceContentManager.getCurrentPinData();if(!t||t.embed&&"pinstory"===t.embed.subtype)return null;var e,i;return t.rich_summary&&(e=t.rich_summary.site_name,i=t.rich_summary.display_name),this._getTransitionPinTitleDOMElements(e,i)},getPin:function Mt(){var t=this.getChildByModuleName("UnauthCloseup")||this.getChildByModuleName("FacebookShareUnauthCloseupWeb")||this.getChildByModuleName("FBOCloseupMweb")||this.getChildByModuleName("UnauthPinInGridCloseup")||this.getChildById(k);return t?t.getPin():null},getLoggingObjectIdStr:function Ft(){return this.resource.options.id},clearBottomRenderInterval:function $t(){window.clearInterval(this.bottomRenderInterval),this.bottomRenderInterval=null,this._focusOnContent()},_addPinsFromHereToRelatedPinsFeed:function Ht(){var t=this.getChildById(k),e=new d({id:$,options:{pin_id:this.options.pin_id,show_pins_from_here:!0,place:t.data&&t.data.place}});e.render().then(function(){this.insertChild(e,this.$(".pinsFromHereWrapper"))}.bind(this))}});j.prototype.className="Closeup",t.exports=r.register(j)},function(t,e,i){"use strict";var n=i(343),s=i(19),o=i(50),a="relatedPins",r="relatedBoards",l=o.extend({onContentReady:function h(){},renderCloseupRelatedPins:function d(t){return this.closeupRelatedPins?this.closeupRelatedPins.options.initial_column_lengths=[t,t,t]:(this.closeupRelatedPins=new n({id:a,options:{show_seo_canonical_pins:this.options.show_seo_canonical_pins,pin_id:this.options.pin_id,initial_column_lengths:[t,t,t]}}),this.appendChild(this.closeupRelatedPins)),this.closeupRelatedPins.render()},onChildRendered:function c(t){var e=t.id===a,i=t.id===r,n,s;if(e&&(n=t.getChildByModuleName("Grid"),s=this.$(".relatedPinsWrapper")),i&&(n=t.getChildByModuleName("PagedGrid"),s=this.$(".relatedBoardsWrapper")),n&&s.length){var o=n.hasItems(),l=o?"visible":"hidden";s.css("visibility",l)}},onDeepLink:function u(){this.relatedPinsInterval&&(window.clearInterval(this.relatedPinsInterval),this.relatedPinsInterval=null)},setMinHeight:function p(t){this.$el.css("min-height",null!==t?t:"")}});l.prototype.className="CloseupBottom",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(8),h=i(27);i(116),i(151),i(129);var d="annotationButton",c=r.extend({events:{"click .moreRelatedPins":"switchToNextRelatedPinsSet"},getOwnedScrollables:function u(){return"relatedPinsGrid"===this.options.view_type?this.$(".pinGridWrapper"):s()},onContentReady:function p(){"relatedPinsGrid"!==this.options.view_type&&"slides"!==this.options.view_type&&this.destroyIfEmpty(),this.childListen(o.EVENT_BUTTON_CLICK,this.onTypeClick),"slides"===this.options.view_type&&(this.currentSet=0,this.$relatedPinsSets=this.$(".relatedPinsBottom"),this.NUMBER_OF_RELATED_PIN_SETS=this.extraData.NUMBER_OF_RELATED_PIN_SETS,this.NUMBER_OF_PINS_PER_SET=this.extraData.NUMBER_OF_PINS_PER_SET)},switchToNextRelatedPinsSet:function _(){var t=(this.currentSet+1)%this.NUMBER_OF_RELATED_PIN_SETS,e=this.$relatedPinsSets.children().eq(this.currentSet),i=e.children(),n=this.$relatedPinsSets.children().eq(t),o=n.children();e.fadeOut(300,function(){n.css("display","flex").show(),o.each(function(t){var e=s(this);setTimeout(e.removeClass.bind(e,"invisible"),100*(t+1))}),i.addClass("invisible")}),this.currentSet=t,h.trackRegisterAction("pin_closeup_more_related_pins_click")},isEmpty:function g(){if(!this.contentReady)return!1;var t=this.getChildById("relatedPinsFeed");return!t||!t.hasItems()},getGrid:function m(){return this.getChildById("relatedPinsFeed")},hideGrid:function f(){this.getGrid().hide()},showGrid:function C(){this.getGrid().show()},onTypeClick:function E(t){var e=t.target;if(e.options.class_name===d&&!e.isActive()){n.each(this.getChildrenByModuleName("Button"),function(t){t.setActive(t===e)}),e.showLoading();var i=e.hideLoading.bind(e);e.options.annotation?this.showAnnotatedPins(e.options.annotation,i):this.showRelatedPins(i)}},showRelatedPins:function v(t){this.updateRelatedPinsGrid(l.create("RelatedPinFeedResource",{pin:this.options.pin_id}),t)},showAnnotatedPins:function I(t,e){this.updateRelatedPinsGrid(l.create("InterestsFeedResource",{interest:t}),e)},updateRelatedPinsGrid:function T(t,e){var i=this.getGrid();this.$el.css("height",this.$el.height()),i.emptyItems(),i.setItemsResource(t);var n=function(){(e||function(){})(),this.$el.css("height","auto")}.bind(this);i.renderItems(n,n)}});c.prototype.className="CloseupRelatedPins",t.exports=a.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(193),a=i(50);i(166);var r=a.extend({getPin:function l(){return this.getChildById("pin")},showEditModal:function h(){var t=this.getPin();return t.showEditModal()},changeCloseupContent:function d(t){var e="/pin/"+t+"/";this.navigate(e)},emptyCloseupImage:function c(t,e){var i=this.getChildById("pin");i&&i.emptyPaddedPin(t,e)},addTutorials:function u(){this.getPin()&&o.launchPlacedExperience(n.GEN.Placement.WEB_PIN_CLOSEUP,{pin_id:this.data.id})}});r.prototype.className="CloseupContent",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(19),s=i(50),o=s.extend({});o.prototype.className="CloseupSidebar",t.exports=n.register(o)},function(t,e){"use strict";var i=736,n=370,s=553,o=166,a={getDetailedImageDimensions:function r(t){var e={width:i,height:n},a={youtube:e,vimeo:e,vevo:e,soundcloud:{width:s,height:o}};if(t.is_playable&&(t.is_video||t.attribution&&t.attribution.embed)){if(t.attribution){var r=a[t.attribution.provider_name];if(r)return r}if(t.embed)return t.embed}return t.images["736x"]}};t.exports=a},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(57),l=i(50),h=i(348),d=i(14),c=i(18),u=i(8);i(171),i(349),i(130),i(173),i(181),i(350),i(211);var p="pinItButton",_="state_likeCount",g="state_repinCount",m=l.extend({CssClassName:{NO_STATS:"noStats"},onContentReady:function f(){l.prototype.onContentReady.apply(this,arguments);var t=this.options.pin_id;if(t){var e={};e[o.PUBSUB_TOPIC_PIN_LIKED]=this.onPinLiked,e[o.PUBSUB_TOPIC_PIN_UNLIKED]=this.onPinUnliked,e[o.PUBSUB_TOPIC_PIN_REPINNED]=this.onPinRepinned,this.pubsubSubscribe(t,e)}if(this.childListen(o.EVENT_MESSAGE_SENT,this.onMessageSent),this.childListen(o.EVENT_REQUIRES_AUTHENTICATION,function(t){t.data.contextualResource||(t.data.contextualResource=this.getContextualResource())}),this.options[_]=this.data.like_count,this.options[g]=this.data.repin_count,this.gatorData=this.data.aggregated_pin_data,this.gatorData){var i=this.gatorData&&this.gatorData.aggregated_stats;i&&i.likes&&(this.options[_]=i&&i.likes),i&&i.saves&&i.saves>1?this.options[g]=i.saves:this.options[g]=1}},onMessageSent:function C(t){"sendPinButton"===t.currentTarget.id&&t.currentTarget.resetDropdown()},onAddedToDom:function E(){r.instance.isPlacedExperience(o.GEN.Placement.WEB_PIN_CLOSEUP,o.GEN.Experience.WEB_PIN_CLOSEUP_LITE)&&this.showSavePinTooltip()},removeDropdowns:function v(){var t=this.getDropdowns();n.each(t,function(t){t.hide()})},showSavePinTooltip:function I(){var t=this.getChildById(p);if(t){var e=d._("<strong>Want to save this Pin for yourself?</strong> Go ahead and Pin It.");this.extraData&&this.extraData.unauthPinCloseupDisplayData&&this.extraData.unauthPinCloseupDisplayData.copy&&(e=this.extraData.unauthPinCloseupDisplayData.copy);var i={name:"Dropdown",options:{anchor:t.$el,class_name:"large",fixed:!1,position_point:"BOTTOM_LEFT",text:e}};c.load(i).then(function(t){t.render().then(function(){s("body").append(t.$el),t.fadeIn()})})}},getDropdowns:function T(){var t=this.getChildrenByModuleName("Dropdown")||[],e=this.getChildrenByModuleName("DropdownButton");return n.each(e,function(e){var i=e.getDropdown();t.push(i)}),t},areDropdownsShowing:function N(){for(var t=this.getDropdowns(),e=0;e<t.length;e++){var i=t[e];if(i.isShowing())return!0}return!1},getContextualResource:function S(){return u.create("PinResource",{id:this.options.pin_id})},showRepinModal:function b(){var t=this.getChildById(p);t.showModalSubmodule()},getLoadingSpinnerOptions:function y(){return null},onPinRepinned:function P(t,e,i){i.board&&"secret"!==i.board.privacy&&this.updateOptionsAndDom({state_repinCount:this.options[g]+1})},onPinLiked:function B(){this.updateOptionsAndDom({state_likeCount:this.options[_]+1})},onPinUnliked:function A(){this.updateOptionsAndDom({state_likeCount:this.options[_]-1})},setDropdownsFixed:function R(t){var e=this.getDropdowns();n.each(e,function(e){var i=n.clone(e.options);i.fixed=t,e.setOptions(i),e.positionModule()})},updateSticky:function w(t){this._sticky||(this._sticky=new h(this.$el,t),this.listen(this._sticky,o.EVENT_STICKY_FIXED,function(t){this.setDropdownsFixed(t)}))},unsticky:function O(){this._sticky&&this._sticky.unSticky()},getLoggingObjectIdStr:function D(){return this.options.pin_id},triggerPinItButton:function x(){var t=this.getChildById(p);t&&t.onClick()},updateDom:function L(){var t=this.$(".likeCountContainer");t.find(".countInfo").text(this.options[_]),t.toggleClass(this.CssClassName.NO_STATS,!this.options[_]);var e=this.$(".repinCountContainer");e.find(".countInfo").text(this.options[g]),e.toggleClass(this.CssClassName.NO_STATS,!this.options[g])}});m.prototype.className="PinActionBar",t.exports=a.register(m)},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},s=i(2),o=i(1),a=i(2),r=i(3),l=i(11),h=i(52),d="sticky",c="absolute",u="below",p=c+" "+u,_=p+" "+d,g=d,m=0,f=1,C=2,E=function v(t,e){this.$el=t,this.elementHeight=null,this.headerHeight=e.headerHeight,this.boundElementHeight=null,this.$boundTo=e.$boundTo,this.$scrollable=e.$scrollable,this.updateFixed=this.updateFixed.bind(this),this._onScroll=this._onScroll.bind(this),this.$scrollable.on("scroll.sticky",this._onScroll),this.pendingScrollRAF=!1,this.lastState=null,h.deferDomManipulation(function(){this.elementHeight=t.height(),this.boundElementHeight=this.$boundTo.height()}.bind(this))};o.extend(E.prototype,r.Events),E.prototype.destroy=function(){this.$scrollable.off("scroll.sticky",this.updateFixed)},E.prototype.unSticky=function(){this.destroy()},E.prototype._onScroll=function(t){this.pendingScrollRAF||(h.deferDomManipulation(function(){return this.scrollTop=this.$scrollable.scrollTop(),this.scrollTop===this.lastScrollTop?void(this.pendingScrollRAF=!1):(this.updateFixed(),this.lastScrollTop=this.scrollTop,void(this.pendingScrollRAF=!1))}.bind(this)),this.pendingScrollRAF=!0)},E.prototype.updateFixed=function(){this.boundElementHeight=this.$boundTo.height();var t=a(window),e=t.scrollTop(),i=e,n=this.$boundTo.offset().top,s=n-this.headerHeight,o=n+this.boundElementHeight-this.headerHeight,r;r=i>=s&&o>=i?f:i>=o?C:m,r!==this.lastState&&(r===f?(this.$el.css("top","").addClass(d).removeClass(p),this.trigger(l.EVENT_STICKY_FIXED,!0)):r===C?(this.$el.removeClass(d),this.trigger(l.EVENT_STICKY_FIXED,!1),this.handleReachingBottom()):r===m&&(this.$el.removeClass(_),this.trigger(l.EVENT_STICKY_NORMAL),this.trigger(l.EVENT_STICKY_FIXED,!1))),this.lastState=r},E.prototype.handleReachingBottom=function(){if(!this.$el.hasClass(p)){var t=this.boundElementHeight||0,e=this.$el.css("top");e=e?e.split("px")[0]:0,e=parseInt(e,10)||0,this.$el.addClass(c+" "+u).css("top",t+e+1)}},s.fn.sticky=function(t){return this.each(function(e,i){var s=a(i),o=s.data(g);if(o&&(o.destroy(),s.removeData(d)),"unsticky"===t);else if("object"===("undefined"==typeof t?"undefined":n(t))){var r={$scrollable:t.$scrollable,$boundTo:t.$boundTo,headerHeight:t.headerHeight||0};t.$scrollable&&(o=new E(s,r),s.data(g,o))}}),this},t.exports=E},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(130),l=r.extend({CssClassName:n.extend(r.prototype.CssClassName,{IS_HIDDEN:"hidden"}),onContentReady:function h(){this.options.state_value="",this.updateOptions({is_hidden:!this.getValue()}),this.listen(this,o.EVENT_INCREMENT_BUTTON_CREATE,this.makeVisible),this.listen(this,o.EVENT_INCREMENT_BUTTON_DESTROY,this.makeInvisible)},updateDom:function d(){this.$el.text(this.options.state_value),this.$el.toggleClass(this.CssClassName.IS_HIDDEN,this.options.is_hidden)},getValue:function c(){if(void 0===this.options.actionCount){var t=s.trim(this.$el.text());return parseInt(t,10)}return this.options.actionCount},setValue:function u(t){this.options.actionCount=t,this.updateOptionsAndDom({state_value:t})},makeVisible:function p(){this.options.is_hidden&&this.updateOptionsAndDom({is_hidden:!1})},makeInvisible:function _(){this.options.is_hidden||this.updateOptionsAndDom({is_hidden:!0})},increment:function g(){var t=this.getValue();isNaN(t)&&(t=0),this.triggerEvent(o.EVENT_INCREMENT_BUTTON_CREATE,this.options.siblingButtonId,!0),t+=1,this.setValue(t)},decrement:function m(){var t=this.getValue();return t-=1,0===t?void this.triggerEvent(o.EVENT_INCREMENT_BUTTON_DESTROY,this.options.siblingButtonId,!0):void this.setValue(t)}});l.prototype.className="IncrementingNavigateButton",t.exports=a.register(l)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(243),r=i(46),l=i(83),h=n.extend({onClick:function d(){return r.isWriteBanned()?l.showWriteBanned(this):(a.shareFb({object_id:this.options.object_id,object_type:this.options.object_type,dialog_options:this.options.dialog_options,ga_category:this.options.ga_category}),this.triggerEvent(o.EVENT_BUTTON_CLICK,null,!0)),!1}});h.prototype.className="FacebookShareButton",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(8),o=10,a=function r(t,e,i){this.currentPinId=null,this.handleContentChange=i,this.sourceContent=[],this.currentPosition=null,this.resource=null,this.setupSourceContentManager(e,t)};a.prototype={setupSourceContentManager:function l(t,e){this.currentPinId=e,this.currentPosition=null,this.resource=this._duplicateResource(t.resource),this.sourceContent=[],this.appendSourceContent(t.data)},appendSourceContent:function h(t){t=t||[];for(var e=0,i=null,n=0;n<t.length;n++)i=t[n],i&&"pin"===i.type?(this.sourceContent.push(i),this.currentPinId===i.id&&(this.currentPosition=n-e)):e+=1},setupResource:function d(t,e){this.currentPinId=e,this.sourceContent=[],this.currentPosition=null,this.resource=t,this.getSourcePins()},_duplicateResource:function c(t){return s.create(t.getName(),t.copyOptions(!1))},setItemByKeyPress:function u(t){var e=this.keyCodeToIncrement(t);e&&this.setItemByIncrement(e)},keyCodeToIncrement:function p(t){switch(t){case n.KeyCode.LEFT:return-1;case n.KeyCode.RIGHT:return 1;default:return null}},setItemByIncrement:function _(t){null!==this.currentPosition&&this.sourceContent.length?this.currentPosition+t<0||this.resource.atEnd()&&this.currentPosition+t>=this.sourceContent.length?this.handleContentChange(null):(this.currentPosition>this.sourceContent.length-o&&!this.resource.atEnd()&&this.getSourcePins(),this.currentPosition+=t,this.currentPinId=this.sourceContent[this.currentPosition].id,this.handleContentChange(this.sourceContent[this.currentPosition].id)):this.getSourcePins()},getSourcePins:function g(){this.resource&&(0===this.sourceContent.length&&this.resource.resetBookmark(),this.resource.callGet({showError:!1}).then(function(t){this.setSourceContentFromResponse(t)}.bind(this)))},setSourceContentFromResponse:function m(t){var e=t.resource_response;e.error||this.appendSourceContent(e.data)},getCurrentPinData:function f(){return this.sourceContent[this.currentPosition]}},t.exports=a},function(t,e,i){"use strict";var n=i(2),s=i(21),o=i(11),a=i(19),r=i(50),l=i(59),h=i(14),d=i(18),c=i(27);i(151),i(347),i(166);var u=".ord-ne",p=".ord-nw",_=".flashlightContainer",g=r.extend({events:{"mousedown .PaddedPin":"onMouseDown"},onCreated:function m(){var t={};t[o.PUBSUB_TOPIC_FLASHLIGHT_CROPPER_CHANGED]=this.onCropperChanged,this.pubsubSubscribe(o.PUBSUB_CHANNEL_SITE,t),this.childListen(o.EVENT_UNAUTH_FLASHLIGHT_CONTAINER_CLICK,this._onFlashlightContainerClick)},onContentReady:function f(){this.options.pin_overlay||this.extraData.gridLayout||this.options.is_csr||this.$(".relatedPinsTitle").css({"padding-top":this.$(".PaddedPin").offset().top-this.$(".resultsContainer").offset().top-14});var t=n(_);if(this.childListen(o.EVENT_PULSER_CLICKED,function(){this.removeFlashlightEd(!t.length),n(this.anchor).click()}),!s.get(o.COOKIE_SUPPRESS_UNAUTH_FLASHLIGHT_ED)&&t.length){this.anchor=_;var e=h._("Give the crazy-fun new visual search tool a try!");this._setupEd(e),c.trackRegisterAction("unauth_flashlight_icon_education_loaded")}},onMouseDown:function C(t){0===n(_).length&&this.removeFlashlightEd(!0)},_onFlashlightContainerClick:function E(t){this.getChildByModuleName("Grid").destroy(),this.$(".relatedPinsTitle")[0].innerHTML="Visually similar results"},removeFlashlightEd:function v(t){this.currentPulser&&(this.currentPulser.destroy(),this.currentPulser=null),this.guideModule&&(this.guideModule.destroy(),this.guideModule=null),t&&s.set(o.COOKIE_SUPPRESS_UNAUTH_FLASHLIGHT_ED,"true")},_updateVisualModule:function I(t,e){if(0!==this.$(".resultsContainer").length){var i=this.getChildById("visuallySimilar");if(!t)return void(i&&i.fadeOut(function(){i.destroy()}));var n={name:"VisuallySimilar",id:"visuallySimilar",options:t};d.load(n).then(function(t){t.render().then(function(){this.getChildrenByModuleName("VisuallySimilar").forEach(function(t){this.removeChild(t)}.bind(this)),this.insertChild(t,this.$(".resultsContainer")),t.fadeIn()}.bind(this))}.bind(this))}},onCropperChanged:function T(t,e,i){var n=null;if(i&&(n={pin_id:i.pinId,crop:i.crop}),this._updateVisualModule(n,"VisualLiveSearchResource"),c.trackRegisterAction("unauth_flashlight_cropper_change"),!s.get(o.COOKIE_SUPPRESS_UNAUTH_FLASHLIGHT_ED)){var a=l.instance.v2GetGroup("unauth_web_flashlight");this.anchor=u,"enabled"===a&&(this.anchor=p);var r=h._("Move or resize to instantly see pins just like this");this._setupEd(r),c.trackRegisterAction("unauth_flashlight_education_loaded")}},_setupEd:function N(t){var e={name:"UserEducationGuideStep",options:{body_html:t,step_type:"tooltipStep",anchor:this.anchor}},i={name:"UserEducationGuideTooltip",options:{module:e,anchor:this.anchor,position_mode:"ANCHORED",position_point:"BOTTOM_CENTER",hide_caret:!0,class_name:"active",fixed:!1}};d.load(i).then(function(t){this.guideModule=t,this.appendChild(t),t.render()}.bind(this));var n={name:"Pulser",options:{anchor:this.anchor,fixed:!1,close_on_mousedown:!0}};d.load(n).then(function(t){this.appendChild(t),t.render(),this.currentPulser=t}.bind(this))},getPin:function S(){return this.getChildByModuleName("Pin")}});g.prototype.className="UnauthPinInGridCloseup",t.exports=a.register(g)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="PinsCarousel",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(355),i(357),i(166);var a=60,r=200,l=o.extend({onContentReady:function h(){this.listen(this.getScrollableElement(),n.EVENT_SCROLL,this._onScroll),this.$closeupContainer=this.$(".closeupContainer"),this.scrollElement=this.getScrollableElement(),this.$facebookActionBar=this.$(".FacebookShareActionBar"),this.$facebookShareBanner=this.$(".FacebookShareBanner")},getPin:function d(){return this.getChildByModuleName("Pin")},_onScroll:function c(){var t=this.scrollElement.scrollTop();t>a?(this.$facebookActionBar.addClass("fbShareActionBarDocked"),this.$closeupContainer.addClass("dock"),t>r&&(this.$facebookShareBanner.fadeIn(300),this.$facebookActionBar.fadeOut(300))):r>t&&(this.$facebookShareBanner.fadeOut(300),this.$facebookActionBar.fadeIn(300),a>t&&(this.$facebookActionBar.removeClass("fbShareActionBarDocked"),this.$closeupContainer.removeClass("dock")))}});l.prototype.className="FBOCloseupMweb",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(356);var o=n.extend({});o.prototype.className="FacebookShareActionBar",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(243),a=i(50),r=i(46),l=i(27),h=i(83),d=a.extend({events:{click:"onClick"},onClick:function c(t){return l.trackRegisterAction("facebook_share_exp_"+this.options.log_element_type),this._logContextEvent(t),r.isWriteBanned()?h.showWriteBanned(this):(o.shareFb({object_id:this.options.object_id,object_type:this.options.object_type,dialog_options:this.options.dialog_options,ga_category:this.options.ga_category}),this.triggerEvent(n.EVENT_BUTTON_CLICK,null,!0)),!1}});d.prototype.className="FacebookShareButtonExp",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(356);var o=n.extend({});o.prototype.className="FacebookShareBanner",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(342),i(359),i(166);var o=n.extend({getPin:function a(){return this.getChildByModuleName("Pin")}});o.prototype.className="FacebookShareUnauthCloseupWeb",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(356);var o=n.extend({onContentReady:function a(){this.$facebookShareNagContainer=this.$(".facebookShareNagContainer"),this.$facebookShareNagContainer.delay(2e3).fadeIn(500)}});o.prototype.className="FacebookShareNag",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(276),o=i(19);i(116);var a=s.extend({onContentReady:function r(){s.prototype.onContentReady.call(this),n(window).on("load",setTimeout(this.toggleVisibility.bind(this),300))},toggleVisibility:function l(){this.$el.fadeIn()}});a.prototype.className="HeroPinFromEmail",t.exports=o.register(a)},,,function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(20),r=i(138),l=200,h=n.extend({onContentReady:function d(){this.origUrl=window.location.href,this._makeUrl(this.options.x,this.options.y,this.options.w,this.options.h);var t={};t[o.PUBSUB_TOPIC_FLASHLIGHT_CROPPER_CHANGED]=this._onCropperChanged,this.pubsubSubscribe(o.PUBSUB_CHANNEL_SITE,t)},getBaseUrl:function c(t){return"/pin/"+t+"/visual-search/"},onDestroyed:function u(){a.instance.pushState(this.origUrl)},_onCropperChanged:function p(t,e,i){if(i){var n=i.origCrop;this._makeUrl(n.x,n.y,n.w,n.h),a.instance.pushState(this.url)}},_makeUrl:function _(t,e,i,n){var s=this.getBaseUrl(this.options.pin_id);(t>0||0===t)&&(e>0||0===e)&&(i>0||0===i)&&(n>0||0===n)?this.url=s+"?x="+t+"&y="+e+"&w="+i+"&h="+n:this.url=s},onClick:function g(t){this._dropdown&&this._dropdown.destroy();var e={name:"FlashlightUrlText",options:{url:this.url}};this._dropdown=new r({options:{anchor:this.$el,anchored:!0,largeCaret:!0,fixed:!1,position_point:"BOTTOM_CENTER",force_in_viewport:!0,class_name:"flashlightUrlText",module:e}}),this._dropdown.initHovering(l),this._dropdown.slideIn()}});h.prototype.className="FlashlightUrlButton",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="FlashlightUrlText",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19),a=s.extend({events:{"click .relatedBoard":"_onBoardClicked"},_onBoardClicked:function r(t){this._clickedBoardId=n(t.currentTarget).data("boardId")},getLoggingObjectIdStr:function l(){return this._clickedBoardId}});a.prototype.className="RelatedBoards",t.exports=o.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(125);var a=o.extend({onContentReady:function r(){this.data&&this.data.length||this.triggerEvent(n.EVENT_DROPDOWN_HIDE,null,!0)}});a.prototype.className="SuggestedBoardsDropdown",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(125);var a=o.extend({onContentReady:function r(){this.data&&this.data.length||this.triggerEvent(n.EVENT_DROPDOWN_HIDE,null,!0)}});a.prototype.className="SuggestedUsersDropdown",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(161);i(369);var r=o.extend({CssClassName:{ACTIVE:"active",SELECTED:"selected"},getItemByCategory:function l(t){return this.$("a[data-category="+t+"]")},mixins:[a],onCategoryUpdated:function h(t,e,i){if(this.$("a").removeClass(this.CssClassName.SELECTED),i){var n=this.getItemByCategory(i);n.length?(n.addClass(this.CssClassName.SELECTED),this.waitingMessage=null):this.waitingMessage=i}},onContentReady:function d(){var t={};t[n.PUBSUB_TOPIC_CURRENT_CATEGORY]=this.onCategoryUpdated,this.pubsubSubscribe(n.PUBSUB_CHANNEL_SITE,t),this.waitingMessage&&this.getItemByCategory(this.waitingMessage).addClass(this.CssClassName.SELECTED)},getHeight:function c(){if("height"in this.options)return this.options.height;this.$el.css("display","block");var t=this.$(".categoriesWrapper").outerHeight(),e=this.getChildByModuleName("AboutLinks");return e&&(t=t+e.getHeight()+1),this.$el.css("display",""),this.options.height=t,this.options.height}});r.prototype.className="CategoriesMenu",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(125);var o=n.extend({getHeight:function a(){return this.$el.outerHeight()}});o.prototype.className="AboutLinks",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({});o.prototype.className="CategoriesPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(128),l=a.extend({unusedPinfluencers:[],onContentReady:function h(){var t=this.data?n.pluck(this.data,"id"):[],e=this.resource.options.num_featured_users;this.unusedPinfluencers=t.length>e?t.slice(e):[],this.destroyIfEmpty()||this.childListen(s.EVENT_USER_FOLLOW,this.onChildActionTaken)},onChildActionTaken:function d(t){var e=t.target;this.dismissUser(e)},dismissUser:function c(t){t&&t.fadeOut(function(){this.unusedPinfluencers.length?this.replaceUser(t):this.removeUser(t)}.bind(this))},replaceUser:function u(t){var e=this.unusedPinfluencers.pop();if(e){var i=new r({resource:{name:"UserResource",options:{field_set_key:"grid_item",user_id:e}}});i.render().then(function(){i.show(),this.removeChild(t),this.appendChild(i),i.fadeIn()}.bind(this))}},removeUser:function p(t){this.removeChild(t);var e=this.getChildByModuleName("User");e||this.remove(),this.triggerEvent(s.EVENT_CONTENT_CHANGED,null,!0)}});l.prototype.className="FeedUsers",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=i(46),l=o.extend({events:{click:"onClick"},_getResourceForTab:function h(t){switch(t){case"pinners":return{name:"SuggestedUsersResource",options:{username:r.get("username"),recommendation_source:"homefeed_builder"}};case"boards":return{name:"RelatedBoardForUserFeedResource",options:{username:r.get("username"),recommendation_source:"homefeed_builder"}};case"topics":return{name:"UserInterestsResource",options:{blend_type:"recommendation",recommendation_source:"homefeed_builder"}}}},onClick:function d(){var t=this.options.tab,e=this._getResourceForTab(t),i={resource:e,tab:t,state:"search"};a.instance.publish(n.PUBSUB_CHANNEL_HOMEFEED_BUILDER,n.PUBSUB_TOPIC_HOMEFEED_BUILDER_CONTENT_UPDATED,i)}});l.prototype.className="FindMoreButton",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=i(81),l=o.extend({CssClassName:{FADE_GRADIENT:"fadeGradient"},onContentReady:function h(){this._changeViewType(),this.homefeedBuilderCount=0,this.updateOptionsAndDom({state_isLoading:!1,state_fadeIn:!0}),this.childListen(n.EVENT_SCROLL_HOMEFEED_BUILDER_CONTENT,this._onScrollHomefeedBuilderContent);var t={};t[n.PUBSUB_TOPIC_HOMEFEED_BUILDER_CONTENT_UPDATED]=this._onContentUpdated,this.pubsubSubscribe(n.PUBSUB_CHANNEL_HOMEFEED_BUILDER,t)},onRemoved:function d(){r.getInstance().addViewToContext(this.previousView)},_changeViewType:function c(){var t=r.getInstance();this.previousView=t.getViewFromContext();var e={view_type:n.GEN.ViewType.HOMEFEED_BUILDER,view_parameter:n.GEN.ViewParameterType.HOMEFEED_BUILDER};t.addViewToContext(e)},getOwnedScrollables:function u(){return this.$(".contentContainer")},updateDom:function p(){var t=this.getChildByModuleName("HomefeedBuilderContent");this.options.state_isLoading&&t.updateOptionsAndDom({state_fadeOutUp:!0}),this.options.state_fadeIn&&(t.fadeIn(),t.updateOptionsAndDom({state_fadeOutUp:!1}))},_onContentUpdated:function _(t,e,i){this._onHomefeedBuilderHeaderChanged(i.state,i.tab),this._onHomefeedBuilderContentChanged(i.resource,i.state,i.tab)},_onHomefeedBuilderContentChanged:function g(t,e,i){var s=this.getChildByModuleName("HomefeedBuilderContent");i&&t&&(e?s.updateOptionsAndDom({tab:i,state:e}):s.updateOptionsAndDom({tab:i}),s.setResource(t),0===this.homefeedBuilderCount&&this.updateOptionsAndDom({state_isLoading:!0,state_fadeIn:!1}),this.homefeedBuilderCount+=1,s.renderExistingData().then(function(){this.homefeedBuilderCount-=1,0===this.homefeedBuilderCount&&(this.updateOptionsAndDom({state_isLoading:!1,state_fadeIn:!0}),a.instance.publish(n.PUBSUB_CHANNEL_HOMEFEED_BUILDER,n.PUBSUB_TOPIC_HOMEFEED_BUILDER_CONTENT_UPDATE_FINISHED,null));
}.bind(this)))},_onHomefeedBuilderHeaderChanged:function m(t,e){var i=this.getChildByModuleName("HomefeedBuilderHeader");e&&t&&i.options.state!==t&&(i.updateOptionsAndDom({state:t,tab:e}),i.options.state=t,i.render())}});l.prototype.className="HomefeedBuilder",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(50),o=i(19),a=i(18),r=s.extend({events:{click:"onButtonClick"},onButtonClick:function l(t){var e={name:"HomefeedBuilder",id:"homefeedBuilder",resource:{name:"UserResource",options:{user_id:this.options.user_id}}},i={modal_style:"homefeedBuilderModal",cancel_button_log_element_type:n.GEN.ElementType.HOMEFEED_BUILDER_DISMISS_BUTTON};a.load(e).then(function(t){this.showInModal(t,i)}.bind(this))}});r.prototype.className="HomefeedBuilderButton",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({CssClassName:{FADE_OUT_UP:"fadeOutUp"},onContentReady:function r(){this.options.state_fadeHomefeedBuilder=!1,this.options.state_fadeOutUp=!1,this.childListen(n.EVENT_RELOAD_HOMEFEED_BUILDER_CONTENT,this.onHomefeedBuilderReload),this.listen(this.getScrollableElement(),n.EVENT_SCROLL,this._onScroll)},updateDom:function l(){this.options.state_fadeOutUp&&this.$el.addClass(this.CssClassName.FADE_OUT_UP)},onHomefeedBuilderReload:function h(t){var e=t.data.tab;this.options.state_tab=e,this.render()},_onScroll:function d(){this.getScrollableElement().scrollTop()>4?this.options.state_fadeHomefeedBuilder||(this.options.state_fadeHomefeedBuilder=!0,this.triggerEvent(n.EVENT_SCROLL_HOMEFEED_BUILDER_CONTENT,!0,!0)):this.options.state_fadeHomefeedBuilder&&(this.options.state_fadeHomefeedBuilder=!1,this.triggerEvent(n.EVENT_SCROLL_HOMEFEED_BUILDER_CONTENT,!1,!0))}});a.prototype.className="HomefeedBuilderContent",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({CssClassName:{FADE_IN_UP:"fadeInUp"},onContentReady:function a(){this.updateOptionsAndDom({state_fadeUpIn:!0})},updateDom:function r(){this.options.state_fadeUpIn&&this.$(".gridWrapper").addClass(this.CssClassName.FADE_IN_UP)}});o.prototype.className="HomefeedBuilderGrid",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=i(46),l=o.extend({onContentReady:function h(){this.childListen(n.EVENT_BUTTON_CLICK,this.onHomefeedBuilderBackButtonClick)},_getResourceForTab:function d(t){var e=r.get("username");switch(t){case"pinners":return{name:"UserFollowingResource",options:{username:e,hide_find_friends_rep:!0,show_find_more_button:!0,exclude_not_explictly_followed:!0}};case"boards":return{name:"BoardFollowingResource",options:{username:e,show_find_more_button:!0,exclude_collaborated_by_me:!0}};case"topics":return{name:"InterestFollowingResource",options:{username:e,show_find_more_button:!0}}}},onHomefeedBuilderBackButtonClick:function c(t){var e=this.options.tab,i=t.target.id;if("homefeedBuilderBack"===i){var s=this._getResourceForTab(e),o={resource:s,tab:e,state:"follow"};a.instance.publish(n.PUBSUB_CHANNEL_HOMEFEED_BUILDER,n.PUBSUB_TOPIC_HOMEFEED_BUILDER_CONTENT_UPDATED,o)}}});l.prototype.className="HomefeedBuilderHeader",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=i(46),l=o.extend({onContentReady:function h(){this.listen(this.getChildById("navFollowedInterests"),n.EVENT_BUTTON_CLICK,this.onButtonTabClick),this.listen(this.getChildById("navFollowedPinners"),n.EVENT_BUTTON_CLICK,this.onButtonTabClick),this.listen(this.getChildById("navFollowedBoards"),n.EVENT_BUTTON_CLICK,this.onButtonTabClick)},_getResourceForTab:function d(t){var e=r.get("username");switch(t){case"pinners":return{name:"UserFollowingResource",options:{username:e,hide_find_friends_rep:!0,show_find_more_button:!0,exclude_not_explictly_followed:!0}};case"boards":return{name:"BoardFollowingResource",options:{username:e,show_find_more_button:!0,exclude_collaborated_by_me:!0}};case"topics":return{name:"InterestFollowingResource",options:{username:e,show_find_more_button:!0}}}},onButtonTabClick:function c(t){var e,i=t.target.id;switch(i){case"navFollowedInterests":e="topics";break;case"navFollowedPinners":e="pinners";break;case"navFollowedBoards":e="boards"}var s=this.getChildById("navFollowedInterests"),o=this.getChildById("navFollowedPinners"),r=this.getChildById("navFollowedBoards");s.setSelected("navFollowedInterests"===i),o.setSelected("navFollowedPinners"===i),r.setSelected("navFollowedBoards"===i);var l=this._getResourceForTab(e),h={resource:l,tab:e};a.instance.publish(n.PUBSUB_CHANNEL_HOMEFEED_BUILDER,n.PUBSUB_TOPIC_HOMEFEED_BUILDER_CONTENT_UPDATED,h)}});l.prototype.className="HomefeedBuilderNavBar",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(79),l=i(23),h=i(34),d=i(46),c=a.extend({CssClassName:{SEARCH_ICON_SHOW:"searchIconShow"},events:{"textchange .search":"_onSearchTextUpdate","focus .search":"_onSearchTextFocus","blur .search":"_onSearchTextBlur"},onContentReady:function u(){this._searchQuery="",this._input=this.getChildByModuleName("Input"),this._searchIconElem=this.$(".searchIcon"),this._loadingIconElem=this.$(".loadingIcon"),this.options.state_showSearchIcon=!0,this.options.state_showLoadingIcon=!1,this.updateOptionsAndDom({state_showSearchIcon:!0});var t={};t[s.PUBSUB_TOPIC_HOMEFEED_BUILDER_CONTENT_UPDATE_FINISHED]=this._onContentUpdateFinished,this.pubsubSubscribe(s.PUBSUB_CHANNEL_HOMEFEED_BUILDER,t)},updateDom:function p(){this.options.state_showSearchIcon?(this._searchIconElem.show(),this.$(".search").addClass(this.CssClassName.SEARCH_ICON_SHOW)):(this._searchIconElem.hide(),this.$(".search").removeClass(this.CssClassName.SEARCH_ICON_SHOW)),this.options.state_showLoadingIcon?this.showLoading(!1,this._loadingIconElem):this.hideLoading(!1,this._loadingIconElem)},getLoadingSpinnerOptions:function _(){return n.extend(a.prototype.getLoadingSpinnerOptions.call(this),{size:r.Size.SMALL})},_onContentUpdateFinished:function g(){this.updateOptionsAndDom({state_showLoadingIcon:!1})},_getScope:function m(){var t=this.options.tab;switch(t){case"pinners":return"people";case"boards":return"boards";case"topics":return"interests"}},_getEmptySearchResourceForTab:function f(t){switch(t){case"pinners":return{name:"SuggestedUsersResource",options:{username:d.get("username"),recommendation_source:"homefeed_builder"}};case"boards":return{name:"RelatedBoardForUserFeedResource",options:{username:d.get("username"),recommendation_source:"homefeed_builder"}};case"topics":return{name:"UserInterestsResource",options:{blend_type:"recommendation",recommendation_source:"homefeed_builder"}}}},_onSearchTextUpdate:function C(t){var e=this._input.getValue();if(this._searchQuery=e,e)var i={name:"SearchResource",options:{scope:this._getScope(),query:e}};else var i=this._getEmptySearchResourceForTab(this.options.tab);var n={resource:i,tab:this.options.tab,state:"search"};h.setTimeout(function(){this._searchQuery===e&&(l.instance.publish(s.PUBSUB_CHANNEL_HOMEFEED_BUILDER,s.PUBSUB_TOPIC_HOMEFEED_BUILDER_CONTENT_UPDATED,n),this.updateOptionsAndDom({state_showLoadingIcon:!0}))}.bind(this),400)},_onSearchTextFocus:function E(t){this.updateOptionsAndDom({state_showSearchIcon:!1})},_onSearchTextBlur:function v(t){this._input.getValue()||this.updateOptionsAndDom({state_showSearchIcon:!0})}});c.prototype.className="HomefeedBuilderSearchBar",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=n.extend({onClick:function r(t){this.triggerEvent(o.EVENT_SEE_MORE_BUTTON_CLICKED,null,!0)}});a.prototype.className="SeeMoreButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(21),s=i(11),o=i(19),a=i(50),r=i(311),l=i(46),h=i(27);i(151),i(125),i(145),i(312),i(382);var d=a.extend({CssClassName:{BACKWARDS:"backwards"},_hexToRGB:function c(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:150,g:156,b:157}},onContentReady:function u(){l.isAuthenticated()||(this.data.is_interest?h.trackRegisterAction("interest_page_view"):this.data.is_seo_term?h.trackRegisterAction("klp_page_view"):h.trackRegisterAction("search_results_page_view"),"0"!==this.data.id&&(n.set(s.COOKIE_LAST_UNAUTH_INTEREST_ID,this.data.id),r.logUrl()));var t=this.$(".interestHeaderBackground");if(t.length){var e="left",i=t.attr("style").replace("background-color: ","");t.hasClass(this.CssClassName.BACKWARDS)&&(e="right");var o=this._hexToRGB(i),a=o.r,d=o.g,c=o.b,u="rgba("+a+","+d+","+c+",1) 0%,",p=u+" rgba("+a+","+d+","+c+",0) 17%,",_=p+" rgba("+a+","+d+","+c+",0) 17%,",g=_+" rgba("+a+","+d+","+c+",1) 35%,",m=g+" rgba("+a+","+d+","+c+",1) 100%",f="background: linear-gradient(to "+e+", "+m+");";this.$(".bgGradient").attr("style","background-color: "+i+";"+f),this.$(".rightImage").delay(1e3).animate({opacity:.7},{duration:500})}}});d.prototype.className="InterestFeedPage",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(23),l=i(20),h=i(31);i(383),i(384),i(385),i(386);var d=a.extend({onCreated:function c(){this.childListen(s.EVENT_NAVIGATE,this.onChildNavigate)},_updateSearchOptions:function u(){this.searchOptions=n.pick(this.options,"query","scope","boost")},onChildNavigate:function p(t){var e=t.data.url;if(!h.isOffsiteUrl(e)){var i=l.instance.resolve(e);if(i&&"SearchPage"===i.module){var n=l.instance.resolve(e).options;return this.setOptions(n),this.publishSearchChange(),void(t.data.handled=!0)}}},onContentReady:function _(){if(this.publishSearchChange(),this.contentReady=!0,"buyable_pins"===this.options.scope){this.grid=this.getChildByModuleName("SearchPageContent").getChildByModuleName("Grid");var t=this.getChildByModuleName("PriceFilter"),e=this.grid.data[0].price_buckets;t&&e&&(t.updateOptions({price_filter_temp_value:e[0],price_buckets:e}),this.childListen(s.EVENT_PRICE_SELECTED,this._updateOnBuyablePinsPriceSelected))}},_updateOnBuyablePinsPriceSelected:function g(t){var e=t.data,i={scope:"buyable_pins"};i.query=this.options.query,"$"!==e&&(i.suggested_price=e),this.grid.setItemsResource({name:"SearchResource",options:i}),this.grid.renderItems()},onAdded:function m(){this.contentReady&&this.publishSearchChange()},publishSearchChange:function f(){this._updateSearchOptions();var t=this.searchOptions||{};r.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED,t.query||""),r.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_SEARCH_SCOPE_UPDATED,t.scope||""),r.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_SEARCH_BOOST_UPDATED,t.boost||"")}});d.prototype.className="SearchPage",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(126),l=i(23),h=125,d=3,c=2,u=a.extend({events:{"click .guidesContainer li":"onGuideClick","click .navigator.left em":"onLeftNavigatorClick","click .navigator.right em":"onRightNavigatorClick"},getOwnedScrollables:function p(){return this.$(".guidesSlider")},onCreated:function _(){this.$guidesSlider=this.$(".guidesSlider"),this.$guidesContainer=this.$(".guidesContainer"),this.currentGuideIndex=0,this.totalGuides=this.options.num_guides,this.state={};var t=this.totalGuides*h;this.$guidesContainer.css("width",t+"px"),this.$leftNav=this.$(".navigator.left"),this.$rightNav=this.$(".navigator.right"),this.listen(r,s.EVENT_BODY_COLUMN_CHANGE,this.onBodyColumnChange),this.scrollLeft=0,this.onSliderScroll=this.onSliderScroll.bind(this),this.$guidesSlider.on("scroll",this.onSliderScroll)},onBodyColumnChange:function g(){this.updateNavigators()},onContentReady:function m(){this.isReady()&&this.updateNavigators()},onAddedToDom:function f(){this.isReady()&&(this.updateNavigators(),this.state.guideSelected=!1)},isReady:function C(){return this.inDom&&this.contentReady},onSliderScroll:function E(t){this.scrollLeft=t.target.scrollLeft,this.currentGuideIndex=Math.floor(this.scrollLeft/h),this.updateNavigators()},onGuideClick:function v(t){var e=n(t.currentTarget),i=e.children().first(),o=i.attr("data-term"),a=i.attr("data-term-position"),r=i.attr("data-dominant-color"),h=i.attr("data-guide-index");this.state.guideSelected||(this.state.guideSelected=!0,l.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_SEARCH_GUIDE_SELECTED,{term:o,position:a,color:r,index:h}))},onLeftNavigatorClick:function I(t){this.$guidesSlider.animate({scrollLeft:this.scrollLeft-d*h},300)},onRightNavigatorClick:function T(t){this.$guidesSlider.animate({scrollLeft:this.scrollLeft+d*h},300)},updateNavigators:function N(){0===this.scrollLeft?this.hideLeftNavigator():this.showLeftNavigator();var t=r.numColumns*c;this.totalGuides-this.currentGuideIndex>t?this.showRightNavigator():this.hideRightNavigator()},hideLeftNavigator:function S(){this.$leftNav.hide()},showLeftNavigator:function b(){this.$leftNav.show()},hideRightNavigator:function y(){this.$rightNav.hide()},showRightNavigator:function P(){this.$rightNav.show()}});u.prototype.className="SearchGuidesBar",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23);i(151);var r=o.extend({onAddedToDom:function l(){if(this.data.typo){var t={typo:this.data.typo,scope:this.options.scope},e={hasSpellCheck:!0,searchAutocorrectOptions:t};a.instance.publish(n.PUBSUB_CHANNEL_SEARCH_AUTOCORRECT,n.PUBSUB_TOPIC_SEARCH_SPELL_CHECK_UPDATED,e)}}});r.prototype.className="SearchPageContent",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(130);var o=n.extend({});o.prototype.className="SearchScopeBar",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="NagSearch",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="AdhocFeedIndexPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({});o.prototype.className="AdhocFeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({onContentReady:function a(){this.destroyIfEmpty()},isEmpty:function r(){if(!this.contentReady)return!1;var t=this.getChildById("relatedBoardsFeed");return!t||!t.hasItems()}});o.prototype.className="BoardRecommendationsModule",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(160);var o=n.extend({});o.prototype.className="EvalFeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({});o.prototype.className="InterestRecommendationsModule",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({});o.prototype.className="RecFeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(160);var o=n.extend({});o.prototype.className="SXS2FeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(8),l=i(395),h=i(27);i(116);var d=a.extend({events:{"change #subjects":"subjectChange"},onContentReady:function c(){this._listener||(this._listener=this.childListen(s.EVENT_BUTTON_CLICK,this.onButtonClick)),this._pickTreatment=this.getChildById("pickTreatment"),this._pickControl=this.getChildById("pickControl"),this._pickNone=this.getChildById("pickNone"),this._lockSxSButton=this.getChildById("lockSxS"),this.setIframes(),this._isLockedSxS=!0,this.sizeIframe(),n(window).resize(function(){this.sizeIframe()}.bind(this))},onButtonClick:function u(t){var e=t.target;e===this._pickTreatment?this.setScore(1):e===this._pickControl?this.setScore(-1):e===this._pickNone?this.setScore(0):e===this._lockSxSButton&&this.toggleLockSxS()},setIframes:function p(){var t=this.$("#sxs_control"),e=this.$("#sxs_treatment");t.prop("src",this.$("#control_url").val()),e.prop("src",this.$("#treatment_url").val()),t.on("load",function(){this.setSxSLock(!0)}.bind(this)),e.on("load",function(){this.setSxSLock(!0)}.bind(this))},setScore:function _(t){var e={};e.score=t,e.token=this.$("#token").val(),e.selected_subject_id=this.$("#selected_subject_id").val();var i=r.create("SXSEvaluationResource",e);i.callUpdate().then(function(t){this.render()}.bind(this))},subjectChange:function g(t){var e=this.$("#subjects").val(),i=this.$("#token").val(),n=window.location.href.split("?")[0];n+="?token="+i+"&subject_id="+e,h.changeWindowLocation(n)},setSxSLock:function m(t){this._isLockedSxS=t;var e=this.$("#sxs_control, #sxs_treatment").contents();t?(l.start(e),this._lockSxSButton.setText("Unlock SxS")):(l.stop(e),this._lockSxSButton.setText("Lock SxS"))},toggleLockSxS:function f(){this.setSxSLock(!this._isLockedSxS)},sizeIframe:function C(){var t=.85*n(window).height();this.$(".iframeContainer").css("height",t)}});d.prototype.className="SXSEvaluation",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(2),o={};o.start=function(t){var e=null,i=n.debounce(function(){e=null},500),o=function a(n){if(null===e&&(e=n.target,i()),n.target===e){var o=s(n.target),a=o.scrollTop();t.scrollTop(a)}};t.on("scroll.synchronize",o)},o.stop=function(t){t.off("scroll.synchronize")},t.exports=o},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(395);i(116);var r=o.extend({events:{"change #subjects":"subjectChange"},onContentReady:function l(){this._listener||(this._listener=this.childListen(n.EVENT_BUTTON_CLICK,this.onButtonClick)),this._lockSxSButton=this.getChildById("lockSxS"),this.setIframes(),this._isLockedSxS=!0},onButtonClick:function h(t){var e=t.target;e===this._lockSxSButton&&this.toggleLockSxS()},setIframes:function d(){var t=this.$("#sxs_control"),e=this.$("#sxs_treatment");t.prop("src",this.$("#control_url").val()),e.prop("src",this.$("#treatment_url").val()),t.on("load",function(){this.setSxSLock(!0)}.bind(this)),e.on("load",function(){this.setSxSLock(!0)}.bind(this))},setSxSLock:function c(t){this._isLockedSxS=t;var e=this.$("#sxs_control, #sxs_treatment").contents();t?(a.start(e),this._lockSxSButton.setText("Unlock SxS")):(a.stop(e),this._lockSxSButton.setText("Lock SxS"))},toggleLockSxS:function u(){this.setSxSLock(!this._isLockedSxS)}});r.prototype.className="SXSPinIds",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({});o.prototype.className="SmartFeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({});o.prototype.className="StoryFeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(50),o=i(19),a=i(18),r=s.extend({events:{input:"onInputChanged"},CssClassName:{EDITABLE:"editable"},onContentReady:function l(){this.updateOptionsAndDom({state_contentReady:!0}),this.addEditor()},updateDom:function h(){if(this.options.state_contentReady){this.$el.addClass(this.CssClassName.EDITABLE),this.$el.attr("data-edit-type","editText");var t=this.options.alignment;this.$el.toggleClass(t,t);var e=this.options.text;e&&this.$(".editableText").text(e)}},activate:function d(){this.$el.click()},getAlignment:function c(){return this.options.alignment},getOptions:function u(){return n.extend({text:this.$el.text()},this.options)},addEditor:function p(){var t={name:"StoryboardEditorMenu",options:{target:this,storyboardFeed:this.options.storyboardFeed,horizontal:!0}};a.load(t).then(function(t){t.render().then(function(){this.appendChild(t)}.bind(this))}.bind(this))},getExportData:function _(){return{type:"text",alignment:this.options.alignment||"left",text:this.$(".editableText").text()}}});r.prototype.className="StoryboardEditableText",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(18);i(171);var l=a.extend({events:{"click .optionsGroup.textVisibility":"_clickTextVisibility","click .optionsGroup.textAlignment":"_clickTextAlignment","click .addTextBox":"_clickAddTextbox","click .delete":"_clickDelete"},CssClassName:{HORIZONTAL:"horizontal",VISIBLE:"visible"},onContentReady:function h(){var t=this.options.target.$el,e=this._getTargetModule().options.pinOptions||{},i=t.attr("data-edit-type");if("storyboardRow"===i){if(this.$(".switchLayoutButton").addClass(this.CssClassName.VISIBLE),this.$(".textVisibility").addClass(this.CssClassName.VISIBLE),this.$(".addTextBox").addClass(this.CssClassName.VISIBLE),this._updateTextVisibility(e.textVisibility),this._updateLayout(this.options.storyboardFeed.getCurrentPinVariationIndex(this._getTargetModule().options.pinOrganization)+1),this.options.rowNumber>=0){var n={};n[s.PUBSUB_TOPIC_STORYBOARD_LAYOUT_CLICKED]=this.onLayoutClicked,this.pubsubSubscribe(s.PUBSUB_CHANNEL_SITE,n)}}else"editText"===i&&(this.$(".delete").addClass(this.CssClassName.VISIBLE),this.$(".textAlignment").addClass(this.CssClassName.VISIBLE),this._updateAlignment(this._getTargetModule()));this.options.horizontal&&this.$el.addClass(this.CssClassName.HORIZONTAL)},onLayoutClicked:function d(t,e,i){i&&i.rowNumber===this.options.rowNumber&&this._setCurrentLayout(i.layoutNumber)},_clickTextVisibility:function c(t){var e=this.options.storyboardFeed,i=n(t.target).attr("data-next");e.setTextVisibility(this._getTargetModule(),i),this._updateTextVisibility(i)},_setCurrentLayout:function u(t){var e=this.options.storyboardFeed;e.setLayoutNumber(this._getTargetModule(),t)},_clickAddTextbox:function p(t){var e=this.options.storyboardFeed,i={name:"StoryboardEditableText",options:{storyboardFeed:this.options.storyboardFeed}};r.load(i).then(function(t){t.render().then(function(){e.insertChild(t,null,null,this._getTargetModule().$el),t.activate()}.bind(this))}.bind(this))},_clickDelete:function _(t){this._getTargetModule().destroy(),this.destroy()},_clickTextAlignment:function g(t){var e=n(t.target).attr("data-next-alignment"),i=this._getTargetModule();i.options=i.getOptions(),i.options.alignment=e,i.render().then(function(){i.activate()}),this._updateAlignment(i)},_updateTextVisibility:function m(t){t=t||"titleDescription",this.$(".textVisibility .option").removeClass(this.CssClassName.VISIBLE),this.$(".textVisibility ."+t).addClass(this.CssClassName.VISIBLE)},_updateAlignment:function f(t){this.$(".textAlignment .option").removeClass(this.CssClassName.VISIBLE);var e=t.getAlignment()||"left";this.$(".textAlignment ."+e).addClass(this.CssClassName.VISIBLE)},_updateLayout:function C(t){t=t||1;var e=this.$(".switchLayoutButtonWrapper");e.attr("class","switchLayoutButtonWrapper"),e.addClass("layout-"+t)},_getTargetModule:function E(){return this.options.target}});l.prototype.className="StoryboardEditorMenu",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(23),l=23,h=a.extend({events:{"click .selectorItem":"onClickSelectorItem"},onCreated:function d(){for(var t=[],e=0;l>e;e++)t.push(e+1);this.options.selector_nums=t},onClickSelectorItem:function c(t){var e={layoutNumber:n(t.target).attr("data-item-num"),rowNumber:this.options.rowNumber};r.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_STORYBOARD_LAYOUT_CLICKED,e)}});h.prototype.className="StoryboardLayoutSelector",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19),a=i(8);i(403);var r=s.extend({events:{"click .deleteButton":"onClickDelete","keyup .boardInput":"onKeyupBoardInput"},onContentReady:function l(){},onClickDelete:function h(t){var e={board_id:n(t.target).attr("data-board-id")},i=a.create("StoryboardResource",e);i.callDelete().fin(function(t){this.render()}.bind(this))},onKeyupBoardInput:function d(t){if(13===t.keyCode){for(var e=n(t.target).val(),i=e.split("/"),s=[];i.length>0;){var o=i.pop();if(o.length&&s.push(o),s.length>=2)break}2===s.length&&this.navigate("/internal/storyboard/"+s[1]+"/"+s[0]+"/")}}});r.prototype.className="StoryboardList",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(128);var o=n.extend({});o.prototype.className="StoryboardHeader",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(8);i(117),i(405),i(403),i(406);var l=640,h=a.extend({events:{"click .createButton":"onClickCreate","click .cancelButton":"onClickCancel"},state:{},onContentReady:function d(){this.childListen(s.EVENT_LAYOUT_ITEM_CLICK,this.fetchLayout),this.childListen(s.EVENT_LAYOUT_INPUT_KEYUP,this.saveStoryboardLayout)},scrollToSecondFrame:function c(t){var e=n(t.target).closest(".editorContainer");e.animate({scrollTop:l},500)},onClickCreate:function u(){var t=this._getStoryboardFeed().exportFeedData(),e={board_id:this.data.id,data:{header_data:this._getHeaderData(),feed_data:t}},i=r.create("StoryboardResource",e);i.callUpdate().fin(function(t){alert("Storyboard saved")})},onClickCancel:function p(){this.navigate("/internal/storyboards/")},fetchLayout:function _(t){var e={layout_name:t.data},i=r.create("StoryboardLayoutResource",e);i.callGet().then(function(t){var e=t.resource_response.data.feedData;this._getStoryboardFeed().options.feed_data=e,this._getStoryboardFeed().render()}.bind(this))},saveStoryboardLayout:function g(t){var e=t.data,i=this._getStoryboardFeed().exportFeedData(!0),n={layout_name:e,layout_data:{layoutName:e,feedData:i}},s=r.create("StoryboardLayoutResource",n);s.callUpdate().fin(function(t){this.getChildById("layout_list").render()}.bind(this))},_getHeaderData:function m(){return{creatorDescription:this.$(".creatorDescription").text().trim(),storyboardBlurb:this.$(".storyboardBlurb").text().trim(),boardName:this.$(".boardNameEditable").text().trim()}},_getCountry:function f(){return this.$('select[name="country"]').val()},_getStoryboardFeed:function C(){return this.getChildById("grid")}});h.prototype.className="StoryboardPage",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(50),a=i(19),r=i(18),l=[{className:"fullWidth bigText",numPins:1,variant:"withPadding"},{className:"fullWidth twoColumnText bigText",numPins:1,variant:"fullWidthTwoColumnText"},{className:"fullWidth textOnRight bigText",numPins:1,variant:"fullWidthTextOnRight"},{className:"fullBleed oneColumnText bigText",numPins:1,variant:"fullBleed"},{className:"fullBleed twoColumnText bigText",numPins:1,variant:"fullBleedTwoColumnText"},{className:"fullBleed textOnRight bigText",numPins:1,variant:"fullBleedTextOnRight"},{className:"fullBleed fullBleedGradient oneColumnText bigText",numPins:1,variant:"fullBleedWithGradient"},{className:"fullBleed fullBleedGradient twoColumnText bigText",numPins:1,variant:"fullBleedTwoColumnTextWithGradient"},{className:"fullBleed fullBleedGradient textOnRight bigText",numPins:1,variant:"fullBleedTextOnRightWithGradient"},{className:"fullBleed leftTriangle bigText",numPins:1,variant:"fullBleedLeftTriange"},{className:"fullBleed rightTriangle bigText",numPins:1,variant:"fullBleedRightTriangle"},{className:"squareWithText textOnRightHalf bigText",numPins:1,variant:"squareWithTextOnRight"},{className:"squareWithText textOnLeftHalf bigText",numPins:1,variant:"squareWithTextOnLeft"},{className:"fullWidthCircle bigText",numPins:1,variant:"withPaddingCircle"},{className:"fullScreenCircle bigText",numPins:1,variant:"bigCircle"},{className:"circleWithText textOnLeftHalf bigText",numPins:1,variant:"circleWithTextOnLeft"},{className:"circleWithText textOnRightHalf bigText",numPins:1,variant:"circleWithTextOnRight"},{className:"semiCircleLeft textOnRightHalf bigText",numPins:1,variant:"semiCircleLeft"},{className:"semiCircleRight textOnLeftHalf bigText",numPins:1,variant:"semiCircleRight"},{className:"halfWidthPins smallText",numPins:2,variant:"withPadding"},{className:"halfWidthFullBleed smallText",numPins:2,variant:"fullBleed"},{className:"fourPinUnequal smallText",numPins:4,variant:"unequalHeight"},{className:"fourPinUnequalReverse smallText",numPins:4,variant:"unequalHeightReverse"}],h=o.extend({CssClassName:{STORYBOARD_ROW:"StoryboardRow"},state:{editingTarget:null},onContentReady:function d(){this.renderStoryGrid()},renderStoryGrid:function c(){var t=this.options.feed_data;t&&n.keys(t).length>0?this.renderGridFromData(t):this.renderGrid()},getRandomPinOrganization:function u(){var t=l[Math.floor(Math.random()*l.length)];return t},getPinOrganizationFromVariant:function p(t){for(var e=0;e<l.length;e++){var i=l[e];if(i.variant===t)return i}},renderGridFromData:function _(t){var e=this.data||[];e=e.filter(function(t){return"pin"===t.type});for(var i=0,s=function(t){if("pin"===t.type){if(i>=e.length)return;var s=this.getPinOrganizationFromVariant(t.variant),o=s.numPins,a={name:"StoryboardRow",options:{pins:e.slice(i,i+o),pinOrganization:s,pinOptions:t.pinOptions,storyboardFeed:this,rowNumber:Math.random()}};r.load(a).then(this.renderAndAppendModule.bind(this)),i+=o}else if("text"===t.type){var l={name:"StoryboardEditableText",options:n.extend({storyboardFeed:this.options.storyboardFeed},t)};r.load(l).then(this.renderAndAppendModule.bind(this))}}.bind(this);i<e.length;)t.forEach(s)},renderGrid:function g(){var t=this.data||[];t=t.filter(function(t){return"pin"===t.type});var e=0,i,s=!this.state.editingTarget;this.children.forEach(function(o){if(this.state.editingTarget===o&&(s=!0),o.options.pinOrganization){if(i=o.options.pinOrganization.numPins,!s)return void(e+=i);n.extend(o.options,{pins:t.slice(e,e+i),editing:this.state.editingTarget===o}),o.render(),e+=i}}.bind(this)),this.backfillPins(t,e)},backfillPins:function m(t,e){for(var i=e;i<t.length;){var n=this.getRandomPinOrganization(),s=n.numPins,o={name:"StoryboardRow",options:{pins:t.slice(i,i+s),pinOrganization:n,pinOptions:{},storyboardFeed:this,rowNumber:Math.random()}};r.load(o).then(this.renderAndAppendModule.bind(this)),i+=s}},renderAndAppendModule:function f(t){t.render().then(function(){this.appendChild(t)}.bind(this))},setLayoutNumber:function C(t,e){this.state.editingTarget=t,t.options.pinOrganization=l[e-1],this.renderGrid()},goToNextIterationWithoutBounds:function E(t){this.state.editingTarget=t;var e=t.options.pinOrganization;if(e){var i=this.getCurrentPinVariationIndex(e),n=(i+1)%l.length;t.options.pinOrganization=l[n]}else t.options.pinOrganization=l[0];this.renderGrid()},getCurrentPinVariationIndex:function v(t){for(var e=0;e<l.length;e++)if(l[e].className===t.className)return e;return-1},setTextVisibility:function I(t,e){this.state.editingTarget=t,t.options.pinOptions=t.options.pinOptions||{},t.options.pinOptions.textVisibility=e,this.renderGrid()},exportFeedData:function T(t){var e=[];return this.$el.children().each(function(i,n){var o=this.getChildByElement(n);o&&(!t||s(n).hasClass(this.CssClassName.STORYBOARD_ROW))&&e.push(o.getExportData())}.bind(this)),e}});h.prototype.className="StoryboardFeed",t.exports=a.register(h)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(8),l=a.extend({events:{"click .item":"onLayoutItemClick","click .xIcon":"onDeleteClick","keyup .layoutTextInput":"onKeyupLayoutTextInput"},CssClassName:{BOLD:"bold"},onLayoutItemClick:function h(t){var e=n(t.target).text().trim();this.$(".item").removeClass(this.CssClassName.BOLD),n(t.target).addClass(this.CssClassName.BOLD),this.triggerEvent(s.EVENT_LAYOUT_ITEM_CLICK,e,!0)},onKeyupLayoutTextInput:function d(t){13===t.keyCode&&this.triggerEvent(s.EVENT_LAYOUT_INPUT_KEYUP,n(t.target).val().trim(),!0)},onDeleteClick:function c(t){t.stopPropagation();var e={layout_name:n(t.target).closest(".item").text().trim()},i=r.create("StoryboardLayoutResource",e);i.callDelete().then(function(t){this.render()}.bind(this))}});l.prototype.className="StoryboardLayoutList",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="StoryboardPin",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(18),a=n.extend({events:{"click .StoryboardPin":"nextIteration"},CssClassName:{EDITING:"editing"},onContentReady:function r(){var t=this.options.pins,e=this.options.pinOrganization||{},i=this.options.pinOptions||{},n=this.options.editing;t.length||this.destroy(),n&&this.$el.addClass(this.CssClassName.EDITING),e.className&&this.$el.addClass(e.className),i.textVisibility&&this.$el.addClass(i.textVisibility),this.$el.attr("data-edit-type","storyboardRow");var s=[];
4===e.numPins&&4===t.length?(s[0]=t[0],s[1]=t[2],s[2]=t[1],s[3]=t[3]):s=t,s&&s.length&&s.forEach(function(t){var e={name:"StoryboardPin",data:t,options:{pin:t}};o.load(e).then(function(t){t.render().then(function(){this.appendChild(t)}.bind(this))}.bind(this))}.bind(this)),this.addEditor()},addEditor:function l(){var t=this.options.storyboardFeed,e={name:"StoryboardEditorMenu",options:{target:this,storyboardFeed:t,rowNumber:this.options.rowNumber}};o.load(e).then(function(t){t.render().then(function(){this.appendChild(t)}.bind(this))}.bind(this))},nextIteration:function h(){this.options.storyboardFeed.goToNextIterationWithoutBounds(this)},getExportData:function d(){var t=this.options.pinOrganization,e=this.options.pins.map(function(t){return t.id});return{type:"pin",textVisibility:this.options.textVisibility,numPins:t.numPins,variant:t.variant,pins:e,pinOptions:this.options.pinOptions}}});a.prototype.className="StoryboardRow",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(410),s=i(19),o=n.extend({});o.prototype.className="GenericPinInfo",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(138),o=i(19),a=i(50),r=i(18),l=i(23),h=i(8),d=i(34),c=a.extend({HIDE_DELAY:100,events:{"click .hidePin":"showSurvey","click .reportPin":"reportPin"},CssClassName:{HIDDEN:"hidden"},hidePin:function u(t,e){t="string"==typeof t?t:n.FeedbackType.HIDE,e=e||!1;var i=this.options.pin_id;this.triggerEvent(n.EVENT_CONTENT_CHANGED,null,!0),d.setTimeout(function(){this.triggerEvent(n.EVENT_DISMISS,null,!0);var s=e?n.PUBSUB_TOPIC_PIN_HIDDEN_UNFOLLOW:n.PUBSUB_TOPIC_PIN_HIDDEN;l.instance.publish(i,s,t)}.bind(this),this.HIDE_DELAY)},showSurvey:function p(){this._ensureSurvey(),d.setTimeout(function(){var t={dropdown:this._feedbackDropdown};this.triggerEvent(n.EVENT_CHANGE_DROPDOWN,t,!0)}.bind(this),this.HIDE_DELAY)},_ensureSurvey:function _(){if(!this._feedbackDropdown){var t=this.options.pin_id,e={pin_id:t,promoter:this.options.promoter,feedback_type:n.GEN.PinFeedbackTypes.BLOCK_SINGLE_PFY_PIN,recommendation_reason:this.options.recommendation_reason},i={name:"PinFeedback",options:e},o={anchor:this.parent.options.anchor,module:i,hide_caret:!0,view_type:"pinFeedbackTool",position_point:"TOP_RIGHT",display_while_loading:!0,force_in_viewport:!0,class_name:"underneathHeader"};this._feedbackDropdown=new s({id:"dropdown",options:o}),this._feedbackDropdown.initHovering(),this.addChild(this._feedbackDropdown)}},reportPin:function g(){var t="FlagPin",e={name:t,options:{pin_id:this.options.pin_id,user_id:this.options.user_id}};r.load(e).then(function(t){this.showInModal(t),this.triggerEvent(n.EVENT_DISMISS,null,!0)}.bind(this))},sendFeedback:function m(t){this.showLoading();var e={complaint_reason:t,pin_id:this.options.pin_id,feedback_type:this.options.feedback_type,promoted:!0},i=h.create("PinFeedbackResource",e);i.callUpdate().then(function(t){d.setTimeout(function(){this.hideLoading(),this.triggerEvent(n.EVENT_DISMISS,null,!0),l.instance.publish(this.options.pin_id,n.PUBSUB_TOPIC_PIN_HIDDEN,"hidePin")}.bind(this),100)}.bind(this))}});c.prototype.className="PinInfo",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(410),r=i(8),l=a.extend({events:n.extend(a.prototype.events,{"click .unfollowBoard":"unfollowBoard","click .unfollowPinner":"unfollowPinner"}),unfollowBoard:function h(){var t={board_id:this.options.board_id},e=r.create("BoardFollowResource",t);e.callDelete(),this.hidePin(s.FeedbackType.UNFOLLOW_BOARD,!0)},unfollowPinner:function d(){var t={user_id:this.options.pinner_id},e=r.create("UserFollowResource",t);e.callDelete(),this.hidePin(s.FeedbackType.UNFOLLOW_PINNER,!0)}});l.prototype.className="HomeFeedPinFollowedInfo",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(410),r=i(23),l=i(8),h=i(34),d=a.extend({events:n.extend(a.prototype.events,{"click .reportUnrelatedPin":"reportUnrelatedPin","click .unfollowInterest":"unfollowInterest"}),reportUnrelatedPin:function c(){var t=this.options.pin_id;this.$(".preAction").addClass(this.CssClassName.HIDDEN),this.triggerEvent(s.EVENT_CONTENT_CHANGED,null,!0),h.setTimeout(function(){this.triggerEvent(s.EVENT_DISMISS,null,!0),r.instance.publish(t,s.PUBSUB_TOPIC_PIN_HIDDEN_INTEREST_PAGE,s.FeedbackType.DOWNVOTE)}.bind(this),this.HIDE_DELAY)},_getFollowResource:function u(){var t={interest_list:s.INTEREST_LIST_FAVORITED,interest_id:this.options.interest_id};return this.options.referrer&&(t.referrer=this.options.referrer),l.create("InterestFollowResource",t)},unfollowInterest:function p(){this._getFollowResource().callDelete();var t=this.options.pin_id;this.triggerEvent(s.EVENT_CONTENT_CHANGED,null,!0),h.setTimeout(function(){this.triggerEvent(s.EVENT_DISMISS,null,!0),r.instance.publish(t,s.PUBSUB_TOPIC_PIN_HIDDEN_UNFOLLOW,s.FeedbackType.UNFOLLOW_INTEREST)}.bind(this),this.HIDE_DELAY)}});d.prototype.className="InterestPinInfo",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=i(8),l=i(34),h=o.extend({events:{"click .notMyTaste":"notMyTaste","click .notRelevant":"notRelevant","click .seenBefore":"seenBefore","click .noRecommendations":"noRecommendations"},CssClassName:{HIDDEN:"hidden"},_hidePin:function d(t){this.showLoading();var e=this.options.recommendation_reason,i={complaint_reason:n.GEN.RecommendationComplaintReason[t],pin_id:this.options.pin_id,feedback_type:this.options.feedback_type,recommendation_reason_id:n.GEN.ReasonToChoose[e.reason],through_id:this.getThroughId(e),promoted:!1},s=r.create("PinFeedbackResource",i);s.callUpdate().then(function(t){l.setTimeout(function(){this.hideLoading(),this.triggerEvent(n.EVENT_DISMISS,null,!0),a.instance.publish(this.options.pin_id,n.PUBSUB_TOPIC_PIN_HIDDEN,"hidePin")}.bind(this),100)}.bind(this))},getThroughId:function c(t){return t.board?t.board.id:t.pin?t.pin.id:t.interest?t.interest.id:""},notMyTaste:function u(){this._hidePin("NOT_MY_TASTE_OR_STYLE")},notRelevant:function p(){this._hidePin("NO_LONGER_RELEVANT")},seenBefore:function _(){this._hidePin("SEEN_IT_BEFORE")},noRecommendations:function g(){this._hidePin("DO_NOT_WANT_RECOMMENDATIONS")}});h.prototype.className="PinFeedback",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(115),r=i(50),l=i(35),h=i(8),d=i(104);i(116);var c=r.extend({events:{"change input":"onChange","click .radioOption":"onClickOption"},CssClassName:{SELECTED:"selected"},onContentReady:function u(){var t={reason:[d.Required()]};this.form=new a(this.$("form"),t),this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.submitButton=this.getChildById("submitButton"),this.submitButton.disable()},onSubmitValidated:function p(t){t.errors[0]||this.sendPinFeedback()},onClickOption:function _(t){var e=n(t.currentTarget).find("input");e.prop("checked","checked"),e.change()},onChange:function g(t){this.submitButton.enable();var e=n(t.target).parent();this._selected&&this._selected.removeClass(this.CssClassName.SELECTED),e.addClass(this.CssClassName.SELECTED),this._selected=e},sendPinFeedback:function m(){this.submitButton.showLoading();var t=this.$('[name="reason"]:checked').val(),e={complaint_reason:s.GEN.RecommendationComplaintReason[t],pin_id:this.options.pin_id,feedback_type:this.options.feedback_type};this.options.rec_reason_id&&(e.through_id=this.options.through_id,e.rec_reason_id=this.options.rec_reason_id);var i=h.create("PinFeedbackResource",e);i.callUpdate().fin(function(t){this.destroy(),this.triggerEvent(s.EVENT_PIN_FEEDBACK_SUBMITTED,this,!0)}.bind(this)).fail(function(t){l.showError(t.message)}).always(function(t){this.submitButton.hideLoading()}.bind(this))}});c.prototype.className="PinFeedbackDialog",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=i(8),l=i(34),h=o.extend({events:{"click .notInterested":"notInterested","click .seenBefore":"seenBefore","click .offensive":"offensive","click .dislikePromo":"dislikePromo"},_sendFeedback:function d(t){this.showLoading();var e={complaint_reason:n.GEN.RecommendationComplaintReason[t],pin_id:this.options.pin_id,feedback_type:this.options.feedback_type,promoted:!0},i=r.create("PinFeedbackResource",e);i.callUpdate().then(function(t){l.setTimeout(function(){this.hideLoading(),this.triggerEvent(n.EVENT_DISMISS,null,!0),a.instance.publish(this.options.pin_id,n.PUBSUB_TOPIC_PIN_HIDDEN,"hidePin")}.bind(this),100)}.bind(this))},notInterested:function c(){this._sendFeedback("NOT_INTERESTED")},seenBefore:function u(){this._sendFeedback("SEEN_IT_BEFORE")},offensive:function p(){this._sendFeedback("OFFENSIVE")},dislikePromo:function _(){this._sendFeedback("OTHER_REASON")}});h.prototype.className="PromotedPinFeedback",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(138),r=i(410),l=i(34),h=r.extend({events:n.extend(r.prototype.events,{"click .showSurvey":"showSurvey","click .alcohol":"alcohol"}),showSurvey:function d(){this._ensureSurvey(),l.setTimeout(function(){this.triggerEvent(s.EVENT_DISMISS,null,!0),this._feedbackDropdown.slideIn(200)}.bind(this),this.HIDE_DELAY)},_ensureSurvey:function c(){if(!this._feedbackDropdown){var t=this.options.pin_id,e={pin_id:t,promoter:this.options.promoter,feedback_type:s.GEN.PinFeedbackTypes.BLOCK_SINGLE_PFY_PIN},i={name:"PromotedPinFeedback",options:e},n={anchor:this.parent.options.anchor,module:i,hide_caret:!0,view_type:"pinFeedbackTool",position_point:"TOP_RIGHT",display_while_loading:!0,force_in_viewport:!0,class_name:"underneathHeader"};this._feedbackDropdown=new a({id:"dropdown",options:n}),this._feedbackDropdown.initHovering(),this.addChild(this._feedbackDropdown)}},alcohol:function u(){this.sendFeedback(s.GEN.RecommendationComplaintReason.DO_NOT_WANT_ALCOHOL_ADS)}});h.prototype.className="PromotedPinInfo",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(410),l=i(23),h=i(34),d=r.extend({events:n.extend(r.prototype.events,{"click .stopShowing":"stopShowing"}),stopShowing:function c(t){var e=this.options.pin_id,i=s(t.target).closest(".stopShowing");this.$(".preAction").addClass(this.CssClassName.HIDDEN),this.triggerEvent(o.EVENT_CONTENT_CHANGED,null,!0),h.setTimeout(function(){this.triggerEvent(o.EVENT_DISMISS,null,!0),"board"===i.attr("data-object-type")?l.instance.publish(e,o.PUBSUB_TOPIC_PIN_HIDDEN_STOP_THROUGH_BOARD,o.FeedbackType.DOWNVOTE_BOARD):"pin"===i.attr("data-object-type")?l.instance.publish(e,o.PUBSUB_TOPIC_PIN_HIDDEN_STOP_THROUGH_PIN,o.FeedbackType.DOWNVOTE_PIN):"interest"===i.attr("data-object-type")&&l.instance.publish(e,o.PUBSUB_TOPIC_PIN_HIDDEN_STOP_THROUGH_INTEREST,o.FeedbackType.DOWNVOTE_INTEREST)}.bind(this),this.HIDE_DELAY)}});d.prototype.className="RelatedPinInfo",t.exports=a.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(410),r=i(8),l=a.extend({events:n.extend(a.prototype.events,{"click .reportUnrelatedPin":"reportUnrelatedPin"}),reportUnrelatedPin:function h(){var t={pin_id:this.options.pin_id,query:this.options.query,pin_type:this.options.pin_type};r.create("SearchPinFeedbackResource",t).callUpdate(),this.hidePin(s.FeedbackType.HIDE)}});l.prototype.className="SearchPinInfo",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19),a=i(46),r=s.extend({events:{'change input[name="scope"]':"onScopeChange"},queryStringWithoutFacets:function l(){var t=window.location.search;return t=t.replace(/&fc=[^&]*/,""),t=t.replace(/\?fc=[^&]*&?/,"?")},navigateToScope:function h(t){var e=this.queryStringWithoutFacets();a.isAuthenticated()||"my_pins"!==t||this.navigate("/join/"),this.navigate("/search/"+t+"/"+e)},navigateToFacet:function d(t,e){var i=this.queryStringWithoutFacets();e&&(i+=(""===i?"?":"&")+"fc="+e),this.navigate("/search/"+t+"/"+i)},onScopeChange:function c(t){var e=n(t.currentTarget),i=e.val();if(i!==this.options.scope){var s=e.attr("data-url")||i;this.navigateToScope(s)}}});r.prototype.className="SearchScopeSelector",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="ClippedPinVisualObject",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=n.extend({onClick:function r(t){this.triggerEvent(o.EVENT_VISUAL_SEARCH_OBJECT_CROP_BUTTON_PRESSED,{commerce:!0},!0)}});a.prototype.className="FlashbuyButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(81),r=i(23);i(151);var l=o.extend({onContentReady:function h(){var t=this.data.search_identifier;a.getInstance().addSearchIdentifier(t),this.data&&r.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_ANNOTATIONS_ADDED,this.data)}});l.prototype.className="FlashlightResults",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=n.extend({onClick:function r(t){this.triggerEvent(o.EVENT_VISUAL_SEARCH_OBJECT_CROP_BUTTON_PRESSED,{commerce:!1},!0)}});a.prototype.className="VisualCropSearchButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({onContentReady:function a(){this._fadeOutBoxesIfReady()},onAddedToDom:function r(){this._fadeOutBoxesIfReady()},_fadeOutBoxesIfReady:function l(){this.inDom&&this.contentReady&&setTimeout(function(){this.$(".visualSearchOverlayInnerWrapper>img").fadeTo(1500,1)}.bind(this),1e3)}});o.prototype.className="VisualSearchPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(166);var o=n.extend({});o.prototype.className="VisualSearchPageQueryItem",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19),a=s.extend({events:{"click label":"_onPinTypeLabelClick"},navigateToPinType:function r(t){this.navigate("/search/"+t+"/"+this.options.pin_id+"/")},_onPinTypeLabelClick:function l(t){var e=n(t.currentTarget),i=e.find("input"),s=i.val();if(s!==this.options.pin_type){var o=i.attr("data-url")||s;return this.navigateToPinType(o),!1}}});a.prototype.className="VisualSearchSelector",t.exports=o.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(18),a=n.extend({onCreated:function r(){this.showDuplicates=!1,this.fetchVisuallySimilarResults(this.options)},fetchVisuallySimilarResults:function l(t){var e="VisualLiveSearchResource";t.keep_duplicates=this.showDuplicates;var i={name:"FlashlightResults",id:"flashlightResults",resource:{name:e,options:t}},n=this.getChildById("flashlightResults");n&&n.fadeOut(function(){n.destroy()}),this.showLoading(),o.load(i).then(function(t){t.render().then(function(){this.hideLoading(),this.insertChild(t,this.$(".flashlightResultsContainer"))}.bind(this))}.bind(this))}});a.prototype.className="VisuallySimilar",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(135),r=i(18),l=i(46),h=i(83),d=o.extend({onContentReady:function c(){var t=function i(){window.close()};if(l.isWriteBanned())h.showWriteBanned(this),this.listen(this,n.EVENT_DISMISS,t);else{var e={name:"ConfirmDialog",options:{template:"offsite_warning",sanitized_url:this.options.sanitized_url,redirect_status:this.options.redirect_status,offsite_message:this.options.offsite_message}};r.load(e).then(function(e){e.render().then(function(){a.get().createAndShowModal(e),e.on(n.EVENT_CONFIRM,function(){window.location.replace(this.options.sanitized_url),e.off(n.EVENT_DESTROYED,t)}.bind(this)),e.on(n.EVENT_DESTROYED,t)}.bind(this))}.bind(this))}}});d.prototype.className="OffsitePage",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(40),l=i(80),h=i(81),d=a.extend({events:{"click .closeGator":"_close"},CssClassName:{SHOW_LOADING:"displayed",VISIBLE:"visible"},onContentReady:function c(){this._positionFeed(),this.updateOptionsAndDom({state_showLoading:!1}),this.childListen(s.EVENT_ITEMS_REQUEST_START,this._toggleLoading),this.childListen(s.EVENT_ITEMS_REQUEST_SUCCESS,this._toggleLoading)},onAddedToDom:function u(){h.getInstance().setupViewContextLogging(this,this,s.GEN.ComponentType.PIN_AGGREGATED_ACTIVITY,{},this.getChildByModuleName("AggregatedActivityItems"));var t={event_type:s.GEN.EventType.VIEW,view_type:s.GEN.ViewType.AGGREGATED_PIN_FEED},e=l.fromPlainObject(t);h.getInstance().addEvent(e)},getOwnedScrollables:function p(){return this.options.can_close?this.$el:n()},_close:function _(){this.options.origin_location?this.options.force_refresh?this.navigate(this.options.origin_location,null,s.GEN.ForceRefreshType.PAGE):this.navigate(this.options.origin_location):this.triggerEvent(s.EVENT_CLOSE,this,!0)},_positionFeed:function g(){if(!r.instance.is_mobile_agent){var t=this.data&&this.data.images;if(t){var e=t["236x"];this.$(".feedItems").css("margin-left",e.width)}}this.updateOptionsAndDom({state_visible:!0})},_toggleLoading:function m(){this.updateOptionsAndDom({state_showLoading:!this.options.state_showLoading})},updateDom:function f(){this.$(".feedLoading").toggleClass(this.CssClassName.SHOW_LOADING,this.options.state_showLoading),this.$el.toggleClass(this.CssClassName.VISIBLE,this.options.state_visible)}});d.prototype.className="AggregatedActivityFeed",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(2),s=i(125),o=i(19),a=19,r=s.extend({_getPageSize:function l(){return a},getOwnedScrollables:function h(){var t=this.getParentByModuleName("AggregatedActivityFeed");return t.options.can_close?t.getContent():n()}});r.prototype.className="AggregatedActivityItems",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="AggregatedActivityPreview",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="AggregatedBoardActivity",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(11),a=i(81),r=n.extend({onContentReady:function l(){var t=o.GEN.ComponentType.PIN_CLOSEUP_AGGREGATED;a.getInstance().setupModuleViewContextLogging(this,t,{})}});r.prototype.className="AggregatedCloseupCard",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="AggregatedLikeActivity",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(150);var o=n.extend({});o.prototype.className="CloseupAboutPinCard",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(173),i(350);var o=n.extend({});o.prototype.className="PinActionDropdown",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151),i(343),i(166);var o=n.extend({getPin:function a(){return this.getChildByModuleName("Pin")}});o.prototype.className="UnauthCloseup",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(19),s=i(50),o=s.extend({});o.prototype.className="CloseupBuyablePriceInfo",t.exports=n.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(167),o=i(19),a=i(50),r=i(126),l=58,h=0,d=a.extend({_listener:null,events:{"click .catalogItem":"_handleCatalogImageClick"},onContentReady:function c(){this.productGallery=this.getChildByModuleName("ProductGallery"),this._listener?this.onScroll():(this._listener=this.childListen(n.EVENT_VARIANT_PICKER_CLICKED,this._handleVariantClick),this.childListen(n.EVENT_CATALOG_IMAGE_CLICKED,this._handleCatalogImageClick))},onAddedToDom:function u(){this.scrollListener=this.listen(this.getScrollableElement(),n.EVENT_SCROLL,this.onScroll),this.listen(r,n.EVENT_RESIZE,this.onScroll),this.onScroll()},onScroll:function p(){if(this.productGallery){var t=this.$(".galleryContainer"),e=this.productGallery.getGalleryHeight(),i=this.getScrollableElement(),n=this.$(".FlashlightEnabledImage"),s=i.scrollTop(),o=n.height(),a=n.offset().top,r=this.$el.closest(".closeupContainer"),h=r.offset().top,d=parseInt(r.css("margin-top")),c=a-h-l+d,u=o+c-e;c>s?t.css("top",0):u>s?t.css("top",s-c+"px"):t.css("top",o-e)}},updateDom:function _(){this.renderExistingData()},getCloseupRichTypes:function g(){return s.getCloseupRichTypes(this.data)},_handleVariantClick:function m(t){this.updateOptionsAndDom({catalog_id:h,variant_id:t.data.variantId})},_handleCatalogImageClick:function f(t){this.updateOptionsAndDom({catalog_id:t.data.catalogId,catalog_position:t.data.catalogPosition})}});d.prototype.className="CloseupBuyableProductCarousel",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({events:{"click div.showMore":"onShowMoreClick"},CssClassName:{ELLIPSIS:"ellipsis",HIDDEN:"hidden"},updateDom:function a(){this.$(".productDescription p").toggleClass(this.CssClassName.ELLIPSIS,!this.options.showMore),this.$(".showMore").toggleClass(this.CssClassName.HIDDEN,!!this.options.showMore)},onShowMoreClick:function r(t){this.updateOptionsAndDom({showMore:!0})}});o.prototype.className="CloseupBuyableProductInfo",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({CssClassName:{SHADOW:"shadow",FIXED:"fixed",SHOW_NAME:"showName",HIDE_NAME:"hideName"},onCreated:function r(){this._canSeeFixedHeader=!1},onContentReady:function l(){this.scrollListener=this.listen(this.getScrollableElement(),n.EVENT_SCROLL,this.onScroll)},_getScrollTop:function h(){return this.getScrollableElement().scrollTop()},onScroll:function d(){var t=this._getScrollTop(),e=this.$el.offset().top,i=this.$(".fixedHeader"),n=this.$(".fixedHeaderNameAndImage");if(!(0>t)){var s=t>e;s^this._canSeeFixedHeader&&(n.toggleClass(this.CssClassName.HIDE_NAME,this._canSeeFixedHeader),n.toggleClass(this.CssClassName.SHOW_NAME,!this._canSeeFixedHeader),i.toggleClass(this.CssClassName.SHADOW),this._canSeeFixedHeader=s);var o=t>0;i.toggleClass(this.CssClassName.FIXED,o)}}});a.prototype.className="MerchantPageHeader",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="OrderHistory",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="OrderHistoryDetail",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="OrderHistorySummary",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=363,r=70,l=o.extend({events:{"click .priceFilterButton":"showPriceFilter","click .priceFilter":"hidePriceFilter","mousedown .filterPriceSlider":"startSlide"},onContentReady:function h(){this.scrollListener=this.listen(this.getScrollableElement(),n.EVENT_SCROLL,this.onScroll),this.$priceFilterValue=this.$(".filterPriceValue"),this.$priceFilterButton=this.$(".priceFilterButton"),this.$priceFilter=this.$(".priceFilter"),this.$priceFilterSlider=this.$(".filterPriceSlider"),this.$priceFilterSlider.draggable({axis:"y",containment:"parent",cursor:"move",drag:this.updatePriceFilter.bind(this),stop:this.onPriceSelected.bind(this),scroll:!1}),this.updateOptions({price_filter_active:!1,price_slider_active:!1,price_filter_value:"$"})},onScroll:function d(t){this.options.price_filter_active&&(this.options.price_slider_active&&this.$priceFilterSlider.trigger("mouseup"),this.hidePriceFilter())},updateDom:function c(){this.$priceFilter.toggleClass("active",this.options.price_filter_active),this.$priceFilterSlider.toggleClass("active",this.options.price_slider_active),this.$priceFilterValue.html(this.options.price_filter_temp_value),this.$priceFilterButton.html(this.options.price_filter_value)},startSlide:function u(){this.updateOptionsAndDom({price_slider_active:!0})},stopSlide:function p(){this.updateOptionsAndDom({price_slider_active:!1,price_filter_value:this.options.price_filter_temp_value})},showPriceFilter:function _(){this.updateOptionsAndDom({price_filter_active:!0,price_slider_active:!1})},hidePriceFilter:function g(){this.updateOptionsAndDom({price_filter_active:!1,price_slider_active:!1})},updatePriceFilter:function m(t,e){var i=this.options.price_buckets.length-1,n=Math.floor((e.offset.top-this.$priceFilter.offset().top)/(a-r)*i),s=this.options.price_buckets[i-n];this.updateOptionsAndDom({price_filter_temp_value:s})},onPriceSelected:function f(){this.stopSlide(),this.updateResource(),setTimeout(this.hidePriceFilter.bind(this),300)},updateResource:function C(){this.triggerEvent(n.EVENT_PRICE_SELECTED,this.options.price_filter_value,!0)}});l.prototype.className="PriceFilter",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(8);i(447),i(449),i(450);var r=o.extend({_listener:null,onContentReady:function l(){this._listener||(this._listener=this.childListen(n.EVENT_PRODUCT_APPROVAL_BUTTON_CLICKED,this._update_product_approval_status))},_update_product_approval_status:function h(){var t=this.getChildByModuleName("ProductApprovalButton").options.product_approved,e="";this.data.product.is_approved&&(e=this.getChildByModuleName("ProductApprovalSelect").el.value);var i={merchant_id:this.data.product.merchant_id,product_id:this.data.product.group_id,disapprove_product:t,rationale:e},n=a.create("ProductApprovalResource",i);n.callUpdate().fin(function(t){window.location.reload()})}});r.prototype.className="ProductDetailsPage",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(116),i(178),i(448);var o=n.extend({});o.prototype.className="ProductsPageHeader",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(23),r=n.extend({onClick:function l(t){this._toggleState(),a.instance.publish(o.PUBSUB_CHANNEL_COMMERCE_ACTIVE_PRODUCTS,o.PUBSUB_TOPIC_COMMERCE_ACTIVE_PRODUCTS,this.options.toggled)},_toggleState:function h(){this._setState(!this._getState())},_setState:function d(t){this.options.toggled=t,this.renderExistingData()},_getState:function c(){return this.options.toggled}});r.prototype.className="ActiveProductsOnlyButton",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=n.extend({onClick:function r(t){this.triggerEvent(o.EVENT_PRODUCT_APPROVAL_BUTTON_CLICKED,null,!0)}});a.prototype.className="ProductApprovalButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="ProductApprovalSelect",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(50),o=i(19),a=96,r=4,l=98,h=35,d=s.extend({events:{"click .arrowUp":"_handleUpClick","click .arrowDown":"_handleDownClick","click .catalogItem":"_handleCatalogImageClick"},onContentReady:function c(){this.$carousel=this.$(".productCatalog"),this.$carousel.length&&(this.carouselLength=this.$carousel.children().length,this.endPosition=(this.carouselLength-r)*a,this.position=this.options.catalog_position,this.updateCarousel(!1))},_handleCatalogImageClick:function u(t){if(t.target.dataset){var e=t.target.dataset.catalogId;this.triggerEvent(n.EVENT_CATALOG_IMAGE_CLICKED,{catalogId:parseInt(e),catalogPosition:this.position},!0)}},_handleUpClick:function p(){if(!(this.position<=0)){var t=this.position/a;r>t?this.position-=a*t:this.position-=a*r,this.updateCarousel(!0)}},_handleDownClick:function _(){if(!(this.position>=this.endPosition)){var t=this.carouselLength-this.position/a-r;r>t?this.position+=a*t:this.position+=a*r,this.updateCarousel(!0)}},updateCarousel:function g(t){if(this.$(".arrowUp").toggleClass("hide",this.position<=0),this.$(".arrowDown").toggleClass("hide",this.position>=this.endPosition),t){var e="transform .3s ease-in-out";this.$carousel.css({transition:e})}var i="translateY("+-this.position+"px)";this.$carousel.css({transform:i})},getGalleryHeight:function m(){var t=this.$(".productCatalog").children().length;return r>=t?t*l:l*r+h}});d.prototype.className="ProductGallery",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(151),i(447);var a=o.extend({onContentReady:function r(){var t={};t[n.PUBSUB_TOPIC_COMMERCE_ACTIVE_PRODUCTS]=this.onProductFilterChange,this.pubsubSubscribe(n.PUBSUB_CHANNEL_COMMERCE_ACTIVE_PRODUCTS,t)},onProductFilterChange:function l(t,e,i){var n=this.getChildByModuleName("Grid");n.resource.options.current_products_only=i,n.render()}});a.prototype.className="ProductsPage",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(50),o=i(19),a=i(454),r="addButton",l=s.extend({events:{"click .shippingAddress":"editShippingAddress"},onContentReady:function h(){this.childListen(n.EVENT_CHANGE,this.onAddressChanged),this.listen(this.getChildById(r),n.EVENT_BUTTON_CLICK,this.onAddClicked)},onAddClicked:function d(t){var e={is_new:!0},i=new a({data:{},options:e});i.render().then(function(){this.insertChild(i,this.$el)}.bind(this))},onAddressChanged:function c(t){this.render()},editShippingAddress:function u(t){var e=parseInt(t.target.dataset.index),i=this.data[e],n={is_new:!1},s=new a({data:i,options:n});s.renderExistingData().then(function(){this.insertChild(s,this.$el)}.bind(this))}});l.prototype.className="ShippingAddress",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(115),a=i(50),r=i(8),l=i(19),h=i(104),d="deleteButton",c=a.extend({onContentReady:function u(){if(this.options.is_new||this.listen(this.getChildById(d),s.EVENT_BUTTON_CLICK,this.onDeleteClick),this.$form=this.$(".standardForm"),this.$form){var t={first_name:[h.Required()],last_name:[h.Required()],email:[h.Required(),h.Email()],phone:[h.Required(),h.PhoneNumber()],street:[h.Required()],locality:[h.Required()],region:[h.Required(),h.Length({min:2,max:2})],country:[h.Required()],postal_code:[h.Required(),h.Number(),h.Length({min:5,max:5})]};this.form=new o(this.$form,t),this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)}},onSubmitValidated:function p(t){t.errors[0]||this.submitShippingAddress()},onDeleteClick:function _(t){var e={id:this.data.id},i=r.create("CommerceShippingAddressDetailResource",e);return i.callDelete().then(function(){this.triggerEvent(s.EVENT_CHANGE,null,!0),this.remove()}.bind(this))},submitShippingAddress:function g(){var t=this._getFormData(),e={street:t.street,extra_street:t.extra_street,locality:t.locality,region:t.region,country:t.country,postal_code:t.postal_code},i={first_name:t.first_name,last_name:t.last_name,address:JSON.stringify(e),phone:t.phone,email:t.email,id:this.data.id,commerceResource:!0},n=r.create("CommerceShippingAddressDetailResource",i);this.options.is_new?n.callCreate().then(function(t){this.triggerEvent(s.EVENT_CHANGE,null,!0),this.remove()}.bind(this)):n.callUpdate().then(function(t){this.triggerEvent(s.EVENT_CHANGE,null,!0),this.remove()}.bind(this))},_getFormData:function m(){var t=this.$form.serializeArray(),e={};return n.each(t,function(t){e[t.name]=t.value}),e}});c.prototype.className="ShippingAddressDetail",t.exports=l.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({CssClassName:{SHADOW:"shadow",FIXED:"canSeeFixedHeader",SHOW_NAME:"showName",HIDE_NAME:"hideName"},onCreated:function r(){this._canSeeFixedHeader=!1},onContentReady:function l(){this.scrollListener=this.listen(this.getScrollableElement(),n.EVENT_SCROLL,this.onScroll),this.grid=this.getChildByModuleName("Grid"),this.priceFilter=this.getChildByModuleName("PriceFilter"),this.priceFilter&&(this.priceFilter.updateOptions({price_filter_temp_value:this.grid.data[0].price_buckets[0],price_buckets:this.grid.data[0].price_buckets}),this.childListen(n.EVENT_PRICE_SELECTED,this.updateResource))},updateResource:function h(t){var e=t.data,i={board_id:this.data.object_id};"$"!==e&&(i.suggested_price=parseInt(e.substring(1))),this.grid.setItemsResource({name:"BoardBuyableFeedResource",options:i}),this.grid.renderItems()},_getScrollTop:function d(){return this.getScrollableElement().scrollTop()},onScroll:function c(){var t=this._getScrollTop(),e=this.$el.offset().top,i=this.$(".fixedHeader"),n=this.$(".fixedHeaderNameAndImage");if(!(0>t)){var s=t>e;(!s&&this._canSeeFixedHeader||!this._canSeeFixedHeader&&s)&&(n.toggleClass(this.CssClassName.HIDE_NAME,this._canSeeFixedHeader),n.toggleClass(this.CssClassName.SHOW_NAME,!this._canSeeFixedHeader),i.toggleClass(this.CssClassName.SHADOW,s),this._canSeeFixedHeader=s);var o=t>0;i.toggleClass(this.CssClassName.FIXED,o);
}}});a.prototype.className="ShopBoardPage",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="ShopCollectionsView",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="ShopGrid",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({onContentReady:function r(){this.grid=this.getChildByModuleName("Grid"),this.priceFilter=this.getChildByModuleName("PriceFilter"),this.priceFilter&&(this.priceFilter.updateOptions({price_filter_temp_value:this.grid.data[0].price_buckets[0],price_buckets:this.grid.data[0].price_buckets}),this.childListen(n.EVENT_PRICE_SELECTED,this.updateResource))},updateResource:function l(t){var e=t.data,i={domain:this.data.domain};"$"!==e&&(i.suggested_price=e),this.grid.setItemsResource({name:"MerchantFeedResource",options:i}),this.grid.renderItems()}});a.prototype.className="ShopMerchantPage",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="ShopSpace",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(461);var o=n.extend({});o.prototype.className="UserOrdersPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(462);var o=n.extend({});o.prototype.className="OrderView",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="OrderItem",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({events:{"click .variant":"_handleVariantClick"},_handleVariantClick:function r(t){if(t.target.dataset){var e=t.target.dataset.variantId;this.triggerEvent(n.EVENT_VARIANT_PICKER_CLICKED,{variantId:parseInt(e)},!0)}}});a.prototype.className="VariantPicker",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(152),h=i(23),d=i(8),c=i(46);i(116),i(155);var u=r.extend({events:{click:"onListItemClick"},CssClassName:{ACTIVE:"active",ANIMATING_OUT:"animatingOut",ANIMATED_OUT:"animatedOut",UNREAD:"unread"},onListItemClick:function p(t){var e=this.getChildById("hideConversation");if(e){var i=s(t.target);if(i.closest(e.getContent()).length){var n={conversation_id:this.data.id};this.triggerEvent(o.EVENT_CONVERSATIONS_PREVENT_CONVERSATIONS_RENDERING_ON_CHANGE,!0,!0);var a=d.create("ConversationResource",n);a.callDelete({showError:!1});var r=this.$el;return r.addClass(this.CssClassName.ANIMATING_OUT),void r.one("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd",function(){r.addClass(this.CssClassName.ANIMATED_OUT),window.setTimeout(function(){this.destroy(),this.remove(),this.triggerEvent(o.EVENT_CONVERSATIONS_PREVENT_CONVERSATIONS_RENDERING_ON_CHANGE,!1,!0),l.removeConversationById(this.data.id),l.logContextEvent(o.GEN.EventType.CONVERSATION_HIDE,this.data.id,null,r),this.data.unread>0&&h.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_CONVERSATION_UNREAD_COUNT_DECREASE,this.data.unread)}.bind(this),200)}.bind(this))}}var c=this.data;if(this.triggerEvent(o.EVENT_CONVERSATION_LIST_ITEM_CLICKED,c,!0),this.options.open_conversation_on_click){this.data.unread&&this.triggerEvent(o.EVENT_UNREAD_CONVERSATION_LIST_ITEM_CLICK,null,!0),this.$el.removeClass(this.CssClassName.UNREAD);var u=this.getChildById("conversationHead").getContent();l.addConversation(c,!0,u),this.triggerEvent(o.EVENT_DISMISS,null,!0)}},setActive:function _(t){this.$el.toggleClass(this.CssClassName.ACTIVE,t)},isActive:function g(){return this.$el.hasClass(this.CssClassName.ACTIVE)},getUsers:function m(){return this.data.users},getUserIds:function f(){return n.pluck(this.getUsers(),"id")},getOtherUsers:function C(){var t=this.getUsers();return n.reject(t,function(t){return t.id===c.get("id")})},getEmails:function E(){return this.data.emails},getFirstUser:function v(){var t=this.getOtherUsers();return t.length>0?t[0]:{id:this.getEmails()[0]}}});u.prototype.className="ConversationListItem",t.exports=a.register(u)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(161),h=i(23),d=i(46);i(116),i(173),i(174),i(466),i(467),i(469);var c=220,u=35,p=r.extend({mixins:[l],events:{"click .convosHeader":"onHeaderClick"},CssClassName:{VISIBLE:"visible"},getConversationsManager:function _(){return this.getParentByModuleName("ActiveConversations").getConversationsManager()},onCreated:function g(){this._unseenMessageCount=0},onHeaderClick:function m(){this.getConversationsManager().closeConversationById(this.options.id)},onContentReady:function f(){this.childListen(o.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(o.EVENT_ENTER_PRESSED,this.onInputEnterPressed),this.childListen(o.EVENT_TEXT_INPUT_RESIZED,this.onInputSizeChanged),this.childListen(o.EVENT_CONVERSATION_MESSAGES_SCROLL,this.onConversationMessagesReady),this.startPreventingScroll(),this.listen(this,o.EVENT_DROPDOWN_CONTAINER_SHOWN,this.onShownInDropdown),this.onMessagesScroll=this.onMessagesScroll.bind(this),this.onMessagesScroll=n.throttle(this.onMessagesScroll,200),this.scrollToLatest(),this._scrollListener=this.listen(this.getConversationMessagesList(),"scroll",this.onMessagesScroll)},onConversationMessagesReady:function C(){this.options.peek&&this.data.unread&&(this._shouldMarkAsReadOnOpen=!0),this.showEmailSentIfNecessary(),this.scrollToLatest()},showEmailSentIfNecessary:function E(){var t=this.data.emails||[],e=1===t.length&&t[0]===d.get("email"),i=this.$(".ConversationMessage").length;if(t.length>0&&!e&&i>0&&3>=i){var n=this.$(".emailSentText");n.show()}},getConversationMessagesList:function v(){return this.$(".conversationMessagesList")},getConversationMessagesModule:function I(){return this.getChildByModuleName("ConversationMessages")},onInputSizeChanged:function T(t){if("textField"===t.target.id){var e=this.getChildById("textField").getHeight(),i=this.$(".messagesContainer");i.css("bottom",e+"px"),this.isScrolledToBottom()&&this.scrollToLatest()}},startPreventingScroll:function N(){var t=this.getConversationMessagesModule();t&&this.startPreventScroll(this.getConversationMessagesList(),this.$(".messagesContent"))},_getSpinner:function S(){return this.$(".spinner")},setUnseenMessageCount:function b(t){this._unseenMessageCount=this._unseenMessageCount+t},onMessagesScroll:function y(t){if(this._unseenMessageCount){var e=this.getConversationMessagesModule(),i=e.getBottomPosition(this._unseenMessageCount);i<=this.getConversationMessagesList().height()&&(this._unseenMessageCount=Math.max(this._unseenMessageCount-1,0),h.instance.publish(o.PUBSUB_CHANNEL_SITE,o.PUBSUB_TOPIC_CONVERSATION_UNREAD_COUNT_DECREASE,1),this.triggerEvent(o.EVENT_CONVERSATION_DECREMENT_BADGE,null,!0))}if(this.getConversationMessagesList().scrollTop()<=c){this._getSpinner().addClass(this.CssClassName.VISIBLE);var n=this.getConversationMessagesModule(),s=n.getHeight();n.fetchPrevMessages(function(){var t=n.getHeight();t!==s&&(this.startPreventingScroll(),this.getConversationMessagesList().scrollTop(t-s))}.bind(this),null,function(){this._getSpinner().removeClass(this.CssClassName.VISIBLE)}.bind(this))}},onShownInDropdown:function P(t){var e=this.$(".ConversationMessages");e.off("click",s.proxy(this._focusInput,this)),e.on("click",s.proxy(this._focusInput,this)),this.scrollToLatest();var i=this.getConversationMessagesModule();i&&(i.updateTimestamps(),this._shouldMarkAsReadOnOpen&&(i.markMessagesAsRead(this.data.unread),this._shouldMarkAsReadOnOpen=!1))},getDropTarget:function B(){return this.$(".dropTarget")},scrollToLatest:function A(){this.getConversationMessagesModule()&&(this.getConversationMessagesList().scrollTop(this.getConversationMessagesModule().getHeight()),this.startPreventingScroll())},setDropTargetText:function R(t){var e=this.getDropTarget(),i=e.find("p");i.text(t)},focus:function w(){return this._focusInput()},_focusInput:function O(){var t=this.getChildById("textField");t&&t.focus()},onInputEnterPressed:function D(t){t.stopPropagation();var e=s.trim(t.target.getValue());e.length&&(this.sendMessage(e,null),this.clearInput())},clearInput:function x(){var t=this.getChildById("textField");t.setValue("")},showDropTarget:function L(){this.getDropTarget().addClass(this.CssClassName.VISIBLE)},hideDropTarget:function k(){this.getDropTarget().removeClass(this.CssClassName.VISIBLE)},sendMessage:function U(t,e){if(t||!n.isEmpty(e)){var i=this.options.id,s={};if(t&&(s.text=t),e){var a=e.data;s.object_type=a.type,s.object_id=a.id}if(d&&!d.isWriteBanned()){var r=this.getConversationMessagesModule(),l=this.isScrolledToBottom()?this.scrollToLatest.bind(this):function(){};e?r.appendObjectMessage(e.getContent().clone(),l):r.appendTextMessage(t,l)}var h=this.getConversationsManager();h.sendMessageToConversation(i,s).then(function(){this.fetchNewMessages(1),this.focus(),h.logContextEvent(o.GEN.EventType.CONVERSATION_MESSAGE_SEND,i,e?e.data.id:null,this.$el)}.bind(this),function(t){this.getConversationMessagesModule().deleteLastClientMessage()}.bind(this))}},isScrolledToBottom:function M(){var t=this.getConversationMessagesList(),e=this.getConversationMessagesModule(),i=t.scrollTop(),n=t.height(),s=e.getHeight(),o=i+n+u;return o>=s},fetchNewMessages:function F(t,e){var i=this.getConversationMessagesModule();if(i){var n=this.isScrolledToBottom();e&&(this._shouldMarkAsReadOnOpen=!0),i.fetchNewMessages(t,e,function(){this.showEmailSentIfNecessary(),n?this.scrollToLatest():this.ensureScrollbarFlash()}.bind(this))}},ensureScrollbarFlash:function $(){var t=this.getConversationMessagesList();t.flashScrollbar()},renderMessages:function H(){var t=this.getConversationMessagesModule();t&&t.renderMessages(function(){this.showEmailSentIfNecessary(),this.scrollToLatest()}.bind(this))},onButtonClick:function V(t){var e=t.target;("closeChatButton"===e.id||"joinToReplyButton"===e.id)&&(this.getConversationsManager().closeConversationById(this.options.id),t.stopPropagation())}});p.prototype.className="ConversationPopup",t.exports=a.register(p)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(128),i(155),i(150),i(166);var a=o.extend({onContentReady:function r(){this.childListen(n.EVENT_PIN_DELETED,this.onAttachedObjectDeleted),this.childListen(n.EVENT_BOARD_DELETED,this.onAttachedObjectDeleted)},onAttachedObjectDeleted:function l(t){this.$(".msgObjectSent").remove(),this.destroy()}});a.prototype.className="ConversationMessage",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(466),r=i(50),l=i(62),h=i(14),d=i(8);i(468);var c=5,u=r.extend({CssClassName:{EMPTY:"empty",HAS_OBJECT:"hasObject"},onCreated:function p(){this._clientMessages=[]},onContentReady:function _(){this.triggerEvent(s.EVENT_CONVERSATION_MESSAGES_SCROLL,null,!0),this._lastMessage=this.data[this.data.length-1],this.resource.set("peek",!1)},appendTextMessage:function g(t,e){var i=this._createMessageWrapper(),n={is_own_message:!0,text:t,pending:!0},s=new a({options:n});s.render().then(function(){this._appendMessage(i,s),e&&e()}.bind(this))},_appendMessage:function m(t,e){e.getContent().appendTo(t),t.appendTo(this.$el),this.removeEmptyState(),this._clientMessages.push(e)},removeEmptyState:function f(){this.$(".emptyState").remove(),this.$el.removeClass(this.CssClassName.EMPTY)},_deleteClientMessage:function C(t){if(!t.destroyed){var e=t.getParentElement();t.destroy(),e.remove()}},_deleteAllClientMessages:function E(){this._clientMessages.forEach(function(t){this._deleteClientMessage(t)}.bind(this)),this._clientMessages=[]},deleteLastClientMessage:function v(){this._deleteClientMessage(this._clientMessages[this._clientMessages.length-1]),this._clientMessages.pop()},_createMessageWrapper:function I(){return n('<li class="messageWrapper"></li>')},getBottomPosition:function T(t){var e=this.children[this.children.length-t],i=e.getContent(),n=i.parent(),s=n.position().top;return s},fetchPrevMessages:function N(t,e,i){if(this.acquireRenderLock()){var n=function(){this.releaseRenderLock(),this.setPreventEmpty(!0),i&&i()}.bind(this);this.resetLastMessageTime(),this.renderAdditional(l.PREPEND).then(t,e).fin(n)}},fetchNewMessages:function S(t,e,i){if(this.acquireRenderLock()){var n=this.resource,s=d.clone(this.resource);s.resetBookmark(),this._lastMessage?(s.set("last_message_id",this._lastMessage.id),s.set("page_size",t+c)):s.set("page_size",t),s.set("peek",e||!1),this.setResource(s),this.setPreventEmpty(!0),this.setLastMessageTime(),this.renderAdditional(l.APPEND).then(function(){this.data.length&&(this._lastMessage=this.data[this.data.length-1]),this._deleteAllClientMessages(),i&&i()}.bind(this)).fin(function(){this.releaseRenderLock(),this.setResource(n)}.bind(this))}},setPreventEmpty:function b(t){this.options.prevent_empty=t},setLastMessageTime:function y(){this._lastMessage&&(this.options.last_message_time=this._lastMessage.created_at)},resetLastMessageTime:function P(){this.options.last_message_time=0},renderMessages:function B(t){this.acquireRenderLock()&&(this.setPreventEmpty(!0),this.resetLastMessageTime(),this.render().then(function(){this._deleteAllClientMessages(),t&&t()}.bind(this)).fin(function(){this.releaseRenderLock()}.bind(this)))},markMessagesAsRead:function A(t){var e=d.clone(this.resource);e.resetBookmark(),e.set("page_size",t),e.set("peek",!1),e.callGet()},acquireRenderLock:function R(){return this._rendering?!1:(this._rendering=!0,!0)},releaseRenderLock:function w(){this._rendering=!1},appendObjectMessage:function O(t,e){var i=n('<li class="messageWrapper"></li>'),s={is_own_message:!0,pending:!0},o=new a({options:s});o.render().then(function(){this._appendMessage(i,o),o.getContent().append(t).addClass(this.CssClassName.HAS_OBJECT).appendTo(i),e&&e()}.bind(this))},updateTimestamps:function D(){var t=this.getChildrenByModuleName("ConversationMessage");t.forEach(function(t){var e=t.getParentElement().next(".timeSeparator");e.length&&e.text(h.getHumanizedTimesince(t.data.created_at))})}});u.prototype.className="ConversationMessages",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(155);var o=n.extend({});o.prototype.className="ConversationEventMessage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(130),s=i(19),o=i(31),a=n.extend({getNavigateUrl:function r(t){return o.getRegisterUrl({action:"join"})}});a.prototype.className="JoinButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(50),a=i(19);i(116),i(471);var r="conversationList",l=o.extend({onCreated:function h(){this.onConversationsScroll=this.onConversationsScroll.bind(this),this.onConversationsScroll=n.throttle(this.onConversationsScroll,200)},onContentReady:function d(){this._scrollListener=this.listen(this.$(".convosContent"),"scroll",this.onConversationsScroll)},onConversationsScroll:function c(t){var e=s(t.target).scrollTop(),i=this._getList(),n=i.getHeight();n-e<=this.$(".convosContent").height()+10&&i.fetchMore()},_getList:function u(){return this.getChildById(r)}});l.prototype.className="ConversationsListDropdown",t.exports=a.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(62),l=i(152),h=i(34);i(125),i(472);var d=a.extend({onCreated:function c(){this._preventRenderOnChange=!1,this.childListen(s.EVENT_CONVERSATIONS_PREVENT_CONVERSATIONS_RENDERING_ON_CHANGE,this.onPreventConversationsRenderingOnChange),this.childListen(s.EVENT_UNREAD_CONVERSATION_LIST_ITEM_CLICK,this.onUnreadListItemClick)},onPreventConversationsRenderingOnChange:function u(t){this._preventRenderOnChange=t.data},onUnreadListItemClick:function p(t){var e=t.target.data.id,i=this.model.getData(),s=n.find(i,function(t){return t.id===e});if(s){var o=n.indexOf(i,s);s.unread=0,i[o]=s;var a=i.slice(0);this.model.set(a),this.renderExistingData()}},onContentReady:function _(){var t=!this.options.no_rerender;t&&!this.modelListener&&(this.modelUpdateHandler=n.debounce(this.onCollectionAddRemoveChange.bind(this),100),this.initialModel=this.model,this.modelListener=this.initialModel.on("add change remove",this.modelUpdateHandler)),this.data.length||this.triggerEvent(s.EVENT_CONVERSATIONS_IS_EMPTY,null,!0)},onRemovedFromDom:function g(){this.modelListener&&this.modelUpdateHandler&&this.model.off("add change remove",this.modelUpdateHandler)},onCollectionAddRemoveChange:function m(t,e){this.options.no_rerender||this._preventRenderOnChange||this._fetchingMore||(this.model!==this.initialModel&&(this.model=this.initialModel,this.resource.resetBookmark()),this.renderExistingData())},setListItemWithUserId:function f(t,e){var i=this.getChildById("list");if(i){var s=i.children;n.each(s,function(i,o){n.each(i.data.users,function(i){i.id===t&&s[o].setActive(e)}),n.each(i.data.emails,function(i){i===t&&s[o].setActive(e)})})}},fetchMore:function C(){this._fetchingMore||this.resource.atEnd()||(this.resource.get("bookmarks")||this.resource.setBookmarks(l.getConversationsBookmarks()),this._fetchingMore=!0,this.renderAdditional(r.APPEND).then(function(){h.setTimeout(function(){this._fetchingMore=!1}.bind(this),200)}.bind(this)))}});d.prototype.className="ConversationsList",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(152),l=i(8);i(155);var h=a.extend({onContentReady:function d(){var t=this.getChildrenByModuleName("ConversationHead");n.each(t,function(t){this.listen(t,s.EVENT_CONVERSATION_HEAD_CLICKED,this.onConversationHeadClick)}.bind(this)),(!this.data||this.data.length<3)&&this.triggerEvent(s.EVENT_CONVERSATIONS_IS_EMPTY_WITHOUT_FRIENDS,null,!0)},onConversationHeadClick:function c(t){var e=t.target;e.showLoading();var i=e.getUserIds(),n=l.create("ConversationsResource",{user_ids:i});n.callCreate().then(function(t){var i=t.resource_response.data;r.addConversation(i),e.hideLoading(),this.triggerEvent(s.EVENT_DISMISS,null,!0),this.render()}.bind(this))}});h.prototype.className="EmptyConversations",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({getLoggingObjectIdStr:function a(){return this.options.pin_id}});o.prototype.className="CardSourceAttribution",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(81),r=o.extend({onContentReady:function l(){var t=n.GEN.ComponentType.PIN_CLOSEUP_SOURCE_DESCRIPTION;a.getInstance().setupModuleViewContextLogging(this,t,{})}});r.prototype.className="CardSourceDescriptionText",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(50),a=i(81),r=i(19),l=i(27),h=30,d=70,c=o.extend({CssClassName:{DISPLAYED:"displayed"},events:{"click .hoverMask":"_expandInstructions"},_expandInstructions:function u(){this.updateOptionsAndDom({expandInstructions:!0}),this._logCustomContextEvent(s.GEN.EventType.CLICK,s.GEN.ElementType.PIN_MAKE_MODULE_GRID,s.GEN.ComponentType.PIN_CLOSEUP_MAKE,{}),a.getInstance().setupViewContextLogging(this,this.$(".expanded"),s.GEN.ComponentType.PIN_CLOSEUP_MAKE,{},this.$(".instructions")),this._scrollExpandedView()},_scrollExpandedView:function p(){var t=this.$el.offset().top-n(window).scrollTop();if(t>=window.innerHeight/2){var e=n(".PinActionBar").outerHeight()-s.CLOSEUP_HALF_TEXT_PADDING;this.isAmplifiedData||(e+=n(".Header").height(),n(".CloseupTitleCard").height()>d&&(e+=h)),l.scrollToTop({$scroller:this.getScrollableElement(),newScrollOffset:this.$el.position().top+e})}},onContentReady:function _(){this.isAmplifiedData=this.data&&this.data.from_aggregated_data;var t=this.isAmplifiedData?{from_aggregated_data:!0}:{},e=s.GEN.ComponentType.PIN_CLOSEUP_MAKE;a.getInstance().setupModuleViewContextLogging(this,e,t)},updateDom:function g(){this.$(".expanded").toggleClass(this.CssClassName.DISPLAYED,this.options.expandInstructions),this.$(".collapsed").toggleClass(this.CssClassName.DISPLAYED,!this.options.expandInstructions),this.isAmplifiedData&&(this.$(".mainHeader").toggleClass(this.CssClassName.DISPLAYED,!this.options.expandInstructions),this.$(".amplifiedExpandedHeader").toggleClass(this.CssClassName.DISPLAYED,this.options.expandInstructions))}});c.prototype.className="CloseupMakeCard",t.exports=r.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(166),r=i(81),l=i(59),h=o.extend({CssClassName:{ANIMATION_OVERLAY_EXPANDED:"expanded"},events:{"click .hoverMask":"_expandMap"},onCreated:function d(){this.childListen(n.EVENT_MAP_READY,this._onMapReady)},onContentReady:function c(){if(this.isInShowPinsWithPlaces=l.instance.v2InGroup("web_pins_with_places",["employees","enabled"]),this.isInShowPinsWithPlaces){var t=n.GEN.ComponentType.PIN_CLOSEUP_PLACE;r.getInstance().setupModuleViewContextLogging(this,t,{})}},_expandMap:function u(){this.map&&(this._showExpandedMapView(),this.triggerEvent(n.EVENT_SHOW_PINS_FROM_HERE,this,!0))},_showExpandedMapView:function p(){this.updateOptionsAndDom({expandAnimationOverlay:!0}),this.map&&this.map.expandPlacesMap(),this.getChildByModuleName("ExpandedPlaceInformation")._showExpandedPlaceInformation()},updateDom:function _(){this.$(".animationTransitionOverlay").toggleClass(this.CssClassName.ANIMATION_OVERLAY_EXPANDED,this.options.expandAnimationOverlay)},_onMapReady:function g(t){if(this.map=this.getChildById("map"),this.map){var e=new a({data:this.data});this.map.addMarkerToCloseupMap(e)}}});h.prototype.className="CloseupPlacePin",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151),i(382);var o=n.extend({});o.prototype.className="RecipeFeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(171);var o=n.extend({});o.prototype.className="RichPinHeading",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(480),s=i(19),o=n.extend({_OBJECT_ID_NAME:"board"});o.prototype.className="SendBoard",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(59),l=i(152),h=i(14),d=i(161);i(226),i(231),i(471),i(481),i(482),i(485);var c=a.extend({_OBJECT_ID_NAME:"",_SEND_RESOURCE_NAME:"ConversationsResource",mixins:[d],CssClassName:{VISIBLE:"visible"},onContentReady:function u(){this.childListen(s.EVENT_CONTENT_CHANGED,this.onContentChanged),this.childListen(s.EVENT_CONTACT_SELECTED,this.onContactSelected),this.childListen(s.EVENT_CONTACTS_IMPORTED,this.onContactsImported),this.childListen(s.EVENT_CONVERSATION_LIST_ITEM_CLICKED,this.onListItemClick),this.childListen(s.EVENT_DISMISS,this.onDismiss),this.childListen(s.EVENT_HIDE_MESSAGE_DRAFT_PANEL,this.onHideMessageDraftPanel),this.childListen(s.EVENT_HIDE_SOCIAL_CONNECT_PANEL,this.onHideSocialConnectPanel),this.childListen(s.EVENT_ITEM_SELECTED,this.onItemSelected),this.childListen(s.EVENT_SHOW_SOCIAL_CONNECT_PANEL,this.showSocialConnectPanel),this.childListen(s.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,this.onNoResultsReturned),this.childListen(s.EVENT_TYPEAHEAD_RESULTS_RETURNED,this.onResultsReturned),this.childListen(s.EVENT_TYPEAHEAD_SEARCH_START,this.onSearchStart),this.listen(this.parent,s.EVENT_DROPDOWN_SHOW,this.onShow),this.startPreventingScroll(),this._setup(),this._setInitialState(),r.instance.v2ActivateExperiment("web_group_board_creation"),this.isGroupBoardCreation=r.instance.v2InGroup("web_group_board_creation",["enabled","employee"]),this.selectedContacts=[]},onSearchStart:function p(t){this.$(".spinner").addClass(this.CssClassName.VISIBLE),this.hideContactsList()},onShow:function _(t){this._focusTypeahead(),this._setInitialState(),this.showContactsList(),this.hideMessageDraftPanel(),this.hideSocialConnectPanel()},_getTypeaheadField:function g(){return this.getChildById("typeaheadField")},_focusTypeahead:function m(){var t=this._getTypeaheadField();window.setTimeout(function(){t.focus()},100)},onContentChanged:function f(){this.startPreventingScroll()},onNoResultsReturned:function C(t){this.$(".spinner").removeClass(this.CssClassName.VISIBLE);var e=this._getTypeaheadField();e.getValue().trim().length||this.showContactsList()},onResultsReturned:function E(t){this.$(".spinner").removeClass(this.CssClassName.VISIBLE)},onHideSocialConnectPanel:function v(t){this._setInitialState(),this.hideSocialConnectPanel()},onHideMessageDraftPanel:function I(t){this._setInitialState(),this.hideMessageDraftPanel()},hideConversationsList:function T(){var t=this._getConversationsList();t.fadeOut()},showConversationsList:function N(){var t=this._getConversationsList();t.fadeIn()},_getConversationsList:function S(){return this.getChildById("conversationsList")},hideContactsList:function b(){var t=this._getContactsList();t.hide(),this._getTypeaheadField().toggleClass("flex",!0)},showContactsList:function y(){var t=this._getContactsList();t.show(),this._getTypeaheadField().toggleClass("flex",!1)},hideMessageDraftPanel:function P(){this.$(".MessageDraft").fadeOut(400,function(){this.$(".sendShareSearch").fadeIn()}.bind(this))},showMessageDraftPanel:function B(){this.$(".sendShareSearch").fadeOut(400,function(){this.$(".MessageDraft").fadeIn()}.bind(this))},hideSocialConnectPanel:function A(){this.$(".SocialConnectPanel").fadeOut(400,function(){this.$(".sendShareSearch").fadeIn()}.bind(this))},showSocialConnectPanel:function R(){this.$(".sendShareSearch").fadeOut(400,function(){this.$(".SocialConnectPanel").fadeIn()}.bind(this))},_getContactsList:function w(){return this.getChildById("contactsList")},_setup:function O(){this._setMaxHeight()},_setMaxHeight:function D(){this.$el.css("maxHeight",this.$el.height())},_setInitialState:function x(){this.resetTypeaheadField(),this.showContactsList();var t=this._getContactsList();if(0===t.numContacts()){var e=this._getTypeaheadField();e.replacePlaceholderText(h._("Enter email"))}},startPreventingScroll:function L(){this.startPreventScroll(this.$(".ConversationsList").last(),this.$(".List").last())},onItemSelected:function k(t){var e=t.data.item,i=e.attributes;i.type||(i.type="user_share_suggestion"),this._onContactSelected(i)},reset:function U(){this.render()},onListItemClick:function M(t){var e=t.target;this._sendToUsers(e.getUserIds(),e.getEmails()),this.triggerEvent(s.EVENT_DISMISS,null,!0)},_getMessageEl:function F(){return this.$(".message")},getMessageValue:function $(){return this._getMessageEl().val().trim()},clearMessageValue:function H(){this._getMessageEl().val("")},_sendToUsers:function V(t,e){if(e||(e=[]),t.length+e.length!==0){var i={text:this.getMessageValue(),object_type:this._OBJECT_ID_NAME,object_id:this.options.object_id};l.sendMessageToUsers(t,e,i).then(function(t){this.clearMessageValue(),this.resetTypeaheadField();var e=t.resource_response.data;l.logContextEvent(s.GEN.EventType.CONVERSATION_MESSAGE_SEND,e.id,this.options.object_id,this.$el)}.bind(this))}},resetTypeaheadField:function G(){var t=this._getTypeaheadField();t.reset(),t.clear()},onContactSelected:function W(t){var e=t.data;this._onContactSelected(e)},_onContactSelected:function K(t){var e=n.clone(t);if(this.isGroupBoardCreation){var i=this.selectedContacts.findIndex(function(t){return t.id===e.id}),s=0>i;e.is_selected=s,s?this.selectedContacts.push(e):this.selectedContacts.splice(i,1);var o=this._getContactsList();o.updateContactSelection(this.selectedContacts);var a=this._getTypeaheadField();return a.updateContactSelection(this.selectedContacts),void this.resetTypeaheadField()}var r=this.getChildByModuleName("MessageDraft");r.options.selected_user=e,r.options.object_id=this.options.object_id,r.render(),this.showMessageDraftPanel()},onContactsImported:function j(){var t=this._getContactsList();t.render()},onDismiss:function Y(t){this.triggerEvent(s.EVENT_DISMISS,null,!0)}});c.prototype.className="SendObjectBase",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(152);i(155),i(116);var r=o.extend({events:{"click .cancel":"onCancelSelected"},onCreated:function l(){this.childListen(n.EVENT_BUTTON_CLICK,this.onButtonClick)},onContentReady:function h(){this.sendButton=this.getChildById("sendButton")},onButtonClick:function d(t){t.currentTarget===this.sendButton&&this.onSendMessage()},onCancelSelected:function c(t){this.triggerEvent(n.EVENT_HIDE_MESSAGE_DRAFT_PANEL,null,!0)},onSendMessage:function u(){var t=this.$(".messageField").val().trim(),e=this.options.selected_user;e.username?this._sendToUsers([e.id],[],t):this._sendToUsers([],[e.id],t)},_sendToUsers:function p(t,e,i){if(e||(e=[]),t.length+e.length!==0){var s={text:i,object_type:this.options.object_type,object_id:this.options.object_id};a.sendMessageToUsers(t,e,s).then(function(t){this.triggerEvent(n.EVENT_MESSAGE_SENT,null,!0),this.triggerEvent(n.EVENT_DISMISS,null,!0)}.bind(this))}}});r.prototype.className="MessageDraft",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(483),r=i(47),l=i(46),h=i(83),d=o.extend({onContentReady:function c(){this.listen(this.getChildById("facebook"),n.EVENT_BUTTON_CLICK,this.openShareDialog),this.listen(this.getChildById("twitter"),n.EVENT_BUTTON_CLICK,this.openShareDialog),this.listen(this.getChildById("fbMessenger"),n.EVENT_BUTTON_CLICK,this.openShareDialog),this.listen(this.getChildById("link"),n.EVENT_BUTTON_CLICK,this.openShareDialog),this.listen(this.getChildById("cancelLink"),n.EVENT_BUTTON_CLICK,this.onCancelLinkDialog)},openShareDialog:function u(t){if(l.isWriteBanned())h.showWriteBanned(this);else{var e=t.target.id;"facebook"===e?this.openFacebookDialog():"twitter"===e?this.openTwitterDialog():"fbMessenger"===e?this.openFbMessengerDialog():"link"===e&&this.openLinkDialog()}return!1},openFacebookDialog:function p(){var t={invite_channel:n.GEN.InviteChannel.FACEBOOK,object_type:this.options.object_type,object_id:this.options.object_id,description:this.options.object_description,path:this.options.object_url,picture:this.options.object_image_url};r.ensureLoggedIn(function(){a.shareFacebookInvite(t)},l)},openTwitterDialog:function _(){var t={invite_channel:n.GEN.InviteChannel.TWITTER,object_type:this.options.object_type,object_id:this.options.object_id,description:this.options.object_description};a.shareTwitterInvite(t)},openFbMessengerDialog:function g(){var t={invite_channel:n.GEN.InviteChannel.FACEBOOK_MESSENGER,object_type:this.options.object_type,object_id:this.options.object_id,description:this.options.object_description,path:this.options.object_url,picture:this.options.object_image_url};r.ensureLoggedIn(function(){a.shareFbMessengerInvite(t)},l)},openLinkDialog:function m(){var t={invite_channel:n.GEN.InviteChannel.COPY_LINK,object_type:this.options.object_type,object_id:this.options.object_id};a.createAndLogShareInvite(t).then(function(t){var e=this.getChildById("input"),i=t.invite_url;i&&e.setValue(i)}.bind(this)),this.$(".shareOptions").fadeOut(400,function(){this.$(".linkWrapper").fadeIn()}.bind(this)),this.$(".linkField").select()},onCancelLinkDialog:function f(t){this.$(".linkWrapper").fadeOut(400,function(){this.$(".shareOptions").fadeIn()}.bind(this))}});d.prototype.className="SharePinBar",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(134),o=i(484),a=i(8),r={ObjectTypeToInviteObject:{pin:n.GEN.InviteObject.PIN,board:n.GEN.InviteObject.BOARD,pinner:n.GEN.InviteObject.PINNER},_convertToInviteObject:function l(t){return this.ObjectTypeToInviteObject[t]||n.GEN.InviteObject.NONE},_createShareInvite:function h(t){var e=this._convertToInviteObject(t.object_type),i=t.invite_channel,s=a.create("CreateExternalInviteResource",{invite_type:{invite_category:n.GEN.InviteCategory.MESSAGE,invite_object:e,invite_channel:i},object_id:t.object_id});return s.callCreate()},_logShareInvite:function d(t,e,i,s){var o=a.create("SentExternalInviteCallbackResource",{invite_type:{invite_category:n.GEN.InviteCategory.MESSAGE,invite_object:t,invite_channel:e},invite_code:i,object_id:s});return o.callCreate()},createAndLogShareInvite:function c(t){var e=this._convertToInviteObject(t.object_type),i=t.invite_channel;return r._createShareInvite(t).then(function(n){var s=n.resource_response.data;return r._logShareInvite(e,i,s.invite_code,t.object_id),Promise.resolve(s)},function(t){return Promise.reject(t)})},shareFacebookInvite:function u(t){
var e=this._convertToInviteObject(t.object_type),i=t.invite_channel;return r._createShareInvite(t).then(function(n){var o=n.resource_response.data,a=o.invite_url,l=o.invite_code;return a&&s.open({type:"feed",object_type:t.object_type,object_id:t.object_id,description:t.description,path:a,picture:t.picture}),r._logShareInvite(e,i,l,t.object_id),Promise.resolve(o)},function(t){return Promise.reject(t)})},shareTwitterInvite:function p(t){var e=this._convertToInviteObject(t.object_type),i=t.invite_channel;return r._createShareInvite(t).then(function(n){var s=n.resource_response.data,a=s.invite_url,l=s.invite_code;return a&&o.openDialog({tweet_path:a,tweet_text:t.description}),r._logShareInvite(e,i,l,t.object_id),Promise.resolve(s)},function(t){return Promise.reject(t)})},shareFbMessengerInvite:function _(t){var e=this._convertToInviteObject(t.object_type),i=t.invite_channel;return r._createShareInvite(t).then(function(n){var o=n.resource_response.data,a=o.invite_url,l=o.invite_code;return a&&s.open({type:"send",object_type:t.object_type,object_id:t.object_id,description:t.description,path:a,picture:t.picture,callback:function h(n){n&&n.success&&r._logShareInvite(e,i,l,t.object_id)}}),Promise.resolve(o)},function(t){return Promise.reject(t)})}};t.exports=r},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(29),a=i(31),r=i(323),l={DIALOG_WIDTH:550,DIALOG_HEIGHT:420,openDialog:function h(t){var e=t.ga_category||"share_twitter";o.trackEvent(e,s.GA_ACTION_CLICK);var i=l._getWindowUrl(t.tweet_path,t.tweet_text);r.open(i,l.DIALOG_WIDTH,l.DIALOG_HEIGHT)},_getWindowUrl:function d(t,e){var i="https://twitter.com/intent/tweet?via=pinterest",s={};return t&&(s.url=encodeURIComponent(a.absolutify(t))),e&&(s.text=encodeURIComponent(e)),n.reduce(s,function(t,e,i){return t+"&"+i+"="+e},i)}};t.exports=l},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(227),r=i(46);i(486);var l=o.extend({events:{"click .backNav":"onBackNavSelected"},onCreated:function h(){this.childListen(n.EVENT_SOCIAL_NETWORK_CONNECTION,this._onSocialNetworkConnect),this.childListen(n.EVENT_CONTACTS_IMPORTED,this._handleFriendImportCompleted),this.childListen(n.EVENT_DISMISS,this.onDismiss)},onBackNavSelected:function d(t){this.triggerEvent(n.EVENT_HIDE_SOCIAL_CONNECT_PANEL,t,!0)},_onSocialNetworkConnect:function c(t){this.showLoading(!0);var e=t.data.network,i=a.instance(),n={username:r.attributes.username},s={resourceOptions:n};i.pollForFriends(e,s)},_handleFriendImportCompleted:function u(t){this.render(),this.hideLoading(),this.triggerEvent(n.EVENT_HIDE_SOCIAL_CONNECT_PANEL,t,!0),this.triggerEvent(n.EVENT_CONTACTS_IMPORTED,t,!0)},onDismiss:function p(t){t.stopPropagation()}});l.prototype.className="SocialConnectPanel",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(227),r=o.extend({events:{click:"onClick"},onCreated:function l(){this.network=this.options.network,this.shouldShowLoading=this.options.show_loading;var t={};t[n.PUBSUB_TOPIC_FRIEND_IMPORT_COMPLETED]=this.handleFriendImportCompleted,this.pubsubSubscribe(n.PUBSUB_CHANNEL_SITE,t)},onClick:function h(){var t=!0,e={success:function(){this.shouldShowLoading&&this.showLoading(!0),this.triggerEvent(n.EVENT_SOCIAL_NETWORK_CONNECTION,{network:this.network},!0)}.bind(this)},i=a.instance();i.handleConnect(this.network,t,e)},handleFriendImportCompleted:function d(t,e,i){if(i.network===this.network){var s={network:this.network,is_success:!i.error};this.triggerEvent(n.EVENT_CONTACTS_IMPORTED,s,!0),i.error||this.triggerEvent(n.EVENT_DISMISS,null,!0)}}});r.prototype.className="SocialNetworkConnectButton",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(480),s=i(19),o=n.extend({_OBJECT_ID_NAME:"pin"});o.prototype.className="SendPin",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(480),s=i(19),o=n.extend({_OBJECT_ID_NAME:"user"});o.prototype.className="SendPinner",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({});o.prototype.className="AppSourceFeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(323);i(491);var a=n.extend({events:{},onContentReady:function r(){this.resizeWindowToFit()},onChildRemoved:function l(t){this.children.length?this.resizeWindowToFit():window.close()},resizeWindowToFit:function h(){o.shrinkWrap()}});a.prototype.className="OAuthDialog",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(115),a=i(492);i(116);var r=a.extend({onContentReady:function l(){this.tryRedirect(this.data),this.form=new o(this.$("form"),{}),this.listen(this.form,n.EVENT_SUBMIT_VALIDATED,this.authorizeConsumer),this.childListen(n.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function h(t){return"cancelButton"===t.target.id?this.cancelAuthorization():void 0},authorizeConsumer:function d(){var t=this.getChildById("submitButton");t.showLoading(),this.makeAuthorizationDecision(!0,t)},cancelAuthorization:function c(){var t=this.getChildById("cancelButton");t.showLoading(),this.makeAuthorizationDecision(!1,t)}});r.prototype.className="OAuthAuthorizationPage",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(115),r=i(50),l=i(8),h=i(34),d=i(46),c=i(27),u=i(31),p=i(104),_=2e3,g=r.extend({getOAuthResource:function m(t){var e=n.extend(this.resource.copyOptions(!0),t);return l.create("OAuthAuthorizationResource",e)},makeAuthorizationDecision:function f(t,e,i){var n=this.getOAuthResource({authorized:t});n.callCreate().then(function(t){this.tryRedirect(t.resource_response.data,i)}.bind(this)).fin(function(){e&&e.hideLoading()})},tryRedirect:function C(t,e){if(t.redirect){var i=t.redirect_uri,n={};t.access_token?(i+="#",n={access_token:t.access_token,expires_at:t.expires_at,token_type:t.token_type}):t.code&&(i+="?",n={code:t.code}),t.state&&(n.state=t.state),i+=u.getQueryStringFromObject(n),e?(this.showRedirectScreen(),h.setTimeout(function(){c.changeWindowLocation(i)},_)):c.changeWindowLocation(i)}},onContentReady:function E(){this.setupForm(),this.$("form input").first().focus()},setupForm:function v(){if(0!==this.$(".standardForm").length){var t={username_or_email:[p.Required(),p.Email()],password:[p.Required()]};this.loginForm=new a(this.$("form"),t),this.loginFormListener=this.listen(this.loginForm,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)}},onSubmitValidated:function I(t){t.errors&&t.errors.length||d.login(this.loginForm.getData()).then(function(){this.authorizeApp()}.bind(this),function(t){if(this.$(".loginError").html(t.message).show(),t.api_error_code===s.AUTO_PASSWORD_RESET_ERROR_CODE){var e=c.getResetPasswordOneClickUrl({username_or_email:this.loginForm.email});this.navigate(e)}}.bind(this))},authorizeApp:function T(){var t=this.getChildById("authorizeButton");t.showLoading(),this.makeAuthorizationDecision(!0,t,!0)},onAuthorizeButtonClicked:function N(t){this.loginForm?this.loginForm.onSubmit(t):this.authorizeApp()},showRedirectScreen:function S(){this.$(".body").hide(),this.$(".loading").show()}});g.prototype.className="OAuthPageBase",t.exports=o.register(g)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="OAuthErrorPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(492),s=i(19),o=i(31);i(116),i(171);var a=n.extend({events:{"click .authorizeApp":"onAuthorizeButtonClicked","click .joinButton":"onJoinButtonClicked"},onJoinButtonClicked:function r(){this.navigate("/join/register/email/?next="+encodeURIComponent(o.getCurrentUrl()))}});a.prototype.className="OAuthPage",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(29),r=i(8),l=o.extend({events:{},onContentReady:function h(){var t={username:this.options.username,username_and_slug:this.options.username_and_slug},e="UserAutoFollowResource",i="/"+this.options.username+"/",s="user_auto_follow";this.options.username_and_slug&&(e="BoardAutoFollowResource",i="/"+this.options.username_and_slug+"/",s="board_auto_follow");var o=r.create(e,t);o.callCreate().then(function(){a.trackEvent(s,n.GA_ACTION_SUCCESS)},function(){a.trackEvent(s,n.GA_ACTION_ERROR)}).fin(function(){this.navigate(i+"?auto_follow=true")}.bind(this))}});l.prototype.className="AutoFollow",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(322),s=i(19);i(325);var o=n.extend({});o.prototype.className="BasicSignupModule",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="EmailVerificationError",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(51),l=i(57),h=i(197),d=i(50),c=i(35),u=i(29),p=i(135),_=i(41),g=i(23),m=i(72),f=i(8),C=i(46),E=i(27);i(116),i(499),i(166);var v=d.extend({events:{click:"onClickOutsideDestroyModal"},CssClassName:{PINIT_BUTTON_SUCCESS:"success"},onClickOutsideDestroyModal:function I(t){var e=s(t.target).closest(".pinCreateContainer").length>0;!e&&this.modal&&this.modal.animateOutAndDestroy()},onCreated:function T(){this.childListen(o.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(o.EVENT_BOARD_CREATED,this.createPin),this.childListen(o.EVENT_CONTENT_CHANGED,this._toggleSubmitButtonEnabled),this.placedExperience=l.instance.getPlacedExperience(o.GEN.Placement.WEB_REPIN_DIALOG_TAKEOVER),this.placedExperience&&l.instance.viewPlacedExperienceId(this.placedExperience.id),this.options.state_isSuccess=!1,this.options.state_seoBannerText=""},updateDom:function N(){var t=this.$(".seoNuxBannerText");t.toggleClass(this.CssClassName.PINIT_BUTTON_SUCCESS,!!this.options.state_isSuccess),t.text(this.options.state_seoBannerText)},setImage:function S(t){var e=this.getChildById("pin");e.setPinImages(t),e.renderExistingData()},onButtonClick:function b(t){var e=t.target;e.isCancelButton()?(this._logCustomContextEvent(o.GEN.EventType.WEB_PIN_CREATE_CLOSE_MODAL_BEFORE_PINNING,o.GEN.ElementType.WEB_PIN_CREATE_BOARD_FILTER,o.GEN.ComponentType.MODAL_REPIN,{}),this.destroy()):"submitButton"===e.id&&this.getFirstBoardCreate()._getNameInputText()&&(e.showLoading(),this.getFirstBoardCreate().createFromInputNameAndSubmit())},getPinResource:function y(){var t="PinResource",e={},i,n=p.get(),s=n&&n.getAnimatedModule();s&&(i=s);var o=this.getChildById("pin");o&&(i=o);var a=i.data,r=i.getDescriptionText();this.isRepin()&&(e.pin_id=a.id,t="RepinResource");var l=this.options.method;l&&(e.method=l),e.description=r;var h=a.link;if(e.link=h,e.is_video=a.is_video,e.guid=this.options.guid,!this.isRepin()){var d=a.image_url;d=this.prependSchemeIfNeeded(d,h),e.image_url=d}return f.create(t,e)},prependSchemeIfNeeded:function P(t,e){if(!e)return t;var i=new RegExp(/http(s?):/);if(!i.test(t)){var n=i.exec(e);if(n&&n.length){var s=n[0];t=s+t}}return t},showPinItSuccess:function B(){return this._applySuccessTextToSeoBanner(),E.delay(2500)},_applySuccessTextToSeoBanner:function A(){var t={state_isSuccess:!0};this.placedExperience&&this.placedExperience.display_data&&this.placedExperience.display_data.create_board_text&&(t.state_seoBannerText=this.placedExperience.display_data.create_board_text),this.updateOptionsAndDom(t)},createPin:function R(t){var e=t.data,i=this.getPinResource();i.options.board_id=e,i.callCreate({showError:!1}).then(function(t){this._onPinCreateSuccess(t)}.bind(this),function(t){u.trackEvent(this.GACategory,o.GA_ACTION_ERROR),c.showError(t.message)}.bind(this))},_onPinCreateSuccess:function w(t){u.trackEvent(this.GACategory,o.GA_ACTION_SUCCESS);var e=f.create("BoardPickerBoardsResource",{allow_stale:!0,field_set_key:"board_picker",filter:"all",shortlist_length:3});m.instance.callGet(e),l.instance.refreshPlacedExperiences();var i=t.resource_response.data,n=new Promise(function(t,e){this.triggerCommonPinCreateEvents(i),t(void 0)}.bind(this)),s=[this.showPinItSuccess(),l.instance.completePlacedExperienceId(this.placedExperience.id),n];Promise.all(s).fin(function(){var t=new _;t.evt=new r("",null,{forceRefresh:1}),h.navigate("/",t)})},isRepin:function O(){return!(!this.data||!this.data.id)},onContentReady:function D(){this.$pinCreateContainer=this.getContent().find(".pinCreateContainer"),this.submitButton=this.getChildById("submitButton"),n.defer(this.lockHeight.bind(this))},_toggleSubmitButtonEnabled:function x(){this.submitButton.setEnabled(!!this.getFirstBoardCreate()._getNameInputText())},lockHeight:function L(){var t=this.getContent().find(".rightContainer"),e=this.getContent().find(".SelectList.firstPinCreate");if(t&&e){var i=t.height()-Math.abs(t.position().top-e.position().top);e.height(i)}var n=this.$(".seoNuxBannerText"),s=this.$(".bottomSpaceAdjuster");if(s.height(n.outerHeight()),this.$pinCreateContainer){var o=this.$pinCreateContainer.height()||this.$el.height();this.$pinCreateContainer.height(o)}var a=this.$(".leftContainer");if(a){var r=this.$pinCreateContainer.height()||this.$el.height();a.height(r)}},getFirstBoardCreate:function k(){return this.getChildById("firstBoardCreate")},focus:function U(){this.getFirstBoardCreate().focus()},triggerCommonPinCreateEvents:function M(t){this.triggerEvent(o.EVENT_PIN_CREATE,t,!1),g.instance.publish(o.PUBSUB_CHANNEL_CURRENT_USER,o.PUBSUB_TOPIC_PIN_CREATED,t),g.instance.publish(t.board.id,o.PUBSUB_TOPIC_PIN_CREATED,{pin:t}),g.instance.publish(C.id,o.PUBSUB_TOPIC_PIN_CREATED),this.isRepin()&&g.instance.publish(this.data.id,o.PUBSUB_TOPIC_PIN_REPINNED,t)}});v.prototype.className="FirstPinCreate",t.exports=a.register(v)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(239),r=i(23),l=i(8),h=a.extend({onContentReady:function d(){a.prototype.onContentReady.call(this),this.model&&this.model.on("change",function(){this.renderExistingData()}.bind(this))},_onChildItemClick:function c(t){var e=t.target,i=t.data;e&&"list"===e.id&&i&&i.name&&(this.$("input.name").val(i.name),this._onNameTextChange())},getBoardResource:function u(t){var e=l.create("BoardResource",{name:t,return_existing:!0});return e},_create:function p(t){if(t){var e=this.getBoardResource(t);return e.callCreate().then(function(e){var i=e.resource_response.data,o=n.pluck(this.data,"title"),a=o.indexOf(t),l;if(a>-1){var h=this.data[a].metadata;l={board_title:t,preselected_title:!0,index:a,board_title_metadata:h,board_title_list:o}}else l={board_title:t,preselected_title:!1,board_title_list:o};this._logCustomContextEvent(s.GEN.EventType.CLICK,s.GEN.ElementType.CREATE_BOARD_BUTTON,s.GEN.ComponentType.FPE_CREATE_FIRST_BOARD_MODAL,l);var d=i.id;return this.triggerEvent(s.EVENT_BOARD_CREATED,d,!0),r.instance.publish(s.PUBSUB_CHANNEL_CURRENT_USER,s.PUBSUB_TOPIC_BOARD_CREATED,i),i}.bind(this))}return Promise.resolve({name:t})},_onNameTextChange:function _(){this.triggerEvent(s.EVENT_CONTENT_CHANGED,{name:this._getNameInputText()},!0)},createFromInputNameAndSubmit:function g(){return this._createFromInputNameAndSubmit()}});h.prototype.className="FirstBoardCreate",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="InterstitialMiniGrid",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="NewBoardPreview",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(28),l=a.extend({onContentReady:function h(){this.childListen(s.EVENT_NEXT,this._handleNext);var t={};t[s.PUBSUB_TOPIC_WINDOW_SCROLL_CHANGE]=this.handleScroll.bind(this),this.pubsubSubscribe(s.PUBSUB_CHANNEL_SITE,t)},setTutorialManager:function d(t){this._tutorialManager=t},_handleNext:function c(){this._tutorialManager._next()},handleScroll:function u(){var t=r.instance.getChildById("mainModule").toString();this.options.trigger_next_when_visible&&this._inView()&&"HomePage"===t&&(delete this.options.trigger_next_when_visible,this._handleNext())},_inView:function p(){if(this.$el.length){var t=n(window),e=t.scrollTop(),i=this.$el.offset().top;return i<=e+t.height()/3}return!1}});l.prototype.className="NuxHomefeedTruncateContainer",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50);i(151),i(347),i(166);var l="actions",h="content",d=r.extend({onContentReady:function c(){var t=this.getChildById(h);if(t&&n.defer(t.addTutorials.bind(t)),this.options.show_repin){var e={};e[o.PUBSUB_TOPIC_APPBASE_CONTENT_READY]=this.showRepinModal,this.pubsubSubscribe(o.PUBSUB_CHANNEL_MAIN_MODULE,e)}this._updateSticky()},onAddedToDom:function u(){this._updateSticky()},showRepinModal:function p(){this.options.show_repin&&this._actionBar&&(this._actionBar.showRepinModal(),delete this.options.show_repin)},_updateSticky:function _(){this._actionBar=this.getChildById(l),this.parent&&this.inDom&&this._actionBar&&this._actionBar.updateSticky({$boundTo:this.$(".pinActionBarStickyContainer"),$scrollable:this.getScrollableElement(),headerHeight:s(".Header").height()})}});d.prototype.className="PinNextToGridCloseup",t.exports=a.register(d)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(27);i(151),i(128),i(150);var a=n.extend({events:{},onContentReady:function r(){o.trackRegisterAction("pin_picks_visit")}});a.prototype.className="PinPicksDetail",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(21),s=i(11),o=i(19),a=i(50),r=i(27);i(151),i(341),i(506),i(296),i(326),i(166);var l=a.extend({events:{"click .continueSignupButton":"onContinueSignup"},CssClassName:{INITIAL_SIGNUP_STEP:"initialSignupStep",COMPLETE_SIGNUP_STEP:"completeSignupStep"},onContentReady:function h(){if(r.trackRegisterAction("sent_pin_landing"),["enabled_discover_open","enabled_save_open"].indexOf(this.extraData.sent_pin_experiment)>-1){var t=n.get(s.COOKIE_SEND_PIN_UNAUTH_BROWSING_ALLOWANCE);null===t&&n.set(s.COOKIE_SEND_PIN_UNAUTH_BROWSING_ALLOWANCE,5,12)}else n.set(s.COOKIE_SEND_PIN_UNAUTH_BROWSING_ALLOWANCE,0,12);this.childListen("toggleMultiStep",function(){this.$(".signupTitle").toggleClass(this.CssClassName.COMPLETE_SIGNUP_STEP)}),this.childListen(s.EVENT_GRID_CONTENT_READY,this.replaceBoardThumb),this.childListen(s.EVENT_ITEMS_REQUEST_SUCCESS,this.replaceBoardThumb);var e={};e[s.PUBSUB_TOPIC_SIGNUP_BUTTON_CLICKED]=this.onSignupButtonClicked,this.pubsubSubscribe(s.PUBSUB_CHANNEL_SITE,e)},replaceBoardThumb:function d(){if(this.$(".sentPinSave"))for(var t=this.$(".GridItems").children(),e=0;e<t.length;e++){var i=t[e].getElementsByClassName("boardThumbs")[0],n=i.getElementsByTagName("img")[0];n.setAttribute("src",this.data.images["60x60"].url)}},onContinueSignup:function c(){this.$(".sentPinTop").addClass(this.CssClassName.INITIAL_SIGNUP_STEP)},onSignupButtonClicked:function u(){this.$("input[name='email']").focus()}});l.prototype.className="SentPin",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="SentPinSender",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(50),o=i(19);i(116);var a=s.extend({onContentReady:function r(){this.childListen(n.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function l(){this.triggerEvent(n.EVENT_CHANGE,{type:this.options.tip_type},!0)}});a.prototype.className="UpsellTip",t.exports=o.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(126),a=i(34),r=i(31);i(236),i(509);var l=7e3,h=n.extend({CssClassName:{FOLLOWED:"followed",HIDDEN:"hidden"},onContentReady:function d(){this.followButton=this.getChildById("followButton"),this.followButton&&(this.listen(this.followButton,"toggleFollow",function(t){this.followButton.getState()?(this.$(".UserFollowPinsPreview").addClass(this.CssClassName.FOLLOWED),this.$(".userBoardFollowButton").addClass(this.CssClassName.HIDDEN),this.$(".postUnFollow").addClass(this.CssClassName.HIDDEN),this.$(".postFollow").removeClass(this.CssClassName.HIDDEN),a.setTimeout(function(){window.close()},l)):this.$(".postUnFollow").removeClass(this.CssClassName.HIDDEN)}),this._attemptAutoFollow());var t=this.$(".userBoardFakeHeader"),e=this.getChildByModuleName("UserFollowPinsPreview");if(t.length&&e){var i=t.height();e.setHeight(o.height-i)}},_getReferrer:function c(){return document.referrer},_attemptAutoFollow:function u(){var t=this.data.owner.is_partner,e=this.data.followed_by_me,i=this.data.owner.domain_url,n=this._getReferrer();t&&!e&&i&&n&&(i=r.absolutify(i,"http:",""),r.parse(n).hostname===r.parse(i).hostname&&this.followButton.toggleFollow())}});h.prototype.className="UserBoardFollow",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(30),a=i(126),r=i(19),l=s.extend({onContentReady:function h(){if(this.data){this.$el.height(a.height);var t=o.siteConst.PIN_WIDTH,e=o.siteConst.PIN_MARGIN,i=t+e,s=this._calculateNumColumns(t,e);this._pinSlotWrapper=this.$(".pinSlotWrapper"),this._pinSlotWrapper.width(s*i);for(var r=0;s>r;r++)this._pinSlotWrapper.append(n('<span class="pinSlot slot"></span>'));this._pinSlots=this._pinSlotWrapper.children();for(var l=0,h=0;h<this.data.length;h++)if(this.data[h].images){var d=document.createElement("IMG");d.src=this.data[h].images["236x"].url,this._pinSlots[l%s].appendChild(d),l+=1}this._positionSlots(t,e)}},setHeight:function d(t){this.$el.height(t)},_positionSlots:function c(t,e){for(var i=0,s=500,o=t+e,a=0;a<this._pinSlots.length;a++)n(this._pinSlots[a]).css("left",i),n(this._pinSlots[a]).transition({top:"30px",duration:s}),i+=o,s+=500},_calculateNumColumns:function u(t,e){var i=this.$el.width(),n=t+e;return Math.floor((i+1)/n)}});l.prototype.className="UserFollowPinsPreview",t.exports=r.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(57),a=i(50),r=i(27);i(116),i(130);var l=a.extend({events:{"click .leftArrowPadding":"shiftPanelLeft","click .rightArrowPadding":"shiftPanelRight","click .leftHalf":"shiftPanelLeft","click .rightHalf":"shiftPanelRight","click .leftFooter":"shiftPanelLeft","click .rightFooter":"shiftPanelRight","click .playStoreScreenshot":"openCompletionPanel","click .appStoreScreenshot":"openCompletionPanel","click .dismissModal":"dismissModal","click .continueToPhonePicker":"continueToPhonePicker"},onContentReady:function h(){this.options.placedExperienceId&&o.instance.completePlacedExperienceId(this.options.placedExperienceId),this.MIDDLE_PANEL="middle",this.LEFT_PANEL="left",this.RIGHT_PANEL="right",this.currentPanel=this.MIDDLE_PANEL,this.childListen(n.EVENT_BUTTON_CLICK,this.openCompletionPanel),this.childListen(n.EVENT_GPLUS_BUTTON_CLICKED,this.openCompletionPanel),r.trackRegisterAction("app_install_modal_opened")},shiftPanelLeft:function d(){var t;this.currentPanel===this.MIDDLE_PANEL?(this.currentPanel=this.LEFT_PANEL,t="150%",this.$(".leftArrow").fadeOut()):this.currentPanel===this.RIGHT_PANEL&&(this.currentPanel=this.MIDDLE_PANEL,t="50%",this.$(".rightArrow").fadeIn()),t&&(this.$(".container").animate({left:t},{queue:!1}),r.trackRegisterAction("app_install_modal_ios_selected"))},shiftPanelRight:function c(){var t;this.currentPanel===this.LEFT_PANEL?(this.currentPanel=this.MIDDLE_PANEL,t="50%",this.$(".leftArrow").fadeIn()):this.currentPanel===this.MIDDLE_PANEL&&(this.currentPanel=this.RIGHT_PANEL,t="-50%",this.$(".rightArrow").fadeOut()),t&&(this.$(".container").animate({left:t},{queue:!1}),r.trackRegisterAction("app_install_modal_android_selected"))},openCompletionPanel:function u(t){"continueToPhonePicker"!==t.target.id&&setTimeout(function(){r.trackRegisterAction("app_install_modal_store_opened"),this.$(".completedPanel").fadeIn()}.bind(this),1e3)},dismissModal:function p(){r.trackRegisterAction("app_install_modal_experience_completed"),this.triggerEvent(n.EVENT_DISMISS,null,!1),this.destroy()},continueToPhonePicker:function _(){r.trackRegisterAction("continued_to_phone_picker"),this.$(".appUpsell").fadeOut(),this.$(".phonePicker").fadeIn()}});l.prototype.className="AppInstallModal",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(115),a=i(50),r=i(23),l=i(8),h=i(104);i(116);var d=a.extend({onAddedToDom:function c(){r.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NAG_STATE,!0)},onRemovedFromDom:function u(){r.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NAG_STATE,!0)},onContentReady:function p(){this.setupForm(),this.$("form input").first().focus()},setupForm:function _(){var t={phone_or_email:[h.PhoneNumber()]};this.form=new o(this.$("form"),t),this.formListener=this.listen(this.form,n.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.sendButton=this.getChildById("submit_button")},onSubmitValidated:function g(t){t.errors&&t.errors.length||this.installAppSms()},onFailure:function m(){this.sendButton.hideLoading()},onSuccess:function f(){this.$(".dialogInput").hide("fast"),this.$(".dialogSuccess").show("fast")},installAppSms:function C(){var t=this.form.getValue("phone_or_email"),e=l.create("SmsAppInstall",{number:t});this.sendButton.showLoading(),e.callCreate({showError:!1}).then(this.onSuccess.bind(this),this.onFailure.bind(this))}});d.prototype.className="LogoutAppUpsell",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="MobileLandingPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(327),s=i(19),o=n.extend({events:{click:"facebookConnect"}});o.prototype.className="FacebookConnectLink",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(129);var o=n.extend({});o.prototype.className="FBOTrendingImageWeb",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="BoardSuggestionSummary",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(151),l=i(50),h=i(126),d=i(27);i(517),i(520);var c="fastFollowContent",u="fastFollowHeader",p="categoryBoardsGrid",_="wholeBoardMask",g=355,m=102,f=56,C=5,E={CATEGORY:0,SEARCH_TERM:1},v=l.extend({_boardsFollowed:[],_modalDisplayed:!1,_cachedGrids:{},_currentAction:E.CATEGORY,getOwnedScrollables:function I(){return this.$(".fastFollowGridContainer")},_getBoardIdFromEvent:function T(t){var e=t.data||{};return e.board_id},_onBoardFollow:function N(t){var e=this._getBoardIdFromEvent(t),i=s.inArray(e,this._boardsFollowed);e&&-1===i&&(this._boardsFollowed.push(e),this._updateFollowedBoards(1),this._updateFollowedBoardMask(t,!0))},_onBoardUnfollow:function S(t){var e=this._getBoardIdFromEvent(t);if(e){var i=s.inArray(e,this._boardsFollowed);-1!==i&&(this._boardsFollowed.splice(i,1),this._updateFollowedBoards(-1)),this._updateFollowedBoardMask(t,!1),this._boardsFollowed.length===C-1&&this._setProgressCompletion(!1)}},_updateFollowedBoardMask:function b(t,e){var i=this._getBoardIdFromEvent(t);if(i){var n=this.$("."+_+".mask"+i);e?n.show():n.hide()}},_onCategoryUpdate:function y(t){var e=t.data,i={name:"CategoryBoardsResource",options:{category:e}};this._currentAction=E.CATEGORY,this._updateGridFromResource(i,e,e)},_onSearchQueryUpdate:function P(t){var e=t.data,i={name:"SearchResource",options:{query:e,scope:"boards",search_context:"fast_follow"}};this._currentAction=E.SEARCH_TERM,this._updateGridFromResource(i,null,e)},_updateGridFromResource:function B(t,e,i){this._currentGrid||(this._currentGrid=this.getChildById(p),this._cachedGrids[this._currentGrid.resource.options.category]=this._currentGrid),this._currentGrid.remove();var n=this._cachedGrids[e];n||(n=new r({id:p,options:{centered:!1,layout:"fixed_height",show_grid_footer:!1,scrollable:!0,item_options:{allow_click_thru:!1,board_click_mask:!0}},resource:t}),n.render(),e&&(this._cachedGrids[e]=n));var s=this.$(".fastFollowGridContainer");this.$("."+c).scrollTop(0),this.insertChild(n,s),this._currentGrid=n},_updateBoardHeading:function A(t){this.$(".heading").hide(),this._currentAction===E.CATEGORY?(t=this.$(".followPageSidebarCategory[data-category="+t+"]"),t=t?t.text():null,this.$(".categoryHeading").show()):this.$(".searchHeading").show();var e=this.$(".categoryOrQuery");e&&e.length&&t&&e.text(t)},_onProgressCompletion:function R(){this._userRegisterTrackActionOrientationComplete(),this._setProgressCompletion(!0)},_onFastFollowCompletion:function w(t){var e=t.target;e&&"tryOutYourFeedButton"===e.id&&(this.hide(),this.navigate("/",null,o.GEN.ForceRefreshType.PAGE))},_userRegisterTrackActionOrientationComplete:function O(){d.trackRegisterAction("orientation_complete")},_setProgressCompletion:function D(t){var e=this.getChildById(u);return e?(e.options.progress_completed=t,t?e.render():(e.options.num_boards_followed=this._boardsFollowed.length,e.render())):Promise.resolve(void 0)},_updateFollowedBoards:function x(t){if(!this._modalDisplayed){var e=this.getChildById(u);e&&e.stepProgress(t)}},onContentReady:function L(){n.each(this.extraData.followed_boards,function(t){this._boardsFollowed.push(t.id)}.bind(this)),this.childListen(o.EVENT_FAST_FOLLOW_CATEGORY_SELECTED,this._onCategoryUpdate),this.childListen(o.EVENT_FAST_FOLLOW_SEARCH_QUERY_UPDATED,this._onSearchQueryUpdate),this.childListen(o.EVENT_PROGRESS_COMPLETED,this._onProgressCompletion),this.childListen(o.EVENT_BOARD_FOLLOW,this._onBoardFollow,this),this.childListen(o.EVENT_BOARD_UNFOLLOW,this._onBoardUnfollow,this),this.childListen(o.EVENT_BUTTON_CLICK,this._onFastFollowCompletion),this.listen(h,o.EVENT_RESIZE,this.position),this.position()},position:function k(){if(this.inDom&&this.contentReady){this.fastFollowHeaderHeight||(this.fastFollowHeaderHeight=this.$(".FastFollowHeader").outerHeight(!0));var t=m+f,e=h.height,i=e-t-this.fastFollowHeaderHeight,n=Math.max(g,i);this.$(".fastFollowContent").height(n)}},onDestroyed:function U(){n.each(n.values(this._cachedGrids),function(t){t.destroy()})}});v.prototype.className="FastFollow",t.exports=a.register(v)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(116),i(518);var o="followPageProgress",a=n.extend({stepProgress:function r(t){var e=this.getChildById(o);e&&e.moveStep(t)}});a.prototype.className="FastFollowHeader",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(23);i(519);var h=r.extend({events:{"click li":"onStepClick"},CssClassName:{IS_ACTIVE:"active"},moveStep:function d(t){this.setStep(this.options.current_step+t)},setStep:function c(t){0>t||t>this.options.steps||(this.options.current_step=t,this._localRender(),t===this.options.steps&&this.triggerEvent(o.EVENT_PROGRESS_COMPLETED,null,!0))},setMiniStepProgress:function u(t,e){var i=this.getChildrenByModuleName("ProgressMinistep"),s=0;n.each(i,function(i){i.options.ministep_type===t&&(e>s?(i.setActive(),s++):i.setInactive())})},updateStepWidths:function p(){var t=this.$el.width(),e=this.$el.find("li").length;if(e>1){var i=Math.floor(t/e);i&&this.$el.find("li").width(i+"px")}},_localRender:function _(){var t=this.$el.children("li"),e=parseInt(this.options.current_step,10),i=this.options.highlight_current_only;s.each(t,function(t,n){s(n).toggleClass(this.CssClassName.IS_ACTIVE,i&&e===t+1||!i&&e>=t+1)}.bind(this))},onStepClick:function g(t){if(this.options.allow_jump_to_any_step){var e=s(t.target).data("step-id");String(e)!==String(this.options.current_step)&&(this.setStep(e),l.instance.publish(o.PUBSUB_CHANNEL_TUTORIAL,o.PUBSUB_TOPIC_TUTORIAL_GO_TO_STEP,Number(e)))}}});h.prototype.className="Progress",t.exports=a.register(h)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({CssClassName:{IS_ACTIVE:"active"},setActive:function a(){var t=this.$el.children("li");t.hasClass(this.CssClassName.IS_ACTIVE)||t.addClass(this.CssClassName.IS_ACTIVE)},setInactive:function r(){var t=this.$el.children("li");t.hasClass(this.CssClassName.IS_ACTIVE)&&t.removeClass(this.CssClassName.IS_ACTIVE)}});o.prototype.className="ProgressMinistep",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50);i(116);var r=a.extend({events:{"click .followPageSidebarCategory":"onCategoryClick"},CssClassName:{EXPAND:"expand",SELECTED:"selected"},onCreated:function l(){var t={};t[s.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED]=this.onSearchQueryUpdated,this.pubsubSubscribe(s.PUBSUB_CHANNEL_SITE,t),this.childListen(s.EVENT_BUTTON_CLICK,this.toggleShowMoreCategories)},onCategoryClick:function h(t){
var e=n(t.currentTarget);if(e.length){var i=e.attr("data-category");i.length&&(this.highlightCategory(i),this.triggerEvent(s.EVENT_FAST_FOLLOW_CATEGORY_SELECTED,i,!0))}},onSearchQueryUpdated:function d(t,e,i){var n=i||"";this.unhighlightCategory(),this.triggerEvent(s.EVENT_FAST_FOLLOW_SEARCH_QUERY_UPDATED,n,!0)},unhighlightCategory:function c(){this.$("."+this.CssClassName.SELECTED).removeClass(this.CssClassName.SELECTED)},highlightCategory:function u(t){this.unhighlightCategory(),this.$("[data-category="+t+"]").addClass(this.CssClassName.SELECTED)},toggleShowMoreCategories:function p(t){return this.$el.toggleClass(this.CssClassName.EXPAND),!1}});r.prototype.className="FastFollowSidebar",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(57),r=i(50),l=i(133),h=i(227);i(116),i(151);var d=r.extend({onCreated:function c(){this.childListen(s.EVENT_BUTTON_CLICK,this.onButtonClick),a.instance.refreshPlacedExperiences()},onButtonClick:function u(t){var e=t.target,i=null;switch(e.id){case"facebookConnectButton":i=l.FACEBOOK;break;case"twitterConnectButton":i=l.TWITTER;break;default:return}this.startNetworkConnect(i)},getGrid:function p(){return this.getChildById("friendGrid")},startNetworkConnect:function _(t){var e;switch(t){case l.FACEBOOK:e=this.getChildById("facebookConnectButton");break;case l.TWITTER:e=this.getChildById("twitterConnectButton");break;default:return}e.showLoading();var i=h.instance(),o={success:function(){var o=n.isUndefined(this.options.exclude_following)?!0:this.options.exclude_following,a={username:this.options.username,exclude_following:o},r={success:function(i){e.hideLoading(),this.resource=i,this.render().then(function(){this.triggerEvent(s.EVENT_SOCIAL_NETWORK_CONNECTION,{network:t},!0)}.bind(this))}.bind(this),error:function(){e.hideLoading(),this.hideLoading(),this.render()}.bind(this),resourceOptions:a};i.pollForFriends(t,r)}.bind(this),error:function(){e.hideLoading(),this.hideLoading()}.bind(this)};i.handleConnect(t,!0,o)}});d.prototype.className="FindFriendsContent",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(13),a=i(46),r=n.extend({events:{click:"onClick"},onClick:function l(t){a.isLimitedLogin()&&(t.stopPropagation(),t.preventDefault(),o.showLogin(this))}});r.prototype.className="FindFriendsRep",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(80),r=i(81);i(524),i(525),i(529);var l=o.extend({onCreated:function h(){this.scrollListener=this.listen(this.getScrollableElement(),n.EVENT_SCROLL,this._onScroll),this.childListen(n.EVENT_ITEM_SELECTED,this._onAnchorLinkSelected),this.childListen(n.EVENT_CONTACTS_IMPORTED,this._handleFriendImportCompleted)},onContentReady:function d(){this.$menu=this.$(".friendsMenu"),this.$menuFiller=this.$(".friendsMenuFiller"),this.$menuFiller.hide()},_calculateTopOffsets:function c(){this.initialMenuTop=this._getMenuTopPosition(),this.minimumMenuTop=this.$(".header").position().top},_getCurrentScrollTop:function u(){return this.getScrollableElement().scrollTop()},_getMenuTopPosition:function p(){var t=this.$menu.position();return t&&t.top?t.top:0},_onScroll:function _(){var t=this._getCurrentScrollTop();this.initialMenuTop||this._calculateTopOffsets();var e=this.initialMenuTop-t;e<this.minimumMenuTop?this.$menu.hasClass("fixed")||(this.$menu.addClass("fixed"),this.$menuFiller.show()):this.$menu.hasClass("fixed")&&(this.$menu.removeClass("fixed"),this.$menuFiller.hide())},_onAnchorLinkSelected:function g(t){var e=t.data.id;if(e){var i={event_type:n.GEN.EventType.ANCHOR_LINKS_VIEW,element:t.data.element_type},s=a.fromPlainObject(i);r.getInstance().addEvent(s)}},_handleFriendImportCompleted:function m(t){t.data.is_success&&this.getChildByModuleName("FriendBoardRecommendationTiles").render()}});l.prototype.className="FriendCenter",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(27),l=a.extend({events:{"click .links li":"_onLinkClick"},CssClassName:{LINK_SELECTED:"selected"},onCreated:function h(){this.initiallySelectedLinkIndex=this.options.selected_link_index||0,this.links=this.options.links||[],this.initialSectionTop=null,this.scrollListener=this.listen(this.getScrollableElement(),s.EVENT_SCROLL,this._onScroll),this.targetTop=null},onContentReady:function d(){this.linkElements=[],this.sectionElements=[],this._indexLinksAndSections(),this.options.state_selectedLinkElement=this.linkElements.length>0?this.linkElements[0]:null,this.jumpToInitialSection()},updateDom:function c(){this.$("."+this.CssClassName.LINK_SELECTED).removeClass(this.CssClassName.LINK_SELECTED),n(this.options.state_selectedLinkElement).addClass(this.CssClassName.LINK_SELECTED)},areSectionsAvailable:function u(){if(0===this.sectionElements.length)return!1;for(var t=0;t<this.sectionElements.length;t++)if(0===this.sectionElements[t].length)return!1;return!0},jumpToInitialSection:function p(){return this._indexLinksAndSections(),this.areSectionsAvailable()?void(this.initiallySelectedLinkIndex&&this.selectLinkAtIndex(this.initiallySelectedLinkIndex)||this.selectFirstAvailableLink()):void setTimeout(this.jumpToInitialSection.bind(this),100)},_indexLinksAndSections:function _(){this.linkElements=[],this.sectionElements=[];var t=this;if(this.$(".links li").each(function(e){var i=this,n=t.getSectionForLinkElement(i);t.linkElements.push(i),t.sectionElements.push(n)}),this.links.length>0){var e=this.initialSectionTop||0;this.initialSectionTop=this._getScrollTopPositionForLinkIndex(0)+e}},_onLinkClick:function g(t){this._selectLink(n(t.currentTarget),!0)},_getScrollTopPositionForLinkIndex:function m(t){var e=this.sectionElements[t];return this._getScrollTopPositionForSectionElement(e)},_getScrollTopPositionForSectionElement:function f(t){if(!t)return null;var e=t.position();if(!e)return null;var i=this.getIndexForSectionElement(t);if(-1===i)return null;var n=this.links[i].y_offset||0,s=e.top;return s-this.initialSectionTop+n},_getCurrentScrollTop:function C(){return this.getScrollableElement().scrollTop()},getSectionForLinkElement:function E(t){var e=n(t).attr("section");return n(e)},getSelectedLinkElement:function v(){return this.options.state_selectedLinkElement?n(this.options.state_selectedLinkElement):null},getIndexForSectionElement:function I(t){for(var e=0;e<this.sectionElements.length;e++)if(t.is(this.sectionElements[e]))return e;return-1},selectFirstAvailableLink:function T(){for(var t=0;t<this.linkElements.length;t++)if(this.isIndexAvailable(t))return void this.selectLinkAtIndex(t)},isIndexAvailable:function N(t){var e=this.sectionElements[t];return e&&e.height()>0},selectLinkAtIndex:function S(t){return this.isIndexAvailable(t)?(this._selectLink(this.linkElements[t],!0),!0):!1},_selectLink:function b(t,e){this.updateOptionsAndDom({state_selectedLinkElement:t});var i=this.getSectionForLinkElement(t),n=this.links[this.getIndexForSectionElement(i)];if(n){var o={id:n.id,element_type:n.log_element_type};this.triggerEvent(s.EVENT_ITEM_SELECTED,o,!0)}if(e){this.isScrolling=!0;var a=this._getScrollTopPositionForSectionElement(i);this.targetTop=a,r.scrollToTop({newScrollOffset:a,duration:s.SCROLL_TO_TOP_ANIMATION_TIME,callback:function(){this.isScrolling=!1}.bind(this)})}},_onScroll:function y(){null!==this.initialSectionTop&&this.sectionElements[0].parent()||this._indexLinksAndSections();var t=this._getCurrentScrollTop();if(!(0>t||this.isScrolling)){for(var e=null,i=null,o=0,a=0;a<this.links.length;a++)if(this.isIndexAvailable(a)){var r=this._getScrollTopPositionForLinkIndex(a),l=this.sectionElements[a];t>=r-s.SCROLL_MARGIN_OF_ERROR&&(!e||o<r-s.SCROLL_MARGIN_OF_ERROR)&&(e=l,i=this.linkElements[a],o=r)}i&&!n(this.options.state_selectedLinkElement).is(n(i))&&this._selectLink(i,!1)}}});l.prototype.className="AnchorLinks",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(62),r=i(23);i(526),i(527);var l=o.extend({onContentReady:function h(){this.childListen(n.EVENT_DISMISS,this.onDismiss),this.childListen(n.EVENT_BOARD_FOLLOW,this.onBoardFollow),this.data&&0!==this.data.length||r.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_FRIEND_CENTER_NO_RECS)},onDismiss:function d(){return"cycler"===this.options.view_type?void this.getChildById("moduleCycler").showNextModule(null):(this.resource.options.page_size=1,void this._fetchMore())},onBoardFollow:function c(){"follow"===this.options.cycle_trigger&&this.getChildById("moduleCycler").showNextModule(null)},_fetchMore:function u(){return this.pendingMoreRequest?void setTimeout(function(){this._fetchMore()}.bind(this),500):(this.pendingMoreRequest=!0,void this.renderAdditional(a.APPEND).then(function(){this.pendingMoreRequest=!1}.bind(this)))}});l.prototype.className="FriendBoardRecommendationTiles",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(18),a=i(75),r=i(27),l=n.extend({events:{"click .navigation .rightArrow":"showNextModule","click .navigation .leftArrow":"showPreviousModule"},CssClassName:{DISABLED:"disabled"},MAX_MODULE_QUEUE_SIZE:3,onCreated:function h(){this.modules=this.options.modules,this._setSelectedIndex(this.options.selected_index||0),this.nextModuleChildEvent=this.options.next_module_child_event,this.wraparound=this.options.wraparound||!1,this.showNavigation=this.options.show_navigation||!1,this.cycleInterval=this.options.cycle_interval||0,this.modulePromises=[],this._moduleIndexQueue=[],this._handleModuleLoadedFnQueue=[]},onContentReady:function d(){this.options.state_leftArrowEnabled=!1,this.options.state_rightArrowEnabled=!1,this.nextModuleChildEvent&&this.childListen(this.nextModuleChildEvent,this.showNextModule),this.children.length>0?this.currentModule=this.children[0]:this.log.error("No modules were loaded in ModuleCycler"),this.$leftArrow=this.$(".navigation .leftArrow"),this.$rightArrow=this.$(".navigation .rightArrow"),this._updateNavigationDisplayState(),this.cycleInterval>0&&(this.interval=setInterval(this.showNextModule.bind(this),1e3*this.cycleInterval))},updateDom:function c(){this.$leftArrow.toggleClass(this.CssClassName.DISABLED,!this.options.state_leftArrowEnabled),this.$rightArrow.toggleClass(this.CssClassName.DISABLED,!this.options.state_rightArrowEnabled)},onDestroyed:function u(){this.interval&&clearInterval(this.interval),this._moduleIndexQueue=[]},_getModuleIndex:function p(t){return this.wraparound?r.mod(t,this.modules.length):t},_getModulePromiseAtIndex:function _(t){if(0>t||t>=this.modules.length)return null;var e=this.modulePromises[t];if(e)return e;var i=this.modules[t];return e=a.promise.then(function(){return o.load(i)}),this.modulePromises[t]=e,e},getNavigatedIndex:function g(){return this._moduleIndexQueue.length>0?this.getNextIndexToShow():this.selectedIndex},showNextModule:function m(t){t&&t.stopPropagation();var e=this._getModuleIndex(this.getNavigatedIndex()+1);return this.showModuleAtIndex(e)},showPreviousModule:function f(t){t&&t.stopPropagation();var e=this._getModuleIndex(this.getNavigatedIndex()-1);return this.showModuleAtIndex(e)},_setSelectedIndex:function C(t){this.selectedIndex=this._getModuleIndex(t)},_handleModuleShown:function E(){if(0!==this._moduleIndexQueue.length){var t=this._moduleIndexQueue.shift();if(this._setSelectedIndex(t),this._handleModuleLoadedFnQueue.length>0){var e=this._handleModuleLoadedFnQueue.shift();e()}}},_handleModuleLoaded:function v(t,e){var i=this.currentModule;if(this.getNextIndexToShow()===t)i.fadeOut(function(){this.removeChild(i),this.appendChild(e),this.currentModule=e,e.fadeIn(this._handleModuleShown.bind(this))}.bind(this));else{var n=function(){this._handleModuleLoaded(t,e)}.bind(this);this._handleModuleLoadedFnQueue.push(n)}},getNextIndexToShow:function I(){var t=this._moduleIndexQueue.length;return t>0?this._moduleIndexQueue[t-1]:null},showModuleAtIndex:function T(t){var e=this._getModulePromiseAtIndex(t);if(!e||this._moduleIndexQueue.length>=this.MAX_MODULE_QUEUE_SIZE)return null;this._moduleIndexQueue.push(t),this._updateNavigationDisplayState();var i=function(e){e.renderExistingData().then(function(){this._handleModuleLoaded(t,e)}.bind(this))}.bind(this);return e.then(i)},hasNext:function N(){return this.wraparound?this.modules.length>0:this.getNextIndexToShow()<this.modules.length-1},hasPrevious:function S(){return this.wraparound?this.modules.length>0:this.getNextIndexToShow()>0&&this.modules.length>1},_updateNavigationDisplayState:function b(){this.contentReady&&this.showNavigation&&this.updateOptionsAndDom({state_leftArrowEnabled:this.hasPrevious(),state_rightArrowEnabled:this.hasNext()})}});l.prototype.className="ModuleCycler",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(18),r=i(8),l=i(206);i(528);var h=o.extend({onContentReady:function d(){this.childListen(n.EVENT_BOARD_FOLLOW,this._onBoardFollow),this.childListen(n.EVENT_DISMISS,this.onDismiss)},_onBoardFollow:function c(t){var e={name:"ActionSuccessToast",id:"boardFollowSuccessToast",options:{view_type:"boardFollow"},data:this.data};a.load(e).then(function(t){l.addToast(t)})},onDismiss:function u(t){var e=t.currentTarget;if(!this.isBoardFollowed()&&"recommendationTile"===e.id){var i=this._extractBoardData(e);this._deleteBoardRecommendation(i)}this._removeSelf()},isBoardFollowed:function p(){var t=this.children[0].getChildByModuleName("Board").getChildByModuleName("BoardFollowButton");return t.getState()},_removeSelf:function _(){this.fadeOut(this.destroy.bind(this))},_extractBoardData:function g(t){return t.options.modules[1].data},_deleteBoardRecommendation:function m(t){var e={board_ids:[t.id]},i=r.create("SocialDiscoverySuggestionResource",e);return i.callDelete()}});h.prototype.className="FriendBoardRecommendationTile",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({events:{"click .dismiss":"onDismissClick"},onDismissClick:function r(t){this.triggerEvent(n.EVENT_DISMISS,null,!0),t.stopPropagation()}});a.prototype.className="DiscoveryTile",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(62),l=i(227),h=i(18),d=i(206),c=i(46);i(528);var u=a.extend({onCreated:function p(){var t={};t[s.PUBSUB_TOPIC_FRIEND_CENTER_NO_RECS]=this.handleRecommendationsEmpty,this.pubsubSubscribe(s.PUBSUB_CHANNEL_SITE,t),this.childListen(s.EVENT_DISMISS,this.onDismiss),this.childListen(s.EVENT_SOCIAL_NETWORK_CONNECTION,this.onSocialNetworkConnect),this.childListen(s.EVENT_CONTACTS_IMPORTED,this.handleFriendImportCompleted),this.pendingMoreRequest=!1},onContentReady:function _(){this.scrollableElement||(this.contacts=this.data,this.scrollableElement=this.getScrollableElement(),this.scrollListener=this.listen(this.scrollableElement,s.EVENT_SCROLL,this._onScroll))},CssClassName:{NO_RECS:"noRecs"},PAGE_SIZE:50,HEIGHT_BEFORE_BOTTOM_FOR_FETCHING_MORE:800,handleRecommendationsEmpty:function g(){this.$el.addClass(this.CssClassName.NO_RECS)},onSocialNetworkConnect:function m(t){var e=t.data.network,i=l.instance(),n={username:c.attributes.username},s={resourceOptions:n};i.pollForFriends(e,s)},_fetchMore:function f(){this.resource.options.page_size=this.PAGE_SIZE;var t=this.resource.getLatestBookmark();return t&&this.resource.setBookmarks([t]),this.pendingMoreRequest=!0,this.options.only_show_contacts=!0,new Promise(function(t,e){this.renderAdditional(r.APPEND).then(function(){this.pendingMoreRequest=!1,this.options.only_show_contacts=!1,t()}.bind(this),function(){this.pendingMoreRequest=!1,this.options.only_show_contacts=!1,e()}.bind(this))}.bind(this))},_getHeightBeforeBottomReached:function C(){var t=this.scrollableElement.scrollTop(),e=this.scrollableElement.height();return n(document).height()-t-e},_onScroll:function E(){this.resource&&this.resource.atEnd()||this.pendingMoreRequest||this._getHeightBeforeBottomReached()<this.HEIGHT_BEFORE_BOTTOM_FOR_FETCHING_MORE&&this._fetchMore()},handleFriendImportCompleted:function v(t){if(t.data.is_success){var e=t.data.network;return this.render().then(function(){var t={name:"ActionSuccessToast",options:{view_type:"contactsAdded"},data:{network:e}};h.load(t).then(function(t){d.addToast(t)})})}},onDismiss:function I(t){var e=t.currentTarget;e.fadeOut(e.destroy.bind(e))}});u.prototype.className="InviteTiles",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="SharedInterests",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(173);var o=n.extend({});o.prototype.className="FillHomeFeed",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(316),a=i(18),r=o.extend({onContentReady:function l(){o.prototype.onContentReady.call(this);var t={};t[n.PUBSUB_MESSAGE_USER_EMAIL_UPDATED]=this.completeExperienceAndReload,this.pubsubSubscribe(n.PUBSUB_CHANNEL_CURRENT_USER,t)},complete:function h(t){this.keepHero=t,this.showEditEmailModal()},showEditEmailModal:function d(){var t=this.getChildById("complete");t.showLoading();var e={name:"UserEditEmail",resource:{name:"UserSettingsResource",options:{}}};a.load(e).then(function(e){t.hideLoading(),this.showInModal(e)}.bind(this))},completeExperienceAndReload:function c(){var t=this.getChildById("complete");t.showLoading(),o.prototype.complete.apply(this,[this.keepHero]),window.location.reload()}});r.prototype.className="HeroFixEmail",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(2),s=i(276),o=i(19),a=i(27),r=i(11),l=s.extend({onContentReady:function h(){var t={};t[r.PUBSUB_TOPIC_TUTORIAL_SEO_HOMEFEED]=this.destroy,this.pubsubSubscribe(r.PUBSUB_CHANNEL_TUTORIAL,t),s.prototype.onContentReady.call(this)},onButtonClick:function d(){var t=n(document).height(),e=2500;a.scrollToTop({duration:e,newScrollOffset:t,callback:this.destroy.bind(this)})}});l.prototype.className="HeroHomefeedEducation",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(115),a=i(276),r=i(8),l=i(104);i(116),i(117);var h="install_app",d=a.extend({onContentReady:function c(){this.formListener&&this.removeListener(this.formListener);var t;t={phoneNumber:[l.Required(),l.PhoneNumber()]},this.form=new o(this.$("form"),t),this.formListener=this.listen(this.form,n.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.installAppButton=this.getChildById(h),a.prototype.onContentReady.call(this)},onSubmitValidated:function u(t){t.errors[0]||this.installAppSms()},onSuccess:function p(){this.complete(),this.installAppButton.hideLoading(),this.installAppButton.setText(this.options.sent_text),this.installAppButton.disable()},onFailure:function _(){this.installAppButton.hideLoading()},installAppSms:function g(){var t=this.form.getValue("phoneNumber"),e=this.form.getValue("country"),i=r.create("SmsAppInstall",{number:t,country:e});this.installAppButton.showLoading(),i.callCreate({showError:!1}).then(function(){this.onSuccess()}.bind(this),function(){this.onFailure()}.bind(this))}});d.prototype.className="HeroInstallApp",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(316),s=i(19),o=i(8),a=1,r=n.extend({complete:function l(t){var e=this.getChildById("complete");e.showLoading();var i=o.create("UserStateResource",{state:"RESETTING_HOME_FEED",value:a});i.callCreate().then(function(e){n.prototype.complete.apply(this,[t]),window.location.reload()}.bind(this),function(){})}});r.prototype.className="HeroRebuildFeed",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(316),s=i(19),o=i(8),a=i(34);i(116);var r=10,l=500,h=2,d=n.extend({dismiss:function c(t){var e=this.getChildById("close");e.showLoading();var i=o.create("OrientationContextResource",{});i.callDelete({showError:!1}).then(function(){this.pollFeedStatus(r)}.bind(this))},pollFeedStatus:function u(t){0>=t&&window.location.reload();var e=o.create("UserStateResource",{state:"RESETTING_HOME_FEED"});e.callGet({showError:!1}).then(function(e){e.resource_response.data!==h?window.location.reload():a.setTimeout(function(){this.pollFeedStatus(t-1)}.bind(this),l)}.bind(this),function(){a.setTimeout(function(){this.pollFeedStatus(t-1)}.bind(this),l)}.bind(this))}});d.prototype.className="HeroUndoRebuildFeed",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(276),s=i(19);i(173);var o=n.extend({});o.prototype.className="HeroVerifyWebsite",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(316),s=i(19),o=i(277),a=n.extend({complete:function r(t){n.prototype.complete.apply(this,[t]),o.instance().subscribe()}});a.prototype.className="HeroWebPush",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="InternationalSubdomains",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(31),l=i(27),h=a.extend({events:{"click .language":"onClick"},onClick:function d(t){var e=n(t.currentTarget),i=r.appendQueryString(e.attr("data-url"),r.getQueryStringParams());return l.trackRegisterAction("language_dropdown_clicked"),this.navigate(i,null,s.GEN.ForceRefreshType.PAGE),!1}});h.prototype.className="LanguageDropdown",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(171);var o=n.extend({});o.prototype.className="LanguageMenu",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(235),s=i(19),o=n.extend({});o.prototype.className="ActionSuccessToast",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(148),a=i(50),r=i(18),l=i(206);i(116);var h=a.extend({events:{"click .btn":"onButtonClick"},CssClassName:{INVITE_DISABLED:"inviteDisabled"},onContentReady:function d(){this.data&&(this.email=this.data.id,this.enabled=!0)},disableInvite:function c(){this.enabled=!1,this.$el.addClass(this.CssClassName.INVITE_DISABLED)},_onInvite:function u(t){if(t){var e={recipients:this.email};this.triggerEvent(n.EVENT_INVITE_USER,e,!0);var i={name:"ActionSuccessToast",id:"inviteSuccessToast",options:{view_type:"inviteContact"},data:this.data};r.load(i).then(function(t){l.addToast(t)})}},onButtonClick:function p(){return this.email&&this.enabled&&(this.disableInvite(),o.userInviteEmail(this.email,this._onInvite.bind(this))),!1}});h.prototype.className="InviteButtonEmail",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(148),a=i(50);i(116);var r=a.extend({onContentReady:function l(){this.inviteButton=this.getChildById("facebookInvite"),this.listen(this.inviteButton,n.EVENT_BUTTON_CLICK,this.onFacebookInvite)},onFacebookInvite:function h(){o.userInviteFacebook(null,function(){})}});r.prototype.className="InviteButtonFacebook",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(148),s=i(19),o=i(546),a=i(50),r=i(27);i(321),i(547);var l=a.extend({onContentReady:function h(){r.trackRegisterAction("web_invite_landing"),n.trackInviteFunnelAction("invite_landing");var t=this.extraData.invite_type;switch(t){case"reminder_1":n.trackInviteFunnelAction("recipient_invite_reminder1_landing",!0);break;case"reminder_2":n.trackInviteFunnelAction("recipient_invite_reminder2_landing",!0);break;default:n.trackInviteFunnelAction("recipient_invite_landing",!0)}this.extraData.show_invite_modal&&o.showInviteModal(this.options.inviter_user_id,"user")}});l.prototype.className="InviteLanding",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(135),a=i(18);i(326);var r=n.extend({});r.showInviteModal=function(t,e){var i={name:"InviteModal",options:{page:e},resource:{name:"UserResource",options:{user_id:t}}};a.load(i).then(function(t){o.get().createAndShowModal(t,{can_dismiss:!1})})},r.prototype.className="InviteModal",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(21),s=i(218),o=i(19),a=i(11),r=i(50),l=i(135),h=i(18),d=i(20),c=i(311),u=i(46);i(315),i(548),i(553),i(567);var p=r.extend({events:{},getLoggingObjectIdStr:function _(){return this.data.id},onAddedToDom:function g(){this.childListen(a.EVENT_NAVIGATE,this.onChildNavigate)},onRemovedFromDom:function m(){this._removeListeners()},onContentReady:function f(){u.isAuthenticated()||(n.set(a.COOKIE_LAST_UNAUTH_PROFILE_ID,this.data.id),c.logUrl());var t={};t[a.PUBSUB_TOPIC_USER_BLOCKED]=this.onAccessChange,t[a.PUBSUB_TOPIC_USER_UNBLOCKED]=this.onAccessChange,this.data&&this.data.id&&this.pubsubSubscribe(this.data.id,t),"1"===this.options.show_redirected_memo&&this.showRedirectDialog(),"1"===this.options.board_create&&this.showBoardCreateModal()},showRedirectDialog:function C(){var t={name:"ConfirmDialog",options:{template:"deleted_board_redirect",user_name:this.data.full_name,auto_close_delay_ms:7e3}};h.load(t).then(function(t){l.get().createAndShowModal(t)})},showBoardCreateModal:function E(){var t=new s({options:{}});this.showInModal(t)},onAccessChange:function v(){this.render()},onChildNavigate:function I(t){this.log.debug("UserProfilePage got navigate event from child",t.target,"for url:",t.data.url);var e=d.instance&&d.instance.resolve(t.data.url);if(e){var i=e.module,n=e.options,s=e.resource,o=s.options&&s.options.username,a=this.data;if(this.contentReady&&i===this.className&&o===(a&&a.username)){this.setOptions(n),this.setResource(s);var r=this.$el.height();this.$el.css("min-height",r);var l=this.getScrollableElement(),h=l.scrollTop(),c=n.tab,u=this.getChildByModuleName("UserProfileContent"),p=this.getChildByModuleName("UserInfoBar");p.setOptions({tab:c,spinner:{enable:!1}}),p.render(),u.setOptions({tab:c}),u.showLoading(),u.render().then(function(){u.hideLoading(),this.$el.css("min-height","");var t=l.height(),e=this.$el.positionAncestor(l).top,i=this.$el.height(),n=h+t-i+e;n>0&&(this.$el.css("min-height",i+n),l.scrollTop(h))}.bind(this)),t.data.handled=!0}}}});p.prototype.className="UserProfilePage",t.exports=o.register(p)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(549),i(246),i(550),i(551),i(552);var o=n.extend({});o.prototype.className="UserInfoBar",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(130),r=o.extend({onContentReady:function l(){var t={};t[n.PUBSUB_TOPIC_BOARD_CREATED]=this.onBoardCountUpdate,t[n.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardCountUpdate,t[n.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardCountUpdate,this.pubsubSubscribe(n.PUBSUB_CHANNEL_CURRENT_USER,t),a.prototype.onContentReady.call(this)},onBoardCountUpdate:function h(t,e,i){i.privacy!==n.BOARD_PRIVACY_SECRET&&this.render()}});r.prototype.className="BoardCount",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(130),r=o.extend({onContentReady:function l(){var t={};t[n.PUBSUB_TOPIC_USER_FOLLOW]=this.onFollowerChange,t[n.PUBSUB_TOPIC_USER_UNFOLLOW]=this.onFollowerChange,this.pubsubSubscribe(this.data.id,t),a.prototype.onContentReady.call(this)},onFollowerChange:function h(t,e,i){this.render()}});r.prototype.className="FollowerCount",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(130),r=o.extend({onContentReady:function l(){a.prototype.onContentReady.call(this);var t={};t[n.PUBSUB_TOPIC_USER_FOLLOW]=this.onFollowingChange,t[n.PUBSUB_TOPIC_USER_UNFOLLOW]=this.onFollowingChange,this.pubsubSubscribe(n.PUBSUB_CHANNEL_CURRENT_USER,t)},onFollowingChange:function h(t,e,i){this.render()}});r.prototype.className="FollowingCount",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="LikeCount",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(193),r=i(50),l=i(80),h=i(81),d=i(14),c=i(8);i(151),i(554),i(556),i(558),i(559),i(561),i(562),i(563),i(566);var u="boards",p="pins",_=r.extend({onCreated:function g(){var t={};t[s.PUBSUB_TOPIC_PIN_CREATED]=this.onPinAdded,this.pubsubSubscribe(s.PUBSUB_CHANNEL_CURRENT_USER,t)},addTutorials:function m(){if(this.options.tab===u){var t=s.GEN.Placement.WEB_USER_PROFILE_TAKEOVER;a.launchPlacedExperience(t,{user_id:this.data.id})}},onContentReady:function f(){if(!this.data.board_count&&!this.data.secret_board_count){var t={};t[s.PUBSUB_TOPIC_BOARD_CREATED]=this.onFirstBoardCreated,this.pubsubSubscribe(s.PUBSUB_CHANNEL_CURRENT_USER,t)}n.defer(this.addTutorials.bind(this)),this.followingContentGrid=this.getChildByModuleName("UserProfileFollowingGrid"),this.childListen(s.EVENT_REFRESH_FOLLOWING_GRID,this.onRefreshFollowingGrid);var e=this.data;switch(this.options.tab){case"boards":e.board_count||this._log_empty_state_view(s.GEN.ViewType.EMPTY_STATE,s.GEN.ViewParameterType.USER_BOARDS);break;case"pins":e.pin_count||this._log_empty_state_view(s.GEN.ViewType.EMPTY_STATE,s.GEN.ViewParameterType.USER_PINS);break;case"likes":e.like_count||this._log_empty_state_view(s.GEN.ViewType.EMPTY_STATE,s.GEN.ViewParameterType.USER_LIKES);break;case"followers":e.follower_count||this._log_empty_state_view(s.GEN.ViewType.EMPTY_STATE,s.GEN.ViewParameterType.USER_FOLLOWERS);break;case"following":e.following_count||this._log_empty_state_view(s.GEN.ViewType.EMPTY_STATE,s.GEN.ViewParameterType.USER_FOLLOWING)}},_log_empty_state_view:function C(t,e){var i={event_type:s.GEN.EventType.VIEW,view_type:t,view_parameter:e},n=l.fromPlainObject(i);h.getInstance().addEvent(n)},onRefreshFollowingGrid:function E(t){var e=this._getFollowingGridOptions(t.data.following_tab);e.resource&&(this.followingContentGrid.resource=c.create(e.resource,{username:t.target.options.username}),n.extend(this.followingContentGrid.options,n.omit(e,"resource")),this.followingContentGrid.render())},_getFollowingGridOptions:function v(t){var e={};switch(t){case"navFollowedInterests":n.extend(e,{resource:"InterestFollowingResource",item_options:{view_type:"followingView"},empty_content_message:d._("What are you interested in? Follow any topic to see what ideas people are saving on Pinterest."),nav_url:"/categories/",nav_button_text:d._("Explore topics")});break;case"navFollowedPinners":n.extend(e,{resource:"UserFollowingResource",empty_content_message:d._("Follow people who share your interests to discover more Pins you might like."),nav_url:"/find_friends/",nav_button_text:d._("Find Pinners to follow")});break;case"navFollowedBoards":n.extend(e,{resource:"BoardFollowingResource",empty_content_message:d._("Follow interesting boards to get the latest Pins delivered right to your home feed."),nav_url:"/search/boards",nav_button_text:d._("Find boards to follow")})}return e},onFirstBoardCreated:function I(t,e,i){this.pubsubUnsubscribe(s.PUBSUB_CHANNEL_CURRENT_USER,s.PUBSUB_TOPIC_BOARD_CREATED),this.render()},onPinAdded:function T(t,e,i){if(this.options.tab===p&&i.board.privacy!==s.BOARD_PRIVACY_SECRET&&this.extraData.isOwnProfile){var n=this.getChildById("userPins");n?n.prependNewItems(1):this.render()}}});_.prototype.className="UserProfileContent",t.exports=o.register(_)},function(t,e,i){"use strict";var n=i(555),s=i(19);i(173);var o=n.extend({});o.prototype.className="EmptyStateCardProfileBoards",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o={FOOTER:"footer",HEADER:"header",CENTER_CONTENT:".centerContent",ACTION_BUTTON:".actionButton"},a=n.extend({_hideItem:function r(t){this.$el.find(t).hide()},_showItem:function l(t){this.$el.find(t).show()},_setVisibility:function h(t,e){return e?this._showItem(t):this._hideItem(t)},setHeaderIsVisible:function d(t){var e=o.HEADER;this._setVisibility(e,t)},setCenterContentIsVisible:function c(t){var e=o.CENTER_CONTENT;this._setVisibility(e,t)},setFooterIsVisible:function u(t){var e=o.FOOTER;this._setVisibility(e,t)},setActionButtonIsVisible:function p(t){var e=o.ACTION_BUTTON;this._setVisibility(e,t)}});a.prototype.className="EmptyStateCard",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(555),s=i(19);i(557),i(137);var o=n.extend({});o.prototype.className="EmptyStateCardProfileFollowers",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(11),a=i(484),r=n.extend({onClick:function l(){a.openDialog({tweet_path:this.options.tweet_path,tweet_text:this.options.tweet_text}),this.triggerEvent(o.EVENT_BUTTON_CLICK,null,!0)}});r.prototype.className="TweetButton",t.exports=s.register(r);
},function(t,e,i){"use strict";var n=i(555),s=i(19);i(130);var o=n.extend({});o.prototype.className="EmptyStateCardProfileFollowing",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(560),s=i(19),o=i(232),a=i(11),r=i(555);i(116);var l=r.extend({onContentReady:function h(){var t={};t[a.PUBSUB_TOPIC_BROWSER_EXTENSION_STATE_UPDATED]=this._setBrowserButtonUpsellDisplayState,this.pubsubSubscribe(a.PUBSUB_CHANNEL_BROWSER_EXTENSION,t),this.childListen(a.EVENT_BUTTON_CLICK,this.onButtonClick),this._setBrowserButtonUpsellDisplayState()},_setBrowserButtonUpsellDisplayState:function d(){var t=this.options.is_own_profile;o.isExtensionInstalled()&&t&&(r.prototype.setFooterIsVisible.call(this,!1),r.prototype.setActionButtonIsVisible.call(this,!1))},onButtonClick:function c(t){var e=t.target;e.showLoading();var i=new n({options:{extension_installed:!!o.isExtensionInstalled(),suppress:!1}});this.showInModal(i),e.hideLoading()}});l.prototype.className="EmptyStateCardProfileLikes",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(21),s=i(232),o=i(19),a=i(11),r=i(50),l=i(81),h=i(35),d=i(14),c=i(23);i(116);var u=r.extend({events:{"click .promoWrapper":"_installExtension"},onContentReady:function p(){this.childListen(a.EVENT_BUTTON_CLICK,this.onButtonClick),l.getInstance().logCustomViewEvent(a.GEN.ViewType.SAVE,a.GEN.ViewParameterType.EXTENSION_UPSELL_MODAL)},_installExtension:function _(){s.isExtensionInstalled()?h.showError(d._("Oops! You already have the browser button.")):s.handleExtensionInstall(function(){this.destroy()}.bind(this))},onButtonClick:function g(t){var e=t.target,i=e.id;"installExtensionButton"===i?this._installExtension():"cancelInstallButton"===i&&(this.options.suppress&&n.set(a.COOKIE_SUPPRESS_EXTENSION_NAG,"true"),this._logCustomContextEvent(a.GEN.EventType.CLICK,a.GEN.ElementType.CANCEL_EXTENSION_INSTALL_BUTTON,a.GEN.ComponentType.BROWSER,{}),c.instance.publish(a.PUBSUB_CHANNEL_SITE,a.PUBSUB_TOPIC_IGNORE_EXTENSION_NAG))}});u.prototype.className="BrowserButtonUpsell",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(560),s=i(19),o=i(232),a=i(11),r=i(555);i(116);var l=r.extend({onContentReady:function h(){this.childListen(a.EVENT_BUTTON_CLICK,this.onButtonClick);var t=this.options.is_own_profile;o.isExtensionInstalled()&&t&&(r.prototype.setFooterIsVisible.call(this,!1),r.prototype.setActionButtonIsVisible.call(this,!1))},onButtonClick:function d(t){var e=t.target;e.showLoading();var i=new n({options:{extension_installed:!!o.isExtensionInstalled(),suppress:!1}});this.showInModal(i),e.hideLoading()}});l.prototype.className="EmptyStateCardProfilePins",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(116);var a=o.extend({onContentReady:function r(){this.listen(this.getChildById("navFollowedInterests"),n.EVENT_BUTTON_CLICK,this.onButtonTabClick),this.listen(this.getChildById("navFollowedPinners"),n.EVENT_BUTTON_CLICK,this.onButtonTabClick),this.listen(this.getChildById("navFollowedBoards"),n.EVENT_BUTTON_CLICK,this.onButtonTabClick)},onButtonTabClick:function l(t){var e=t.target.id,i=this.getChildById("navFollowedInterests"),s=this.getChildById("navFollowedPinners"),o=this.getChildById("navFollowedBoards");i.setSelected("navFollowedInterests"===e),s.setSelected("navFollowedPinners"===e),o.setSelected("navFollowedBoards"===e),this.triggerEvent(n.EVENT_REFRESH_FOLLOWING_GRID,{following_tab:e},!0)}});a.prototype.className="FollowingSwitcher",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(2),s=i(150),o=i(19),a=i(564),r=i(11),l=i(50),h=i(126),d=i(29),c=i(8);i(151);var u=r.BOARD_PRIVACY_SECRET,p="publicBoardsGrid",_="secretBoardsGrid",g=l.extend({onContentReady:function m(){var t={};t[r.PUBSUB_TOPIC_BOARD_CREATED]=this.onBoardCreated,t[r.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,t[r.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,this.extraData.isOwnProfile&&(t[r.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF]=this.onBoardRemovedSelf,this.initializeBoardsSortManager(p),this.initializeBoardsSortManager(_),this.setupMessageHandlers()),this.pubsubSubscribe(r.PUBSUB_CHANNEL_CURRENT_USER,t)},onBoardCreated:function f(t,e,i){var n=i,o=n.id,a=n.privacy,r=a===u?_:p,l=this.getChildById(r),h=new s({options:{show_board_context:!1},resource:{name:"BoardResource",options:{board_id:o}}});l.items.appendChild(h),h.render(),l.forceDragState()},onBoardDeleted:function C(t,e,i){},onBoardUpdated:function E(t,e,i){i===r.PUBSUB_MESSAGE_BOARD_PRIVACY_CHANGED&&this.render()},onBoardRemovedSelf:function v(t,e,i){this.render()},addCreateBoardRep:function I(t,e,i){if(!i.items.getChildById(t)){var n=new a({id:t,options:{secret:e===u}});n.render().then(function(){i.items.appendChild(n)})}},initializeBoardsSortManager:function T(t){var e=this.getChildById(t),i={cancel:".BoardCreateRep",over:function s(t,e){var i=30,s=n(window).scrollTop(),o=e.offset.top-s,a=e.item.height(),r=0>o,l=o>h.height-a;l&&(i*=-1),(r||l)&&n(window).scrollTop(s-i)},update:function(e,i){this.onBoardsSortUpdate(e,i,t)}.bind(this)};e.setDragState(e.DRAGGING_DISABLED),e.items.initializeSortManager(i,"Board",function(t){return t.data&&t.data.id})},onBoardsSortUpdate:function N(t,e,i){var n=this.getChildById(i);this.saveBoardOrder(n.items.getSortOrder())},saveBoardOrder:function S(t){var e="BoardsReorderResource",i={board_ids:t},n=c.create(e,i),s="user_boards_reorder";n.callUpdate({showError:!1}).then(function(){d.trackEvent(s,r.GA_ACTION_SUCCESS)},function(){d.trackEvent(s,r.GA_ACTION_ERROR)})},setupMessageHandlers:function b(){var t=[this.getChildById(p),this.getChildById(_)],e={};e[r.PUBSUB_TOPIC_CONVERSATION_OPEN]=this.handleConversationOpen.bind(this,t),e[r.PUBSUB_TOPIC_CONVERSATION_CLOSED]=this.handleConversationClosed.bind(this,t),e[r.PUBSUB_TOPIC_CONVERSATION_NO_ACTIVE_CONVERSATIONS]=this.handleConversationClosed.bind(this,t),this.pubsubSubscribe(r.PUBSUB_CHANNEL_MESSAGES,e),this.childListen(r.EVENT_ITEMS_REQUEST_SUCCESS,this.onItemsRequestSuccess.bind(this,t))},handleConversationOpen:function y(t){t.forEach(function(t){t.setDragState(t.DRAGGING_ENABLED)})},handleConversationClosed:function P(t){t.forEach(function(t){t.setDragState(t.DRAGGING_DISABLED)})},onItemsRequestSuccess:function B(t){t.forEach(function(t){t.forceDragState()})}});g.prototype.className="UserBoards",t.exports=o.register(g)},function(t,e,i){"use strict";var n=i(565),s=i(19),o=i(13),a=i(46),r=n.extend({events:{click:"onClick"},onClick:function l(t){t.stopPropagation(),t.preventDefault(),a.isLimitedLogin()?o.showLogin(this):this.showModalSubmodule()}});r.prototype.className="BoardCreateRep",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(27),a=n.extend({showModalSubmodule:function r(){return o.showModalSubmodule(this)}});a.prototype.className="ModalTrigger",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151),i(130);var o=n.extend({});o.prototype.className="UserProfileFollowingGrid",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(40);i(171),i(173),i(137),i(568);var r=o.extend({CssClassName:{ACTIVE:"active",SHADOW:"shadow",FIXED:"fixed"},onCreated:function l(){this._resized=!1,this._canSeeFixedHeader=!1},_resizeTextIfReady:function h(){!this._resized&&this.inDom&&this.contentReady&&this.$(".userProfileHeaderBio").overflowingText()},onContentReady:function d(){if(this._resizeTextIfReady(),this.options.user_id){var t={};t[n.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(this.options.user_id,t)}this.scrollListener=this.listen(this.getScrollableElement(),n.EVENT_SCROLL,this.onScroll)},onAddedToDom:function c(){this._resizeTextIfReady()},onUserUpdated:function u(){this.render()},onScroll:function p(){var t=this.getScrollableElement().scrollTop(),e=this.$el.offset().top,i=63;if(!(0>t)){var n=t>e;n^this._canSeeFixedHeader&&(this.$(".fixedHeaderNameAndImage").transition({y:this._canSeeFixedHeader?"0":"50px",duration:200}),this.$(".fixedHeader").toggleClass(this.CssClassName.SHADOW),this._canSeeFixedHeader=n);var s=t>e-i;if(this.$(".header").toggleClass(this.CssClassName.FIXED,s),a.instance.is_mobile_agent){var o=this.$(".userProfileMenu");o.hasClass(this.CssClassName.ACTIVE)&&o.trigger("click")}}}});r.prototype.className="UserProfileHeader",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(29),l=i(18),h=i(23),d=i(8);i(116);var c=a.extend({events:{click:"onClick"},onContentReady:function u(){this.options.state_isUserUnblockConfirmed=!!this.options.isUserUnblockConfirmed,this.options.state_isShowLoading=!!this.options.isShowLoading},updateDom:function p(){this.options.state_isShowLoading?this.showLoading():this.hideLoading(),this.options.state_isUserUnblockConfirmed&&this.destroy()},onUserUnblockSuccess:function _(){var t={name:"ConfirmDialog",options:{template:"block_unblock_user_success",name:this.options.full_name,action:"unblocked"}};n.extend(t.options,this.options.dialog_options),l.load(t).then(function(t){this.showInModal(t,{can_dismiss:!1}),this.listen(t,s.EVENT_CONFIRM,this.onUnblockConfirm)}.bind(this))},onUnblockConfirm:function g(){this.updateOptionsAndDom({state_isUserUnblockConfirmed:!0})},onClick:function m(t){r.trackEvent("user_unblock",s.GA_ACTION_CLICK);var e=this.options.user_id;this.updateOptionsAndDom({state_isShowLoading:!0});var i=d.create("UserBlockResource",{blocked_user_id:this.options.user_id});i.callDelete().then(function(){r.trackEvent("user_unblock",s.GA_ACTION_SUCCESS),h.instance.publish(e,s.PUBSUB_TOPIC_USER_UNBLOCKED),this.onUserUnblockSuccess()}.bind(this),function(){r.trackEvent("user_unblock",s.GA_ACTION_ERROR)}).fin(function(){this.updateOptionsAndDom({state_isShowLoading:!1})}.bind(this))}});c.prototype.className="UnblockButton",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(570),a=i(8),r=i(17);i(571);var l=o.extend({onContentReady:function h(){o.prototype.onContentReady.apply(this,arguments),this.sendInvitationEmailModule=this.getChildById("sendInvitationEmailModule")},onTypeaheadData:function d(t){o.prototype.onTypeaheadData.apply(this,arguments);var e=t.term,i=r.isEmailAddress(e);this.sendInvitationEmailModule.options={text_value:e,is_valid_email:i},this.sendInvitationEmailModule.render()},sendInvitesClicked:function c(){var t,e=[],i="invitability"===this.options.network;if(this.inviteAllChecked()&&!i)t=a.create("BulkNetworkInviteResource",{network:this.options.network});else{var n=this.getCheckedContacts();for(var s in n)n[s]&&e.push(s);var o=this.inviteAllChecked()&&i;if(t=a.create("UserMultiInviteResource",{emails:e,invite_all:o}),!this.inviteAllChecked()&&i){var r=a.create("InviteSentLogResource",{emails_invited:e});r.callCreate()}}this.sendButton.showLoading(),this._triggerInviteEventWithData(t,e)},_triggerInviteEventWithData:function u(t,e){t.callCreate().then(function(){this.sendButton.hideLoading(),this.triggerEvent(n.EVENT_INVITE_USER,null,!0)}.bind(this))}});l.prototype.className="InviteListEmail",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(62),h=i(175);i(116),i(120),i(125);var d=2500,c=["google","yahoo","microsoft","invitability"],u=r.extend({events:{"click .inviteAllLabel":"_onClickInviteAll",'textchange input[type="text"]':"_onTextChange"},onContentReady:function p(){r.prototype.onContentReady.apply(this,arguments),this.scrollableElement=this.$(".inviteContent"),this._scrollListener=this.listen(this.scrollableElement,"scroll",this._onInviteScroll),this.inviteList=this.getChildById("inviteList"),this.emptyResultsFooter=this.$(".emptyResultsFooterContainer"),this.sendButton=this.getChildById("inviteButton"),this.options.checkable&&(this.inviteAllCheck=this.getChildById("inviteAllCheck")),this._reset()},_reset:function _(){this.checkedContacts={},this.options.checkable&&(this.sendButton.setEnabled(!1),this.childListen(o.EVENT_CHANGE,this._onChange)),this.childListen(o.EVENT_BUTTON_CLICK,this._onClick),this._onInviteScroll=this._onInviteScroll.bind(this),this._onInviteScroll=n.throttle(this._onInviteScroll,200);var t={name:"invite",tags:this.options.network,count:50};this.typeahead=new h(t),this.typeahead.prefetch(),this.listen(this.typeahead,o.EVENT_DATA,this.onTypeaheadData)},_onInviteScroll:function g(){if(!this.rendering&&this._searchIsEmpty()){var t=this.$(".List");if(t.position()){var e=t.height()+t.position().top-this.scrollableElement.height();d>=e&&this._fetchMore()}return!1}},_onChange:function m(t){var e=t.target;if("inviteAllCheck"===e.id)this._onToggleInviteAll(t);else{for(var i=0,n=0;n<this.inviteList.children.length;n++){var s=this.inviteList.children[n];this.checkedContacts[s.getEmail()]=s.isChecked(),i+=s.isChecked()?1:0}this._searchIsEmpty()&&this.inviteAllCheck.setChecked(i===this.inviteList.children.length,!1);var o=0;for(var a in this.checkedContacts)this.checkedContacts[a]&&o++;this.sendButton.setEnabled(o>0)}},_onClick:function f(t){"inviteButton"===t.target.id&&this._onClickInvite(t)},_fetchMore:function C(){return this.inviteList.options.item_options.checkedAll=this.inviteAllChecked(),this.resource.atEnd()?void this.removeListener(this._scrollListener):(this.rendering=!0,void this.getChildById("inviteList").renderAdditional(l.APPEND).then(function(){this.rendering=!1}.bind(this)))},_onTextChange:function E(t){this._filterResults()},onTypeaheadData:function v(t){if(!this._searchIsEmpty()&&this._getSearchText()===t.term){var e=[];n.each(t.items,function(t){var i=s.extend({},t);s.inArray(this.options.network,c)>=0&&(i.id_type="email"),this.options.checkable&&(this.checkedContacts[i.id]|=this.inviteAllChecked(),i.checked=this.checkedContacts[i.id]),e.push(i)}.bind(this)),this.inviteList.options.items=e,this.inviteList.resource=null,this.inviteList.render(),e.length?this.emptyResultsFooter.hide():this.emptyResultsFooter.show()}},_filterResults:function I(t){this._searchIsEmpty()?(this.inviteList.resource||this.inviteList.renderAbort(),this.emptyResultsFooter.hide(),this.inviteList.resource=this.resource,delete this.inviteList.options.items,this.inviteList.render().then(function(){this._searchIsEmpty()&&(this.options.checkable&&n.each(this.inviteList.children,function(t){t.setChecked(this.checkedContacts[t.getEmail()],!1)}.bind(this)),t&&t())}.bind(this))):this.typeahead.search(this._getSearchText(),function(){})},_getSearchText:function T(){return this.$("input[type='text']").val().toLowerCase()},_searchIsEmpty:function N(){var t=this._getSearchText();return!t||""===t},inviteAllChecked:function S(){return this.options.checkable&&this.inviteAllCheck.isChecked()},_onClickInvite:function b(t){this.sendInvitesClicked()},_onToggleInviteAll:function y(t){this._getSearchText()?(this.$("input[type='text']").val(""),this._filterResults(function(){this._toggleInviteAll()}.bind(this))):this._toggleInviteAll()},_onClickInviteAll:function P(){this.inviteAllCheck.setChecked(!this.inviteAllChecked()),this._onToggleInviteAll()},_toggleInviteAll:function B(){var t=this.inviteAllChecked();n.each(this.inviteList.children,function(e){this.checkedContacts[e.getEmail()]=t,e.setChecked(t)}.bind(this)),this.sendButton.setEnabled(t)},getCheckedContacts:function A(){return this.checkedContacts},sendInvitesClicked:function R(){}});u.prototype.className="InviteListBase",t.exports=a.register(u)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(148),a=i(50),r=a.extend({events:{"click .sendInvitationEmail":"onMouseClick"},onMouseClick:function l(){if(this.options.is_valid_email){var t=this.options.text_value;o.userInviteEmail(t,function(){this.triggerEvent(n.EVENT_INVITE_USER,{recipients:[t]},!0)}.bind(this))}}});r.prototype.className="SendInvitationEmail",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(570),s=i(19),o=i(47),a=i(46),r=n.extend({onContentReady:function l(){n.prototype.onContentReady.apply(this,arguments),o.ensureInit(function(){},a)}});r.prototype.className="InviteListFacebook",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(148),a=i(50),r=i(18),l=i(206),h=i(104);i(226);var d=a.extend({onCreated:function c(){this.childListen(n.EVENT_ITEM_SELECTED,this._onChildItemSelected),this.childListen(n.EVENT_ENTER_PRESSED,this._onChildEnterPressed),this.childListen(n.EVENT_CONTACT_SELECTED,this._onRecentContactSelected)},_onChildItemSelected:function u(t){var e=t.data.item,i=e.attributes;this._inviteUser(i),t.stopPropagation()},_onRecentContactSelected:function p(t){var e=t.data.type;"emailcontact"===e&&this._inviteEmail(t.data.email_address),t.stopPropagation()},_onItemSelected:function _(){var t=this.getChildById("typeaheadField");t.reset(),this.showLoading(!0)},_onChildEnterPressed:function g(t){var e=this.getChildById("typeaheadField"),i=e.getField(),n=new h.Validator(i,[h.Length({min:1}),h.Email()]);n.validate(this._handleEmailValidation.bind(this)),t.stopPropagation()},_handleEmailValidation:function m(t){var e=this.getChildById("typeaheadField"),i=e.getValue();t.errors&&0!==t.errors.length||this._inviteEmail(i)},_onInvited:function f(t){if(this.hideLoading(),t){var e={name:"ActionSuccessToast",id:"inviteSuccessToast",options:{view_type:"inviteContact"},data:{id:this.email}};r.load(e).then(function(t){l.addToast(t)})}},_inviteEmail:function C(t){this.email=t,this._onItemSelected(),o.userInviteEmail(t,this._onInvited.bind(this))},_inviteUser:function E(t){var e=t.email;this._onItemSelected(),this._inviteEmail(e)}});d.prototype.className="InvitePanelEmail",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=i(46),l=i(323);i(326),i(321);var h=o.extend({onAddedToDom:function d(){this.resizeWindow(),a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NAG_STATE,!1)},onRemovedFromDom:function c(){a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NAG_STATE,!0)},onContentReady:function u(){this.resizeWindow(),r.setLoginContainer("login_page")},resizeWindow:function p(){this.contentReady&&this.inDom&&l.contain()}});h.prototype.className="LoginPage",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(80),r=i(81),l=i(50),h=i(62),d=i(161);i(576),i(275);var c=300,u=l.extend({mixins:[d],onCreated:function p(){this.onNetworkNotificationsScroll=this.onNetworkNotificationsScroll.bind(this),this.onNetworkNotificationsScroll=n.throttle(this.onNetworkNotificationsScroll,200),this.lastViewingStories=[],this.lastViewingStoriesStartTimes=[],this.storyImpressions=[]},onContentReady:function _(){this.scrollableElement=this.$(".networkNotifContent"),this._scrollListener=this.listen(this.scrollableElement,"scroll",this.onNetworkNotificationsScroll),this.startPreventScroll(this.scrollableElement,this.$(".NetworkNotificationItems")),this.parent&&this.listen(this.parent,s.EVENT_DROPDOWN_HIDE,this.onHide)},onAddedToDom:function g(){this.startImpressionsTracking()},onRemovedFromDom:function m(){this.finishImpressionsTracking()},onHide:function f(){this.finishImpressionsTracking()},onNetworkNotificationsScroll:function C(t){if(!this.rendering){var e=this.$(".NetworkNotificationItems"),i=e.height()+e.position().top-this.scrollableElement.height();return c>=i&&this.fetchMore(),this.impressionsTrackingWhenScroll(),!1}},fetchMore:function E(){if(!this.rendering){if(this.resource.atEnd())return void this.removeListener(this._scrollListener);this.rendering=!0,this.appendLoadingItem(),this.getChildById("items").renderAdditional(h.APPEND).then(function(){this.rendering=!1,this.removeLoadingItem(),this.addHeadersToChildContent()}.bind(this))}},addHeadersToChildContent:function v(){this.$(".NetworkNotificationItems").trigger("addHeaders")},appendLoadingItem:function I(){this.$(".NetworkNotificationItems").trigger("appendLoadingItem")},removeLoadingItem:function T(){this.$(".NetworkNotificationItems").trigger("removeLoadingItem")},startImpressionsTracking:function N(){var t=this.getChildByModuleName("NetworkNotificationItems").getChildrenByModuleName("NetworkNotificationItem");this._findStoriesInViewPort(t,this.lastViewingStories,this.lastViewingStoriesStartTimes)},finishImpressionsTracking:function S(){this._sendImpressionsEvents([])},impressionsTrackingWhenScroll:function b(){var t=this.getChildByModuleName("NetworkNotificationItems").getChildrenByModuleName("NetworkNotificationItem"),e=[];this._findStoriesInViewPort(t,e,[]),n.each(e,function(t){this.lastViewingStories.indexOf(t)>=0||(this.lastViewingStories.push(t),this.lastViewingStoriesStartTimes.push(1e6*Date.now()))}.bind(this)),this._sendImpressionsEvents(e)},_findStoriesInViewPort:function y(t,e,i){n.each(t,function(t){t.$el.position().top<this.$el.position().top-5||t.$el.position().top>this.$el.position().top+this.$el.height()||(e.push(t),i.push(1e6*Date.now()))}.bind(this))},_sendImpressionsEvents:function P(t){var e=[],i=[],o=n.zip(this.lastViewingStories,this.lastViewingStoriesStartTimes);if(n.map(o,function(n){var s=n[0],o=n[1];if(t.indexOf(s)>=0)return e.push(s),void i.push(o);var a=1e6*Date.now();1e9>a-o||this.storyImpressions.push({storyIdStr:s.data.story_id,storyType:s.data.story_type})}.bind(this)),this.lastViewingStories=e,this.lastViewingStoriesStartTimes=i,this.storyImpressions.length){var l=s.GEN.EventType.NETWORK_STORY_IMPRESSION_ONE_PIXEL,h=a.fromEventType(l);h.setNetworkStoryImpressions(this.storyImpressions),r.getInstance().addEvent(h)}this.storyImpressions=[]}});u.prototype.className="NetworkNotifications",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19),a=i(577),r=i(40),l=i(14),h=i(68),d=i(17);i(578);var c="<div class='networkNotifDateHeader unseenHeader todayHeader'><span> {{text}} </span></div>",u="<div class='networkNotifDateHeader'><span> {{timeSince}} </span></div>",p=".networkNotifDateHeader",_=s.extend({events:{addHeaders:"addHeadersToContent",appendLoadingItem:"appendLoadingItem",removeLoadingItem:"removeLoadingItem"},CssClassName:{UNSEEN:"unseen"},onContentReady:function g(){this.listen(this,"addHeaders",this.addHeadersToContent),this.trigger("addHeaders"),this.loadingItem=null},addHeadersToContent:function m(){this.$(p).remove();var t=!1,e="",i=l._("Today's stories"),s=d.format(c,{text:i}),o=this.$(".networkNotifItem"),a=this;o.each(function(i){var o=n(this),l=o.data("time"),d=new Date(1e3*parseInt(l,10)),c=new Date,p=r.instance.locale,_=h.formatDate(p,c,h.DateFormatType.WEEKDAY_DATE),g=h.formatDate(p,d,h.DateFormatType.WEEKDAY_DATE);_===g&&o.addClass(a.CssClassName.UNSEEN),_!==g||t?g!==e&&n(u.replace("{{timeSince}}",g)).insertBefore(o):(n(s).insertBefore(o),t=!0),e=g})},appendLoadingItem:function f(){this.removeLoadingItem(),this.loadingItem=new a,this.loadingItem.render().then(function(){this.insertChild(this.loadingItem,this.$el)}.bind(this))},removeLoadingItem:function C(){this.loadingItem&&(this.loadingItem.destroy(),this.loadingItem=null)}});_.prototype.className="NetworkNotificationItems",t.exports=o.register(_)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({onContentReady:function a(){this.showLoading(!1)}});o.prototype.className="NotificationLoadingItem",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(80),r=i(81),l=i(50),h=l.extend({events:{"click .networkNotifItem":"onNetworkNotificationClick","click .mainActorImage":"onMainActorImageClick","click .relatedObjectImage":"onRelatedObjectImageClick","click .actorText":"onActorTextClick"},onNetworkNotificationClick:function d(t){var e=n(t.currentTarget),i=e.attr("data-url");this._logClick(i,s.GEN.ElementType.STORIES_FEED_LARGE_STORY),t.stopPropagation(),this.navigate(i)},onMainActorImageClick:function c(t){var e=n(t.currentTarget),i=e.attr("href");this._logClick(i,s.GEN.ElementType.STORIES_FEED_ACTOR_IMAGE),t.stopPropagation()},onRelatedObjectImageClick:function u(t){var e=n(t.currentTarget),i=e.attr("href");this._logClick(i,s.GEN.ElementType.STORIES_FEED_RELATED_OBJECT),t.stopPropagation()},onActorTextClick:function p(t){var e=n(t.currentTarget),i=e.attr("href");this._logClick(i,s.GEN.ElementType.STORIES_FEED_ACTOR),t.stopPropagation()},_logClick:function _(t,e){if(t){var i=a.fromEventType(s.GEN.EventType.CLICK);i.setElement(e),i.setComponent(s.GEN.ComponentType.STORIES_FEED),i.updateEventData({storyCellType:this.data.cell_type,storyType:this.data.story_type}),r.getInstance().addEvent(i,null)}}});h.prototype.className="NetworkNotificationItem",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151),i(580);var o=n.extend({});o.prototype.className="NetworkStoryLandingPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(128),i(581);var o=n.extend({});o.prototype.className="NetworkStoryInfoBar",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="NetworkStoryActorInfoOverride",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(62),h=i(161);i(583),i(585),i(275);var d=300,c=r.extend({events:{"click .notificationItem":"onNotificationClick"},mixins:[h],onCreated:function u(){this.onNotificationsScroll=this.onNotificationsScroll.bind(this),this.onNotificationsScroll=n.throttle(this.onNotificationsScroll,200)},onContentReady:function p(){this.scrollableElement=this.$(".notifContent"),this._scrollListener=this.listen(this.scrollableElement,"scroll",this.onNotificationsScroll);var t=this.$(".NotificationItems");this.startPreventScroll(this.scrollableElement,t)},onNotificationClick:function _(t){var e=s(t.target),i=s(t.currentTarget),n=i.attr("data-url");if(e.is("a"))return!0;if(n){var a=this.options.use_domain_on_redirect?o.GEN.Settings.CANONICAL_MAIN_URL:"";this.navigate(a+n)}},onNotificationsScroll:function g(t){if(!this.rendering){var e=this.getChildById("items").$el,i=e.height()+e.position().top-this.scrollableElement.height();return d>=i&&this.fetchMore(),!1}},fetchMore:function m(){if(!this.rendering){if(this.resource.atEnd())return void this.removeListener(this._scrollListener);this.rendering=!0,this.appendLoadingItem(),this.getChildById("items").renderAdditional(l.APPEND).then(function(){this.rendering=!1,this.removeLoadingItem()}.bind(this))}},appendLoadingItem:function f(){this.$(".NotificationItems").trigger("appendLoading")},removeLoadingItem:function C(){this.$(".NotificationItems").trigger("removeLoading")}});c.prototype.className="Notifications",t.exports=a.register(c)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(577);i(584);var a=n.extend({events:{appendLoading:"appendLoadingItem",removeLoading:"removeLoadingItem"},onContentReady:function r(){this.loadingItem=null},appendLoadingItem:function l(){this.removeLoadingItem(),this.loadingItem=new o,this.loadingItem.render().then(function(){this.insertChild(this.loadingItem,this.$el)}.bind(this))},removeLoadingItem:function h(){this.loadingItem&&(this.loadingItem.destroy(),this.loadingItem=null)}});a.prototype.className="NotificationItems",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(128);var o=n.extend({});o.prototype.className="NotificationItemBalanced",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(223);var a=o.extend({onContentReady:function r(){this.destroyIfEmpty(),this.pagedGrid=this.getChildById("pagedGrid"),this.childListen(n.EVENT_CONTENT_CHANGED,this.onChildContentChanged)},onChildContentChanged:function l(){this.pagedGrid.hasItems()||this.destroy()},isEmpty:function h(){return!this.data.length},showLoading:function d(){}});a.prototype.className="UserBoardInvites",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(587),a=i(50),r=i(152),l=i(23);i(588);var h=a.extend({CssClassName:{SHOWING_CONVERSATIONS:"conversationsShowing"},onCreated:function d(){var t={};this.childListen(n.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(n.EVENT_SEND_OBJECT_TO_USERS,this.onCreateConversationWithUsers),this.showingConversationGroup=!1,t[n.PUBSUB_TOPIC_CONVERSATION_SET_BADGE]=this.setConversationBadge,t[n.PUBSUB_TOPIC_NOTIFICATION_SET_BADGE]=this.setNotificationBadge,t[n.PUBSUB_TOPIC_NETWORK_STORY_SET_BADGE]=this.setNetworkStoryBadge,this.pubsubSubscribe(n.PUBSUB_CHANNEL_SITE,t)},show:function c(){a.prototype.show.call(this)},hide:function u(){a.prototype.hide.call(this)},onChildRemoved:function p(t,e){a.prototype.onChildRemoved.call(this,t,e),this.removeCreateConversationGroup()},onChildAdded:function _(t){a.prototype.onChildAdded.call(this,t)},onButtonClick:function g(t){var e=t.target;if(e.isCancelButton())return void this.removeCreateConversationGroup();switch(e.id){case"conversationsButton":l.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_CONVERSATION_DROPDOWN_SHOW,{}),this.$el.addClass(this.CssClassName.SHOWING_CONVERSATIONS);break;case"notificationsButton":l.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NOTIFICATION_DROPDOWN_SHOW,{}),this.$el.removeClass(this.CssClassName.SHOWING_CONVERSATIONS);break;case"networkNotificationsButton":l.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NETWORK_STORY_DROPDOWN_SHOW,{}),this.$el.removeClass(this.CssClassName.SHOWING_CONVERSATIONS);break;case"newMessage":this.showCreateConversationGroup()}},setBadge:function m(t,e){t&&(e>0?t.setBadge(e):t.clearBadge())},setConversationBadge:function f(t,e,i){var n=this.getConversationsSegmentedButton();this.setBadge(n,i)},setNotificationBadge:function C(t,e,i){var n=this.getNotificationsSegmentedButton();this.setBadge(n,i)},setNetworkStoryBadge:function E(t,e,i){var n=this.getNetworkNotifSegmentedButton();this.setBadge(n,i)},onCreateConversationWithUsers:function v(t){var e=t.data.user_ids,i=t.data.emails,s={text:t.data.text};r.sendMessageToUsers(e,i,s).then(function(t){this.triggerEvent(n.EVENT_DISMISS,null,!0),this.render()}.bind(this))},showCreateConversationGroup:function I(){this.showingConversationGroup||(this.createConversationGroup=new o({}),this.createConversationGroup.renderExistingData().then(function(){this.appendChild(this.createConversationGroup)}.bind(this))),this.showingConversationGroup=!0},removeCreateConversationGroup:function T(){(this.showingConversationGroup||this.createConversationGroup)&&(this.createConversationGroup.destroy(),this.createConversationGroup=null),this.showingConversationGroup=!1},getConversationsSegmentedButton:function N(){var t=this._getSegmentedController();return t?t.getChildById("conversationsButton"):void 0},getNotificationsSegmentedButton:function S(){var t=this._getSegmentedController();return t?t.getChildById("notificationsButton"):void 0},getNetworkNotifSegmentedButton:function b(){var t=this._getSegmentedController();return t?t.getChildById("networkNotificationsButton"):void 0},setConversationsActiveSegment:function y(){var t=this._getSegmentedController();this.$el.addClass(this.CssClassName.SHOWING_CONVERSATIONS),t.makeActiveModuleFromIndex(1)},_getSegmentedController:function P(){return this.getChildById("segmentedController")},setNotificationsActiveSegment:function B(){var t=this._getSegmentedController();this.$el.removeClass(this.CssClassName.SHOWING_CONVERSATIONS),t.makeActiveModuleFromIndex(0)},getNotificationsSegment:function A(){var t=this._getSegmentedController(),e;return t&&(e=t.getChildByModuleName("notifications")),e}});h.prototype.className="NotificationsConversationsDropdown",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(155),r=i(50),l=i(161);i(116),i(226),i(471);var h=r.extend({mixins:[l],events:{"click .tokenized":"onTokenizedAreaClick"},focus:function d(){var t=this.getTypeaheadField();t.focus()},onCreated:function c(){this.childListen(s.EVENT_BUTTON_CLICK,this.onButtonClicked),this.childListen(s.EVENT_TOKEN_REMOVED,this.onTokenRemoved),this.childListen(s.EVENT_ENTER_PRESSED,this.onEnterPressed),this.childListen(s.EVENT_TOKEN_ADDED,this.onTokenAdded),this.childListen(s.EVENT_CONVERSATION_LIST_ITEM_CLICKED,this.onListItemClicked),this.childListen(s.EVENT_ITEM_SELECTED,this.onTypeaheadItemSelected),
this.userIds=[],this.emails=[]},onEnterPressed:function u(t){var e=this.getTypeaheadField();e.getTypeaheadHighlightedItem()||"input"===t.target.id||this.userIds.length&&this._triggerSendEvent()},getTokenizedInput:function p(){return this.getTypeaheadField().getChildById("tokenizedInput")},getTypeaheadField:function _(){return this.getChildById("searchField")},onTokenizedAreaClick:function g(t){this.focus()},onTokenAdded:function m(t){var e=t.data,i=e.getUsers(),n=e.getFirstUserId();i.length>0?this.userIds.push(n):this.emails.push(n),this._setListItemWithUserId(n,!0),this.setSendButtonEnabled(!0),this.focus()},onTokenRemoved:function f(t){var e=t.data,i=e.getFirstUserId(),s=n.indexOf(this.userIds,i),o=n.indexOf(this.emails,i);-1!==s?this.userIds.splice(s,1):-1!==o&&this.emails.splice(o,1),this._setListItemWithUserId(i,!1),this._getTotalUsersCount()||this.setSendButtonEnabled(!1),this.focus()},_getTotalUsersCount:function C(){return this.userIds.length+this.emails.length},_setListItemWithUserId:function E(t,e){this._getConversationsList().setListItemWithUserId(t,e)},_getConversationsList:function v(){return this.getChildById("convosList")},onContentReady:function I(){this._setup(),this.focus(),this.startPreventingScroll()},adjustTokenizedInputWidth:function T(){var t=this.getTypeaheadField(),e=this.getWidth(),i=10,n=this.$(".placeholder").width();t.getContent().width(e-2*i-n)},onTypeaheadItemSelected:function N(t){t.stopPropagation();var e=t.target;e.parent.reset();var i=t.data.item.attributes,n=i.email,s;s=n?{id:n}:{id:i.id,username:i.username,image_large_url:i.image_medium_url},this.setSendButtonEnabled(!0),this._addConversationHeadAsToken(s)},_addConversationHeadAsToken:function S(t){var e=this.getTokenizedInput(),i=e.getTokens(),s=n.find(i,function(e){return e.getFirstUserId()===t.id});if(!s){var o={size:"small",users:[],emails:[]};t.username?o.users=[t]:o.emails=[t.id];var r=new a({options:o});r.render().then(function(){e.addTokensAndUpdateInputView([r])})}this.focus()},_setup:function b(){this.inDom&&this.contentReady&&(this.adjustTokenizedInputWidth(),this.focus())},setSendButtonEnabled:function y(t){var e=this.$(".cancelButton"),i=this.$(".sendToGroupButton");t?(e.hide(),i.show()):(e.show(),i.hide())},_removeHeadForUser:function P(t){var e=this.getTokenizedInput(),i=e.getTokens();n.each(i,function(i){t.id===i.getFirstUserId()&&e.removeToken(i)})},_addUserAsToken:function B(t){this._addConversationHeadAsToken(t)},onListItemClicked:function A(t){t.stopPropagation();var e=t.target,i=e.getFirstUser();e.isActive()?this._removeHeadForUser(i):(e.setActive(!0),this._addUserAsToken(i))},onAddedToDom:function R(){this._setup()},startPreventingScroll:function w(){this.startPreventScroll(this.$(".ConversationsList"),this.$(".List"))},onButtonClicked:function O(t){var e=t.target.id;"sendToGroupButton"===e&&this._triggerSendEvent()},_triggerSendEvent:function D(){this.triggerEvent(s.EVENT_SEND_OBJECT_TO_USERS,{user_ids:this.userIds,emails:this.emails},!0)}});h.prototype.className="CreateConversationGroup",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(30),a=i(50),r=i(18),l=i(19),h=i(23),d=i(42);i(116);var c=300,u=a.extend({CssClassName:{ACTIVE_SEGMENT:"activeSegment"},onCreated:function p(){this.options=n.extend({state_activeIndex:0,state_loading:!0,state_activeView:null},this.options),this.previousView=null,this.childListen(s.EVENT_BUTTON_CLICK,this.onButtonClick)},onContentReady:function _(){h.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_SEGMENTED_CONTROLLER_SHOW,this),h.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_DROPDOWN_PREP_APP)},updateDom:function g(){var t=this.options.state_activeIndex,e=this.getButtons();n.each(e,function(t){t.getContent().removeClass(this.CssClassName.ACTIVE_SEGMENT)}.bind(this));var i=e[t];if(i.getContent().addClass(this.CssClassName.ACTIVE_SEGMENT),this.previousView&&(this.previousView.remove(),this.previousView=null),this.options.state_loading)this.showLoading();else{this.hideLoading();var s=this.options.state_activeView,o=this.$(".content");this.insertChild(s,o),this.previousView=s}},onButtonClick:function m(t){var e=t.target;if(e.isSegmentedControlButton()){var i=this.getButtons();this.onButtonSelected(n.indexOf(i,e))}},onButtonSelected:n.throttle(function(t){this.makeActiveModuleFromIndex(t)},c),makeActiveModuleFromIndex:function f(t){var e=this.options.modules[t],i=this.parent&&this.parent.className;return d.start(i,"ClickToRender",e.name),this.updateOptionsAndDom({state_activeIndex:t,state_loading:!0}),r.load(e).then(function(t){t.render().then(function(){this.updateOptionsAndDom({state_loading:!1,state_activeView:t}),d.end(i,"ClickToRender",o.reportInteractionTimings)}.bind(this))}.bind(this))},getButtons:function C(){return this.getChildrenByModuleName("Button")}});u.prototype.className="SegmentedController",t.exports=l.register(u)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(115),r=i(50),l=i(8);i(116);var h=r.extend({onContentReady:function d(){this.$form=this.$("form");var t=new a(this.$form,{});this.listen(t,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function c(){var t={},e={};this.$(".pushNotifSettings input[type=checkbox]").each(function(){var t=n(this),i=t.attr("name");e[i.substr(5)]=t.is(":checked")?"anyone":"none"}),t.push_settings=JSON.stringify(e);var i=l.create("NotificationSettingsResource",t);this.showLoading(!0),i.callUpdate().then(function(){this.isInModal()&&this.destroy()}.bind(this)).fin(function(){this.hideLoading()}.bind(this))}});h.prototype.className="PushNotificationSettings",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(195),a=i(50);i(116),i(591),i(593);var r=a.extend({events:{"click .launchFlexibleSetup":"launchFlexibleSetup"},onContentReady:function l(){this.destroyIfEmpty()},onChildRemoved:function h(){this.destroyIfEmpty()||this.triggerEvent(n.EVENT_CONTENT_CHANGED,null,!0)},launchFlexibleSetup:function d(){var t={steps:[{moduleName:"NuxModalInterestPicker",options:{view_type:"brio"}},{moduleName:"NuxModalCompassStep",options:{view_type:"brio_final_loading"}}],sub_type:"modal"};o.instance().startTutorial({type:n.GEN.ExperienceType.NUX,id:"31:10035",display_data:t})}});r.prototype.className="UserNews",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(227),r=i(80),l=i(81),h=i(46);i(592),i(486);var d=o.extend({onCreated:function c(){this.inviteSrc=this.options.invite_src||"homefeed_invite_merch",this.addFriendsURL=n.GEN.Settings.FRIEND_CENTER_ADD_FRIENDS_URL+"?invite_src="+this.inviteSrc},onContentReady:function u(){this.childListen(n.EVENT_DISMISS,this._onDismiss),this.childListen(n.EVENT_SOCIAL_NETWORK_CONNECTION,this._onSocialNetworkConnect),this.childListen(n.EVENT_CONTACTS_IMPORTED,this._handleFriendImportCompleted);var t={};t[n.PUBSUB_TOPIC_VIEW_EVENT_INITIALIZED]=this._logMerchandisingViewEvent,this.pubsubSubscribe(n.PUBSUB_CHANNEL_CONTEXT_LOGGING,t),this._onContactsChange()},_onContactsChange:function p(){var t=this.$(".content .list");0===t.children().length&&this._onNoContacts()},_onNoContacts:function _(){this.$(".upsell").addClass("slideIn")},_logMerchandisingViewEvent:function g(){var t={event_type:n.GEN.EventType.VIEW_DISCOVER_FRIEND_MERCHANDISING,view_type:n.GEN.ViewType.FEED,view_parameter:n.GEN.ViewParameterType.FEED_HOME,component:n.GEN.ComponentType.DISCOVER_FRIEND_MERCHANDISING_INVITE_FRIENDS},e=r.fromPlainObject(t);l.getInstance().addEvent(e)},_onSocialNetworkConnect:function m(t){this.showLoading(!0,this.$(".upsell"));var e=t.data.network,i=a.instance(),n={username:h.attributes.username},s={resourceOptions:n};i.pollForFriends(e,s)},_handleFriendImportCompleted:function f(t){this.hideLoading(),t.data.is_success&&this._redirectToFriendCenter()},_redirectToFriendCenter:function C(){this.navigate(this.addFriendsURL,this.$el,n.GEN.ForceRefreshType.PAGE,{})},_onDismiss:function E(t){"contact"===t.target.id&&(t.target.destroy(),this._onContactsChange())}});d.prototype.className="EmailInviteMerchandising",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(148),r=i(50),l=i(18),h=i(8),d=i(206),c=r.extend({events:{click:"onContactClick","click .dismiss":"onDismissClick"},CssClassName:{DISABLED:"disabled",INVITED:"invited"},onContentReady:function u(){this.data&&(this.email=this.data.id)},onDismissClick:function p(t){var e=n(t.currentTarget.parentElement);return e.hasClass(this.CssClassName.DISABLED)?!1:(this._deleteContact(e),!1)},onContactClick:function _(t){var e=n(t.currentTarget);return e.hasClass(this.CssClassName.DISABLED)?!1:(this.email&&(e.addClass(this.CssClassName.INVITED),this._onContactDisabled(e),a.userInviteEmail(this.email,function(t){t&&this._onInviteSuccess()}.bind(this))),!1)},_onInviteSuccess:function g(){var t={recipients:this.email};this.triggerEvent(s.EVENT_INVITE_USER,t,!0);var e={name:"ActionSuccessToast",id:"inviteSuccessToast",options:{view_type:"inviteContact"},data:{id:this.email}};l.load(e).then(function(t){d.addToast(t)})},_deleteContact:function m(t){var e={emails:[this.email]},i=h.create("UserAddressBookRecommendationsResource",e);return i.callDelete().then(function(){this._onContactDisabled(t)}.bind(this))},_onContactDisabled:function f(t){return t.addClass(this.CssClassName.DISABLED),new Promise(function(t,e){setTimeout(function(){this.triggerEvent(s.EVENT_DISMISS,null,!0),t()}.bind(this),500)}.bind(this))}});c.prototype.className="InviteContact",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(227),r=i(80),l=i(81),h=i(46);i(116),i(525),i(486);var d=o.extend({onCreated:function c(){this.inviteSrc=this.options.invite_src||"homefeed_friend_center_merch",this.recommendationsURL=n.GEN.Settings.FRIEND_CENTER_RECOMMENDATIONS_URL+"?invite_src="+this.inviteSrc},onContentReady:function u(){this.childListen(n.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(n.EVENT_SOCIAL_NETWORK_CONNECTION,this._onSocialNetworkConnect);var t=this.$(".FriendBoardRecommendationTile");if(t.length){var e=n.GEN.ComponentType.DISCOVER_FRIEND_MERCHANDISING_BOARD_RECS;this.$el.attr("data-component-type",e)}var i={};i[n.PUBSUB_TOPIC_VIEW_EVENT_INITIALIZED]=this._logMerchandisingViewEvent,this.pubsubSubscribe(n.PUBSUB_CHANNEL_CONTEXT_LOGGING,i)},onButtonClick:function p(t){var e=t.target,i=e.id;switch(i){case"moreNetworkConnectionsBtn":this._onTransitionClick()}},_onSocialNetworkConnect:function _(t){this.showLoading(!0);var e=t.data.network,i=a.instance(),n={username:h.attributes.username},s={resourceOptions:n};i.pollForFriends(e,s)},_onTransitionClick:function g(){this.$(".networkConnectContainer").addClass("slideIn")},_handleFriendImportCompleted:function m(t){this.hideLoading(),t.data.is_success&&this._redirectToFriendCenter()},_redirectToFriendCenter:function f(){this.navigate(this.recommendationsURL,this.$el,n.GEN.ForceRefreshType.PAGE,{})},_logMerchandisingViewEvent:function C(){var t={event_type:n.GEN.EventType.VIEW_DISCOVER_FRIEND_MERCHANDISING,view_type:n.GEN.ViewType.FEED,view_parameter:n.GEN.ViewParameterType.FEED_HOME,component:parseInt(this.$el.attr("data-component-type"),10)},e=r.fromPlainObject(t);l.getInstance().addEvent(e)}});d.prototype.className="FriendCenterMerchandising",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(115),r=i(50),l=i(595),h=i(35),d=i(14),c=i(8),u=i(17),p=i(104);i(116),i(130);var _=r.extend({events:{"click .submitButton":"onSubmit","click .clearIcon":"onClearAnimation","focus .passwordResetSearch":"onClearAnimation","click .directSendEmail":"onSendEmail"},CssClassName:{HIDDEN:"hidden",EXPANDED:"expanded",SHRUNK:"shrunk",HAS_RESULTS:"hasResults",DIRECT_SEND:"directSend"},downloadWebfont:function g(){var t=/(android)/i.test(navigator.userAgent);t&&n("head").append("<link href='https://fonts.googleapis.com/css?family=Roboto:400,700' rel='stylesheet' type='text/css'>"),this.$el.removeClass("hidden")},onContentReady:function m(){this.downloadWebfont(),this.$form=this.$("form"),this.$header=this.$(".header"),this.$subtitle=this.$(".subtitle"),this.$noEmailAccessMessage=this.$(".noEmail"),this.$noSearchResultMessage=this.$(".noSearchResult"),this.$cantFindAccountMessage=this.$(".cantFindAccount"),this.$buttonDirectSendEmail=this.$(".directSendEmail"),this.$buttonPasswordResetSearch=this.$(".submitButton"),this.$inputPasswordResetSearch=this.$(".passwordResetSearch"),this.$successMessage=this.$(".successMessage"),this.$inputWrapper=this.$(".inputWrapper"),this.$userContainer=this.$(".allResults"),this.$resultsContainer=this.$(".searchResultsContainer"),this.$userSearchContainer=this.$(".userSearchContainer"),this.$emailSentMessage=this.$(".emailSent"),this.$clearIcon=this.$(".clearIcon"),this.form=new a(this.$form,{email:[p.Required(),p.Email()]},{}),this.displayingResults=!1;var t={};t[s.PUBSUB_TOPIC_SEND_PASSWORD_RESET_EMAIL]=this.onSendEmail,this.pubsubSubscribe(s.PUBSUB_CHANNEL_SITE,t)},onSubmit:function f(){var t=this.$inputPasswordResetSearch.val();if(this.$inputPasswordResetSearch.blur(),this.onSubmitAnimation(),this.displayingResults=!0,u.isEmailAddress(t))this.promptSendEmail();else{if(""!==t){var e={scope:"obfuscated_users",query:t,page_size:25},i=this.createSearchResource(e),n=[];return i.callGet({showError:!1}).then(function(t){var e=t.resource_response.data.results;0!==e.length?(this.onSubmitTextChange(),e.forEach(function(t){var e={user:t},i=new l({id:t.username,options:e});n.push(i.render().then(function(){i.getContent().appendTo(this.$userContainer)}.bind(this)).fin(function(){this.$cantFindAccountMessage.removeClass(this.CssClassName.HIDDEN),this.$resultsContainer.hide().show(0),this.$resultsContainer.addClass(this.CssClassName.HAS_RESULTS)}.bind(this)))}.bind(this))):this.onNoResult()}.bind(this),function(t){429===t.http_status&&h.showError(t.message)}).then(function(){return Promise.all(n)})}this.onNoResult()}},createSearchResource:function C(t){return c.create("BaseSearchResource",t)},onNoResult:function E(){this.$cantFindAccountMessage.addClass(this.CssClassName.HIDDEN),this.$noSearchResultMessage.removeClass(this.CssClassName.HIDDEN),this.$resultsContainer.addClass(this.CssClassName.HAS_RESULTS)},onClearAnimation:function v(){if(this.displayingResults){var t=d._("Let&rsquo;s find your Pinterest account"),e=d._("What&rsquo;s your email, name or username?");this.$userContainer.empty(),this.$buttonDirectSendEmail.addClass(this.CssClassName.HIDDEN),this.$header.html(t),this.$subtitle.html(e),this.$emailSentMessage.addClass(this.CssClassName.HIDDEN),this.$noEmailAccessMessage.addClass(this.CssClassName.HIDDEN),this.$clearIcon.addClass(this.CssClassName.HIDDEN),this.$noSearchResultMessage.addClass(this.CssClassName.HIDDEN),this.$cantFindAccountMessage.addClass(this.CssClassName.HIDDEN),this.$resultsContainer.removeClass(this.CssClassName.HAS_RESULTS),this.$resultsContainer.removeClass(this.CssClassName.DIRECT_SEND),this.$inputPasswordResetSearch.val(""),this.$inputWrapper.removeClass(this.CssClassName.EXPANDED),this.$buttonPasswordResetSearch.removeClass(this.CssClassName.SHRUNK),this.displayingResults=!1}},onSubmitAnimation:function I(){this.$clearIcon.removeClass(this.CssClassName.HIDDEN),this.$buttonPasswordResetSearch.addClass(this.CssClassName.SHRUNK),this.$emailSentMessage.addClass(this.CssClassName.HIDDEN),this.$inputWrapper.addClass(this.CssClassName.EXPANDED)},onSubmitTextChange:function T(){var t=d._("Is this you?"),e=d._("We&rsquo;ll send you the info you need.");this.$header.text(t),this.$subtitle.html(e),this.$noEmailAccessMessage.removeClass(this.CssClassName.HIDDEN),this.$emailSentMessage.addClass(this.CssClassName.HIDDEN)},onSendEmail:function N(t,e,i){this.$header.text(d._("Email sent!"));var n;i?n=i.obfuscatedEmail:(n=this.$inputPasswordResetSearch.val(),this.resetPassword(n));var s=d._("We sent a message to {{ obfuscatedEmail }} so you can pick your new password."),o=u.format(s,{obfuscatedEmail:n});this.$noEmailAccessMessage.addClass(this.CssClassName.HIDDEN),this.$buttonDirectSendEmail.addClass(this.CssClassName.HIDDEN),this.$emailSentMessage.removeClass(this.CssClassName.HIDDEN),this.$userSearchContainer.addClass(this.CssClassName.HIDDEN),this.$(".searchResultsScrollContainer").empty(),this.displayingResults=!1,this.$cantFindAccountMessage.addClass(this.CssClassName.HIDDEN),this.$subtitle.text(o),this.$resultsContainer.removeClass(this.CssClassName.HAS_RESULTS),this.$resultsContainer.removeClass(this.CssClassName.DIRECT_SEND)},onSubmitValidated:function S(t){if(!t.errors[0]){var e=this.form.getValue("email");this.resetPassword(e)}},promptSendEmail:function b(){this.$header.text(d._("Reset your password")),this.$subtitle.html(d._("We&rsquo;ll send you the info you need.")),this.$noEmailAccessMessage.removeClass(this.CssClassName.HIDDEN),this.$buttonDirectSendEmail.removeClass(this.CssClassName.HIDDEN),this.$resultsContainer.addClass(this.CssClassName.DIRECT_SEND)},resetPassword:function y(t){var e={username_or_email:t},i=c.create("UserResetPasswordResource",e);i.callCreate({showError:!1})},onSuccess:function P(t){this.$form.hide();var e=u.format(d._("We&rsquo;ll send a message to <strong>{{ email }}</strong> so you can pick your new password."),{email:t});this.$(".messageText").html(e),this.$successMessage.removeClass(this.CssClassName.HIDDEN),this.$successMessage.show()}});_.prototype.className="InitiatePasswordReset",t.exports=o.register(_)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23),r=i(8);i(116);var l=o.extend({events:{"click .sendButton":"resetPassword"},resetPassword:function h(){var t=this.id,e={username_or_email:t},i=r.create("UserResetPasswordResource",e);i.callCreate({showError:!0}).then(function(){var e={username:t,obfuscatedEmail:this.$(".userEmail").text()};a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_SEND_PASSWORD_RESET_EMAIL,e)}.bind(this))}});l.prototype.className="UserSearchResult",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(8);i(116),i(130);var r=o.extend({onCreated:function l(){this.childListen(n.EVENT_BUTTON_CLICK,this.onResetPassword)},onSuccess:function h(){this.$(".message").hide(),this.$(".successMessage").show()},onResetPassword:function d(t){if("resetPasswordButton"===t.target.id){var e={username_or_email:this.options.username_or_email},i=a.create("UserResetPasswordResource",e),n=this.getChildById("resetPasswordButton");n.showLoading(),i.callCreate({showError:!1}).then(function(){this.onSuccess()}.bind(this)).fin(function(){n.hideLoading()})}}});r.prototype.className="PasswordResetOneClick",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(115),l=i(50),h=i(14),d=i(18),c=i(8),u=i(27),p=i(104);i(116);var _="resetPasswordSubmit",g=l.extend({onContentReady:function m(){if(this.data.is_link_valid){var t={new_password:[p.Required(),p.ContainsOnlyAscii({message:h.commonStrings.asciiPasswordError}),p.Password()],new_password_confirm:[p.Required(),p.EqualTo({targetFieldName:"new_password",message:h._("Passwords don't match")})]};this.formListener&&this.removeListener(this.formListener),this.form=new r(this.$("form"),t),this.formListener=this.listen(this.form,o.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)}},onSubmitValidated:function f(t){var e=this.getChildById(_);t.errors[0]||(e.showLoading(!0),this.resetPassword())},resetPassword:function C(){this.hideLoading(!0);var t={new_password:this.form.getValue("new_password"),new_password_confirm:this.form.getValue("new_password_confirm")},e=s.extend(n.clone(this.options),t),i=c.create("ResetPasswordFromEmailResource",e);i.callUpdate().then(function(t){var e=t.resource_response.data;if(e.password_changed){var i={name:"ConfirmDialog",options:{template:"change_password_success"}},n=function s(){u.changeWindowLocation("/login/",!1)};d.load(i).then(function(t){this.showInModal(t),this.listen(t,o.EVENT_CONFIRM,n)}.bind(this))}}.bind(this)).fin(function(){var t=this.getChildById(_);t.hideLoading()}.bind(this))}});g.prototype.className="ResetPasswordPage",t.exports=a.register(g)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(115),r=i(50),l=i(29),h=i(14),d=i(18),c=i(23),u=i(8),p=i(46),_=i(104);i(116);var g="changePasswordSubmit",m=r.extend({onContentReady:function f(){this.$form=this.$("form");var t={message:" "},e={"new":[_.Required(t),_.ContainsOnlyAscii({message:h.commonStrings.asciiPasswordError}),_.Password({samePasswordStr:h._("Oops! Your password shouldn't match your username.")})],new_confirm:[_.Required(t),_.EqualTo({targetFieldName:"new",message:h._("Passwords don't match")})]};this.extraData.has_password&&(e.old=[_.Required(t)]),this.form=new a(this.$form,e),this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated);var i=this.getChildById("forgotPasswordButton");i&&this.listen(i,s.EVENT_BUTTON_CLICK,this.onForgotPasswordClick)},onSubmitValidated:function C(t){var e=this.getChildById(g);t.errors[0]||(e.showLoading(!0),this.changePassword())},changePassword:function E(){this.hideLoading(!0);var t=function(){if(this.isInModal()){var t={name:"ConfirmDialog",options:{template:"change_password_success"}},e=function(){this.triggerEvent("success",this),this.destroy(),c.instance.publish(s.PUBSUB_CHANNEL_SITE,s.PUBSUB_TOPIC_USER_CHANGED_PASSWORD,this.extraData.render_social_networks)}.bind(this);d.load(t).then(function(t){this.showInModal(t),this.listen(t,s.EVENT_CONFIRM,e)}.bind(this))}else this.navigate("/")}.bind(this),e=n("form",this.$el),i={new_password:e.find("[name=new]").val(),new_password_confirm:e.find("[name=new_confirm]").val()};this.extraData.has_password&&(i.old_password=e.find("[name=old]").val());var o=u.create("UserPasswordResource",i);o.callUpdate().then(t).fin(function(){var t=this.getChildById(g);t.hideLoading()}.bind(this))},onForgotPasswordClick:function v(t){l.trackEvent("forgot_password",s.GA_ACTION_CLICK),this.showLoading();var e=u.create("UserResetPasswordResource",{username_or_email:p.attributes.username}),i=function(t){l.trackEvent("forgot_password",s.GA_ACTION_SUCCESS);var e={name:"ConfirmDialog",options:{template:"change_password"}};d.load(e).then(function(t){this.showInModal(t),this.listen(t,s.EVENT_CONFIRM,this.destroy)}.bind(this))}.bind(this),n=function(){this.hideLoading()}.bind(this),o=function a(){l.trackEvent("forgot_password",s.GA_ACTION_ERROR)};e.callCreate({showError:!1}).then(i,o).fin(n)}});m.prototype.className="UserChangePassword",t.exports=o.register(m)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(322),a=i(14),r=i(131),l=i(27);i(300),i(325);var h=o.extend({events:{"click .closeModal":"_onCloseModal"},onContentReady:function d(){this.listen(this,n.EVENT_DISMISS,this._onCloseModal),l.trackRegisterAction("closeup_signup_modal_view"),o.prototype.onContentReady.call(this),this.setMultiStepHeader(".tagline",{step1:this.options.tagline,step2:a._("Looking good! Just a few more details...")})},_onCloseModal:function c(){r.notifyWasDismissed()}});h.prototype.className="CloseupSignupModal",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(322),o=i(19),a=i(31),r=i(27),l=i(323);i(325);var h=s.extend({CssClassName:n.extend(s.prototype.CssClassName,{HAS_IMAGE:"hasImage"}),onContentReady:function d(){this.setupSavePinitLanding(),l.shrinkWrap(),r.trackRegisterAction("pin_it_landing_view")},setupSavePinitLanding:function c(){var t=a.getQueryStringParams(this.options.next),e=t.media,i=this.$(".savePinImg").get(0);i&&(i.src=e,this.$(".savePinText").addClass(this.CssClassName.HAS_IMAGE))}});h.prototype.className="PinItLandingSignup",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(265),a=i(19),r=i(11),l=i(322),h=i(28),d=i(40),c=i(59),u=i(135),p=i(131),_=i(23),g=i(31),m=i(27);i(116),i(130),i(325),i(321);var f=l.extend({events:{"click .continueSignupButton":"onContinueSignup","click .emailSignup":"onContinueSignup","click .textAndButtons .closePlain":"onDismissSignup","click .fullScreenSignup .closePlain":"onDismissSignup"},CssClassName:n.extend(o.prototype.CssClassName,{NO_BANNER:"noBanner",QUARTER_SCREEN_BANNER:"short_variant"===c.instance.v2GetGroup("giftwrap_relax")?"quarterScreenBannerShortVariant":"quarterScreenBanner",HALF_SCREEN_BANNER:"short_variant"===c.instance.v2GetGroup("giftwrap_relax")?"halfScreenBannerShortVariant":"halfScreenBanner",FULL_SCREEN_BANNER:"fullScreenBanner"}),onContentReady:function C(){l.prototype.onContentReady.call(this),this.destroyIfEmpty()||(_.instance.subscribe(r.PUBSUB_CHANNEL_SITE,r.PUBSUB_TOPIC_HIDE_UNAUTH_BANNER,this._onHide.bind(this)),this.childListen(r.EVENT_BUTTON_CLICK,this.onButtonClick),this.$(".emailLogin").attr("href",g.getLoginUrl()),this.childListen(r.EVENT_NAVIGATE,this.onChildNavigate),this.listen(this.getScrollableElement(),r.EVENT_SCROLL,this._onScroll),c.instance.v2ActivateExperiment("tablet_black_banner"),this.bannerHeight=this.CssClassName.NO_BANNER,this.$el.addClass(this.CssClassName.NO_BANNER),c.instance.v2InGroup("lisa_giftwrap_v2",["enabled","employees"])&&this._loadLisaBackgrounds(),"JP"===d.instance.country&&"ja"===d.instance.locale&&null!==c.instance.v2GetGroup("unauth_instructional_video_jp")&&0===c.instance.v2GetGroup("unauth_instructional_video_jp").indexOf("enabled")&&(this.inVideoExperiment=!0,"enabled_autoplay"===c.instance.v2GetGroup("unauth_instructional_video_jp")&&(this.inVideoAutoplay=!0,this.videoPlayedOnce=!1)),m.trackRegisterAction("unuath_banner_loaded"))},_onScroll:function E(){if(!p.naggingAllowed())return void(this.bannerHeight!==this.CssClassName.NO_BANNER&&this.onDismissSignup(null));var t=c.instance.v2GetGroup("giftwrap_relax"),e=this.getScrollableElement().scrollTop(),i=s(window).height()/2;if(i>e&&d.instance.deep_link_action&&d.instance.is_tablet_agent&&(this.bannerHeight=this.CssClassName.NO_BANNER,this.$el.addClass(this.CssClassName.NO_BANNER),this.$el.removeClass(this.CssClassName.QUARTER_SCREEN_BANNER),this.$el.removeClass(this.CssClassName.HALF_SCREEN_BANNER)),!(u.get().hasModals()||this.lockFullScreen||d.instance.deep_link_action&&d.instance.is_tablet_agent&&1e3>e)){this.show();var n="delay"===t?250:0,o=750,a=1200;if("Closeup"===h.instance.options.module.name&&("delay"===t&&(n=500),o=1500,a=2e3),d.instance.deep_link_action&&d.instance.is_tablet_agent&&(o=1500,a=2e3),!(e>a)||d.instance.is_tablet_agent&&c.instance.v2InGroup("tablet_black_banner",["enabled","employee"]))if(!(e>o)||d.instance.is_tablet_agent&&c.instance.v2InGroup("tablet_black_banner",["enabled","employee"])||"no_half_banner"===t){if(this.bannerHeight!==this.CssClassName.QUARTER_SCREEN_BANNER&&e>n){var r=this.$(".textAndButtons");this.bannerHeight===this.CssClassName.FULL_SCREEN_BANNER?this.unShowFullPageTakeover():this.bannerHeight===this.CssClassName.NO_BANNER&&(this.$el.removeClass(this.CssClassName.NO_BANNER),r.fadeOut(0)),this.bannerHeight=this.CssClassName.QUARTER_SCREEN_BANNER,this.$el.addClass(this.CssClassName.QUARTER_SCREEN_BANNER),this.$el.removeClass(this.CssClassName.NO_BANNER),this.$el.removeClass(this.CssClassName.HALF_SCREEN_BANNER),this.$el.removeClass(this.CssClassName.FULL_SCREEN_BANNER),r.delay(500).fadeIn(),m.trackRegisterAction("unauth_banner_quarter_screen")}}else this.bannerHeight!==this.CssClassName.HALF_SCREEN_BANNER&&(this.bannerHeight===this.CssClassName.FULL_SCREEN_BANNER&&this.unShowFullPageTakeover(),this.bannerHeight=this.CssClassName.HALF_SCREEN_BANNER,this.$el.addClass(this.CssClassName.HALF_SCREEN_BANNER),this.$el.removeClass(this.CssClassName.NO_BANNER),this.$el.removeClass(this.CssClassName.FULL_SCREEN_BANNER),this.$el.removeClass(this.CssClassName.QUARTER_SCREEN_BANNER),m.trackRegisterAction("unauth_banner_half_screen"));else this.bannerHeight!==this.CssClassName.FULL_SCREEN_BANNER&&this.showFullPageTakeover()}},showFullPageTakeover:function v(){this.bannerHeight=this.CssClassName.FULL_SCREEN_BANNER,this.$el.addClass(this.CssClassName.FULL_SCREEN_BANNER),this.$el.removeClass(this.CssClassName.NO_BANNER),this.$el.removeClass(this.CssClassName.HALF_SCREEN_BANNER),this.$el.removeClass(this.CssClassName.QUARTER_SCREEN_BANNER),this.$(".textAndButtons").fadeOut(250),this.$(".fullScreenSignup").delay(500).fadeIn(250),this.inVideoAutoplay&&!this.videoPlayedOnce&&(this.videoPlayedOnce=!0,this._startVideo()),m.trackRegisterAction("unauth_banner_full_screen")},unShowFullPageTakeover:function I(){this.$(".fullScreenSignup").fadeOut(250),this.$(".textAndButtons").delay(500).fadeIn(250),this.bannerHeight=this.CssClassName.HALF_SCREEN_BANNER,this.inVideoExperiment&&this._stopVideo()},onContinueSignup:function T(t){m.trackRegisterAction("unauth_banner_continue_click"),d.instance.is_tablet_agent&&c.instance.v2InGroup("tablet_black_banner",["enabled","employee"])?this.navigate(r.GEN.Settings.CANONICAL_MAIN_URL,{trigger:!0,replace:!0}):(this.showFullPageTakeover(),this.lockFullScreen=!0)},onDismissSignup:function N(){var t=null;switch(this.bannerHeight){case this.CssClassName.QUARTER_SCREEN_BANNER:t=this.$(".textAndButtons");break;case this.CssClassName.HALF_SCREEN_BANNER:t=this.$(".textAndButtons");break;case this.CssClassName.FULL_SCREEN_BANNER:t=this.$(".fullScreenSignup"),this.inVideoExperiment&&this._stopVideo()}null!==t&&(p.notifyWasDismissed(),t.fadeOut(250),this.$el.removeClass(this.CssClassName.HALF_SCREEN_BANNER),this.$el.removeClass(this.CssClassName.QUARTER_SCREEN_BANNER),this.$el.removeClass(this.CssClassName.FULL_SCREEN_BANNER),this.$el.addClass(this.CssClassName.NO_BANNER),this.bannerHeight=this.CssClassName.NO_BANNER,this.lockFullScreen=!1)},onButtonClick:function S(t){var e=t.target;"emailSignup"===t.target.id&&(this.navigate(g.appendQueryString(e.getNavigateUrl(),{prev:window.location.href})),t.stopPropagation())},onChildNavigate:function b(t){this.inVideoExperiment&&this._stopVideo(),(-1!==t.data.url.indexOf("/login/")||-1!==t.data.url.indexOf("/join/"))&&(t.data.url=g.appendQueryString(t.data.url,{prev:window.location.pathname})),t.data.url===r.GEN.Settings.CANONICAL_MAIN_URL&&d.instance.is_tablet_agent&&c.instance.v2InGroup("tablet_black_banner",["enabled","employee"])&&this.triggerEvent(r.EVENT_HEADER_INTERSTITIAL_DISMISSED,null,!0)},_loadLisaBackgrounds:function y(){this.$(".lisaBackground1").addClass("bgImage"),this.$(".lisaBackground2").addClass("bgImage"),this.$(".lisaBackground3").addClass("bgImage")},_startVideo:function P(){var t=this.$(".inspiredSearchInstructionalVideo iframe"),e=t.attr("src").replace("autoplay=0","autoplay=1");t.attr("src",e)},_stopVideo:function B(){var t=this.$(".inspiredSearchInstructionalVideo iframe"),e=t.attr("src").replace("autoplay=1","autoplay=0");t.attr("src",e)},_onHide:function A(){this.inVideoExperiment&&this._stopVideo(),this.hide()}});f.prototype.className="UnauthBanner",t.exports=a.register(f)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23);i(603);var r=o.extend({onAddedToDom:function l(){a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NAG_STATE,!1)},onRemovedFromDom:function h(){a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NAG_STATE,!0)}});r.prototype.className="UserRegisterPage",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(322),r=i(131),l=i(27);i(325);var h=a.extend({events:{"click .closeModal":"closeModal"},CssClassName:n.extend(a.prototype.CssClassName,{SECOND_STEP:"secondStep"}),onContentReady:function d(){this.listen(this,s.EVENT_DISMISS,this.closeModal),l.trackRegisterAction("plain_signup_modal_view"),a.prototype.onContentReady.call(this)},closeModal:function c(){this.triggerEvent(s.EVENT_CLOSE_SIGNUP_OVERLAY,null,!0),r.notifyWasDismissed()}});h.prototype.className="PlainSignupModal",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(23);i(130);var r=o.extend({onAddedToDom:function l(){a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NAG_STATE,!1)},onRemovedFromDom:function h(){a.instance.publish(n.PUBSUB_CHANNEL_SITE,n.PUBSUB_TOPIC_NAG_STATE,!0)}});
r.prototype.className="UserRegisterRestricted",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(606),a=i(23),r=i(8),l=i(34),h=10,d=500,c=o.extend({numChecks:0,onContentReady:function u(){},_checkHomeFeedRebuildStatus:function p(){var t,e=function i(){a.instance.publish(n.PUBSUB_CHANNEL_TUTORIAL,n.PUBSUB_TOPIC_TUTORIAL_NEXT)};t=r.create("OrientationContextStatusResource",{redo_homefeed:this.options.is_nux===!1}),this.numChecks+=1,t.callGet({showError:!1}).then(function(t){e()},function(t){this.numChecks<=h?l.setTimeout(this._checkHomeFeedRebuildStatus.bind(this),d):e()}.bind(this))},onShow:function _(t){l.setTimeout(this._checkHomeFeedRebuildStatus.bind(this),d),o.prototype.onShow.call(this,t)}});c.prototype.className="BuildingHomeFeedSpinner",t.exports=s.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(57),a=i(50),r=i(170);i(116),i(518);var l=a.extend({onCreated:function h(){this.childListen(n.EVENT_BUTTON_CLICK,this._onButtonClick);var t={};t[n.PUBSUB_TOPIC_TUTORIAL_NEXT]=function(){this.triggerEvent(n.EVENT_NEXT,null,!0)},this.pubsubSubscribe(n.PUBSUB_CHANNEL_TUTORIAL,t),this.initializeStep(),this.isContextualExperience=!1,r.log("growth.tutorial_step_module."+this.className)},initializeStep:function d(){},onEnter:function c(t){t&&t()},onShow:function u(t){t&&t()},onRemoved:function p(){},onExit:function _(t){t&&t()},onButtonClick:function g(t){},_onButtonClick:function m(t){var e=t.target;e&&(this.onButtonClick(t),t.shouldPropagate()&&("previousButton"===e.id?(t.stopPropagation(),this.onPreviousButtonClicked()):"nextButton"===e.id?(t.stopPropagation(),this.onNextButtonClicked()):"dismissButton"===e.id&&(t.stopPropagation(),this.onDismissButtonClicked())))},onDismissButtonClicked:function f(){this.triggerEvent(n.EVENT_DISMISS,null,!0)},onPreviousButtonClicked:function C(){this.triggerEvent(n.EVENT_PREVIOUS,null,!0)},onNextButtonClicked:function E(){this.triggerEvent(n.EVENT_NEXT,null,!0)},getExperienceId:function v(){return null},getPlacementId:function I(){return null},getPlacedExperienceId:function T(){return this.isContextualExperience?o.instance.constructPlacedExperienceId(this.getPlacementId(),this.getExperienceId()):null},completePlacedExperience:function N(){var t=o.instance;return this.getPlacedExperienceId()?t.completePlacedExperienceId(this.getPlacedExperienceId()):t.completePlacedExperience(this.getPlacementId(),this.getExperienceId())},isDismissAsync:!0,dismissPlacedExperience:function S(){var t=o.instance;return this.getPlacedExperienceId()?t.dismissPlacedExperienceId(this.getPlacedExperienceId(),this.isDismissAsync):t.dismissPlacedExperience(this.getPlacementId(),this.getExperienceId(),this.isDismissAsync)},onTutorialComplete:function b(){},setExperienceViewed:function y(){var t=o.instance;this.getPlacedExperienceId()?t.viewPlacedExperienceId(this.getPlacedExperienceId()):t.viewPlacedExperience(this.getPlacementId(),this.getExperienceId())}});l.prototype.className="StepBase",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(608),a=i(28),r=o.extend({getPlacementId:function l(){return n.GEN.Placement.ANALYTICS_AUDIENCE_DASHBOARD_TAKEOVER},getExperienceId:function h(){return n.GEN.Experience.ANALYTICS_AUDIENCE_SELECTOR_USER_ED},getHighlightedElement:function d(){var t=this._getModuleChildrenByModuleName(a.instance,"SelectButtonWrapper");return this._highlightModule(t[0],!0)},onShow:function c(t){var e=this.getHighlightedElement();e&&this.setModalPosition("BOTTOM_CENTER",e,!0),t&&t()}});r.prototype.className="ModalAnalyticsAudienceSelectorIntro",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(8),r=i(606),l=i(126),h=i(19);i(116),i(518);var d="tutorialHighlightMask",c="tutorialHighlightBackground",u="href",p=r.extend({CssClassName:n.extend(r.prototype.CssClassName,{TUTORIAL_HIGHLIGHT:"tutorialHighlight"}),highlightedElements:{},initializeStep:function _(){this.listen(l,o.EVENT_RESIZE,this.onResize)},disableCloneLinks:function g(t){var e=t.find("a");n.each(e,function(t){var e=s(t),i=e.attr(u);e.attr("data-href",i).removeAttr(u)})},disableButtonCloneLinks:function m(t){t.removeAttr(u)},setModalPosition:function f(t,e,i,n){var s="VIEWPORT_MIDDLE";t&&e&&(s="ANCHORED",this.modal.options.position_point=t,this.modal.options.anchor=e),e&&0===e.length&&this.sendLogging(),this.modal.options.position_mode=s,void 0!==n&&(this.modal.options.fixed=n),this.modal.options.caret=!0,i&&this.modal.positionModule()},sendLogging:function C(){var t={uri:"/v3/callback/frontend/",method:"POST",params:{event:"tooltip_no_anchor."+this.toString(),sample_rate:1}},e=JSON.parse(JSON.stringify(t));e.params.event="tooltip_anchor_module."+this.toString();var i={requests:[t,e]},n=a.create("BatchRequestResource",i);n.callCreate({showError:!1})},setCloneInteractions:function E(t){var e=s("body"),i=s('<div class="'+d+'"/>');i.addClass(this.CssClassName.TUTORIAL_HIGHLIGHT),e.append(i),t.$mask=i,this.disableCloneLinks(t)},setCloneBackground:function v(t){var e=s("body"),i=s('<div class="'+c+'"/>');i.addClass(this.CssClassName.TUTORIAL_HIGHLIGHT),e.append(i),t.$background=i},setCloneDimensions:function I(t,e){var i=e.outerWidth()+1,n=e.outerHeight()+1;t.css({width:i,height:n,"box-sizing":"border-box"})},ensurePath:function T(t){window.location.pathname!==t&&this.navigate(t)},cleanHighlightedElements:function N(){s("."+this.CssClassName.TUTORIAL_HIGHLIGHT).remove(),this.highlightedElements={}},_getModuleChildById:function S(t,e){var i=t._childrenIdMap[e];if(i)return i;for(var n,s=0,o=t.children.length;o>s;s++)if(n=t.children[s],i=this._getModuleChildById(n,e))return i},_getModuleChildrenByModuleName:function b(t,e){var i=[];return n.each(t.children,function(t){t.className===e&&i.push(t),i=i.concat(this._getModuleChildrenByModuleName(t,e))}.bind(this)),i},_highlightModule:function y(t,e){return this._highlightElement(t.cid,t.$el,e)},_highlightElement:function P(t,e,i){var n;if(i){n=e.clone(),n.$origin=e,n.attr("id",t),n.addClass(this.CssClassName.TUTORIAL_HIGHLIGHT),this.highlightedElements[t]=n;var o=s("body");o.append(n),this.options.has_background&&this.setCloneBackground(n),void 0!==this.options.disable_mask&&this.options.disable_mask||this.setCloneInteractions(n),this.setCloneDimensions(n,e),this.positionClone(n)}else n=this.highlightedElements[t],n&&(n.remove(),delete this.highlightedElements[t]);return n},positionClone:function B(t){var e=t.$origin.parents().addBack();e.css("animation-duration","0s"),n.defer(function(){var i=t.$origin.offset();i={top:i.top,left:i.left};var n=i.top-s(window).scrollTop();n>0&&(i.top=n),t.css(i);var o=s.extend({},i,{height:t.outerHeight(),width:t.outerWidth()});t.$mask&&t.$mask.css(o),t.$background&&(this.options.background_class&&t.$background.addClass(this.options.background_class),t.$background.css(o)),this.modal&&this.modal.positionModule(),e.css("animation-duration","")}.bind(this))},onResize:function A(){n.each(this.highlightedElements,this.positionClone.bind(this))},onRemoved:function R(){this.cleanHighlightedElements()}});p.prototype.className="ModalStepBase",t.exports=h.register(p)},function(t,e,i){"use strict";var n=i(610),s=i(19),o=n.extend({getStepPosition:function a(){return"RIGHT_CENTER"},getHighlightedElement:function r(){return this.getHighlightedCardModule("audience")}});o.prototype.className="ModalAnalyticsHomeAudienceCardIntro",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(608),a=i(28),r=o.extend({getPlacementId:function l(){return n.GEN.Placement.ANALYTICS_HOME_TAKEOVER},getExperienceId:function h(){return n.GEN.Experience.ANALYTICS_HOME_USER_ED},getHighlightedCardModule:function d(t){var e=this._getModuleChildrenByModuleName(a.instance,"HomePageAnalyticsCard"),i=null;switch(t){case"profile":i=e[0];break;case"audience":i=e[1];break;case"domain":i=e[2]}return i?this._highlightModule(i,!0):null},getStepPosition:function c(){},getHighlightedElement:function u(){throw new Error("must be overridden")},onShow:function p(t){var e=this.getHighlightedElement();e?this.setModalPosition(this.getStepPosition(),e,!0):this.setModalPosition(null,null,!0),t&&t()}});r.prototype.className="ModalAnalyticsHomeIntroBase",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(610),s=i(19),o=n.extend({getStepPosition:function a(){return"LEFT_CENTER"},getHighlightedElement:function r(){return this.getHighlightedCardModule("domain")}});o.prototype.className="ModalAnalyticsHomeDomainCardIntro",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(610),s=i(19),o=n.extend({getStepPosition:function a(){return null},getHighlightedElement:function r(){return null}});o.prototype.className="ModalAnalyticsHomeOverallIntro",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(610),s=i(19),o=n.extend({getStepPosition:function a(){return"RIGHT_CENTER"},getHighlightedElement:function r(){return this.getHighlightedCardModule("profile")}});o.prototype.className="ModalAnalyticsHomeProfileCardIntro",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(615),s=i(19),o=i(28),a=n.extend({onShow:function r(){this.actionBar=this._getModuleChildById(o.instance,"actions"),this.modalPosition="BOTTOM_LEFT",this.actionBar&&(this.actionButton=this._getModuleChildById(this.actionBar,this.options.anchor_id),this.actionButton||(this.actionButton=this._getModuleChildById(o.instance,this.options.anchor_id),this.modalPosition="TOP_RIGHT"),this.highlightActionButton())}});a.prototype.className="ModalFirstPinClickthrough",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(608),a=i(28);i(116);var r=o.extend({onShow:function l(){this.actionBar=this._getModuleChildById(a.instance,"actions"),this.modalPosition="BOTTOM_LEFT",this.actionBar&&(this.actionButton=this._getModuleChildById(this.actionBar,this.options.anchor_id),this.highlightActionButton())},onButtonClick:function h(t){var e=t.target;"nextButton"===e.id&&this.actionButton.$el.trigger("click")},isDismissAsync:!1,highlightActionButton:function d(){if(this.actionButton){this.options.disable_mask=!0;var t=this._highlightModule(this.actionButton,!0);this.modal.options.caret_style="fpxBlue",this.disableButtonCloneLinks(t),t.on("click",function(){this.triggerEvent(n.EVENT_NEXT,null,!0),this.actionButton.$el.trigger("click")}.bind(this)),this.setModalPosition(this.modalPosition,t,!0),this.$el.css("display","block")}}});r.prototype.className="ModalFirstPinExperience",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(608),r=i(126),l=i(28),h=a.extend({CssClassName:n.extend(a.prototype.CssClassName,{FIRST_PIN_INTRO_HIGHLIGHT:"firstPinIntroHighlight",MODAL_PIN_INTRO:"modalPinIntro"}),onCreated:function d(){a.prototype.onCreated.apply(this,arguments),this.listen(r,s.EVENT_BODY_COLUMN_CHANGE,this.onBodyColumnChange)},onShow:function c(t){this.highlightPin(),t&&t()},highlightPin:function u(){if(this.pin=this.getTargetPin(),this.pin){var t=this._highlightModule(this.pin,!0);t.remove(),this.modal.getModalScroller().append(t),this.$repinButton=t.find(".repinSmall"),this.$repinButton.on("click",this.onRepinClicked.bind(this)),this.modal.$el.addClass(this.CssClassName.MODAL_PIN_INTRO),this.setModalPosition("LEFT_TOP",this.$repinButton,!0),t.addClass(this.CssClassName.FIRST_PIN_INTRO_HIGHLIGHT)}},setCloneInteractions:function p(t){this.disableCloneLinks(t)},getTargetPin:function _(){var t=this._getModuleChildrenByModuleName(l.instance,"Grid")[0];if(t){var e=t.getGridItems(),i=Math.ceil(r.numColumns/2);return e.getChildModuleAtIndex(i,"Pin")}},onBodyColumnChange:function g(){this.$repinButton.off(),this.$repinButton=null,this.cleanHighlightedElements(),this.highlightPin()},onRepinClicked:function m(){this.triggerEvent(s.EVENT_PREVIOUS,null,!0);var t=this.pin.getChildById("pinItButton");t.$el.trigger("click")},getPlacementId:function f(){return s.GEN.Placement.WEB_HOME_TAKEOVER},getExperienceId:function C(){return s.GEN.Experience.WEB_FIRST_PIN_USER_ED}});h.prototype.className="ModalFirstPinIntro",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(608),r=i(28),l=a.extend({CssClassName:n.extend(a.prototype.CssClassName,{SEE_PROFILE_INTRO_HIGHLIGHT:"seeProfileIntroHighlight"}),onShow:function h(t){var e=this._getModuleChildrenByModuleName(r.instance,"UserMenu")[0];if(this.noUserMenu=!e,this.noUserMenu){var i=this._getModuleChildById(r.instance,"userMenu"),n=this._highlightModule(i,!0);this.setModalPosition("BOTTOM_RIGHT",n,!0)}else e.setSticky(!0),e.showDropdown(function(){e.getDropdown().getContentModulePromise().then(function(e){var i=e.getMyBoardsElement(),n=this._highlightElement("highlightContainer",i,!0);n.addClass(this.CssClassName.SEE_PROFILE_INTRO_HIGHLIGHT),n.on("click",function(){this.triggerEvent(s.EVENT_NEXT,null,!0)}.bind(this)),this.setModalPosition("LEFT_TOP",n,!0),t&&t()}.bind(this))}.bind(this))},onExit:function d(t){if(!this.noUserMenu&&r.instance){var e=this._getModuleChildrenByModuleName(r.instance,"UserMenu")[0];e.setSticky(!1),e.hideDropdown()}t&&t()},getPlacementId:function c(){return s.GEN.Placement.WEB_HOME_TAKEOVER},getExperienceId:function u(){return s.GEN.Experience.WEB_YOUR_BOARDS_USER_ED}});l.prototype.className="ModalSeeProfileIntro",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(57),r=i(619),l=i(23),h=i(8),d=i(34);i(151);var c=1500,u=r.extend({CssClassName:n.extend(r.prototype.CssClassName,{HIDDEN:"hidden"}),onAddedToDom:function p(){this.childListen(s.EVENT_ITEM_CLICK,this.onInterestClick)},onInterestClick:function _(t){var e=t.data||{},i=e.url_name;n.contains(this.selectedInterests,i)?this.selectedInterests=n.without(this.selectedInterests,i):this.selectedInterests.push(i),this._notifyProgressBar()},_notifyProgressBar:function g(){l.instance.publish(s.PUBSUB_CHANNEL_TUTORIAL,s.PUBSUB_TOPIC_TUTORIAL_MINI_NEXT,{type:"interest",total:this.selectedInterests.length})},initializeStep:function m(){this.selectedInterests=[]},onExit:function f(t){var e=this.selectedInterests.join(",");if(e){var i=this.nuxProgress.getNextButton();i.showLoading();var n=this.nuxProgress.$skip;n.addClass(this.CssClassName.HIDDEN);var s=function(){d.setTimeout(function(){t&&(t(),i.hideLoading(),n.removeClass(this.CssClassName.HIDDEN))}.bind(this),c)}.bind(this);this.signalFollowedInterests(e,s)}else t&&t()},signalFollowedInterests:function C(t,e){var i={interests:t};a.instance.isPlacedExperience(s.GEN.Placement.WEB_HOME_TAKEOVER,s.GEN.Experience.WEB_REBUILD_FEED)&&(i.redo_homefeed=!0);var n=h.create("OrientationContextResource",i);n.callCreate().then(e)}});u.prototype.className="NewUserInterestPicker",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(1),s=i(606),o=i(19),a=i(28),r=s.extend({CssClassName:n.extend(s.prototype.CssClassName,{HIDDEN:"hidden"}),onContentReady:function l(){this.nuxProgress=a.instance.getChildById("nuxProgress"),this.nuxProgress.initializeProgress({module:this})},hideStepHeader:function h(){this.$(".newUserStepHeader").addClass(this.CssClassName.HIDDEN)}});r.prototype.className="NewUserStepBase",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(619),a=i(606),r=i(23),l=i(34),h=5e3,d=o.extend({onShow:function c(t){this.nuxProgress&&this.nuxProgress.endMandatoryFlow(),l.setTimeout(this._goToNextStep,h),a.prototype.onShow.call(this,t)},_goToNextStep:function u(){r.instance.publish(n.PUBSUB_CHANNEL_TUTORIAL,n.PUBSUB_TOPIC_TUTORIAL_NEXT)}});d.prototype.className="NewUserSetupSpinner",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(619),s=i(19);i(116);var o=n.extend({onButtonClick:function a(t){var e=t.target;e.disable(),this.$(".spinner").show()}});o.prototype.className="NewUserWelcome",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(57),l=i(195),h=i(125),d=i(623),c=i(14),u=i(23),p=i(8),_=i(17),g=i(34),m=i(27);i(324),i(116);var f=d.extend({onContentReady:function C(){var t,e,i,s,o;if("final_loading"===this.options.view_type){if(g.setTimeout(this._checkHomeFeedReady.bind(this),1500),t=this.extraData.truncateLength,e=l.instance().tutorial,i=e?e.getStorage("interest_follow_count"):0,s=this.getChildByModuleName("List"),i>t&&s.children.length===t){o=n.last(s.children);var a=_.format(c._("+{{ num }} more interests"),{num:i-t+1});o.showOverflowMask(a)}this.numCheckHomefeedReadyChecks=0,this.maxCheckHomefeedReadyChecks=10}else if("brio_final_loading"===this.options.view_type||"fullScreen"===this.options.view_type){t=this.extraData.truncateLength,e=l.instance().tutorial,i=e?e.getStorage("interest_follow_count"):0,i||(i=0);var r=i>t||0===i;if(s=this.getChildById("interestsList"),r&&s.children.length===t){o=n.last(s.children);var u=c._("+more");o.showOverflowMask(u)}var p=e?e.getStorage("friend_ids_followed"):[];if(p&&p.length>0){var m=p.length,f=n.first(p,t),C=new h({id:"friendsList",options:{items:f,item_options:{view_type:"imageOnlyThumb"}}});C.render().then(function(){this.insertChild(C,this.$(".followingFriendsListWrapper"));var e=this.getChildById("friendsList");if(m>t&&e.children.length===t){var i=n.last(e.children),s=c._("+more");i.showOverflowMask(s)}}.bind(this))}else this.$(".followingFriendsListWrapper").css("visibility","hidden");this.homefeedReadyCheckInitialDuration=1500,this.homefeedReadyCheckDuration=5e3,this.maxCheckHomefeedReadyChecks=10,this.numCheckHomefeedReadyChecks=0,this.homefeedReadyCheckMaxDuration=this.homefeedReadyCheckInitialDuration+this.maxCheckHomefeedReadyChecks*this.homefeedReadyCheckDuration,this.homefeedReadyCheckCurrentTotalDuration=this.homefeedReadyCheckInitialDuration+this.numCheckHomefeedReadyChecks*this.homefeedReadyCheckDuration;var E=(this.homefeedReadyCheckCurrentTotalDuration/this.homefeedReadyCheckMaxDuration*100).toString()+"%";this.$(".progressBar").animate({width:E},this.homefeedReadyCheckInitialDuration,function(){this._checkHomeFeedReady()}.bind(this))}this._ensureInterestListLoadedWithContent().fin(function(){d.prototype.onContentReady.call(this)}.bind(this))},_ensureInterestListLoadedWithContent:function E(){var t=Promise.resolve(),e=this.getChildById("interestsList");if(e&&e.isEmpty()){var i=l.instance().tutorial,s=i?i.getStorage("interest_follow_ids"):[];n.isEmpty(s||[])||(e.setResource(void 0),e.updateOptions({items:n.map(s,function(t){return{id:t,type:"interest"}})})),t=e.render()}return t},numCheckHomefeedReadyChecks:0,_checkHomeFeedReady:function v(){var t=p.create("OrientationContextStatusResource",{});this.numCheckHomefeedReadyChecks+=1,t.callGet({showError:!1}).then(function(t){this._refreshExperiencesAndGrid()}.bind(this),function(t){if(this.numCheckHomefeedReadyChecks<=this.maxCheckHomefeedReadyChecks)if("final_loading"===this.options.view_type)this.numChecks<=10&&g.setTimeout(this._checkHomeFeedReady.bind(this),500);else{this.homefeedReadyCheckMaxDuration=this.homefeedReadyCheckInitialDuration+this.maxCheckHomefeedReadyChecks*this.homefeedReadyCheckDuration,this.homefeedReadyCheckCurrentTotalDuration=this.homefeedReadyCheckInitialDuration+this.numCheckHomefeedReadyChecks*this.homefeedReadyCheckDuration;var e=(this.homefeedReadyCheckCurrentTotalDuration/this.homefeedReadyCheckMaxDuration*100).toString()+"%";this.$(".progressBar").animate({width:e},this.homefeedReadyCheckDuration,function(){this._checkHomeFeedReady()}.bind(this))}else this._refreshExperiencesAndGrid()}.bind(this))},_refreshExperiencesAndGrid:function I(){return r.instance.refreshPlacedExperiences().fin(this._refreshGrid.bind(this))},_refreshGrid:function T(){var t=s(".AuthHomePage").length>=1,e=n.isUndefined(this.options.refresh_grid)?!0:this.options.refresh_grid;t&&e?(m.scrollToTop({}),u.instance.publish(o.PUBSUB_CHANNEL_CURRENT_USER,o.PUBSUB_TOPIC_HOMEFEED_REFRESH,{callback:this._goToNextStep.bind(this)})):this._goToNextStep()},_goToNextStep:function N(){if("brio_final_loading"!==this.options.view_type&&"fullScreen"!==this.options.view_type)this.triggerEvent(o.EVENT_NEXT,null,!0);else{var t;t="fullScreen"===this.options.view_type?"70%":"100%";var e=[this.$(".progressBar").animate({width:t},1500)];s.when.apply(s,e).always(function(){this.triggerEvent(o.EVENT_NEXT,null,!0)}.bind(this))}}});f.prototype.className="NuxModalCompassStep",t.exports=a.register(f)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(195),a=i(59),r=i(606),l=i(14),h=i(18);i(116);var d=r.extend({events:{"click .optionalSkip":"onSkipClick"},onContentReady:function c(){var t=this.getChildById("nuxModalDismissButton");t&&this.listen(t,n.EVENT_BUTTON_CLICK,this.onDismiss)},onSkipClick:function u(){"enabled_skip"===a.instance.v2GetGroup("remove_extension_upsell")?this._goToNextStep():this._launchSkipConfirmDialog()},_launchSkipConfirmDialog:function p(){var t=this.options.skip_message?this.options.skip_message:l._("Are you sure you want to skip this step?"),e={name:"ConfirmDialog",options:{title:l._("Skip this step?"),body_message:t,dismiss_button_text:l._("Go back"),button_text:l._("Skip"),template:"generic"}};h.load(e).then(function(t){this.showInModal(t,{mask_type:"dark",can_dismiss:!1}),this.listen(t,n.EVENT_CONFIRM,this._goToNextStep)}.bind(this))},onNextButtonClicked:function _(){var t=this.getChildById("nextButton");t&&t.showLoading(),r.prototype.onNextButtonClicked.call(this)},getExperienceId:function g(){return this.options.experienceID},getPlacementId:function m(){return this.options.placementID},onDismiss:function f(t){o.instance()._dismiss()}});d.prototype.className="NuxModalStepBase",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(623),a=i(23);i(625),i(626),i(627);var r=o.extend({_goToNextStep:function l(){a.instance.publish(n.PUBSUB_CHANNEL_TUTORIAL,n.PUBSUB_TOPIC_TUTORIAL_NEXT)}});r.prototype.className="NuxModalInstallExtensionContainer",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(623),l=i(232),h=i(81),d=i(23),c=i(27);i(116);var u=a.extend({onContentReady:function p(){r.prototype.onContentReady.call(this);var t=this.getChildById("installButton");t&&this.listen(t,s.EVENT_BUTTON_CLICK,this.onInstallButtonClick),h.getInstance().logCustomViewEvent(s.GEN.ViewType.SAVE,s.GEN.ViewParameterType.EXTENSION_UPSELL_NUX),"fullScreen"===this.options.view_type&&window.setTimeout(function(){this._goToNextStep()}.bind(this),4800)},onInstallButtonClick:function _(){c.trackRegisterAction("browser_extension_install_clicked"),l.handleExtensionInstall(this._goToNextStep)},_goToNextStep:function g(){if("fullScreen"===this.options.view_type){var t=[this.$(".progressBar").animate({width:"100%"},1500)];n.when.apply(n,t).always(function(){d.instance.publish(s.PUBSUB_CHANNEL_TUTORIAL,s.PUBSUB_TOPIC_TUTORIAL_NEXT)})}else d.instance.publish(s.PUBSUB_CHANNEL_TUTORIAL,s.PUBSUB_TOPIC_TUTORIAL_NEXT)},_skipInstall:function m(){c.trackRegisterAction("browser_extension_skipped"),this._goToNextStep()}});u.prototype.className="NuxModalInstallExtension",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(625),a=i(232),r=i(34);i(116);var l=o.extend({onContentReady:function h(){o.prototype.onContentReady.call(this),this.installButton=this.getChildById("installButton"),this.continueButton=this.getChildById("continueButton"),this.listen(this.continueButton,n.EVENT_BUTTON_CLICK,this._goToNextStep),this.continueButton.hide()},onInstallButtonClick:function d(){a.handleExtensionInstall(function(){}),this.installButton.hide(),this.continueButton.show(),this.$(".optionalSkip").hide(),this.continueButton.showLoading(!0),r.setTimeout(function(){this.continueButton.hideLoading()}.bind(this),3e3)}});l.prototype.className="NuxModalInstallExtensionFirefox",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(625),a=i(14);i(116);var r=o.extend({onContentReady:function l(){o.prototype.onContentReady.call(this),this.installButton=this.getChildById("installButton"),this.continueButton=this.getChildById("continueButton"),this.listen(this.continueButton,n.EVENT_BUTTON_CLICK,this._goToNextStep),this.continueButton.hide()},openSafariExtensionWindow:function h(){var t=window.open("https://extensions.apple.com/details/?id=com.pinterest.extension-HWZFLG9PNK","_blank");t&&t.focus()},onInstallButtonClick:function d(){this.installButton.hide(),this.continueButton.show(),this.$(".optionalSkip").hide(),this.$(".extensionUpsellWrapper").hide(),this.$(".headerTitle").text(a._('In the new tab, click on "Install Now"')),this.$(".headerSubTitle").hide(),this.$(".opensInNewTab").css("visibility","hidden"),this.$(".extensionUpsellSafariAfterInstallWrapper").show(),this.openSafariExtensionWindow()}});r.prototype.className="NuxModalInstallExtensionSafari",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(21),a=i(194),r=i(19),l=i(11),h=i(57),d=i(195),c=i(143),u=i(623),p=i(175),_=i(59),g=i(14),m=i(8),f=i(17),C=i(46),E=i(27);i(116),i(151),i(178);var v=u.extend({events:{'textchange input[type="text"]':"_onSearchTextUpdate","click .clearSearch":"_clearSearch"},CssClassName:n.extend(u.prototype.CssClassName,{VISIBILE:"visible",HIDDEN:"hidden",DISABLE_SCROLL:"disableScroll"}),nuxInterests:[],recommendedInterests:[],currentInterestFollowingStatus:[],onCreated:function I(){this.options.state_recTitleHidden=!0,this.options.state_recHidden=!0,this.options.state_noResultsHidden=!0,this.options.state_noResultsText="",this.options.state_disableScroll=!1,u.prototype.onCreated.call(this)},updateDom:function T(){this.$recommendedTitles.toggleClass(this.CssClassName.HIDDEN,!!this.options.state_recTitleHidden),this.$recommendedGrid.toggleClass(this.CssClassName.HIDDEN,!!this.options.state_recHidden),this.$noResultsDiv.toggleClass(this.CssClassName.HIDDEN,!!this.options.state_noResultsHidden),this.$noResultsDiv.html(this.options.state_noResultsText),this.$gridWrapper.toggleClass(this.CssClassName.DISABLE_SCROLL,!!this.options.state_disableScroll)},onContentReady:function N(){this._setup(),u.prototype.onContentReady.call(this)},_setup:function S(){var t=h.instance.getPlacedExperienceType(l.GEN.Placement.WEB_HOME_TAKEOVER);this.inNux=t===l.GEN.ExperienceType.NUX,this._throttledSyncBothInterestCaches=n.throttle(this._syncBothInterestCaches.bind(this),200),this.nextButton=this.getChildById("nextButton"),this.grid=this.getChildById("grid"),this.$gridWrapper=this.$(".gridWrapper"),this.$recommendedGrid=this.$(".recommended"),this.$recommendedTitles=this.$(".recommendedTitle"),this.$noResultsDiv=this.$(".noResults"),this.separateRecommended=!0,this.interestsSearchField=this.getChildById("interestsSearchField"),this.interestFollowChange=!1,this.$clearSearchEm=this.$(".clearSearch em"),this.syncInterestsCacheAndGridUI().then(function(){"fullScreen"!==this.options.view_type&&this.updateNextButton()}.bind(this));var e={field_set_key:"blur",resource_name:"InterestTypeaheadResource"};this._typeahead=new p(e),this.listen(this._typeahead,l.EVENT_DATA,this._onTypeaheadData),this.listen(this._typeahead,l.EVENT_TYPEAHEAD_SEARCH_START,this._onSearchStart),this.childListen(l.EVENT_INTEREST_FOLLOW,this._onInterestFollowClick),this.childListen(l.EVENT_INTEREST_UNFOLLOW,this._onInterestUnfollowClick),this.options.disable_scroll&&this.disableScroll()},allowScroll:function b(){this.updateOptionsAndDom({state_disableScroll:!1})},disableScroll:function y(){this.updateOptionsAndDom({state_disableScroll:!0})},getEmptySearchResultsFromCache:function P(){var t=n.filter(this.currentInterestFollowingStatus,function(t){return t.followingStatus}),e=n.pluck(t,"interest"),i=n.reject(e,function(t){return t.is_recommended}),s=n.pluck(t,"id"),o=n.reject(this.nuxInterests,function(t){return n.contains(s,t.id)});return this.separateRecommended&&this.recommendedExperiment?i.concat(o):e.concat(o)},getRecommendedResultsFromCache:function B(){var t=n.filter(this.currentInterestFollowingStatus,function(t){return t.followingStatus}),e=n.pluck(t,"interest"),i=n.reject(e,function(t){return!t.is_recommended}),s=n.pluck(t,"id"),o=n.reject(this.recommendedInterests,function(t){return n.contains(s,t.id)});return i.concat(o)},syncInterestsCacheAndGridUI:function A(){return this.grid.showLoading(),this._throttledSyncBothInterestCaches().then(function(){this.inNux&&this.recommendedExperiment&&this.createInterestModulesAndReplaceGrid(this.getRecommendedResultsFromCache(),this.recommended_grid,"recommended"),this.createInterestModulesAndReplaceGrid(this.getEmptySearchResultsFromCache(),this.grid,"other")}.bind(this))},_syncBothInterestCaches:function R(){var t=[this._syncFollowedInterestsCache(),this._syncNUXInterestsCache()];return Promise.all(t).then(function(){})},_syncFollowedInterestsCache:function w(){var t=m.create("InterestFollowingResource",{username:C.get("username")}),e=[],i=function s(i){var o=i.resource_response.data;return n.isArray(o)&&(e=e.concat(o)),t.atEnd()?Promise.resolve(e):t.callGet().then(s)};return t.callGet().then(i).then(function(t){this.currentInterestFollowingStatus=[],n.each(t,function(t){this.currentInterestFollowingStatus.push({id:t.id,interest:t,followingStatus:!0,logData:n.has(t,"log_data")?t.log_data:null})}.bind(this))}.bind(this))},_syncNUXInterestsCache:function O(){var t=m.create("UserInterestsResource",{blend_type:"nux",sort:"ranked",board:o.get(l.COOKIE_LAST_UNAUTH_BOARD_ID),interest:o.get(l.COOKIE_LAST_UNAUTH_INTEREST_ID),profile:o.get(l.COOKIE_LAST_UNAUTH_PROFILE_ID),pin:o.get(l.COOKIE_LAST_UNAUTH_PIN_ID),field_set_key:"grid_item_nux"});return t.callGet().then(function(t){for(var e=t.resource_response.data,i=!1,s=0;s<e.length;s++){var o=e[s];if(o.is_recommended){i=!0;break}}if(n.isArray(e))if(this.inNux&&i){this.recommended_grid=this.getChildById("recommended_grid");var a=_.instance.v2GetGroup("recommended_interest_picker2");if(this.recommendedExperiment=n.contains(["employees","enabled"],a),this.recommendedExperiment&&this.separateRecommended){for(var r=0;r<e.length;r++){var l=e[r];l.is_recommended?this.recommendedInterests.push(l):this.nuxInterests.push(l)}this.updateOptionsAndDom({state_recTitleHidden:!1,state_recHidden:!1})}else this.nuxInterests=e}else this.nuxInterests=e}.bind(this))},_onSearchStart:function D(t){this.$clearSearchEm.removeClass(this.CssClassName.VISIBILE),this.interestsSearchField.showLoading(!1,this.$(".clearSearch"))},_onTypeaheadData:function x(t){if(this.interestsSearchField.hideLoading(),this._searchFieldIsEmpty()||this.$clearSearchEm.addClass(this.CssClassName.VISIBILE),!t.term||this._getSearchText()===t.term){if(t.term){if(n.isEmpty(t.items)){var e=f.format(g._("Sorry! We couldn't find <b>{{ searchTerm }}</b>."),{searchTerm:n.escape(t.term)});this.updateOptionsAndDom({state_noResultsHidden:!1,state_noResultsText:e}),this.inNux&&!n.isEmpty(this.recommendedInterests)&&this.separateRecommended&&(this.updateOptionsAndDom({state_recTitleHidden:!1,state_recHidden:!1}),this.createInterestModulesAndReplaceGrid(this.getRecommendedResultsFromCache(),this.recommended_grid,"recommended")),this.createInterestModulesAndReplaceGrid(this.getEmptySearchResultsFromCache(),this.grid,"other")}else this.createInterestModulesAndReplaceGrid(t.items,this.grid,"other"),this.updateOptionsAndDom({state_recTitleHidden:!0,state_recHidden:!0,state_noResultsHidden:!0});this.logToContextLog(t.term,!n.isEmpty(t.items))}else this._searchFieldIsEmpty()&&(this.inNux&&!n.isEmpty(this.recommendedInterests)&&this.separateRecommended&&(this.updateOptionsAndDom({state_recTitleHidden:!1,state_recHidden:!1}),this.createInterestModulesAndReplaceGrid(this.getRecommendedResultsFromCache(),this.recommended_grid,"recommended")),this.createInterestModulesAndReplaceGrid(this.getEmptySearchResultsFromCache(),this.grid,"other"),this.updateOptionsAndDom({state_noResultsHidden:!0}));E.scrollToTop({})}},_createInterestModuleAndPrependToGrid:function L(t,e,i){var n=this.options.view_type,s="brio"===n||"fullScreen"===n?"homefeedSetupViewNoFollowButton":"homefeedSetupView",o=new c({data:t,options:{view_type:s,show_mask:!0}});return"recommended"===i?o.renderExistingData().then(function(){
this.recommended_grid.getGridItems().prependChildItem(o)}.bind(this)):o.renderExistingData().then(function(){this.grid.getGridItems().prependChildItem(o)}.bind(this))},createInterestModulesAndReplaceGrid:function k(t,e,i){e.emptyItems();for(var n=[],s=t.length-1;s>=0;s--)n.push(this._createInterestModuleAndPrependToGrid(t[s],e,i));Promise.all(n).then(function(){e.hideLoading()})},_searchFieldIsEmpty:function U(){return n.isEmpty(this._getSearchText())},_getSearchText:function M(){var t=s.trim(this.$("input[type='text']").val());return t.replace(/'/g,"`")},_onInterestFollowClick:function F(t){var e=t.data||{};this._onInterestClick(e,!0)},_onInterestUnfollowClick:function $(t){var e=t.data||{};this._onInterestClick(e,!1)},_onInterestClick:function H(t,e){if(!this._searchFieldIsEmpty()&&this.separateRecommended&&(this.separateRecommended=!1,this.nuxInterests=this.recommendedInterests.concat(this.nuxInterests),this.recommendedInterests=[]),this._invalidateTypeaheadCacheForInterestSearchTerm(),n.has(t,"is_followed")){var i=n.find(this.currentInterestFollowingStatus,function(e){return e.id===t.id});i&&(this.currentInterestFollowingStatus=n.reject(this.currentInterestFollowingStatus,function(e){return e.id===t.id})),this.currentInterestFollowingStatus.unshift({id:t.id,interest:t,followingStatus:e,logData:n.has(t,"log_data")?t.log_data:null});var s=n.find(this.nuxInterests,function(e){return e.id===t.id});s&&(s.is_followed=e),this.interestFollowChange=!0,"fullScreen"===this.options.view_type?this.updateBottomBanner():this.updateNextButton()}},_invalidateTypeaheadCacheForInterestSearchTerm:function V(){var t=this._getSearchText();if(t){this._getTypeahead().removeCacheForTerm(t);var e=t.split(" ");e.length>=2&&n.each(e,function(t){this._getTypeahead().removeCacheForTerm(t)}.bind(this));for(var i=t.substring(0,t.length-1);i;)this._getTypeahead().removeCacheForTerm(i),i=i.substring(0,i.length-1)}},_getTypeahead:function G(){return this._typeahead},updateFollowCount:function W(){var t=d.instance().tutorial;t&&t.setStorage("interest_follow_count",this.getNumFollowedInterests())},addBanner:function K(){var t=new a({id:"bottomBanner",options:{banner_text:this.options.banner_text}});return t.render().then(function(){this.insertChild(t,this.$(".contentWrapper")),this.bottomBanner=this.getChildById("bottomBanner"),this.updateBottomBanner()}.bind(this))},getNumFollowedInterests:function j(){var t=n.filter(this.currentInterestFollowingStatus,function(t){return t.followingStatus});return t.length},getMinNumToFollow:function Y(){return this.inNux?5:1},updateNextButton:function q(){var t=this.getMinNumToFollow(),e=t-this.getNumFollowedInterests(),i;e>0?(i=1===e?g._("Follow 1 more"):f.format(g._("Follow {{ numToFollow }} more"),{numToFollow:e}),this.nextButton.setText(i),this.nextButton.disable()):(i=g._("Done"),this.nextButton.setText(i),this.nextButton.enable()),this.nextButton.show()},updateBottomBanner:function z(){var t=this.getMinNumToFollow(),e=t-this.getNumFollowedInterests(),i;e>0?(i=1===e?g._("Pick 1 more"):e===t?f.format(g._("Pick {{ numToFollow }} (or more!)"),{numToFollow:e}):f.format(g._("Pick {{ numToFollow }} more"),{numToFollow:e}),this.bottomBanner&&(this.bottomBanner.setText(i),this.bottomBanner.hideButton(),this.bottomBanner.notDone())):this.bottomBanner&&(this.bottomBanner.hideText(),this.bottomBanner.showButton(),this.bottomBanner.isDone())},_clearSearch:function X(){this.$("input").val(""),this._onSearchTextUpdate()},_onSearchTextUpdate:function Q(){this._getTypeahead().search(this._getSearchText()),this._searchFieldIsEmpty()?this.$clearSearchEm.removeClass(this.CssClassName.VISIBILE):this.interestsSearchField.isLoading()||this.$clearSearchEm.addClass(this.CssClassName.VISIBILE)},onNextButtonClicked:function Z(){this.updateFollowCount();var t=Promise.resolve();if(this.currentInterestFollowingStatus&&this.interestFollowChange){var e,i=n.reject(this.currentInterestFollowingStatus,function(t){return!t.followingStatus}),s=n.pluck(i,"id");if(this._storeFollowedInterestIds(s),this.inNux){var o=n.pluck(i,"logData");e={interests:s.join(),log_data:JSON.stringify(o),referrer:"nux"};var a=m.create("OrientationContextResource",e);t=a.callCreate()}else{var r=n.object(n.pluck(this.currentInterestFollowingStatus,"id"),n.pluck(this.currentInterestFollowingStatus,"followingStatus"));e={updated_interest_follows:r};var l=m.create("UpdateFollowedInterestsResource",e),h=m.create("OrientationRefreshHomefeedResource");t=Promise.all([l.callUpdate(),h.callUpdate()])}}t.then(function(){u.prototype.onNextButtonClicked.call(this)}.bind(this))},_storeFollowedInterestIds:function J(t){var e=d.instance().tutorial;e&&e.setStorage("interest_follow_ids",t)},logToContextLog:function tt(t,e){var i={entered_query:t,results_exist:e};this._logCustomContextEvent(l.GEN.EventType.SEARCH_INTERESTS,l.GEN.ElementType.SEARCH_BOX_TEXT_INPUT,l.GEN.ComponentType.INTEREST_PICKER,i)}});v.prototype.className="NuxModalInterestPicker",t.exports=r.register(v)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(630),a=i(126),r=[{transition:{scale:.6,opacity:0}},{transition:{opacity:.7},time:550,timingFuction:"linear"},{transition:{opacity:.7},time:800},{transition:{scale:.45},time:150,timingFunction:"cubic-bezier(0.1, 0.55, 0.95, 0.5)"},{transition:{scale:.6},time:150,timingFunction:"linear"},{transition:{opacity:0},time:750,timingFunction:"cubic-bezier(0.42, 0.0, 1.0, 1.0)"}],l=[{transition:{scale:.8,opacity:0}},{transition:{scale:.8,opacity:0},time:1450},{transition:{opacity:.6},time:150,timingFunction:"linear"},{transition:{scale:1.2,opacity:0},time:800,timingFunction:"linear"}],h=o.extend({onContentReady:function d(){this.options.append_to&&this.$el.parent().appendTo(this.options.append_to),this._positionPulser(),this.$innerCircle=this.$(".innerCircle"),this.$outerCircle=this.$(".outerCircle"),this.$innerCircle.css(r[0].transition),this.$outerCircle.css(l[0].transition),this.options.fixed&&this.$el.addClass(this.CssClassName.FIXED),this.$el.css("visibility","visible"),this._playAnimation(),window.setInterval(this._playAnimation.bind(this),3e3),this.listen(a,n.EVENT_RESIZE,this._positionPulser),this.listen(a,n.EVENT_BODY_COLUMN_CHANGE,this._positionPulser)},_playAnimation:function c(){this._playInnerAnimation(),this._playOuterAnimation()},_playInnerAnimation:function u(){this.$innerCircle.css(r[0].transition),r.slice(1).forEach(function(t){this.$innerCircle=this.$innerCircle.transition(t.transition,t.time,t.timingFunction).delay()}.bind(this))},_playOuterAnimation:function p(){this.$outerCircle.css(l[0].transition),l.slice(1).forEach(function(t){this.$outerCircle=this.$outerCircle.transition(t.transition,t.time,t.timingFunction).delay()}.bind(this))}});h.prototype.className="TwoCirclesPulser",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(141),l=i(126),h=i(23),d=[{transition:{scale:.5,opacity:1}},{transition:{scale:.6,opacity:1},time:200,timingFunction:"cubic-bezier(0, 0.55, 0.55, 1.0)"},{transition:{scale:.4},time:200,timingFunction:"cubic-bezier(0, 0.55, 0.55, 1.0)"},{transition:{scale:.8,opacity:0},time:1400,timingFunction:"cubic-bezier(0, 0.5, 0, 1)"}],c=a.extend({events:{click:"_onClick",mousedown:"_onMousedown"},CssClassName:{FIXED:"fixed"},onContentReady:function u(){this._positionPulser(),this.$(".pulserImage").css(d[0].transition),this.options.fixed&&this.$el.addClass(this.CssClassName.FIXED),this.$el.css("visibility","visible"),this._playAnimation(),window.setInterval(this._playAnimation.bind(this),2e3),this.listen(l,s.EVENT_RESIZE,this._positionPulser),this.listen(l,s.EVENT_BODY_COLUMN_CHANGE,this._positionPulser)},_positionPulser:function p(){var t=this.options.anchor;t&&r.positionElementAtAnchor(this.$el,n(t),s.PositionPoint.CENTER_CENTER,!!this.options.fixed,!1,!!this.options.append_to)},_onClick:function _(){this.options.close_on_mousedown||this.triggerEvent(s.EVENT_PULSER_CLICKED,null,!0)},_onMousedown:function g(){this.options.close_on_mousedown&&(this.triggerEvent(s.EVENT_PULSER_CLICKED,null,!0),h.instance.publish(s.PUBSUB_CHANNEL_TUTORIAL,s.EVENT_PULSER_MOUSEDOWN,{}))},_playAnimation:function m(){var t=this.$(".pulserImage");t.css(d[0].transition),d.slice(1).forEach(function(e){t=t.transition(e.transition,e.time,e.timingFunction).delay()})}});c.prototype.className="Pulser",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(195),a=i(320),r=a.extend({onContentReady:function l(){this.manager=o.instance(),this.childListen(n.EVENT_NEXT,this.manager._next.bind(this.manager)),this.childListen(n.EVENT_PREVIOUS,this.manager._previous.bind(this.manager)),this.childListen(n.EVENT_DISMISS,this.manager._dismiss.bind(this.manager))}});r.prototype.className="UserEducationGuide",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(195),a=i(50);i(116);var r=a.extend({events:{"click .guide":"onClickGuide"},onContentReady:function l(){var t={};t[n.PUBSUB_TOPIC_TUTORIAL_TRIGGER_ACTIVE]=this._onTutorialTriggerActive,this.pubsubSubscribe(n.PUBSUB_CHANNEL_TUTORIAL,t)},onClickGuide:function h(t){if(this.triggerEvent(n.EVENT_DISMISS,null,!0),this.options.guides&&0!==this.options.guides.length){var e=this.options.guides[0];e.showFlyout=!1,e.display_data.trigger="automatic",o.instance().startTutorial(e)}},_onTutorialTriggerActive:function d(t,e,i){return i?this.options.guides=[i]:this.options.guides=[],this.render()}});r.prototype.className="UserEducationGuideDropdown",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(634);i(116);var r=30,l=10,h=a.extend({CssClassName:n.extend(a.prototype.CssClassName,{ACTIVE:"active"}),onContentReady:function d(){this.childListen(s.EVENT_BUTTON_CLICK,function(t){var e=t.target;e&&("nextButton"===e.id?(t.stopPropagation(),this.updateCardsForNextStep().then(function(){this.triggerEvent(s.EVENT_NEXT,null,!0)}.bind(this))):"dismissButton"===e.id&&(t.stopPropagation(),this.$el.removeClass(this.CssClassName.ACTIVE),window.setTimeout(function(){this.triggerEvent(s.EVENT_DISMISS,null,!0)}.bind(this),500)))}),window.setTimeout(function(){this.$el.addClass(this.CssClassName.ACTIVE)}.bind(this),200)},updateCardsForNextStep:function c(){return new Promise(function(t,e){var i=this.$(".guideStepContent:first-child");i.appendTo(this.$(".cardPositionAnimation.cardPosition")).transition({y:350,rotate:this._getRotateAngle(),visibility:"hidden"},800,"ease",function(){i.remove(),t(void 0)})}.bind(this))},_getRotateAngle:function u(){var t=Math.random()*r;return l>t&&(t=l),Math.random()<.5&&(t*=-1),t+"deg"}});h.prototype.className="UserEducationGuideStacked",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(116);var o=n.extend({});o.prototype.className="UserEducationGuideStep",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(606),l=i(18),h=r.extend({CssClassName:n.extend(r.prototype.CssClassName,{HIDE_CARD:"hideCard"}),onContentReady:function d(){var t=this.options.step_type,e=t===o.StepTypes.TOOLTIP,i=e?"UserEducationGuideStep":"UserEducationGuideStacked",n=this.getCardModuleLoadOptions(i),a=this.getCardPositionModuleLoadOptions(i),r=e?a:n;l.load(r).then(function(t){this.guideModule=t,this.appendChild(t),t.render()}.bind(this)),this.options.anchor&&(this.loadPulser(),this.childListen(o.EVENT_PULSER_CLICKED,function(){this.currentPulser&&(this.currentPulser.destroy(),this.currentPulser=null),this.goToNextStep(),s(this.options.anchor).click()}),s(this.options.anchor).on("click.userEducationGuideAnchor",function(){this.goToNextStep()}.bind(this)))},goToNextStep:function c(){s(this.options.anchor).off("click.userEducationGuideAnchor"),this.guideModule.$el.find(".guideStepContent").addClass(this.CssClassName.HIDE_CARD),window.setTimeout(function(){this.triggerEvent(o.EVENT_NEXT,null,!0)}.bind(this),200)},onShow:function u(t){this.isContextualExperience=!0,t&&t()},getCardModuleLoadOptions:function p(t){var e={name:t,options:{body_html:this.options.body_html,stacked_cards:this.options.stacked_cards,step_type:this.options.step_type,anchor:this.options.anchor}};return e},getCardPositionModuleLoadOptions:function _(t){var e={name:"UserEducationGuideTooltip",options:{module:this.getCardModuleLoadOptions(t),anchor:this.options.anchor,position_mode:"ANCHORED",position_point:this.options.position_point,hide_caret:!0,class_name:"active",fixed:!!this.options.fixed}};return e},loadPulser:function g(){var t={name:"Pulser",options:{anchor:this.options.anchor,fixed:!!this.options.fixed,close_on_mousedown:this.options.close_on_mousedown}};l.load(t).then(function(t){this.appendChild(t),t.render(),this.currentPulser=t}.bind(this))},getExperienceId:function m(){return this.options.experienceID},getPlacementId:function f(){return this.options.placementID}});h.prototype.className="UserEducationGuideStepBase",t.exports=a.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(140),a=i(19),r=i(126),l=i(18),h=o.extend({CssClassName:n.extend(o.prototype.CssClassName,{CARET_ON_LEFT:"caretOnLeft",CARET_IN_MIDDLE:"caretInMiddle",CARET_ON_RIGHT:"caretOnRight"}),onContentReady:function d(){var t=r,e=s(this.options.anchor),i=e.offset().left+e.outerWidth()/2;i>t.width*(2/3)?this.$el.addClass(this.CssClassName.CARET_ON_RIGHT):i<t.width*(1/3)?this.$el.addClass(this.CssClassName.CARET_ON_LEFT):this.$el.addClass(this.CssClassName.CARET_IN_MIDDLE)},render:function c(){return new Promise(function(t,e){this.renderContainer();var i=function(){this.contentReady=!0,this.onContentReady(),t()}.bind(this);this.options.module?l.load(this.options.module).then(function(t){this.insertChild(t,this.getPositionElement()),t.render().then(function(){this.positionModule(),i()}.bind(this))}.bind(this)):i()}.bind(this))}});h.prototype.className="UserEducationGuideTooltip",t.exports=a.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=o.extend({events:{click:"onClick"},onClick:function r(){this.triggerEvent(n.EVENT_TRIGGER_FLYOUT_CLICKED,null,!0)}});a.prototype.className="UserEducationTriggerCard",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(115),r=i(50),l=i(132),h=i(18),d=i(8),c=i(46),u=i(27),p=i(104);i(324),i(116),i(117);var _=r.extend({CssClassName:{CANCEL_CONVERT:"cancelConvert"},onContentReady:function g(){if(u.trackRegisterAction("create_business_account_loaded"),c.isAuthenticated())if(c.attributes.is_partner)this.navigate(s.GEN.Settings.PARTNER_GET_STARTED);else if("create"===this.options.view_type){var t={name:"ConfirmDialog",options:{template:"confirm_create_a_business"}};h.load(t).then(function(t){this.showInModal(t),this.listen(t,s.EVENT_DIALOG_BUTTON_CLICKED,this.onConfirmClick)}.bind(this))}var e={account_type:[p.Required()],business_name:[p.Required()],website_url:[p.URL()]};"create"===this.options.view_type&&(e.password=[p.Password(),p.Required()],e.email=[p.Email({}),p.Required()]);var i={};this.$form=this.$("form"),this.form=new a(this.$form,e,i),this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function m(t){if(!t.errors[0]){var e=this.getChildById("submitButton"),i=this.form.getData();if(e.showLoading(),"create"===this.options.view_type)u.trackRegisterAction("create_business_submit_clicked"),l.register("partner",i).then(function(t){u.trackRegisterAction("create_business_signup_success"),this.log.debug("Signup success:",t),this.triggerEvent(s.EVENT_USER_REGISTER,{},!0)&&(window.location="/")}.bind(this)).fin(function(t){e.hideLoading()});else{var n=d.create("PartnerResource",i);n.callUpdate().fin(function(){e.hideLoading()}).then(function(){this.navigate(s.GEN.Settings.PARTNER_GET_STARTED)}.bind(this))}}},onConfirmClick:function f(t){var e=n(t.data),i="";e.hasClass(this.CssClassName.CANCEL_CONVERT)?i="/":e.hasClass("continueConvert")&&(i="/logout/?next="+s.GEN.Settings.PARTNER_GET_STARTED),this.navigate(i)}});_.prototype.className="BusinessAccountCreate",t.exports=o.register(_)},function(t,e,i){"use strict";var n=i(218),s=i(19),o=i(11),a=i(50),r=i(29);i(640),i(548),i(567);var l=a.extend({events:{"click .partnerCreateBoard":"createBoard"},createBoard:function h(){return r.trackEvent("board_create",o.GA_ACTION_OPEN_MODAL),this.showBoardCreateModal(),!1},showBoardCreateModal:function d(){var t=new n({options:{}});this.showInModal(t)}});l.prototype.className="BusinessGetStarted",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(2),s=i(641),o=i(19),a=i(50),r=i(47),l=i(8),h=i(642);i(116),i(130),i(173);var d=a.extend({events:{"click .dismiss":"onDismissClick"},onContentReady:function c(){var t="6013056087942",e=968689080,i="NeuUCJjtygkQuIv0zQM",n="l550e";r.injectTrackingPixel(t),s.pingGoogleConversion(e,i),h.injectTrackingPixel(n)},onDismissClick:function u(t){var e=n(t.target),i=e.parents(".getStartedCard"),s=i.data("card-name"),o=l.create("PartnerCardResource",{card_name:s});o.callDelete(),i.remove()}});d.prototype.className="BusinessGetStartedCards",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(21),s=i(11),o=i(9),a=i(46),r="983308403",l="BAZXCN218AYQ87Dw1AM",h=function c(t){var e=new Image;t+="&cache_bust="+Date.now(),e.src=t},d={};d.trackConversions=function(){a.isAuthenticated()&&n.get(s.COOKIE_USER_JUST_REGISTERED)&&(d.pingGoogleConversion(r,l),d.pingFacebookConversion(),n.unset(s.COOKIE_USER_JUST_REGISTERED))},d.pingGoogleConversion=function(t,e){h("https://www.googleadservices.com/pagead/conversion/"+t+"/?value=0&label="+e+"&guid=ON&script=0")},d.pingFacebookConversion=function(){h("https://www.facebook.com/offsite_event.php?id=6016714330942&value=0&currency=USD")},t.exports=o.expose("AdTracking",d)},function(t,e,i){"use strict";var n=i(48),s={injectTrackingPixel:function o(t){if(void 0!==window.twttr)window.twttr.conversion.trackPid(t);else{var e="twttr";n.load([],"//platform.twitter.com/oct.js",e),n.ready(e,function(){void 0!==window.twttr&&window.twttr.conversion.trackPid(t)})}}};t.exports=s},function(t,e,i){"use strict";var n=i(125),s=i(19),o=n.extend({});o.prototype.className="CampbellMenuList",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(173),i(645);var o=n.extend({});o.prototype.className="DrawerSideNav",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=i(18),a=n.extend({onClick:function r(t){t.stopPropagation(),this.showLoading();var e={name:"DomainVerify",options:{prepend_main_url:!0},resource:{name:"DomainVerifyResource",options:{}}};o.load(e).then(function(t){this.hideLoading();var e={show_api_error:!0};this.showInModal(t,e)}.bind(this))}});a.prototype.className="VerifyWebSiteButton",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({});o.prototype.className="Editorial",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="PartnerHomepage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(276),a=i(80),r=i(81);i(649),i(650);var l=o.extend({onContentReady:function h(){this._logDisplayState()},_logDisplayState:function d(){var t="",e=this.$(".performanceStatsAnalytics");if(e.length>0){var i=e.find(".performanceStatsHighlight"),s=i.text().trim().replace(/[\d,\.]+\s+/,"").charAt(0);t+=s+":";var o=this.$(".performanceStatsTrend");if(o.length>0){var l=o.find(".performanceDeltaIndicator");t+=9652===l.text().trim().charCodeAt(0)?"u":"d"}else t+="x"}else t+="x";t+="-";var h=this.$(".partnerPerformanceTopPins");if(h.length>0){var d=h.find("li");t+=d.length+":";for(var c=0;c<d.length;++c){c>0&&(t+=",");var u=d.eq(c).find(".topPinInfo").text().trim();t+="."===u.charAt(0)?"0":"n",t+=u.match(/clickthrough/)?"c":u.match(/repin/)?"r":"i",t+=u.match(/rate/)?"r":"c"}}else t+="x";var p=this.$(".heroBasicContainer").data("component-type");if(p){var _={component:p,element:n.GEN.ElementType.PARTNER_PERFORMANCE_STATS,event_type:n.GEN.EventType.VIEW,view_type:n.GEN.ViewType.FEED,view_parameter:n.GEN.ViewParameterType.FEED_HOME},g=a.fromPlainObject(_);g.updateAuxData({value:t}),r.getInstance().addEvent(g)}}});l.prototype.className="PartnerPerformanceHero",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(276),s=i(19);i(116);var o=n.extend({});o.prototype.className="PartnerPerformanceHeroPins",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(276),s=i(19),o=n.extend({});o.prototype.className="PartnerPerformanceHeroStats",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(316),s=i(19),o=n.extend({});o.prototype.className="PromotedPinAbandonmentHero",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(115),a=i(50),r=i(18),l=i(23),h=i(72),d=i(8),c=i(46);i(116),i(653);var u=a.extend({onContentReady:function p(){this.form=new o(this.$("form"),{}),this.listen(this.form,n.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},getBoardPicker:function _(){return this.getChildById("boardPicker")},getBoardId:function g(){return this.getBoardPicker().getSelectedBoardId()},onSubmitValidated:function m(){var t=this.getBoardId(),e=d.create("BulkEditResource",{board_id:t,pin_ids:this.options.pin_ids});this.options.action_type===n.BulkAction.MOVE?e.callUpdate({showError:!0}).then(function(){for(var e=this.options.pin_ids,i=0;i<e.length;i++)l.instance.publish(e[i],n.PUBSUB_TOPIC_PIN_DELETED);l.instance.publish(t,n.PUBSUB_TOPIC_BULK_PINS_CREATED),this.showSuccessModal(t),l.instance.publish(n.PUBSUB_CHANNEL_BULK_EDIT,n.PUBSUB_TOPIC_TOGGLE_BULK_EDIT,n.EXIT_BULK_EDIT)}.bind(this)):this.options.action_type===n.BulkAction.COPY&&e.callCreate({showError:!0}).then(function(){l.instance.publish(t,n.PUBSUB_TOPIC_BULK_PINS_CREATED),this.showSuccessModal(t),l.instance.publish(t,n.PUBSUB_TOPIC_BULK_PINS_CREATED),l.instance.publish(n.PUBSUB_CHANNEL_BULK_EDIT,n.PUBSUB_TOPIC_TOGGLE_BULK_EDIT,n.EXIT_BULK_EDIT)}.bind(this))},showSuccessModal:function f(t){var e=d.create("BoardResource",{board_id:t,field_set_key:"grid_item",user_name:c.get("username")});e.callGet().then(function(t){var e=t.resource_response.data,i={id:"pinSuccess",name:"PinCreateSuccess",options:{action:this.options.action_type,board_name:e.name,board_category:e.category,board_id:e.id,board_url:e.url,is_collaborative:e.is_collaborative,is_extension_installed:!0,privacy:e.privacy,is_bulk_action:!0}};this.showLoading(),r.load(i).then(function(t){this.modal&&this.modal.setSubmodule(t)}.bind(this));var n=this.getBoardPicker(),s=d.clone(n.resource);h.instance.callGet(s)}.bind(this))}});u.prototype.className="BulkBoardPicker",t.exports=s.register(u)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(171),r=i(654),l=i(52),h=a.extend({CssClassName:n.extend(a.prototype.CssClassName,{PRIMARY:"primary"}),onCreated:function d(){a.prototype.onCreated.call(this),this._selectedBoard=null,this.childListen(s.EVENT_CHANGE,this._onChildChange),this.childListen(s.EVENT_DROPDOWN_HIDE,this._onChildDropdownHide)},onContentReady:function c(){this.extraData&&(this._selectedBoard=this.extraData.selectedBoard),a.prototype.onContentReady.call(this),this.extraData.noBoards&&l.deferDomManipulation(function(){var t=this.$el;r.showNoBoardsTooltip(t)}.bind(this))},getContentModuleLoadOptions:function u(){var t={name:"BoardPicker",options:{view_type:"compact",in_popover:!0},resource:{name:this.resource.name,options:this.resource.options}};return this.options.selected_board_id?t.options.selected_board_id=this.options.selected_board_id:(t.options.selected_section_index=0,t.options.selected_item_index=0),t},getSelectedBoardId:function p(){return this._selectedBoard?this._selectedBoard.id:null},getSelectedBoardPrivacy:function _(){return this._selectedBoard?this._selectedBoard.privacy:null},_onChildChange:function g(t){t.stopPropagation(),this._selectedBoard=t.data,this.options.selected_board_id=this._selectedBoard.id;var e=this._getLabelModule();e.data=this._selectedBoard,e.renderExistingData(),this.hideDropdown(),this.$el.removeClass(this.CssClassName.PRIMARY),this.triggerEvent(s.EVENT_CHANGE,t.data,!0),this.$el.blur()},_onChildDropdownHide:function m(t){var e=this.getDropdown().getContentModule();e.clearName()}});h.prototype.className="BoardPickerDropdownButton",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(138),a=i(14),r={showNoBoardsTooltip:function l(t){if(t.length){var e=new o({options:{anchor:t,class_name:"large aboveModal",fixed:!0,position_point:"TOP_CENTER",text:a._("<strong>You collect your Pins on boards</strong> so everything's nice and organized."),mouse_close_mode:"always"}});e.render().then(function(){s("body").append(e.$el),n.defer(function(){e.positionModule(),e.fadeIn()})})}}};t.exports=r},function(t,e,i){"use strict";var n=i(656),s=i(19),o=n.extend({});o.prototype.className="EmbedBoard",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19),a=s.extend({onContentReady:function r(){n("head").append(n("<script></script>").attr({async:!0,src:"//assets.pinterest.com/js/pinit.js"}));var t=this.$(".sampleCode textarea");t.focus(),t.select()}});a.prototype.className="Embed",t.exports=o.register(a)},function(t,e,i){"use strict";var n=i(656),s=i(19),o=n.extend({});o.prototype.className="EmbedPinner",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(35),l=i(14),h=i(8),d=i(27),c=i(323);i(217);var u=a.extend({onCreated:function p(){this.childListen(s.EVENT_NAVIGATE,this.onChildNavigate),this.childListen(s.EVENT_IMAGE_LOAD_ERROR,this._onImageError)},onContentReady:function _(){this.resizeWindowToFit(),this._isPinFave()&&window.opener.postMessage("pinterestReady","*")},onAddedToDom:function g(){this._windowMessageListener=this.listen(n(window),"message",this.onWindowMessage)},onRemovedFromDom:function m(){this._windowMessageListener&&(this.removeListener(this._windowMessageListener),this._windowMessageListener=null)},_parseDataUri:function f(t){var e=/^data:(.+\/.+);(.+),(.*)$/,i=t.match(e);return i?{contentType:i[1],encoding:i[2],payload:i[3]}:null},onWindowMessage:function C(t){var e=t.originalEvent.data;if(e&&"pinImageData"===e.type){var i=e.dataUri;if(!i)return void r.showError(l._("Missing image data"));var n=this._parseDataUri(i);if(!n)return void r.showError(l._("Invalid image data uri"));if("base64"!==n.encoding)return void r.showError(l._("The image data URI uses an unsupported encoding"));var s=h.create("ImagePreviewResource",{content_type:n.contentType,base64_payload:n.payload});s.callCreate().then(function(t){var e=t.resource_response.data.image_url;this._setImage(e)}.bind(this))}},_isPinFave:function E(){return!this.options.image_url&&this.options.is_pin_fave&&window.opener},_setImage:function v(t){this.options.image_url=t;var e=this.getChildById("pinCreate");e.setImage(t)},_onImageError:function I(t){if(this.options.is_from_external&&!this._isPinFave()){var e=this.getChildById("pinCreate");r.showError(l._("Invalid image data uri"),function(){e.destroy()})}},onChildRemoved:function T(t){this.children.length?this.resizeWindowToFit():window.close()},onChildAdded:function N(t){var e=this.$(".pinningBG");"pinSuccess"===t.id&&e.length&&e.remove()},onChildNavigate:function S(t){var e=!0;d.changeWindowLocation(t.data.url,e),window.close()},resizeWindowToFit:function b(){c.shrinkWrap()}});u.prototype.className="PinBookmarklet",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(116),s=i(19),o=n.extend({onClick:function a(t){this._logContextEvent(t),t.stopPropagation(),t.preventDefault(),this.toggleState(),n.prototype.onClick.call(this,t)},toggleState:function r(){this.setState(!this.getState())},setState:function l(t){this.options.toggled=t,this.renderExistingData()},getState:function h(){return this.options.toggled}});o.prototype.className="ToggleButton",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50),r=i(29),l=i(23),h=i(8);i(116),i(661);var d=a.extend({events:{"click .save":"save","click .cancel":"cancel"},save:function c(t){r.trackEvent("board_edit_cover",s.GA_ACTION_CLICK_SUBMIT);var e=this.getChildByModuleName("BoardCoverEdit"),i=e.getBoardCoverData(),o=this.getChildById("saveCover");o.showLoading();var a=n.extend(i,{board_id:this.extraData.boardId,url:this.$(".in").attr("src")}),d=h.create("BoardResource",a),c=Math.round(i.nativeWidth*i.scale),u=Math.round(i.width),p=Math.round(i.nativeHeight*i.scale),_=Math.round(i.height);if(p!==_&&c!==u){var g=n.extend({},i,{userAgent:window.navigator.userAgent});this.log.error("Invalid cover data (crop box bound error)",g)}d.callUpdate().then(function(){r.trackEvent("board_edit_cover",s.GA_ACTION_SUCCESS),this.destroy(),l.instance.publish(this.extraData.boardId,s.PUBSUB_TOPIC_BOARD_COVER_UPDATED,a)}.bind(this)).fin(function(){o.hideLoading()})},cancel:function u(){r.trackEvent("board_edit_cover",s.GA_ACTION_CLICK_CANCEL),this.destroy()}});d.prototype.className="BoardCoverEditPage",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(50),l=i(8),h=i(27);i(116),i(662);var d=r.extend({pins:null,index:null,prefetchBuffer:10,events:{"click .previous":"previous","click .next":"next"},onCreated:function c(){this.imageCrop=null,this.onKeyup=this.onKeyup.bind(this),this.next=this.next.bind(this),this.previous=this.previous.bind(this),this.$img=s("<img>")},_positionIfReady:function u(){!this._positioned&&this.inDom&&this.contentReady&&(this._positioned=!0,this.imageCrop=this.getChildByModuleName("ImageCrop"),this.listen(s("body"),"keyup",this.onKeyup),this.coverPinId=this.options.cover_pin_id,this._initializePins(!0))},_initializePins:function p(t){if(t&&null!==this.coverPinId){var e={id:this.coverPinId,field_set_key:"board_cover_picker"},i=l.create("PinResource",e);i.callGet({showError:!1}).then(function(t){this._appendPinsFromData([t.resource_response.data]),this._initializePins()}.bind(this),function(){this.coverPinId=null,this._initializePins()}.bind(this))}else this._appendPinsFromData(this.data),this.setIndex(0),this.updateButtons()},_appendPinsFromData:function _(t){this.pins||(this.pins=[]),n.each(t,function(t){var e={id:t.id,url:t.images["236x"].url};e.id===this.coverPinId&&this.pins.length||this.pins.push(e)}.bind(this))},onAddedToDom:function g(){this._positionIfReady()},onContentReady:function m(){this._positionIfReady()},onKeyup:function f(t){null!==this.index&&(t.keyCode===o.KeyCode.LEFT?this.previous():t.keyCode===o.KeyCode.RIGHT&&this.next())},requestMoreIfNeeded:function C(){this.index+this.prefetchBuffer<this.pins.length||this.resource.atEnd()||this.resource.callGet().then(function(t){this.data=t.resource_response.data,this._appendPinsFromData(this.data)}.bind(this),function(){this.data=[]}.bind(this))},next:function E(){if(this.requestMoreIfNeeded(),this.index===this.pins.length-1)return!1;var t=this.index+1;return this.setIndex(t),!1},previous:function v(){var t=this.index-1;return this.setIndex(t),!1},setIndex:function I(t){var e=this.pins[t];e&&(this.imageCrop.setImage(e.url),this.index=t,this.preload([this.index-2,this.index-1,this.index+1,this.index+2]),this.updateButtons())},preload:function T(t){n.each(t,function(t){var e=this.pins[t];e&&h.preloadImage(e.url)}.bind(this))},updateButtons:function N(){var t=this.index>0;this.$(".previous").toggle(t);var e=this.index<this.pins.length-1||!this.resource.atEnd();this.$(".next").toggle(e)},getBoardCoverData:function S(){var t=this.pins[this.index].id,e=this.pins[this.index].url,i=n.extend({},{pin_id:t,pin_image_url:e},this.imageCrop.getCropData());return i}});d.prototype.className="BoardCoverEdit",t.exports=a.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(50),a=i(19),r=o.extend({events:{"mousedown .drag":"onStartDrag","touchstart .drag":"onStartDrag"},CssClassName:{IMAGE_AREA:"in"},onAddedToDom:function l(){this._positionIfReady()},onContentReady:function h(){n.defaults(this.options,{size:{width:222,height:150},padding:60}),this.$holder=this.$(".holder"),this.$bg=this.$(".bg"),this.$help=this.$(".help"),
this.$frame=this.$(".frame"),this.$mask=this.$(".mask"),this.$spinner=this.$(".spinner"),this.$holder.show().css("height",this.options.size.height+2*this.options.padding),this.options.help_text&&this.$help.html(this.options.help_text),this._positionIfReady()},_positionIfReady:function d(){if(!this._positioned&&this.inDom&&this.contentReady){this._positioned=!0;var t=this._frameBounds={left:this.$holder.width()/2-this.options.size.width/2,width:this.options.size.width,top:this.options.padding,height:this.options.size.height};t.ratio=t.height/t.width,this.$frame.css(t);var e=this.$mask.children();e.eq(0).css({top:0,left:0,right:0,height:t.top}),e.eq(1).css({top:t.top,left:t.left+t.width,right:0,height:t.height}),e.eq(2).css({top:t.top+t.height,left:0,right:0,bottom:0}),e.eq(3).css({top:t.top,left:0,width:t.left,height:t.height}),this.options.image_url&&this.setImage(this.options.image_url)}},initImage:function c(){if(!this.$img.height()||!this.$img.width())return void n.delay(this.initImage.bind(this),200);var t=this._imageBounds={nativeWidth:this.$img.width(),nativeHeight:this.$img.height()};t.ratio=t.nativeHeight/t.nativeWidth,this.$img.addClass(this.CssClassName.IMAGE_AREA),this._fitImage(),this._centerImage(),this._hideSpinner()},onStartDrag:function u(t){var e="touchstart"===t.type;e?this._mousePosition={x:t.originalEvent.touches[0].pageX,y:t.originalEvent.touches[0].pageY}:this._mousePosition={x:t.pageX,y:t.pageY},this._startPosition={x:parseInt(this.$bg.css("left"),10),y:parseInt(this.$bg.css("top"),10)},s("body").on({"mousemove.ImageCrop touchmove.ImageCrop":this.onDragging.bind(this),"mouseup.ImageCrop touchend.ImageCrop":this.onStopDragging}),t.preventDefault()},onDragging:function p(t){t.preventDefault();var e="touchmove"===t.type,i=e?t.originalEvent.changedTouches[0]:t,n=i.pageX-this._mousePosition.x,s=i.pageY-this._mousePosition.y,o={top:this._startPosition.y+s,left:this._startPosition.x+n};this._clampValues(o),this.$bg.css(o)},onStopDragging:function _(t){s("body").off("mousemove.ImageCrop mouseup.ImageCrop touchmove.ImageCrop touchend.ImageCrop")},_clampValues:function g(t){t.top=Math.min(t.top,this._frameBounds.top),t.left=Math.min(t.left,this._frameBounds.left),t.top+this._imageBounds.height<this._frameBounds.top+this._frameBounds.height&&(t.top=this._frameBounds.top+this._frameBounds.height-this._imageBounds.height+1),t.left+this._imageBounds.width<this._frameBounds.left+this._frameBounds.width&&(t.left=this._frameBounds.left+this._frameBounds.width-this._imageBounds.width+1)},setImage:function m(t){this._showSpinner(),this.$img=s("<img>",{src:t}),this.$bg.empty().append(this.$img),this.initImage()},_fitImage:function f(){var t;t=this._imageBounds.ratio>=this._frameBounds.ratio?this._frameBounds.width/this._imageBounds.nativeWidth:this._frameBounds.height/this._imageBounds.nativeHeight,this._scaleImage(t)},_centerImage:function C(){var t=this.$holder.height(),e=this.$holder.width();this.$bg.css({top:t/2-this.$bg.height()/2+1,left:e/2-this.$bg.width()/2+1})},_scaleImage:function E(t){var e=this._imageBounds.width=this._imageBounds.nativeWidth*t,i=this._imageBounds.height=this._imageBounds.nativeHeight*t;this.$img.css({width:e,height:i})},_showSpinner:function v(){this.$spinner.show()},_hideSpinner:function I(){this.$spinner.hide()},getCropData:function T(){var t={x:-1*(parseInt(this.$bg.css("left"),10)-parseInt(this._frameBounds.left,10)),y:-1*(parseInt(this.$bg.css("top"),10)-parseInt(this._frameBounds.top,10))},e=this.$img.width()/this._imageBounds.nativeWidth,i={crop_x:t.x,crop_y:t.y,nativeHeight:this._imageBounds.nativeHeight,nativeWidth:this._imageBounds.nativeWidth,height:this.options.size.height,width:this.options.size.width,scale:e};return i}});r.prototype.className="ImageCrop",t.exports=a.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(526);var o=n.extend({onContentReady:function a(){}});o.prototype.className="BoardCycler",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(665),s=i(19),o=i(219),a=i(11),r=i(29),l=i(18),h=i(23);i(116),i(225);var d=n.extend({handleDelete:function c(t,e){this.isInModal()?(h.instance.publish(t,a.PUBSUB_TOPIC_BOARD_DELETED),h.instance.publish(a.PUBSUB_CHANNEL_CURRENT_USER,a.PUBSUB_TOPIC_BOARD_DELETED,{privacy:e}),this.destroy()):this.redirectAfterDelete()},onButtonClick:function u(t){o.prototype.onButtonClick.call(this,t);var e=t.target;"deleteBoardButton"===e.id&&this.onDeleteClick()},onDeleteClick:function p(){r.trackEvent("board_delete",a.GA_ACTION_OPEN_MODAL),this.showConfirmation()},onDeleteConfirm:function _(){r.trackEvent("board_delete",a.GA_ACTION_CLICK_SUBMIT),this.deleteBoard()},showConfirmation:function g(){var t={name:"ConfirmDialog",options:{template:"delete_board"}};l.load(t).then(function(t){this.showInModal(t),this.listen(t,a.EVENT_CONFIRM,this.onDeleteConfirm)}.bind(this))}});d.prototype.className="BoardEdit",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(219),s=i(19),o=i(11),a=i(666),r=i(35),l=i(29),h=i(14),d=i(72),c=i(8),u=n.extend({onContentReady:function p(){if(a.checkForAutologin()){var t=h._("To edit your board, please take a second to confirm it's really you.");return a.showLoginErrorDialog(this,t),void this.destroy()}n.prototype.onContentReady.call(this);var e={};e[o.PUBSUB_TOPIC_BOARD_BANNED_COLLABORATOR]=this.onBannedUser,e[o.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF]=this.onBoardRemovedSelf,this.pubsubSubscribe(this.data.id,e)},onInviteAdded:function _(t,e){var i=t?this.getChildById("boardPendingInvites"):this.getChildById("boardInvites");l.trackEvent("collaborator_invite_user",o.GA_ACTION_SUCCESS),i.addInvitee({type:e.type,identifier:e.invitee})},onSubmitValidated:function g(){this.saveBoard()},deleteBoard:function m(){var t=this.getBoardId(),e=this.getFieldValues(),i=e.privacy,n=c.create("BoardResource",{board_id:t}),s=function h(t){r.showError(t.message),l.trackEvent("board_delete",o.GA_ACTION_ERROR)},a=function(e){if(l.trackEvent("board_delete",o.GA_ACTION_SUCCESS),this.updateBoardPickerBoardsResource(),e){var n=e.resource_response;if(n&&!n.error){this.handleDelete(t,i);var a=c.create("BoardPickerBoardsResource",{filter:"all",field_set_key:"board_picker",allow_stale:!0});return void d.instance.invalidate(a)}}s(e)}.bind(this);this.showLoading(),n.callDelete({showError:!1}).then(a,s).fin(function(){this.hideLoading()}.bind(this))},handleDelete:function f(t,e){},redirectAfterDelete:function C(){var t=this.data.owner?"/"+this.data.owner.username+"/":"/";window.location.href!==t&&this.navigate(t)},onBoardRemovedSelf:function E(t,e,i){this.destroy()},onBannedUser:function v(t,e,i){var n=this.getChildById("boardInvites");n.render();var s=this.getChildById("boardPendingInvites");s&&s.render()}});u.prototype.className="BoardEditActionBase",t.exports=s.register(u)},function(t,e,i){"use strict";var n=i(11),s=i(14),o=i(135),a=i(18),r=i(46),l={checkForAutologin:function h(){return"true"===r.get("autologin")},showLoginErrorDialog:function d(t,e){var i={name:"ConfirmDialog",options:{button_text:s._("Log in to continue"),body_message:e,title:s._("Password, please!"),template:"generic"}};a.load(i).then(function(e){o.get().createAndShowModal(e),t.listen(e,n.EVENT_CONFIRM,function(){t.navigate("/login/",null,null)})})}};t.exports=l},function(t,e,i){"use strict";var n=i(50),s=i(19);i(223);var o=n.extend({});o.prototype.className="BoardFollowers",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19);i(116),i(245);var a=s.extend({onCreated:function r(){this._DOMTextReplacerInstance=null},setSelectedStyle:function l(t){this.getChildById("boardIcons").setLightColor(t)},highlightMatchedText:function h(t){this.unHighlightMatchedText();var e=new RegExp(t,"i");this._DOMTextReplacerInstance=window.findAndReplaceDOMText(this.$(".nameAndIcons")[0],{find:e,replace:function i(t,e){var i=n('<em class="highlightMatchText"></em>');return i.html(t.text),i[0]}})},unHighlightMatchedText:function d(){this._DOMTextReplacerInstance&&this._DOMTextReplacerInstance.revert()}});a.prototype.className="BoardLabel",t.exports=o.register(a)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(21),a=i(670),r=i(19),l=i(11),h=i(193),d=i(671),c=i(148),u=i(546),p=i(50),_=i(40),g=i(80),m=i(81),f=i(59),C=i(29),E=i(23),v=i(8),I=i(311),T=i(46),N=i(27);i(116),i(151),i(173),i(185),i(672),i(673),i(165);var S=["description","privacy"],b="cubic-bezier(.19, 1, .48, 1)",y=p.extend({CssClassName:{DROP_PREVIEW:"dropPreview",HIDDEN:"hidden",UI_STATE_CONVERSATION:"ui-state-conversation"},addTutorials:function P(){var t=l.GEN.Placement.WEB_BOARD_TAKEOVER;h.launchPlacedExperience(t,{board_id:this.data.id})},getGrid:function B(){return this.getChildById("grid")},getBoardHeader:function A(){return this.getChildById("boardHeader")},getBoardInfoBar:function R(){return this.getBoardHeader().getChildById("boardInfoBar")},getBoardTitleHeight:function w(){return this.$(".boardHeaderWrapper").height()},getPins:function O(){var t=this.getGrid();if(!t)return[];var e=t.getGridItemsChildren();return e.length?e:[]},getPinCount:function D(){return this.getPins().length},getLoggingObjectIdStr:function x(){return this.data.id},updateDom:function L(){var t=0===this._pinCountTotal;this.$(".EmptyStateCardBoard").toggleClass(this.CssClassName.HIDDEN,!t),this.$(".Grid").toggleClass(this.CssClassName.HIDDEN,t),1===this._pinCountTotal?this.getGrid().show():0===this._pinCountTotal&&this.getGrid().hide()},_getPinByPinId:function k(t){for(var e=this.getPins(),i,n=0,s=e.length;s>n;++n)if(i=e[n],i.data&&i.getId()===t)return i;return null},onContentReady:function U(){var t={};if(this.userAgentPlatform=this.extraData.userAgentPlatform,this.extraData.show_invite_modal){var e=this.extraData.invite_type,i;switch(e){case"reminder_1":c.trackInviteFunnelAction("recipient_invite_reminder1_landing",!0),i="user";break;case"reminder_2":c.trackInviteFunnelAction("recipient_invite_reminder2_landing",!0),i="user";break;case"user":c.trackInviteFunnelAction("recipient_invite_landing",!0),c.trackInviteFunnelAction("invite_landing"),i="user";break;default:case"board":N.trackRegisterAction("board_invite_landing"),i="board"}if("board"!==i||this.userAgentPlatform!==l.USER_AGENT_PLATFORM_ANDROID&&this.userAgentPlatform!==l.USER_AGENT_PLATFORM_IOS)u.showInviteModal(this.options.inviter_user_id,i);else{var a=f.instance.v2ActivateExperiment("new_gb_landing"),r=-1!==s.inArray(a,["enabled","employees"]);r?d.showBoardRepModal(this.data.id,this.options.inviter_user_id,this.options.invite_code):u.showInviteModal(this.options.inviter_user_id,i)}}T.isAuthenticated()?this.options.board_collab_inviter&&this.showBoardCollaboratorInviterModal():(o.set(l.COOKIE_LAST_UNAUTH_BOARD_ID,this.data.id),I.logUrl()),this.data.id&&(t={},t[l.PUBSUB_TOPIC_BOARD_BANNED_COLLABORATOR]=this.onBannedUser,t[l.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,t[l.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,t[l.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF]=this.onBoardRemovedSelf,t[l.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED]=this.onBoardWriteAccessUpdated,t[l.PUBSUB_TOPIC_PIN_CREATED]=this.onPinAdded,t[l.PUBSUB_TOPIC_BULK_PINS_CREATED]=this.onBulkPinsAdded,t[l.PUBSUB_TOPIC_PIN_FLAGGED]=this.onPinFlagged,this.pubsubSubscribe(this.data.id,t));var h={};if(h[l.PUBSUB_TOPIC_TOGGLE_BULK_EDIT]=this.toggleBulkEditMode,this.pubsubSubscribe(l.PUBSUB_CHANNEL_BULK_EDIT,h),this.childListen(l.EVENT_PIN_UPDATED,this.onChildPinUpdated),this.childListen(l.EVENT_PIN_DELETED,this.onPinDeleted),this.childListen(l.EVENT_ITEMS_REQUEST_SUCCESS,this.onChildItemsAddedToGrid),this.options.show_edit&&(this.extraData.canEdit&&this.showEditModal(),delete this.options.show_edit),this.extraData&&this.extraData.canEdit&&f.instance.v2InGroup("rearrange_pins_internal","employees")&&this._initializePinsRearrangeManagers(),n.defer(this.addTutorials.bind(this)),this.inBulkEditMode=!1,this.numPinsFlagged=0,this._pinCountTotal=this.data.pin_count,!this.data.pin_count){var p={event_type:l.GEN.EventType.VIEW,view_type:l.GEN.ViewType.EMPTY_STATE,view_parameter:l.GEN.ViewParameterType.BOARD_EMPTY},_=g.fromPlainObject(p);m.getInstance().addEvent(_)}},_initializePinsRearrangeManagers:function M(){var t=this,e=this.getGrid();if(e){var i="addPinRep",n=t.getGrid().items.getChildById(i),o={drop:function a(e,i){t._onPinRearrangeDroppableDrop(i,s(this))},over:function r(e,i){t._onPinRearrangeDroppableOver(i,s(this))},out:function l(e,i){t._onPinRearrangeDroppableOut(s(this))}};e.setDragState(e.DRAGGING_ENABLED),e.items.initializeDropManager(o),n&&(e.items.disableDraggingForChildModule(n),e.items.disableDroppingForChildModule(n))}},_onPinRearrangeDroppableDrop:function F(t,e){var i=t.draggable,n=this.getGrid().items.getChildByElement(i.find(".Pin")),s=this.getGrid().items.getChildByElement(e.find(".Pin"));e.removeClass(this.CssClassName.DROP_PREVIEW),e.transition({paddingLeft:0,easing:b,duration:230}),t.helper.hasClass(this.CssClassName.UI_STATE_CONVERSATION)||this.splicePinOrder(n,s)},_onPinRearrangeDroppableOver:function $(t,e){t.helper.hasClass(this.CssClassName.UI_STATE_CONVERSATION)||(e.addClass(this.CssClassName.DROP_PREVIEW),e.transition({paddingLeft:25,easing:b,duration:230}))},_onPinRearrangeDroppableOut:function H(t){t.removeClass(this.CssClassName.DROP_PREVIEW),t.transition({paddingLeft:0,easing:b,duration:230})},splicePinOrder:function V(t,e){var i="SplicePinResource",n={board_id:this.data.id,source_pin:t.getId(),target_pin:e.getId()},s=v.create(i,n),o="board_pins_reorder";s.callUpdate().then(function(){C.trackEvent(o,l.GA_ACTION_SUCCESS),this.getGrid().items.reorderChildModule(t,e)}.bind(this),function(){C.trackEvent(o,l.GA_ACTION_ERROR)})},showBoardCollaboratorInviterModal:function G(){var t=new a({options:{},resource:{name:"BoardResource",options:{board_id:this.data.id}}});this.showInModal(t)},toggleBulkEditMode:function W(t,e,i){(i===l.ENTER_BULK_EDIT&&!this.inBulkEditMode||i===l.EXIT_BULK_EDIT&&this.inBulkEditMode)&&(this.inBulkEditMode=!this.inBulkEditMode,this.getPins().forEach(function(t){t.data&&E.instance.publish(t.data.id,l.PUBSUB_TOPIC_TOGGLE_BULK_EDIT,i)}))},reconfigurePins:function K(t){this.getPins().forEach(function(e){this.reconfigurePin(e,t)}.bind(this))},collapseBoardInfoBar:function j(t){this.getBoardInfoBar().setCollapsible(!1),this.getBoardInfoBar().collapse(t)},expandBoardInfoBar:function Y(){this.getBoardInfoBar().setCollapsible(!0),this.getBoardInfoBar().expand()},onBoardWriteAccessUpdated:function q(t){this.renderHeader()},onPinDeleted:function z(t){_.instance.is_mobile_agent||this.renderHeader(),this._decrementPinCount()},onPinFlagged:function X(){this.numPinsFlagged+=1},getNumPinsFlagged:function Q(){return this.numPinsFlagged},onChildItemsAddedToGrid:function Z(t){this.inBulkEditMode&&this.getPins().forEach(function(t){t.data&&t.changePinBulkEditMode(!0)})},onBoardUpdated:function J(t,e,i){var n=!1;if(i.url!==this.data.url&&this.inDom)this.data.url=i.url,this.navigate(i.url);else{for(var s=0;s<S.length;s++){var o=i[S[s]];"undefined"!=typeof o&&this.data[S[s]]!==o&&(n=!0,this.data[S[s]]=o)}n&&this.renderHeader()}},_setPinCount:function tt(t){this._pinCountTotal=t,this.updateDom()},_incrementPinCount:function et(){this._setPinCount(this._pinCountTotal+1)},_decrementPinCount:function it(){this._setPinCount(this._pinCountTotal-1)},_prependGridItem:function nt(t,e){var i=this.getGrid();i&&(i.prependNewItems(t,e),this._incrementPinCount())},_onPrependedInBulkEdit:function st(){var t=this.getPins(),e=t[0].data?t[0]:t[1];e.changePinBulkEditMode(!0)},onPinAdded:function ot(t,e,i){if(this.inBulkEditMode){var n=this._onPrependedInBulkEdit.bind(this);this._prependGridItem(1,n)}else this._prependGridItem(1,i.gridPrependCallback),this.renderHeader()},onBulkPinsAdded:function at(){var t=this.getGrid();t.render().then(function(){n.defer(function(){this._setPinCount()}.bind(this))}.bind(this))},onBannedUser:function rt(t,e,i){this.renderHeader();var n=this.getGrid();n.render()},onBoardDeleted:function lt(){this.inDom&&this.navigateToUserPage()},navigateToUserPage:function ht(){var t=this.extraData&&this.extraData.currentUsername,e="/",i=t?e+t+"/":e;this.navigate(i)},getHeader:function dt(){return this.getChildById("boardHeader")},renderHeader:function ct(){var t=this.getHeader();t.render()},showEditModal:function ut(){var t=this.getHeader();return t.showEditModal()},onChildPinUpdated:function pt(t){var e=t.data,i=e.board.id,n=t.target;return i!==this.data.id?void n.destroy():void 0},onBoardRemovedSelf:function _t(t,e,i){this.data.privacy===l.BOARD_PRIVACY_SECRET&&this.inDom?this.navigateToUserPage():this.renderHeader()}});y.prototype.className="BoardPage",t.exports=r.register(y)},function(t,e,i){"use strict";var n=i(665),s=i(19);i(116),i(128),i(225),i(222);var o=n.extend({onContentReady:function a(){n.prototype.onContentReady.call(this);var t=this.$(".BoardInviteForm .TypeaheadField .Input"),e=this.$(".BoardInviteForm .inviteButton");t.width(t.width()-e.innerWidth())}});o.prototype.className="BoardCollaboratorInviter",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(135),a=i(18);i(296),i(150);var r=n.extend({});r.showBoardRepModal=function(t,e,i){var n={name:"GroupBoardInviteLanding",options:{inviter_user_id:e},resource:{name:"BoardResource",options:{board_id:t,field_set_key:"grid_item"}}};a.load(n).then(function(t){o.get().createAndShowModal(t,{can_dismiss:!1,modal_style:"fullScreen"})})},r.prototype.className="GroupBoardInviteLanding",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(560),s=i(19),o=i(232),a=i(11),r=i(555);i(116);var l=r.extend({onContentReady:function h(){var t={};t[a.PUBSUB_TOPIC_BROWSER_EXTENSION_STATE_UPDATED]=this._setBrowserButtonUpsellDisplayState,this.pubsubSubscribe(a.PUBSUB_CHANNEL_BROWSER_EXTENSION,t),this.childListen(a.EVENT_BUTTON_CLICK,this.onButtonClick),this._setBrowserButtonUpsellDisplayState()},_setBrowserButtonUpsellDisplayState:function d(){var t=this.options.is_own_board;o.isExtensionInstalled()&&t&&(r.prototype.setFooterIsVisible.call(this,!1),r.prototype.setActionButtonIsVisible.call(this,!1))},onButtonClick:function c(t){var e=t.target;e.showLoading();var i=new n({options:{extension_installed:!!o.isExtensionInstalled(),suppress:!1}});i.render().then(function(){e.hideLoading(),this.showInModal(i)}.bind(this))}});l.prototype.className="EmptyStateCardBoard",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(674);var a="BoardInfoBar",r=o.extend({CssClassName:{HEADER_COLLAPSED:n.CLASS_HEADER_COLLAPSED},onCreated:function l(){this.childListen(n.EVENT_INFO_BAR_COLLAPSED,this.onInfoBarCollapsed),this.childListen(n.EVENT_INFO_BAR_EXPANDED,this.onInfoBarExpanded)},showEditModal:function h(){var t=this.getChildByModuleName(a);return t.showEditModal()},onInfoBarCollapsed:function d(){this.updateOptionsAndDom({headerCollapsed:!0})},onInfoBarExpanded:function c(){this.updateOptionsAndDom({headerCollapsed:!1})},updateDom:function u(){this.$el.toggleClass(this.CssClassName.HEADER_COLLAPSED,this.options.headerCollapsed)}});r.prototype.className="BoardHeader",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(675),s=i(11),o=i(50),a=i(30),r=i(40),l=i(19),h=i(23),d=i(46);i(116),i(171),i(173),i(128),i(236),i(676);var c="editButton",u="boardMenu",p=300,_=2,g="ease-out",m=o.extend({CssClassName:{FIXED_HEADER:"fixedHeader",HEADER_COLLAPSED:s.CLASS_HEADER_COLLAPSED},events:{"click .movePinsButton":"onMovePinsClicked"},onCreated:function f(){this.totalNagHeight=0,this.boardInfoOffsetHeight=0;var t={};t[s.PUBSUB_TOPIC_NAG_TOGGLE]=this.onNagVisibilityChange,this.pubsubSubscribe(s.PUBSUB_CHANNEL_SITE,t)},onContentReady:function C(){var t={};t[s.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED]=this.onWriteAccessChange,this.pubsubSubscribe(this.data.id,t),this._isPlaceBoard="places"===this.data.layout;var e={};e[s.PUBSUB_TOPIC_TOGGLE_BULK_EDIT]=this.toggleBulkEditMode,this.pubsubSubscribe(s.PUBSUB_CHANNEL_BULK_EDIT,e)},onAddedToDom:function E(){var t=this.$el.position().top;"places"===this.data.layout&&(t+=a.siteConst.PIN_MARGIN,r.instance.is_mobile_agent||(t=300)),this.infoBarPosition=t;var e=!r.instance.is_mobile_agent&&!d.isAuthenticated();r.instance.is_mobile_agent||e||("undefined"==typeof this.inBulkEditMode&&this._setBulkEditMode(!1),this.scrollListener=this.listen(this.getScrollableElement(),s.EVENT_SCROLL,this.onScroll),this.onScroll())},onRemovedFromDom:function v(){this.scrollListener&&this.removeListener(this.scrollListener)},onWriteAccessChange:function I(t,e){this.render()},onNagVisibilityChange:function T(t,e,i){i.height&&(i.visible?this.totalNagHeight+=i.height:this.totalNagHeight-=i.height)},showEditModal:function N(){var t=this.getChildById(c);return t?(t.showModalSubmodule(),!0):!1},onScroll:function S(){var t=this.getScrollableElement().scrollTop();if(!(0>t)&&this.options.collapsible)if(t>=this.infoBarPosition+this.totalNagHeight&&!this.options.fixedHeader){if(this.collapse(),this.getChildById(u)){this.boardInfoOffsetHeight=this.getChildById(u).getDropdown().getTopOffset();var e=String(this.boardInfoOffsetHeight-(this.parent.$(".boardHeaderWrapper").height()+_))+"px";this.getChildById(u).getDropdown().turnOnFixed(e)}}else t<this.infoBarPosition+this.totalNagHeight&&this.options.fixedHeader&&(this.expand(),this.getChildById(u)&&this.getChildById(u).getDropdown().turnOffFixed(this.boardInfoOffsetHeight))},collapse:function b(t){this.options.fixedHeader||(this.triggerEvent(s.EVENT_INFO_BAR_COLLAPSED,null,!0),this.updateOptionsAndDom({collapsed:!0,fixedHeader:!0,offsetTop:t}))},expand:function y(){this.options.fixedHeader&&(this.triggerEvent(s.EVENT_INFO_BAR_EXPANDED,null,!0),this.updateOptionsAndDom({collapsed:!1,fixedHeader:!1}))},onMovePinsClicked:function P(){if(!this.inBulkEditMode){this._setBulkEditMode(!0);var t=this.data,e={board_id:t.id,board_privacy:t.privacy,is_place_board:this._isPlaceBoard},i=new n({options:e});return i.render().then(function(){h.instance.publish(s.PUBSUB_CHANNEL_BULK_EDIT,s.PUBSUB_TOPIC_TOGGLE_BULK_EDIT,s.ENTER_BULK_EDIT);var t="64px";this.insertChild(i,this.$el),this.bulkEditBar=i,this.enterBulkEditMode(t)}.bind(this))}},enterBulkEditMode:function B(t){this.$(".infoBarWrapper").transition({y:t,easing:g,duration:s.BULK_EDIT_ANIMATION_DURATION}),this.bulkEditBar.enterBulkEditMode()},exitBulkEditMode:function A(){this.bulkEditBar&&this.bulkEditBar.exitBulkEditMode(),this._setBulkEditMode(!1),this.$(".infoBarWrapper").transition({y:"0",easing:g,duration:s.BULK_EDIT_ANIMATION_DURATION})},toggleBulkEditMode:function R(t,e,i){i===s.EXIT_BULK_EDIT&&this.exitBulkEditMode()},updateDom:function w(){this.$el.toggleClass(this.CssClassName.HEADER_COLLAPSED,this.options.collapsed),this.$el.toggleClass(this.CssClassName.FIXED_HEADER,this.options.fixedHeader);var t={easing:g,duration:p},e=this.$(".smallBoardName"),i=this.$(".pinsAndFollowerCount");this.inBulkEditMode||(this.options.fixedHeader?(t.y="66px",e.css("opacity",1),e.transition(t),this.$el.css("top",this.options.offsetTop)):(this.$el.css("top",""),t.y="0",e.transition(t,function(){e.css("opacity",0)})),i.transition(t))},_setBulkEditMode:function O(t){this.inBulkEditMode=t},setCollapsible:function D(t){this.updateOptions({collapsible:t})},onOptionsChanged:function x(t,e){"undefined"==typeof e.fixedHeader&&(e.fixedHeader=!1),"undefined"==typeof e.collapsible&&(e.collapsible=!0)}});m.prototype.className="BoardInfoBar",t.exports=l.register(m)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(246),r=i(35),l=i(14),h=i(135),d=i(18),c=i(23),u=i(8);i(116);var p=o.extend({onContentReady:function _(){var t={};t[n.PUBSUB_TOPIC_BULK_PIN_SELECTED]=this.pinSelected,this.pubsubSubscribe(n.PUBSUB_CHANNEL_BULK_EDIT,t),this.childListen(n.EVENT_BUTTON_CLICK,this.onButtonClick),this.pinsSelected={},this.selectedPinsCount=0},pinSelected:function g(t,e,i){if(i&&this.pinsSelected){if(this.pinsSelected.hasOwnProperty(i))this.selectedPinsCount--,delete this.pinsSelected[i];else{if(50===Object.keys(this.pinsSelected).length)return r.showError(l._("You can only move 50 Pins at a time.")),void c.instance.publish(i,n.PUBSUB_TOPIC_BULK_PIN_UNSELECTED);this.selectedPinsCount++,this.pinsSelected[i]=1}this.updateSelectedPinsCount()}},updateSelectedPinsCount:function m(){var t=this.getChildById("selectedPinsCount");t&&t.destroy();var e={can_update_count:!0,view_type:"selectedPins"},i={pin_count:this.selectedPinsCount},n=new a({id:"selectedPinsCount",data:i,options:e});n.renderExistingData().then(function(){var t=this.$(".notifications");this.insertChild(n,t)}.bind(this))},showBoardPicker:function f(t){var e=Object.keys(this.pinsSelected);0===e.length?t===n.BulkAction.MOVE?r.showError(l._("Select the Pins you want to move.")):t===n.BulkAction.COPY?r.showError(l._("Select the Pins you want to copy.")):r.showError(l._("Select some Pins first.")):d.load({name:"BulkBoardPicker",options:{action_type:t,board_privacy:this.options.board_privacy,pin_count:e.length,pin_ids:e}}).then(function(t){h.get().createAndShowModal(t)})},onButtonClick:function C(t){var e=t.target,i=e.id;switch(i){case"moveBulkButton":this.showBoardPicker(n.BulkAction.MOVE);break;case"copyBulkButton":this.showBoardPicker(n.BulkAction.COPY);break;case"deleteBulkButton":this.onDeleteClick();break;case"cancelBulkButton":c.instance.publish(n.PUBSUB_CHANNEL_BULK_EDIT,n.PUBSUB_TOPIC_TOGGLE_BULK_EDIT,n.EXIT_BULK_EDIT)}},enterBulkEditMode:function E(){this.$el.transition({y:"64px",easing:"ease-out",duration:n.BULK_EDIT_ANIMATION_DURATION})},exitBulkEditMode:function v(){this.$el.transition({y:"0",easing:"ease-out",duration:n.BULK_EDIT_ANIMATION_DURATION},1,function(){this.destroy()}.bind(this))},onDeleteClick:function I(){var t=Object.keys(this.pinsSelected);if(0===t.length)r.showError(l._("Select the Pins you want to delete."));else{var e="";e=1===t.length?"delete_pin":"delete_pins";var i={name:"ConfirmDialog",options:{template:e}};d.load(i).then(function(t){this.showInModal(t),this.listen(t,n.EVENT_CONFIRM,this.bulkDeletePins)}.bind(this))}},bulkDeletePins:function T(){var t=u.create("BulkEditResource",{board_id:this.options.board_id,pin_ids:Object.keys(this.pinsSelected)});t.callDelete({showError:!0}).then(function(){for(var t in this.pinsSelected)c.instance.publish(t,n.PUBSUB_TOPIC_PIN_DELETED);c.instance.publish(n.PUBSUB_CHANNEL_BULK_EDIT,n.PUBSUB_TOPIC_TOGGLE_BULK_EDIT,n.EXIT_BULK_EDIT)}.bind(this))}});p.prototype.className="BulkEditBar",t.exports=s.register(p)},function(t,e,i){"use strict";var n=i(220),s=i(19),o=i(11);i(223),i(173),i(128),i(225);var a=n.extend({onContentReady:function r(){this.boardInviteForm=this.getChildById("boardInviteForm");var t=this.getBoardId();if(t){var e={};e[o.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,this.pubsubSubscribe(t,e)}},onBoardUpdated:function l(){this.render()}});a.prototype.className="BoardCollaborators",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(1),s=i(115),o=i(19),a=i(50),r=i(8);i(116);var l=a.extend({onCreated:function h(){this.childListen("change",this.onChildChange)},onSubmitValidated:function d(t){return this.save(),!1},save:function c(){var t={},e=[];this.$form.find("input[name=collab_board_email]:checked").each(function(){e.push(this.value)}),t.email_collaborative_board_ids=e;var i=this.getChildById("submitButton"),n=r.create("UserSettingsResource",t);i.showLoading(),n.callUpdate().then(function(){this.destroy()}.bind(this)).fin(function(){i.hideLoading()})},onContentReady:function u(){a.prototype.onContentReady.apply(this,arguments);var t={};this.$form=this.$("form"),this.form=new s(this.$form,t),this.listen(this.form,"submitValidated",this.onSubmitValidated)},onChildChange:function p(t){var e=t.target;if("toggleAll"===e.id){var i;i=e.isChecked()?function o(t){t.setChecked(!0)}:function a(t){t.setChecked(!1)};var s=this.getChildrenByModuleName("Checkbox");n.each(s,i)}}});l.prototype.className="GroupBoardEmailSettings",t.exports=o.register(l)},function(t,e,i){"use strict";var n=i(2),s=i(679),o=i(19),a=i(14),r=s.extend({events:{"click [name=ban]":"onBanClick"},onContentReady:function l(){this.returnData=["ban"],s.prototype.onContentReady.call(this)},onBanClick:function h(t){var e=n(t.target),i=e.is(":checked")?a._("Block Pinner"):a._("Remove Pinner");this.setPrimaryButtonText(i)}});r.prototype.className="RemoveUserFromBoardDialog",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(115),r=i(50),l=i(34);i(116);var h=r.extend({events:{"click .cancelButton":"onCloseClick","click .confirm":"onConfirmClick","change #confirmCheckbox":"onConfirmCheckboxChange"},returnData:null,onContentReady:function d(){var t=this.$("form");t&&(this.formListener&&this.removeListener(this.formListener),this.form=new a(t,this.formConfig),this.formListener=this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated));var e=this.options.auto_close_delay_ms;e&&this.closeOnDelay(e)},onConfirmCheckboxChange:function c(){this.$("#confirmCheckbox").is(":checked")?this.$(".confirm").removeAttr("disabled"):this.$(".confirm").attr("disabled","disabled")},onSubmitValidated:function u(t){t.errors[0]||(this.formData={},n.each(this.returnData,function(t){this.formData[t]=this.form.getValue(t)}.bind(this)),this.confirm())},onCloseClick:function p(t){return this.triggerEvent(s.EVENT_DIALOG_BUTTON_CLICKED,t.currentTarget,!0),this.close(),!1},close:function _(){this.triggerEvent(s.EVENT_CLOSE,this),this.destroy()},closeOnDelay:function g(t){this.closeTimer&&clearTimeout(this.closeTimer),this.closeTimer=l.setTimeout(function(){this.closeTimer=null,this.destroy()}.bind(this),t)},open:function m(){this.triggerEvent(s.EVENT_OPEN,this)},onConfirmClick:function f(t){return this.triggerEvent(s.EVENT_DIALOG_BUTTON_CLICKED,t.currentTarget,!0),this.confirm(),!1},confirm:function C(){this.showLoading(!0),this.triggerEvent(s.EVENT_CONFIRM,this,!0),this.destroy()},setPrimaryButtonText:function E(t){this.$(".primary .buttonText").text(t)},onDestroyed:function v(){this.closeTimer&&clearTimeout(this.closeTimer)}});h.prototype.className="ConfirmDialog",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(235),a=i(232),r=i(81),l=i(18),h=i(206),d=o.extend({events:{"click .toastWrapper":"onToastClick"},onContentReady:function c(){o.prototype.onContentReady.call(this),r.getInstance().logCustomViewEvent(n.GEN.ViewType.SAVE,n.GEN.ViewParameterType.EXTENSION_UPSELL_TOAST)},onToastClick:function u(t){this._logCustomContextEvent(n.GEN.EventType.CLICK,n.GEN.ElementType.GET_EXTENSION_BUTTON,n.GEN.ComponentType.BROWSER,{}),t.preventDefault();var e={name:"BrowserButtonUpsell",options:{extension_installed:!!a.isExtensionInstalled()}};l.load(e).then(function(t){h.removeAllToasts(),this.modal?this.modal.setSubmodule(t):this.showInModal(t)}.bind(this))}});d.prototype.className="ExtensionInstallToast",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(57),a=i(50),r=i(81),l=i(59),h=i(29),d=i(23),c=i(34),u=i(31),p=i(27);i(116),i(130),i(682),i(245),i(684),i(685),i(686);var _=5e3,g=2e3,m=3e3,f=1e4,C=15e3,E=f,v=1e3,I="installExtensionButton",T="cancelInstallButton",N="dismissAllPromos",S=a.extend({CssClassName:{NO_BODY:"noBody"},onContentReady:function b(){var t=u.getQueryStringParams().guid;t&&p.logWidgetEvent({guid:t,pin_id:this.options.pin_id});var e=g,i=!1,s=this.getChildById("successBoard");if(s&&s.hasBoard()){e=f,i=!0;var a={};a[n.PUBSUB_TOPIC_USER_FOLLOW]=this.onBoardFollow,this.pubsubSubscribe(s.getBoardId(),a)}this.options.is_csr&&(e=_),this.options.is_bulk_action&&(e=m);var r=this.getChildById("successPromo");if(r&&!r.isValid())return void this.destroy();var h=this.getChildById(I);h&&(e=E,this.childListen(n.EVENT_BUTTON_CLICK,this.onInstallExtensionButtonClick),this._viewExtensionUpsellExperience());var d=this.getChildById(T);d&&this.childListen(n.EVENT_BUTTON_CLICK,this.onGotItButtonClick);var c=this.getChildById(N);c&&this.childListen(n.EVENT_BUTTON_CLICK,this.onDismissAllPromosButtonClick),d&&this._viewWebPinSuccessExperience(n.GEN.Experience.WEB_PIN_SUCCESS_NEW_EXTENSION_UPSELL),
i||this.$el.addClass(this.CssClassName.NO_BODY),o.instance.isPlacedExperience(n.GEN.Placement.WEB_PIN_SUCCESS,n.GEN.Experience.WEB_PIN_SUCCESS_EXTENSION_UPSELL)&&"bookmarklet"===this.options.method&&(e=f);var v=l.instance.v2ActivateExperiment("partner_post_create_promote_pin_ga");"enabled"===v&&(e=C),this.options.auto_close&&this.closeOnDelay(e),o.instance.completePlacedExperience(n.GEN.Placement.WEB_PIN_CLOSEUP,n.GEN.Experience.WEB_PIN_CLOSEUP_LITE)},closeOnDelay:function y(t){this.closeTimer&&clearTimeout(this.closeTimer),this.closeTimer=c.setTimeout(function(){this.closeTimer=null,this.options.is_csr&&window.parent.postMessage("navigate",n.PIN_IT_DOMAIN),this.destroy()}.bind(this),t)},onInstallExtensionButtonClick:function P(t){var e=t.target;e.id===I&&this._completeExtensionUpsellExperience()},onGotItButtonClick:function B(t){var e=t.target,i;e.id===T&&(i=n.GEN.Experience.WEB_PIN_SUCCESS_NEW_EXTENSION_UPSELL),this._completeWebPinSuccessExperience(i)},onDismissAllPromosButtonClick:function A(t){var e=t.target;e.id===N&&this._completeWebPinSuccessExperience(n.GEN.Experience.WEB_PIN_SUCCESS_NEW_EXTENSION_UPSELL)},_viewWebPinSuccessExperience:function R(t){if(t){var e=o.instance.constructPlacedExperienceId(n.GEN.Placement.WEB_PIN_SUCCESS,t);o.instance.viewPlacedExperienceId(e)}},_completeWebPinSuccessExperience:function w(t){t&&o.instance.completePlacedExperience(n.GEN.Placement.WEB_PIN_SUCCESS,t)},onBoardFollow:function O(){this.closeOnDelay(v)},onDestroyed:function D(){"pin_create_ignition"===this.options.action&&d.instance.publish(n.PUBSUB_CHANNEL_TUTORIAL,n.PUBSUB_TOPIC_TUTORIAL_NEXT)},_viewExtensionUpsellExperience:function x(){h.trackEvent("web_pin_success_extension_upsell","viewed"),r.getInstance().logCustomViewEvent(n.GEN.ViewType.SAVE,n.GEN.ViewParameterType.EXTENSION_UPSELL_NAG_PIN_CREATE)},_completeExtensionUpsellExperience:function L(){h.trackEvent("web_pin_success_extension_upsell","completed"),r.getInstance().logCustomViewEvent(n.GEN.ViewType.SAVE,n.GEN.ViewParameterType.EXTENSION_INSTALLED)}});S.prototype.className="PinCreateSuccess",t.exports=s.register(S)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(683),i(150);var a=o.extend({events:{"click .CSRDomainSuggestions":"onSuggestionsClick"},onSuggestionsClick:function r(){window.parent.postMessage("navigate",n.PIN_IT_DOMAIN)}});a.prototype.className="CSRCreateSuccess",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="CSRDomainSuggestions",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(150);var o=n.extend({onContentReady:function a(){this.hasBoard||this.hide()},hasBoard:function r(){return!!this.getChildById("board")},getBoardId:function l(){return this.extraData.boardId}});o.prototype.className="PinCreateSuccessBoard",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(150);var o=n.extend({hasBoard:function a(){return!!this.getChildById("board")},getBoardId:function r(){return this.extraData.boardId}});o.prototype.className="PinCreateSuccessBulkAction",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="PinCreateSuccessExtensionNag",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(665),s=i(19),o=i(11),a=i(18),r=i(8);i(116),i(120),i(225),i(222);var l=n.extend({onContentReady:function h(){n.prototype.onContentReady.call(this);var t=this.getChildById("doneButton");t&&this.listen(t,o.EVENT_BUTTON_CLICK,this.onDone)},onDone:function d(t){this.showLoading();var e={board_id:this.data&&this.data.id},i=this.getChildById("placeLayoutCheckbox");i&&(e.layout=i.isChecked()?"places":"default");var n=r.create("BoardResource",e),s=this.options.pinCreateInfo,o=function(){s&&a.load(s).then(function(t){this.showInModal(t),this.hideLoading(),this.destroy()}.bind(this))}.bind(this);n.callUpdate({showError:!1}).fin(o)}});l.prototype.className="PinCreateSuccessBoardEdit",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(34),a=3e3,r=n.extend({onContentReady:function l(){this.closeOnDelay(a)},closeOnDelay:function h(t){o.setTimeout(function(){this.destroy()}.bind(this),t)}});r.prototype.className="PinCreateSuccessToast",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(151);var o=n.extend({});o.prototype.className="RepinsLikesFeedPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(102),s=i(232),o=i(19),a=i(11),r=i(50),l=i(18);i(116),i(173);var h="upload_button",d="url_button",c="browser_button",u=r.extend({onContentReady:function p(){this.childListen(a.EVENT_BUTTON_CLICK,this.onButtonClick),n.fileinput||this.$(".pinUpload").remove()},onButtonClick:function _(t){var e=t.target,i=e.id,n;e.showLoading(),e.$el.blur(),i===h?n={name:"PinUploader",options:{}}:i===d?n={name:"AddPinURL",options:{show_title:!0,pinmarklet_link_element_type:a.GEN.ElementType.ADD_PIN_REP_BOOKMARKLET}}:i===c&&(n={name:"BrowserButtonUpsell",options:{extension_installed:!!s.isExtensionInstalled(),suppress:!0}});var o=this.options.default_board_id;o&&(n.options.default_board_id=o),n&&l.load(n).then(function(t){e.hideLoading(),this.modal?this.modal.setSubmodule(t):this.showInModal(t)}.bind(this))}});u.prototype.className="AddPin",t.exports=o.register(u)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(692),i(116);var o=n.extend({});o.prototype.className="AddPinRepWithPromote",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(565),s=i(19),o=i(13),a=i(46),r=n.extend({events:{click:"onClick"},onClick:function l(t){t.stopPropagation(),t.preventDefault(),a.isLimitedLogin()?o.showLogin(this):this.showModalSubmodule()}});r.prototype.className="AddPinRep",t.exports=s.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(115),a=i(50),r=i(232),l=i(35),h=i(14),d=i(31),c=i(104);i(116);var u=a.extend({events:{"click .pinmarkletLink":"onPinmarkletLinkClick"},onContentReady:function p(){var t=this.$(".standardForm"),e={prevalidate:!0,message:h._("Where do you want to Pin from?")},i={url:[c.Required(e),c.URL()]};this.form=new o(t,i,e),this.form.getField("url").placeholder(),this.listen(this.form,n.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onPinmarkletLinkClick:function _(){this.logPinmarkletLinkClick(),r.isExtensionInstalled()?l.showError(h._("Oops! You already have the browser button.")):r.handleExtensionInstall(function(){this.destroy()}.bind(this),function(){l.showError(h._("Oops! The download didn't work."))})},logPinmarkletLinkClick:function g(){this._logCustomContextEvent(n.GEN.EventType.CLICK,this.options.pinmarklet_link_element_type,n.GEN.ComponentType.MODAL_ADD_PIN,{})},onSubmitValidated:function m(t){if(!t.errors[0]){var e=this.form.getValue("url").trim(),i=this.options.use_domain_on_redirect?n.GEN.Settings.CANONICAL_MAIN_URL:"";this.navigate(i+"/pin/find/?"+d.getQueryStringFromObject({url:e}))}}});u.prototype.className="AddPinURL",t.exports=s.register(u)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50);i(151);var a=o.extend({onContentReady:function r(){this.imagesGrid=this.getChildById("imagesGrid"),this.childListen(n.EVENT_CONTENT_CHANGED,this.onChildContentChanged);var t=this.getChildById("domainPinsGrid");t&&0===t.children.length?t.destroy():this.$(".domainPinsHolder").css("visibility","visible")},onChildContentChanged:function l(){this.imagesGrid&&!this.imagesGrid.hasItems()&&(this.resource=null,this.render())}});a.prototype.className="ImagesFeedPage",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(217),l=i(79),h=i(80),d=i(81),c=i(67),u=i(31),p=a.extend({events:{dragdrop:"onOverlayDrop",drop:"onOverlayDrop",dragleave:"onOverlayLeave",click:"onOverlayLeave"},onOverlayDrop:function _(t){t.preventDefault(),this.options.file_drop?this._createFromFileDrop(t.originalEvent.dataTransfer):this._createFromWebsiteDrop(t.originalEvent.dataTransfer)},onOverlayLeave:function g(t){t.preventDefault(),this.removeOverlay()},removeOverlay:function m(){this.destroy()},ensurePinCreate:function f(t,e,i,n){var o={image_url:t,action:e?"create":"upload",method:"uploaded",render_existing_pin:!0},a={description:e?n||"":"",image_url:t,link:e?i:""},l=e?s.GEN.EventType.DRAG_AND_DROP_FROM_BROWSER:s.GEN.EventType.DRAG_AND_DROP_FROM_FILE,c={container_class:"webNewContentNewRepin",mask_type:"webNewContentNewRepin",modal_style:"webNewContentNewRepin",custom_entrance_animation:!0,custom_exit_animation:!0},u=new r({options:o,id:"pinCreate",resource:{name:"FakePinResource",options:a}});return this.showLoading(),u.render().then(function(){var t=h.fromEventType(l);return d.getInstance().addEvent(t),this.hideLoading(),this.showInModal(u,c),this.triggerEvent(s.EVENT_PIN_CREATE_OPENED,null,!0),this.removeOverlay(),Promise.resolve()}.bind(this))},_createFromFileDrop:function C(t){var e=t&&t.files;if(!e||!e.length)return void this.removeOverlay();if(!(new XMLHttpRequest).upload)return void this.removeOverlay();var i=new FormData;i.append("img",e[0]);var n=new XMLHttpRequest;n.open("POST",u.absolutify("/upload-image/")),n.setRequestHeader("Cache-Control","no-cache"),n.setRequestHeader("X-CSRFToken",c.getCSRFToken()),n.onload=function(){200===n.status?(this._uploadingFilesSpinner.stop(),this.ensurePinCreate(JSON.parse(n.responseText).image_url,!1,null,null)):this.removeOverlay()}.bind(this),this._uploadingFilesSpinner=new l({}),this._uploadingFilesSpinner.spin(this.$el),this.$(".overlayText").hide(),n.send(i)},_createFromWebsiteDrop:function E(t){var e=t.getData("text/uri-list"),i=t.getData("text/html");if(!e||!i)return void this.removeOverlay();var s=n("<div>"+i+"</div>").find("img");return s.length?(this._uploadingFilesSpinner=new l({}),this._uploadingFilesSpinner.spin(this.$el),this.ensurePinCreate(s[0].src,!0,e,s[0].alt),void this.$(".overlayText").hide()):void this.removeOverlay()}});p.prototype.className="PinDragAndDrop",t.exports=o.register(p)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(666),r=i(29),l=i(14),h=i(18),d=i(23),c=i(8);i(697);var u=o.extend({_onButtonClick:function p(t){var e=t.target;switch(e.id){case"submitButton":r.trackEvent(n.GA_CATEGORY_PIN_EDIT,n.GA_ACTION_CLICK_SUBMIT);break;case"cancelButton":r.trackEvent(n.GA_CATEGORY_PIN_EDIT,n.GA_ACTION_CLICK_CANCEL);break;case"deleteButton":r.trackEvent(n.GA_CATEGORY_PIN_DELETE,n.GA_ACTION_OPEN_MODAL),this.showConfirmation()}},savePin:function _(){var t=this.data.id,e=this.pinForm.getData();e.id=t;var i=c.create("PinResource",e);this.showLoading(!0),i.callUpdate().then(function(i){r.trackEvent(n.GA_CATEGORY_PIN_EDIT,n.GA_ACTION_SUCCESS);var s=i.resource_response.data;if(!this.refreshOnSave&&this.isInModal()){d.instance.publish(t,n.PUBSUB_TOPIC_PIN_UPDATED,s);var o=e.board_id,a=this.data.board.id;o!==a&&(d.instance.publish(o,n.PUBSUB_TOPIC_PIN_CREATED),d.instance.publish(a,n.PUBSUB_TOPIC_PIN_DELETED)),this.destroy()}else{var l="/pin/"+t+"/";this.navigate(l)}}.bind(this),function(t){r.trackEvent(n.GA_CATEGORY_PIN_EDIT,n.GA_ACTION_ERROR)}).fin(function(){this.hideLoading()}.bind(this))},onDeleteConfirm:function g(){r.trackEvent(n.GA_CATEGORY_PIN_DELETE,n.GA_ACTION_CLICK_SUBMIT),this.deletePin()},deletePin:function m(){var t=this.data.id,e={id:t},i=c.create("PinResource",e);this.showLoading(!0),i.callDelete().then(function(){if(r.trackEvent(n.GA_CATEGORY_PIN_DELETE,n.GA_ACTION_SUCCESS),d.instance.publish(this.data.board.id,n.PUBSUB_TOPIC_PIN_DELETED),d.instance.publish(this.data.pinner.id,n.PUBSUB_TOPIC_PIN_DELETED),!this.refreshOnSave&&this.isInModal())d.instance.publish(t,n.PUBSUB_TOPIC_PIN_DELETED),this.destroy();else{var e=this.data.board.url;this.navigate(e)}}.bind(this),function(){r.trackEvent(n.GA_CATEGORY_PIN_DELETE,n.GA_ACTION_ERROR)}).fin(function(){this.hideLoading()}.bind(this))},onContentReady:function f(){if(a.checkForAutologin()){var t=l._("To edit your Pin, please take a second to confirm it's really you.");return a.showLoginErrorDialog(this,t),void this.destroy()}this.pinForm=this.getChildById("pinForm"),this.childListen(n.EVENT_ITEM_SELECTED,this.onPlaceTypeaheadItemSelected),this.refreshOnSave=!1,this.listen(this.pinForm,n.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(n.EVENT_BUTTON_CLICK,this._onButtonClick)},onPlaceTypeaheadItemSelected:function C(t){var e=t.data.item,i=e.get("id");this.$(".pinPlaceId").val(i)},onSubmitValidated:function E(t){var e=t.data;e.errors[0]||(this.needConfirm()?this.showPrivacyChangeConfirmation():this.savePin())},needConfirm:function v(){var t=this.data.board.privacy,e=this.pinForm.getBoardPicker(),i=e.getSelectedBoardPrivacy();return t===n.BoardPrivacy.SECRET&&i===n.BoardPrivacy.PUBLIC},showConfirmation:function I(){var t={name:"ConfirmDialog",options:{template:"delete_pin",ga_category:n.GA_CATEGORY_PIN_DELETE}};h.load(t).then(function(t){this.showInModal(t),this.listen(t,n.EVENT_CONFIRM,this.onDeleteConfirm)}.bind(this))},showPrivacyChangeConfirmation:function T(){var t={name:"ConfirmDialog",options:{template:"change_pin_privacy"}};h.load(t).then(function(t){this.showInModal(t),this.listen(t,n.EVENT_CONFIRM,function(){r.trackEvent(n.GA_CATEGORY_PIN_EDIT,n.GA_ACTION_CLICK_CONFIRM),this.savePin()})}.bind(this))}});u.prototype.className="PinEdit",t.exports=s.register(u)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(243),r=i(115),l=i(133),h=i(698),d=i(14),c=i(17),u=i(46),p=i(104);i(116),i(120),i(699),i(702),i(174),i(128),i(703),i(237),i(653);var _=l.FACEBOOK,g=l.TWITTER,m=".socialShareWrapper",f=h.extend({events:{'change [name="share_facebook"]':"onFacebookCheckboxChanged","focus .PlaceSelector input":"onPlaceSelectorFocus",click:"_onClick"},setImage:function C(t){this.options.image_url=t;var e=this.getChildById("pinPreview");e.setImage(t)},_onClick:function E(t){var e=n(t.target).closest(".PlaceSelector").length;if(!e){var i=this.getPlaceSelector();if(i){var s=i.getTypeaheadField(),o=s.getTypeahead();o.isOpen()&&o.hide()}}},getPlaceSelector:function v(){return this.getChildById("placeSelector")},onPlaceSelectorFocus:function I(t){var e=this.getPlaceSelector();if(e){var i=e.getTypeaheadField(),n=i.getTypeaheadItemsToRender(),s=n&&n.length>0;if(s){var o=i.getTypeahead();o.show()}}},onCreated:function T(){h.prototype.onCreated.apply(this,arguments),this.networkToSelectorMap={},this.networkToSelectorMap[_]='[name="share_facebook"]',this.networkToSelectorMap[g]='[name="share_twitter"]'},onItemSelected:function N(t){this.getChildById("removePlaceButton").show()},onFacebookCheckboxChanged:function S(t){var e=this.getNetworkChecked(_);u.set(s.FB_PUBLISH_KEY,e),e&&a.maybeRequestFbTimelinePermission({error:function(){this.setNetworkChecked(_,!1),u.set(s.FB_PUBLISH_KEY,!1)}.bind(this)})},onContentReady:function b(){var t={message:d._("Don't forget a description!")},e={description:[p.Required(t),p.Length({max:s.MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION})]};this.form=new r(this.$("form"),e),this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(s.EVENT_CHANGE,this._onChildChange),this.childListen(s.EVENT_ITEM_SELECTED,this.onItemSelected),this.childListen(s.EVENT_BUTTON_CLICK,this.onButtonClick);var i=this.getBoardPicker();i.getSelectedBoardPrivacy()===s.BoardPrivacy.SECRET&&this.hideSocialExplicitSharing();var n=this.getChildById("uploader");n&&this.listen(n,s.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess)},onButtonClick:function y(t){var e=t.target;"removePlaceButton"===e.id&&this.removePlace()},removePlace:function P(){this.$(".pinPlaceId").val(0);var t=this.getPlaceSelector(),e=t.getTypeaheadField();e.reset(),e.enableInput(),this.getChildById("removePlaceButton").hide()},_onChildChange:function B(t){if("boardPicker"===t.target.id){var e=t.data;e.privacy===s.BoardPrivacy.SECRET?this.hideSocialExplicitSharing():this.showSocialExplicitSharing()}},hideSocialExplicitSharing:function A(){this.$(m).hide()},showSocialExplicitSharing:function R(){this.$(m).show()},onSubmitValidated:function w(t){this.triggerEvent(s.EVENT_SUBMIT_VALIDATED,t,!0)},onUploadSuccess:function O(t){var e=t.data.image_url,i=this.getChildById("pinPreview");i.setImage(e),this.options.image_url=e},getBoardPicker:function D(){return this.getChildById("boardPicker")},getBoardId:function x(){return this.getBoardPicker().getSelectedBoardId()},getDescription:function L(){return this.getChildById("pinDescriptionField").getValue()},setNetworkChecked:function k(t,e){var i=this.networkToSelectorMap[t];i&&this.$(i).prop("checked",e)},getNetworkChecked:function U(t){var e=this.networkToSelectorMap[t];if(e){var i=this.$(e);return i.length?i.is(":checked"):""}},getImageUrl:function M(){return this.options.image_url},getLink:function F(){return this.$("#pinFormLink").val()||""},getData:function $(){var t={board_id:this.getBoardId(),description:this.getDescription(),link:this.getLink()},e=this.getNetworkChecked(l.TWITTER);""!==e&&(t.share_twitter=e),e=this.getNetworkChecked(l.FACEBOOK),""!==e&&(t.share_facebook=e);var i=this.getImageUrl();if(i&&(t.image_url=i,c.beginsWith(i,"//"))){var n=document.referrer;if(n){var s;c.beginsWith(n,"http://")?s="http:":c.beginsWith(n,"https://")&&(s="https:"),s&&(t.image_url=s+t.image_url)}}var o=this.$(".pinPlaceId");if(o.length){t.place=o.val();var a=this.getPlaceSelector();if(a){var r=a.getTypeaheadField(),h=r.getValue();(0===h.length||"0"===o.val())&&(t.place=0)}}return this.data&&this.data.source_interest&&(t.source_interest_id=this.data.source_interest.id),t}});f.prototype.className="PinForm",t.exports=o.register(f)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(133),r=i(227),l=i(35),h=i(14),d=i(18),c=o.extend({FB_PUBLISH_ACTIONS_PERMISSION:"publish_actions",onCreated:function u(){this.childListen("change",this.onChildChange);var t={};t[n.PUBSUB_TOPIC_SOCIAL_NETWORK_UPDATED]=this.onSocialNetworkUpdated,this.pubsubSubscribe(n.PUBSUB_CHANNEL_CURRENT_USER,t)},disconnectFromSocial:function p(t,e,i){this.showLoading(!0);var n={error:function o(){t.toggle()},complete:function(){this.hideLoading()}.bind(this)},s=r.instance();s.handleConnect(i,e,n)},onChildChange:function _(t){var e=t.target,i=e.isChecked&&e.isChecked(),n=null;switch(e.id){case"facebookToggle":if(!(i&&!this.extraData.facebookUrl||!i&&this.extraData.facebookUrl))return;n=a.FACEBOOK;break;case"twitterToggle":if(!(i&&!this.extraData.twitterUrl||!i&&this.extraData.twitterUrl))return;n=a.TWITTER;break;case"gplusToggle":if(!(i&&!this.extraData.gplusUrl||!i&&this.extraData.gplusUrl))return;n=a.GPLUS;break;case"googleToggle":if(!(i&&!this.extraData.connected_to_google||!i&&this.extraData.connected_to_google))return;n=a.GOOGLE;break;case"yahooToggle":if(!(i&&!this.extraData.connected_to_yahoo||!i&&this.extraData.connected_to_yahoo))return;n=a.YAHOO;break;case"rakutenToggle":if(!(i&&!this.extraData.connected_to_rakuten||!i&&this.extraData.connected_to_rakuten))return;n=a.RAKUTEN;break;case"microsoftToggle":if(!(i&&!this.extraData.connected_to_microsoft||!i&&this.extraData.connected_to_microsoft))return;n=a.MICROSOFT;break;default:return}if(i||this.extraData.has_password)this.disconnectFromSocial(e,i,n);else{var s={name:"UserChangePassword",options:{has_password:!1,render_social_networks:!1}},o=!1;d.load(s).then(function(t){this.showInModal(t),this.listen(t,"destroyed",function(){o?this.disconnectFromSocial(e,i,n):(l.showError(h._("A password must be set before unlinking.")),e.toggle())}),this.listen(t,"success",function(){o=!0})}.bind(this))}},onSocialNetworkUpdated:function g(){this.render()}});c.prototype.className="UserSocialNetworkSettings",t.exports=s.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(67),o=i(50),a=i(30),r=i(35),l=i(14),h=i(19),d=i(31);i(116);var c=o.extend({CssClassName:{IS_SELECTED:"selected"},onCreated:function u(){this.onUploaderSubmit=this.onUploaderSubmit.bind(this),this.onUploaderComplete=this.onUploaderComplete.bind(this),this.onUploaderProgress=this.onUploaderProgress.bind(this),this.onUploaderError=this.onUploaderError.bind(this)},enable:function p(){this.getButton().enable()},disable:function _(){this.getButton().disable()},select:function g(){this._setSelected(!0)},_setSelected:function m(t){this.$el.toggleClass(this.CssClassName.IS_SELECTED,t)},deselect:function f(){this._setSelected(!1)},onContentReady:function C(){this.ensureUploader()},getUploadUrl:function E(){return d.absolutify("/upload-image/")},getFileNameElement:function v(){return this.$fileName||(this.$fileName=this.$(".uploaderProgress").find("span")),this.$fileName},getButton:function I(){return this.getChildById("upload")},ensureUploader:function T(){i.e(8,function(){var t=i(700);this.uploader=new t.FineUploaderBasic({debug:a.DEBUG,button:this.getButton().$el.get(0),multiple:!1,request:{endpoint:this.getUploadUrl(),inputName:"img",forceMultipart:!0,customHeaders:{"X-CSRFToken":s.getCSRFToken()}},callbacks:{onUpload:this.onUploaderSubmit,onComplete:this.onUploaderComplete,onProgress:this.onUploaderProgress,onError:this.onUploaderError,showAlert:function(t){this.log.debug(t)}.bind(this)}})}.bind(this))},onUploaderSubmit:function N(t,e){this.getButton().showLoading(),this.triggerEvent(n.EVENT_UPLOAD_START),this.log.debug("UploaderSubmit",arguments)},onUploaderComplete:function S(t,e,i){i.success&&(this.getButton().hideLoading(),this.triggerEvent(n.EVENT_UPLOAD_SUCCESS,i,!0),this.getFileNameElement().text(i.filename),this.log.debug("UploaderComplete",arguments))},onUploaderProgress:function b(t,e,i,s){var o=Math.round(i/s*100);this.triggerEvent(n.EVENT_UPLOAD_PROGRESS,{loaded:i,total:s,percent:o}),this.getFileNameElement().text(o+"%"),this.log.debug("UploaderProgress",arguments)},resetFileNameElement:function y(){this.getFileNameElement().text("")},onUploaderError:function P(t,e,i){this.getButton().hideLoading(),this.log.debug("UploaderError",arguments),i===n.RESPONSE_CODE_REQUEST_TOO_LARGE?r.showError(l._("Oops! That file is too big. Please make it smaller and try again.")):r.showError(l._("Oops! Uploading that image didn't work. Please try again.")),this.resetFileNameElement()}});c.prototype.className="ImageUploader",t.exports=h.register(c)},,,function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({setImage:function a(t){this.options.image_url=t,this.showLoading(!0);var e=function(){this.hideLoading()}.bind(this),i=this.$("img").get(0);i&&(i.onerror=i.onload=e,i.src=t)}});o.prototype.className="PinPreview",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(50);i(228);var r=a.extend({onContentReady:function l(){this._placeChanged=!1,this.childListen(s.EVENT_ITEM_SELECTED,this.onItemSelected),this.childListen(s.EVENT_TYPEAHEAD_SEARCH_START,this.onSearchStart),this.childListen(s.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,this.onNoResultsReturned),this.childListen(s.EVENT_TYPEAHEAD_RESULTS_RETURNED,this.onResultsReturned),this.childListen(s.EVENT_TYPEAHEAD_HINT,this.onHint)},onHint:function h(t){this.hintData=t.data,this.options.show_hints&&this.determineHint()},determineHint:function d(){if(this.hintData&&this.hintData.length){var t=this.getTypeaheadField();if(n.isEmpty(this.results))t.setPrependedStaticItems([{template:"hint_no_city",selectable:!1}]);else{var e=this.hintData[0].feature.name,i=e;-1!==e.indexOf(",")&&(i=e.split(",")[0]),t.setPrependedStaticItems([{template:"hint_specific_city",selectable:!1,locality:i,place:e}])}}},onNoResultsReturned:function c(t){this.results=t.data;var e=this.getTypeaheadField();e.setPrependedStaticItems([]),this.hideTypeaheadLoading()},getTypeaheadField:function u(){return this.getChildById("placeField")},onResultsReturned:function p(t){this.results=t.data;var e=this.getTypeaheadField();e.setPrependedStaticItems([]),this.hideTypeaheadLoading()},onSearchStart:function _(t){var e=this.getTypeaheadField();e.showLoading()},hideTypeaheadLoading:function g(){var t=this.getTypeaheadField();t.hideLoading()},getSelectedPlace:function m(){if(!this._placeChanged)return null;var t=this.getTypeaheadField();if(!t)return"0";var e=t.getTypeaheadSelectedItem();if(!e)return"0";var i=e.get("id");return i?i:"0"},focusPlaceField:function f(){var t=this.getTypeaheadField();t.focus()},onItemSelected:function C(t){this._placeChanged=!0;var e=t.data.item,i=this.getTypeaheadField(),n=e.get("name");i.setValue(n)}});r.prototype.className="PlaceSelector",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(217),r=i(29);i(699);var l=o.extend({onContentReady:function h(){var t=this.getChildById("uploader");this.listen(t,n.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess)},onUploadSuccess:function d(t){r.trackEvent("pin_upload",n.GA_ACTION_SUCCESS),this.imageUrl=t.data.image_url,this.ensurePinCreate()},ensurePinCreate:function c(){var t={image_url:this.imageUrl,action:"upload",method:"uploaded",render_existing_pin:!0};this.options.default_board_id&&(t.default_board_id=this.options.default_board_id);var e={container_class:"webNewContentNewRepin",mask_type:"webNewContentNewRepin",modal_style:"webNewContentNewRepin",custom_entrance_animation:!0,custom_exit_animation:!0},i=new a({id:"pinCreate",options:t,resource:{name:"FakePinResource",options:{description:"",image_url:this.imageUrl,link:""}}});return this.showLoading(),i.render().then(function(){return this.hideLoading(),this.showInModal(i,e),this.triggerEvent(n.EVENT_PIN_CREATE_OPENED,null,!0),this.destroy(),Promise.resolve()}.bind(this))}});l.prototype.className="PinUploader",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(706),a=i(115),r=i(50),l=i(35),h=i(14),d=i(23),c=i(8),u=i(46);i(116);var p=r.extend({events:{"click .helpText a":"onClickType","click .downloadLink":"onClickDownload"},onCreated:function _(){this.METATAG="metatag",this.FILENAME="filename",this.verificationType=this.METATAG},onContentReady:function g(){this.formListener&&this.removeListener(this.formListener),this.form=new a(this.$("form"),[]),this.formListener=this.listen(this.form,n.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.downloadButton=this.getChildById("downloadButton"),this.downloadButton&&this.listen(this.downloadButton,n.EVENT_BUTTON_CLICK,this.onClickDownload)},onClickType:function m(){this.swapVerificationType()},onClickDownload:function f(){o("/website/confirm/download/")},onSubmitValidated:function C(t){t.errors[0]||this.verifyDomain()},swapVerificationType:function E(){this.$(".filename, .metaTag").toggle(),this.verificationType===this.METATAG?this.verificationType=this.FILENAME:this.verificationType=this.METATAG},verifyDomain:function v(){var t=this.getChildById("submitButton");t.showLoading();var e=u.attributes.domain_url,i=h._("Looks like we had trouble connecting to your website. Please try again later."),s=c.create("DomainVerifyResource",{type:this.verificationType}),o=c.create("DomainResource",{field_set_key:"owner",domain:e});return s.callUpdate().then(function(){return o.callGet({retries:2,retryAfter:1e3,showError:!1})},function(){l.showError(i)}).then(function(){return this.isInModal()?(d.instance.publish(n.PUBSUB_CHANNEL_CURRENT_USER,n.PUBSUB_TOPIC_USER_UPDATED),d.instance.publish(u.attributes.id,n.PUBSUB_TOPIC_USER_UPDATED),this.destroy()):this.navigate("/"),!0}.bind(this),function(){var t=h._("We're still working on confirming your site. Please sit tight, sometimes it takes up to an hour.");l.showError(t)}).fin(function(){t.hideLoading()})}});p.prototype.className="DomainVerify",t.exports=s.register(p)},function(t,e){"use strict";var i=function n(t){var e="downloaderIFrame",i=document.getElementById(e);null===i&&(i=document.createElement("iframe"),i.id=e,i.style.display="none",document.body.appendChild(i)),i.src=t};t.exports=i},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(14),r=i(18),l=i(17),h=o.extend({onContentReady:function d(){var t="",e,i="",s="";null!==this.options.domain?(t=l.format(a._("Congratulations! Check out your analytics page to see how  popular your Pins are on Pinterest.")),i=a._("Go To Analytics"),s=a._("Website confirmed")):(t=l.format(a._("Oops! We weren't able to verify your website. Write to us at the help center for more information.")),i=a._("Go to the help center"),s=a._("Trouble verifying your website")),e={name:"ConfirmDialog",options:{body_message:t,button_text:i,template:"generic",title:s}},r.load(e).then(function(t){this.showInModal(t),this.listen(t,n.EVENT_CONFIRM,this.onConfirmClick)}.bind(this))},onConfirmClick:function c(){var t="";t=null===this.options.domain?"/_/_/help/":n.GEN.Settings.ANALYTICS_SITE_URL,this.navigate(t)}});h.prototype.className="DomainVerifyByLink",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(138),a=i(134),r=i(50),l=i(666),h=i(152),d=i(14),c=i(13),u=i(18),p=i(46);i(125);var _=r.extend({events:{"click .reportBug":"openReportBugModal","click .getHelp":"openHelpDropdown","click .blockUser":"onBlockUser","click .sendProfile":"sendProfile","click .sendMessage":"sendUserMessage","click .userMenuFindBoards":"openFindBoards","click .userMenuCreateBoard":"openCreateBoard","click .userMenuAddPin":"openAddPin","click .userMenuUploadPin":"openUploadPin","click .userMenuEditProfile":"openEditProfile","click .userMenuMakeAWidget":"openMakeAWidget","click .settings":"onSettingsClick","click .userMenuMakeABoardWidget":"openMakeABoardWidget","click .sendBoard":"sendBoard","click .shareBoardOnFacebook":"onClickShareBoardOnFacebook"},onCreated:function g(){this._help_dropdown=null},onSettingsClick:function m(t){if(t.stopPropagation(),t.preventDefault(),p.isLimitedLogin())c.showLogin(this);else if(l.checkForAutologin()){var e=d._("To get to your settings, please take a second to confirm it's really you.");l.showLoginErrorDialog(this,e)}else this.navigate("/settings/")},getFindFriendsElement:function f(){return this.$(".userMenuFindFriends").parent().eq(0)},getMyBoardsElement:function C(){return this.$(".myBoards").parent().eq(0)},getFindBoardsElement:function E(){return this.$(".userMenuFindBoards").parent().eq(0)},openFindBoards:function v(){var t={name:"FastFollow",resource:{name:"UserResource",options:{username:p.get("username"),field_set_key:"fast_follow"}},options:{post_orientation:!0}};return this.showLoading(),u.load(t).then(function(t){this.hideLoading(),this.showInModal(t,{can_dismiss:!0,container_class:"fastFollowContainer"})}.bind(this)),!1},openReportBugModal:function I(t){t.preventDefault();var e={name:"ReportBug",options:{shrinkToFit:!0}};return this.showLoading(),u.load(e).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this)),!1},openHelpDropdown:function T(t){t.preventDefault(),null===this._help_dropdown&&(this._help_dropdown=new o({options:{anchor:this.$("a.getHelp"),position_point:"LEFT_TOP",module:{name:"HelpMenu",options:{}}}})),this._help_dropdown.isVisible()||this._help_dropdown.slideIn(200)},onBlockUser:function N(t){var e=this.options.user,i={name:"UserBlock",options:{full_name:e.full_name,first_name:e.first_name,username:e.username,blocked_by_me:e.blocked_by_me,user_id:e.id}};return u.load(i).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this)),!1},sendProfile:function S(t){if(t.stopPropagation(),t.preventDefault(),p.isLimitedLogin())c.showLogin(this);else{var e=this.options.user,i={name:"SendPinner",options:{class_name:"modal",object_type:"user",object_id:e.id,object_image_url:e.image_large_url,object_description:e.bio,object_url:"/"+e.username,view_type:"sendShare"}};this.showLoading(),u.load(i).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this))}},sendUserMessage:function b(t){if(p.isLimitedLogin())c.showLogin(this);else{var e=[this.options.user.id];h.sendMessageToUsers(e,[],{text:null}).then(function(){this.triggerEvent(n.EVENT_DISMISS,null,!0),this.render()}.bind(this)),t.stopPropagation()}},openCreateBoard:function y(){var t={name:"BoardCreate",options:{}};return this.showLoading(),u.load(t).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this)),!1},openAddPin:function P(){var t={name:"AddPinURL",options:{shrinkToFit:!0,show_title:!0
}};return this.showLoading(),u.load(t).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this)),!1},openUploadPin:function B(){var t={name:"PinUploader",options:{shrinkToFit:!0,show_title:!0}};return this.showLoading(),u.load(t).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this)),!1},openEditProfile:function A(){var t={name:"UserEdit",resource:{name:"UserSettingsResource",options:{}},options:{user_id:this.options.user_id}};return this.showLoading(),u.load(t).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this)),!1},openMakeAWidget:function R(){var t={name:"EmbedPinner",options:{user:this.options.user}};return this.showLoading(),u.load(t).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this)),!1},openMakeABoardWidget:function w(){var t={name:"EmbedBoard",options:{board:this.options.board,class_name:"v2"}};return this.showLoading(),u.load(t).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this)),!1},sendBoard:function O(t){if(t.preventDefault(),p.isLimitedLogin())c.showLogin(this);else{var e=this.options.board,i={name:"SendBoard",options:{class_name:"newBoardHeaderStyle",object_type:"board",object_id:e.id,object_image_url:e.image_cover_url,object_description:e.description,object_url:e.url,view_type:"sendShare"}};this.showLoading(),u.load(i).then(function(t){this.hideLoading(),this.showInModal(t)}.bind(this))}return!1},onClickShareBoardOnFacebook:function D(){if(p.isAuthenticated()){var t=this.options.board,e=n.GEN.Settings.CANONICAL_MAIN_URL+t.url,i={object_type:"board",type:"feed",object_id:t.id,path:e};a.open(i),this.triggerEvent(n.EVENT_DISMISS,null,!0)}return!1}});_.prototype.className="UserDropdown",t.exports=s.register(_)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=i(126),a=i(34),r=i(31);i(137),i(509),i(568);var l=7e3,h=25,d=n.extend({CssClassName:{FOLLOWED:"followed",HIDDEN:"hidden"},onContentReady:function c(){this.followButton=this.getChildById("followButton"),this.followButton&&(this.listen(this.followButton,"toggleFollow",this._onToggleFollowButton),this._attemptAutoFollow()),this._setHeightOfFollowPinsModule()},_setHeightOfFollowPinsModule:function u(){var t=this.$el.find(".userProfileFakeHeader"),e=this.getChildByModuleName("UserFollowPinsPreview");if(t.length&&e){var i=t.height();e.setHeight(o.height-i)}},_onToggleFollowButton:function p(t){this.followButton.getState()?(this._addFollowedAnimation(),this.$(".userProfileFollowButton").addClass(this.CssClassName.HIDDEN),this.$(".postUnFollow").addClass(this.CssClassName.HIDDEN),this.$(".postFollow").removeClass(this.CssClassName.HIDDEN),a.setTimeout(function(){window.close()},l)):this.$(".postUnFollow").removeClass(this.CssClassName.HIDDEN)},_addFollowedAnimation:function _(){var t=this.data&&this.data.pin_count||0;t>=h&&this.$(".UserFollowPinsPreview").addClass(this.CssClassName.FOLLOWED)},_getReferrer:function g(){return document.referrer},_attemptAutoFollow:function m(){var t=this.data.is_partner,e=this.data.followed_by_me,i=this.data.domain_url,n=this._getReferrer();t&&!e&&i&&n&&(i=r.absolutify(i,"http:",""),r.parse(n).hostname===r.parse(i).hostname&&this.followButton.toggleFollow())}});d.prototype.className="UserProfileFollow",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(35),r=i(29),l=i(23),h=i(8);i(699);var d=o.extend({onContentReady:function c(){var t=this.getChildById("uploader");this.listen(t,n.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess),this.listen(t,n.EVENT_UPLOAD_ERROR,this.onUploadError)},onUploadSuccess:function u(t){r.trackEvent("user_profile_image_upload",n.GA_ACTION_SUCCESS),this.imageUrl=t.data.image_url,this.updateUserProfileImage()},onUploadError:function p(t){r.trackEvent("user_profile_image_upload",n.GA_ACTION_ERROR);var e=t.data;a.showError(e)},getUserSettingsResource:function _(){return h.create("UserSettingsResource",{profile_image_url:this.imageUrl})},updateUserProfileImage:function g(){this.showLoading();var t=this.getUserSettingsResource();t.callUpdate().then(function(t){this.onUpdateSuccess(t),this.hideLoading()}.bind(this))},onUpdateSuccess:function m(t){var e=t.resource_response;e.data.profile_image_url=this.imageUrl,l.instance.publish(this.options.user_id,n.PUBSUB_TOPIC_USER_UPDATED,e),this.destroy()}});d.prototype.className="UserProfileImageUploader",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="YourWebsiteDropdown",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(115),r=i(50),l=i(35),h=i(18),d=i(8),c=i(31),u=i(46),p=i(27),_=i(104);i(116),i(258);var g=r.extend({events:{"change input":"onInputChanged"},onContentReady:function m(){this.options.state_detailsShown="";var t={reason:[_.Required()]};this.form=new a(this.$("form"),t),this.submitButton=this.getChildById("submitButton"),this.submitButton.disable(),this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this._onSubmitValidated),this._logUninstallEvent()},updateDom:function f(){this.$("#accidental").toggle("accident"===this.options.state_detailsShown)},onInputChanged:function C(t){this.submitButton.enable(),this.updateOptionsAndDom({state_detailsShown:n(t.target).attr("value")})},_logUninstallEvent:function E(){var t=c.getQueryStringParams(),e=t.xuid,i=t.xv,n={type:"extension",event:"uninstall"};e&&(n.xuid=e),i&&(n.xv=i),p.logWidgetEvent(n)},_onSubmitValidated:function v(t){t.errors[0]||this._submitReason()},_onSuccess:function I(){var t={name:"ConfirmDialog",options:{template:"uninstall_extension_reason",view_type:"mediumWide"}};h.load(t).then(function(t){this.showInModal(t),this.listen(t,s.EVENT_CONFIRM,this.destroy),this.listen(t,s.EVENT_DESTROYED,this._successCancel)}.bind(this))},_onFailure:function T(t){l.showError(t)},_submitReason:function N(){var t=c.getQueryStringParams().xuid,e={user_id:u.id,reason:this.$('input:radio[name="reason"]:checked').val()};t&&(e.xuid=t);var i=d.create("UninstallBrowserExtensionResource",e);this.submitButton.showLoading(),i.callCreate().then(function(){this._onSuccess()}.bind(this),function(t){this._onFailure(t.message)}.bind(this)).fin(function(){this.submitButton.hideLoading()}.bind(this))},_successCancel:function S(){this.navigate("/"),this.destroy()}});g.prototype.className="BrowserExtensionUninstallPage",t.exports=o.register(g)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(115),r=i(50),l=i(35),h=i(18),d=i(8),c=i(46),u=i(104);i(116);var p=r.extend({events:{"change input":"onChange"},onContentReady:function _(){this.options.state_reason="";var t={reason:[u.Required()]};this.form=new a(this.$("form"),t),this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(s.EVENT_BUTTON_CLICK,this.onButtonClick),this.submitButton=this.getChildById("submitButton"),this.submitButton.disable()},onButtonClick:function g(t){var e=t.target;"deleteButton"===e.id&&this.deleteAccountConfirm()},onSubmitValidated:function m(t){t.errors[0]||this.deactivateAccount()},onChange:function f(t){this.submitButton.enable(),this.updateOptionsAndDom({state_reason:n(t.target).attr("value")})},updateDom:function C(){this.$("#emailSettings").toggle("emails"===this.options.state_reason),this.$("#otherText").toggle("other"===this.options.state_reason),this.$("#resetPassword").toggle("hacked"===this.options.state_reason),this.$("#explore").toggle("noInterestingPins"===this.options.state_reason),this.$("#exploreBox").toggle("noInterestingPins"===this.options.state_reason),this.$("#access").toggle("break"===this.options.state_reason),this.$("#infoMultipleAccounts").toggle("secondAccount"===this.options.state_reason),this.$("#businessLink").toggle("businessAccountWanted"===this.options.state_reason),this.$("#dislikeText").toggle("dislike"===this.options.state_reason),this.$("#dislikeBox").toggle("dislike"===this.options.state_reason),this.$("#understandText").toggle("understand"===this.options.state_reason),this.$("#understandBox").toggle("understand"===this.options.state_reason),this.$("#privacyText").toggle("privacy"===this.options.state_reason),this.$("#privacyBox").toggle("privacy"===this.options.state_reason)},deactivateAccount:function E(){this.submitButton.showLoading();var t={user_id:c.id,reason:this.$('input:radio[name="reason"]:checked').val()};"other"===t.reason?t.explanation=this.$('textarea[name="otherText"]').val():"privacy"===t.reason?t.explanation=this.$('textarea[name="privacyTextBox"]').val():"dislike"===t.reason?t.explanation=this.$('textarea[name="dislikeTextBox"]').val():"explore"===t.reason?t.explanation=this.$('textarea[name="exploreTextBox"]').val():"understand"===t.reason&&(t.explanation=this.$('textarea[name="understandTextBox"]').val());var e=c.get("email"),i={name:"ConfirmDialog",options:{template:"deactivate_account_success",view_type:"mediumWide",email:e}},n=d.create("DeactivateAccountResource",t);n.callCreate().then(function(t){h.load(i).then(function(t){this.showInModal(t),this.listen(t,s.EVENT_CONFIRM,this.closeModalAndNavigate),this.listen(t,s.EVENT_DESTROYED,this.closeModalAndNavigate)}.bind(this))}.bind(this)).fail(function(t){l.showError(t.message)}).always(function(t){this.submitButton.hideLoading()}.bind(this))},closeModalAndNavigate:function v(){this.navigate("/"),this.destroy()},deleteAccountConfirm:function I(){var t={name:"ConfirmDialog",options:{email:c.get("email"),is_partner:c.get("is_partner"),template:"delete_account_confirm",view_type:"mediumWide"}};h.load(t).then(function(t){this.showInModal(t),this.listen(t,s.EVENT_CONFIRM,this.deleteAccount)}.bind(this))},deleteAccount:function T(){var t={name:"ConfirmDialog",options:{template:"delete_account_success",view_type:"mediumWide"}},e={user_id:c.id},i=d.create("DeleteAccountResource",e);i.callUpdate().then(function(e){h.load(t).then(function(t){this.showInModal(t),this.listen(t,s.EVENT_CONFIRM,this.closeModalAndNavigate),this.listen(t,s.EVENT_DESTROYED,this.closeModalAndNavigate)}.bind(this))}.bind(this)).fail(function(t){l.showError(t.message)})}});p.prototype.className="DeactivateAccount",t.exports=o.register(p)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="PinfluencerOptOutConfirmationPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(116);var o=n.extend({});o.prototype.className="SignedEmailDisassociatePage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(116);var o=n.extend({});o.prototype.className="SignedEmailSettingsPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="SignedEmailUnsubscribePage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(115),a=i(50),r=i(14),l=i(23),h=i(8),d=i(104);i(116);var c=a.extend({onContentReady:function u(){this.$form=this.$("form"),this.form=new o(this.$form,{email:[d.Required()]}),this.listen(this.form,n.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function p(t){t.errors[0]||this.updateEmail()},updateEmail:function _(){var t={},e=this.form.getValue("email");this.data.email.trim()!==e.trim()?t.email=e:t.email_bounced=!1;var i=h.create("UserSettingsResource",t);i.callUpdate().then(function(t){var e=t.resource_response.data;if(this.isInModal()){var i;i=e.email_changing_to?r._("Thanks! Your email update is pending. You should receive a confirmation email soon."):r._("Thanks! Your email has been updated. You should receive a confirmation email soon."),l.instance.publish(n.PUBSUB_CHANNEL_CURRENT_USER,n.PUBSUB_TOPIC_NAG_UPDATED,i),l.instance.publish(n.PUBSUB_CHANNEL_CURRENT_USER,n.PUBSUB_MESSAGE_USER_EMAIL_UPDATED,{}),this.destroy()}}.bind(this))}});c.prototype.className="UserEditEmail",t.exports=s.register(c)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(115),l=i(50),h=i(80),d=i(81),c=i(14),u=i(18),p=i(8),_=i(17),g=i(27),m=i(104);i(116),i(130),i(117),i(173),i(720),i(721),i(722),i(724),i(698);var f="https://www.google.com/webmasters/tools/removals?pli=1",C=2,E=["company","agency","business","organization","corporate","online","store","magazine","website"],v=l.extend({events:{"click .toc li":"onTOCClick","change input[name=gender]":"onGenderChange"},CssClassName:{HIDDEN:"hidden",TOC_SELECTED:"selected"},onContentReady:function I(){this.options.state_hideCustomGenderField="unspecified"===this.data.gender?!1:!0,this.options.state_tocSelectedIndex=0;var t={email:[m.Required(),m.Email()],first_name:[m.Required()],username:[m.Required()],about:[m.Length({max:o.MAX_CHARS_FOR_USER_DESCRIPTION})],website_url:[m.URL()]};this.data.is_partner&&(t.contact_name=[m.Required()],t.business_name=[m.Required()]);var e=this.$(".Checkbox[name=exclude_from_search]");this.listen(e,"change",this.onSearchPrivacyChange),this.$form=this.$("form"),this.form=new r(this.$form,t),this.listen(this.form,o.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(o.EVENT_BUTTON_CLICK,this.onButtonClick),this.listen(this.$(".customGender"),"blur",this.onCustomGenderBlur);var i={};i[o.PUBSUB_TOPIC_USER_CHANGED_PASSWORD]=this.onPasswordChanged,this.pubsubSubscribe(o.PUBSUB_CHANNEL_SITE,i),this.negativeSpaceAdded=0,this.scrollListener=this.listen(this.getScrollableElement(),o.EVENT_SCROLL,this.onScroll)},onAdded:function T(t){i.e(9,function(){i(725),this.$(".formFooter").fixedsticky()}.bind(this))},updateDom:function N(){this.$(".toc li").removeClass(this.CssClassName.TOC_SELECTED),this.$(".toc").children().eq(this.options.state_tocSelectedIndex).addClass(this.CssClassName.TOC_SELECTED);var t=this.$(".customGender");t.toggleClass(this.CssClassName.HIDDEN,this.options.state_hideCustomGenderField),this.options.state_hideCustomGenderField&&t.val("")},onGenderChange:function S(t){var e=t.target;"unspecified"===e.value&&e.checked?this.updateOptionsAndDom({state_hideCustomGenderField:!1}):this.updateOptionsAndDom({state_hideCustomGenderField:!0})},isBusinessAccountKeyword:function b(t){return-1!==E.indexOf(t)},onCustomGenderBlur:function y(){var t=this.$(".customGender").val().toLowerCase();if(""!==t&&this.isBusinessAccountKeyword(t)){var e=c._("It looks like you might be using Pinterest as a business. Would you like to switch to a business account and get access to analytics?"),i={name:"ConfirmDialog",options:{button_text:c._("Switch now"),body_message:e,title:c._("Switch to a business account?"),template:"generic"}};return u.load(i).then(function(t){this.showInModal(t),this.listen(t,o.EVENT_CONFIRM,this.onDialogConfirm)}.bind(this))}},onDialogConfirm:function P(){this.navigate("/business/convert")},onSearchPrivacyChange:function B(t){var e=t.target;if(e.checked){var i={name:"ConfirmDialog",options:{template:"search_privacy",google_search_privacy_url:f}};u.load(i).then(function(t){this.showInModal(t);var e={event_type:o.GEN.EventType.VIEW,view_type:o.GEN.ViewType.SETTINGS,view_parameter:o.GEN.ViewParameterType.SETTINGS_SEARCH_PRIVACY},i=h.fromPlainObject(e);d.getInstance().addEvent(i),this.listen(t,o.EVENT_NAVIGATE,function(t){if(t.data&&t.data.url===f){var e={};this._logCustomContextEvent(o.GEN.EventType.CLICK,o.GEN.ElementType.SEARCH_PRIVACY_LINK,o.GEN.ComponentType.MODAL_SEARCH_PRIVACY,e)}})}.bind(this))}},onPasswordChanged:function A(t,e,i){var n=this.getChildById("userChangePasswordButton");if(n.options.submodule.options.has_password=!0,n.options.text=this.extraData.change_password_text,n.render(),i){var s=this.getChildById("userSocialNetworkSettings");s.render()}},onButtonClick:function R(t){var e=t.target,i=e.id;switch(i){case"clearRecentSearches":this.clearRecentSearches(t)}},clearRecentSearches:function w(t){var e=t.target;e.disable();var i=p.create("TypeaheadClearRecentResource");i.callDelete({showError:!1}).fin(function(){e.enable()})},onSubmitValidated:function O(t){if(!t.errors[0]){var e=this.getChildById("notifications"),i=[this.save()];return e&&i.push(e.updateResource()),Promise.all(i).then(function(t){var e=t[0];if(e&&!e.resource_response.error){var i=e.resource_response.data;this.data.email!==this.email&&i.email_changing_to?this.showPendingEmailChange():this.navigateToUserProfilePage(this.username)}}.bind(this))}var n=this.$form.find(".hasError");if(n.length){var o=n.offset().top-70;s(window.document.body).animate({scrollTop:o},50)}},navigateToUserProfilePage:function D(t){var e="/"+t+"/";g.changeWindowLocation(e,!1)},save:function x(){var t=this.$form.serializeArray(),e={};n.each(t,function(t){e[t.name]="on"===t.value||"off"===t.value?"on"===t.value:t.value}),this.$form.find("input[type=checkbox]").each(function(){var t=s(this);e[t.attr("name")]=t.is(":checked")});var i=this.getChildById("submitButton"),o=p.create("UserSettingsResource",e);return this.email=e.email,this.username=e.username,i.showLoading(),o.callUpdate().fin(function(){i.hideLoading()})},showPendingEmailChange:function L(){var t=_.format(c._("To finish updating your address, look for the confirmation email we sent to {{ current_email }}."),{current_email:this.data.email}),e={name:"ConfirmDialog",options:{button_text:c._("Ok"),body_message:t,title:c._("You're almost done!"),template:"generic"}};u.load(e).then(function(t){this.showInModal(t,{can_dismiss:!1}),this.listen(t,o.EVENT_CLOSE,this.navigateToUserProfilePage(this.username)),this.listen(t,o.EVENT_CONFIRM,this.navigateToUserProfilePage(this.username))}.bind(this))},onTOCClick:function k(t){var e=s(t.currentTarget).find("a").attr("href"),i=s(e).position().top,n=s(t.currentTarget).index();return this.updateOptionsAndDom({state_tocSelectedIndex:n}),this.tocClicked=!0,g.scrollToTop({newScrollOffset:i,duration:800,callback:function(){this.tocClicked=!1}.bind(this)}),t.stopPropagation(),!1},addNegativeSpace:function U(){if(0===this.negativeSpaceAdded){var t=this.$(".standardForm");t.height("100%");var e=this.$("#apps").position().top,i=s(document).height()-this.getScrollableElement().height(),n=e-i;if(n>0){var o=t.height();t.height(o+n),this.negativeSpaceAdded=n}}},onScroll:function M(){var t=this.getScrollableElement().scrollTop();if(!(0>t)){if(!this.tocClicked){for(var e=null,i=0,n=this.$(".sectionTitle"),o=0;o<n.length;o++){var a=n[o],r=s(a).position().top;t>=r-C&&(!e||r>i)&&(e=a,i=r)}var l=this.$('.toc a[href="#'+s(e).attr("id")+'"]').parent("li").index();this.updateOptionsAndDom({state_tocSelectedIndex:l})}this.addNegativeSpace()}}});v.prototype.className="UserSettingsPage",t.exports=a.register(v)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(115),r=i(50),l=i(18),h=i(8);i(173);var d="emailGlobalToggle",c=r.extend({CssClassName:{DISABLED:"emailDisabled",EMAIL_SETTINGS:"emailSettings"},onContentReady:function u(){this.$form=this.$("form");var t=new a(this.$form,[]);this.listen(t,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(s.EVENT_CHANGE,this.onChildChange)},updateResource:function p(){var t={},e={};this.$(".pushNotifSettings input[type=checkbox]").each(function(){var t=n(this),i=t.attr("name");e[i.substr(5)]=t.is(":checked")?"anyone":"none"}),t.push_settings=JSON.stringify(e),t.filter_settings=this.$("input[name=filter_settings]:checked").val();var i=h.create("NotificationSettingsResource",t);return i.callUpdate()},onSubmitValidated:function _(){this.showLoading(!0);var t=this.updateResource();return this.isInModal()&&(t=t.then(function(){this.destroy()}.bind(this))),t.fin(this.hideLoading.bind(this)),!1},onChildChange:function g(t){var e=t.target;e.id===d&&(e.isChecked()?this.setEmailsEnabled(!0):this.confirmDisableEmails())},confirmDisableEmails:function m(){var t={name:"ConfirmDialog",options:{template:"disable_emails_confirm"}};l.load(t).then(function(t){this.showInModal(t);var e=this.listen(t,s.EVENT_DESTROYED,function(t){var e=this.getChildById(d);e.setChecked(!0)});this.listen(t,s.EVENT_CONFIRM,function(t){this.setEmailsEnabled(!1),this.removeListener(e)})}.bind(this))},setEmailsEnabled:function f(t){var e=h.create("UserSettingsResource",{email_enabled:t}),i=this.$("."+this.CssClassName.EMAIL_SETTINGS);i.toggleClass(this.CssClassName.DISABLED,!t),e.callUpdate()}});c.prototype.className="NotificationSettings",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(50),a=i(18),r=i(8);i(116);var l=o.extend({onContentReady:function h(){this.childListen(n.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function d(t){var e=t.target.id;-1!==e.indexOf("revokeButton")&&this.showConfirmation(e)},onRevokeConfirm:function c(t){var e=this.getChildById(t),i=t.replace("revokeButton",""),n=r.create("OAuthUserAuthorizationsResource",{consumer_id:i});e.showLoading(),n.callDelete().then(function(){this.render()}.bind(this)).fin(function(){e.hideLoading()})},showConfirmation:function u(t){var e={name:"ConfirmDialog",options:{template:"revoke_app_access"}};a.load(e).then(function(e){this.showInModal(e),this.listen(e,n.EVENT_CONFIRM,function(){this.onRevokeConfirm(t)})}.bind(this))}});l.prototype.className="UserAppSettings",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(115),r=i(50),l=i(23),h=i(8),d=i(104);i(116),i(173),i(723);var c=r.extend({CssClassName:{RESTRICT_WIDTH:"restrictWidth"},onContentReady:function u(){this.options.state_imgSrc=this.data.profile_image_url||this.context&&this.context.user&&this.context.user.image_medium_url;var t={first_name:[d.Required(),d.Length({min:s.MIN_CHARS_FOR_USER_FIRST_NAME,should_trim:!0})],username:[d.Required()],about:[d.Length({max:s.MAX_CHARS_FOR_USER_DESCRIPTION})],impressum_url:[d.URL()],website_url:[d.URL()]};this.data.is_partner&&(t.business_name=[d.Required()]),this.formListener&&this.removeListener(this.formListener),this.form=new a(this.$("form"),t),this.formListener=this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated);var e={};e[s.PUBSUB_TOPIC_USER_UPDATED]=this.onImageUploaded,this.pubsubSubscribe(this.options.user_id,e),this.$(".profileImage").on("load",function(){this.updateDom()}.bind(this))},updateDom:function p(){var t=this.$(".profileImage");t.attr("src",this.options.state_imgSrc),t.toggleClass(this.CssClassName.RESTRICT_WIDTH,t.height()>t.width())},onImageUploaded:function _(t,e,i){i&&i.data&&i.data.profile_image_url&&this.updateOptionsAndDom({state_imgSrc:i.data.profile_image_url})},onSubmitValidated:function g(t){t.errors[0]||this.saveProfile()},getFormData:function m(){var t=this.$("form").serializeArray(),e={};return n.each(t,function(t){e[t.name]=t.value}),e},getSaveResource:function f(t){return h.create("UserSettingsResource",t)},saveProfile:function C(){var t=this.getFormData(),e=this.getChildById("submitButton"),i=this.extraData.currentUsername,n=t.username&&i!==t.username;e.showLoading(),this.getSaveResource(t).callUpdate().then(function(e){var i=this.isInModal()&&!n;if(i)l.instance.publish(this.options.user_id,s.PUBSUB_TOPIC_USER_UPDATED),this.destroy();else{var o="/"+t.username+"/";this.navigate(o)}}.bind(this)).fin(function(){e.hideLoading()})}});c.prototype.className="UserEdit",t.exports=o.register(c)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(18),l=i(23),h=i(8);i(116);var d=a.extend({events:{'keyup input[name="website_url"]':"onInput",'input input[name="website_url"]':"onInput"},CssClassName:{HIDDEN:"hidden"},onContentReady:function c(){this.originalWebsite=this.data&&this.data.website_url?this.data.website_url:"";var t={};t[s.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(s.PUBSUB_CHANNEL_CURRENT_USER,t),this.options.state_verified=!1;var e=this.getChildById("verifyWebsite");this.listen(e,s.EVENT_BUTTON_CLICK,this.onClick)},onUserUpdated:function u(){this.render()},onInput:function p(t){var e=n(t.target).val(),i=this.getChildById("verifyWebsite");this.updateOptionsAndDom({state_verified:this.options.domain_verified&&e===this.originalWebsite}),e?i.enable():i.disable()},showModalForDomain:function _(t){this.showLoading();var e={name:"DomainVerify",resource:{name:"DomainVerifyResource",options:{}}};r.load(e).then(function(t){this.hideLoading();var e={show_api_error:!0};this.showInModal(t,e)}.bind(this))},onClick:function g(){var t=this.$('input[name="website_url"]').val();if(t===this.originalWebsite)return void this.showModalForDomain(t);var e=this.getChildById("verifyWebsite");e.showLoading();var i=h.create("UserSettingsResource",{website_url:t});i.callUpdate().then(function(){l.instance.publish(this.options.user_id,s.PUBSUB_TOPIC_USER_UPDATED),this.showModalForDomain(t)}.bind(this)).fin(function(){e.hideLoading()})},updateDom:function m(){this.$(".verifiedDomainContainer").toggleClass(this.CssClassName.HIDDEN,!this.options.state_verified),this.$(".verifyButton").toggleClass(this.CssClassName.HIDDEN,this.options.state_verified)}});d.prototype.className="UserEditVerifyWebsite",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(14),l=i(18),h=i(8);i(116);var d=a.extend({events:{"click .revokeButton":"revokeSession","click .showHideButton":"showSessions"},CssClassName:{HIDDEN:"hidden"},onCreated:function c(){this.options.state_activeSessionHidden=!0},updateDom:function u(){var t=this.getChildById("showHideButton"),e=this.$(".activeSessions");e.toggleClass(this.CssClassName.HIDDEN,this.options.state_activeSessionHidden),this.options.state_activeSessionHidden?t.setText(r._("Show Sessions")):t.setText(r._("Hide Sessions"))},revokeSession:function p(t){var e=n(t.currentTarget),i=e.parent().parent();this.showConfirmation(i)},showSessions:function _(t){this.updateOptionsAndDom({state_activeSessionHidden:!this.options.state_activeSessionHidden})},onConfirm:function g(t){var e=t.attr("data-sess-id"),i=h.create("UserSessionStoreResource",{sess_id:e});i.callDelete().then(function(){t.hide()})},showConfirmation:function m(t){var e={name:"ConfirmDialog",options:{template:"revoke_session"}};l.load(e).then(function(e){this.showInModal(e),this.listen(e,s.EVENT_CONFIRM,function(){this.onConfirm(t)})}.bind(this))}});d.prototype.className="UserSecuritySettings",t.exports=o.register(d)},,,function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="UserSettingsPageReactWrapper",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(729),s=i(19),o=i(135),a=n.extend({getUserToBlock:function r(t){return this.options.commenter&&this.options.commenter[t]},_onUserBlockConfirmed:function l(){var t=o.get();t&&t.removeTopModal();var e=this.getUserToBlock("id"),i=this.data&&this.data.board&&this.data.board.owner&&this.data.board.owner.id===e;"leaveBoardAndBlockPinner"!==this._getCheckedValues()||i?this._onUserActionDone():this._leaveAndUnfollowBoard()}});a.prototype.className="BlockAndUnfollowComment",t.exports=s.register(a)},function(t,e,i){"use strict";var n=i(730),s=i(19);i(116),i(173);var o=n.extend({getButtonConfig:function a(t){return this.buttonConfig[t]}});o.prototype.className="BlockAndUnfollowBoardContent",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(11),o=i(19),a=i(50),r=i(40),l=i(29),h=i(135),d=i(18),c=i(23),u=i(8);i(679);var p=a.extend({events:{"change input":"onInputChange","click button":"onButtonClicked"},CssClassName:{CLASS_VISIBLE:"visible",BLOCK_BUTTON:"blockButton"},buttonConfig:{unfollowBoard:{buttonClassName:".unfollowBoardButton",buttonClickHandler:"_unfollowBoard",userActions:["unfollow_board"]},unfollowPinner:{buttonClassName:".unfollowPinnerButton",buttonClickHandler:"_unfollowPinner",userActions:["unfollow_pinner"]},blockPinner:{buttonClassName:".blockButton",userActions:["block_pinner"]},leaveAndUnfollowBoard:{buttonClassName:".leaveAndUnfollowBoardButton",buttonClickHandler:"_leaveAndUnfollowBoard",userActions:["leave_board"]},leaveBoardAndBlockPinner:{buttonClassName:".blockButton",userActions:["leave_board","block_pinner"]},"leaveAndUnfollowBoard leaveBoardAndBlockPinner":{buttonClassName:".blockButton",userActions:["leave_board","block_pinner"]},"":{buttonClassName:".doneButton",buttonClickHandler:"destroy",userActions:[]}},onContentReady:function _(){this.options.state_isInputChanged=!!this.options.isInputChanged,this.options.state_isShowLoading=!!this.options.isShowLoading,this.options.state_isButtonClicked=!!this.options.isButtonClicked,this.options.state_buttonDomEl=this.options.buttonDomEl||null;var t={},e=this.getUserToBlock("id");e&&(t[s.PUBSUB_TOPIC_USER_BLOCKED]=this._onUserBlockConfirmed,this.pubsubSubscribe(e,t))},updateDom:function g(){var t;if(this.options.state_isInputChanged&&(t=this._getCheckedValues(),this.$("button.visible").toggleClass(this.CssClassName.CLASS_VISIBLE,!1),this.$(this.getButtonConfig(t).buttonClassName).toggleClass(this.CssClassName.CLASS_VISIBLE,!0),this.options.state_isInputChanged=!1),this.options.state_isButtonClicked){var e=n(this.options.state_buttonDomEl);if(this.options.state_isButtonClicked=!1,this.options.state_buttonDomEl=null,!e.hasClass(this.CssClassName.BLOCK_BUTTON)){this.updateOptionsAndDom({state_isShowLoading:!0}),t=this._getCheckedValues();var i=this.buttonConfig[t].buttonClickHandler;i&&this[i]&&("destroy"===i&&"ignoreThisPin"===this.options.flagReason?this._onUserActionDone():this[i].apply(this))}}this.options.state_isShowLoading?this.showLoading():this.hideLoading()},onInputChange:function m(t){this.updateOptionsAndDom({state_isInputChanged:!0})},onButtonClicked:function f(t){this.updateOptionsAndDom({state_isButtonClicked:!0,state_buttonDomEl:t.target})},_getCheckedValues:function C(){var t=[];return this.$("input:checked").each(function(){t.push(n(this).val())}),t.join(" ")},_onUserBlockConfirmed:function E(){var t=h.get();t.removeTopModal(),this._onUserActionDone()},_onUserActionDone:function v(){this.updateOptionsAndDom({state_isShowLoading:!1});var t=this.getUserToBlock("full_name"),e={pinnerName:t},i=this._getCheckedValues();e.userActions={};var n=this.getButtonConfig(i).userActions;n.forEach(function(t){e.userActions[t]=!0}),e.template="block_and_unfollow",e.fluid=!r.instance.is_mobile_agent;var s={name:"ConfirmDialog",options:e};d.load(s).then(function(t){this.showInModal(t),this.destroy()}.bind(this))},_unfollowBoard:function I(){var t=this.data&&this.data.board&&this.data.board.id,e={name:"BoardFollowResource",options:{board_id:t}},i={id:t,topic:s.PUBSUB_TOPIC_BOARD_UNFOLLOW};this._resourceDeleteCall(e,"board_unfollow",i).then(function(){this._onUserActionDone()}.bind(this))},_unfollowPinner:function T(){var t=this.getUserToBlock("id"),e={name:"UserFollowResource",options:{user_id:t}},i={id:t,topic:s.PUBSUB_TOPIC_USER_UNFOLLOW};this._resourceDeleteCall(e,"user_unfollow",i).then(function(){this._onUserActionDone()}.bind(this))},_leaveAndUnfollowBoard:function N(){var t=this.data&&this.data.board&&this.data.board.id,e={name:"BoardCollaboratorResource",options:{board_id:t,invited_user_id:this.options.user_id,ban:!1}},i={id:t,topic:s.PUBSUB_TOPIC_BOARD_UNFOLLOW},n={name:"BoardFollowResource",options:{board_id:t}},o={id:t,topic:s.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED},a=this._resourceDeleteCall(e,"collaborator_delete_invite",i),r=this._resourceDeleteCall(n,"board_unfollow",o),l=[r,a];Promise.all(l).then(function(){this._onUserActionDone()}.bind(this))},_resourceDeleteCall:function S(t,e,i){var n=u.create(t.name,t.options);return n?n.callDelete().then(function(){return e&&l.trackEvent(e,s.GA_ACTION_SUCCESS),i&&c.instance.publish(i.id,i.topic,!0),Promise.resolve()},function(){return e&&l.trackEvent(e,s.GA_ACTION_ERROR),Promise.reject(new Error(n.getName()+" failed to call callDelete()"))}):(this.log.error("No resource created from "+n.getName()),Promise.reject(new Error(n.getName()+" was not created")))}});p.prototype.className="BlockAndUnfollowForm",t.exports=o.register(p)},function(t,e,i){"use strict";var n=i(1),s=i(730),o=i(19),a=i(11);i(116),i(173);var r=s.extend({buttonConfig:{blockPinner:{buttonClassName:".blockButton",userActions:["block_pinner"]},blockPinners:{buttonClassName:".blockButton",userActions:["block_multiple_pinners"]},"":{buttonClassName:".doneButton",buttonClickHandler:"destroy",userActions:[]}},blockConfig:{numBlocked:0,numToBlock:0
},onContentReady:function l(){var t={};if(this.options.conversation&&this.options.conversation.users){var e=n.pluck(this.options.conversation.users,"user_id");e&&(t[a.PUBSUB_TOPIC_USER_BLOCKED]=this._onUserBlockConfirmed,n.each(e,function(e){this.pubsubSubscribe(e,t)}.bind(this)))}},getUsersToBlock:function h(t){if(this.options.conversation&&this.options.conversation.users){var e=this.options.conversation.users,i=this._getCheckedValues().split(" ");return n.pluck(n.filter(e,function(t){return-1!==n.indexOf(i,t.user_id)}),t)}return[]},getButtonConfig:function d(t){if(""===t)return this.buttonConfig[t];var e=t.split(" ");return e.length>1?this.buttonConfig.blockPinners:1===e.length?this.buttonConfig.blockPinner:void 0},getUserToBlock:function c(t){return this.getUsersToBlock(t)},onInputChange:function u(t){var e=this._getCheckedValues().split(" ");1===e.length&&""===e[0]?this.blockConfig.numToBlock=0:this.blockConfig.numToBlock=e.length;var i=this.getChildByModuleName("ShowModalButton").options.submodule;i.options.blocked_users=e,i.options.first_name=this.getUserToBlock("first_name"),s.prototype.onInputChange.call(this,t)},_onUserBlockConfirmed:function p(){this.blockConfig.numBlocked++,this.blockConfig.numToBlock>0&&this.blockConfig.numBlocked===this.blockConfig.numToBlock&&s.prototype._onUserBlockConfirmed.call(this)},onRemovedFromDom:function _(){this.blockConfig.numBlocked=0,this.blockConfig.numToBlock=0}});r.prototype.className="BlockAndUnfollowMessage",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(729),s=i(19),o=n.extend({getUserToBlock:function a(t){return this.data&&this.data.pinner&&this.data.pinner[t]}});o.prototype.className="BlockAndUnfollowPin",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="CsrfErrorPage",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(735),a=i(29),r=i(8);i(116);var l=o.extend({ModuleName:{BLOCK_AND_UNFOLLOW_FORM:"BlockAndUnfollowComment",CONFIRM_DIALOG:"ConfirmDialog"},getResource:function h(){return{name:"PinResource",options:{id:this.options.pin_id,field_set_key:"flag_comment"}}},flag:function d(t,e){var i=this.getChildById("submitButton");i.showLoading();var s={pin_id:e.pin_id,comment_id:e.comment_id,reason:e.flagReasonCategory};a.trackEvent(n.GA_CATEGORY_COMMENT_FLAG,n.GA_ACTION_CLICK_SUBMIT,"flagReason",s.reason);var o=r.create("CommentFlagResource",s);return o.callCreate().then(function(){a.trackEvent(n.GA_CATEGORY_COMMENT_FLAG,n.GA_ACTION_SUCCESS),this.showNextModal(t,e)}.bind(this),function(){a.trackEvent(n.GA_CATEGORY_COMMENT_FLAG,n.GA_ACTION_ERROR)}).fin(function(){i.hideLoading()})}});l.prototype.className="FlagComment",t.exports=s.register(l)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(115),r=i(50),l=i(18),h=i(104);i(116);var d=r.extend({events:{"change input":"onReportReasonSelected"},CssClassName:{CLASS_VISIBLE:"visible"},ModuleName:{BLOCK_AND_UNFOLLOW_FORM:"BlockAndUnfollowForm"},onContentReady:function c(){var t=this.getChildById("nextButton");t&&(t.disable(),this.listen(t,s.EVENT_BUTTON_CLICK,this.onNextStep)),this.options.state_reasonVisible=!0;var e=this.getChildById("backButton");e&&this.listen(e,s.EVENT_BUTTON_CLICK,this.onBackStep);var i=this.$("form"),n={reason:[h.Required()]},o={prevalidate:!0};this.form=new a(i,n,o),this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function u(t){if(!t.errors[0]){var e=this.$("form :checked"),i=e.attr("value"),s=e.data("category"),o=this.getNextModalName(e),a=this.isAgainstPolicies(s),r=this.isReportingPin(i,s),l=n.extend({},this.options);l.flagReasonCategory=s,l.flagReason=i,l.isAgainstPolicies=a,l.isReportingPin=r,l.detailedReasons?l.detailedReasons.push(i):l.detailedReasons=[i],this.flag(o,l)}},onReportReasonSelected:function p(){var t=this.$("form :checked"),e=t.length?t.attr("value"):"",i=this._getProceedButton(t);"nextButton"===i.id?this.getChildById("submitButton").hide():this.getChildById("nextButton").hide(),i.show(),i.enable(),this.showPolicyLinkeBaseOnReason(e)},showPolicyLinkeBaseOnReason:function _(t){var e=["nudity","hurtfulContent","gore"],i=e.indexOf(t);-1!==i&&this.updateOptionsAndDom({state_reasonVisible:!1,state_policyLinkIndex:i})},showNextModal:function g(t,e){var i={name:t,options:e};t===this.ModuleName.BLOCK_AND_UNFOLLOW_FORM?(i.resource=this.getResource(),this.addContentSpecificModalOptions(i.options)):t===this.ModuleName.CONFIRM_DIALOG&&(i.options.template="block_and_unfollow",i.options.fluid=!0),l.load(i).then(function(t){this.showInModal(t),this.destroy()}.bind(this))},addContentSpecificModalOptions:function m(t){},onNextStep:function f(t){var e=this.$("form :checked"),i=e.attr("value"),s=this.getNextModalName(e),o=n.extend({},this.options);o.flagReason=i,o.detailedReasons?o.detailedReasons.push(i):o.detailedReasons=[i],this.extraData.aggregated_rich_data_type&&(o.aggregated_rich_data_type=this.extraData.aggregated_rich_data_type),this.extraData.rich_data_url&&(o.rich_data_url=this.extraData.rich_data_url),this.showNextModal(s,o)},onBackStep:function C(t){this.options.detailedReasons.pop(),this.options.flagReason=n.last(this.options.detailedReasons);var e={name:this.toString(),options:this.options};l.load(e).then(function(t){this.showInModal(t),this.destroy()}.bind(this))},isTerminalReason:function E(t){return!!t.data("is-terminal-reason")},isReportingPin:function v(t,e){var i=["nudity","spam","hate-speech","self-harm"],n=["harassingMeOrMyChild","gore"];return-1!==i.indexOf(e)||-1!==n.indexOf(t)},isAgainstPolicies:function I(t){var e=["spam","nudity","attacks","hate-speech","self-harm"];return-1!==e.indexOf(t)},getNextModalName:function T(t){return this.isTerminalReason(t)?this.ModuleName.BLOCK_AND_UNFOLLOW_FORM:this.toString()},_getProceedButton:function N(t){return t&&this.isTerminalReason(t)?this.getChildById("submitButton"):this.getChildById("nextButton")},updateDom:function S(){this.$(".helpText > .visible").toggleClass(this.CssClassName.CLASS_VISIBLE,this.options.state_reasonVisible),void 0!==this.options.state_policyIndex&&this.$(".helpText").children().eq(this.options.state_policyLinkIndex).toggleClass(this.CssClassName.CLASS_VISIBLE,!this.options.state_reasonVisible)}});d.prototype.className="FlagBase",t.exports=o.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(735),r=i(29),l=i(8);i(116);var h=a.extend({ModuleName:{BLOCK_AND_UNFOLLOW_FORM:"BlockAndUnfollowMessage",CONFIRM_DIALOG:"ConfirmDialog"},getResource:function d(){return{name:"ConversationResource",options:{conversation_id:this.options.conversation.id,ignore_bookmark:!0,field_set_key:"flag_conversation"}}},addContentSpecificModalOptions:function c(t){var e=t.conversation.users;t.anyPinnerFollowedByMe=n.some(e,function(t){return t.explicitly_followed_by_me})},flag:function u(t,e){var i=this.getChildById("submitButton");i.showLoading();var n={conversation_id:e.conversation.id,reason:e.flagReason};r.trackEvent(s.GA_CATEGORY_CONVERSATION_FLAG,s.GA_ACTION_CLICK_SUBMIT,"flagReason",n.reason);var o=l.create("ConversationReportResource",n);return o.callCreate().then(function(){r.trackEvent(s.GA_CATEGORY_COMMENT_FLAG,s.GA_ACTION_SUCCESS),this.showNextModal(t,e)}.bind(this),function(){r.trackEvent(s.GA_CATEGORY_COMMENT_FLAG,s.GA_ACTION_ERROR)}).fin(function(){i.hideLoading()})}});h.prototype.className="FlagConversation",t.exports=o.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(735),a=i(28),r=i(29),l=i(8);i(116);var h=o.extend({ModuleName:{CONFIRM_DIALOG:"ConfirmDialog"},getNextModalName:function d(t){return this.isTerminalReason(t)?this.ModuleName.CONFIRM_DIALOG:this.toString()},flag:function c(t,e){var i=this.getChildById("submitButton");i.showLoading();var s="Unlabeled",o=null,h=null,d=a.instance.backgroundModule;d&&(s=d.className,"SearchPage"===s&&(o=d.options.scope,h=d.options.query),o=void 0!==o?o:null,h=void 0!==h?h:null);var c={csr_id:e.csr_id,reason:e.flagReasonCategory,source:s,sourceDetail1:o,sourceDetail2:h,detailedReasons:e.detailedReasons};r.trackEvent(n.GA_CATEGORY_CSR_FLAG,n.GA_ACTION_CLICK_SUBMIT,"flagReason",c.detailedReasons);var u=l.create("CSRFlagResource",c);u.callCreate().then(function(){r.trackEvent(n.GA_CATEGORY_CSR_FLAG,n.GA_ACTION_SUCCESS),this.showNextModal(t,e)}.bind(this),function(){r.trackEvent(n.GA_CATEGORY_CSR_FLAG,n.GA_ACTION_ERROR)}).fin(function(){i.hideLoading()})}});h.prototype.className="FlagCsr",t.exports=s.register(h)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(735),a=i(28),r=i(29),l=i(23),h=i(8);i(116);var d=o.extend({ModuleName:{BLOCK_AND_UNFOLLOW_FORM:"BlockAndUnfollowPin",CONFIRM_DIALOG:"ConfirmDialog"},getNextModalName:function c(t){var e=t.attr("value"),i=t.data("category"),n=["other","badAggregatedRichData","badLocationData"];return-1!==n.indexOf(i)?this.ModuleName.CONFIRM_DIALOG:this.isTerminalReason(t)||"ignoreThisPin"===e?this.ModuleName.BLOCK_AND_UNFOLLOW_FORM:this.toString()},getResource:function u(){return{name:"PinResource",options:{id:this.options.pin_id,field_set_key:"flag_pin"}}},flag:function p(t,e){"badAggregatedRichData"===e.flagReasonCategory?this.flagAggregatedRichData(t,e):"badLocationData"===e.flagReasonCategory?this.flagLocationData(t,e):this.flagPin(t,e)},flagPin:function _(t,e){var i=this.getChildById("submitButton");i.showLoading();var s="Unlabeled",o=null,d=null,c=a.instance.backgroundModule,u="BoardPage";c&&(s=c.className,"SearchPage"===s?(o=c.options.scope,d=c.options.query):s===u?o=c.options.tab:"FeedPage"===s?o=c.options.feed:"DomainFeedPage"===s&&(o=c.options.feed_item_type,d=c.options.domain),o=void 0!==o?o:null,d=void 0!==d?d:null);var p={pin_id:e.pin_id,reason:e.flagReasonCategory,source:s,sourceDetail1:o,sourceDetail2:d,detailedReasons:e.detailedReasons};r.trackEvent(n.GA_CATEGORY_PIN_FLAG,n.GA_ACTION_CLICK_SUBMIT,"flagReason",p.detailedReasons);var _=h.create("PinFlagResource",p);_.callCreate().then(function(){r.trackEvent(n.GA_CATEGORY_PIN_FLAG,n.GA_ACTION_SUCCESS),this.showNextModal(t,e),s===u?l.instance.publish(this.options.board_id,n.PUBSUB_TOPIC_PIN_FLAGGED,{}):l.instance.publish(this.options.pin_id,n.PUBSUB_TOPIC_PIN_FLAGGED,n.FeedbackType.REPORT)}.bind(this),function(){r.trackEvent(n.GA_CATEGORY_PIN_FLAG,n.GA_ACTION_ERROR)}).fin(function(){i.hideLoading()})},flagAggregatedRichData:function g(t,e){var i={pin_id:e.pin_id,rich_data_url:e.rich_data_url,reason:e.flagReason};this.flagRichData(t,e,"PinFlagAggregatedRichDataResource",i)},flagLocationData:function m(t,e){var i={pin_id:e.pin_id,reason:e.flagReason};this.flagRichData(t,e,"PinFlagLocationDataResource",i)},flagRichData:function f(t,e,i,n){var s=this.getChildById("submitButton");s.showLoading();var o=h.create(i,n);o.callCreate().then(function(){this.showNextModal(t,e)}.bind(this),function(){}).fin(function(){s.hideLoading()})}});d.prototype.className="FlagPin",t.exports=s.register(d)},function(t,e,i){"use strict";var n=i(1),s=i(740),o=i(19),a=s.extend({onSubmitValidated:function r(t){if(!t.errors[0]){var e=this.getChildById("submitButton"),i=this.options.users,s=this.options.blocked_users;n.each(i,function(t){-1!==n.indexOf(s,t.user_id)&&this.blockUser(t,e)}.bind(this))}}});a.prototype.className="MultipleUserBlock",t.exports=o.register(a)},function(t,e,i){"use strict";var n=i(11),s=i(19),o=i(115),a=i(50),r=i(29),l=i(135),h=i(18),d=i(23),c=i(8),u=i(31);i(116);var p=a.extend({events:{"click .cancelButton":"onCancelButtonClick"},onContentReady:function _(){this.options.state_isUserBlockCanceled=!!this.options.isUserBlockCanceled,this.options.state_isShowLoading=!!this.options.isShowLoading,this.form=new o(this.$("form"),[]),this.formListener=this.listen(this.form,n.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.submitButton=this.getChildById("submitButton"),this.childListen(n.EVENT_BUTTON_CLICK,this.onButtonClick)},updateDom:function g(){this.options.state_isShowLoading?this.submitButton.showLoading():this.submitButton.hideLoading(),this.options.state_isUserBlockCanceled&&this.destroy()},onButtonClick:function m(t){var e=t.target;if(e){var i=this.options.blocked_by_me?"user_unblock":"user_block";"cancelButton"===e.id?r.trackEvent(i,n.GA_ACTION_CLICK_CANCEL):"submitButton"===e.id&&r.trackEvent(i,n.GA_ACTION_CLICK_SUBMIT)}},onSubmitValidated:function f(t){if(!t.errors[0]){var e={user_id:this.options.user_id,blocked_by_me:this.options.blocked_by_me};this.blockUser(e,this.getChildById("submitButton"))}},onUserBlockSuccess:function C(){var t={name:"ConfirmDialog",options:{template:"block_unblock_user_success",name:this.options.full_name,action:"blocked"}};h.load(t).then(function(t){this.showInModal(t,{can_dismiss:!1}),this.listen(t,n.EVENT_CONFIRM,this.onBlockConfirm)}.bind(this))},onBlockConfirm:function E(){l.get().removeAllModals();var t=u.getCurrentUrl().split("/")||[];t[1]&&t[1]===this.options.username&&this.navigate("/")},onCancelButtonClick:function v(){this.updateOptionsAndDom({state_isUserBlockCanceled:!0})},blockUser:function I(t,e){this.updateOptionsAndDom({state_isShowLoading:!0});var i={blocked_user_id:t.user_id},s=c.create("UserBlockResource",i),o=t.blocked_by_me?"user_unblock":"user_block";(t.blocked_by_me?s.callDelete():s.callCreate()).then(function(){r.trackEvent(o,n.GA_ACTION_SUCCESS),d.instance.publish(t.user_id,n.PUBSUB_TOPIC_USER_BLOCKED),this.options.not_show_confirmation_dialog||this.onUserBlockSuccess()}.bind(this),function(){r.trackEvent(o,n.GA_ACTION_ERROR)}).fin(function(){this.updateOptionsAndDom({state_isShowLoading:!1})}.bind(this))}});p.prototype.className="UserBlock",t.exports=s.register(p)},function(t,e,i){"use strict";var n=i(1),s=i(11),o=i(19),a=i(115),r=i(50),l=i(35),h=i(59),d=i(14),c=i(18),u=i(8),p=i(31),_=i(46),g=i(104);i(116),i(699);var m='[name="metadata"]',f=r.extend({getMetadata:function C(){return this.$(m).val()},onContentReady:function E(){var t=this.getChildById("uploader");this.listen(t,s.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess),this.listen(t,s.EVENT_UPLOAD_ERROR,this.onUploadError),this.imageUrl=null;var e={title:[g.Required()],description:[g.Required()]};this.setMetadata(),this.form=new a(this.$("form"),e),this.formListener=this.listen(this.form,s.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function v(){this.reportBug()},setMetadata:function I(){var t=window.navigator.userAgent,e=p.getCurrentUrl(),i=h.instance.getDebugInfo();this.updateOptionsAndDom({state_inputMetadata:"\n\n\n\n----------------------------------\nuserAgent: "+t+"\ncurrentURL: "+e+"\nexperiments: "+i+"\nusername: "+_.get("username")+"\n\n"})},reportBug:function T(){var t=this.$("form").serializeArray(),e=this.getChildById("submitButton"),i={};n.each(t,function(t){i[t.name]=t.value}),i.description="Type: "+i.bugtype+"\n\n"+i.description+this.getMetadata(),this.imageUrl&&(i.image_url=this.imageUrl),e.showLoading();var o=u.create("ReportErrorResource",i);o.callCreate().then(function(t){var e=t.resource_response.data,i={name:"ConfirmDialog",options:{template:"report_bug",task_url:"https://jira.pinadmin.com/browse/"+e.key+"?filter=15009",class_name:"reportBug"}};c.load(i).then(function(t){this.showInModal(t),this.listen(t,s.EVENT_CONFIRM,this.destroy)}.bind(this))}.bind(this)).fin(function(){e.hideLoading()})},onUploadSuccess:function N(t){this.imageUrl=t.data.image_url},onUploadError:function S(t){l.showError(d.commonStrings.defaultErrorMessage)},updateDom:function b(){this.$(m).val(this.options.state_inputMetadata)}});f.prototype.className="ReportBug",t.exports=o.register(f)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(115),l=i(50),h=i(743),d=i(744),c=i(18),u=i(8),p=i(104);i(116),i(745);var _=100,g=800,m=128,f=l.extend({events:{"click .addAnotherInfringingButton":"onAddAnotherInfringingClick","click .removeInfringingItemButton":"onRemoveInfringingItemClick","click .sameInfoButton":"onSameInfoClicked","click .addAnotherOffsiteButton":"onAddAnotherOffsiteClick","click .removeOffsiteItemButton":"onRemoveOffsiteItemClick"},onCreated:function C(){this.numOffsiteUrls=1,this.numReportedItems=1},updateDom:function E(){var t,e;if(this.options.state_newContentReported){var i=this.options.state_newContentReported.newContent;t=this.options.state_newContentReported.selector,e=this.options.state_newContentReported.countSelector,this.options.state_newContentReported=null;var n=this.$(t);i.render().then(function(){if(this[e]<_)this.insertChild(i,n),s(t).children().last().wrap("<li></li>"),this[e]+=1,this.onContentReady();else{var o={name:"ConfirmDialog",options:{message:"No more than "+_+" reported items per form, please."}};c.load(o).then(function(t){this.showInModal(t)}.bind(this))}}.bind(this))}if(this.options.state_itemRemoved)if(t=this.options.state_itemRemoved.selector,e=this.options.state_itemRemoved.countSelector,this.options.state_itemRemoved=null,this[e]>1){var o=this.$(t).children().last();o.remove(),this[e]-=1}else{var a={name:"ConfirmDialog",options:{message:"You must report at least one item."}};c.load(a).then(function(t){this.showInModal(t)}.bind(this))}},onAddAnotherInfringingClick:function v(){var t=new d({options:{view_type:this.extraData.view_type}});this._onAddAnotherClick(t,".ReportedContentWrapper","numReportedItems")},onAddAnotherOffsiteClick:function I(){this._onAddAnotherClick(new h({}),".OffsiteWorkWrapper","numOffsiteUrls")},_onAddAnotherClick:function T(t,e,i){this.updateOptionsAndDom({state_newContentReported:{newContent:t,selector:e,countSelector:i}})},onRemoveInfringingItemClick:function N(){this._onRemoveItemClick(".ReportedContentWrapper","numReportedItems")},onRemoveOffsiteItemClick:function S(){this._onRemoveItemClick(".OffsiteWorkWrapper","numOffsiteUrls")},_onRemoveItemClick:function b(t,e){this.updateOptionsAndDom({state_itemRemoved:{selector:t,countSelector:e}})},onContentReady:function y(){this.options.state_newContentReported=this.options.newContentReported||null,this.options.state_itemRemoved=this.options.itemRemoved||null;var t={agent_name:[p.Required()],agent_street_address:[p.Length({max:m})],agent_city:[p.Length({max:m})],agent_state:[p.Length({max:m})],agent_zipcode:[p.Length({max:m})],agent_country:[],agent_phone:[p.PhoneNumber()],agent_email:[p.Email({}),p.Required()],is_accurate:[p.Required()],is_good_faith:[p.Required()],is_authorized_agent:[p.Required()],signed_name:[p.Required(),p.EqualTo({targetFieldName:"agent_name",message:"Electronic signature doesn't match your name."})]};this.$(".owner_website_url")&&(t.owner_website_url=[p.Required()]),this.$(".reported_content_url")&&(t.reported_content_url=[p.Required(),p.URL()]),this.$(".context_notes")&&(t.context_notes=[p.Length({max:g})]),this.$(".exact_string")&&(t.exact_string=[p.Required()]),this.$(".remove_all")&&(t.remove_all=[]),this.$(".strike")&&(t.strike=[]);var e={prevalidate:!0};this.$form=this.$("form"),this.form=new r(this.$form,t,e),this.formListener&&this.removeListener(this.formListener),this.formListener=this.listen(this.form,o.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},getFormData:function P(){var t=[],e={},i=this.form.$el.serializeArray(),s=["owner_website_url","reported_content_url","context_notes","exact_string","remove_all","strike"],o=[],a={};return n.each(i,function(i){-1!==s.indexOf(i.name)?(-1!==o.indexOf(i.name)&&(t.push(a),o=[],a={}),a[i.name]=i.value,o.push(i.name)):e[i.name]=e[i.name]="on"===i.value?!0:i.value}),t.push(a),e.reported_content=t,e},onSubmitValidated:function B(t){var e;if(!t.errors[0]){var i=this.getChildById("submitButton");i.showLoading(),e="dmcapin"===this.extraData.view_type?this.form.getData(!0):this.getFormData(),e.form_type=this.extraData.view_type,e.num_offsite_urls=this.numOffsiteUrls,e.num_reported_items=this.numReportedItems;var n=u.create("TakedownRequestResource",e);n.options=e,n.callCreate({showError:!0}).then(function(t){i.hideLoading();var e=t.resource_response.data,n="Thanks for submitting. Your confirmation number is "+e+".",s={name:"ConfirmDialog",options:{button_text:"Got it!",body_message:n,title:"Request Submitted",template:"generic"}};c.load(s).then(function(t){this.showInModal(t)}.bind(this))}.bind(this)).fin(function(){i.hideLoading()})}}});f.prototype.className="TakedownForm",t.exports=a.register(f)},function(t,e,i){"use strict";var n=i(50),s=i(19),o=n.extend({});o.prototype.className="OffsiteWork",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19),a=i(14),r=s.extend({onContentReady:function l(){this.$(".toggler").click(function(){n(this).next().children(":first").toggle("blind",function(){var t=n(this).parent().prev();t.text()===a._("Less")?t.text(a._("More info ...")):t.text(a._("Less"))})}),this.$(".reportedContentUrl").focusout(function(){var t=this.$(".reportedContentUrl").val(),e=/pinterest.com\/web-result\//.test(t);if(e!==this.options.strikeDisabled){var i=this.$("input[name=strike]").is(":checked"),n=this.$("input[name=remove_all]").is(":checked");this.updateOptionsAndDom({initial_value:t,strikeDisabled:e,strikeChecked:i,removeAllChecked:n})}}.bind(this))},updateDom:function h(){this.renderExistingData()}});r.prototype.className="ReportedContent",t.exports=o.register(r)},function(t,e,i){"use strict";var n=i(50),s=i(19);i(116),i(117);var o=n.extend({});o.prototype.className="AddressForm",t.exports=s.register(o)},function(t,e,i){"use strict";var n=i(1),s=i(2),o=i(11),a=i(19),r=i(115),l=i(50),h=i(18),d=i(8);i(116);var c=".agentFields",u=".transferField",p=l.extend({onCreated:function _(){this.onComplainantTypeChange=this.onComplainantTypeChange.bind(this),this.onTrademarkClaimSuccess=this.onTrademarkClaimSuccess.bind(this),this.onAddURLButtonClick=this.onAddURLButtonClick.bind(this)},onContentReady:function g(){if(n.contains(["username","content","goods"],this.options.claim_type)){this.$("[name=complainant_type]").on("change",this.onComplainantTypeChange),this.$("[name=course_of_action]").on("change",this.onClaimTypeChange);var t=this.getChildById("addURL");t&&this.listen(t,o.EVENT_BUTTON_CLICK,this.onAddURLButtonClick),this.complainantType=null,this.claimType=null;var e=new Date;this.$("#trademarkSignatureDate").val(e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()),this.setupForm()}},setupForm:function m(){var t=this.$("form"),e={};this.form=new r(t,e),this.listen(this.form,o.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onComplainantTypeChange:function f(t){var e=s(t.target);if(e.is(":checked")){var i=e.val();this.complainantType=i,"agent"===i?this.showAgentFields():this.hideAgentFields()}},onClaimTypeChange:function C(t){var e=s(t.target);if(e.is(":checked")){var i=e.val();this.claimType=i,"transfer"===i?s(u).show():s(u).hide()}},onSubmitValidated:function E(t){if(!t.errors[0]){var e=this.createResourceOptions(),i=this.getChildById("submitBtn");i.showLoading();var n=d.create("TrademarkClaimResource",e);n.callCreate().then(this.onTrademarkClaimSuccess.bind(this)).fin(function(){i.hideLoading()})}},onTrademarkClaimSuccess:function v(t){var e=t.resource_response.data,i={name:"ConfirmDialog",options:{claim_id:e,template:"trademark_claim_success"}};h.load(i).then(function(t){this.showInModal(t),this.listen(t,o.EVENT_DESTROYED,function(){this.navigate("/")})}.bind(this))},onAddURLButtonClick:function I(){var t=this.$(".infringingURLs"),e=t.children().first().clone();e.find("input").removeAttr("id"),t.append(e)},showAgentFields:function T(){this.$(c).show()},hideAgentFields:function N(){this.$(c).hide()},createResourceOptions:function S(){var t=n.omit(this.form.getData(),"complainant_type");t.claim_type=this.options.claim_type,t.is_owner="owner"===this.complainantType;var e=["infringing_content_urls","infringing_goods_urls"];return n.each(e,function(e){var i=t[e];n.isArray(i)&&(i=n.map(i,function(t){return t.trim()}),i=n.reject(i,function(t){return""===t}),t[e]=i.join(","))}),t}});p.prototype.className="TrademarkForm",t.exports=a.register(p)},function(t,e,i){"use strict";var n=i(2),s=i(50),o=i(19),a=s.extend({onContentReady:function r(){this.$("[name=claim_type]").on("change",this.onClaimTypeChange.bind(this))},onClaimTypeChange:function l(t){var e=n(t.target);if(e.is(":checked")){var i=e.val();this.navigate("/about/trademark/form/"+i+"/")}}});a.prototype.className="TrademarkFormSelector",t.exports=o.register(a)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){function n(t){return i(s(t))}function s(t){return o[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var o={"./ar/index.js":953,"./cs_CZ/index.js":959,"./da_DK/index.js":964,"./de/index.js":969,"./el_GR/index.js":974,"./en_AU/index.js":979,"./en_GB/index.js":984,"./en_IN/index.js":989,"./en_US/index.js":994,"./es_419/index.js":998,"./es_ES/index.js":1003,"./fi_FI/index.js":1008,"./fr/index.js":1013,"./he_IL/index.js":1018,"./hi_IN/index.js":1023,"./hu_HU/index.js":1028,"./id/index.js":1033,"./id_ID/index.js":1038,"./it/index.js":1043,"./ja/index.js":1048,"./ko_KR/index.js":1053,"./ms_MY/index.js":1058,"./nb_NO/index.js":1063,"./nl/index.js":1068,"./no/index.js":1073,"./pl_PL/index.js":1077,"./pt_BR/index.js":1082,"./pt_PT/index.js":1087,"./ro_RO/index.js":1092,"./ru_RU/index.js":1097,"./sk_SK/index.js":1102,"./sv_SE/index.js":1107,"./th_TH/index.js":1112,"./tl_PH/index.js":1117,"./tr/index.js":1122,"./uk_UA/index.js":1127,"./ur/index.js":1132,"./vi_VN/index.js":1137,"./zh_CN/index.js":1142,"./zh_HK/index.js":1147,"./zh_TW/index.js":1152};n.keys=function a(){return Object.keys(o)},n.resolve=s,t.exports=n,n.id=952},function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(10,function(t){s=i(954);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(11,function(t){s=i(960);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(12,function(t){s=i(965);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(13,function(t){s=i(970);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(14,function(t){s=i(975);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(15,function(t){s=i(980);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(16,function(t){s=i(985);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(17,function(t){s=i(990);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(18,function(t){s=i(995);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(19,function(t){s=i(999);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(20,function(t){s=i(1004);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(21,function(t){s=i(1009);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(22,function(t){s=i(1014);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(23,function(t){s=i(1019);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(24,function(t){s=i(1024);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(25,function(t){s=i(1029);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(26,function(t){s=i(1034);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(27,function(t){s=i(1039);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(28,function(t){s=i(1044);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(29,function(t){s=i(1049);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(30,function(t){s=i(1054);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(31,function(t){s=i(1059);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(32,function(t){s=i(1064);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(33,function(t){s=i(1069);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(34,function(t){s=i(1074);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(35,function(t){s=i(1078);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(36,function(t){s=i(1083);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(37,function(t){s=i(1088);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(38,function(t){s=i(1093);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(39,function(t){s=i(1098);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(40,function(t){s=i(1103);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(41,function(t){s=i(1108);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(42,function(t){s=i(1113);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(43,function(t){s=i(1118);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(44,function(t){s=i(1123);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(45,function(t){s=i(1128);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(46,function(t){s=i(1133);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(47,function(t){s=i(1138);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(48,function(t){s=i(1143);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(49,function(t){s=i(1148);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s)})},,,,,function(t,e,i){var n=[],s;t.exports=function(t){n?n.push(t):t(s)},i.e(50,function(t){s=i(1153);var e=n;n=null;for(var o=0,a=e.length;a>o;o++)e[o](s);
})},,,,,,function(t,e,i){"use strict";var n=i(2),s=i(641),o=i(11),a=i(1159),r=i(16),l=i(63),h=i(30),d=i(1160),c=i(8),u=i(126),p=i(28),_=i(40),g=i(35),m=i(29),f=i(14),C=i(135),E=i(18),v=i(269),I=i(72),T=i(46),N=i(27),S=r.getLogger("Main"),b=h.DEBUG?r.LOG_LEVEL.INFO:r.LOG_LEVEL.WARN;r.setDefaultLogLevel(b);var y=function B(t,e){t=t||f._("Sorry! Something went wrong on our end.");var i={name:"ConfirmDialog",options:{view_type:"error",message:t,template:null}},n=C.get().getTopModal(),s;if(n&&n.options.module){var a=n.options.module;s="error"===a.options.view_type}s||E.load(i).then(function(t){e&&t.on(o.EVENT_CONFIRM,e),C.get().createAndShowModal(t)})};g.setShowHtmlErrorCallback(y);var P={start:function A(t){u.init(),T.set(t.user),_.set(t.context),v.set(t.initialPageInfo),m.init(t.gaAccountNumbers,t.isLoggedIn),N.initFocus(),f.initializeCommonStrings(),t.resourceDataCache.forEach(function(t){var e=c.createFromPlainObject(t.resource);I.instance.ensureModel(e,t.data)});var e=t.tree,i=l.fromPlainObject(e);a.stopCapturing(),d.reportPageLoadMetricsRegisterOnLoad(),E.create(i).then(function(t){p.set(t),a.replayEvents(),d.reportPageLoadMetricsOnModuleTreeDone()},function(t){S.error("Failed to initialize the module tree; "+t.message)}),s.trackConversions()}};n(document).ready(function(){FastClick.attach(document.body)}),t.exports=P},,function(t,e,i){"use strict";var n=i(2),s=i(1),o=i(30),a=i(28),r=i(40),l=i(35),h=i(43),d=i(46),c={onLoadFlag:!1,loadTimeoutFlag:!1,moduleTreeDoneFlag:!1,fired:!1,loadTimeoutId:null,_reportOnPageLoad:function p(){c.moduleTreeDoneFlag&&(c.onLoadFlag||c.loadTimeoutFlag)&&(c.fired||(c.fired=!0,u.reportPageLoadMetrics()))}},u={reportPageLoadMetricsOnModuleTreeDone:function _(){c.moduleTreeDoneFlag=!0,c._reportOnPageLoad()},reportPageLoadMetricsRegisterOnLoad:function g(){n(window).on("load",function(){c.onLoadFlag=!0,c._reportOnPageLoad()}),c.loadTimeoutId=setTimeout(function(){c.loadTimeoutFlag=!0,c._reportOnPageLoad()},12e4),n(window).on("close",function(){if(null!==c.loadTimeoutId){var t=c.loadTimeoutId;c.loadTimeoutId=null,clearTimeout(t)}})},reportPageLoadMetrics:function m(){if(o.reportPageLoadTimings){var t={};if(window.performance){if(window.performance.getEntriesByType){var e=window.performance.getEntriesByType("resource").filter(function(t){return t.name.match(/com\/\d+x/)})[0];e&&(t.firstPinTiming={url:e.name,start:Math.floor(e.startTime),duration:Math.floor(e.duration),responseEnd:Math.floor(e.responseEnd)})}if(window.performance.timing){var i=window.performance.timing,n={};for(var l in i)"number"==typeof i[l]&&i[l]>0&&(n[l]=i[l]);t.performanceTiming=n}if(window.chrome&&window.chrome.loadTimes){var c=window.chrome.loadTimes();t.firstPaint=1e3*(c.firstPaintTime-c.startLoadTime)}else if("number"==typeof window.performance.timing.msFirstPaint&&window.performance.timing.navigationStart){var u=window.performance.timing.msFirstPaint;t.msFirstPaint=u-window.performance.timing.navigationStart}s.isEmpty(t)||(t.pinterestRID=o.pinterestRID,o.PAGE_ROUTE_PATTERN&&(t.routePattern=o.PAGE_ROUTE_PATTERN),d.attributes.country&&(t.country=d.attributes.country),t.userAgent=window.navigator.userAgent,t.browser=r.instance.browser_name,t.isMobile=r.instance.is_mobile_agent,t.pathname=window.location.pathname,t.moduleName=a.instance.debugGetCurrentMainModuleName(),h.logToServer(h.SERVER_LOG_TYPE.PAGE_LOAD_METRIC,h.HTTP_METHOD.POST,t))}}}};l.wrap(u,["reportPageLoadMetrics","reportPageLoadMetricsRegisterOnLoad","reportPageLoadMetricsOnModuleTreeDone"]),t.exports=u},,,,function(t,e){t.exports=[{extraContent:{allow_full_page:!1,resource_method:"${method}",module_data:"?{module_data}",append:"?{append}"},named:{name:0,method:1},resource:{name:"${name}",options:"?{options}"},module:"?{module_name}",pathPattern:"^/resource/([^/]+)/([^/]+)/$",options:"?{module_options}"},{extraContent:{allow_full_page:!1,resource_method:"${method}",module_data:"?{module_data}",append:"?{append}"},named:{name:0,method:1},resource:{name:"${name}",options:"?{options}"},module:"?{module_name}",pathPattern:"^/resource/commerce/([^/]+)/([^/]+)/$",options:"?{module_options}"},{extraContent:{hide_interstitial:!0,require_authentication:!0,log:{view_type:77}},named:{},resource:{name:"PartnerHomepageResource"},module:"PartnerHomepage",pathPattern:"^/business/$",options:{}},{extraContent:{require_authentication:!0,login_parameters:{username:"${username}",auto_follow:"true"}},named:{username:0},resource:{},module:"AutoFollow",pathPattern:"^/follow/([^/]+)/*$",options:{username:"${username}"}},{extraContent:{require_authentication:!0,login_parameters:{username:"${username}",boardname:"${slug}",auto_follow:"true"}},named:{username:0,slug:1},resource:{},module:"AutoFollow",pathPattern:"^/follow/([^/]+)/([^/]+)/*$",options:{username:"${username}",username_and_slug:"${username}/${slug}"}},{extraContent:{hide_interstitial:!0,content_only:!0},named:{},resource:{},module:"LogoutPage",pathPattern:"^/logout/",options:{next:"?{next}"}},{extraContent:{redirect:"/categories/everything/",perf_log:!0,log:{view_parameter:2,view_type:1}},named:{},resource:{name:"CategoryResource",options:{category:"everything"}},module:"FeedPage",pathPattern:"^/all/$",options:{feed:"everything"}},{extraContent:{redirect:"/categories/${category}/",perf_log:!0,log:{helper_data:{feed:"${category}",is_category:!0},view_type:1}},named:{category:0},resource:{name:"CategoryResource",options:{category:"${category}"}},module:"FeedPage",pathPattern:"^/all/([^/]+)/$",options:{feed:"${category}",is_category:!0}},{extraContent:{ios_deep_link:"pinterest://conversation/${conversation_id}",android_deep_link:"pinterest://www.pinterest.comconversation/${conversation_id",log:{view_parameter:92,view_type:1}},named:{conversation_id:0},resource:{},module:"HomePage",pathPattern:"^/conversation/([^/]+)/*$",options:{auto_follow_interest:"?{auto_follow_interest}",allow_nux:"?{allow_nux}",email_updated:"?{ues}",tab:"following"}},{extraContent:{redirect:"/"},named:{},resource:{},module:"",pathPattern:"^/places/examples/$",options:{}},{extraContent:{redirect:"/nbctv/the-66th-primetime-emmys/"},named:{},resource:{},module:"",pathPattern:"^/emmysnbc/$",options:{}},{extraContent:{redirect:"/nbctv/the-66th-primetime-emmys/"},named:{},resource:{},module:"",pathPattern:"^/nbcemmys/$",options:{}},{extraContent:{redirect:"/nbctv/the-66th-primetime-emmys/"},named:{},resource:{},module:"",pathPattern:"^/primetimeemmys/$",options:{}},{extraContent:{redirect:"/categories/popular/",perf_log:!0,log:{view_parameter:3,view_type:1}},named:{},resource:{name:"CategoryResource",options:{category:"popular"}},module:"FeedPage",pathPattern:"^/popular/$",options:{feed:"popular"}},{extraContent:{redirect:"/categories/gifts/",perf_log:!0,log:{view_parameter:85,view_type:1}},named:{},resource:{name:"CategoryResource",options:{category:"gifts"}},module:"FeedPage",pathPattern:"^/gifts/$",options:{feed:"gifts",low_price:"?{low_price}",high_price:"?{high_price}"}},{extraContent:{redirect:"/categories/videos/",perf_log:!0,log:{view_parameter:128,view_type:1}},named:{},resource:{name:"CategoryResource",options:{category:"videos"}},module:"FeedPage",pathPattern:"^/videos/$",options:{feed:"videos"}},{extraContent:{redirect:"/categories/"},named:{},resource:{},module:"",pathPattern:"^/explore/$",options:{}},{extraContent:{ios_deep_link:"pinterest://explore/${interest}",android_deep_link:"pinterest://www.pinterest.com/explore/${interest}",log:{view_parameter:136,helper_data:{interest:"${interest}"},view_type:1},show_klp_bar:!0,perf_log:!0,canonical_url:"/explore/${interest}/"},named:{interest:0},resource:{name:"InterestResource",options:{no_gift_wrap:"?{no_gift_wrap}",interest:"${interest}"}},module:"InterestFeedPage",pathPattern:"^/explore/([^/]+)/$",options:{show_follow_memo:"?{auto_follow}",interest:"${interest}"}},{extraContent:{perf_log:!0,android_deep_link:"pinterest://search/?q=?{q}",ios_deep_link:"pinterest://search/?q=?{q}",log:{view_parameter:43,view_type:2}},named:{},resource:{name:"BaseSearchResource",options:{scope:"pins",query:"?{q}"}},module:"SearchPage",pathPattern:"^/search/$",options:{scope:"pins",query:"?{q}"}},{extraContent:{perf_log:!0,android_deep_link:"pinterest://search/?q=?{q}",ios_deep_link:"pinterest://search/${scope}/?q=?{q}",log:{helper_data:{scope:"${scope}"},view_type:2}},named:{scope:0},resource:{name:"BaseSearchResource",options:{restrict:"?{restrict}",scope:"${scope}",constraint_string:"?{fc}",show_scope_selector:!0,query:"?{q}"}},module:"SearchPage",pathPattern:"^/search/([^/]+)/$",options:{restrict:"?{restrict}",scope:"${scope}",constraint_string:"?{fc}",show_scope_selector:!0,query:"?{q}"}},{extraContent:{perf_log:!0,log:{view_parameter:181,helper_data:{scope:"boards"},view_type:2}},named:{},resource:{name:"BaseSearchResource",options:{scope:"boards",layout:"places",show_scope_selector:!0,query:"?{q}"}},module:"SearchPage",pathPattern:"^/search/boards/places/$",options:{query:"?{q}",layout:"places",scope:"boards"}},{extraContent:{log:{helper_data:{ingredient:"${ingredient}"},view_type:28}},named:{ingredient:0},resource:{name:"RecipePagesResource",options:{scope:"recipes",show_scope_selector:!1,query:"${ingredient}"}},module:"RecipeFeedPage",pathPattern:"^/recipes/([^/]+)/$",options:{ingredient:"${ingredient}"}},{extraContent:{content_only:!0},named:{},resource:{},module:"OffsitePage",pathPattern:"^/offsite/$",options:{offsite_message:"?{offsite_message}",redirect_status:"?{redirect_status}",sanitized_url:"?{sanitized_url}"}},{extraContent:{hide_interstitial:!0,content_only:!0},named:{},resource:{name:"OAuthAuthorizationResource",options:{scope:"?{scope}",state:"?{state}",redirect_uri:"?{redirect_uri}",response_type:"?{response_type}",consumer_id:"?{consumer_id}"}},module:"OAuthPage",pathPattern:"^/oauth/$",options:{scope:"?{scope}",state:"?{state}",redirect_uri:"?{redirect_uri}",response_type:"?{response_type}",consumer_id:"?{consumer_id}"}},{extraContent:{hide_interstitial:!0,require_authentication:!0,content_only:!0},named:{},resource:{},module:"OAuthDialog",pathPattern:"^/oauth/dialog/$",options:{scope:"?{scope}",state:"?{state}",redirect_uri:"?{redirect_uri}",response_type:"?{response_type}",consumer_id:"?{consumer_id}"}},{extraContent:{suppress_nags:!0,hide_interstitial:!0,suppress_unauth_banner:!0},named:{username:0},resource:{name:"VerifyEmailTokenResource",options:{username:"${username}",token:"?{t}",expiration:"?{e}"}},module:"ResetPasswordPage",pathPattern:"^/pw/([^/]+)/$",options:{username:"${username}",token:"?{t}",expiration:"?{e}"}},{extraContent:{},named:{},resource:{name:"FindPinImagesResource",options:{url:"?{url}"}},module:"ImagesFeedPage",pathPattern:"^/pin/find/$",options:{url:"?{url}"}},{extraContent:{},named:{},resource:{},module:"DomainVerifyByLink",pathPattern:"^/website/confirm/link/",options:{domain:"?{domain}"}},{extraContent:{require_authentication:!0},named:{},resource:{name:"DomainVerifyResource"},module:"DomainVerify",pathPattern:"^/website/confirm/$",options:{}},{extraContent:{},named:{},resource:{name:"UserResource",options:{username:"me"}},module:"HeroVerifyWebsite",pathPattern:"^/verify_website/$",options:{username:"me"}},{extraContent:{hide_interstitial:!0},named:{},resource:{},module:"EmailVerificationError",pathPattern:"/email_verification_error/$",options:{}},{extraContent:{},named:{},resource:{name:"SubdomainResource"},module:"InternationalSubdomains",pathPattern:"^/pinterest-international/$",options:{}},{extraContent:{require_authentication:!0,log:{view_parameter:135,view_type:30}},named:{},resource:{},module:"FriendCenter",pathPattern:"^/find_friends/$",options:{}},{extraContent:{require_authentication:!0,canonical_url:"/find_friends/",log:{view_parameter:135,helper_data:{section:"${section}"},view_type:30}},named:{section:0},resource:{},module:"FriendCenter",pathPattern:"^/find_friends/([^/]+)/",options:{section:"${section}"}},{extraContent:{suppress_nags:!0,content_only_if_mobile:!0,suppress_unauth_banner:!0,hide_interstitial:!0},named:{},resource:{},module:"InitiatePasswordReset",pathPattern:"^/password/reset/",options:{}},{extraContent:{require_authentication:!0},named:{},resource:{name:"UserResource",options:{username:"me"}},module:"BusinessGetStarted",pathPattern:"^/business/getstarted/$",options:{username:"me"}},{extraContent:{},named:{},resource:{name:"RichPinSamplePinResource",options:{}},module:"RichPinBuilder",pathPattern:"^/business/tools/rich-pin-builder/$",options:{}},{extraContent:{require_authentication:!0},named:{},resource:{name:"PartnerResource"},module:"BusinessAccountCreate",pathPattern:"^/business/convert/$",options:{view_type:"convert"}},{extraContent:{content_only:!0},named:{},resource:{name:"PartnerCreateInspiredWallResource"},module:"BusinessAccountCreate",pathPattern:"^/business/create/$",options:{view_type:"create"}},{extraContent:{require_authentication:!0,redirect_on_404:"/?redirected=1"},named:{id:0},resource:{name:"NetworkStoryResource",options:{story_id:"${id}"}},module:"NetworkStoryLandingPage",pathPattern:"^/news/([^/]+)/$",options:{}},{extraContent:{require_authentication:!0,redirect_on_404:"/?redirected=1"},named:{type:0},resource:{name:"NetworkStoryByTypeResource",options:{story_type:"${type}"}},module:"NetworkStoryLandingPage",pathPattern:"^/news/type/([^/]+)/$",options:{}},{extraContent:{perf_log:!0,ios_deep_link:"pinterest://pin/${id}",show_klp_bar:!0,android_deep_link:"pinterest://pin/${id}",log:{helper_data:{pin_id:"${id}"},view_type:3}},named:{id:0},resource:{name:"PinResource",options:{field_set_key:"detailed",ptrf:"?{ptrf}",fetch_visual_search_objects:!0,id:"${id}"}},module:"Closeup",pathPattern:"^/pin/([^/]+)/$",options:{show_reg:"?{show_reg}",ptrf:"?{ptrf}",sender:"?{sender}"}},{extraContent:{require_authentication:!0,content_only:!0,log:{view_parameter:73,helper_data:{csr_id:"?{parentcsrid}"},view_type:52}},named:{},resource:{name:"FakePinResource",options:{link:"?{iframeurl}",image_url:"?{imageurl}",description:"?{description}"}},module:"PinCreate",pathPattern:"^/web-result/save/$",options:{hide_pin_credits:!0,is_clone_for_repin:!0,parent_csr_id:"?{parentcsrid}",render_existing_pin:!0,action:"create",show_explicit_share:!1,is_csr:!0,method:"csr",source_url:"?{iframeurl}"}},{extraContent:{log:{view_parameter:154,helper_data:{pin_id:"${id}"},view_type:3}},named:{id:0},resource:{name:"CSRResource",options:{id:"${id}"}},module:"Closeup",pathPattern:"^/web-result/([^/]+)/$",options:{is_csr:!0}},{extraContent:{noindex:!0,log:{view_type:75}},named:{id:0},resource:{name:"PinResource",options:{field_set_key:"detailed",id:"${id}"}},module:"AggregatedActivityFeed",pathPattern:"^/pin/([^/]+)/activity/$",options:{}},{extraContent:{ios_deep_link:"pinterest://pin/${id}",require_explicit_login:!0,log:{helper_data:{pin_id:"${id}"},view_type:3},show_klp_bar:!0,android_deep_link:"pinterest://pin/${id}",perf_log:!0,canonical_url:"/pin/${id}/"},named:{id:0},resource:{name:"PinResource",options:{field_set_key:"detailed",id:"${id}"}},module:"Closeup",pathPattern:"^/pin/([^/]+)/edit/$",options:{show_edit:!0}},{extraContent:{perf_log:!0,ios_deep_link:"pinterest://repin/${id}",show_klp_bar:!0,android_deep_link:"pinterest://repin/${id}",log:{helper_data:{pin_id:"${id}"},view_type:3}},named:{id:0},resource:{name:"PinResource",options:{field_set_key:"detailed",ptrf:"?{ptrf}",fetch_visual_search_objects:!0,id:"${id}"}},module:"Closeup",pathPattern:"^/pin/([^/]+)/repin/$",options:{show_repin:!0}},{extraContent:{android_deep_link:"pinterest://repin/${id}",require_authentication:!0,content_only:!0,ios_deep_link:"pinterest://repin/${id}"},named:{id:0},resource:{name:"PinResource",options:{field_set_key:"repin",id:"${id}"}},module:"PinBookmarklet",pathPattern:"^/pin/([^/]+)/repin/x/$",options:{action:"repin",pin_id:"${id}",method:"bookmarklet",default_repin_board_id:"?{bid}"}},{extraContent:{perf_log:!0,ios_deep_link:"pinterest://pin/${id}",show_klp_bar:!0,android_deep_link:"pinterest://pin/${id}",log:{helper_data:{pin_id:"${id}"},view_type:3}},named:{id:0},resource:{name:"PinResource",options:{field_set_key:"detailed",id:"${id}"}},module:"Closeup",pathPattern:"^/pin/([^/]+)/comments/$",options:{show_reg:"?{show_reg}",show_comments:!0,sender:"?{sender}"}},{extraContent:{noindex:!0},named:{id:0},resource:{name:"RepinFeedResource",options:{pin_id:"${id}",page_size:50}},module:"RepinsLikesFeedPage",pathPattern:"^/pin/([^/]+)/repins/$",options:{pin_id:"${id}",type:"repins"}},{extraContent:{noindex:!0},named:{id:0},resource:{name:"PinLikesResource",options:{pin_id:"${id}",page_size:50}},module:"RepinsLikesFeedPage",pathPattern:"^/pin/([^/]+)/likes/$",options:{pin_id:"${id}",type:"likes"}},{extraContent:{},named:{id:0},resource:{name:"PinResource",options:{field_set_key:"detailed",fetch_visual_search_objects:!0,id:"${id}"}},module:"CloseupFlashlight",pathPattern:"^/pin/([^/]+)/visual-search/$",options:{has_animation:!1,force_refresh:!0,h:"?{h}",w:"?{w}",y:"?{y}",x:"?{x}"}},{extraContent:{require_authentication:!0,content_only:!0,log:{view_parameter:119,helper_data:{guid:"?{guid}",method:"${method}"},view_type:12},ios_deep_link:"pinterest://add_pin/?method=${method}&image_url=?{media}&source_url=?{url}&description=?{description}"},named:{method:0},resource:{},module:"PinBookmarklet",pathPattern:"^/pin/create/([^/]+)/$",options:{is_pin_fave:"?{pinFave}",image_url:"?{media}",description:"?{description}",title:"?{title}",url:"?{url}",guid:"?{guid}",is_video:"?{is_video}",method:"${method}",is_from_external:"true"}},{extraContent:{noindex:!0,ios_deep_link:"pinterest://pin/${id}",android_deep_link:"pinterest://pin/${id}",log:{helper_data:{pin_id:"${id}"},view_type:3},sent_pin_experiment:"?{spe}",show_klp_bar:!0,hide_banner:!0,hide_interstitial:!0,perf_log:!0,briofy:!0},named:{id:0},resource:{name:"PinResource",options:{field_set_key:"detailed",id:"${id}"}},module:"SentPin",pathPattern:"^/pin/([^/]+)/sent/$",options:{show_reg:"?{show_reg}",conversation_id:"?{conversation}",sender_id:"?{sender}",conversation_obfuscated_data:"?{od}",conversation_user_id:"?{user_id}"}},{extraContent:{android_deep_link:"pinterest://www.pinterest.com/settings/",require_authentication:!0,require_explicit_login:!0,log:{view_type:7},ios_deep_link:"pinterest://settings/"},named:{},resource:{name:"UserSettingsResource"},module:"UserSettingsPageReactWrapper",pathPattern:"^/settings/$",options:{}},{extraContent:{},named:{},resource:{},module:"BrowserExtensionUninstallPage",pathPattern:"^/settings/extension/uninstall/$",options:{}},{extraContent:{suppress_nags:!0,suppress_nag_download:!0,suppress_js_nag:!0,hide_interstitial:!0},named:{},resource:{name:"SignedEmailSubscriptionResource",options:{od:"?{od}",user_id:"?{user_id}"}},module:"SignedEmailUnsubscribePage",pathPattern:"^/email/subscription/$",options:{}},{extraContent:{suppress_nags:!0,suppress_nag_download:!0,suppress_js_nag:!0},named:{},resource:{name:"SignedEmailSettingsResource",options:{od:"?{od}",user_id:"?{user_id}"}},module:"SignedEmailSettingsPage",pathPattern:"^/email/settings/$",options:{}},{extraContent:{content_only:!0,ios_deep_link:"pinterest://user/${username}?follow=1",android_deep_link:"pinterest://user/${username}?follow=1",sub_page:"pins/follow/"},named:{username:0},resource:{name:"UserResource",options:{username:"${username}",field_set_key:"detailed"}},module:"UserProfileFollow",pathPattern:"^/([^/]+)/pins/follow/$",options:{}},{extraContent:{content_only:!0,ios_deep_link:"pinterest://board/${username}/${slug}?follow=1",android_deep_link:"pinterest://board/${username}/${slug}?follow=1",board_sub_page:"follow/"},named:{username:0,slug:1},resource:{name:"BoardResource",options:{username:"${username}",field_set_key:"detailed",slug:"${slug}"}},module:"UserBoardFollow",pathPattern:"^/([^/]+)/([^/]+)/follow/$",options:{}},{extraContent:{ios_deep_link:"pinterest://pinpicks/${country}/${pinpick}/",android_deep_link:"pinterest://www.pinterest.com/pinpicks/${country}/${pinpick}/",log:{helper_data:{pinpickname:"${pinpick}",country:"${country}"},view_type:44},canonical_url:"/pinpicks/${country}/${pinpick}/"},named:{country:0,pinpick:1},resource:{name:"PinPicksResource",options:{pinpickname:"${pinpick}",country:"${country}"}},module:"PinPicksDetail",pathPattern:"^/pinpicks/([^/]+)/([^/]+)/$",options:{}},{extraContent:{content_only:!0},named:{},resource:{name:"MobileLandingResource",options:{device:"Mobile"}},module:"MobileLandingPage",pathPattern:"^/mobile/$",options:{device:"Mobile"}},{extraContent:{content_only:!0},named:{},resource:{name:"MobileLandingResource",options:{device:"Android",platform:"android"}},module:"MobileLandingPage",pathPattern:"^/android/$",options:{device:"Android",platform:"android"}},{extraContent:{content_only:!0},named:{},resource:{name:"MobileLandingResource",options:{device:"iOS",platform:"iOS"}},module:"MobileLandingPage",pathPattern:"^/ios/$",options:{device:"iOS",platform:"iOS"}},{extraContent:{content_only:!0},named:{},resource:{name:"MobileLandingResource",options:{device:"iPhone",platform:"iOS"}},module:"MobileLandingPage",pathPattern:"^/iphone/$",options:{device:"iPhone",platform:"iOS"}},{extraContent:{content_only:!0},named:{},resource:{name:"MobileLandingResource",options:{device:"iPad",platform:"iOS"}},module:"MobileLandingPage",pathPattern:"^/ipad/$",options:{device:"iPad",platform:"iOS"}},{extraContent:{content_only:!0},named:{},resource:{name:"MobileLandingResource",options:{device:"Tablet"}},module:"MobileLandingPage",pathPattern:"^/tablet/$",options:{device:"Tablet"}},{extraContent:{suppress_nags:!0,suppress_nag_download:!0,suppress_js_nag:!0},named:{},resource:{name:"SignedEmailAssociationResource",options:{od:"?{od}",user_id:"?{user_id}"}},module:"SignedEmailDisassociatePage",pathPattern:"^/email/remove/$",options:{}},{extraContent:{redirect:"/explore/${url_name}/"},named:{locale:0,url_name:1},resource:{},module:"",pathPattern:"^/editorial/([^/]+)/([^/]+)/$",options:{}},{extraContent:{},named:{locale:0,url_name:1},resource:{name:"EditorialResource",options:{locale:"${locale}",is_business:!0,url_name:"${url_name}"}},module:"Editorial",pathPattern:"^/business/([^/]+)/([^/]+)/$",options:{}},{extraContent:{suppress_nags:!0,suppress_nag_download:!0,suppress_js_nag:!0},named:{},resource:{},module:"PinfluencerOptOutConfirmationPage",pathPattern:"^/pinfluencer/opted_out/$",options:{}},{extraContent:{ios_deep_link:"pinterest://feed/home",android_deep_link:"pinterest://",log:{view_parameter:92,view_type:1},suppress_unauth_banner:!0,content_only_if_unauth:!0,allow_nux:!0,is_home_page:!0},named:{},resource:{},module:"HomePage",pathPattern:"^/$",options:{auto_follow_interest:"?{auto_follow_interest}",allow_nux:"?{allow_nux}",fb_ad:"?{fb_ad}",tab:"following",logged_out:"?{logged_out}",prev:"?{prev}",email_updated:"?{ues}",cmp:"?{cmp}"}},{extraContent:{ios_deep_link:"pinterest://notifications",android_deep_link:"pinterest://www.pinterest.com/notifications",log:{view_parameter:92,view_type:1},suppress_unauth_banner:!0,content_only_if_unauth:!0,allow_nux:!0,is_home_page:!0},named:{},resource:{},module:"HomePage",pathPattern:"^/notifications/$",options:{auto_follow_interest:"?{auto_follow_interest}",allow_nux:"?{allow_nux}",fb_ad:"?{fb_ad}",tab:"following",notifications_open:!0,logged_out:"?{logged_out}",prev:"?{prev}",email_updated:"?{ues}",cmp:"?{cmp}"}},{extraContent:{log:{view_parameter:129,view_type:1}},named:{domain:0},resource:{name:"DomainResource",options:{field_set_key:"access",domain:"${domain}"}},module:"DomainFeedPage",pathPattern:"^/source/([^/]+)/$",options:{domain:"${domain}",feed_item_type:"most_recent"}},{extraContent:{content_only:!0},named:{},resource:{},module:"InviteLanding",pathPattern:"^/invited/$",options:{invite_code:"?{invite_code}",inviter_user_id:"?{inviter_user_id}",invite_type:"?{invite_type}"}},{extraContent:{hide_interstitial:!0,content_only:!0,suppress_unauth_banner:!0},named:{},resource:{},module:"LoginPage",pathPattern:"^/login/$",options:{prev:"?{prev}",auto_follow:"?{auto_follow}",hide_dismiss:!0,next:"?{next}"}},{extraContent:{hide_interstitial:!0,content_only:!0},named:{},resource:{},module:"PasswordResetOneClick",pathPattern:"^/login/reset/$",options:{username_or_email:"?{username_or_email}"}},{extraContent:{redirect:"/",hide_interstitial:!0},named:{},resource:{},module:"",pathPattern:"^/join/signup/",options:{}},{extraContent:{redirect:"/",hide_interstitial:!0},named:{},resource:{},module:"",pathPattern:"^/signup/",options:{}},{extraContent:{hide_interstitial:!0,content_only:!0,suppress_unauth_banner:!0},named:{},resource:{name:"InspiredWallResource",options:{override_story:"register"}},module:"UnauthHomePage",pathPattern:"^/join/register/",options:{register:!0,wallClass:"whiteWall",next:"?{next}"}},{extraContent:{hide_interstitial:!0,content_only:!0,suppress_unauth_banner:!0},named:{},resource:{name:"InspiredWallResource",options:{override_story:"register"}},module:"UnauthHomePage",pathPattern:"^/join/.*$",options:{register:!0,invite_follow_user:"?{username}",next:"?{next}",auto_follow_interest:"?{auto_follow_interest}",invite_follow_board:"?{boardname}",prev:"?{prev}",wallClass:"whiteWall"}},{extraContent:{hide_interstitial:!0,content_only:!0},named:{network:0},resource:{},module:"UserRegisterPage",pathPattern:"^/join/register/([^/]+)/",options:{auto_follow_interest:"?{auto_follow_interest}",prev:"?{prev}",network:"${network}",next:"?{next}"}},{extraContent:{hide_interstitial:!0,content_only:!0},named:{reason:0},resource:{},module:"UserRegisterRestricted",pathPattern:"^/restricted/([^/]+)/",options:{reason:"${reason}"}},{extraContent:{ios_deep_link:"pinterest://search/",android_deep_link:"pinterest://categories/",log:{view_type:19}},named:{},resource:{name:"CategoriesResource",options:{field_set_key:"default",category_types:"main,non_board",browsable:"true"}},module:"CategoriesPage",pathPattern:"^/categories/$",options:{}},{extraContent:{perf_log:!0,android_deep_link:"pinterest://www.pinterest.com/categories/${category}",ios_deep_link:"pinterest://categories/${category}",log:{helper_data:{feed:"${category}",is_category:!0},view_type:1}},named:{category:0},resource:{name:"CategoryResource",options:{category:"${category}"}},module:"FeedPage",pathPattern:"^/categories/([^/]+)/$",options:{feed:"${category}",is_category:!0,high_price:"?{high_price}",low_price:"?{low_price}"}},{extraContent:{hide_interstitial:!0},named:{},resource:{},module:"CsrfErrorPage",pathPattern:"/csrf_error/$",options:{}},{extraContent:{hide_interstitial:!0,content_only:!0},named:{},resource:{},module:"OAuthErrorPage",pathPattern:"/oauth_error/$",options:{error_message:"?{error_message}"}},{extraContent:{hide_interstitial:!0},named:{},resource:{},module:"TrademarkFormSelector",pathPattern:"^/about/trademark/form/$",options:{}},{extraContent:{hide_interstitial:!0},named:{claim_type:0},resource:{},module:"TrademarkForm",pathPattern:"^/about/trademark/form/([^/]+)/$",options:{claim_type:"${claim_type}"}},{extraContent:{hide_interstitial:!0},named:{id:0},resource:{},module:"TakedownForm",pathPattern:"^/about/copyright/dmca-pin/web-result/([^/]+)",options:{initial_value:"https://www.pinterest.com/web-result/${id}",view_type:"dmcapin"}},{extraContent:{hide_interstitial:!0},named:{id:0},resource:{},module:"TakedownForm",pathPattern:"^/about/copyright/dmca-pin/pin/([^/]+)",options:{initial_value:"https://www.pinterest.com/pin/${id}",view_type:"dmcapin"}},{extraContent:{hide_interstitial:!0},named:{},resource:{},module:"TakedownForm",pathPattern:"^/about/copyright/dmca-pin/",options:{view_type:"dmcapin"}},{extraContent:{hide_interstitial:!0},named:{},resource:{},module:"AppealForm",pathPattern:"^/about/appeal/form/",options:{}},{extraContent:{suppress_nags:!0,suppress_nag_download:!0,suppress_js_nag:!0},named:{},resource:{},module:"AppealConfirmationPage",pathPattern:"^/appeal/submitted/$",options:{}},{extraContent:{hide_interstitial:!0,content_only:!0},named:{},resource:{},module:"LogoutAppUpsell",pathPattern:"^/loggedout/getapp/",options:{username:"?{username}"}},{extraContent:{perf_log:!0,log:{view_parameter:43,view_type:2}},named:{},resource:{name:"BaseSearchResource",options:{scope:"pins",boost:"recent_week",show_scope_selector:!0,query:"?{q}"}},module:"SearchPage",pathPattern:"^/search/pins/recent/$",options:{query:"?{q}",boost:"recent_week",scope:"pins"}},{extraContent:{},named:{},resource:{name:"VisualSearchResource"},module:"VisualSearchPage",pathPattern:"^/visualsearch/browse/$",options:{}},{extraContent:{},named:{browse_object:0},resource:{name:"VisualSearchResource",options:{browse_object:"${browse_object}"}},module:"VisualSearchPage",pathPattern:"^/visualsearch/browse/([^/]+)/$",options:{}},{extraContent:{},named:{id:0},resource:{name:"VisualSearchResource",options:{pin_id:"${id}"}},module:"VisualSearchPage",pathPattern:"^/visualsearch/([^/]+)/$",options:{}},{extraContent:{},named:{obj:1,id:0},resource:{name:"VisualSearchResource",options:{pin_id:"${id}",obj_id:"${obj}"}},module:"VisualSearchPage",pathPattern:"^/visualsearch/([^/]+)/([^/]+)/$",options:{}},{extraContent:{},named:{type:0,id:1},resource:{name:"VisualSearchResource",options:{pin_type:"${type}",pin_id:"${id}"}},module:"VisualSearchPage",pathPattern:"^/search/([^/]+)/([^/]+)/$",options:{pin_type:"${type}",pin_id:"${id}"}},{extraContent:{content_only:!0},named:{},resource:{name:"UserOrdersResource",options:{field_set_key:"detailed"}},module:"UserOrdersPage",pathPattern:"^/orders/$",options:{}},{extraContent:{perf_log:!0},named:{},resource:{name:"UserResource",options:{username:"me"}},module:"UserProfilePage",pathPattern:"^/board/create/",options:{board_create:"1",tab:"boards"}},{extraContent:{perf_log:!0,ios_deep_link:"pinterest://user/${username}",android_deep_link:"pinterest://www.pinterest.com/${username}",log:{view_parameter:49,view_type:4},canonical_url:"/${username}/"},named:{username:0},resource:{name:"UserResource",options:{username:"${username}",invite_code:"?{invite_code}"}},module:"UserProfilePage",pathPattern:"^/([^/]+)/$",options:{show_redirected_memo:"?{redirected}",show_follow_memo:"?{auto_follow}",tab:"boards"}},{extraContent:{perf_log:!0,android_deep_link:"pinterest://www.pinterest.com/${username}",ios_deep_link:"pinterest://user/${username}",log:{view_parameter:49,view_type:4}},named:{username:0},resource:{name:"UserResource",options:{username:"${username}"}},module:"UserProfilePage",pathPattern:"^/([^/]+)/boards/$",options:{tab:"boards"}},{extraContent:{perf_log:!0,android_deep_link:"pinterest://www.pinterest.com/${username}",ios_deep_link:"pinterest://user/${username}",sub_page:"pins/",log:{view_parameter:74,view_type:4}},named:{username:0},resource:{name:"UserResource",options:{username:"${username}"}},module:"UserProfilePage",pathPattern:"^/([^/]+)/pins/$",options:{tab:"pins"}},{extraContent:{noindex:!0,ios_deep_link:"pinterest://user/${username}",android_deep_link:"pinterest://www.pinterest.com/${username}",log:{view_parameter:52,view_type:4},sub_page:"likes/",perf_log:!0},named:{username:0},resource:{name:"UserResource",options:{username:"${username}"}},module:"UserProfilePage",pathPattern:"^/([^/]+)/likes/$",options:{tab:"likes"}},{extraContent:{noindex:!0,ios_deep_link:"pinterest://user/${username}",android_deep_link:"pinterest://www.pinterest.com/${username}",log:{view_parameter:50,view_type:4},sub_page:"followers/",perf_log:!0},named:{username:0},resource:{name:"UserResource",options:{username:"${username}"}},module:"UserProfilePage",pathPattern:"^/([^/]+)/followers/$",options:{tab:"followers"}},{extraContent:{noindex:!0,ios_deep_link:"pinterest://user/${username}",android_deep_link:"pinterest://www.pinterest.com/${username}",log:{view_parameter:51,view_type:4},sub_page:"following/",perf_log:!0},named:{username:0},resource:{name:"UserResource",options:{username:"${username}"}},module:"UserProfilePage",pathPattern:"^/([^/]+)/following/$",options:{tab:"following"}},{extraContent:{},named:{},resource:{},module:"ShopSpace",pathPattern:"^/shop/shop_space/$",options:{}},{extraContent:{},
named:{},resource:{name:"CommerceOrderHistoryResource",options:{commerceResource:!0}},module:"OrderHistory",pathPattern:"^/shop/order_history/$",options:{}},{extraContent:{},named:{},resource:{name:"CommerceShippingDetailsResource",options:{commerceResource:!0}},module:"ShippingAddress",pathPattern:"^/shop/shipping_address/$",options:{}},{extraContent:{ios_deep_link:"pinterest://board/${username}/${slug}",show_klp_bar:!0,android_deep_link:"pinterest://board/${username}/${slug}",log:{view_type:5},redirect_on_404:"/${username}/?redirected=1"},named:{username:0,slug:1},resource:{name:"BoardResource",options:{username:"${username}",field_set_key:"detailed",slug:"${slug}"}},module:"BoardPage",pathPattern:"^/([^/]+)/([^/]+)/$",options:{inviter_user_id:"?{inviter_user_id}",invite_type:"?{invite_type}",show_follow_memo:"?{auto_follow}",board_invite_code:"?{board_invite_code}",invite_code:"?{invite_code}",ptrf:"?{ptrf}"}},{extraContent:{ios_deep_link:"pinterest://board/${username}/${slug}",android_deep_link:"pinterest://board/${username}/${slug}",log:{view_type:5},show_klp_bar:!0,require_explicit_login:!0,canonical_url:"/${username}/${slug}/"},named:{username:0,slug:1},resource:{name:"BoardResource",options:{username:"${username}",field_set_key:"detailed",slug:"${slug}"}},module:"BoardPage",pathPattern:"^/([^/]+)/([^/]+)/edit/$",options:{show_edit:!0}},{extraContent:{ios_deep_link:"pinterest://board/${username}/${slug}",android_deep_link:"pinterest://board/${username}/${slug}",log:{view_type:5},show_klp_bar:!0,require_explicit_login:!0,canonical_url:"/${username}/${slug}/"},named:{username:0,slug:1},resource:{name:"BoardResource",options:{username:"${username}",field_set_key:"detailed",slug:"${slug}"}},module:"BoardPage",pathPattern:"^/([^/]+)/([^/]+)/invite/$",options:{board_collab_inviter:!0}},{extraContent:{ios_deep_link:"pinterest://board/${username}/${slug}",show_klp_bar:!0,android_deep_link:"pinterest://board/${username}/${slug}",log:{view_type:5},canonical_url:"/${username}/${slug}/"},named:{username:0,slug:1},resource:{name:"BoardResource",options:{username:"${username}",field_set_key:"detailed",slug:"${slug}"}},module:"BoardPage",pathPattern:"^/([^/]+)/([^/]+)/pins/$",options:{}},{extraContent:{noindex:!0,redirect:"/${username}/${slug}/",log:{view_parameter:54,view_type:5}},named:{username:0,slug:1},resource:{},module:"BoardPage",pathPattern:"^/([^/]+)/([^/]+)/followers/$",options:{}},{extraContent:{ios_deep_link:"pinterest://shop_space/${section}/${collection}/",android_deep_link:"pinterest://www.pinterest.com/shop_space/${section}/${collection}/",log:{view_parameter:92,view_type:1}},named:{section:0,collection:1},resource:{name:"ShopSpaceCollectionResource",options:{section:"${section}",collection:"${collection}"}},module:"ShopBoardPage",pathPattern:"^/shop_space/([^/]+)/([^/]+)/$",options:{}},{extraContent:{},named:{merchant:0},resource:{name:"ShopMerchantResource",options:{merchant:"${merchant}"}},module:"ShopMerchantPage",pathPattern:"^/shop/merchants/([^/]+)/$",options:{}},{extraContent:{},named:{section:0,collection:1},resource:{name:"ShopSpaceCollectionResource",options:{section:"${section}",collection:"${collection}"}},module:"ShopBoardPage",pathPattern:"^/shop/([^/]+)/([^/]+)/$",options:{}},{extraContent:{content_only:!0},named:{},resource:{},module:"Echo",pathPattern:"^/_/_/perf1/",options:{}},{extraContent:{},named:{},resource:{},module:"Echo",pathPattern:"^/_/_/perf2/",options:{}},{extraContent:{},named:{},resource:{name:"CategoriesResource"},module:"Echo",pathPattern:"^/_/_/perf3/",options:{}},{extraContent:{},named:{},resource:{name:"PinResource",options:{id:0x314010007628d0}},module:"Echo",pathPattern:"^/_/_/perf4/",options:{}}]}]);