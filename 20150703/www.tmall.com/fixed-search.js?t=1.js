KISSY.add("fp/mods/fixed-search",function(e,t){return{init:function(a){if(e.UA.ie<7){return}var n=t.one("body"),i,r,o=t(window),s=false,d=t.one("#mallSearch"),l,u,f=t.one("#mq");if(!d||!f)return;var c=t.one("#J_FpBrandRec");var p=c?c.offset().top:688;n.append('<div class="as-shelter"></div><div id="J_ASTotalContainer" class="as-total-container"><div id="J_AttachedSearchContainer" class="attached-search-container"><div class="fp-iconfont">&#x3450;</div></div></div>');var m=t.one("#J_AttachedSearchContainer");var v=t.one("#J_ASTotalContainer"),h=t.one(".as-shelter");t(window).on("scroll",KISSY.buffer(function(e){if(o.scrollTop()>p){if(s===false||v.css("display")!=="block"){f[0].blur();setTimeout(function(){d.appendTo(m)},100);v.addClass("show");h.addClass("show");s=true;if(TB&&TB.instance&&TB.instance.searchbar){i=TB.instance.searchbar;r=i.get("log");r["clickId"]="attachedsearch";i.set("log",r)}if(l===undefined){u=setInterval(function(){var e=t.one(".s-menu");if(e){e.css({position:"fixed"});e.css({top:"40px"});clearInterval(u)}},500)}if(l===undefined&&t.one(".s-menu")){l=t.one(".s-menu")}if(l){l.css({opacity:1});l.css({position:"fixed"})}}}else if(o.scrollTop()<=p){if(s===true){f[0].blur();d.appendTo(".header-extra");v.removeClass("show");h.removeClass("show");s=false;clearInterval(u);if(TB&&TB.instance&&TB.instance.searchbar){i=TB.instance.searchbar;r=i.get("log");r["clickId"]="topsearch";i.set("log",r)}if(l===undefined&&t.one(".s-menu")){l=t.one(".s-menu")}if(l){l.css({position:"absolute"})}}}},30))}}},{requires:["node"]});