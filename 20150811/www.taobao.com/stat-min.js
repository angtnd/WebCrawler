KISSY.add("tbc/search-suggest/1.4.8/mods/stat",function(t,e,n,a,i){function r(t){r.superclass.constructor.call(this,t||{})}return KISSY.extend(r,e,{pluginInitializer:function(t){var e=this,n=e.get("stat");e.set("caller",t),t.on("beforeSubmit",function(t){var n=t.isInitSearch;e.setStat(n)}),n&&(e.sendTongji(),e.bindSearchTrace())},bindSearchTrace:function(){var t=this;a.delegate("body","click","a",t.initSearchTrace,t)},initSearchTrace:function(t){var e=this,n=t.currentTarget,a=n.getAttribute("trace"),i=n.getAttribute("href");if(a)switch(a){case"relatedSearch":e.saveQuery();break;case"auction":var r=e.stat;r&&-1===i.indexOf("initiative_new")&&n.setAttribute("href",i+"&initiative_new=1")}},sendTongji:function(){var t,e=this,n=e.getStatInst();n.checkFlash({onSuccess:function(){t=n.query("stat")[0],t&&t.value&&(e.stat=t.value,e.send("f_stats_show="+t.value,!0))}})},setStat:function(t,e){var n=this,a=n.get("caller"),i=a.query,r=n.saveQuery(i,t);r&&n.send("lf_aclog=null-null-null-null-0&stats_click="+r,e)},getStatInst:function(){var t=this,e=t.get("caller"),n=e.get("sugConfig"),a=n.tab||"",r=new i({name:"stat",tab:a});return r},saveQuery:function(t,e){var n,a,i=this.getStatInst();return e&&t?(n=encodeURIComponent(t),a="initiative_new:1;q:"+n,i.save("stat",a)):i.deleteItem("stat"),a},send:function(t,e){var n,a;e?(n="/tongji",a="H51884970"):(n="/search",a="H51884969"),(window.goldlog_queue||(window.goldlog_queue=[])).push({action:"goldlog.record",arguments:[n,"",t,a]})},renderPlugin:function(){}},{ATTRS:{pluginId:{value:"stat"}}}),r},{requires:["base","cookie","event","../mods/local-query"]});