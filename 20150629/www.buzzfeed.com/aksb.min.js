/*
Copyright 2010 Google Inc.
Copyright 2014 Akamai Technolgies

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

See the source code here:
     http://code.google.com/p/episodes/
*/

(function(b){b.parent!==b&&void 0==b.AKSB&&(b=b.parent);var m=b.document;"undefined"===typeof b.AKSB&&(b.AKSB={});var a=b.AKSB;if(void 0!=a.prof&&!0===a.prof.origin&&("number"!==typeof a.prof.beaconrate&&(a.prof.beaconrate=10),parseInt(a.prof.beaconrate,10)<=100*Math.random()))return;a.q=a.q||[];a.targetOrigin=m.location.protocol+"//"+m.location.hostname;a.testObject=a.testObject||"AkamaiSiteBeaconTestObject0123456789.txt";a.autorun="undefined"!==typeof a.autorun?a.autorun:!0;a.version||(a.version=
"0.3",a.init=function(){a.bDone=!1;a.marks={};a.measures={};a.starts={};a.getClientProf();a.findStartTime();a.addEventListener("DOMContentLoaded",a.onready,!1);a.addEventListener("beforeunload",a.beforeUnload,!1);a.addEventListener("load",a.onload,!1);"complete"===m.readyState&&(a.onloadHasFired=!0,window.setTimeout(a.onload,1));a.processQ()},a.processQ=function(){for(var c=a.q.length,b=0;b<c;b++){var d=a.q[b],k=d[0];"mark"===k?a.mark(d[1],d[2]):"measure"===k?a.measure(d[1],d[2],d[3]):"done"===k&&
a.done(d[1])}},a.getClientProf=function(){a.prof=a.prof||{};a.prof.beaconUrl=a.prof.beaconUrl||("https:"===m.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/2/"+a.prof.custid+"/b";a.prof.ua=escape(b.navigator.userAgent);a.prof.plat=escape(b.navigator.platform);a.prof.uri=escape(m.location.protocol.toLowerCase()+"//"+m.location.hostname.toLowerCase()+m.location.pathname);var c=b.navigator.connection||b.navigator.mozConnection||b.navigator.webkitConnection,e="",d="";c&&"number"===typeof c.type?
c.type==c.WIFI?(e="wifi",d=7E6):c.type==c.CELL_2G?(e="cellular",d=384):c.type==c.CELL_3G?(e="cellular",d=42E3):c.type==c.CELL_4G?(e="cellular",d=1E5):c.type==c.ETHERNET?(e="ethernet",d=1E7):c.type==c.NONE?(e="none",d=0):e="unknown":c&&"string"===typeof c.type&&(e=c.type,c.downlinkMax&&(d=Math.round(1E3*c.downlinkMax)));a.prof.connType=escape(e);a.prof.connBandwidth=d;a.prof.pageViz=m.visibilityState||m.webkitVisibilityState||m.mozVisibilityState||m.msVisibilityState;"undefined"!==typeof b.chrome&&
b.chrome.hasOwnProperty("loadTimes")&&(a.prof.spdy=b.chrome.loadTimes().wasFetchedViaSpdy?!0:!1);a.prof.feo="undefined"!==typeof b.aFeoApplied?!0:!1;a.prof.qryTrunc=""!==m.location.search;!a.prof.pct||parseInt(a.prof.pct,10)<=100*Math.random()||void 0===a.prof.clientip||(a.prof.ipv6?(c=a.prof.clientip.split(":"),c=(""==c[0]?"":parseInt(c[0],16).toString(32))+"z"+(""==c[1]?"":parseInt(c[1],16).toString(32))+"z"+(""==c[2]?"":parseInt(c[2],16).toString(32)),a.prof.beaconUrl=("https:"===m.location.protocol?
"https:":"http:")+"//j"+c+"-ds-aksb-a.akamaihd.net/2/"+a.prof.custid+"/b"):(c=a.prof.clientip.split("."),c=("00000000"+(256*(256*(256*+c[0]+ +c[1])+ +c[2])+0).toString(16)).slice(-8),a.prof.beaconUrl=("https:"===m.location.protocol?"https:":"http:")+"//i"+c+"-ds-aksb-a.akamaihd.net/2/"+a.prof.custid+"/b"))},a.mark=function(c,b){c&&(a.marks[c]=parseInt(b||(new Date).getTime(),10),"firstbyte"===c?a.measure("t_fb","starttime","firstbyte"):"onload"===c?a.measure("t_onload","starttime","onload"):"done"===
c&&a.measure("t_plt","starttime","done"))},a.measure=function(c,b,d){if(c){if("undefined"===typeof b)b="number"===typeof a.marks[c]?a.marks[c]:(new Date).getTime();else if("number"===typeof a.marks[b])b=a.marks[b];else if("number"!==typeof b)return;if("undefined"===typeof d)d=(new Date).getTime();else if("number"===typeof a.marks[d])d=a.marks[d];else if("number"!==typeof d)return;a.starts[c]=parseInt(b,10);a.measures[c]=parseInt(d-b,10)}},a.done=function(c){a.mark("done");var e=function(){a.bDone=
!0;a.autorun&&a.sendBeacon();"function"===typeof c&&c()};if(a.prof.navTimingSupported){var d=a.getNavTimingAPI(),k=d.navigation,f=d.timing,h=function(){if(k&&(0===k.type||1===k.type)&&f&&0<f.loadEventEnd){for(var c in f)a.mark(c,f[c]);a.measure("dE","domainLookupStart","domainLookupEnd");a.measure("cS","domainLookupStart","connectStart");f.secureConnectionStart&&a.measure("sS","domainLookupStart","secureConnectionStart");a.measure("cE","domainLookupStart","connectEnd");a.measure("rqS","domainLookupStart",
"requestStart");a.measure("rsS","domainLookupStart","responseStart");a.measure("rsE","domainLookupStart","responseEnd");f.msFirstPaint?a.measure("fp","navigationStart","msFirstPaint"):"undefined"!==typeof b.chrome&&b.chrome.hasOwnProperty("loadTimes")&&a.measure("fp","domainLookupStart",Math.round(1E3*b.chrome.loadTimes().firstPaintTime));a.measure("dl","domainLookupStart","domLoading");a.measure("di","domainLookupStart","domInteractive");a.measure("dlS","domainLookupStart","domContentLoadedEventStart");
a.measure("dlE","domainLookupStart","domContentLoadedEventEnd");a.measure("dc","domainLookupStart","domComplete");a.measure("leS","domainLookupStart","loadEventStart");a.measure("leE","domainLookupStart","loadEventEnd");e()}else 0>=f.loadEventEnd&&setTimeout(h,100)};h()}else e()},a.sendBeacon=function(c,b){c=c||a.prof.beaconUrl;var d="";a.bf=a.bitField();a.createBitField();var k={dE:a.measures.dE,cS:a.measures.cS,cE:a.measures.cE,rqS:a.measures.rqS,rsS:"undefined"!==typeof a.measures.rsS?a.measures.rsS:
a.measures.t_fb,rsE:a.measures.rsE,sS:a.measures.sS,dl:a.measures.dl,di:a.measures.di,fp:a.measures.fp,dlS:a.measures.dlS,dlE:"undefined"!==typeof a.measures.dlE?a.measures.dlE:a.measures.t_onready,dc:a.measures.dc,leS:"undefined"!==typeof a.measures.leS?a.measures.leS:a.measures.t_onload,leE:"undefined"!==typeof a.measures.leE?a.measures.leE:a.measures.t_plt,to:a.measures.to,ol:a.prof.originlat,cr:a.prof.clientrtt,mt:a.prof.connType,mb:a.prof.connBandwidth,b:a.bf.get(),u:a.prof.uri,ua:a.prof.ua,
pl:a.prof.plat,us:a.prof.ustr,gh:a.prof.ghostip,t:a.prof.token,rid:a.prof.requestid,akM:a.prof.akM,akN:a.prof.akN},f;for(f in k)d+="&"+escape(f)+"="+("undefined"===typeof k[f]?"":k[f]);if(d){d=d.substring(1);if(b)for(var h in b)b.hasOwnProperty(h)&&(d+="&"+escape(h)+"="+escape(b[h]));a.bf.get();k=new Image;k.src=c+"?"+d;return k.src}return""},a.bitField=function(a){var b=Math.abs(a);a=function(){};a.prototype.set=function(a){return this.hasbit(a)?b:b|=a};a.prototype.hasbit=function(a){return a>b?
0:b&a};a.prototype.get=function(){return b};return new a},a.createBitField=function(){"nt"===a.prof.src&&a.bf.set(1);"js"===a.prof.src&&a.bf.set(2);"ck"===a.prof.src&&a.bf.set(4);"gtb"===a.prof.src&&a.bf.set(8);void 0!==a.prof.protocol&&"h2"==a.prof.protocol.slice(0,2)&&a.bf.set(131072);a.prof.ipv6&&a.bf.set(16);a.prof.feo&&a.bf.set(32);a.prof.spdy&&a.bf.set(64);"hidden"===a.prof.pageViz&&a.bf.set(128);"visible"===a.prof.pageViz&&a.bf.set(256);"prerendered"===a.prof.pageViz&&a.bf.set(512);a.prof.qryTrunc&&
a.bf.set(2048);!0===a.prof.origin&&a.bf.set(4096);!0===a.onloadHasFired&&a.bf.set(8192);b.performance&&(b.performance.getEntries||b.performance.webkitGetEntries)||a.bf.set(16384)},a.findStartTime=function(){a.processQ();var b=a.findStartWebTiming()||a.findStartGToolbar()||a.findStartCookie();!b&&a.marks.firstbyte&&(b=a.marks.firstbyte,a.prof.src="js");b&&a.mark("starttime",b)},a.findStartWebTiming=function(){var b=void 0,e=a.getNavTimingAPI();if("undefined"!==typeof e&&"undefined"!==typeof e.timing&&
"undefined"!==typeof e.timing.navigationStart)a.prof.navTimingSupported=!0,b=a.prof.ua.match(/Firefox\/[78]\./i)?e.timing.unloadEventStart||e.timing.fetchStart:e.timing.navigationStart,a.prof.src="nt";else if(a.prof.xhrtest){var d=a.newXHR();if(d){a.mark("testobj-start");d.open("get",("https:"===document.location.protocol?"https:":"http:")+"//"+m.location.hostname+"/"+a.testObject,!0);var k=setTimeout(function(){d.abort()},1E4);d.onreadystatechange=function(){4===d.readyState&&200<=d.status&&500>
d.status&&(clearTimeout(k),a.measure("to","testobj-start"))};d.send(null)}}return b},a.findStartGToolbar=function(){var c=void 0;"undefined"!==typeof b.external&&"undefined"!==typeof b.external.pageT?c=(new Date).getTime()-b.external.pageT:"undefined"!==typeof b.gtbExternal&&"undefined"!==typeof b.gtbExternal.pageT?c=(new Date).getTime()-window.gtbExternal.pageT():"undefined"!==typeof b.chrome&&"undefined"!==typeof b.chrome.csi&&(c=(new Date).getTime()-b.chrome.csi().pageT);c&&(a.prof.src="gtb");
return c},a.findStartCookie=function(){for(var b=m.cookie.split(" "),e=0;e<b.length;e++)if(0===b[e].indexOf("AKSB=")){for(var d=b[e].substring(5).split("&"),k,f,h=0;h<d.length;h++)0===d[h].indexOf("s=")?k=d[h].substring(2):0===d[h].indexOf("r=")&&(f=d[h].substring(2),f=escape(m.referrer)===f);if(f&&k)return a.prof.src="ck",k}},a.setCookie=function(a,b,d){if(!a||!b)return 0;d?(d=new Date((new Date).getTime()+6E4*(new Date).getTimezoneOffset()+864E5),d=";expires="+(new Date(d.getUTCFullYear(),d.getUTCMonth(),
d.getUTCDate())).toUTCString().replace(/ [0-9]+\:/," 00:")):d="";m.cookie=a+"="+b+d+";path=/;"},a.beforeUnload=function(b){a.setCookie("AKSB","s="+Number(new Date)+"&r="+escape(m.location))},a.onready=function(b){a.mark("onready",(new Date).getTime());a.measure("t_onready","starttime","onready")},a.onload=function(b){a.mark("onload",(new Date).getTime());a.autorun&&a.done()},a.addEventListener=function(a,e,d){if("undefined"!==typeof b.attachEvent)return b.attachEvent("on"+a,e);if(b.addEventListener)return b.addEventListener(a,
e,d)},a.newXHR=function(){a.axStr="unk";if("undefined"!==typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!==typeof ActiveXObject)if("unk"===a.axStr){for(var b=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"],e=0,d=b.length;e<d;e++)try{var k=new ActiveXObject(b[e]);a.axStr=b[e];return k}catch(f){}a.axStr="none"}else if("none"!==a.axStr)return new ActiveXObject(a.axStr);return null},a.getNavTimingAPI=function(){return b.performance||
b.mozPerformance||b.msPerformance||b.webkitPerformance},a.init())})(window);
(function(b){function m(){this.data={};this.value=[]}b.parent!==b&&void 0==b.RT&&(b=b.parent);var a=b.document;"undefined"===typeof b.RT&&(b.RT={});var c=b.RT;c.version||(c.version="0.2",c.init=function(){"complete"===a.readyState?window.setTimeout(c.getW3CTimings,1):c.addEventListener("load",c.getW3CTimings,!1)},c.getW3CTimings=function(){var e=new m,d=c.getResourceTimingAPI(),k={},f=0;if("all"in b.document)for(var h=b.document.all,l=0;l<h.length;l++){var n=h[l];if("LINK"===n.tagName&&"href"in n){if("http"===
n.href.substr(0,4).toLowerCase()&&(k[n.href]=1,1E3<f++))break}else if("src"in n&&"http"===n.src.substr(0,4).toLowerCase()&&(k[n.src]=1,1E3<f++))break}if(d)for(l in d)"undefined"!==typeof d[l].duration&&(delete k[d[l].name],e.insert(d[l].name,[Math.round(d[l].redirectStart),Math.round(d[l].redirectEnd),Math.round(d[l].fetchStart),Math.round(d[l].domainLookupStart),Math.round(d[l].domainLookupEnd),Math.round(d[l].connectStart),Math.round(d[l].connectEnd),Math.round(d[l].secureConnectionStart),Math.round(d[l].requestStart),
Math.round(d[l].responseStart),Math.round(d[l].responseEnd),Math.round(d[l].duration),d[l].initiatorType,d[l].nextHopProtocol,d[l].transferSize,d[l].encodedBodySize,d[l].decodedBodySize]));for(res in k)e.insert(res,[]);c.radtree=e;c.baseurl=escape(a.location.protocol.toLowerCase()+"//"+a.location.hostname.toLowerCase()+a.location.pathname);var p=function(a){var d=new XMLHttpRequest;d.open("POST",("https:"===b.document.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/RRT",!0);d.send(JSON.stringify([a,
c.radtree.data,b.AKSB.prof.requestid,b.AKSB.prof.ghostip,b.AKSB.bf.get(),b.AKSB.prof.custid,b.AKSB.prof.ustr,b.AKSB.prof.originlat,b.AKSB.prof.clientrtt,b.AKSB.prof.ua,b.AKSB.prof.plat,b.AKSB.prof.connType,b.AKSB.prof.connBandwidth]))};if(b.performance&&b.performance.timing){var g=b.performance.timing,q=function(){if(0<g.loadEventEnd){var a=[g.domainLookupEnd-g.domainLookupStart,g.connectStart-g.domainLookupStart,g.connectEnd-g.domainLookupStart,g.secureConnectionStart?g.secureConnectionStart-g.domainLookupStart:
null,g.requestStart-g.domainLookupStart,g.responseStart-g.domainLookupStart,g.responseEnd-g.domainLookupStart,g.domLoading-g.domainLookupStart,g.domInteractive-g.domainLookupStart,g.msFirstPaint?g.msFirstPaint-g.navigationStart:"undefined"!==typeof b.chrome&&b.chrome.hasOwnProperty("loadTimes")?Math.round(1E3*b.chrome.loadTimes().firstPaintTime)-g.domainLookupStart:null,g.domContentLoadedEventStart-g.domainLookupStart,g.domContentLoadedEventEnd-g.domainLookupStart,g.domComplete-g.domainLookupStart,
g.loadEventStart-g.domainLookupStart,g.loadEventEnd-g.domainLookupStart],d={};d[c.baseurl]=a;p(d)}else 0>=g.loadEventEnd&&setTimeout(q,100)};q()}else{var r=function(){if("AKSB"in b&&"measures"in b.AKSB&&"t_plt"in b.AKSB.measures){var a={};a[c.baseurl]=[null,null,null,0,null,null,null,null,null,null,null,null,null,b.AKSB.measures.t_onload,b.AKSB.measures.t_plt];p(a)}else setTimeout(r,100)};r()}},c.addEventListener=function(a,d,c){if("undefined"!==typeof b.attachEvent)return b.attachEvent("on"+a,d);
if(b.addEventListener)return b.addEventListener(a,d,c)},c.getResourceTimingAPI=function(){if("performance"in b){if("getEntriesByType"in b.performance)return b.performance.getEntriesByType("resource");if("webkitGetEntriesByType"in b.performance)return b.performance.webkitGetEntriesByType("resource")}return null},m.prototype.insert=function(a,b){for(var c=this.data;a;){var f=this.get_prefix(a,Object.keys(c)),h=f[0],f=f[1];if(!h||"string"!==typeof h||"string"!==typeof f)break;var l=h.length;if(h!==f){var m=
f.slice(l,f.length),p=c[f];p===this.value&&(p=JSON.parse(JSON.stringify(p)));c[h]={};c[h][m]=p;delete c[f]}else c[h]===this.value&&(c[h]=JSON.parse(JSON.stringify(this.value)));a=a.slice(l,a.length);c=c[h]}c[a]=a?b:null;return!0},m.prototype.get_prefix=function(a,b){function c(a,b){if(""===b)return!0;if(null==a||null==b)return!1;a=String(a);b=String(b);return a.length>=b.length&&a.slice(0,b.length)===b}b.sort(function(a,b){return a.length<b.length?-1:a.length>b.length?1:0}).reverse;if("undefined"!==
typeof a){wc=a[0];for(var f in b)if(c(b[f],wc))for(var h=a.length;1<=h;h--)if(c(b[f],a.slice(0,h)))return[a.slice(0,h),b[f]]}return["",null]},!("https:"!==a.location.protocol&&0<=b.document.location.search.search("akamai-rum-rt=on"))&&10<=100*Math.random()||c.init())})(window);
