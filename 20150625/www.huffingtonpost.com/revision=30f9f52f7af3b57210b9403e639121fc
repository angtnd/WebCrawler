!function(){"use strict";function t(e){t.timer?t.callbacks.push(e):(t.callbacks=[],t.timer=setTimeout(function(){t.timer=void 0;var e=t.callbacks;o.console.log("setImmediate(): #"+e.length);for(var i=0;i<e.length;i++)e[i]()},0))}function e(t,e){this.pmData=t,this.options=e||{};var a=t.saleMode,n=setInterval(function(){h=piximedia.pmData5418_1&&piximedia.pmData5418_1.adIdAlliance===parseFloat(t.adIdAlliance,10)?!0:!1,i=h?piximedia.pmData5418_1:{},l++,(h||100===l)&&clearInterval(n)},50),l=0;t.minEngagementTime=t.minEngagementTime?parseInt(t.minEngagementTime,10):0,t.minExposureTime=t.minExposureTime?parseInt(t.minExposureTime,10):0,"cpc"===a&&t.minEngagementTime>0?a="cpc":"cpm"===a&&t.minExposureTime>0&&(a="cpmview"),this.salemode=a,o.piximedia.PAM.EventEmitter.forObject(this)}var i,o=window,a=100,n=1500,l=100,r=1500,p=4e3,s=250,d=.5,c=100,m=250,u=250,h=!1;e.prototype.start=function(){var t=this.pmData,e=t.framedAd,n=e.pam,l=this;if(this.framedPam=n,window.piximedia["pmData"+t.creativeIdAlliance+"_1"]=t,t.tracking&&t.tracking.clickUrl)for(var r=0;r<t.tracking.clickUrl.length;r++)t.clickUrl[r].url=t.tracking.clickUrl[r];if(t.tracking&&t.tracking.pixelUrl)for(var p=0;p<t.tracking.pixelUrl.length;p++)t.pixelUrl[p]=t.tracking.pixelUrl[p];"string"==typeof t.clickUrl[0].url&&t.clickUrl.unshift(""),l.pmData.allpapr_custom&&(l.pmData.allpapr_custom.clickindex=l.pmData.allpapr_custom.clickindex&&t.clickUrl[l.pmData.allpapr_custom.clickindex]&&t.clickUrl[l.pmData.allpapr_custom.clickindex].url?l.pmData.allpapr_custom.clickindex:1),n.loadLibrary("sweetlib.js",function(){var r,p,s=!1,d=!0,c=o.piximedia.SweetLib,m=c.log,u=t.openmode;e.inject(((e||{}).args||{}).primary_position||l.pmData.position||"wallpaper",{},function h(y,f,g,v){function b(){return t.pub_cc+t.clickUrl[l.pmData.allpapr_custom.clickindex].tracking+t.clickUrl[l.pmData.allpapr_custom.clickindex].url}function _(){var e=t.clickUrl[l.pmData.allpapr_custom.clickindex]?l.pmData.allpapr_custom.clickindex:1;return t.clickUrl[e].custom&&c.track(t,"CLICK_OOB",l.pmData.allpapr_custom.position,t.clickUrl[e].custom),o.open(t.pub_cc+t.clickUrl[e].tracking+t.clickUrl[e].url,"_blank"),!0}function x(e,i,o,a){if(m("setStage call %s, %s %s",i,o,a),"tracking"===i)c.track(l.pmData,o,a&&"!!"!==a?a:"");else switch(i){case"show":x(!1,"tracking","AP_EXPAND",a),n.createAnimation("#pmFiller",{duration:1e3,height:l.pmData.allpapr_custom.arch_height_expand*it}).play(),K.style.display="block";var r=function(){if(P.play(),U&&U.play(),u&&t.openmode_timer){u=!1,et.style.display="block",et.style.marginLeft="-"+c.gbcr(et).width/2+"px";var e=l.pmData.openmode_timer.openmode_value;p=setInterval(function(){return e--,y.getElementById("auto_open_button_text").innerHTML=l.pmData.openmode_timer.openmode_timer_text+e,0>e?(p&&clearInterval(p),et.style.display="none",void x(!1,"hide")):void 0},1e3),c.addEvent(et,"click",function(){p&&clearInterval(p),et.style.display="none"})}};l.pmData.allpapr_video.no_display_animation?(X.style.opacity=1,tt.style.display="block",q.style.opacity=1,J.style.width=l.pmData.allpapr_video.video_front_width*it+"px",r()):c.animate(X,{duration:1e3,opacity:1,onplayed:function(){tt.style.display="block",c.animate(q,{duration:1e3,opacity:1}).play(),c.animate(J,{width:l.pmData.allpapr_video.video_front_width*it,duration:1e3,onplayed:r}).play()}}).play();break;case"close":case"hide":"close"===i?x(!1,"tracking","AP_CLOSE",a):x(!1,"tracking","AP_COLLAPSE",a),P.pause(),u=!1,p&&clearInterval(p),et.style.display="none",n.createAnimation("#pmFiller",{height:l.pmData.allpapr_custom.arch_height*it}).play(),c.animate(K,{opacity:0,onplayed:function(){K.style.display="none",K.style.opacity="1",K.style.filter="alpha(opacity=100)",X.style.opacity="0",X.style.filter="alpha(opacity=0)",q.style.opacity="0",q.style.filter="alpha(opacity=0)",J.style.width="0px",P.play(0),P.pause(),U&&(U.play(0),U.pause()),et.style.display="none"}}).play()}}f.piximedia=o.piximedia;var k={};if(t.object=k,t.pub_cc=g.clickUrl&&g.clickUrl.match(/\/\/|http/)?g.clickUrl:"",o.pmGetUrl=b,o.click=_,o.setStage=x,d&&0===g.injectionIndex)for(var w=t.pixelUrl||[],I=0;I<w.length;I++)c.PixelPrinter(w[I]);var A=!1;v.emit("register-visibility-callback",{callback:"visibility-changed",threshold:70}),v.on("visibility-changed",function(t){A=t});var D={5:!0,10:!0,20:!0,30:!0,40:!0},S=0;if(setInterval(function(){A&&S++,D[S]&&(D[S]=!1,c.track(t,"AP_VIEWABLE_GLOBAL:"+S+"S"))},1e3),"cpmview"===l.salemode){e.on("ad-unit-visible",function(){A||E++});var T=setInterval(function(){A&&E++,E>=t.minExposureTime&&!C&&(C=!0,clearInterval(T),c.track(t,"CLICK","cpmview"))},1e3),E=0,C=!1}l.iframe=v,l.injectedDocument=y,l.injectedWindow=f;var L=n.globalOptions.location,B=l.options.wallpaper,N=l.options.video;B||(B=L.match(/movetop4.html/)?{top:{asset:"http://resources.pm/sandbox/inline/frozentop.jpg",width:1795,height:195,mode:"stretch"},left:{asset:"http://resources.pm/sandbox/inline/any.jpg",width:170,height:679},right:{asset:"http://resources.pm/sandbox/inline/any.jpg",width:170,height:679}}:L.match(/movetop3.html/)?{top:{asset:"http://resources.pm/sandbox/inline/frozentop.jpg",width:1795,height:195,mode:"center"},left:{asset:"http://resources.pm/sandbox/inline/any.jpg",width:170,height:679},right:{asset:"http://resources.pm/sandbox/inline/any.jpg",width:170,height:679}}:L.match(/movetop2.html/)?{left:{asset:"http://resources.pm/sandbox/inline/left.jpg",width:500,height:1080},right:{asset:"http://resources.pm/sandbox/inline/right.jpg",width:500,height:1080}}:L.match(/movetop.html/)?{asset:"http://resources.pm/sandbox/inline/parkentrance.jpg",top:550,contentWidth:1300,width:2e3,height:1190}:{asset:"http://resources.pm/sandbox/inline/wallpaper_ysl.jpg",top:350,contentWidth:1050,width:1518,height:1500,room:{top:214,left:449.588,width:698.824,height:396,onactivated:function(t){n.loadLibrary("video.js",function(){var e=o.piximedia.Video;l.video=new e(t,{files:"http://piximedia.com/video/ALLIANCE_HD.mp4",width:t.style.width,height:t.style.height,options:{}}),l.video.play()})}}});var j=g.pageContainerWidth,z=c.getPageContainerHints()||{};y.write("<div id='background_container' style='cursor: pointer'><img style='-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;' src='data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=' id='background' ondragstart='return false' style='pointer-events: none; width: 0; height: 0'><div id='top'></div><div id='left'></div><div id='middle'></div><div id='right'></div></div><div id='background_mask'></div><div id='video_container'></div>"),y.write("<div id='replay_button'></div><div id='container_wallpaper_video'><div id='video_background'><div id='opacity_background'></div><div id='player_background'></div></div><div id='image_top'></div><div id='video_front'><div id='auto_open_button'></div><div id='player_front'></div></div><div id='close_button'></div></div>");var U,P,R=y.getElementById("background"),W=y.getElementById("background_container"),M=y.getElementById("background_mask"),F=y.getElementById("video_container"),H=y.getElementById("top"),V=y.getElementById("left"),O=y.getElementById("middle"),Z=y.getElementById("right"),G=y.getElementById("replay_button"),K=y.getElementById("container_wallpaper_video"),X=y.getElementById("video_background"),Q=y.getElementById("opacity_background"),Y=y.getElementById("player_background"),q=y.getElementById("image_top"),J=y.getElementById("video_front"),$=y.getElementById("player_front"),tt=y.getElementById("close_button"),et=y.getElementById("auto_open_button"),it=j/(l.pmData.allpapr_custom||l.pmData.allpapr).pc_width;if(B.left&&B.right){var ot=0,at=0;if(V.style.display=O.style.display=Z.style.display="inline-block",V.style.width=B.left.width+"px",V.style.height=B.left.height+"px",Z.style.width=B.right.width+"px",Z.style.height=B.right.height+"px",O.style.width=j+"px",O.style.height="1px",V.style.backgroundImage="url("+B.left.asset+")",V.style.backgroundRepeat="no-repeat",Z.style.backgroundImage="url("+B.right.asset+")",Z.style.backgroundRepeat="no-repeat",B.top){var nt,lt=B.left.width+j+B.right.width;switch(B.top.mode){case"stretch":nt=lt/B.top.width;break;default:case"center":nt=lt<B.top.width?lt/B.top.width:1}ot=nt*B.top.width,at=nt*B.top.height,H.style.width=ot+"px",H.style.height=at+"px",H.style.margin="0 auto",H.style.backgroundImage="url("+B.top.asset+")",H.style.backgroundRepeat="no-repeat",H.style.backgroundPosition="0% 50%"}W.style.position="absolute",W.style.width=B.left.width+j+B.right.width+"px",W.style.height=at+Math.max(B.left.height,B.right.height)+"px",v.emit("resize",{wallpaper:!0,moveTop:at,width:B.left.width+j+B.right.width,height:Math.max(B.left.height,B.right.height),stickToTop:l.pmData.stickToTop,moveTopOptions:{duration:void 0!==l.pmData.fadeInDuration?l.pmData.fadeInDuration:a},bodyBackgroundColor:l.pmData.enableBodyBackgroundColor?l.pmData.enableBodyBackgroundColor.bodyBackgroundColor:void 0})}else if(B.asset){var rt=B.inset||z.inset||{},pt=rt.thickness?parseFloat(rt.thickness,10):0,st=rt.color||"#555",dt=j+2*pt,ct=dt/B.contentWidth,mt=Math.round(ct*B.top)+pt,ut=Math.round(ct*B.width),ht=Math.round(ct*B.height);d&&(W.style.opacity=0);var yt=void 0!==l.pmData.fadeInDuration?l.pmData.fadeInDuration:a;W.style.position="absolute",W.style.width="100%",W.style.height="100%",W.style.transition="opacity "+yt/1e3+"s ease-in",W.style.WebkitTransition="opacity "+yt/1e3+"s ease-in","swf"===c.getExtention(B.asset)&&!c.hasFlash()&&B.backup&&(B.asset=B.backup);var ft,gt;if(l.callbackLoad)ft=function(){var t={document:y,window:f,wallpaper:B,background:R,backgroundMask:M,ratio:ct,realWidth:ut,realHeight:ht,pcWidth:dt};l.callbackLoad(t,function(){ct=t.ratio,ut=t.realWidth,ht=t.realHeight,gt()})};else if("swf"!==c.getExtention(B.asset))R.src=B.asset,ft=function(){R.onload=gt};else{var vt=y.createElement("div");R.parentNode.insertBefore(vt,R),vt.style.width="100%",vt.style.height="100%",R.parentNode.removeChild(R),B.flashvars||(B.flashvars={}),B.attributes||(B.attributes={}),B.params||(B.params={}),B.attributes.scale=B.params.scale="exactfit",B.params.wmode=B.params.wmode="transparent",B.flashvars.clickTag||(B.flashvars.clickTag=g.clickUrl+(l.pmData&&l.pmData.clickUrl[1]?l.pmData.clickUrl[1].tracking+l.pmData.clickUrl[1].url:"")),c.handleAsset({file:B.asset,width:"100%",height:"100%",flashvars:B.flashvars,params:B.params,attributes:B.attributes},vt,"allpapr"),ft=function(){gt()},l.onclick=function(){},f.setStage=function(e,i,o){"tracking"===e&&c.track(t,i,"1x1",o?o.replace(/^!!/,""):"")}}gt=function(){if(R.style.width=ut+"px",R.style.height=ht+"px",M.style.position="absolute",M.style.left="50%",M.style.marginLeft=-dt/2+"px",M.style.top=mt-pt+"px",M.style.width=dt+"px",M.style.height=ht-mt+pt+"px",M.style.background=l.pmData.backgroundMaskColor||"white",pt&&(M.style.boxSizing="border-box",M.style.borderTop=pt+"px solid "+st,M.style.borderLeft=pt+"px solid "+st,M.style.borderRight=pt+"px solid "+st),F.style.position="absolute",N&&N.file&&N.file.length){F.style.left=parseFloat(N.left,10)*ct+"px",F.style.top=parseFloat(N.top,10)*ct+"px",F.style.width=parseFloat(N.width,10)*ct+"px",F.style.height=parseFloat(N.height,10)*ct+"px";var t=F.ownerDocument.createElement("div");F.appendChild(t),n.loadLibrary("video.js",function(){n.loadLibrary("sweetlib.js",function(){var t=o.piximedia.SweetLib,e={onclick:function(){W.onclick()},track:function(t,e){o.piximedia.SweetLib.track(l.pmData,t,e)}};t.extend(e,N),l.video=new o.piximedia.Video(F,{files:N.file,width:F.style.width,height:F.style.height,options:e}),l.video.play()})})}else F.style.left=0,F.style.top=0,F.style.width=0,F.style.height=0;if(l.pmData.allpapr_video){M.style.top=(l.pmData.allpapr_custom.arch_height>l.pmData.allpapr_custom.arch_height_expand?l.pmData.allpapr_custom.arch_height:l.pmData.allpapr_custom.arch_height_expand)+"px";var e,i=l.pmData.allpapr_custom,a=l.pmData.allpapr_video,p=l.pmData;e=a.use_video_background?{files:a.use_video_background.video_background.video_background_file,backup:a.use_video_background.video_background.video_background_backup,width:a.use_video_background.video_background.video_background_width,height:a.use_video_background.video_background.video_background_height}:{files:a.video_front_file,backup:a.video_front_backup,width:i.width,height:i.width*a.video_front_height/a.video_front_width},c.applyStyle(G,{position:"absolute",width:i.replay_button_width,height:i.replay_button_height,top:parseInt(i.replay_button_pos_y,10)*it+"px",right:parseInt(i.replay_button_pos_x,10)*it+"px",padding:"0px",zIndex:"1",cursor:"pointer"}),c.addEvent(G,"click",function(){x(!1,"show")});var m=y.createElement("div");m.id="replay_button_background",c.applyStyle(m,{background:i.replay_button_background,opacity:i.replay_button_opacity/100,filter:"alpha(opacity="+i.replay_button_opacity+")",position:"absolute",width:"100%",height:"100%",top:"0px",left:"0px"}),G.appendChild(m);var u=y.createElement("div");if(u.id="replay_button_text",c.applyStyle(u,{position:"relative",textAlign:"center",color:i.replay_button_color,fontFamily:i.replay_button_font,fontSize:i.replay_button_fontsize,margin:"0px",padding:"0px"}),u.innerHTML=i.replay_button,G.appendChild(u),u.style.top=(i.replay_button_height-c.gbcr(u).height)/2+"px",c.applyStyle(K,{position:"absolute",width:parseInt(e.width,10)*it+"px",height:parseInt(e.height,10)*it+"px",top:"0px",left:"0px",zIndex:"2"}),c.applyStyle(X,{position:"absolute",width:parseInt(e.width,10)*it+"px",height:parseInt(e.height,10)*it+"px",top:"0px",left:"0px",zIndex:"2",opacity:"0",filter:"alpha(opacity=0)",cursor:"pointer"}),c.applyStyle(Q,{position:"absolute",background:"black",display:"block",width:"100%",height:"100%",top:"0px",left:"0px",opacity:"0.5",filter:"alpha(opacity=50)",zIndex:1,cursor:"pointer"}),a.use_video_background?c.addEvent(Q,"click",function(){c.track(p,"AP_CLICK",i.position),_(),x(!1,"hide")}):(Q.style.display="none",c.addEvent(X,"click",function(){c.track(p,"AP_CLICK",i.position),_(),x(!1,"hide")})),c.applyStyle(Y,{position:"relative",width:parseInt(e.width,10)*it+"px",height:parseInt(e.height,10)*it+"px",top:"0px",left:"0px"}),a.image_top){c.applyStyle(q,{position:"absolute",width:parseInt(a.image_top.image_top_width,10)*it+"px",height:parseInt(a.image_top.image_top_height,10)*it+"px",top:parseInt(a.image_top.image_top_position_from_top,10)*it+"px",left:"50%",marginLeft:"-"+parseInt(a.image_top.image_top_width,10)*it/2+"px",zIndex:"3",opacity:"0",filter:"alpha(opacity=0)"}),c.addEvent(q,"click",function(){c.track(p,"AP_CLICK",i.position),_(),x(!1,"hide")});var b=y.createElement("img");b.id="my_image_top",b.src=a.image_top.image_top_file,b.style.position="relative",b.style.width="100%",b.style.height="100%",b.style.cursor="pointer",q.appendChild(b)}c.applyStyle(J,{position:"relative",width:"0px",height:parseInt(a.video_front_height,10)*it+"px",top:parseInt(a.position_from_top,10)*it+"px",zIndex:"3",overflow:"hidden",margin:"0 auto",mozBoxShadow:"0px 0px 30px #000000",webkitBoxShadow:"0px 0px 30px #000000",boxShadow:"0px 0px 30px #000000"}),c.applyStyle($,{position:"relative",width:parseInt(a.video_front_width,10)*it+"px",height:parseInt(a.video_front_height,10)*it+"px",top:"0px",left:"50%",marginLeft:"-"+parseInt(a.video_front_width,10)*it/2+"px"}),c.applyStyle(et,{position:"absolute",top:"20px",left:"50%",padding:"3px 0px",zIndex:"5",cursor:"pointer",display:"none"});var k=y.createElement("div");k.id="auto_open_button_background",c.applyStyle(k,{background:l.pmData.openmode_timer.openmode_background,opacity:l.pmData.openmode_timer.openmode_opacity/100,filter:"alpha(opacity="+l.pmData.openmode_timer.openmode_opacity+")",position:"absolute",width:"100%",height:"100%",top:"0px",left:"0px"}),et.appendChild(k);var w=y.createElement("div");w.id="auto_open_button_text",c.applyStyle(w,{position:"relative",textAlign:"center",color:l.pmData.openmode_timer.openmode_color,fontFamily:l.pmData.openmode_timer.openmode_font,fontSize:l.pmData.openmode_timer.openmode_fontsize,margin:"0px",padding:"0px 10px"}),w.innerHTML=l.pmData.openmode_timer.openmode_timer_text+l.pmData.openmode_timer.openmode_value,et.appendChild(w),n.loadLibrary("video.js",function(){a.use_video_background&&(U=new o.piximedia.Video(Y,{files:e.files,poster:e.backup,id:a.video_background_id,baseUrl:"",width:100,height:100,unit:"%",options:{soundbutton:!1,threshold:0,nofullscreen:!0,controls:!1,hidecontrols:!0,rollover:!1,autoplay:!1,loop:!1,onclick:function(){c.track(p,"AP_CLICK",i.position),_(),x(!1,"hide")},track:function(t,e){c.track(p,t,e)}}})),P=new o.piximedia.Video($,{files:a.video_front_file,poster:a.video_front_backup,id:a.video_front_id,baseUrl:"",width:100,height:100,unit:"%",options:{threshold:0,nofullscreen:!0,controls:a.video_front_controls===!0||a.video_front_controls&&"full"===a.video_front_controls.type,soundbutton:a.video_front_controls&&a.video_front_controls.type&&"sound"===a.video_front_controls.type,hidecontrols:!0,rollover:a.video_front_sound_mode,autoplay:!1,loop:!1,onclick:function(){c.track(p,"AP_CLICK",i.position),_(),x(!1,"hide")},track:function(t,e){c.track(p,t,e)},onend:function(){x(!1,"hide")}}}),l.pmData.openmode&&setTimeout(function(){x(!1,"show")},50)}),c.applyStyle(tt,{position:"absolute",width:a.close_button_width,height:a.close_button_height,top:parseInt(a.close_button_pos_y,10)*it+"px",right:parseInt(a.close_button_pos_x,10)*it+"px",padding:"0px",zIndex:"4",cursor:"pointer"}),c.addEvent(tt,"click",function(){x(!1,"close")});var I=y.createElement("div");I.id="close_button_background",c.applyStyle(I,{background:a.close_button_background,opacity:a.close_button_opacity/100,filter:"alpha(opacity="+a.close_button_opacity+")",position:"absolute",width:"100%",height:"100%",top:"0px",left:"0px"}),tt.appendChild(I);var A=y.createElement("div");A.id="close_button_text",c.applyStyle(A,{position:"relative",textAlign:"center",color:a.close_button_color,fontFamily:a.close_button_font,fontSize:a.close_button_fontsize,margin:"0px",padding:"0px"}),A.innerHTML=a.close_button,tt.appendChild(A),A.style.top=(a.close_button_height-c.gbcr(A).height)/2+"px",K.style.display="none"}v.emit("resize",{wallpaper:!0,moveTop:mt,width:ut,height:ht,stickToTop:l.pmData.stickToTop,moveTopOptions:{duration:yt},bodyBackgroundColor:l.pmData.enableBodyBackgroundColor?l.pmData.enableBodyBackgroundColor.bodyBackgroundColor:void 0}),d&&(W.style.opacity=1),setTimeout(function(){s||(s=!0,v.registerResponsiveCallback(function(){return y.close(),y.open(),d=!1,h(y,f,g,v)})),r?r.update({iframe:v,wallpaper:B,realWidth:ut,realHeight:ht,realTop:mt,pcWidth:dt,position:g}):r=l.createRichMedia({iframe:v,wallpaper:B,realWidth:ut,realHeight:ht,realTop:mt,pcWidth:dt,position:g})},yt),l.emit("complete",{document:y,window:f,wallpaper:B,background:R,backgroundMask:M,ratio:ct,realWidth:ut,realHeight:ht,pcWidth:dt})},d?ft():gt()}W.onclick=function(){if(l.onclick)return l.onclick();if(i&&i.expand&&"click"!==i.openmode)n.emit("open-footer",{id_ad:t.adIdAlliance,index:1,newtab:!1});else{var e=l.pmData.allpapr?l.pmData.allpapr.clickAction:void 0;if(e)return l.framedPam.emit(e,{id_ad:l.pmData.adIdAlliance});var o=g.clickUrl+(g.advertiserClickUrl||(l.pmData&&l.pmData.clickUrl[1]?l.pmData.clickUrl[1].tracking+l.pmData.clickUrl[1].url:""));c.track(t,"AP_VISIT_NEW_TAB"),f.open(o,"_blank")}}})})},e.prototype.animate=function(t){if(o.piximedia.PAM.isArray(t))for(var e=0;e<t.length;e++)this.animate(t[e]);else{var i=this,a=function(){i.framedPam.loadLibrary("sweetlib.js",function(){o.piximedia.SweetLib.coolDown(function(){return i[t].apply(i,arguments)})})};if(this[t]&&this.iframe&&this.iframe.iframe)return a();var n=setInterval(function(){return i[t]&&i.iframe&&i.iframe.iframe?(clearInterval(n),a()):void 0},50)}},e.prototype.flow=function(){this.animate("flow")},e.prototype.arch=function(){this.animate("arch")},e.prototype.glow=function(){this.animate("glow")},e.prototype.flip=function(){this.animate("flip")},e.prototype.zip=function(){this.animate("zip")},e.prototype.createRichMedia=function(e){var i=this,a=this.framedPam,h=e.iframe,y=e.wallpaper,f=e.realWidth,g=e.realHeight,v=e.realTop,b=e.pcWidth,_=e.position,x=new o.piximedia.PAM.EventEmitter;return a.loadLibrary("sweetlib.js",function(){a.waitDomMutable(function(){var e=o.piximedia.SweetLib;a.log("PC Width = "+b);var k=function(){if(i.onclick)return i.onclick();var t=_.clickUrl+(i.pmData&&i.pmData.clickUrl[1]?i.pmData.clickUrl[1].url:"");window.open(t,"_blank")},w=i.flow=function(i,n){var l=top.document;n=n||{};var r,p,s=n.transitionDuration||"0.2s",d=n.type||"rotateX",c=n.zIndex||e.LAYER_HIGHEST,m=n.position||"fixed",u=l.createElement("div"),v=l.createElement("div"),b=l.createElement("img");u.className="pmFlowContainer pmNozip",v.className="pmFlow",b.className="pmFlow",a.clearCSS(v),a.clearCSS(u),a.clearCSS(b),u.style.position=m,u.style.width=f+"px",u.style.cursor=n.cursor,u.style.height=g+"px",u.style.display="block",u.style.zIndex=c,u.onclick=k,v.style.cursor="pointer",v.style.width="100%",v.style.height="100%",v.style.position="relative",v.style.overflow="hidden",b.src=y.asset,b.style.position="relative",b.style.width=f+"px",b.style.height=g+"px",b.style.cursor=n.cursor;var _=function(){var t=e.gbcr(h.iframe);if(i){var o=e.gbcr(i);u.style.left=o.left+"px",u.style.top=o.top+"px",u.style.width=o.width+"px",u.style.height=o.height+"px",b.style.left=-(o.left-t.left)+"px",b.style.top=-(o.top-t.top)+"px"}else u.style.left=t.left+"px",u.style.top=t.top+"px"};_(),u.appendChild(v),v.appendChild(b),l.body.appendChild(u);var x;switch(d){case"rotateX":u.style.perspective=10*g+"px",v.style.transform="rotateZ(0) rotateX(270deg)",t(function(){o.console.log("Rotating",i),v.style.transition="transform "+s,v.style.transform="rotateZ(0) rotateX(360deg)"});break;case"opacity":v.style.opacity=0,x=e.animate(v,{opacity:1,duration:1e3*parseFloat(s,10)}),x.play();break;case"immediate":}n.absolute&&setTimeout(function(){r.absolute(n.absolute)},s);var w;return n.noReajustAfter||(w=setInterval(function(){_()},50)),r={container:u,interval:w,readjust:function(){w&&_()},remove:function I(t){t=t||{};var i=t.duration;void 0!==i&&x&&(x.duration=i),x?x.reverse(function(){x=void 0,I()}):void 0!==i?(u.style.opacity=1,u.style.transition="opacity "+i/1e3+"s",u.style.opacity=0,setTimeout(function(){I()},i)):(clearInterval(w),u.parentNode.removeChild(u)),p&&(p.style.opacity=1,e.animate(p,{opacity:0,duration:i}).play())},activateRoom:function(){if(y.room){p=l.createElement("div"),p.className="pmAllpaprRoom";var t=parseFloat(b.style.width,10)/y.width;p.style.position="absolute",p.style.left="50%",p.style.marginLeft=y.room.left*t-parseFloat(b.style.left,10)-parseFloat(b.style.width,10)/2+"px",p.style.top=y.room.top*t-parseFloat(b.style.top,10)+"px",p.style.width=y.room.width*t+"px",p.style.height=y.room.height*t+"px",v.appendChild(p),e.call(y.room.onactivated,[p])}},absolute:function(t){e.call(t.onready),clearInterval(w),t=t||{};var i=t.duration||250,a=e.gbcr(u),n=e.gbcr(v),l=e.getViewportSize();v.style.height="",v.style.width=n.width+"px",u.style.overflow="scroll","mobile"===e.device.name?(u.style.position="absolute",u.style.top=e.getPageScroll()[1]+"px"):(u.style.position="fixed",u.style.top=0),u.style.left="50%",u.style.width="16000px",u.style.marginLeft="-8000px",u.style.height=l[1]+"px",v.style.margin=a.top+"px auto";var p;p=t.scrollToTop?"0px":a.top+"px",v.style.backgroundSize="100% 100%",o.console.log(v),o.console.log(u);var s=Math.min(1,t.zoomToWidth/a.width);v.style.marginLeft="auto",v.style.marginRight="auto",b.style.marginLeft="auto",b.style.marginRight="auto",b.style.marginTop=v.style.marginTop,v.style.marginTop=0,e.animate(b,{duration:i,marginTop:p,width:s*f+"px",height:s*g+"px",onplayed:function(){t.activateRoom&&r.activateRoom()}}).play()}}},I=function(t){t=t||{};var i=top.document,o=t.duration||r,n=t.opacity||d,l=[],p=void 0===t.showAlpha?!0:t.showAlpha,s=i.createElement("div"),c=i.createElement("top"),m=i.createElement("div"),u=i.createElement("div"),y=h.iframe.parentNode;return a.clearCSS(s),a.clearCSS(c),a.clearCSS(m),a.clearCSS(u),s.className="pmLeft",c.className="pmTop",m.className="pmRight",u.className="pmAlpha",s.style.position="absolute",c.style.position="absolute",m.style.position="absolute",u.style.position="fixed",s.style.cursor="pointer",m.style.cursor="pointer",c.style.cursor="pointer",s.onclick=m.onclick=c.onclick=k,t.onclickAlpha&&(u.onclick=t.onclickAlpha),s.style.top=v+"px",s.style.left="0px",s.style.width=(f-b)/2+"px",s.style.height=g-v+"px",c.style.top="0px",c.style.left="0px",c.style.width=f+"px",c.style.height=v+"px",m.style.top=v+"px",m.style.right="0px",m.style.left="",m.style.width=(f-b)/2+"px",m.style.height=g-v+"px",u.style.top="0px",t.doubleWidthAlpha?(u.style.left="-50%",u.style.width="200%",u.style.height="200%"):(u.style.left="0px",u.style.width="100%",u.style.height="100%"),u.style.zIndex=e.LAYER_ALPHA,u.style.background="black",u.style.opacity="0.2",u.style.cursor="pointer",y.appendChild(s),y.appendChild(c),y.appendChild(m),l.push(w(s,{cursor:"pointer",type:"immediate",noReajustAfter:t.noReajustAfter})),l.push(w(c,{cursor:"pointer",type:"immediate",noReajustAfter:t.noReajustAfter})),l.push(w(m,{cursor:"pointer",type:"immediate",noReajustAfter:t.noReajustAfter})),p&&(top.document.body.appendChild(u),u.style.opacity=0,u.style.transition="opacity "+o/1e3+"s",setTimeout(function(){u.style.opacity=n},0)),{left:s,top:c,right:m,alpha:u,flowedElements:l,remove:function(t){t=t||{};var e=function(){s.parentNode.removeChild(s),c.parentNode.removeChild(c),m.parentNode.removeChild(m),p&&u.parentNode.removeChild(u)};if(void 0!==t.duration){var i=t.duration;p&&(u.style.opacity=n,u.style.transition="opacity "+i/1e3+"s",u.style.opacity=0);for(var o=0;o<l.length;o++)l[o].remove(t);setTimeout(e,i)}else{for(var a=0;a<l.length;a++)l[a].remove();e()}},readjust:function(){for(var t=0;t<l.length;t++)l[t].readjust()}}},A=function(t,a){t=t||{},a=a||function(){};var n=e.gbcr(h.iframe);i.loadAllVisnodes(top.document,{minimumTop:n.top,minimumSurface:8e3},function(t){t.push({bounds:n,node:h.iframe,surface:n.width*n.height}),t.sort(function(t,e){return t.surface<e.surface?-1:t.surface>e.surface?1:0});var e={flowedElements:[]},i=1,l=1,p=r/(i+l-1),s=Math.ceil(t.length/i),d=0,c=[],m=function(t){for(var e=0;e<c.length;e++){var i=c[e].bounds,o=t.bounds,a=!0;if(i.bottom<o.top&&(a=!1),i.right<o.left&&(a=!1),i.top>o.bottom&&(a=!1),i.left>o.right&&(a=!1),a)return!0}return!1},u=function(){o.console.log("** RUNNING ROUND ** "+new Date);for(var n=s*d;s*(d+1)>n&&n<t.length;n++){var r=t[n],h={transitionDuration:l*p/1e3+"s"};m(r)?h.type="opacity":(h.type="rotateX",c.push(r)),e.flowedElements.push(w(r.node,h))}++d===i?setTimeout(function(){a(e)},l*p):setTimeout(u,p)};setTimeout(u,0)})};i.maskOver=function(){var t,o,a,n,l,r,p,s,y,f=i.framedPam,g=top.document,v=!1,b=function(){};switch(y=function(){f.log("Enter"),t||(t=I({duration:c,opacity:d,onclick:s}),r=setTimeout(function(){r=void 0,t.remove({duration:u}),t=void 0},c))},p=function(){return v?f.log("Prevented leave"):(f.log("Leave"),t&&(t.remove({duration:u}),t=void 0),o&&(o.remove({duration:u}),o=void 0),a&&(a.remove({duration:u}),a=void 0),n&&(n.remove({duration:u}),n=void 0),l&&(l.remove({duration:u}),l=void 0),void setTimeout(function(){g.body.className=g.body.className.replace(/ pmMaskOver pmBodyAnimation/g,"")},u))},s=function(){f.log("Full"),v=!0,o&&(o.remove(),o=void 0),e.animate(g.body,{scrollTop:e.gbcrfp(i.iframe.iframe).top,duration:200,css:!1,forcejs:!0,onplayed:function(){n=e.makeClose("mobile"===e.device.name?{position:"absolute",top:e.getPageScroll()[1]+"px"}:{},function(t){e.preventDefault(t),v=!1,p()}),r?(t.readjust(),clearTimeout(r)):t=I({duration:c,opacity:d,onclick:s}),g.body.className+=" pmMaskOver pmBodyAnimation",l=e.makeUnderlay({},function(t){e.preventDefault(t),v=!1,p()});var i=e.getViewportSize()[0];a=w(h.iframe,{type:"opacity",absolute:{onready:function(){t&&(t.remove(),t=void 0)},zoomToWidth:i,scrollToTop:!0,duration:m,activateRoom:!0}}),e.mouseenter(a.container,b),e.mouseleave(a.container,p)}}).play()},i.onclick=s,e.device.name){case"tablet":case"mobile":e.addEvent(h.iframe,"click",s);break;default:e.mouseenter(h.iframe,y),x.on("mouseenter",y)}},i.arch=function(){var t=I();setTimeout(function(){t.alpha.parentNode.removeChild(t.alpha)},p)},i.glow=function(){var t=top.document,i=e.getViewportSize()[0],o=i+"px",a="50% 0",n=i-f+"px";e.createCSS("body.pmGlow","-webkit-perspective-origin: "+a+"; perspective-origin: "+a+"; perspective: "+o+"; -webkit-perspective: "+o),e.createCSS("body.pmGlow > *","-webkit-transition: -webkit-transform "+c/1e3+"s; transition: transform "+c/1e3+"s; transform: translateZ(0px); -webkit-transform: translateZ(0px)");var l=I({duration:c,opacity:d,noReajustAfter:!0,doubleWidthAlpha:!0});setTimeout(function(){return l.alpha.style.opacity=0,e.getPageScroll()[1]?(l.remove(),void setTimeout(function(){t.body.className=t.body.className.replace(/ pmGlow pmBodyAnimation/g,"")},1.5*c)):(t.body.className+=" pmGlow pmBodyAnimation",void setTimeout(function(){l.alpha.style.opacity=d,e.createCSS("body.pmGlow > *","transform: translateZ("+n+"); -webkit-transform: translateZ("+n+")"),setTimeout(function(){l.alpha.style.opacity=0,e.createCSS("body.pmGlow > *","transform: translateZ(0px); -webkit-transform: translateZ(0px)"),setTimeout(function(){l.remove(),setTimeout(function(){t.body.className=t.body.className.replace(/ pmGlow pmBodyAnimation/g,"")},1.5*c)},c)},3*c)},750))},2*c)},i.flip=function(){var t=top.document;e.animate(t.body,{scrollTop:e.gbcrfp(this.iframe.iframe).top,duration:200,css:!1,forcejs:!0,onplayed:function(){var t,i,o,a,n,l=function(){if(a)for(var e=0;e<a.flowedElements.length;e++)a.flowedElements[e].remove({duration:0});o&&o.remove({duration:s}),i&&i.remove({duration:s}),n&&(n.remove({duration:s}),n=void 0),t&&t.remove({duration:s})};o=I({duration:r,opacity:d,onclickAlpha:l}),A({},function(o){a=o,t=e.makeUnderlay({},function(t){e.preventDefault(t),l()}),i=e.makeClose({},l);var r=e.getViewportSize()[0];n=w(h.iframe,{type:"opacity",absolute:{zoomToWidth:r,duration:m,activateRoom:!0}})})}}).play()},i.zip=function(){var t=300,i=250,o=t-20,n=i-20,r=top.document;e.animate(r.body,{scrollTop:0,duration:250,css:!1,forcejs:!0,onplayed:function(){var p,s,d,c=r.createElement("div"),m=r.createElement("div"),u=e.getViewportSize(),y=u[0],g=u[1],v=r.body.style.overflow;r.body.style.overflow="hidden",p=I({noReajustAfter:!0,showAlpha:!1}),p.remove({duration:1e3}),s=w(h.iframe,{type:"immediate",noReajustAfter:!0,zIndex:-1}),c.className="pmClosezip pmNozip",m.className="pmClosetag pmNozip",a.clearCSS(c),a.clearCSS(m),m.style.position=c.style.position="fixed",m.style.display=c.style.display="inline-block",m.style.top=c.style.top=g-i+"px",m.style.left=c.style.left="0px",c.style.background="url(//resources.pm/sandbox/inline/closezip.png)",m.style.width=c.style.width=t+"px",m.style.height=c.style.height="250px",m.style.zIndex=e.LAYER_HIGHEST,c.style.zIndex="",m.style.cursor="pointer",r.body.insertBefore(c,r.body.firstChild),r.body.insertBefore(m,r.body.firstChild);var b=setInterval(function(){var a=e.getPageScroll(),p=e.gbcr(r.body),s=a[1],u=e.getViewportSize()[1],h=o/f*p.height,g=s+u-n,v="perspective: "+l*(o/f)+"px; perspective-origin: "+t*t/y+"px "+g*p.height/(p.height-h)+"px";v!==d&&(d=v,e.createCSS("body.pmZip",d));var b=u-i+"px";m.style.top!==b&&(m.style.top=c.style.top=b)},50);e.createCSS("body.pmZip > *","transition: transform 1s; transform: translateZ(-"+l+"px)"),e.createCSS("body.pmZip > *.pmNozip","transform: translateZ(0)"),r.body.className+=" pmZip pmBodyAnimation","fixed"===h.iframe.style.position&&(h.iframe.style.position=""),m.onclick=function(){clearInterval(b),s.remove({duration:1e3}),e.createCSS("body.pmZip > *","transition: transform 1s; transform: translateZ(0px)"),setTimeout(function(){r.body.className=r.body.className.replace(/ pmZip pmBodyAnimation/g,""),
r.body.removeChild(c),r.body.removeChild(m),r.body.style.overflow=v},1e3)},setTimeout(function(){var t=e.getViewportSize()[0];s.absolute({scrollToTop:!0,zoomToWidth:t})},1e3)}}).play()},i.options.animate&&setTimeout(function(){i.animate(i.options.animate)},n),i.options.maskOver&&i.animate("maskOver"),e.mouseenter(i.injectedDocument.body,function(){x.emit("mouseenter")}),e.addEvent(i.injectedDocument.body,"mousemove",function(){x.emit("mousemove")})})}),{update:function(t){t.iframe&&(h=t.iframe),t.wallpaper&&(y=t.wallpaper),t.realWidth&&(f=t.realWidth),t.realHeight&&(g=t.realHeight),t.realTop&&(v=t.realTop),t.pcWidth&&(b=t.pcWidth),t.position&&(_=t.position),a.loadLibrary("sweetlib.js",function(){var t=o.piximedia.SweetLib;t.mouseenter(i.injectedDocument.body,function(){x.emit("mouseenter")}),t.addEvent(i.injectedDocument.body,"mousemove",function(){x.emit("mousemove")})})}}},e.prototype.loadAllVisnodes=function(t,e,i){this.framedPam.loadLibrary("sweetlib.js",function(){var a=o.piximedia.SweetLib,n=[];e=e||{};var l,r=void 0===e.minimumTop?0:e.minimumTop,p=a.getViewportSize()[1],s=e.minimumSurface||0;if(t.createTreeWalker)for(var d,c=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);d=c.nextNode();)l={node:d,bounds:a.gbcr(d)},l.bounds&&l.bounds.width&&l.bounds.height&&(l.surface=l.bounds.width*l.bounds.height,l.surface>=s&&!(d.className||"").match(/^pm/)&&!(d.className||"").match(/ pm/)&&l.bounds.top+l.bounds.height>=r&&l.bounds.top<=p&&a.isVisible(l.node)&&n.push(l));else{var m;if(t.querySelectorAll)m=t.querySelectorAll("*");else{var u=["DIV","SPAN","P","TABLE"];m=[];for(var h=0;h<u.length;h++)m=m.concat(t.getElementsByTagName(u[h]))}for(var y=0;y<m.length;y++){var f=m[y];l={node:f,bounds:a.gbcr(f)},l.bounds&&l.bounds.width&&l.bounds.height&&(l.surface=l.bounds.width*l.bounds.height,l.surface>=s&&!(f.className||"").match(/^pm/)&&!(f.className||"").match(/ pm/)&&l.bounds.top+l.bounds.height>=0&&l.bounds.top<=p&&a.isVisible(l.node)&&n.push(l))}}return i(n)})},o.piximedia.Allpapr=e,o.piximedia.libraryLoader&&o.piximedia.libraryLoader["allpapr.js"]&&(o.piximedia.libraryLoader["allpapr.js"].complete=!0)}(),function(){var t=window,e="allpapr.js";t.piximedia.libraryLoader=t.piximedia.libraryLoader||{};var i=t.piximedia.libraryLoader[e];i&&(i.complete=!0)}();