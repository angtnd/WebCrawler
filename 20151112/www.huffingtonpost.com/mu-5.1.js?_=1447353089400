/*! mu-5.1 11-08-2015 15:52:42 */
var eStatTag=function(a){"use strict";function b(){var a=null;if(J)a=new window.XDomainRequest;else for(var b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=0;c<b.length;c++)try{a=b[c]();break}catch(d){}return a}function c(a){var b=!1;if(!a)return!1;if(a.hasOwnProperty("serial")||(b=!0),(!a.hasOwnProperty("measure")||"page"!==a.measure&&"streaming"!==a.measure)&&(b=!0),"streaming"===a.measure){a.hasOwnProperty("streaming")||(b=!0);var c={};c.live=1,c.replay=1,c.timeshifting=1,a.streaming.hasOwnProperty("diffusion")&&c.hasOwnProperty(a.streaming.diffusion)||(b=!0),a.streaming.hasOwnProperty("streamName")||(b=!0),a.streaming.hasOwnProperty("playerName")||(b=!0),a.hasOwnProperty("criteria")&&(b=!0),a.hasOwnProperty("segments")&&(b=!0),"live"!==a.streaming.diffusion&&(a.streaming.hasOwnProperty("playerObj")||(b=!0),a.streaming.hasOwnProperty("callbackPosition")||(b=!0))}return b?!1:!0}function d(){var a="";return a=K.domain?K.domain:"frame"===K.implementation?e():document.domain,a?"&"+I.domain+"="+l(a):a}function e(){var a="",b=(window.location!==window.parent.location?document.referrer:document.location).replace(S,"").split("/");if(b[0].match(/:/g)){var c=b[0].split(":");a=c[0]}else a=b[0];return a}function f(){var a="",b=document.referrer;return"redirection"===K.implementation&&(b=g()),"frame"===K.implementation&&(b=e()),b&&(a="&r="+l(b)),a}function g(){for(var a="",b=document.cookie.split(";"),c=0;c<b.length;c++){var d=b[c].split("=");if("cks"===d[0]&&"-1"!==d[1])return a=b[c].substring(4),document.cookie="cks=-1;",a}return h()}function h(){var a="",b=document.URL;return b.match(/__cks_=/g)&&(a=b.match(/__cks_=([^&]+)/g)[0].split("=")[1]),a?a:(K.implementation="",f())}function i(){var a="",b=!0,c=["domain","measure"];if(a+=k("levels"),"streaming"===K.measure){c.push("page");for(var d=["cmsVI","cmsPS","cmsPO","cmsOP","cmsMV","cmsEV"],e=0;e<d.length;e++)a+="&"+d[e]+"="+K.streaming[d[e]]}else c.push("streaming"),c.push("page"),a+=k("segments"),a+=k("criteria");for(var f in I)if("exclude"!==I[f]){for(var g=0;g<c.length;g++)c[g]===f&&(b=!1);b&&(a+=k(f)),b=!0}return a}function j(){if(!W)return"";var a="",b="-yahoo";return b="",a=("undefined"!=typeof K.measureNodesURL?K.measureNodesURL:U)+K.serial+"?v="+L+"&tn=JS"+b+i()+"&sch="+N+"&scw="+O+"&scp="+R+"&vh="+P+"&vw="+Q+"&enc="+T+"&n="+Math.round(1e9*Math.random())+d()+f(),"undefined"!=typeof _&&(a+=_),a}function k(a){if(!(a in K))return"";var b="",c="",d="";if("string"==typeof I[a])c=I[a],b+="&"+c+"="+l(K[a]);else{"undefined"==typeof I[a]?c=I[K.measure][a]:"object"==typeof I[a]&&(c=I[a]);for(d in c)K[a][d]&&"exclude"!==c[d]&&(b+="&"+c[d]+"="+l(K[a][d]))}return b}function l(a){var b="";if(a){encodeURIComponent(a).length;b=encodeURIComponent(a).substring(0,256)}return b}function m(a){if(a){"streaming"===K.measure&&(Z++,a=a+"&cmsRK="+Z,12===K.streaming.cmsPS&&(Z=0),"restricted"===K.streaming.access&&(W=!1,Y.stop()));var b=document.createElement("img");return b.src=a,"streaming"===K.measure&&(K.streaming.cmsOP=K.streaming.cmsPO),!0}}function n(a){return 12===K.streaming.cmsPS?(m(a),void($=null)):($||(m(a),window.setTimeout(function(){o()},1e3),$=[],$.firstPS=K.streaming.cmsPS),$.cmsPS=K.streaming.cmsPS,$.cmsPO=K.streaming.cmsPO,$.cmsOP=K.streaming.cmsOP,void($.cmsVI=K.streaming.cmsVI))}function o(){if($&&$.firstPS!==$.cmsPS){K.streaming.cmsEV="state",K.streaming.cmsPS=$.cmsPS,K.streaming.cmsPO=$.cmsPO,K.streaming.cmsOP=$.cmsOP,K.streaming.cmsVI=$.cmsVI;var a=j();m(a)}$=null}function p(){K.streaming.cmsMV=M,isNaN(K.streaming.cmsPO)&&(K.streaming.cmsPO=0),K.streaming.cmsOP=K.streaming.cmsPO,X!==[]&&Y.stop(),Y.launch()}function q(){K.streaming.cmsVI=Math.floor(1e17*Math.random()%0x8db076000000000),K.streaming.access="full",x()}function r(){Y.stop(),K.streaming.cmsPS=12,n(j()),K.streaming.cmsVI=0,K.streaming.cmsPO=0,K.streaming.cmsOP=0}function s(){var a="0";return"replay"!==K.streaming.diffusion||(a=K.streaming.callbackPosition(K.streaming.playerObj),isNaN(a))?a:Math.round(a)}function t(){K.streaming.cmsEV="polling",K.streaming.cmsPO=s(),$&&(K.streaming.cmsPS=$.firstPS),m(j())}function u(a){Z||(K.streaming.access=a[0].split("=")[1]||a[0],U=a[1].split("=")[1]||a[1],"denied"===K.streaming.access?W=!1:a[2].split("=")[1]?K.streaming.cmsVI=a[2].split("=")[1].replace(/\"/g,""):K.streaming.cmsVI=a[2])}function v(){K.streaming.access="denied",W=!1}function w(){200===H.status?u(H.responseText.split("|")):401===H.status&&v()}function x(){V="undefined"!=typeof K.authURL?K.authURL:S+"auth.estat.com/";var a=V+K.serial;if(H)J?(H.onload=w,H.open("GET",a,!0),H.send()):(H.onreadystatechange=function(){4===H.readyState&&w()},H.open("GET",a,!0),H.send());else{var b=function(){var a=[eS_access,eS_host,cmsVI];u(a)},c=document.createElement("script");c.type="text/javascript",c.async=!0,c.src=a+".js";var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(c,d),c.addEventListener?c.addEventListener("load",function(){b()},!1):c.onreadystatechange=function(){c.readyState in{complete:1,loaded:1}&&b()}}}function y(a){var b="";try{b=new window.ActiveXObject(a)}catch(c){}return b}function z(a){var b=y(a);return b?a:""}function A(){return screen.width+"x"+screen.height+"x"+screen.colorDepth}function B(){var a=new RegExp("/[0-9]+(.[0-9]+)*/","g");return navigator.userAgent.replace(a,"")}function C(a){var b="",c="";if(navigator.appName.match("/Internet Explorer/g")){c=["wmplayer.ocx","QuickTime.QuickTime","ShockwaveFlash.ShockwaveFlash","VideoLAN.VLCPlugin","AgControl.AgControl","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","AcroPDF.PDF","PDF.PdfCtrl","SWCtl.SWCtl"];for(var d=0;d<c.length;d++)b+=z(c[d])+a}else if(c=navigator.plugins)for(var e=0;e<c.length;e++){var f=c[e];b||(b+=a),b+=f.name;for(var g=0;g<f.length;g++)b||(b+=a),b+=f[g].type}return b}function D(){return navigator.cookieEnabled?"Yes":"No"}function E(a){var b,c,d,e,f,g,h,i,j;for(b=3&a.length,c=a.length-b,d=j,j=3735928559,f=3432918353,g=461845907,i=0;c>i;)h=255&a.charCodeAt(i)|(255&a.charCodeAt(++i))<<8|(255&a.charCodeAt(++i))<<16|(255&a.charCodeAt(++i))<<24,++i,h=(65535&h)*f+(((h>>>16)*f&65535)<<16)&4294967295,h=h<<15|h>>>17,h=(65535&h)*g+(((h>>>16)*g&65535)<<16)&4294967295,d^=h,d=d<<13|d>>>19,e=5*(65535&d)+((5*(d>>>16)&65535)<<16)&4294967295,d=(65535&e)+27492+(((e>>>16)+58964&65535)<<16);switch(h=0,b){case 3:h^=(255&a.charCodeAt(i+2))<<16;break;case 2:h^=(255&a.charCodeAt(i+1))<<8;break;case 1:h^=255&a.charCodeAt(i),h=(65535&h)*f+(((h>>>16)*f&65535)<<16)&4294967295,h=h<<16|h>>>16,h=(65535&h)*g+(((h>>>16)*g&65535)<<16)&4294967295,d^=h}return d^=a.length,d^=d>>>16,d=2246822507*(65535&d)+((2246822507*(d>>>16)&65535)<<16)&4294967295,d^=d>>>13,d=3266489909*(65535&d)+((3266489909*(d>>>16)&65535)<<16)&4294967295,d^=d>>>16,d>>>0}function F(){var a="";return a+=A()+"|",a+=B()+"|",a+=C("|")+"|",a+=D(),_="&ck2="+E(a)}function G(a,b){var c=!1;b||(a.hasOwnProperty("measure")&&delete a.measure,a.hasOwnProperty("serial")&&delete a.serial);for(var d in a)if("object"!=typeof a[d])K[d]=a[d],c=!0;else for(var e in a[d])K[d]||(K[d]={}),K[d][e]=a[d][e],c=!0;return c}if(!a)throw new Error("You have to pass a configuration JSON object to the eStatTag constructor");if(!c(a))throw new Error("The configuration JSON object passed to the eStatTag constructor doesn't respect the good pattern");var H,I={measure:{page:"exclude",streaming:"exclude"},serial:"exclude",implementation:"exclude",authURL:"exclude",measureNodesURL:"exclude",crmID:"crmid",domain:"dom",master:"g",wrapper:"w",page:{levels:{level_1:"c",level_2:"p",level_3:"l3",level_4:"l4"},criteria:{critere_1:"c1",critere_2:"c2",critere_3:"c3",critere_4:"c4",critere_5:"c5"},segments:{segment_1:"seg1",segment_2:"seg2",segment_3:"seg3",segment_4:"seg4",segment_5:"seg5",segment_6:"seg6",segment_7:"seg7",segment_8:"seg8"}},streaming:{levels:{level_1:"cmsS3",level_2:"cmsS2",level_3:"cmsS1",level_4:"cmsS4",level_5:"cmsS5"},diffusion:"exclude",streamName:"cmsSN",streamURL:"cmsME",streamGenre:"cmsGR",streamDuration:"cmsDU",playerName:"cmsPL",playerVersion:"cmsPV"},newLevels:{newLevel_1:"ml1",newLevel_2:"ml2",newLevel_3:"ml3",newLevel_4:"ml4",newLevel_5:"ml5",newLevel_6:"ml6",newLevel_7:"ml7",newLevel_8:"ml8",newLevel_9:"ml9",newLevel_10:"ml10",newLevel_11:"ml11"},mediaInfo:{mediaContentId:"msCid",mediaDiffMode:"msDm",mediaChannel:"msCh"},netMeasurement:"miCh"},J=window.XDomainRequest?!0:!1,K={},L="5.1.3",M=5,N=screen.height,O=screen.width,P=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,Q=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0,R=screen.colorDepth,S="https:"===document.location.protocol?"https://":"http://",T=document.characterSet||document.charset,U=S+"prof.estat.com/m/web/",V=S+"auth.estat.com/";H=b();var W=!0,X=[],Y={launch:function(){X[0]=window.setTimeout(function(){t()},1e4),X[1]=window.setTimeout(function(){t()},2e4),X[2]=window.setTimeout(function(){t()},4e4),X[3]=window.setInterval(function(){t()},6e4)},stop:function(){for(var a=0;3>a;a++)window.clearTimeout(X[a]);window.clearInterval(X[3]),X=[]}},Z=0,$=null,_=F();G(a,!0),"streaming"===K.measure&&q();var aa={post:function(){return"page"!==K.measure?!1:(m(j()),!0)},set:function(a){var b=!1;return b=G(a)},notifyPlayer:function(a,b){if("streaming"!==K.measure)return!1;if(!("play"===a|"pause"===a|"stop"===a))return!1;switch(W&&(K.streaming.cmsEV="state"),b&&!isNaN(b)&&"live"!==K.streaming.diffusion?K.streaming.cmsPO=Math.round(b):K.streaming.cmsPO=s(),a){case"play":if(!W||5===K.streaming.cmsPS)break;K.streaming.cmsPS=5,Z||(K.streaming.cmsVI||q(),p()),n(j());break;case"pause":if(!W||7===K.streaming.cmsPS)break;"replay"!==K.streaming.diffusion?(r(),"timeshifting"===K.streaming.diffusion&&(K.streaming.diffusion="replay")):(K.streaming.cmsPS=7,n(j()));break;case"stop":if(!W||12===K.streaming.cmsPS)break;r();break;default:return!1}return!0}};return aa};