!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){!function(){"use strict";function BFAttributeParser(config){this.defaultConfig={start:"@",end:";",separator:":",objectPropertySeparator:",",objectStart:"{",objectEnd:"}",arrayStart:"[",arrayEnd:"]",parts:{action:"a",description:"d",location:"l",data:"e",options:"o"}},this.config=config||this.defaultConfig,this.parse=function(element){var result={},attribute=element.getAttribute("data-bfa");return result=null===attribute||""===attribute?{action:"",location:"",description:"",data:{},options:{}}:this.processAttribute(attribute),""===result.location&&(result.location=this.findLocation(element.parentElement)),result.action=this.grabDataSource(result.action),result.location=this.grabDataSource(result.location),result.description=this.grabDataSource(result.description),[result.action,result.location,result.description,result.data,result.options]},this.processAttribute=function(attribute){var collector=[];for(var part in this.config.parts)if(this.config.parts.hasOwnProperty(part)){var idx=attribute.indexOf(this.config.start+this.config.parts[part]+this.config.separator);idx>-1&&collector.push({part:part,idx:idx})}collector=collector.sort(function(a,b){return a.idx<b.idx?-1:a.idx===b.idx?0:1});for(var result={action:"",location:"",description:"",data:"",options:""},i=0;i<collector.length;i++)i<collector.length-1?result[collector[i].part]=attribute.substring(collector[i].idx,collector[i+1].idx):result[collector[i].part]=attribute.substring(collector[i].idx);for(var key in result)result.hasOwnProperty(key)&&(result[key]=result[key].replace(this.config.start+this.config.parts[key]+this.config.separator,"").trim(),result[key][result[key].length-1]===this.config.end&&(result[key]=result[key].substring(0,result[key].length-1)));return result.data=this.convertToObject(result.data),result.options=this.convertToObject(result.options),result},this.findLocation=function(element){for(;null!==element;){var attr=element.getAttribute("data-bfa");if(null!==attr&&""!==attr){var result=this.processAttribute(attr);if(""===result.location){element=element.parentElement;continue}return result.location}element=element.parentElement}return""},this.objectParseMode={propertyName:1,propertyValue:2,propertyArray:4},this.convertToObject=function(value){var resultedObj={};if(value=value.trim().replace('"',"").replace("'",""),"string"!=typeof value||0!==value.indexOf(this.defaultConfig.objectStart)||value.indexOf(this.defaultConfig.objectEnd)!==value.length-1)return resultedObj;for(var currentPropertyName="",currentPropertyValue="",currentArrayValue="",parseMode=this.objectParseMode.propertyName,i=1;i<value.length-1;i++)if(value[i]!==this.defaultConfig.separator||parseMode!==this.objectParseMode.propertyName)switch(parseMode){case this.objectParseMode.propertyArray:if(currentPropertyValue||(currentPropertyValue=[]),value[i]===this.defaultConfig.arrayEnd){currentPropertyValue.push(currentArrayValue.trim()),resultedObj[currentPropertyName.trim()]=currentPropertyValue,currentPropertyName="",currentArrayValue="",currentPropertyValue="",parseMode=this.objectParseMode.propertyName;break}if(value[i]===this.defaultConfig.objectPropertySeparator){currentPropertyValue.push(currentArrayValue),currentArrayValue="";break}currentArrayValue+=value[i];break;case this.objectParseMode.propertyValue:value[i]===this.defaultConfig.objectPropertySeparator||i===value.length-2?(resultedObj[currentPropertyName.trim()]=(currentPropertyValue+(value[i]!==this.defaultConfig.objectPropertySeparator?value[i]:"")).trim(),currentPropertyName="",currentPropertyValue="",parseMode=this.objectParseMode.propertyName):currentPropertyValue+=value[i];break;case this.objectParseMode.propertyName:value[i]!==this.defaultConfig.objectPropertySeparator&&(currentPropertyName+=value[i])}else value[i+1]&&value[i+1]===this.defaultConfig.arrayStart?(parseMode=this.objectParseMode.propertyArray,i++):parseMode=this.objectParseMode.propertyValue;return resultedObj},this.grabDataSource=function(value){if(value.indexOf("source:")>-1){var funcFullName=value.replace("source:","").trim();if(funcFullName&&window){for(var context=window,namespaces=funcFullName.split("."),funcName=namespaces.pop(),i=0;i<namespaces.length;i++)context=context[namespaces[i]];var func=context[funcName];if(func)return func()}}return value}}module.exports=BFAttributeParser}()},{}],2:[function(require,module,exports){!function(){"use strict";function BFEventBinder(configuration,executable){this.parser=new BFAttributeParser,this.configuration=configuration,this.init=function(){if(this.configuration)for(var key in this.configuration)if(this.configuration.hasOwnProperty(key)){if("dom"===key&&this.configuration[key].enabled){var domBinder=new BFDomEventBinder(this.configuration[key],executable);domBinder.init()}if("social"===key&&this.configuration[key].enabled){var socialMappings=this.configuration[key];if(void 0!==socialMappings.facebook){var fbBinder=new SocialBinders.FacebookBinder(socialMappings.facebook,executable);fbBinder.init()}}if("scroll"===key&&this.configuration[key].enabled){var scrollBinder=new BFScrollBinder(this.configuration[key],executable);scrollBinder.init()}}}}var BFDomEventBinder=require("./dom/bf_dom_event_binder.js"),SocialBinders=require("./social/bf_social_event_binder.js"),BFScrollBinder=require("./scroll/bf_scroll_event_binder.js"),BFAttributeParser=require("./bf_attribute_parser.js");module.exports=BFEventBinder}()},{"./bf_attribute_parser.js":1,"./dom/bf_dom_event_binder.js":5,"./scroll/bf_scroll_event_binder.js":10,"./social/bf_social_event_binder.js":11}],3:[function(require,module,exports){var BFEventBinder=require("./bf_event_binder.js");!function(configuration){"use strict";window.bfaBinder=new BFEventBinder(configuration,"bfa")}({social:{enabled:!0,facebook:["like","unlike","comment"]},dom:{enabled:!0,mapping:{click:[{event:"mousedown",selector:".page-nav__action--fb-share",options:{}},{event:"mousedown",selector:"div.reactions-carousel__arrows",options:{}},{event:"mousedown",selector:"i.gif-nav",options:{}},{event:"mousedown",selector:".page-search__search-button",options:{}},{event:"mousedown",selector:"a",options:{handlers:["ATagWithExternalLinkHandler","ATagWithInternalLinkHandler","ATagDefaultHandler"]}},{event:"mousedown",selector:"button",options:{}},{event:"mousedown",selector:"input[type='submit']",options:{}},{event:"mousedown",selector:"svg",options:{directHandling:!0}},{event:"mousedown",selector:"select",options:{}},{event:"mousedown",selector:".country-toggle",options:{}},{event:"change",selector:"select",options:{handlers:["SelectTagChangedClickHandler"]}},{event:"mousedown",selector:"#contribute-post",options:{directHandling:!0}},{event:"mousedown",selector:".commentbox.contribution-form .submit",options:{directHandling:!0}},{event:"mousedown",selector:"button.js-submit-signup-form",options:{directHandling:!0}}]}},scroll:{enabled:!1,mode:"pixel",percentages:[25,50,75,100],elements:{locator:".buzz",count:16},bottomSharingBar:'[data-bfa="@l:Bottom-Share;"]',relatedFeedBar:"#related_feed",platform:1}})},{"./bf_event_binder.js":2}],4:[function(require,module,exports){function parseUrl(url){"use strict";if(null===url||void 0===url||!("string"==typeof url||url instanceof String))return null;var matches=url.match(urlPattern);return{url:matches[0]?matches[0]:"",scheme:matches[2]?matches[2]:"",host:matches[4]?matches[4]:"",path:matches[5]?matches[5]:"",cleanedPath:matches[5]?matches[5]:"",query:matches[7]?matches[7]:"",fragment:matches[9]?matches[9]:""}}function checkIsUrlInternal(urlObj){"use strict";return urlObj.scheme.length>0&&urlObj.host.length>0&&-1===urlObj.host.indexOf("buzzfeed.com")||0===urlObj.url.indexOf("javascript:;")?!1:!0}function checkIsUrlExternal(urlObj){"use strict";return!urlObj.host||!urlObj.scheme||urlObj.host.indexOf("buzzfeed.com")>-1||-1===urlObj.scheme.indexOf("http")?!1:!0}function getValidInternalUrlString(urlObj){"use strict";return urlObj.path+(urlObj.query?"?"+urlObj.query:"")}function getValidExternalUrlString(urlObj){"use strict";return urlObj.url}function getValidUrlString(urlStr){"use strict";var urlObj=parseUrl(urlStr);return null===urlObj?"":checkIsUrlExternal(urlObj)?getValidExternalUrlString(urlObj):checkIsUrlInternal(urlObj)?getValidInternalUrlString(urlObj):""}function shouldBeTrackedOptionsCheck(options){return!(options&&options.ignore instanceof Array)||-1===options.ignore.indexOf("bfaBinder")&&-1===options.ignore.indexOf("all")||options.force instanceof Array&&-1!==options.force.indexOf("bfaBinder")?!0:!1}function ATagWithInternalLinkHandler(element,executable){"use strict";if(null===element||"A"!==element.nodeName||element.hasAttribute("data-bfa"))return!1;var href=element.getAttribute("href"),urlObj=parseUrl(href);if(null===urlObj||!checkIsUrlInternal(urlObj))return!1;var parser=new BFAttributeParser,location=parser.findLocation(element),trackingInfo=["track","click","Nav-Link",location,"",{url:getValidInternalUrlString(urlObj)},{}];return executable&&window[executable]instanceof Function&&window[executable].apply(this,trackingInfo),!0}function ATagWithExternalLinkHandler(element,executable){"use strict";if(null===element||"A"!==element.nodeName||element.hasAttribute("data-bfa"))return!1;var href=element.getAttribute("href"),urlObj=parseUrl(href);if(!urlObj||!checkIsUrlExternal(urlObj))return!1;var parser=new BFAttributeParser,location=parser.findLocation(element),anchorDesc=element.innerHTML,trackingInfo=["track","click","Exit-Link",location,"",{url:getValidExternalUrlString(urlObj),anchorDesc:anchorDesc},{}];return executable&&window[executable]instanceof Function&&window[executable].apply(this,trackingInfo),!0}function SelectTagChangedClickHandler(element,executable){"use strict";if(null===element||"SELECT"!==element.nodeName)return!1;var optionElement=element.options[element.selectedIndex];if(!optionElement)return!1;if(!optionElement.hasAttribute("data-bfa"))return!1;var parser=new BFAttributeParser,parsed=parser.parse(optionElement);if(!shouldBeTrackedOptionsCheck(parsed[4]))return!1;optionElement.hasAttribute("data-href")&&(parsed[3].url=getValidUrlString(optionElement.getAttribute("data-href")));var result=["track","click"];return result=result.concat(parsed),executable&&window[executable]instanceof Function&&window[executable].apply(this,result),!0}function ATagDefaultHandler(element,executable,trackingMethod){"use strict";if(null===element||"A"!==element.nodeName||!element.hasAttribute("data-bfa"))return!1;var parser=new BFAttributeParser,parsed=parser.parse(element);if(!shouldBeTrackedOptionsCheck(parsed[4]))return!1;parsed[3].url=getValidUrlString(element.getAttribute("href"));var result=["track",trackingMethod];return result=result.concat(parsed),executable&&window[executable]instanceof Function&&window[executable].apply(this,result),!0}function DefaultHandler(element,executable,trackingMethod){"use strict";if(null===element||!element.hasAttribute("data-bfa"))return!1;var parser=new BFAttributeParser,parsed=parser.parse(element);if(!shouldBeTrackedOptionsCheck(parsed[4]))return!1;var result=["track",trackingMethod];return result=result.concat(parsed),executable&&window[executable]instanceof Function&&window[executable].apply(this,result),!0}var BFAttributeParser=require("./../bf_attribute_parser.js"),urlPattern=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");module.exports={ATagWithInternalLinkHandler:ATagWithInternalLinkHandler,ATagWithExternalLinkHandler:ATagWithExternalLinkHandler,ATagDefaultHandler:ATagDefaultHandler,SelectTagChangedClickHandler:SelectTagChangedClickHandler,DefaultHandler:DefaultHandler}},{"./../bf_attribute_parser.js":1}],5:[function(require,module,exports){function BFDomEventBinder(configuration,executable){"use strict";this.configuration=configuration,this.directEvents={},this.delegatedEvents={},this.eventhandlerDelegation={},this.eventhandlerDirect={},this.init=function(){if(this.configuration){var mapping=this.configuration.mapping;if(mapping)for(var sectionName in mapping)mapping.hasOwnProperty(sectionName)&&this.processMappingSection(sectionName,mapping[sectionName]);this.eventhandlerDelegation=new BFDomEventhandlerDelegation(this.delegatedEvents,executable),this.eventhandlerDelegation.init(),this.eventhandlerDirect=new BFDomEventhandlerDirect(this.directEvents,executable),this.eventhandlerDirect.init()}},this.processMappingSection=function(trackingMethod,mappingSectionValue){for(var i=0;i<mappingSectionValue.length;i++){var record=mappingSectionValue[i];if(record.options&&record.options.directHandling){var directEvent={selector:record.selector,trackingMethod:trackingMethod,pipeline:record.options.handlers};record.event in this.directEvents?this.directEvents[record.event].push(directEvent):this.directEvents[record.event]=[directEvent]}else{var delegatedEvent={selector:record.selector,trackingMethod:trackingMethod,pipeline:record.options?record.options.handlers:null};record.event in this.delegatedEvents?this.delegatedEvents[record.event].push(delegatedEvent):this.delegatedEvents[record.event]=[delegatedEvent]}}},this.unbindAll=function(){this.eventhandlerDelegation.unbindAll()}}var BFDomEventhandlerDelegation=require("./bf_dom_eventhandler_delegation.js"),BFDomEventhandlerDirect=require("./bf_dom_eventhandler_direct.js");module.exports=BFDomEventBinder},{"./bf_dom_eventhandler_delegation.js":6,"./bf_dom_eventhandler_direct.js":7}],6:[function(require,module,exports){function BFDomEventhandlerDelegation(events,executable){"use strict";this.events=events,this.handlers=[],this.matches=document.documentElement.matches||document.documentElement.webkitMatchesSelector||document.documentElement.mozMatchesSelector||document.documentElement.oMatchesSelector||document.documentElement.msMatchesSelector,this.init=function(){this.subscribeDelegatedEvents()},this.subscribeDelegatedEvents=function(){var listener=document.body||document.documentElement;for(var domEventName in this.events)if(this.events.hasOwnProperty(domEventName)){var hndl=this.getHandler();this.handlers.push({eventName:domEventName,handler:hndl}),listener.addEventListener(domEventName,hndl)}},this.getHandler=function(){var _this=this;return function(e){if(!e.bfaHandled&&e.target)for(var element=e.target,isHandled=!1;element;){for(var j=0;j<_this.events[e.type].length;j++){var record=_this.events[e.type][j];if(element.nodeType&&9!==element.nodeType&&_this.matches.call(element,record.selector)){_this.trackElement(element,record.trackingMethod,record.pipeline),isHandled=!0;break}}if(isHandled){e.bfaHandled=!0;break}element=element.parentNode}}},this.trackElement=function(element,trackingMethod,pipelineList){if(pipelineList)for(var i=0;i<pipelineList.length&&!BFElementHandlers[pipelineList[i]](element,executable,trackingMethod);i++);else BFElementHandlers.DefaultHandler(element,executable,trackingMethod)},this.unbindAll=function(){for(var listener=document.body||document.documentElement,i=0;i<this.handlers.length;i++)listener.removeEventListener(this.handlers[i].eventName,this.handlers[i].handler)}}var BFElementHandlers=require("./bf_dom_element_handlers.js");module.exports=BFDomEventhandlerDelegation},{"./bf_dom_element_handlers.js":4}],7:[function(require,module,exports){function BFDomEventhandlerDirect(events,executable){"use strict";this.events=events,this.handlers=[],this.init=function(){this.subscribeDirectEvents()},this.subscribeDirectEvents=function(){for(var domEventName in this.events)if(this.events.hasOwnProperty(domEventName))for(var toHandle=this.events[domEventName],i=0;i<toHandle.length;i++){var element=document.querySelector(toHandle[i].selector);element&&element.addEventListener(domEventName,this.getHandler(toHandle[i].trackingMethod,toHandle[i].pipeline))}},this.getHandler=function(trackingMethod,pipelineList){var _this=this;return function(e){_this.trackElement(this,trackingMethod,pipelineList),e.bfaHandled=!0}},this.trackElement=function(element,trackingMethod,pipelineList){if(pipelineList)for(var i=0;i<pipelineList.length&&!BFElementHandlers[pipelineList[i]](element,executable,trackingMethod);i++);else BFElementHandlers.DefaultHandler(element,executable,trackingMethod)}}var BFElementHandlers=require("./bf_dom_element_handlers.js");module.exports=BFDomEventhandlerDirect},{"./bf_dom_element_handlers.js":4}],8:[function(require,module,exports){function ElementsScrollBinder(options,executable,checkPoints){"use strict";this.options=options||{},this.executable=executable,this.checkPoints=checkPoints,this.getHandler=function(){var _this=this;return function(){if(_this.options.elements&&_this.options.elements.locator&&_this.options.elements.count){for(var currentScroll=window.pageYOffset+document.documentElement.clientHeight+1,scrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,clientTop=document.documentElement.clientTop||document.body.clientTop||0,elements=document.querySelectorAll(_this.options.elements.locator),passedElementsCount=0,i=0;i<elements.length;i++){var elTop=elements[i].getBoundingClientRect().top+scrollTop-clientTop;currentScroll>=elTop&&passedElementsCount++}var currentPercentage=passedElementsCount/_this.options.elements.count*100,bottomSharingBar=document.querySelector(options.bottomSharingBar),relatedFeedBar=document.querySelector(options.relatedFeedBar),anchor=bottomSharingBar||relatedFeedBar||null;if(anchor){var anchorPosition=anchor.getBoundingClientRect().top+scrollTop-clientTop;currentScroll>=anchorPosition&&100>currentPercentage&&(currentPercentage=100),anchorPosition>=currentScroll&&100===currentPercentage&&(currentPercentage=0)}else currentPercentage=100===currentPercentage?0:currentPercentage;for(var j=0;j<_this.checkPoints.length;j++)if(_this.checkPoints[j].percentage<=currentPercentage&&!_this.checkPoints[j].passed){_this.checkPoints[j].passed=!0;var result=["track","scroll","post",null,_this.checkPoints[j].trackingValue,null,null];_this.executable&&window[_this.executable]instanceof Function&&window[_this.executable].apply(this,result)}}}}}module.exports=ElementsScrollBinder},{}],9:[function(require,module,exports){function PixelsScrollBinder(options,executable,checkPoints){"use strict";this.options=options||{},this.executable=executable,this.checkPoints=checkPoints,this.getHandler=function(){var _this=this;return function(){if(options.bottomSharingBar){var scrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,clientHeight=document.documentElement.clientHeight+1,clientTop=document.documentElement.clientTop||document.body.clientTop||0,currentScroll=scrollTop+clientHeight,currentPercentage=0,bottomSharingBar=document.querySelector(options.bottomSharingBar),relatedFeedBar=document.querySelector(options.relatedFeedBar),anchor=bottomSharingBar||relatedFeedBar||null;if(anchor){var anchorPosition=anchor.getBoundingClientRect().top+scrollTop-clientTop;currentScroll>=anchorPosition&&100>currentPercentage&&(currentPercentage=100),anchorPosition>=currentScroll&&(currentPercentage=currentScroll/anchorPosition*100)}for(var i=0;i<_this.checkPoints.length;i++)if(_this.checkPoints[i].percentage<=currentPercentage&&!_this.checkPoints[i].passed){_this.checkPoints[i].passed=!0;var result=["track","scroll","post",null,_this.checkPoints[i].trackingValue,null,null];_this.executable&&window[_this.executable]instanceof Function&&window[_this.executable].apply(this,result)}}}}}module.exports=PixelsScrollBinder},{}],10:[function(require,module,exports){function BFScrollBinder(options,executable){"use strict";this.options=options||{},this.executable=executable,this.handler=null,this.checkPoints=[],this.init=function(){if(window&&options&&executable&&(this.fillCheckPoints(),this.handler=this.getHandler(),this.handler)){this.options.platform!==defs.platform.mobileweb&&window.addEventListener("load",this.handler),window.addEventListener("scroll",this.debounce(this.handler,200));var _this=this;document.addEventListener("keydown",function(e){(32===e.which||33===e.which||34===e.which||38===e.which||40===e.which||e.ctrlKey&&35===e.which||e.ctrlKey&&36===e.which)&&_this.handler()})}},this.fillCheckPoints=function(){if(options.percentages)for(var i=0;i<this.options.percentages.length;i++)this.checkPoints.push({percentage:this.options.percentages[i],trackingValue:this.options.percentages[i],passed:!1})},this.getHandler=function(){if(this.checkPoints.length>0){var binder="pixel"===options.mode?new PixelsScrollBinder(this.options,this.executable,this.checkPoints):"element"===options.mode?new ElementsScrollBinder(this.options,this.executable,this.checkPoints):null;if(binder)return binder.getHandler()}return null},this.debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||func.apply(context,args)},callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&func.apply(context,args)}}}var PixelsScrollBinder=require("./bf_pixels_scroll_event_binder.js"),ElementsScrollBinder=require("./bf_elements_scroll_event_binder.js"),defs=require("../../common/bfa_defs.js");module.exports=BFScrollBinder},{"../../common/bfa_defs.js":12,"./bf_elements_scroll_event_binder.js":8,"./bf_pixels_scroll_event_binder.js":9}],11:[function(require,module,exports){function FacebookBinder(mapping,executable){"use strict";this.mapping=mapping,this.executable=executable,this.parser=new BFAttributeParser,this.init=function(){var _this=this,counter=0,interval=setInterval(function(){counter>=10&&clearInterval(interval),window.FB&&(clearInterval(interval),_this.processMappings()),counter++},1e3)},this.processMappings=function(){if(void 0!==mapping)for(var i=0;i<mapping.length;i++)"like"===mapping[i]&&this.bindLikes(),"unlike"===mapping[i]&&this.bindDislikes(),"comment"===mapping[i]&&this.bindComments()},this.bindLikes=function(){var _this=this;window.FB.Event.subscribe("edge.create",function(url,element){var result=["track","click"];if(null!==element&&element.getAttribute){var parsed=_this.parser.parse(element);result=result.concat(parsed)}_this.executable&&window[_this.executable]instanceof Function&&window[_this.executable].apply(this,result)})},this.bindDislikes=function(){var _this=this;window.FB.Event.subscribe("edge.remove",function(url,element){var result=["track","click"];if(null!==element&&element.getAttribute){var parsed=_this.parser.parse(element);result=result.concat(parsed)}_this.executable&&window[_this.executable]instanceof Function&&window[_this.executable].apply(this,result)})},this.bindComments=function(){var _this=this;window.FB.Event.subscribe("comment.create",function(){var result=["track","click","Submit","Contributions","Facebook",{},{}];_this.executable&&window[_this.executable]instanceof Function&&window[_this.executable].apply(this,result)})}}var BFAttributeParser=require("./../bf_attribute_parser.js");module.exports={FacebookBinder:FacebookBinder}},{"./../bf_attribute_parser.js":1}],12:[function(require,module,exports){!function(){"use strict";var bfaDefs={platform:{desktop:1,mobileweb:2},trackingBehavior:{byDefault:1,ifSpecified:2}};Object.freeze(bfaDefs),module.exports=bfaDefs}()},{}]},{},[3]);