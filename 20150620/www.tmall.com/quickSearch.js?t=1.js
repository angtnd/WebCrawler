KISSY.add("mui/searchbar/instance/default",function(e,a,r,t,i,s,u,o,c,n,l,h,m){var p=window,g=p.g_config||{},d=g["bizId"]||"",b=g["sysId"]||"",f=g["devId"]||"pc",v=d+"."+b+"."+f,C="//suggest.taobao.com/sug?area=tmall-hq&code=utf-8&src="+v,A=(new m).getCurBt();var q={build:function(e){e=e||{};var m=e.node||"#mq",p=!!e.autoFocus,d=e.clickId,b=e.pageType,f=!!e.unableSpeech,q=e.placeholder||{},S=e.query||t.UNKNOWN,x=e.extraParams,y=e.sugArea||"b2c",k="//suggest.taobao.com/sug?area="+y+"&code=utf-8&k=1&bucketid="+A;var B=g.searchbarCfg=g.searchbarCfg||{},w=!!B.isTestBt;if(w){k=k.replace(/\barea=b2c\b/gi,"area=b2c_bts")}var I=a.one(m),E=I?I.parent("form"):undefined,N=E?E[0].redirect:undefined,_=N?N.value:"";var U=new s({text:q.text||"\u641c\u7d22 \u5929\u732b \u5546\u54c1/\u54c1\u724c/\u5e97\u94fa",query:q.query||"",redirectUrl:q.redirectUrl||_});if(TB&&TB.globalToolFn&&TB.globalToolFn.requestHotQuery){TB.globalToolFn.requestHotQuery(function(e){if(e.success&&e.model&&e.model.placeholder){U.update(e.model.placeholder[0])}else{U.update(e)}})}else{r({url:q.cfgTMSUrl||C||"//www.tmall.com/go/rgn/tmall/searchbar/placeholder-reader.php",success:function(e){if(e.success&&e.model&&e.model.placeholder){U.update(e.model.placeholder[0])}else{U.update(e)}},scriptCharset:"utf-8",dataType:"jsonp"})}var T=new t({plugins:[U,new i({})],sugConfig:{url:k,node:m||"#mq",autoFocus:!!p,autoExpand:true,extraParams:x||{},enableSpeech:!f},templates:{act:u,shipShop:o,cat:c,list:n,shop:l,quickSearch:h},query:S,acceptCharset:"gbk",dim:v,log:{pageType:b||1,clickId:d||"topsearch",isMobile:false}});return T}};return q},{requires:["node","ajax","mui/searchbar/base","mui/searchbar/plugin/spm","mui/searchbar/plugin/placeholder","mui/searchbar/template/act","mui/searchbar/template/shipShop","mui/searchbar/template/cat","mui/searchbar/template/list","mui/searchbar/template/shop","mui/searchbar/template/quickSearch","mui/bucket/index","mui/searchbar/suggest.css"]});KISSY.version>=1.4&&KISSY.config({modules:{sizzle:{alias:["node"]},"rich-base":{alias:["base"]},ajax:{alias:["io"]}}});KISSY.add("mui/searchbar/base",function(S,Node,RichBase,D,ComboBox,UA,Cookie,E){var TIP="\u8bf7\u8f93\u5165\u641c\u7d22\u6587\u5b57",UNKNOWN="unknown",VALUE="{VALUE}",ltIE9=UA.ie<9,win=window;function makeCacheNum(){return Math.floor(Math.random()*268435456).toString(16)}var SearchBar=RichBase.extend([],{initializer:function(){this._initComboxBox();this._bindSubmitEvent();this._other()},_initComboxBox:function(){var e=this,a=e._buildDataSourceCfg(),r=new ComboBox.RemoteDataSource(a),t=e._buildComboBoxCfg(r),i=e.comboBox=new ComboBox(t);var s=i.sendRequest;i.sendRequest=function(a){a=S.trim(a);if(e.fire("beforeQueryChange",{query:a})!==false){s.call(this,a)}};i.normalizeData=function(e){var a=this,r;if(a.get("format")){r=a.get("format").call(a,(a["getValueInternal"]||a["getValueForAutocomplete"]).call(a),e)}else{r=[]}return r.slice(0,a.get("maxItemCount"))};i.render();e._bindComboBoxEvents()},_buildDataSourceCfg:function(){var e=this.get("sugConfig"),a=this.get("dataSourceCfg");a.xhrCfg.url=e.url;a.parse=S.bind(this._parse,this);return a},_parse:function(e,a){var r=this.fire("beforeParse",{data:a,query:e});if(r===false){return null}else if(r){a=r}return a},_bindComboBoxEvents:function(){var e=this,a=this.get("templates"),r=this.get("log"),t=function(t){var i=D.children(t),s=D.attr(i,"data-tpl"),o=a[s],n=S.unparam(D.attr(i,"data-params")||""),u=S.merge(e.get("options"),{$query:S.escapeHTML(e.curQuery),$pageType:r.pageType,$index:D.attr(i,"data-index")||"1",$isMobile:r.isMobile});o&&e.clicklog((o["genAtpanel"]||function(e,a){return S.substitute(o.atpanel,a)})(i,S.merge(u,n)))};this.comboBox.on("click",function(a){var r=a.target;if(/MyIE/i.test(navigator.userAgent)){if(!a._elItem)return;else{r.set("el",a._elItem)}}if(r&&r.get("el")&&r.get("el")[0]&&D.get(".s-mi-ship",r.get("el")[0])){t(r.get("el"));location.href=D.attr(D.get(".s-mi-ship .s-mi-ship-wrap",r.get("el")[0]),"data-url");return}if(r&&(r.get("el").hasClass(".s-hqHd-menuitem")||r.get("el").hasClass(".s-hyHd-menuitem")||r.get("el").hasClass(".s-loginHd-menuitem"))){return}if(e.fire("itemClick",{activeitem:r})!==false){var i=this.get("form"),s=r.get("el");var o=D.attr(D.children(s),"data-params")||"q="+e.query;o=S.merge(this.get("sugConfig").extraParams,S.unparam(o));this.filterFormParams(o);t(s);i.fire("submit",{ignoreClicklog:1})}},this)},filterFormParams:function(e){for(var a=0,r=this.get("form")[0],t=r.elements,i=t.length;a<i;a++){t[a].type==="hidden"&&t[a].name&&D.attr(t[a],"disabled","disabled")}this.modifyFormParams(e,1)},modifyFormParams:function(params,forceEnable){var form=this.get("form")[0];for(var k in params){if(!params.hasOwnProperty(k)){continue}params[k]=params[k]||"";if(form[k]&&form[k].tagName==="INPUT"){if(params[k].indexOf(VALUE)>-1){if(params[k]!==VALUE){D.val(form[k],eval(params[k].replace(VALUE,form[k].value)))}}else{D.val(form[k],params[k])}Node.one(form[k]).fire("valuechange");forceEnable==1&&D.removeAttr(form[k],"disabled")}else{var value=params[k];if(params[k].indexOf(VALUE)>-1){if(params[k]!==VALUE){value=eval(params[k].replace(VALUE,""))}else{value=""}}D.append(D.create('<input type="hidden" name="'+k+'" value="'+S.escapeHTML(value)+'"/>'),form)}}},_bindSubmitEvent:function(){var e=this,a=e.get("form"),r=e.get("input"),t=e.get("button"),i=e.get("dim"),s=e.get("log"),o=e.get("sugConfig").extraParams,n=e.get("acceptCharset");a.on("submit",function(a){var t=e.fire("beforeSubmit");if(t===false){a.halt()}if(!a.ignoreClicklog&&t!==e.IGNORE_CLICK_LOG){e.clicklog(","+r.val()+","+r.val()+","+i+"-,"+s.clickId+",searchbutton,"+s.pageType+","+s.isMobile)}UA&&UA.ie&&n!==UNKNOWN&&(document.charset=n)});function u(){e.filterFormParams(S.merge(o,{type:"p",q:VALUE,from:i+"_1_searchbutton"}))}r.on("keydown",function(e){if(e.keyCode==13){u()}});t.on("click",function(e){u()})},_buildComboBoxCfg:function(e){var a=this.get("sugConfig");return{srcNode:this._wrapInput(a.node,a.prefixCls)||"."+a.prefixCls+"combobox",dataSource:e,format:S.bind(this._format,this),focused:!!a.autoFocus,prefixCls:a.prefixCls||"ks-",hasTrigger:false,matchElWidth:!!a.matchElWidth,highlightMatchItem:false,menu:{align:{overflow:{adjustY:0}}},cache:true,placeholder:a.placeholder||TIP}},_wrapInput:function(e,a){var r=this.get("sugConfig"),t=r.enableSpeech;D.attr(e,S.merge({"class":a+"combobox-input",autocomplete:"off",role:"combobox","aria-haspopup":"true",title:TIP,"aria-label":TIP},t?{"x-webkit-speech":"","x-webkit-grammar":"builtin:translate"}:{}));var i=D.parent(e,".{cls}combobox".replace(/{cls}/g,a)),s=S.guid(a+"combobox-"),o;if(i){i.id=i.id||s;o=Node.one(i)}else{D.wrap(e,D.create('<div id="'+s+'" class="{cls}combobox"><div class="{cls}combobox-input-wrap"></div></div>'.replace(/{cls}/g,a)));o=Node.one("#"+s)}return o},_format:function(e,a){if(!a)return[];var r=this.get("templates"),t=this.get("dim"),i=[],s=this._getDate(),o=this.get("sugConfig").prefixCls,n={$wq:S.escapeHTML(e),$query:S.escapeHTML(e),$index:0,$date:s,$prefixCls:o,$dim:t,$userId:a["shop_info"]&&a["shop_info"][0]&&a["shop_info"][0]["user_id"]||""};this.set("options",n);for(var u in r){if(!r[u]){delete r[u];continue}S.log("searchbar::to parse template:"+u+"...");r[u].parse(i,a,S.clone(n))}return i},_getDate:function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+(e.getDate()+1)},update:function(e){var a=this.get("plugins");for(var r=0,t=a.length,i;r<t;r++){i=a[r];i&&S.isFunction(i.update)&&i.update(e)}},blur:function(){var e=this.get("input");e[0].blur()},clicklog:function(e){var a=e.split(","),r=win.__header_atpanel_param||"",t={pos:a[0]||"",q:a[1]||"",wq:a[2]||"",suggest:a[3]||"",clickid:a[4]||"",combo:a[5]||"",page_type:a[6]||"",is_wap:a[7]||"0",type:a[8]||5,active:"0",search_type:"search"};r+=(S.endsWith(r,"&")?"":r?"&":"")+S.param(t);this.exposelog("/mallsearch","tmallsearch",r,"H1449172242")},exposelog:function(e,a,r,t){if(win.goldlog&&win.goldlog.record){goldlog.record(e,a,r,t)}else{var i=new Image,s="_img_"+e+"_"+(new Date).getTime();win[s]=i;i.onload=i.onerror=function(){win[s]=null};i.src="//gm.mmstat.com"+e+"?goldlog=undefined"+"&cache="+makeCacheNum()+"&gmkey="+encodeURIComponent(a)+"&gokey="+encodeURIComponent(r)+"&cna="+(Cookie.get("cna")||"");S.log(win[s]);i=null}},_other:function(){var e=this,a=this.get("ignoreChars"),r=new RegExp("["+a.join(",")+"]","gi"),t=this.get("input"),i=this.comboBox,s=this.get("sugConfig"),o=s.autoExpand,n=s.prefixCls;var u=this.get("query");if(u!==UNKNOWN){t.attr("value",u);i.set("value",u)}t.on("keyup",function(e){e.shiftKey&&(e.keyCode<37&&e.keyCode!==16||e.keyCode>40)&&(this.value=this.value.replace(r,""))});o&&t.on("focus",function(){i.sendRequest(S.trim(this.value))});Node.one(window).on("resize",S.buffer(function(a){var r=e.get("menuContainer");r&&r.width(t.outerWidth())},150));var c=this.get("acceptCharset"),l=this.get("form");c!==UNKNOWN&&l.attr("accept-charset",c);var m=s["autoSubmitOnItemClick"];!m&&this.on("itemClick",function(){return false});i.on("afterCollapsedChange",function(a){if(!a.newVal){i.detach("afterCollapsedChange",arguments.callee);if(/MyIE/i.test(navigator.userAgent)){E.delegate(D.get(".s-menu"),"click",".s-menuitem",function(a){e.comboBox.fire("click",{_elItem:S.one(a.currentTarget)})})}}});t.on("valuechange",function(){e.curQuery=t.val()});e.curQuery=t.val()},_event:["beforeSubmit","beforeParse","beforeQueryChange","itemClick","restore"],VALUE:VALUE,IGNORE_CLICK_LOG:"{{ignore_click_log}}",UNKNOWN:UNKNOWN},{ATTRS:{sugConfig:{value:{extraParams:{},url:"",node:"",autoFocus:false,autoExpand:false,prefixCls:"s-",placeholder:TIP,enableSpeech:true,matchElWidth:true,autoSubmitOnItemClick:true},setter:function(e){var a=this.get("sugConfig");return S.mix(a,e,undefined,undefined,true)}},templates:{value:{},setter:function(e){return e}},nodes:{value:{}},placeholder:{getter:function(){var e=this.get("nodes");if(!e.placeholder){e.placeholder=this.comboBox.get("placeholderEl")}return e.placeholder}},input:{getter:function(){var e=this.get("nodes");if(!e.input){e.input=this.comboBox.get("input")}return e.input}},button:{getter:function(){var e=this,a=this.get("nodes");if(typeof a.button==="undefined"){var r=this.get("form");var t=r[0].elements;S.each(t,function(a){if(D.attr(a,"type")==="submit"){e.get("nodes").button=Node.one(a)}})}!a.button&&S.log("searchbar::there isn't a button of 'submit' type in this form!","error");return a.button}},form:{getter:function(e){var a=this.get("nodes");if(!a.form){a.form=this.get("input").parent("form")}return a.form}},container:{getter:function(){var e=this.get("nodes");if(!e.container){e.container=this.comboBox.get("el")}return e.container}},menuContainer:{getter:function(){var e=this.get("nodes");if(!e.menuContainer){var a=this.get("menu");a&&a.get&&(e.menuContainer=a.get("el"))}!e.menuContainer&&S.log("searchbar::at so far, popup menu for suggest is nonexistent.","warn");return e.menuContainer}},menu:{getter:function(){return this.comboBox.get("menu")}},dataSourceCfg:{value:{xhrCfg:{url:"",dataType:"jsonp",scriptCharset:"utf-8",data:{code:"utf-8"}},allowEmpty:true,paramName:"q",cache:true}},dim:{value:".list.pc"},log:{value:{pageType:"1",clickId:"topsearch",isMobile:0},setter:function(e){var a=this.get("log");a=S.mix(a,e,undefined,undefined,true);a.isMobile=a.isMobile?1:0;return a}},ignoreChars:{value:["<",">","?","\uff1f"]},acceptCharset:{value:UNKNOWN},query:{value:UNKNOWN,setter:function(e){if(e){var a=this.get("ignoreChars"),r=new RegExp("["+a.join(",")+"]","gi");e=e.replace(r,"")}else{e=""}return e}}}});SearchBar.UNKNOWN=UNKNOWN;SearchBar.VALUE=VALUE;SearchBar.IGNORE_CLICK_LOG="{{ignore_click_log}}";return SearchBar},{requires:["node","rich-base","dom","combobox","ua","cookie","event"]});/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 22 12:16
*/
KISSY.add("combobox/combobox-xtpl",[],function(){return function(f){var a,d=this;a=this.config.utils;var j=a.runBlockCommand,k=a.renderOutput,g=a.getProperty,h=a.runInlineCommand,e=a.getPropertyOrRunCommand;a='<div id="ks-combobox-invalid-el-';var b=e(d,f,{},"id",0,1);a+=k(b,!0);a+='"\n     class="';var b={},c=[];c.push("invalid-el");b.params=c;b=h(d,f,b,"getBaseCssClasses",2);a+=k(b,!0);a+='">\n    <div class="';b={};c=[];c.push("invalid-inner");b.params=c;b=h(d,f,b,"getBaseCssClasses",3);a+=k(b,
!0);a+='"></div>\n</div>\n\n';var b={},c=[],m=g(d,f,"hasTrigger",0,6);c.push(m);b.params=c;b.fn=function(b){var a;a='\n<div id="ks-combobox-trigger-';var c=e(d,b,{},"id",0,7);a+=k(c,!0);a+='"\n     class="';var c={},g=[];g.push("trigger");c.params=g;c=h(d,b,c,"getBaseCssClasses",8);a+=k(c,!0);a+='">\n    <div class="';c={};g=[];g.push("trigger-inner");c.params=g;b=h(d,b,c,"getBaseCssClasses",9);a+=k(b,!0);return a+'">&#x25BC;</div>\n</div>\n'};a+=j(d,f,b,"if",6);a+='\n\n<div class="';b={};c=[];c.push("input-wrap");
b.params=c;b=h(d,f,b,"getBaseCssClasses",13);a+=k(b,!0);a+='">\n\n    <input id="ks-combobox-input-';b=e(d,f,{},"id",0,15);a+=k(b,!0);a+='"\n           aria-haspopup="true"\n           aria-autocomplete="list"\n           aria-haspopup="true"\n           role="autocomplete"\n           aria-expanded="false"\n\n    ';b={};c=[];m=g(d,f,"disabled",0,22);c.push(m);b.params=c;b.fn=function(){return"\n    disabled\n    "};a+=j(d,f,b,"if",22);a+='\n\n    autocomplete="off"\n    class="';b={};c=[];c.push("input");
b.params=c;b=h(d,f,b,"getBaseCssClasses",27);a+=k(b,!0);a+='"\n\n    value="';b=e(d,f,{},"value",0,29);a+=k(b,!0);a+='"\n    />\n\n\n    <label id="ks-combobox-placeholder-';b=e(d,f,{},"id",0,33);a+=k(b,!0);a+='"\n           for="ks-combobox-input-';b=e(d,f,{},"id",0,34);a+=k(b,!0);a+="\"\n            style='display:";b={};c=[];g=g(d,f,"value",0,35);c.push(g);b.params=c;b.fn=function(){return"none"};b.inverse=function(){return"block"};a+=j(d,f,b,"if",35);a+=";'\n    class=\"";j={};g=[];g.push("placeholder");
j.params=g;j=h(d,f,j,"getBaseCssClasses",36);a+=k(j,!0);a+='">\n    ';f=e(d,f,{},"placeholder",0,37);a+=k(f,!0);return a+"\n    </label>\n</div>\n"}});
KISSY.add("combobox/render",["component/control","./combobox-xtpl"],function(f,a){var d=a("component/control"),j=a("./combobox-xtpl");return d.getDefaultRender().extend({beforeCreateDom:function(a,d){f.mix(d,{input:"#ks-combobox-input-{id}",trigger:"#ks-combobox-trigger-{id}",invalidEl:"#ks-combobox-invalid-el-{id}",placeholderEl:"#ks-combobox-placeholder-{id}"})},getKeyEventTarget:function(){return this.control.get("input")},_onSetCollapsed:function(a){this.control.get("input").attr("aria-expanded",
!a)},_onSetDisabled:function(a,d){this.callSuper(a,d);this.control.get("input").attr("disabled",a)}},{ATTRS:{contentTpl:{value:j}},HTML_PARSER:{value:function(a){return a.one("."+this.getBaseCssClass("input")).val()},input:function(a){return a.one("."+this.getBaseCssClass("input"))},trigger:function(a){return a.one("."+this.getBaseCssClass("trigger"))},invalidEl:function(a){return a.one("."+this.getBaseCssClass("invalid-el"))},placeholderEl:function(a){return a.one("."+this.getBaseCssClass("placeholder"))}}})});
KISSY.add("combobox/control",["node","component/control","./render","menu"],function(f,a){function d(a){for(var b=0;b<a.length;b++)if(!a[b].get("disabled"))return a[b];return null}function j(){c(this)}function k(){var a=this;setTimeout(function(){m(a)},0)}function g(){this.focus();m(this)}function h(){this.setValueFromAutocomplete(this.getValueForAutocomplete(),{force:1})}function e(a){a=a.target;a.isMenuItem&&(a=a.get("textContent"),this.setValueFromAutocomplete(a),this._savedValue=a,this.set("collapsed",
!0))}function b(a,b){var c=a.$el,e=a.view.getBaseCssClasses("invalid"),d=a.get("invalidEl");b?(c.addClass(e),d.attr("title",b),d.show()):(c.removeClass(e),d.hide())}function c(a){a._focusoutDismissTimer||(a._focusoutDismissTimer=setTimeout(function(){a._focusoutDismissTimer&&a.set("collapsed",!0)},50))}function m(a){var b=a._focusoutDismissTimer;b&&(clearTimeout(b),a._focusoutDismissTimer=null)}function s(a){this.set("value",a.newVal,{data:{causedByTimer:1}})}function i(a){var b,c=[],e,d,c=this.get("menu"),
a=this.normalizeData(a);c.removeChildren(!0);(d=c.get("highlightedItem"))&&d.set("highlighted",!1);if(a&&a.length){for(d=0;d<a.length;d++)b=a[d],c.addChild(b);c=c.get("children");a=this.getValueForAutocomplete();if(this.get("highlightMatchItem"))for(d=0;d<c.length;d++)if(c[d].get("textContent")===a){c[d].set("highlighted",!0);e=!0;break}if(!e&&this.get("autoHighlightFirst"))for(d=0;d<c.length;d++)if(!c[d].get("disabled")){c[d].set("highlighted",!0);break}this.set("collapsed",!1);this.fire("afterRenderData")}else this.set("collapsed",
!0)}var t=a("node"),p=a("component/control"),o=a("./render");a("menu");var l=t.KeyCode;return p.extend([],{initializer:function(){this.publish("afterRenderData",{bubbles:!1})},_savedValue:null,normalizeData:function(a){var b,c,d;if(a&&a.length){a=a.slice(0,this.get("maxItemCount"));b=this.get("format")?this.get("format").call(this,this.getValueForAutocomplete(),a):[];for(d=0;d<a.length;d++)c=a[d],b[d]=f.mix({content:c,textContent:c,value:c},b[d])}return b},bindUI:function(){var a=this;a.get("input").on("valuechange",
s,a);a.on("click",e,a);a.get("menu").onRendered(function(b){var c=a.get("input"),d=b.get("el"),b=b.get("contentEl");c.attr("aria-owns",d.attr("id"));d.on("focusout",j,a);d.on("focusin",k,a);b.on("mouseover",g,a);b.on("mousedown",h,a)})},destructor:function(){this.get("menu").destroy()},getValueForAutocomplete:function(){return this.get("value")},setValueFromAutocomplete:function(a,b){this.set("value",a,b)},_onSetValue:function(a,b){var c;b.causedByTimer?(c=this.getValueForAutocomplete(),void 0===
c?this.set("collapsed",!0):(this._savedValue=c,this.sendRequest(c))):this.get("input").val(a)},handleFocusInternal:function(){var a;m(this);this.get("invalidEl")&&b(this,!1);(a=this.get("placeholderEl"))&&a.hide()},handleBlurInternal:function(a){var d=this,e=d.get("placeholderEl");d.callSuper(a);c(d);d.get("invalidEl")&&d.validate(function(a,c){a?!d.get("focused")&&c===d.get("value")&&b(d,a):b(d,!1)});e&&!d.get("value")&&e.show()},handleMouseDownInternal:function(a){var b,c;this.callSuper(a);b=a.target;
if((c=this.get("trigger"))&&(c[0]===b||c.contains(b)))this.get("collapsed")?(this.focus(),this.sendRequest("")):this.set("collapsed",!0),a.preventDefault()},handleKeyDownInternal:function(a){var b,c=a.keyCode,e,g,h=this.get("menu");this.get("input");b=this.get("updateInputOnDownUp");if(h.get("visible")){e=h.get("highlightedItem");if(b&&e&&(g=h.get("children"),c===l.DOWN&&e===d(g.concat().reverse())||c===l.UP&&e===d(g)))return this.setValueFromAutocomplete(this._savedValue),e.set("highlighted",!1),
!0;g=h.handleKeyDownInternal(a);e=h.get("highlightedItem");if(c===l.ESC)return this.set("collapsed",!0),b&&this.setValueFromAutocomplete(this._savedValue),!0;b&&f.inArray(c,[l.DOWN,l.UP])&&this.setValueFromAutocomplete(e.get("textContent"));return c===l.TAB&&e&&(e.handleClickInternal(a),this.get("multiple"))?!0:g}if(c===l.DOWN||c===l.UP)if(a=this.getValueForAutocomplete(),void 0!==a)return this.sendRequest(a),!0},validate:function(a){var b=this.get("validator"),c=this.getValueForAutocomplete();b?
b(c,function(b){a(b,c)}):a(!1,c)},sendRequest:function(a){this.get("dataSource").fetchData(a,i,this)},_onSetCollapsed:function(a){var b=this.$el,c=this.get("menu");a?c.hide():(m(this),c.get("visible")||(this.get("matchElWidth")&&(c.render(),a=c.get("el"),a=(parseInt(a.css("borderLeftWidth"))||0)+(parseInt(a.css("borderRightWidth"))||0),c.set("width",b[0].offsetWidth-a)),c.show()))}},{ATTRS:{input:{},value:{value:"",sync:0,view:1},trigger:{},placeholder:{view:1},placeholderEl:{},validator:{},invalidEl:{},
allowTextSelection:{value:!0},hasTrigger:{value:!0,view:1},menu:{value:{},getter:function(a){a.isControl||(a.xclass=a.xclass||"popupmenu",a=this.createComponent(a),this.setInternal("menu",a));return a},setter:function(a){if(a.isControl){a.setInternal("parent",this);var b={node:this.$el,points:["bl","tl"],overflow:{adjustX:1,adjustY:1}};f.mix(a.get("align"),b,!1)}}},collapsed:{view:1,value:!0},dataSource:{},maxItemCount:{value:99999},matchElWidth:{value:!0},format:{},updateInputOnDownUp:{value:!0},
autoHighlightFirst:{},highlightMatchItem:{value:!0},xrender:{value:o}},xclass:"combobox"})});
KISSY.add("combobox/cursor",["node"],function(f,a){function d(a){var b=g;b||(b=j(k));"textarea"===""+a[0].type.toLowerCase()?b.css("width",a.css("width")):b.css("width",9999);f.each(h,function(c){b.css(c,a.css(c))});g||b.insertBefore(a[0].ownerDocument.body.firstChild);return g=b}var j=a("node").all,k='<div style="z-index:-9999;overflow:hidden;position: fixed;left:-9999px;top:-9999px;opacity:0;white-space:pre-wrap;word-wrap:break-word;"></div>',g,h="paddingLeft,paddingTop,paddingBottom,paddingRight,marginLeft,marginTop,marginBottom,marginRight,borderLeftStyle,borderTopStyle,borderBottomStyle,borderRightStyle,borderLeftWidth,borderTopWidth,borderBottomWidth,borderRightWidth,line-height,outline,height,fontFamily,fontSize,fontWeight,fontVariant,fontStyle".split(",");
return function(a){var b=j(a),a=b[0],c=a.ownerDocument,g=j(c),h=a.scrollTop,i=a.scrollLeft;if(c.selection)return a=c.selection.createRange(),{left:a.boundingLeft+i+g.scrollLeft(),top:a.boundingTop+h+a.boundingHeight+g.scrollTop()};g=b.offset();if("textarea"!==a.type)return g.top+=a.offsetHeight,g;c=d(b);b=a.selectionStart;c.html(f.escapeHtml(a.value.substring(0,b-1))+"<span>x</span>");c.offset(g);g=c.last();a=g.offset();a.top+=g.height();0<b&&(a.left+=g.width());a.top-=h;a.left-=i;return a}});
KISSY.add("combobox/multi-value-combobox",["./cursor","./control"],function(f,a){function d(a,c){return c&&-1!==a.indexOf(c)}function j(a){a.newVal&&a.target===this.get("menu")&&this.alignWithCursor()}function k(a){var c=a.get("input"),e=a.get("value"),f=[],i=[],k=a.get("literal"),j=a.get("separator"),a=a.get("separatorType"),o=!1,l=a!==g,c=c.prop("selectionStart"),q,n,r=-1;for(q=0;q<e.length;q++)(n=e.charAt(q),k&&n===k&&(o=!o),o)?i.push(n):(q===c&&(r=f.length),l&&h.test(n))?(i.length&&f.push(i.join("")),
i=[],i.push(n)):d(j,n)?a===g?(i.push(n),i.length&&f.push(i.join("")),i=[]):(i.length&&f.push(i.join("")),i=[],i.push(n)):i.push(n);i.length&&f.push(i.join(""));f.length||f.push("");-1===r&&(a===g&&d(j,n)&&f.push(""),r=f.length-1);return{tokens:f,cursorPosition:c,tokenIndex:r}}var g="suffix",h=/\s|\xa0/,e=a("./cursor");return a("./control").extend({syncUI:function(){var a;this.get("alignWithCursor")&&(a=this.get("menu"),a.setInternal("align",null),a.on("beforeVisibleChange",j,this))},getValueForAutocomplete:function(){var a=
k(this),c=a.tokens,h=a.tokenIndex,a=this.get("separator"),f=this.get("separatorType"),c=c[h],h=c.length-1;if(f!==g)if(d(a,c.charAt(0)))c=c.slice(1);else return;else f===g&&d(a,c.charAt(h))&&(c=c.slice(0,h));return c},setValueFromAutocomplete:function(a,c){var f=this.get("input"),e=k(this),i=e.tokens,e=Math.max(0,e.tokenIndex),j=this.get("separator"),p;p=this.get("separatorType");var o=i[e+1]||"",l=i[e];if(p!==g){if(i[e]=l.charAt(0)+a,a&&(!o||!h.test(o.charAt(0))))i[e]+=" "}else i[e]=a,p=l.length-
1,d(j,l.charAt(p))?i[e]+=l.charAt(p):1===j.length&&(i[e]+=j);e=i.slice(0,e+1).join("").length;this.set("value",i.join(""),c);f.prop("selectionStart",e);f.prop("selectionEnd",e)},alignWithCursor:function(){var a=this.get("menu"),c;c=this.get("input");c=e(c);a.move(c.left,c.top)}},{ATTRS:{separator:{value:",;"},separatorType:{value:g},literal:{value:'"'},alignWithCursor:{}},xclass:"multi-value-combobox"})});
KISSY.add("combobox/filter-select",["./control"],function(f,a,d,j){f=a("./control");j.exports=f.extend({validate:function(a){var d=this;d.callSuper(function(h,e){h?a(h,e):d.get("dataSource").fetchData(e,function(b){a:{if(b=d.normalizeData(b))for(var c=0;c<b.length;c++)if(b[c].textContent===e){b=b[c];break a}b=!1}a(b?"":d.get("invalidMessage"),e,b)})})}},{ATTRS:{invalidMessage:{value:"invalid input"}}})});
KISSY.add("combobox/local-data-source",["attribute"],function(f,a){return a("attribute").extend({fetchData:function(a,f,k){var g=this.get("parse"),h=this.get("data"),h=g(a,h);f.call(k,h)}},{ATTRS:{data:{value:[]},parse:{value:function(a,j){var k=[],g=0;if(!a)return j;f.each(j,function(f){-1!==f.indexOf(a)&&k.push(f);g++});return k}}}})});
KISSY.add("combobox/remote-data-source",["io","attribute"],function(f,a){var d=a("io");return a("attribute").extend({fetchData:function(a,f,g){var h=this,e,b=h.get("paramName"),c=h.get("parse"),m=h.get("cache"),s=h.get("allowEmpty");h.caches=h.caches||{};h.io&&(h.io.abort(),h.io=null);if(!a&&!0!==s)return f.call(g,[]);if(m&&(e=h.caches[a]))return f.call(g,e);e=h.get("xhrCfg");e.data=e.data||{};e.data[b]=a;e.success=function(b){c&&(b=c(a,b));h.setInternal("data",b);m&&(h.caches[a]=b);f.call(g,b)};
h.io=d(e)}},{ATTRS:{paramName:{value:"q"},allowEmpty:{},cache:{},parse:{},xhrCfg:{value:{}}}})});
KISSY.add("combobox",["combobox/control","combobox/multi-value-combobox","combobox/filter-select","combobox/local-data-source","combobox/remote-data-source"],function(f,a){var d=a("combobox/control"),j=a("combobox/multi-value-combobox"),k=a("combobox/filter-select"),g=a("combobox/local-data-source"),h=a("combobox/remote-data-source");d.LocalDataSource=g;d.RemoteDataSource=h;d.FilterSelect=k;d.MultiValueComboBox=j;return d});
/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 27 14:01
*/
KISSY.add("component/control/process",["base","promise"],function(f,c){function g(d){d.fire("beforeSyncUI");d.syncUI();d.__callPluginsMethod("pluginSyncUI");d.fire("afterSyncUI")}var k=c("base"),m=c("promise").Defer,h=k.prototype.__getHook,e=f.noop,i=k.extend({bindInternal:e,syncInternal:e,initializer:function(){this._renderedDefer=new m},renderUI:e,syncUI:e,bindUI:e,onRendered:function(d){return this._renderedDefer.promise.then(d)},create:function(){this.get("created")||(this.fire("beforeCreateDom"),
this.createInternal(),this.__callPluginsMethod("pluginCreateDom"),this.fire("afterCreateDom"),this.setInternal("created",!0));return this},createInternal:function(){this.createDom()},render:function(){this.get("rendered")||(this.create(),this.fire("beforeRenderUI"),this.renderUI(),this.__callPluginsMethod("pluginRenderUI"),this.fire("afterRenderUI"),this.fire("beforeBindUI"),i.superclass.bindInternal.call(this),this.bindUI(),this.__callPluginsMethod("pluginBindUI"),this.fire("afterBindUI"),i.superclass.syncInternal.call(this),
g(this),this.setInternal("rendered",!0));return this},sync:function(){g(this)},plug:function(d){var c=this.get("plugins");this.callSuper(d);d=c[c.length-1];this.get("rendered")?(d.pluginCreateDom&&d.pluginCreateDom(this),d.pluginRenderUI&&d.pluginCreateDom(this),d.pluginBindUI&&d.pluginBindUI(this),d.pluginSyncUI&&d.pluginSyncUI(this)):this.get("created")&&d.pluginCreateDom&&d.pluginCreateDom(this);return this}},{__hooks__:{createDom:h("__createDom"),renderUI:h("__renderUI"),bindUI:h("__bindUI"),
syncUI:h("__syncUI")},name:"ComponentProcess",ATTRS:{rendered:{value:!1,setter:function(c){c&&this._renderedDefer.resolve(this)}},created:{value:!1}}});return i});
KISSY.add("component/control/render-xtpl",[],function(){return function(f){var c,g=this;c=this.config.utils;var k=c.runBlockCommand,m=c.renderOutput,h=c.getProperty,e=c.runInlineCommand,i=c.getPropertyOrRunCommand;c='<div id="';var d=i(g,f,{},"id",0,1);c+=m(d,!0);c+='"\n class="';var d={},n=[];n.push("");d.params=n;e=e(g,f,d,"getBaseCssClasses",2);c+=m(e,!0);c+="\n";e={};d=[];n=h(g,f,"elCls",0,3);d.push(n);e.params=d;e.fn=function(a){var b;b="\n ";a=i(g,a,{},".",0,4);b+=m(a,!0);return b+"  \n"};c+=
k(g,f,e,"each",3);c+='\n"\n\n';e={};d=[];n=h(g,f,"elAttrs",0,8);d.push(n);e.params=d;e.fn=function(a){var b;b=" \n ";var c=i(g,a,{},"xindex",0,9);b+=m(c,!0);b+='="';a=i(g,a,{},".",0,9);b+=m(a,!0);return b+'"\n'};c+=k(g,f,e,"each",8);c+='\n\nstyle="\n';e={};d=[];h=h(g,f,"elStyle",0,13);d.push(h);e.params=d;e.fn=function(a){var b;b=" \n ";var c=i(g,a,{},"xindex",0,14);b+=m(c,!0);b+=":";a=i(g,a,{},".",0,14);b+=m(a,!0);return b+";\n"};c+=k(g,f,e,"each",13);return c+'\n">'}});
KISSY.add("component/control/render",["node","xtemplate/runtime","./process","./render-xtpl","component/manager"],function(f,c){function g(j){"number"===typeof j&&(j+="px");return j}function k(j){j||(j=[""]);"string"===typeof j&&(j=j.split(/\s+/));return j}function m(j,a,b){for(var c="",d=0,e=b.length,a=j+a;d<e;d++)j=(j=b[d])?"-"+j:j,c+=" "+a+j;return c}function h(j){var a;j.target===this.control&&(a=this[o+j.type.slice(5).slice(0,-6)],a.call(this,j.newVal,j))}function e(a,l){return this.config.view.getBaseCssClasses(l.params[0])}
function i(a,l){return this.config.view.getBaseCssClass(l.params[0])}var d=c("node"),n=c("xtemplate/runtime"),a=c("./process"),b=c("./render-xtpl"),q=c("component/manager"),o="_onSet",p=f.trim,r=d.all,s=f.UA,t=f.Env.host.document;return a.extend({isRender:!0,createInternal:function(){var a=this.control.get("srcNode");a?this.decorateDom(a):this.callSuper()},beforeCreateDom:function(a){var l=this.control,b,c,d,e=l.get("elAttrs"),f=l.get("elCls"),h;b=l.getAttrs();h=l.get("elStyle");var m=l.get("elCls");
for(c in b)d=b[c],d.view&&(a[c]=l.get(c));b=a.width;c=a.height;d=a.visible;a=a.zIndex;b&&(h.width=g(b));c&&(h.height=g(c));a&&(h["z-index"]=a);d||m.push(this.getBaseCssClasses("hidden"));if(h=l.get("disabled"))f.push(this.getBaseCssClasses("disabled")),e["aria-disabled"]="true";l.get("highlighted")&&f.push(this.getBaseCssClasses("hover"));l.get("focusable")&&(9>s.ieMode&&(e.hideFocus="true"),e.tabindex=h?"-1":"0")},createDom:function(){this.beforeCreateDom(this.renderData={},this.childrenElSelectors=
{},this.renderCommands={getBaseCssClasses:e,getBaseCssClass:i});var a=this.control,l;l=this.renderTpl(b)+this.renderTpl(this.get("contentTpl"))+"</div>";a.setInternal("el",this.$el=r(l));this.el=this.$el[0];this.fillChildrenElsBySelectors()},decorateDom:function(a){var b=this.control;a.attr("id")||a.attr("id",b.get("id"));var c=this.constructor.HTML_PARSER,d,e;for(d in c)e=c[d],"function"===typeof e?(e=e.call(this,a),void 0!==e&&b.setInternal(d,e)):"string"===typeof e?b.setInternal(d,a.one(e)):f.isArray(e)&&
e[0]&&b.setInternal(d,a.all(e[0]));b.setInternal("el",this.$el=a);this.el=a[0]},renderUI:function(){var a=this.control,b=this.$el;if(!a.get("srcNode")){var c=a.get("render");(a=a.get("elBefore"))?b.insertBefore(a,void 0):c?b.appendTo(c,void 0):b.appendTo(t.body,void 0)}},bindUI:function(){var a=this.control,b=a.getAttrs(),c,d;for(c in b){d=b[c];var e=f.ucfirst(c),g=this[o+e];if(d.view&&g)a.on("after"+e+"Change",h,this)}},destructor:function(){this.$el&&this.$el.remove()},$:function(a){return this.$el.all(a)},
fillChildrenElsBySelectors:function(a){var b=this.$el,c=this.control,d,e,a=a||this.childrenElSelectors;for(d in a)e=a[d],"function"===typeof e?c.setInternal(d,e(b)):c.setInternal(d,this.$(f.substitute(e,this.renderData))),delete a[d]},renderTpl:function(a,b,c){b=b||this.renderData;c=c||this.renderCommands;return(new (this.get("xtemplate"))(a,{control:this.control,view:this,commands:c})).render(b)},getComponentConstructorByNode:function(a,b){var c=b[0].className;return c?(c=c.replace(RegExp("\\b"+
a,"ig"),""),q.getConstructorByXClass(c)):null},getComponentCssClasses:function(){if(this.componentCssClasses)return this.componentCssClasses;for(var a=this.control.constructor,b,c=[];a&&!a.prototype.hasOwnProperty("isControl");)(b=a.xclass)&&c.push(b),a=a.superclass&&a.superclass.constructor;return this.componentCssClasses=c},getBaseCssClasses:function(a){for(var a=k(a),b=this.getComponentCssClasses(),c=0,d=this.get("control"),e="",f=b.length,d=d.get("prefixCls");c<f;c++)e+=m(d,b[c],a);return p(e)},
getBaseCssClass:function(a){return p(m(this.control.get("prefixCls"),this.getComponentCssClasses()[0],k(a)))},getKeyEventTarget:function(){return this.$el},_onSetWidth:function(a){this.$el.width(a)},_onSetHeight:function(a){this.$el.height(a)},_onSetContent:function(a){var b=this.$el;b.html(a);this.get("allowTextSelection")||b.unselectable()},_onSetVisible:function(a){var b=this.$el,c=this.getBaseCssClasses("hidden");a?b.removeClass(c):b.addClass(c)},_onSetHighlighted:function(a){var b=this.getBaseCssClasses("hover");
this.$el[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.control,c=this.getBaseCssClasses("disabled");this.$el[a?"addClass":"removeClass"](c).attr("aria-disabled",a);b.get("focusable")&&this.getKeyEventTarget().attr("tabindex",a?-1:0)},_onSetActive:function(a){var b=this.getBaseCssClasses("active");this.$el[a?"addClass":"removeClass"](b).attr("aria-pressed",!!a)},_onSetFocused:function(a){var b=this.$el,c=this.getBaseCssClasses("focused");b[a?"addClass":"removeClass"](c)},_onSetZIndex:function(a){this.$el.css("z-index",
a)}},{__hooks__:{decorateDom:a.prototype.__getHook("__decorateDom"),beforeCreateDom:a.prototype.__getHook("__beforeCreateDom")},extend:function l(b,c,d){var e,g={};e=a.extend.apply(this,arguments);e.HTML_PARSER=e.HTML_PARSER||{};f.isArray(b)&&(f.each(b.concat(e),function(a){a&&f.each(a.HTML_PARSER,function(a,b){g[b]=a})}),e.HTML_PARSER=g);f.mix(e.HTML_PARSER,this.HTML_PARSER,!1);e.extend=l;return e},ATTRS:{control:{setter:function(a){this.control=a}},xtemplate:{value:n},contentTpl:{value:function(a){return a.get("content")||
""}}},HTML_PARSER:{id:function(a){return(a=a[0].id)?a:void 0},content:function(a){return a.html()},disabled:function(a){return a.hasClass(this.getBaseCssClass("disabled"))}},name:"render"})});
KISSY.add("component/control",["node","./control/process","component/manager","./control/render"],function(f,c){function g(){var a,b=this;do a=b.ATTRS,b=b.superclass;while(!a||!a.xrender);return a.xrender.value}var k=c("node"),m=c("./control/process"),h=c("component/manager"),e=c("./control/render"),i=f.UA.ieMode,d=k.Gesture,n=f.Features.isTouchGestureSupported(),e=m.extend({isControl:!0,createDom:function(){var a=this.get("xrender"),b=this.get("view"),c=this.get("id");b?b.set("control",this):this.set("view",
this.view=b=new a({control:this}));b.create();a=b.getKeyEventTarget();this.get("allowTextSelection")||a.unselectable();h.addComponent(c,this)},renderUI:function(){this.view.render()},bindUI:function(){var a=this.view.getKeyEventTarget();if(this.get("focusable"))a.on("focus",this.handleFocus,this).on("blur",this.handleBlur,this).on("keydown",this.handleKeydown,this);if(this.get("handleMouseEvents")){a=this.$el;a.on("mouseenter",this.handleMouseEnter,this).on("mouseleave",this.handleMouseLeave,this).on("contextmenu",
this.handleContextMenu,this);a.on(d.start,this.handleMouseDown,this).on(d.end,this.handleMouseUp,this).on(d.tap,this.handleClick,this);if(d.cancel)a.on(d.cancel,this.handleMouseUp,this);if(9>i)a.on("dblclick",this.handleDblClick,this)}},sync:function(){this.fire("beforeSyncUI");this.syncUI();this.view.sync();this.__callPluginsMethod("pluginSyncUI");this.fire("afterSyncUI")},createComponent:function(a,b){return h.createComponent(a,b||this)},_onSetFocused:function(a){var b=this.view.getKeyEventTarget()[0];
a?b.focus():b.ownerDocument.activeElement===b&&b.ownerDocument.body.focus()},_onSetX:function(a){this.$el.offset({left:a})},_onSetY:function(a){this.$el.offset({top:a})},_onSetVisible:function(a){this.fire(a?"show":"hide")},show:function(){this.render();this.set("visible",!0);return this},hide:function(){this.set("visible",!1);return this},focus:function(){this.get("focusable")&&this.set("focused",!0)},blur:function(){this.get("focusable")&&this.set("focused",!1)},move:function(a,b){this.set({x:a,
y:b})},handleDblClick:function(a){this.get("disabled")||this.handleDblClickInternal(a)},handleDblClickInternal:function(a){this.handleClickInternal(a)},handleMouseEnter:function(a){this.get("disabled")||this.handleMouseEnterInternal(a)},handleMouseEnterInternal:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.get("disabled")||this.handleMouseLeaveInternal(a)},handleMouseLeaveInternal:function(a){this.set("active",!1);this.set("highlighted",!a)},handleMouseDown:function(a){this.get("disabled")||
this.handleMouseDownInternal(a)},handleMouseDownInternal:function(a){var b;if(1===a.which||n)this.get("activeable")&&this.set("active",!0),this.get("focusable")&&this.focus(),!this.get("allowTextSelection")&&-1!==a.originalEvent.type.toLowerCase().indexOf("mouse")&&(b=(b=a.target.nodeName)&&b.toLowerCase(),"input"!==b&&"textarea"!==b&&"button"!==b&&a.preventDefault())},handleMouseUp:function(a){this.get("disabled")||this.handleMouseUpInternal(a)},handleMouseUpInternal:function(a){this.get("active")&&
(1===a.which||n)&&this.set("active",!1)},handleContextMenu:function(a){this.get("disabled")||this.handleContextMenuInternal(a)},handleContextMenuInternal:function(){},handleFocus:function(){this.get("disabled")||this.handleFocusInternal()},handleFocusInternal:function(){this.focus();this.fire("focus")},handleBlur:function(){this.get("disabled")||this.handleBlurInternal()},handleBlurInternal:function(){this.blur();this.fire("blur")},handleKeydown:function(a){if(!this.get("disabled")&&this.handleKeyDownInternal(a))return a.halt(),
!0},handleKeyDownInternal:function(a){if(a.keyCode===k.KeyCode.ENTER)return this.handleClickInternal(a)},handleClick:function(a){this.get("disabled")||this.handleClickInternal(a)},handleClickInternal:function(){this.get("focusable")&&this.focus()},destructor:function(){h.removeComponent(this.get("id"));this.view?this.view.destroy():this.get("srcNode")&&this.get("srcNode").remove()}},{name:"control",ATTRS:{id:{view:1,valueFn:function(){return f.guid("ks-component")}},content:{view:1,value:""},width:{view:1},
height:{view:1},elCls:{view:1,value:[],setter:function(a){"string"===typeof a&&(a=a.split(/\s+/));return a||[]}},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{},el:{setter:function(a){this.$el=a;this.el=a[0]}},x:{},y:{},xy:{setter:function(a){var b=f.makeArray(a);b.length&&(void 0!==b[0]&&this.set("x",b[0]),void 0!==b[1]&&this.set("y",b[1]));return a},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{view:1},render:{},visible:{sync:0,value:!0,view:1},srcNode:{setter:function(a){return k.all(a)}},
handleMouseEvents:{value:!0},focusable:{value:!0,view:1},allowTextSelection:{value:!1},activeable:{value:!0},focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},prefixCls:{view:1,value:f.config("component/prefixCls")||"ks-"},prefixXClass:{},parent:{setter:function(a,b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}},disabled:{view:1,value:!1},xrender:{value:e},view:{setter:function(a){this.view=a}}}});e.getDefaultRender=g;e.extend=function b(c,d,e){var i=f.makeArray(arguments),
k,n=i[i.length-1];if(k=n.xclass)n.name=k;i=m.extend.apply(this,i);k&&h.setConstructorByXClass(k,i);i.extend=b;i.getDefaultRender=g;return i};return e});
/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 22 12:17
*/
KISSY.add("component/manager",[],function(){var h=0,e,g={},c={};return e={__instances:c,addComponent:function(a,b){c[a]=b},removeComponent:function(a){delete c[a]},getComponent:function(a){return c[a]},createComponent:function(a,b){var d;if(a){if(!a.isControl&&b&&(a.prefixCls||(a.prefixCls=b.get("prefixCls")),!a.xclass&&a.prefixXClass))a.xclass=a.prefixXClass,a.xtype&&(a.xclass+="-"+a.xtype);if(!a.isControl&&(d=a.xclass))d=e.getConstructorByXClass(d),a=new d(a);a.isControl&&b&&a.setInternal("parent",
b)}return a},getConstructorByXClass:function(a){var a=a.split(/\s+/),b=-1,d,c,f,e=null;for(c=0;c<a.length;c++)if((f=g[a[c]])&&(d=f.priority)>b)b=d,e=f.constructor;return e},setConstructorByXClass:function(a,b){g[a]={constructor:b,priority:h++}}}});
/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 22 12:29
*/
KISSY.add("menu/menu-render",["component/container"],function(e,a){return a("component/container").getDefaultRender().extend({beforeCreateDom:function(a){a.elAttrs.role="menu"},containsElement:function(a){var c=this.$el;return c&&(c[0]===a||c.contains(a))}})});
KISSY.add("menu/control",["node","component/container","component/extension/delegate-children","./menu-render"],function(e,a){function b(a){a.target.isMenu&&(a=a.newVal,this.el.setAttribute("aria-activedescendant",a&&a.el.id||""))}var c=a("node"),h=a("component/container"),d=a("component/extension/delegate-children"),g=a("./menu-render"),i=c.KeyCode;return h.extend([d],{isMenu:1,_onSetHighlightedItem:function(a,f){var d;a&&f&&(d=f.prevVal)&&d.set("highlighted",!1,{data:{byPassSetHighlightedItem:1}})},
_onSetVisible:function(a,f){this.callSuper(f);var d;!a&&(d=this.get("highlightedItem"))&&d.set("highlighted",!1)},bindUI:function(){this.on("afterHighlightedItemChange",b,this)},getRootMenu:function(){return this},handleMouseEnterInternal:function(a){this.callSuper(a);if((a=this.getRootMenu())&&a._popupAutoHideTimer)clearTimeout(a._popupAutoHideTimer),a._popupAutoHideTimer=null},handleBlurInternal:function(a){this.callSuper(a);var f;(f=this.get("highlightedItem"))&&f.set("highlighted",!1)},_getNextEnabledHighlighted:function(a,
f){var d=this.get("children"),b=d.length,c=a;do{var g=d[a];if(!g.get("disabled")&&!1!==g.get("visible"))return d[a];a=(a+f+b)%b}while(a!==c)},handleKeyDownInternal:function(a){var f=this.get("highlightedItem");if(f&&f.handleKeyDownInternal(a))return!0;var d=this.get("children"),b=d.length;if(0!==b){var c;switch(a.keyCode){case i.ESC:(f=this.get("highlightedItem"))&&f.set("highlighted",!1);break;case i.HOME:c=this._getNextEnabledHighlighted(0,1);break;case i.END:c=this._getNextEnabledHighlighted(b-
1,-1);break;case i.UP:f?(a=e.indexOf(f,d),b=(a-1+b)%b):b-=1;c=this._getNextEnabledHighlighted(b,-1);break;case i.DOWN:f?(a=e.indexOf(f,d),b=(a+1+b)%b):b=0,c=this._getNextEnabledHighlighted(b,1)}if(c)return c.set("highlighted",!0,{data:{fromKeyboard:1}}),!0}},containsElement:function(a){if(!this.get("visible")||!this.$el)return!1;if(this.view.containsElement(a))return!0;for(var f=this.get("children"),b=0,d=f.length;b<d;b++){var c=f[b];if(c.containsElement&&c.containsElement(a))return!0}return!1}},
{ATTRS:{highlightedItem:{value:null},xrender:{value:g},defaultChildCfg:{value:{xclass:"menuitem"}}},xclass:"menu"})});
KISSY.add("menu/menuitem-render",["component/control"],function(e,a){return a("component/control").getDefaultRender().extend({beforeCreateDom:function(a){a.elAttrs.role=a.selectable?"menuitemradio":"menuitem";a.selected&&a.elCls.push(this.getBaseCssClasses("selected"))},_onSetSelected:function(a){var c=this.getBaseCssClasses("selected");this.$el[a?"addClass":"removeClass"](c)},containsElement:function(a){var c=this.$el;return c&&(c[0]===a||c.contains(a))}},{HTML_PARSER:{selectable:function(a){return a.hasClass(this.getBaseCssClass("selectable"))}}})});
KISSY.add("menu/menuitem",["component/control","./menuitem-render","node"],function(e,a){var b=a("component/control"),c=a("./menuitem-render"),h=a("node").all;return b.extend({isMenuItem:1,handleClickInternal:function(){this.callSuper();this.get("selectable")&&this.set("selected",!0);this.fire("click");return!0},_onSetHighlighted:function(a,c){var b=this.get("parent");if(!c||!c.byPassSetHighlightedItem)this.get("rendered")?b.set("highlightedItem",a?this:null):a&&b.set("highlightedItem",this);if(a){var e=
this.$el;(b=e.parent(function(a){return"visible"!==h(a).css("overflow")},b.get("el").parent()))&&e.scrollIntoView(b,{alignWithTop:!0,allowHorizontalScroll:!0,onlyScrollIfNeeded:!0})}},containsElement:function(a){return this.view.containsElement(a)}},{ATTRS:{focusable:{value:!1},handleMouseEvents:{value:!1},selectable:{view:1},value:{},selected:{view:1},xrender:{value:c}},xclass:"menuitem"})});
KISSY.add("menu/check-menuitem-xtpl",["component/extension/content-xtpl"],function(e,a,b,c){return function(b){var d,g;d=this.config.utils;"undefined"!==typeof c&&c.kissy&&(g=c);var e=d.renderOutput,j=d.runInlineCommand;d='<div class="';var f={},k=[];k.push("checkbox");f.params=k;f=j(this,b,f,"getBaseCssClasses",1);d+=e(f,!0);d+='">\n</div>\n';f={};k=[];k.push("component/extension/content-xtpl");f.params=k;g&&(a("component/extension/content-xtpl"),f.params[0]=g.resolveByName(f.params[0]));b=j(this,
b,f,"include",3);return d+=e(b,!1)}});KISSY.add("menu/check-menuitem-render",["./menuitem-render","component/extension/content-render","./check-menuitem-xtpl"],function(e,a){var b=a("./menuitem-render"),c=a("component/extension/content-render"),h=a("./check-menuitem-xtpl");return b.extend([c],{beforeCreateDom:function(a){a.checked&&a.elCls.push(this.getBaseCssClasses("checked"))},_onSetChecked:function(a){var b=this.getBaseCssClasses("checked");this.$el[a?"addClass":"removeClass"](b)}},{ATTRS:{contentTpl:{value:h}}})});
KISSY.add("menu/check-menuitem",["./menuitem","./check-menuitem-render"],function(e,a){var b=a("./menuitem"),c=a("./check-menuitem-render");return b.extend({handleClickInternal:function(){this.callSuper();this.set("checked",!this.get("checked"));this.fire("click");return!0}},{ATTRS:{checked:{view:1},xrender:{value:c}},xclass:"check-menuitem"})});
KISSY.add("menu/submenu-xtpl",[],function(){return function(e){var a;a=this.config.utils;var b=a.renderOutput,c=a.runInlineCommand,h=a.getPropertyOrRunCommand;a='<div id="ks-content-';var d=h(this,e,{},"id",0,1);a+=b(d,!0);a+='"\n     class="';var d={},g=[];g.push("content");d.params=g;c=c(this,e,d,"getBaseCssClasses",2);a+=b(c,!0);a+='">';c=h(this,e,{},"content",0,2);a+=b(c,!1);a+='</div>\n<span class="';e=h(this,e,{},"prefixCls",0,3);a+=b(e,!0);return a+'submenu-arrow">\u25ba</span>'}});
KISSY.add("menu/submenu-render",["./submenu-xtpl","./menuitem-render","component/extension/content-render"],function(e,a){var b=a("./submenu-xtpl"),c=a("./menuitem-render"),h=a("component/extension/content-render");return c.extend([h],{decorateDom:function(a){var b=this.control,c=b.get("prefixCls"),a=a.one("."+c+"popupmenu"),e=a[0].ownerDocument.body;e.insertBefore(a[0],e.firstChild);e=this.getComponentConstructorByNode(c,a);b.setInternal("menu",new e({srcNode:a,prefixCls:c}))}},{ATTRS:{contentTpl:{value:b}}})});
KISSY.add("menu/submenu",["node","./menuitem","./submenu-render"],function(e,a){function b(a){var b=a.target;b!==this&&b.isMenuItem&&a.newVal&&(this.clearHidePopupMenuTimers(),this.get("highlighted")||(this.set("highlighted",!0),b.set("highlighted",!1),b.set("highlighted",!0)))}function c(){var a=this.get("menu"),b={node:this.$el,points:["tr","tl"],overflow:{adjustX:1,adjustY:1}};e.mix(a.get("align"),b,!1);a.show();this.el.setAttribute("aria-haspopup",a.get("el").attr("id"))}function h(){this.get("menu").hide()}
var d=a("node"),g=a("./menuitem"),i=a("./submenu-render"),j=d.KeyCode;return g.extend({isSubMenu:1,clearShowPopupMenuTimers:function(){var a;if(a=this._showTimer)a.cancel(),this._showTimer=null},clearHidePopupMenuTimers:function(){var a;if(a=this._dismissTimer)a.cancel(),this._dismissTimer=null},clearSubMenuTimers:function(){this.clearHidePopupMenuTimers();this.clearShowPopupMenuTimers()},bindUI:function(){this.on("afterHighlightedChange",b,this)},handleMouseLeaveInternal:function(){this.set("highlighted",
!1,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")&&(this._dismissTimer=e.later(h,1E3*this.get("menuDelay"),!1,this))},handleMouseEnterInternal:function(){this.set("highlighted",!0,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")||(this._showTimer=e.later(c,1E3*this.get("menuDelay"),!1,this))},_onSetHighlighted:function(a,b){b&&(this.callSuper(b),b.fromMouse||(a&&!b.fromKeyboard?c.call(this):a||h.call(this)))},handleClickInternal:function(){c.call(this);
this.callSuper()},handleKeyDownInternal:function(a){var b=this.get("menu"),d,e=b.get("visible"),g=a.keyCode;if(e){if(!b.handleKeyDownInternal(a))if(g===j.LEFT)this.set("highlighted",!1),this.set("highlighted",!0,{data:{fromKeyboard:1}});else return}else if(g===j.RIGHT)c.call(this),a=b.get("children"),(d=a[0])&&d.set("highlighted",!0,{data:{fromKeyboard:1}});else{if(g===j.ENTER)return this.handleClickInternal(a);return}return!0},containsElement:function(a){return this.get("menu").containsElement(a)},
destructor:function(){var a=this.get("menu");this.clearSubMenuTimers();a.destroy()}},{ATTRS:{menuDelay:{value:0.15},menu:{value:{},getter:function(a){a.isControl||(a.xclass=a.xclass||"popupmenu",a=this.createComponent(a),this.setInternal("menu",a));return a},setter:function(a){a.isControl&&a.setInternal("parent",this)}},xrender:{value:i}},xclass:"submenu"})});
KISSY.add("menu/popupmenu-render",["component/extension/content-render","./menu-render"],function(e,a){var b=a("component/extension/content-render");return a("./menu-render").extend([b])});
KISSY.add("menu/popupmenu",["component/extension/align","component/extension/shim","./control","./popupmenu-render"],function(e,a){var b=a("component/extension/align"),c=a("component/extension/shim"),h=a("./control"),d=a("./popupmenu-render");return h.extend([c,b],{getRootMenu:function(){var a=this,b;do b=a,a=a.get("parent");while(a&&(a.isMenuItem||a.isMenu));return b===this?null:b},handleMouseLeaveInternal:function(a){this.callSuper(a);if(this.get("autoHideOnMouseLeave")){var b=this.getRootMenu();
b&&(clearTimeout(b._popupAutoHideTimer),b._popupAutoHideTimer=setTimeout(function(){var a;(a=b.get("highlightedItem"))&&a.set("highlighted",!1)},1E3*this.get("parent").get("menuDelay")))}},isPopupMenu:1,handleBlurInternal:function(a){this.callSuper(a);this.hide()}},{ATTRS:{focusable:{value:!1},autoHideOnMouseLeave:{},contentEl:{},visible:{value:!1},xrender:{value:d}},xclass:"popupmenu"})});
KISSY.add("menu",["menu/control","menu/menuitem","menu/check-menuitem","menu/submenu","menu/popupmenu"],function(e,a){var b=a("menu/control"),c=a("menu/menuitem"),h=a("menu/check-menuitem"),d=a("menu/submenu"),g=a("menu/popupmenu");b.Item=c;b.CheckItem=h;b.SubMenu=d;b.PopupMenu=g;return b});
/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 22 12:16
*/
KISSY.add("component/container/render",["component/control","component/manager"],function(g,d){var f=d("component/control"),i=d("component/manager");return f.getDefaultRender().extend([],{decorateDom:function(){var d=this,f=d.getChildrenContainerEl(),a=d.control,b=a.get("defaultChildCfg"),c=b.prefixCls,e=b.xclass,h=[];f.children().each(function(a){var f=d.getComponentConstructorByNode(c,a)||e&&i.getConstructorByXClass(e);f&&h.push(new f(g.merge(b,{srcNode:a})))});a.set("children",h)},getChildrenContainerEl:function(){return this.$el}},
{name:"ContainerRender"})});
KISSY.add("component/container",["component/control","./container/render"],function(g,d){function f(a){if(a.target===this){var b=a.component,c=this.get("children"),a=a.index;c.splice(a,0,b);c=this.get("children");b=c[a];b.setInternal("parent",this);this.get("rendered")&&this.renderChild(a);this.fire("afterAddChild",{component:b,index:a})}}function i(a){if(a.target===this){var b=a.component,c,e,h=a.destroy,d=this.get("children"),a=a.index;-1!==a&&d.splice(a,1);b.setInternal("parent",null);if(h)b.destroy&&
b.destroy();else if(b.get&&(e=b.el))(c=e.parentNode)&&c.removeChild(e);this.fire("afterRemoveChild",{component:b,index:a})}}var j=d("component/control"),k=d("./container/render");return j.extend({isContainer:!0,initializer:function(){var a=this.get("prefixCls"),b=this.get("defaultChildCfg");this.publish("beforeAddChild",{defaultFn:f});this.publish("beforeRemoveChild",{defaultFn:i});b.prefixCls=b.prefixCls||a},createDom:function(){this.createChildren()},renderUI:function(){this.renderChildren()},renderChildren:function(){var a,
b=this.get("children");for(a=0;a<b.length;a++)this.renderChild(a)},createChildren:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)this.createChild(a)},addChild:function(a,b){var c=this.get("children");void 0===b&&(b=c.length);this.fire("beforeAddChild",{component:a,index:b})},renderChild:function(a){var b=this.get("children");this.createChild(a).render();this.fire("afterRenderChild",{component:b[a],index:a})},createChild:function(a){var b,c,e,d;b=this.get("children")[a];d=this.view.getChildrenContainerEl();
e=d[0];c=e.children[a]||null;b.get("rendered")?(d=b.el,d.parentNode!==e&&e.insertBefore(d,c)):(c?b.set("elBefore",c):b.set("render",d),b.create());this.fire("afterCreateChild",{component:b,index:a});return b},removeChild:function(a,b){void 0===b&&(b=!0);this.fire("beforeRemoveChild",{component:a,index:g.indexOf(a,this.get("children")),destroy:b})},removeChildren:function(a){var b,c=[].concat(this.get("children"));for(b=0;b<c.length;b++)this.removeChild(c[b],a);return this},getChildAt:function(a){return this.get("children")[a]||
null},destructor:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)b[a].destroy&&b[a].destroy()}},{ATTRS:{children:{value:[],getter:function(a){var b=null,c,d;for(c=0;c<a.length;c++)d=a[c],d.isControl||(b=b||this.get("defaultChildCfg"),g.mix(d,b,!1),a[c]=this.createComponent(d));return a},setter:function(a){var b,c;for(b=0;b<a.length;b++)c=a[b],c.isControl&&c.setInternal("parent",this)}},defaultChildCfg:{value:{}},xrender:{value:k}},name:"container"})});
/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 22 12:16
*/
KISSY.add("component/extension/delegate-children",["node","component/manager"],function(d,e){function h(a){a.target===this&&a.component.$el.addClass(this.__childClsTag)}function i(a){a.target===this&&(a=a.component.$el)&&a.removeClass(this.__childClsTag)}function f(){this.__childClsTag=d.guid("ks-component-child");this.on("afterRenderChild",h,this).on("afterRemoveChild",i,this)}var j=e("node"),k=e("component/manager"),g=d.UA.ieMode,c=j.Gesture;d.Features.isTouchEventSupported();d.augment(f,{handleChildrenEvents:function(a){if(!this.get("disabled")){var b=
this.getOwnerControl(a);if(b&&!b.get("disabled"))switch(a.stopPropagation(),a.type){case c.start:b.handleMouseDown(a);break;case c.end:b.handleMouseUp(a);break;case c.tap:b.handleClick(a);break;case "mouseenter":b.handleMouseEnter(a);break;case "mouseleave":b.handleMouseLeave(a);break;case "contextmenu":b.handleContextMenu(a);break;case "dblclick":b.handleDblClick(a)}}},__bindUI:function(){var a=c.start+" "+c.end+" "+c.tap;c.cancel&&(a+=" "+c.cancel);a+=" mouseenter mouseleave contextmenu "+(g&&9>
g?"dblclick ":"");this.$el.delegate(a,"."+this.__childClsTag,this.handleChildrenEvents,this)},getOwnerControl:function(a){return k.getComponent(a.currentTarget.id)}});return f});
/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 22 12:16
*/
KISSY.add("component/extension/content-render",["component/extension/content-xtpl"],function(e,g){function f(a){var b=a.control,c=b.get("contentEl");a.$contentEl=b.$contentEl=c;a.contentEl=b.contentEl=c[0]}function d(){}var h=g("component/extension/content-xtpl");d.prototype={__beforeCreateDom:function(a,b){e.mix(b,{contentEl:"#ks-content-{id}"})},__createDom:function(){f(this)},__decorateDom:function(){f(this)},getChildrenContainerEl:function(){return this.control.get("contentEl")},_onSetContent:function(a){var b=
this.control,c=b.$contentEl;c.html(a);b.get("allowTextSelection")||c.unselectable()}};e.mix(d,{ATTRS:{contentTpl:{value:h}},HTML_PARSER:{content:function(a){return a.one("."+this.getBaseCssClass("content")).html()},contentEl:function(a){return a.one("."+this.getBaseCssClass("content"))}}});return d});
/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 22 12:16
*/
KISSY.add("component/extension/content-xtpl",[],function(){return function(b){var a;a=this.config.utils;var d=a.renderOutput,e=a.runInlineCommand,f=a.getPropertyOrRunCommand;a='<div id="ks-content-';var c=f(this,b,{},"id",0,1);a+=d(c,!0);a+='"\n           class="';var c={},g=[];g.push("content");c.params=g;e=e(this,b,c,"getBaseCssClasses",2);a+=d(e,!0);a+='">';b=f(this,b,{},"content",0,2);a+=d(b,!1);return a+"</div>"}});
/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 22 12:16
*/
KISSY.add("component/extension/align",["node"],function(k,u){function m(a){var c=a.ownerDocument.body,d=j(a).css("position");if(!("fixed"===d||"absolute"===d))return"html"===a.nodeName.toLowerCase()?null:a.parentNode;for(a=a.parentNode;a&&a!==c;a=a.parentNode)if(d=j(a).css("position"),"static"!==d)return a;return null}function n(a){var c,d,b={left:0,right:Infinity,top:0,bottom:Infinity},f;f=a.ownerDocument;d=j(f).getWindow();c=f.body;for(f=f.documentElement;a=m(a);)if((!v.ie||0!==a.clientWidth)&&
a!==c&&a!==f&&"visible"!==j(a).css("overflow")){var h=j(a).offset();h.left+=a.clientLeft;h.top+=a.clientTop;b.top=Math.max(b.top,h.top);b.right=Math.min(b.right,h.left+a.clientWidth);b.bottom=Math.min(b.bottom,h.top+a.clientHeight);b.left=Math.max(b.left,h.left)}f=d.scrollLeft();a=d.scrollTop();b.left=Math.max(b.left,f);b.top=Math.max(b.top,a);c=d.width();d=d.height();b.right=Math.min(b.right,f+c);b.bottom=Math.min(b.bottom,a+d);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null}function o(a,
c,d,b){var f,h;f=a.left;h=a.top;c=p(c,d[0]);a=p(a,d[1]);a=[a.left-c.left,a.top-c.top];return{left:f-a[0]+ +b[0],top:h-a[1]+ +b[1]}}function q(a,c,d){var b=[];k.each(a,function(a){b.push(a.replace(c,function(a){return d[a]}))});return b}function l(){}function r(a){var c,d;c=a[0];k.isWindow(c)?(a=j(c).getWindow(),c={left:a.scrollLeft(),top:a.scrollTop()},d=a.width(),a=a.height()):(c=a.offset(),d=a.outerWidth(),a=a.outerHeight());c.width=d;c.height=a;return c}function p(a,c){var d=c.charAt(0),b=c.charAt(1),
f=a.width,h=a.height,e,g;e=a.left;g=a.top;"c"===d?g+=h/2:"b"===d&&(g+=h);"c"===b?e+=f/2:"r"===b&&(e+=f);return{left:e,top:g}}function w(a){a.target===this&&a.newVal&&this._onSetAlign(this.get("align"))}function s(){this.get("visible")&&this._onSetAlign(this.get("align"))}var t=u("node"),x=k.Env.host,j=t.all,v=k.UA;l.__getOffsetParent=m;l.__getVisibleRectForElement=n;l.ATTRS={align:{value:{}}};l.prototype={__bindUI:function(){this.on("beforeVisibleChange",w,this);this.$el.getWindow().on("resize",s,
this)},_onSetAlign:function(a){a&&a.points&&this.align(a.node,a.points,a.offset,a.overflow)},align:function(a,c,d,b){var a=t.one(a||x),d=d&&[].concat(d)||[0,0],b=b||{},f=this.$el,h=0,e=n(f[0]),g=r(f),j=r(a),a=o(g,j,c,d),i=k.merge(g,a);if(e&&(b.adjustX||b.adjustY)){if(a.left<e.left||a.left+g.width>e.right)h=1,c=q(c,/[lr]/ig,{l:"r",r:"l"}),d[0]=-d[0];if(a.top<e.top||a.top+g.height>e.bottom)h=1,c=q(c,/[tb]/ig,{t:"b",b:"t"}),d[1]=-d[1];h&&(a=o(g,j,c,d),k.mix(i,a));c=b.adjustX&&(a.left<e.left||a.left+
g.width>e.right);b=b.adjustY&&(a.top<e.top||a.top+g.height>e.bottom);if(c||b)a=k.clone(a),i={width:g.width,height:g.height},c&&a.left<e.left&&(a.left=e.left),c&&a.left+i.width>e.right&&(a.left=Math.max(e.right-i.width,e.left)),b&&a.top<e.top&&(a.top=e.top),b&&a.top+i.height>e.bottom&&(a.top=Math.max(e.bottom-i.height,e.top)),i=k.mix(a,i)}this.set({x:i.left,y:i.top},{force:1});i.width!==g.width&&this.set("width",f.width()+i.width-g.width);i.height!==g.height&&this.set("height",f.height()+i.height-
g.height);return this},center:function(a){this.set("align",{node:a,points:["cc","cc"],offset:[0,0]});return this},__destructor:function(){this.$el&&this.$el.getWindow().detach("resize",s,this)}};return l});
/*
Copyright 2014, KISSY v1.44
MIT Licensed
build time: May 22 12:17
*/
KISSY.add("component/extension/shim",[],function(a){function b(){}var a=6===a.UA.ie,c='<iframe style="position: absolute;border: none;width: '+(a?"expression(this.parentNode.clientWidth)":"100%")+";top: 0;opacity: 0;filter: alpha(opacity=0);left: 0;z-index: -1;height: "+(a?"expression(this.parentNode.clientHeight)":"100%")+';"/>';b.ATTRS={shim:{value:a}};b.prototype.__createDom=function(){this.get("shim")&&this.get("el").prepend(c)};return b});
KISSY.add("mui/searchbar/plugin/spm",function(e,t,a){var r="data-spm",i="spm-id",s="spm",n="0.0.a2227oh.d100";function o(t){o.superclass.constructor.call(this,e.merge({spm:n},t||{}))}e.extend(o,a,{pluginInitializer:function(e){this.set("caller",e);this.init()},init:function(){var e=this.get("caller");if(!e)return;var t=e.get("sugConfig").extraParams;t[s]=this.get("spm")}},{ATTRS:{pluginId:{value:"spm"},spm:{value:n,setter:function(e){var a=(e.split(".")||[]).reverse(),s={};s.d=a[0]||"0";s.c=a[1]||"0";s.b=a[2]||"0";s.a=a[3]||"0";var n=l(i),o=n?n.content:"";if(!o){n=l(r);o=n?n.content:"";o+="."+(t.attr(document.body,r)||"")}var u=o.split(".")||[];s.a=u[0]||s.a;s.b=u[1]||s.b;return[s.a,s.b,s.c,s.d].join(".")},getter:function(e){var t=(e.split(".")||[]).reverse(),a={};var i=this.get("caller");if(i){var n=i.get("form"),o=n[0][s],l;if(o&&o.tagName==="INPUT"){l=(o.value.split(".")||[]).reverse();t[0]=l[0]||t[0];t[1]=l[1]||t[1]}if(!t[1]&&a.c==="0"){var c=i.get("input"),h=i.get("container");t[1]=h.attr(r)||n.attr(r)||u(c[0])||t[1]}}return t.reverse().join(".")}}}});function u(e){var t;while(e&&e.tagName!="HTML"&&e.tagName!="BODY"&&e.getAttribute){if(t=e.getAttribute(r)){break}if(!(e=e.parentNode)){break}}return t}function l(e){try{return t.get('meta[name="'+e+'"]')}catch(a){var r=t.query("meta"),i="";for(var s=0,n=r.length;s<n;s++){if(r[s].name==e){i=r[s];break}}return i}}return o},{requires:["dom","base"]});KISSY.add("mui/searchbar/plugin/placeholder",function(e,t,a){var r=window;function i(e){this._tasks=[];i.superclass.constructor.call(this,e||{})}e.extend(i,a,{pluginInitializer:function(t){this.set("caller",t);var a=t.get("placeholder");if(!a){var r=this.get("text"),i=t.get("input"),s=t.get("container"),n=i.attr("id"),o=t.get("sugConfig").prefixCls;!n&&i.attr("id",n=e.guid(o+"combobox-input"));t.comboBox.set("placeholderEl",e.all('<label for="'+n+'" class="'+o+'combobox-placeholder">'+r+"</label>").appendTo(s))}this._customizeText();this._customizeInteraction();this._customizeSearch()},_customizeText:function(){var e=this.get("caller"),t=e.comboBox,a=t.get("placeholderEl"),r=this.get("text");a&&a.html(r);t.set("placeholder",r)},_customizeInteraction:function(){var t=this.get("caller"),a=t.get("placeholder"),r=t.get("input"),i=this.get("colors");function s(){e.trim(r.val())===""?a.css({visibility:"visible"}):a.css({display:"none",visibility:"hidden"})}setTimeout(s,100);r.on("valuechange",s);a.css("color",i[1]);if(t.get("sugConfig").autoFocus){a.css("color",i[0])}r.on("focus",function(){a.css("color",i[0]);e.trim(this.value)===""&&a.css({display:"inline",visibility:"visible"})});r.on("blur",function(){e.trim(this.value)===""&&e.trim(r.attr("value"))===""&&a.css({color:i[1],visibility:"visible"})});r.on("keydown",function(t){var r=t.keyCode;if(r==32&&e.trim(this.value)===""){a.css({visibility:"hidden"})}else if(r<13||r>37&&r<112||r>123){a.css({visibility:"hidden"})}});r.on("keyup",function(e){var t=e.keyCode;this.value===""&&!(t==8||t==46)&&a.css({display:"inline",visibility:"visible"})})},_customizeSearch:function(){var a=this,r=this.get("query"),i=this.get("text"),s=this.get("redirectUrl"),n=this.get("xiaoer"),o=this.get("caller"),u=o.get("input"),c=o.get("form"),l=o.get("dim"),h=o.get("log");if(r&&!this._eQueryFn){o.on("beforeSubmit",this._eQueryFn=function(t){if(e.trim(u.val())===""){u.val(a.get("query"));o.modifyFormParams({from:l+"_"+n+"_placeholder"});o.clicklog(","+a.get("query")+","+a.get("query")+","+l+"-,"+h.clickId+",placeholder,"+h.pageType+","+h.isMobile);setTimeout(function(){u.val("")},0);return o.IGNORE_CLICK_LOG}});setTimeout(function(){o.exposelog("/msearch.3.3","searchbar-placeholder","dim="+l+"&q="+r+"&xiaoer="+n,"H46777406")},0)}else if(!r&&this._eQueryFn){o.detach("beforeSubmit",this._eQueryFn);this._eQueryFn=null}if(!r){if(s&&!this._eRedirectFn){if(!c[0]["redirect"])c.append(t.create('<input type="hidden" name="redirect" value="" disabled="disabled" />'));o.on("beforeSubmit",this._eRedirectFn=function(a){if(e.trim(u.val())===""){c[0]["redirect"].value=s;t.removeAttr(c[0]["redirect"],"disabled");o.modifyFormParams({from:l+"_1_placeholder"});o.clicklog(","+s+","+s+","+l+"-,"+h.clickId+",placeholder,"+h.pageType+","+h.isMobile);return o.IGNORE_CLICK_LOG}else{c[0]["redirect"].value="";t.attr(c[0]["redirect"],"disabled","disabled")}});return}else if(!s&&this._eRedirectFn){o.detach("beforeSubmit",this._eRedirectFn);this._eRedirectFn=null}}else{if(this._eRedirectFn){o.detach("beforeSubmit",this._eRedirectFn);this._eRedirectFn=null}}!this._eEmptyFn&&o.on("beforeSubmit",this._eEmptyFn=function(t){if(a._eQueryFn||a._eRedirectFn){o.detach("beforeSubmit",a._eEmptyFn);a._eEmptyFn=null;return}if(e.trim(u.val())===""){a._emptyNotice();return false}})},_reviseUrl:function(e){var t=r.TB&&TB.globalToolFn&&TB.globalToolFn.isDaily&&TB.globalToolFn.isDaily(),a="?spm=0.0.0.0",i=e.indexOf("?"),s=e.indexOf("#"),n=s<0?e.length:s;t&&e.replace(/\b\/\/list.tmall.com\b/,"//list.daily.tmall.net");return i>0?e.replace("?",a+(i==n-1?"":"&")):e+a},_emptyNotice:function(){var e=this.get("caller"),t=e.get("placeholder"),a=e.get("input");if(!a._inFlash){a._inFlash=true;t.html("\u8bf7\u8f93\u5165\u5173\u952e\u5b57");t.css("visibility","visible");this._flashBackground()}},_flashBackground:function(){var a=this.get("caller"),r=a.get("input"),i={background:r.css("background"),borderLeftColor:r.css("border-left-color"),zIndex:r.css("z-index")};r.css({background:"none #fff",borderLeftColor:"#fdbd78",zIndex:e.UA.ie<8?-1:0});this._flashBackgroundAnim(r,4,function(){t.css(r,i);r._inFlash=false})},_flashBackgroundAnim:function(t,a,r){var i=this;if(a<=0){if(r){r.call()}return}new e.Anim(t,{backgroundColor:a%2==0?"#fdbd78":"#fff"},.3,"easeNone",function(){i._flashBackgroundAnim(t,--a,r)}).run()},renderPlugin:function(e){},update:function(e){if(!e||typeof e!=="object")return;if(!this.get("caller")){this._tasks.push(["update",arguments]);return}e.text&&this.set("text",e.text);e.query&&this.set("query",e.query);e.redirectUrl&&this.set("redirectUrl",e.redirectUrl);e.xiaoer&&this.set("xiaoer",e.xiaoer);this._customizeText();this._customizeSearch()}},{ATTRS:{pluginId:{value:"placeholder"},colors:{value:["#ccc","#666"]},text:{value:"\u641c\u7d22 \u5929\u732b \u5546\u54c1/\u54c1\u724c/\u5e97\u94fa",setter:function(e){return typeof e==="string"?e:"\u641c\u7d22 \u5929\u732b \u5546\u54c1/\u54c1\u724c/\u5e97\u94fa"}},query:{value:"",setter:function(e){return typeof e==="string"?e:""}},redirectUrl:{value:"",setter:function(e){return typeof e==="string"&&e!=="notRedirect"?e:""}},xiaoer:{value:0,setter:function(e){return e?1:0}},caller:{value:undefined,setter:function(e){if(e){var t=this;setTimeout(function(){var e=t._tasks;for(var a=0,r=e.length,i;a<r;a++){i=e.shift();t[i[0]].apply(t,i[1])}},10);return e}}}}});return i},{requires:["dom","base"]});KISSY.add("mui/searchbar/template/act",function(e,t){e.ready(function(){setTimeout(function(){t({url:"//www.tmall.com/go/rgn/tmall/searchbar/act.php",dataType:"jsonp",scriptCharset:"gbk",success:function(e){if(a){a.text=e.text||"";a.promo=typeof e.promo=="undefined"?"49218":e.promo}}})},0)});var a={name:"act",text:"",promo:"49218",tpl:'<div class="{$prefixCls}mi-act" data-tpl="act" data-params="q={$query}&promo={promo}&type=p&xl={$wq}_1&from={$dim}_1_suggest">'+'<span class="{$prefixCls}mi-cont-key">{$query}</span>'+'<span class="{$prefixCls}mi-cont-text">\u5728<b>{text}</b>\u4e0b\u641c\u7d22</span>'+"</div>",atpanel:"{$index},{q},{$wq},{$dim}-sugAct,option,suggest,{$pageType},{$isMobile}",parse:function(t,a,r){var i=r["$query"];if(e.trim(i)===""||!this.text)return;r["text"]=this.text;r["promo"]=this.promo;var s=e.substitute(this.tpl,r);t.push({textContent:i,content:s})}};return a},{requires:["ajax"]});KISSY.add("mui/searchbar/template/shipShop",function(e){var t={name:"shipShop",tpl:'<div class="{$prefixCls}mi-ship" data-tpl="shipShop" data-index="0" data-params="q={$query}&type=2&style=w&xl={$wq}_2&from={$dim}_2_suggest">'+'<span class="{$prefixCls}mi-ship-wrap" data-url="{$shopUrl}"><img class="{$prefixCls}mi-ship-img" src="{$logo}"><span class="{$prefixCls}mi-ship-key">{$shopName}</span><i class="{$prefixCls}mi-ship-icon"></i></span>'+"</div>",atpanel:"{$index},{q},{$wq},{$dim}-sugShop,{$userId},suggest,{$pageType},{$isMobile},2",parse:function(t,a,r){var i=r["$query"],s=this;if(i&&a["shop_info"]&&a["shop_info"].length){for(var n=0;n<a["shop_info"].length;n++){e.each(a["shop_info"][n],function(e,t){switch(t){case"shop_name":r["$shopName"]=e;break;case"logo":r["$logo"]="//img.alicdn.com/tfscom/"+e;break;case"shop_url":r["$shopUrl"]=e;break;default:}});r["$query"]=e.urlEncode(i);var o=e.substitute(s.tpl,r);t.push({textContent:i,content:o})}}}};return t});KISSY.add("mui/searchbar/template/cat",function(e,t){var a={name:"cat",tpl:'<div class="{$prefixCls}mi-cat" data-tpl="cat" data-index="{$index}" data-params="q={$2}&cat={$1}&type=p&xl={$wq}_{$index}&from={$dim}_1_suggest">'+'<span class="{$prefixCls}mi-cont-text">\u5728<b>{$0}</b>\u5206\u7c7b\u4e0b\u641c\u7d22</span>'+"</div>",atpanel:"{$index},{q},{$wq},{$dim}-sugCat,{cat},suggest,{$pageType},{$isMobile}",parse:function(t,a,r){var i=a["cat"];if(a["tmall_noresult"]||!i||!e.isArray(i)||a.result.length<1)return;var s={textContent:"",content:'<div class="{$prefixCls}mi-cat" data-tpl="cat" data-index="0" data-params="q={$2}&type=p&xl={$wq}_{$index}&from={$dim}_1_suggest"><span class="{$prefixCls}mi-cont-key">{$2}</span></div>'};t.push(s);for(var n=0,o=Math.min(i.length,2),u="";n<o;n++){r["$index"]=1+n;var l=i[n];if(e.isArray(l)){for(var c=0;c<3;c++){r["$"+c]=l[c]||r["$query"]}}u=e.substitute(this.tpl,r);s.textContent=r["$2"];s.content=e.substitute(s.content,r);t.push({textContent:r["$2"],content:u})}t.push({content:'<div class="hr"/>',disabled:true})}};return a},{requires:["dom"]});KISSY.add("mui/searchbar/template/list",function(e){var t={name:"list",tpl:'<div class="{$prefixCls}mi-list" data-tpl="list" data-index="{$index}" data-params="q={$query}&type=p&xl={$wq}_{$index}&from={$dim}_1_suggest">'+'<span class="{$prefixCls}mi-cont-key">{text}</span>'+'<span class="{$prefixCls}mi-cont-count">\u7ea6{count}\u4e2a\u7ed3\u679c</span>'+'<a class="{$prefixCls}mi-btn-backfill" href="javascript:;">\u56de\u586b</a>'+"</div>",atpanel:"{$index},{q},{$wq},{$dim}-sugQuery,query,suggest,{$pageType},{$isMobile}",parse:function(t,a,r){var i=this,s=r["$query"];a["tmall_noresult"]&&t.push({content:'<div class="'+r["$prefixCls"]+'mi-noresult-tip">\u56e7\uff0c\u60a8\u8f93\u5165\u7684\u5173\u952e\u8bcd\u4e0b\u6ca1\u6709\u7ed3\u679c\uff0c\u8bd5\u8bd5\u8fd9\u4e9b\u5427\uff1a</div>',disabled:true});e.each(a.result,function(n,o){if(!n||!n[0]){a.result.splice(o,1);return}for(var u in t){if(t[u].textContent===n[0])return}var l=n[0],c=s;if(!l.match(/\<(\/)?\w\>/gi)){while(l.indexOf(c)<0){c=c.substr(0,c.length-1)}var p=l.indexOf(c),m=p+c.length,h=l.substr(0,p),d=l.substr(m);h=h?"<b>"+h+"</b>":"";d=d?"<b>"+d+"</b>":"";l=h+c+d}r["$query"]=e.urlEncode(n[0].replace(/\<(\/)?\w\>/gi,""));r["$index"]=o+1;r["text"]=l;r["count"]=n[1];var f=e.substitute(i.tpl,r);t.push({textContent:e.urlDecode(r["$query"]),content:f})})}};return t});KISSY.add("mui/searchbar/template/shop",function(e){var t={name:"shop",tpl:'<div class="{$prefixCls}mi-tip" data-tpl="shop" data-params="q={$query}&type=p&style=w&xl={$wq}_2&from={$dim}_2_suggest">'+"<i></i>\u627e\u201c<b>{$text}</b>\u201d\u76f8\u5173<em>\u5e97\u94fa</em>"+"</div>",atpanel:"{$index},{q},{$wq},{$dim}-sugShop,option,suggest,{$pageType}",parse:function(t,a,r){var i=r["$query"];if(e.trim(i)===""||i=="undefined")return;r["$query"]=e.urlEncode(i);r["$text"]=i;var s=e.substitute(this.tpl,r);t.push({textContent:i,content:s})}};return t});KISSY.add("mui/searchbar/template/quickSearch",function(e){var t={name:"quickSearch",tpl:'<p class="{$prefixCls}mi-qs"><i></i>\u6309\u5feb\u6377\u952e <em>shift</em> + <em>?</em> \u53ef\u4ee5\u968f\u65f6\u6253\u5f00\u5feb\u6377\u641c\u7d22\u6846\uff0c\u8d76\u7d27\u8bd5\u8bd5\u5427~</p>',parse:function(t,a,r){var i=r["$query"];if(e.trim(i)==="")return;var s=e.substitute(this.tpl,r);t.push({content:s,disabled:true})}};return t});