var SaForDspUtil=function(config){var oThis=this;var _tag="|";var _cookieAdIdName="_snAdId";var expires_ms_2years=365*2*24*60*60*1000;var expires_ms_30mins=30*60*1000;var expires_ms_24hours=86400000;var utils=new Utils();var dspConfig=new DspConfig(utils);oThis.init=function(){var url=utils.getHostPath()+"dspExpo.gif";var date=(new Date).getTime();var param="a="+dspConfig.adID+"&b="+dspConfig.requestId+"&c="+dspConfig.visitorId+"&d="+date+"&ps="+dspConfig.proIds+"&q="+dspConfig.expoContents;var extParam="i="+dspConfig.ip+"&t="+dspConfig.templateNum+"&cno="+dspConfig.memberId+"&adId="+dspConfig.adId+"&top="+dspConfig.topUrl+"&bw="+dspConfig.browser+"&sen="+dspConfig.sense;url=url+"?"+param+"&"+extParam;utils.sendByImg(url)};oThis.click=function(pointId,ponitType){var url=utils.getHostPath()+"dspClick.gif";if(ponitType!=undefined&&ponitType!=null&&ponitType!=""){var proIdArr=dspConfig.proIds.split(",");if(proIdArr!=null&&proIdArr.length>0){pointId=proIdArr[pointId]}}var date=(new Date).getTime();var param="a="+dspConfig.adID+"&b="+dspConfig.requestId+"&c="+dspConfig.visitorId+"&d="+date+"&p="+pointId+"&q="+dspConfig.clickContents;var extParam="i="+dspConfig.ip+"&t="+dspConfig.templateNum+"&cno="+dspConfig.memberId+"&adId="+dspConfig.adId+"&top="+dspConfig.topUrl+"&bw="+dspConfig.browser+"&sen="+dspConfig.sense;url=url+"?"+param+"&"+extParam;utils.sendByImg(url)};oThis.flash=function(index,proId){var url=utils.getHostPath()+"dspFlash.gif";var date=(new Date).getTime();var param="b="+dspConfig.requestId+"&i="+index+"&p="+proId+"&t="+dspConfig.templateNum;url=url+"?"+param};function DspConfig(utils){var oThis=this;oThis.adID=config&&config.AdID?config.AdID:"-";oThis.requestId=config&&config.REQUESTID?config.REQUESTID:"-";oThis.visitorId=config&&config.Cookie_ID?config.Cookie_ID:"-";oThis.proIds=config&&config.Pro_IDS?config.Pro_IDS:"-";oThis.expoContents=config&&config.EXPO_Content?config.EXPO_Content:"-";oThis.clickContents=config&&config.EXPO_Content?config.EXPO_Content:"-";oThis.ip=config&&config.Ip?config.Ip:"-";oThis.templateNum=config&&config.TemplateNum?config.TemplateNum:"-";oThis.memberId=utils.getCookie("custno")?utils.getCookie("custno"):"-";oThis.adId=getAdIdCookie();oThis.topUrl=utils.getTopUrl();oThis.browser=utils.encode(utils.getExplore());oThis.sense=utils.getSense();function getAdIdCookie(){var adId=utils.getCookie(_cookieAdIdName);if(adId&&adId!=null&&adId!=""){return adId}else{adId=utils.createOnlyId();utils.addCookie(_cookieAdIdName,adId,"/",expires_ms_2years,"");return adId}}}function Utils(){var oThis=this;var IE=document.all?true:false;var m="match";oThis.IsArray=function(obj){return Object.prototype.toString.call(obj).toLowerCase()=="[object array]"};oThis.IsNull=function(obj){return""==obj||undefined==obj||"-"==obj};oThis.jsonPick=function(obj,name){return !IsArray(obj)&&typeof(obj).toLowerCase()=="object"?obj[name]:"-"};oThis.sendByImg=function(url){var n=Math.round((new Date).getTime()/1000),img=new Image(1,1);window.__n=img;img.onload=img.onerror=function(){window.__n=null;img=null};img.src=url+"&i="+n};oThis.getHostPath=function(){return"https:"==document.location.protocol?"https://click.suning.cn/sa/":"http://click.suning.cn/sa/"};oThis.addEvent=function(ele,eve,listener,useCapture){if(window.addEventListener){ele.addEventListener(eve,listener,!!useCapture)}else{window.attachEvent&&ele.attachEvent("on"+eve,listener)}};oThis.mapPick=function(map,key,separator){var result="-",idx;if(!oThis.IsNull(map)&&!oThis.IsNull(key)){idx=map.indexOf(key);if(idx>-1){var endIdx=map.indexOf(separator,idx);if(endIdx<0){endIdx=map.length}result=map.substring(idx+key.indexOf("=")+1,endIdx)}}return result};oThis.createOnlyId=function(){var now=new Date();var m=Math.round(100000*Math.random());var onlyId=now.getTime().toString().concat(m);return onlyId};oThis.encode=function(s){return null!=s?encodeURIComponent(s):""};oThis.addCookie=function(name,value,path,expires,domain){var str=name+"="+escape(value);if(expires!=""){var date=new Date();date.setTime(date.getTime()+expires);str+=";expires="+date.toGMTString()}if(path!=""){str+=";path="+path}var dm=oThis.getDomain();if(dm.indexOf(".suning.com")!=-1){str+=";domain=.suning.com"}else{if(dm.indexOf(".cnsuning.com")!=-1){str+=";domain=.cnsuning.com"}else{if(dm.indexOf(".manzuo.com")!=-1){str+=";domain=.manzuo.com"}else{str+=";domain="+location.hostname}}}document.cookie=str};oThis.getCookie=function(name){var arrStr=document.cookie.split("; ");for(var i=0;i<arrStr.length;i++){var temp=arrStr[i].split("=");if(temp[0]==name){return decodeURIComponent(temp[1]?temp[1]:"-")}}};oThis.delCookie=function(name){oThis.addCookie(name,"","/",-10000,"")};oThis.getDomain=function(){var dom=document.location.hostname;return dom};oThis.getTopUrl=function(){var topUrl="-";try{var lhash=getHash();if(window.parent.location.hash){topUrl=window.parent.location.href.substring(0,window.parent.location.href.indexOf(lhash)-1)}else{topUrl=window.parent.location.href}return cutUrlToShort(topUrl)}catch(e){return"-"}};oThis.getExplore=function(){try{var ua=navigator.userAgent;var browser={};var s;(s=ua[m](/ucbrowser\/[\d\.]+/i))?browser.uc=s[0]:(s=ua[m](/msie ([\d.]+)/i))?browser.ie=s[1]:(s=ua[m](/firefox\/([\d.]+)/i))?browser.firefox=s[1]:(s=ua[m](/chrome\/([\d.]+)/i))?browser.chrome=s[1]:(s=ua[m](/opera.([\d.]+)/i))?browser.opera=s[1]:(s=ua[m](/version\/([\d.]+).*safari/i))?browser.safari=s[1]:0;var version="";if(browser.uc){version=browser.uc}else{if(browser.ie){version="msie "+browser.ie}else{if(browser.firefox){version="firefox "+browser.firefox}else{if(browser.chrome){version="chrome "+browser.chrome}else{if(browser.opera){version="opera "+browser.opera}else{if(browser.safari){version="safari "+browser.safari}else{version="unknown Browser"}}}}}}return version}catch(e){return"-"}};oThis.getSense=function(){try{return window.screen.width+"x"+window.screen.height}catch(e){return"-"}};oThis.getPrinColor=function(){try{return window.screen.colorDepth+"bit"}catch(e){return"-"}};oThis.getFlash=function(){try{var f="";var n=navigator;if(n.plugins&&n.plugins.length){for(var ii=0;ii<n.plugins.length;ii++){if(n.plugins[ii].name.indexOf("Shockwave Flash")!=-1){f=n.plugins[ii].description.split("Shockwave Flash ")[1].split(" ")[0];break}}}else{if(document.ActiveXObject){for(var ii=10;ii>=2;ii--){try{var fl=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+ii+"');");if(fl){f=ii+".0";break}}catch(e){}}}}if(f!=""){return 1}return 0}catch(e){return 0}};oThis.getJava=function(){try{if(navigator.javaEnabled()){return 1}}catch(e){}return 0};function getHash(){var match=location.href.match(/#(.*)$/);return match?match[1]:""}function cutUrlToShort(urlOrTitle){if(urlOrTitle.length>301){urlOrTitle=urlOrTitle.substring(0,300)}while(urlOrTitle.indexOf(_tag)!=-1){urlOrTitle=urlOrTitle.replace(_tag,"--")}return urlOrTitle}}};