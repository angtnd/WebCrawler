STK.register("kit.dom.parseDOM",function(a){return function(a){for(var b in a)a[b]&&a[b].length==1&&(a[b]=a[b][0]);return a}});
STK.register("kit.dom.layoutPos",function(a){return function(b,c,d){if(!a.isNode(c))throw"kit.dom.layerOutElement need element as first parameter";if(c===document.body)return!1;if(!c.parentNode)return!1;if(c.style.display==="none")return!1;var e,f,g,h,i,j,k;e=a.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},d);f=c;if(!f)return!1;while(f!==document.body){f=f.parentNode;if(f.style.display==="none")return!1;j=a.getStyle(f,"position");k=f.getAttribute("layout-shell");if(j==="absolute"||j==="fixed")break;if(k==="true"&&j==="relative")break}f.appendChild(b);g=a.position(c,{parent:f});h={w:c.offsetWidth,h:c.offsetHeight};i=e.pos.split("-");i[0]==="left"?b.style.left=g.l+e.offsetX+"px":i[0]==="right"?b.style.left=g.l+h.w+e.offsetX+"px":i[0]==="center"&&(b.style.left=g.l+h.w/2+e.offsetX+"px");i[1]==="top"?b.style.top=g.t+e.offsetY+"px":i[1]==="bottom"?b.style.top=g.t+h.h+e.offsetY+"px":i[1]==="middle"&&(b.style.top=g.t+h.h/2+e.offsetY+"px");return!0}});
STK.register("kit.dom.firstChild",function(a){var b=a.core.dom.next;return function(a){var c=a.firstChild;c&&c.nodeType!=1&&(c=b(c));return c}});
STK.register("kit.extra.textareaUtils",function(a){var b={},c=document.selection;b.selectionStart=function(a){if(!c)try{return a.selectionStart}catch(b){return 0}var d=c.createRange(),e,f,g=0,h=document.body.createTextRange();try{h.moveToElementText(a)}catch(b){}for(g;h.compareEndPoints("StartToStart",d)<0;g++)h.moveStart("character",1);return g};b.selectionBefore=function(a){return a.value.slice(0,b.selectionStart(a))};b.selectText=function(a,b,d){a.focus();if(!c)a.setSelectionRange(b,d);else{var e=a.createTextRange();e.collapse(1);e.moveStart("character",b);e.moveEnd("character",d-b);e.select()}};b.insertText=function(a,d,e,f){a.focus();f=f||0;if(!c){var g=a.value,h=e-f,i=h+d.length;a.value=g.slice(0,h)+d+g.slice(e,g.length);b.selectText(a,i,i)}else{var j=c.createRange();j.moveStart("character",-f);j.text=d}};b.replaceText=function(a,d){a.focus();var e=a.value,f=b.getSelectedText(a),g=f.length;if(f.length==0)b.insertText(a,d,b.getCursorPos(a));else{var h=b.getCursorPos(a);if(!c){var j=h+f.length;a.value=e.slice(0,h)+d+e.slice(h+g,e.length);b.setCursor(a,h+d.length);return}var i=c.createRange();i.text=d;b.setCursor(a,h+d.length)}};b.getCursorPos=function(a){var b=0;if(STK.core.util.browser.IE){a.focus();var d=null;d=c.createRange();var e=d.duplicate();e.moveToElementText(a);e.setEndPoint("EndToEnd",d);a.selectionStartIE=e.text.length-d.text.length;a.selectionEndIE=a.selectionStartIE+d.text.length;b=a.selectionStartIE}else if(a.selectionStart||a.selectionStart=="0")b=a.selectionStart;return b};b.getSelectedText=function(a){var b="",d=function(a){return a.selectionStart!=undefined&&a.selectionEnd!=undefined?a.value.substring(a.selectionStart,a.selectionEnd):""};window.getSelection?b=d(a):b=c.createRange().text;return b};b.setCursor=function(a,b,c){b=b==null?a.value.length:b;c=c==null?0:c;a.focus();if(a.createTextRange){var d=a.createTextRange();d.move("character",b);d.moveEnd("character",c);d.select()}else a.setSelectionRange(b,b+c)};b.unCoverInsertText=function(a,b,c){c=c==null?{}:c;c.rcs=c.rcs==null?a.value.length:c.rcs*1;c.rccl=c.rccl==null?0:c.rccl*1;var d=a.value,e=d.slice(0,c.rcs),f=d.slice(c.rcs+c.rccl,d==""?0:d.length);a.value=e+b+f;this.setCursor(a,c.rcs+(b==null?0:b.length))};return b});
STK.register("kit.io.jsonp",function(a){return function(b){var c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:3e4,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:!0},b),d=[],e={},f=!1,g=function(){if(!!d.length){if(f===!0)return;f=!0;e.args=d.shift();e.onComplete=function(a){f=!1;c.onComplete(a,e.args);setTimeout(g,0)};e.onFail=function(a){f=!1;c.onFail(a);setTimeout(g,0)};a.jsonp(a.core.json.merge(c,{args:e.args,onComplete:function(a){e.onComplete(a)},onFail:function(a){try{e.onFail(a)}catch(b){}}}))}},h={};h.request=function(a){a||(a={});d.push(a);a._t=1;g()};h.abort=function(a){while(d.length)d.shift();f=!1;e=null};return h}});
STK.register("common.extra.parseLanguage",function(a){var b,c=function(d){if(typeof d=="string")return a.core.util.language(d,b);for(var e in d)d[e]=c(d[e]);return d};return function(a,d){b=d||window.$LANG||{};return c(a)}});
STK.register("common.listener",function(a){var b={},c={};c.define=function(c,d){if(b[c]!=null)throw"common.listener.define: é¢éå·²è¢«å ç¨";b[c]=d;var e={};e.register=function(d,e){if(b[c]==null)throw"common.listener.define: é¢éæªå®ä¹";a.listener.register(c,d,e)};e.fire=function(d,e){if(b[c]==null)throw"commonlistener.define: é¢éæªå®ä¹";a.listener.fire(c,d,e)};e.remove=function(b,d){a.listener.remove(c,b,d)};e.cache=function(b){return a.listener.cache(c,b)};return e};return c});
STK.register("common.channel.sso.login",function(a){var b=["login","logout","verify.extra","verify.username","pincode","pincode.create","login.complete","login.success","login.failure","logout.complete","logout.success","logout.failure","verify.update","verify.failure","verify.complete","pincode.update","yalogin.verify","yalogin.active","yalogin.deny"];return a.common.listener.define("common.channel.sso.login",b)});
STK.register("ui.mod.layer",function(a){var b=function(a){var b={};if(a.style.display=="none"){a.style.visibility="hidden";a.style.display="";b.w=a.offsetWidth;b.h=a.offsetHeight;a.style.display="none";a.style.visibility="visible"}else{b.w=a.offsetWidth;b.h=a.offsetHeight}return b},c=function(c,d){d=d||"topleft";var e=null;if(c.style.display=="none"){c.style.visibility="hidden";c.style.display="";e=a.core.dom.position(c);c.style.display="none";c.style.visibility="visible"}else e=a.core.dom.position(c);if(d!=="topleft"){var f=b(c);if(d==="topright")e.l=e.l+f.w;else if(d==="bottomleft")e.t=e.t+f.h;else if(d==="bottomright"){e.l=e.l+f.w;e.t=e.t+f.h}}return e};return function(d){var e=a.core.dom.builder(d),f=e.list.outer[0],g=e.list.inner[0],h=a.core.dom.uniqueID(f),i={},j=a.core.evt.custEvent.define(i,"show");a.core.evt.custEvent.define(j,"hide");var k=null;i.show=function(){f.style.display="";a.core.evt.custEvent.fire(j,"show");return i};i.hide=function(){f.style.display="none";a.custEvent.fire(j,"hide");return i};i.getPosition=function(a){return c(f,a)};i.getSize=function(a){if(a||!k)k=b.apply(i,[f]);return k};i.html=function(a){a!==undefined&&(g.innerHTML=a);return g.innerHTML};i.text=function(b){b!==undefined&&(g.innerHTML=a.core.str.encodeHTML(b));return a.core.str.decodeHTML(g.innerHTML)};i.appendChild=function(a){g.appendChild(a);return i};i.getUniqueID=function(){return h};i.getOuter=function(){return f};i.getInner=function(){return g};i.getParentNode=function(){return f.parentNode};i.getDomList=function(){return e.list};i.getDomListByKey=function(a){return e.list[a]};i.getDom=function(a,b){return e.list[a]?e.list[a][b||0]:!1};i.getCascadeDom=function(b,c){return e.list[b]?a.core.dom.cascadeNode(e.list[b][c||0]):!1};return i}});
STK.register("common.form.bubbleTip",function(a){var b={FRAME:'<div node-type="outer" class="layer_form_tips" style="width:216px"><div class="bg"><div node-type="inner" class="content"><a href="javascript:void(0)" action-type="common_layer_errtip_close" node-type="close" onclick="return false;" class="W_ico12 icon_close"></a><p node-type="msg" class="tips"></p></div><div node-type="arrow" class="arrow arrow_tips"></div></div></div>',CONTENT:'<span class="icon_rederrorS"></span>'};return function(c){var d,e,f,g,h={init:function(){h.parseParam();h.build();h.bind()},parseParam:function(){d=a.parseParam({template:b.FRAME},c||{})},build:function(){e=a.ui.mod.layer(d.template);f=a.kit.dom.parseDOM(e.getDomList())},bind:function(){g=a.core.evt.delegatedEvent(f.outer);for(var b in i)g.add(b,"click",i[b])},show:function(c,d){d=a.parseParam({el:null,box:null},d||{});if(!!d.el&&!!a.isNode(d.el)){a.isNode(d.box)||(d.box=d.el);f.msg.innerHTML=b.CONTENT+c;e.show();a.kit.dom.layoutPos(f.outer,d.box,{pos:"left-top"});d.layerPos=a.core.json.merge(a.core.dom.position(d.box),a.core.dom.getSize(f.outer));d.elPos=a.core.json.merge(a.core.dom.position(d.el),a.core.dom.getSize(d.el));if(d.elPos.l<0||d.elPos.width<=0){d.elPos.l=d.layerPos.l;d.elPos.width=d.layerPos.width}a.core.dom.setStyle(f.arrow,"left",Math.abs(d.layerPos.l-d.elPos.l)+d.elPos.width/2+"px");a.core.dom.setXY(f.outer,{t:d.layerPos.t-d.layerPos.height-3,l:d.layerPos.l-2})}},hide:function(){e.hide()},destroy:function(){e.hide();e=null;a.core.dom.removeNode(f.outer)}},i={common_layer_errtip_close:function(){e.hide()}};h.init();var j={layer:e,show:h.show,hide:h.hide,domList:f,destroy:h.destroy};return j}});
STK.register("common.extra.keyboardCapture",function(a){var b={13:"enter",27:"esc",32:"space",38:"up",40:"down",9:"tab"};return function(c,d){d=d||{};var e={},f,g={keydown:function(c){d.stopScroll&&a.stopEvent();var f,g;!!(f=c)&&!!(g=f.keyCode)&&b[g]&&a.custEvent.fire(e,b[g])}},h={init:function(){h.pars();h.bind()},pars:function(){},bind:function(){for(var b in g)a.addEvent(c,b,g[b])},getKey:function(a){return b[a]},destroy:function(){for(var b in g)a.removeEvent(c,b,g[b])}};h.init();e.getKey=h.getKey;e.destroy=h.destroy;return e}});
STK.register("kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b){var c=[].splice.call(arguments,1,arguments.length),d=[b,$LANG].concat(c),e=a.core.util.language.apply(this,d);return e}});
STK.register("common.layer.emailAutocomplete",function(a){var b=a.kit.extra.textareaUtils,c=a.kit.extra.language,d=["sina.com","163.com","qq.com","126.com","vip.sina.com","sina.cn","hotmail.com","gmail.com","sohu.com","139.com","wo.com.cn","189.cn","21cn.com"],e={panel:['<div node-type="layer" class="layer_menu_list" style="display:none;">','<ul><li class="note">#L{è¯·éæ©é®ç®±ç±»å}</li></ul>','<ul node-type="panel"></ul>',"</div>"].join(""),item:["<#et userlist data>","<#list data.data as item>",'<li action-type="item" action-data="value=${data.key}@${item}" ><a href="#">${data.key}@${item}</a></li>',"</#list>","</#et>"].join("")},f=["enter","esc","up","down"],g=[/^[0-9a-z_][_.0-9a-z-]{0,31}$/,/^[0-9a-zA-Z_][_.0-9a-zA-Z-]{0,31}$/],h={};return function(b,i){var j,k,l,m,n,o,p,q=!1,r={get:function(a){var b=a.split("@"),c=b.length;if(c==2){var e=b[1].toLowerCase();if(!!e&&!/^[0-9a-z]+[0-9a-z-.]*$/.test(e))return null;if(e){!h[e]&&r.run(e);return h[e]}return d}return null},run:function(a){var b=new RegExp("^"+a+"");h[a]=[];for(var c in d){c=d[c];!!b.exec(c)&&h[a].push(c)}},checkFormat:function(a,b){b=!b?0:1;return g[b].test(a)}},s,t={build:function(){var b=a.builder(c(j.template.panel));k=b.list.layer[0];l=b.list.panel[0];document.body.appendChild(b.box)},show:function(){var c=a.core.dom.position(b),d=a.core.dom.getSize(b),e=["position:absolute","display:inline-block","z-index:10010","left:"+(c.l+j.offsetX)+"px","top:"+(c.t+d.height+j.offsetY)+"px"];if(j.width>0){e.push("width:"+j.width+"px");e.push("overflow:hidden")}k.style.cssText=e.join(";");q=!0},hide:function(){setTimeout(function(){k.style.display="none";q=!1},300)},refresh:function(b,c,d){l.innerHTML=a.core.util.easyTemplate(j.template.item,{key:encodeURIComponent(b),domain:c,data:d}).toString();s=null},indexChange:function(b){var c=p.length;if(!(c<1)){var d=a.sizzle("li.cur",l)[0];if(d){var e=a.core.dom[b>0?"next":"prev"](d);e?s=e:s=a.core.dom[(b>0?"first":"last")+"Child"](l);s&&a.removeClassName(d,"cur")}else{var f=a.sizzle("li",l);s=a.sizzle("li",l)[0]}a.addClassName(s,"cur")}},onShown:function(){return q},hasCurrent:function(){var b=a.sizzle("li.cur",l)[0];return b?!0:!1}},u={enter:function(){var c=b.value;j.autoTrim&&(c=c.replace(/^\s+/g,""));var d=a.queryToJson(s.getAttribute("action-data"));if(d.value.indexOf(c)===0&&c!==""){b.value=d.value;b.blur()}},esc:function(){x.hide()},up:function(){t.indexChange(-1);a.preventDefault()},down:function(){t.indexChange(1);a.preventDefault()}},v={focus:function(){x.show()},blur:function(){x.hide()},keyup:function(a){var b=a.keyCode;!u[n.getKey(b)]&&!m&&(m=setTimeout(function(){x.show();clearTimeout(m);m=null},500))}},w={mousedown:{item:function(a){b.value=a.data.value}},click:{item:function(b){a.preventDefault();x.hide()}}},x={init:function(){if(!a.isNode(b))throw"input is undefined";x.pars();x.build();x.bind()},pars:function(){j=a.parseParam({template:e,autoTrim:!1,autoCase:!1,width:-1,offsetX:0,offsetY:0},i||{});d=$CONFIG.emailDomains||i&&i.domains||d},build:function(){t.build();n=a.common.extra.keyboardCapture(b)},bind:function(){a.custEvent.define(n,f);for(var c=0,d=f.length;c<d;c++)a.custEvent.add(n,f[c],u[f[c]]);for(var e in v)a.addEvent(b,e,v[e]);o=a.delegatedEvent(l);for(var e in w){var g=w[e];for(var h in g)o.add(h,e,g[h])}},show:function(){p=r.get(b.value);var a=b.value.split("@"),c=a[0],d=a[1];j.autoTrim&&(c=c.replace(/^\s+/g,""));if(p&&p[0]&&r.checkFormat(c,j.autoCase)){if(p.length==1&&d==p[0])return;t.refresh(c,d,p);t.show()}else t.hide()},hide:function(){t.hide()},destroy:function(){for(var c in v)a.removeEvent(b,c,v[c]);a.custEvent.undefine(n,f);o.destroy();n.destroy()},onShown:t.onShown,onActive:function(){return t.onShown()&&t.hasCurrent()}};x.init();var y={};y.show=x.show;y.hide=x.hide;y.onShown=x.onShown;y.onActive=x.onActive;y.destroy=x.destroy;return y}});
STK.register("common.extra.inputMonitor",function(a){var b={m:100,s:1e3,f:5e3};return function(c,d){var e,f,g={},h={},i=!1,j={init:function(){j.parseParam();j.bind()},parseParam:function(){d=a.parseParam(b,d||{})},bind:function(){a.custEvent.define(h,["change"]);a.addEvent(c,"focus",j.start);a.addEvent(c,"blur",j.stop)},start:function(){g.f&&clearTimeout(g.f);!g.m&&(g.m=setInterval(j.check,d.m))},stop:function(){g.f&&clearTimeout(g.f);g.f=setTimeout(function(){if(g.m){clearInterval(g.m);g.m=null}},d.f)},check:function(){e=c.value;if(!j.isSame(e)){if(!i){i=!0;a.custEvent.fire(h,"change")}f=e;j.inputing()}},inputing:function(){g.s&&clearTimeout(g.s);g.s=setTimeout(function(){i=!1},d.s)},isSame:function(a){return a===f},destroy:function(){for(var b in g)g[b]&&clearTimeout(g[b]);a.removeEvent(c,"focus",j.start);a.removeEvent(c,"blur",j.stop);a.custEvent.undefine(h);f=g=d=e=h=j=null}};j.init();h.destroy=j.destroy;return h}});
STK.register("kit.extra.orderStr",function(a){return function(a,b){if(!a||!b)throw"orderStr error!";typeof a!="string"&&(a=a+"");typeof b!="string"&&(b=b+"");var c=a.charCodeAt(0),d=b.charCodeAt(0),e=c>d;if(e){var f=c;c=d;d=f}var g=[];for(var h=c;h<=d;h++)g.push(String.fromCharCode(h));e&&g.reverse();return g.join("")}});
STK.register("common.setting.rule",function(a){var b=a.kit.extra.orderStr,c={};c.isEmpty=function(a){return/^\s*$/g.test(a.replace(/^\s+|\s+$/g,""))};c.isNumber=function(a){return/^[+\-]?\d+(\.\d+)?$/.test(a)};c.isName=function(a){return/^[0-9a-zA-Z\u4e00-\u9fa5_-]+$/.test(a)};c.isRealName=function(a){return/^[\u4e00-\u9fa5]{2,6}$/.test(a)?!0:/^[a-zA-Z]{2,20}$/.test(a)?!0:/[a-zA-Z0-9\u3000|\s|\t|\uff00-\uffffï½ï¼@#ï¿¥%â¦â¦&Ãï¼ï¼ââããããããââãã\?\~\!\@\#\$\%\^\&\*\\\+\`\=\[\]\(\)\{\}\|\;\'\:\"\,\/\<\>]+/.test(a)?!1:!0};c.isCompany=function(a){return/^[^"'<>]+$/.test(a)};c.isChinese=function(a){return/[\u4e00-\u9fa5]+$/.test(a)};c.isCName=function(a){return/^[\u4e00-\u9fa5]+[\u00b7\.]?[\u4e00-\u9fa5]+$/.test(a)};c.isEmail=function(a){if(!/^[0-9a-z_][_.0-9a-z-]{0,31}@([0-9a-z][0-9a-z-]{0,30}\.){1,4}[a-z]{2,4}$/.test(a))return!1;if(a&&a!=""&&a.indexOf("@")!=-1){var b=a.indexOf("@"),c=a.substring(0,b);return c.length>64||a.length>256?!1:!0}return!1};c.isYahoo=function(a){return/^.*@((yahoo\.com\.cn)||(yahoo\.cn))$/.test(a)};c.isEmailName=function(a){return/^[0-9a-z_][_.0-9a-z-]{0,31}$/.test(a)};c.isIDNumber=function(a){return/^[\d]{15}$/.test(a)||/^[\d]{17}([Xx\d]{1}$)$/.test(a)};c.isMobile=function(a){return/^1[3|4|5|7|8][0-9]{9}$/.test(a)};c.isWeird=function(a){return!/^[0-9a-zA-Z~!@#$%^&*()_+`\-={}|\[\]\\\:\";'<\>?,.\/]+$/i.test(a)};c.isPassportID=function(a){return/^[a-zA-Z0-9]{8,20}$/.test(a)};c.isAbroadName=function(a){return/^[a-zA-Z\u4e00-\u9fa5]+([\u00b7\.\- ]?[a-zA-Z\u4e00-\u9fa5]+)*$/.test(a)};c.lenLimit=function(b,c,d){var e=a.bLength(b);return!(e<c||e>d)};c.isUrl=function(a){return/^http:\/\/([\w-]+(\.[\w-]+)+(\/[\w-   .\/\?%@&+=\u4e00-\u9fa5]*)?)?$/i.test(a)};c.turnBoolean=function(a){switch(typeof a){case"boolean":return a;case"number":return!!a;case"string":return a=="true"||a=="1"}};c.reNullChar=function(a){return a.replace(/^\s+|\s+$/g,"")};var d=[b("a","z"),b("z","a"),b("0","9"),b("9","0")];c.isOrder=function(a){return a&&a.length&&a.length>1&&function(){for(var b=0;b<d.length;b++)if(d[b].indexOf(a)>=0)return!0;return!1}()};c.isWeakPasswd=function(b){var d=["000000","111111","11111111","112233","123123","123321","123456","12345678","654321","666666","888888","abcdef","abcabc","abc123","a1b2c3","aaa111","123qwe","qwerty","qweasd","admin","password","p@ssword","passwd","iloveyou","5201314"];if(a.inArray(b,d))return!0;if(/^([a-zA-Z0-9])\1+$/.test(b))return!0;if(c.isOrder(b))return!0;if(/^([a-zA-Z]+)([0-9]+)$/.test(b)||/^([0-9]+)([a-zA-Z]+)$/.test(b)){var e=RegExp.$1,f=RegExp.$2;if(c.isOrder(e)&&c.isOrder(f))return!0}return!1};c.isStrongPasswd=function(a){var b=a.match(/[a-z]/ig),c=a.match(/[0-9]/ig),d=a.match(/([^a-z0-9])/ig);if(b&&c&&d)return!0;if(b&&c)return b.length+c.length>=11;if(b&&d)return b.length+d.length>=11;if(c&&d)return c.length+d.length>=11};c.isMobileSea=function(a,b){switch(b){case"0086":return c.isMobile(a);case"00852":return/^[569]\d{7}$/.test(a);case"00853":return/^6\d{7}$/.test(a);case"00886":return/^9\d{8}$/.test(a);case"001":return/^\d{10}$/.test(a);case"0060":return/^1\d{8}$/.test(a);case"0061":return/^4\d{8}$/.test(a);case"0081":return/^[789]0\d{8}$/.test(a);case"0082":return/^1[016789]\d{8}$/.test(a);case"0065":return/^[89]\d{7}$/.test(a);case"0044":return/^(7[45789]\d{8})|7624\d{6}$/.test(a);case"0033":return/^((6\d{8})|(7[345678]\d{7}))$/.test(a);case"007":return/^((90[12345689]\d{7})|(9[1236]\d{8})|(95[0123]\d{7}))$/.test(a);case"0091":return/^[987]\d{9}$/.test(a);case"0066":return/^[98]\d{8}$/.test(a);case"0049":return/^(15[12579]\d{7}|16[023]\d{7}|160\d{8}|17[012345789]\d{7}|176\d{8}|700\d{8})$/.test(a);default:return!0}};return c});
STK.register("common.setting.textCopy",function(a){var b=a.common.setting.rule,c=a.core.dom.uniqueID,d={text:"text"},e=function(a){var b=[];for(var c in a)b.push(a[c]);return b};return function(e,f){var g,h={blur:function(b){var c=a.fixEvent(b).target;i.text.reset(c);a.custEvent.fire(o,"blur",{type:options.actionType,el:c});var d=c.getAttribute("no_cls");d!="true"&&a.removeClassName(c,options.focusCS)},focus:function(b){var c=a.fixEvent(b).target;i.text.place(c);a.custEvent.fire(o,"focus",{type:options.actionType,el:c});var d=c.getAttribute("no_cls");d!="true"&&a.addClassName(c,options.focusCS)},keyup:function(b){var c=a.fixEvent(b).target;a.custEvent.fire(o,"keyup",{type:options.actionType,el:c})}},i={text:{place:function(a){a.value.replace(/^\s+|\s+$/g,"")==k[c(a)].data[d.text]&&(a.value="")},reset:function(a){b.isEmpty(a.value)&&(a.value=k[c(a)].data[d.text]||"")}}},j=function(a){m.buildItem(a);m.active(a.el)},k={},l={click:j,focusin:j},m={init:function(){m.parseParam();m.bind()},parseParam:function(){options=a.parseParam({actionType:"text_copy",focusCS:"W_input_focus"},f);d=a.parseParam(d,f)},bind:function(){g=a.core.evt.delegatedEvent(e);for(var b in l)g.add(options.actionType,b,l[b])},destroy:function(){g.destroy();for(var b in k)for(var c in h)a.removeEvent(b.el,c,h[c])},buildItem:function(b){var e=c(b.el);if(!k[e]){k[e]={el:b.el||"",data:{}};for(var f in d)k[e].data[d[f]]=b.data[d[f]]||"";for(var g in h)a.addEvent(b.el,g,h[g])}},active:function(b){i.text.place(b);var c=b.getAttribute("no_cls");c!="true"&&a.addClassName(b,options.focusCS)}},n={isCopyText:function(b){var c=b.getAttribute("action-type"),d=a.queryToJson(b.getAttribute("action-data"));return b.value.replace(/^\s+|\s+$/g,"")==(d[c].replace(/^\s+|\s+$/g,"")||"")},build:m.buildItem};m.init();var o={};o.API=n;o.destroy=m.destroy;return o}});
STK.register("common.setting.form",function(a){var b=["input","textarea","select","a","div","ul","li","em"];return function(c,d){var e={},f,g="form",h={ctls:{},states:{}},i={reset:function(a){for(var b in a)h.states[b]=a[b]}},j={init:function(){j.pars();j.build();j.bind()},pars:function(){if(!c)throw"from is undefined";f=a.parseParam({proxy:null},d)},build:function(){e.domList=a.builder(c).list},bind:function(){a.custEvent.define(e,["reset"]);a.custEvent.add(e,"reset",i.reset)},add:function(a,b){h.ctls[a]=b},getData:function(){var d={};for(var e in h.ctls){var f=h.ctls[e];d[f.name()]=f.value()}return a.parseParam(a.htmlToJson(c,b),d)},check:function(a){if(a){var b=h.ctls[a];h.states[a]=b.check();return h.states[a].type}var c=!0;for(var d in h.ctls){var b=h.ctls[d];b.pars.iorecords?h.states[d]=b.msg:h.states[d]=b.check();c=c&&h.states[d].state}return c},reset:function(){for(var a in h.ctls)h.states[a].reset()},states:function(){for(var a in h.ctls)h.states[a]=h.ctls[a].msg;return h.states},destroy:function(){for(var a in h.ctls)h.ctls[a].destroy()}};j.init();e.ctls=function(){return h.ctls}();e.states=j.states;e.add=j.add;e.getData=j.getData;e.check=j.check;e.reset=j.reset;e.destroy=j.destroy;return e}});
STK.register("common.setting.base",function(a){return function(){var b={};b.frame=["id","preInit","init","initPars","build","bind","errText","setMust","setMsg","disabled","check","name","value","reset","fire","destroy"];for(var c in b.frame)b[b.frame[c]]=a.core.func.empty;return b}});
STK.register("common.setting.dataType",function(a){var b=a.kit.extra.language,c={msg:{id:"",state:!0,type:"empty",code:"",action:"",msg:"",iodata:null,iorecords:!1},initPars:{text:"",hook:null,type:"",proxy:null,iokey:null,disabled:!1,iodelay:0,must:!0,auto:!0},errText:{E00:b("#L{ç³»ç»ç¹å¿}")}},d={};d.get=function(b){return a.core.json.clone(c[b])||{}};return d});
STK.register("common.setting.control",function(a){return function(b,c,d){var e=a.common.setting.base();e.preInit=function(){e.id=a.core.dom.uniqueID(b);e.dataType=a.common.setting.dataType;e.rule=a.common.setting.rule;e.pars=a.parseParam(e.dataType.get("initPars"),c)};e.init=function(){e.initPars();e.build();e.bind()};e.initPars=function(){e.check();e.msg.msg=e.errText[e.msg.code]||"";e.msg.action="init";e.cache_value=null;e.old_value=e.value();var a=["must","disabled"];for(var b=0,c=a.length;b<c;b++){var d=a[b];e.pars[d]=e.rule.turnBoolean(e.pars[d])}};e.build=function(){e.rule.isEmpty(b.defaultValue)&&(e.pars.text?b.value=e.pars.text:b.value="");e.pars.disabled&&e.disabled(e.pars.disabled);e.node=b};e.bind=function(){for(var c in d.evtAct)a.addEvent(b,c,d.evtAct[c]);if(e.pars.iokey){var f=function(){e.pars.iorecords=!1};a.addEvent(b,"change",f)}};e.check=function(){e.msg=e.dataType.get("msg");e.msg.id=e.id;e.msg.action="check";if(e.pars.disabled){e.msg.state=!0;e.msg.type="empty";e.msg.code="E01"}else d.check&&d.check();e.msg.msg=e.errText[e.msg.code];return e.msg};e.setMust=function(a){a=e.rule.turnBoolean(a);a!=undefined&&(e.pars.disabled=a)};e.setMsg=function(b){e.pars.iokey&&(e.pars.iorecords=!1);e.msg=a.parseParam(e.dataType.get("msg"),b)};e.fire=function(){e.errText[e.msg.code]&&(e.msg.msg=e.errText[e.msg.code]);var b={};b[e.type]=e.msg;e.pars.hook&&a.custEvent.fire(e.pars.hook,"check",b)};e.disabled=function(a){a=e.rule.turnBoolean(a);if(a!=undefined){e.pars.disabled=a;a?b.disabled=!0:b.disabled=!1}};e.name=function(){return b.getAttribute("name")||e.id};e.value=function(a){if(typeof a!="undefined")b.value=a;else return b.value===e.pars.text?"":b.value.replace(/^\s+|\s+$/g,"")};e.reset=function(b){e.value(e.old_value);e.pars=a.parseParam(e.dataType.get("initPars"),c);e.check();e.msg.action="reset";!b&&e.fire()};e.destroy=function(){for(var c in d.evtAct)a.removeEvent(b,c,d.evtAct[c])};e.preInit();return e}});
STK.register("common.setting.verifycode",function(a){var b={E01:"",E02:"#L{è¯·è¾å¥éªè¯ç }",E03:"#L{éªè¯ç è¾å¥æè¯¯}"};return function(c,d){var e=function(){var a=g.value().replace(/^\s+|\s+$/g,""),b=!1;if(!g.pars.must&&g.rule.isEmpty(a)){g.msg.state=!0;g.msg.type="empty";g.msg.code="E01"}else{if(!b&&g.rule.isEmpty(a)){b=!0;g.msg.type="empty";g.msg.code="E02"}if(!b&&!g.rule.lenLimit(a,1,6)){b=!0;g.msg.type="err";g.msg.code="E03"}if(!b){g.msg.state=!0;g.msg.type="empty";g.msg.code="E01"}else g.msg.state=!1}},f={focus:function(){g.cache_value=g.value();if(g.rule.isEmpty(g.cache_value)){g.msg.state=!1;g.msg.action="focus";g.msg.type="tip";g.msg.code="E02";g.fire()}},blur:function(){c.value=g.rule.reNullChar(c.value);g.msg.action="focus";e();g.fire()}},g=a.common.setting.control(c,d,{evtAct:f,check:e}),h=a.core.obj.sup(g,["initPars"]);g.initPars=function(){h.initPars();g.errText=a.common.extra.parseLanguage(b);g.type="verifycode"};g.pars.auto&&g.init();return g}});
STK.register("common.setting.vsncode",function(a){var b={E01:"",E02:"#L{è¯·è¾å¥å¾®ç¾å¨æç }",E03:"#L{å¨æç æè¯¯ï¼è¯·éæ°è¾å¥}"};return function(c,d){var e=function(){var a=g.value().replace(/^\s+|\s+$/g,""),b=!1;if(!g.pars.must&&g.rule.isEmpty(a)){g.msg.state=!0;g.msg.type="empty";g.msg.code="E02"}else{if(!b&&g.rule.isEmpty(a)){b=!0;g.msg.type="empty";g.msg.code="E02"}if(!b&&!g.rule.lenLimit(a,1,6)){b=!0;g.msg.type="err";g.msg.code="E03"}if(!b){g.msg.state=!0;g.msg.type="empty";g.msg.code="E01"}else g.msg.state=!1}},f={focus:function(){g.cache_value=g.value();if(g.rule.isEmpty(g.cache_value)){g.msg.state=!1;g.msg.action="focus";g.msg.type="tip";g.msg.code="E02";g.fire()}},blur:function(){c.value=g.rule.reNullChar(c.value);g.msg.action="blur";e();g.fire()}},g=a.common.setting.control(c,d,{evtAct:f,check:e}),h=a.core.obj.sup(g,["initPars"]);g.initPars=function(){h.initPars();g.errText=a.common.extra.parseLanguage(b);g.type="vsncode"};g.pars.auto&&g.init();return g}});
STK.register("common.setting.username",function(a){var b={E01:"",E02:"#L{è¯·è¾å¥ç»å½å}",E03:"#L{è¯·è¾å¥æ­£ç¡®çç»å½å}"};return function(c,d){var e,f=function(){var a=h.value(),b=!1;if(!h.pars.must&&h.rule.isEmpty(a)){h.msg.state=!0;h.msg.type="empty";h.msg.code="E01"}else{if(!b&&h.rule.isEmpty(a)){b=!0;h.msg.type="empty";h.msg.code="E02"}if(!b&&!h.rule.lenLimit(a,1,128)){b=!0;h.msg.type="err";h.msg.code="E03"}if(!b){h.msg.state=!0;h.msg.type="ok";h.msg.code="E01"}else h.msg.state=!1}},g={},h=a.common.setting.control(c,d,{evtAct:g,check:f}),i=a.core.obj.sup(h,["initPars"]);h.initPars=function(){i.initPars();h.errText=a.common.extra.parseLanguage(b);h.type="username"};h.pars.auto&&h.init();return h}});
STK.register("common.setting.passwordlite",function(a){var b={E01:"",E02:"#L{è¯·è¾å¥å¯ç }",E03:"#L{è¯·è¾å¥æ­£ç¡®çå¯ç }"},c;return function(d,e){var f=function(){var a=j.value(),b=!1;if(!j.pars.must&&j.rule.isEmpty(a)){j.msg.state=!0;j.msg.type="empty";j.msg.code="E01"}else{if(!b&&j.rule.isEmpty(a)){b=!0;j.msg.type="empty";j.msg.code="E02"}if(!b&&!j.rule.lenLimit(a,1,24)){b=!0;j.msg.type="err";j.msg.code="E03"}if(!b){j.msg.state=!0;j.msg.type="ok";j.msg.code="E01"}else j.msg.state=!1}},g=a.core.dom.next(d),h={init:function(){h.auto()},auto:function(){j.rule.isEmpty(j.value())?h.show():h.hide()},show:function(){if(g){g.style.display="";a.addEvent(g,"click",function(){d.focus();a.removeEvent(g,"click",arguments.callee)})}},hide:function(){g&&(g.style.display="none")}},i={focus:function(){j.cache_value=j.value();if(j.rule.isEmpty(j.cache_value)){j.msg.state=!1;j.msg.action="focus";j.msg.type="tip";j.msg.code="E02";j.fire()}h.hide()},blur:function(){c&&clearTimeout(c);d.value=j.rule.reNullChar(d.value);j.msg.action="blur";f();j.fire();h.auto()}},j=a.common.setting.control(d,e,{evtAct:i,check:f}),k=a.core.obj.sup(j,["initPars"]);j.initPars=function(){k.initPars();j.errText=a.common.extra.parseLanguage(b);j.type="password"};j.pars.auto&&j.init();h.init();return j}});
STK.register("common.form.verifycodeSSO",function(a){var b=a.common.channel.sso.login;return function(c){var d={init:function(){if(!a.core.dom.isNode(c))throw"Node of verify photo is necessary!";d.bind();b.fire("pincode")},bind:function(){b.register("pincode.update",d.callback)},callback:function(a){c.src=a;d.destroy()},destroy:function(){b.remove("pincode.update",d.callback)}};d.init();return{}}});
STK.register("common.form.ssoErrCode",function(a){var b=window.top==window.self;return{4038:'#L{ç»å½æ¬¡æ°è¿äºé¢ç¹ï¼}<a href="http://help.weibo.com/faq/q/85/12699#12699" target="_blank">#L{æ¥çå¸®å©}</a>',4049:"#L{è¯·å¡«åéªè¯ç }",4010:'#L{å¸å·å°æªæ¿æ´»ã}<a target="_blank" href="http://weibo.com/signup/v5/resend?username=#{USERNAME}">#L{éåæ¿æ´»é®ä»¶}</a>',4090:"#L{æ­¤å¸å·æªæ¿æ´»ï¼è¯·ç»å½åå¸å·}",5024:"#L{è¯·å¡«åæ­£ç¡®çå¾®ç¾å¨æç }",5025:"#L{å¨æç æè¯¯ï¼è¯·éæ°è¾å¥}",5:'#L{å°æªæ³¨åå¾®åï¼}<a href="http://weibo.com/logout.php?backurl='+encodeURIComponent("http://weibo.com/signup/signup.php")+'"'+(b?"":' target="_blank"')+">#L{é©¬ä¸æ³¨å}</a>",101:'#L{ç¨æ·åæå¯ç éè¯¯ã}<a href="http://help.weibo.com/faq/q/85/12606#12606" target="_blank">#L{æ¥çå¸®å©}</a>',4098:'#L{æ¨çå¸å·è¿æ²¡æè®¾ç½®å¯ç ï¼ä¸ºæ¹ä¾¿ç»å½è¯·}<a href="https://login.sina.com.cn/getpass.html?entry=weibo" target="_blank">#L{éç½®å¯ç }</a>',9999:"#L{å½åç½ç»è¶æ¶ï¼è¯·ç¨ååè¯}",2071:"#L{æ¨å·²å¼å¯ç»å½ä¿æ¤ï¼è¯·æ«ç ç»å½}"}});
STK.register("common.login.form_new",function(a){var b=["username","password","verifycode","vsncode"],c=a.core.util.templet,d=a.common.channel.sso.login,e=a.common.form.verifycodeSSO,f=a.core.evt.hotKey,g=a.kit.extra.textareaUtils,h=$CONFIG&&$CONFIG.register_url||"http://weibo.com/signup/signup.php"+(Boolean(a.URL(window.location.href).getParam("c"))?"?backurl="+encodeURI(window.location.href):""),i={CAPSLOCK:"#L{é®çå¤§åéå®å·²æå¼ï¼è¯·æ³¨æ}",ERRTIP:{CODE:a.common.form.ssoErrCode},SAVE_STATE_LAYER:'<div class="layer_pop" node-type="outer" style="position:absolute;"><p node-type="content"></p></div>',MAIN:'<div node-type="prename_box" class="info_list pre_info clearfix"></div><div node-type="username_box" class="info_list"><div class="inp username"><input autocomplete="off" maxlength="128" tabindex="1" node-type="username" name="username" type="text" class="W_input" action-type="text_copy" action-data="text=#L{é®ç®±/ä¼åå¸å·/ææºå·}" value="" /></div></div><div node-type="password_box" class="info_list"><div class="inp password"><input maxlength="24" tabindex="2" node-type="password" name="password" type="password" class="W_input" action-type="text_copy" value="" /><span class="enter_psw">#L{è¯·è¾å¥å¯ç }</span></div></div><div node-type="verifycode_box" class="info_list" style="display: none;"><div class="inp verify"><input maxlength="6" tabindex="3" node-type="verifycode" name="verifycode" type="text" class="W_input" value="" action-type="text_copy" action-data="text=#L{è¯·è¾å¥éªè¯ç }" /><a class="code" href="javascript:void(0);" onclick="return false;"><img src="" node-type="verifycode_image" action-type="btn_change_verifycode" width="100" height="40"></a><a node-type="btn_change_verifycode" action-type="btn_change_verifycode" class="verify_refresh" href="javascript:void(0);" onclick="return false;">#L{æ¢ä¸æ¢}</a></div></div><div node-type="vsncode_box" class="info_list" style="display: none;"><div class="inp wei_dun"><input maxlength="6" tabindex="4" node-type="vsncode" name="vsncode" type="text" class="W_input" action-type="text_copy" action-data="text=#L{è¯·è¾å¥å¾®ç¾å¨æç }" value="" /><a node-type="btn_vsncode_recover" href="http://account.weibo.com/forgot/vdun">#L{å¾®ç¾æå¤±}</a></div></div><div class="info_list"><div class="inp automatic clearfix"><div class="right"><a suda-data="key=tblog_weibologin3&value=click_forgetpwd" target="_blank" node-type="btn_password_recover" href="https://login.sina.com.cn/getpass.html?entry=weibo">#L{å¿è®°å¯ç }</a></div><label action-type="customTip" action-data="content=#L{å»ºè®®å¨ç½å§æå¬å±çµèä¸åæ¶è¯¥éé¡¹ã}" title="#L{å»ºè®®å¨ç½å§æå¬å±çµèä¸åæ¶è¯¥éé¡¹ã}" for="login_form_savestate"><input tabindex="5" id="login_form_savestate" checked="checked" node-type="savestate" type="checkbox" class="W_checkbox" />#L{ä¸æ¬¡èªå¨ç»å½}</label><a suda-data="key=tblog_weibologin3&value=click_help" action-type="customTip" action-data="content=#L{è®°ä¸ä½ç»å½ç¶æï¼æä¹åï¼}" title="#L{è®°ä¸ä½ç»å½ç¶æï¼æä¹åï¼}" target="_blank" class="icon_ask" href="http://help.weibo.com/faq/q/85/12524#12524"></a></div></div><div class="info_list no_reg"><a tabindex="6" suda-data="key=tblog_weibologin3&value=click_sign" node-type="submitBtn" action-type="btn_submit" class="W_btn_g" href="javascript:void(0)"><span node-type="submitStates">#L{ç»å½}</span></a></div>',SUBMIT:{NORMAL:"#L{ç»å½}",ONSUBMIT:'<b class="loading"></b>#L{ç»å½}'},PRENAME_BOX:'<div class="W_fl"><img class="W_face_radius" width="50" height="50" src="#{AVATAR}"></div><div class="info_detail"><p class="W_autocut W_f14 W_fb">#{NICKNAME}</p><p class="sub_title W_autocut S_txt2">#{LOGIN_NAME_HAZY}</p><p class="sub_txt"><a href="javascript:void(0)" action-type="use_username">#L{æ¢ä¸ªè´¦å·ç»å½}</a></p></div>'},j={username:a.common.setting.username,password:a.common.setting.passwordlite,verifycode:a.common.setting.verifycode,vsncode:a.common.setting.vsncode},k=function(){var a,b={save:function(b){a=b},load:function(){return a},reset:function(){b.save("")},cached:function(b){return a===b}};return b}(),l={cookie:{name:"un",conf:{expire:240,path:"/",domain:window.location.hostname,encode:!0}},verifyCodeDelay:3e5,savestateDelay:600,errtipDelay:5e3},m,n=function(b){if(!m){m=[];for(var c in i.ERRTIP.CODE)m.push(c)}return a.inArray(""+b,m)};return function(f,h){var m,o,p,q,r={},s,t,u,v={yalogin:!1,nopwd:!1,unChecked:!1},w={init:function(){w.parseParam();w.parseDOM();w.initPlugin();w.bind()},initPlugin:function(){x.init();u=function(){var b='<div class="W_layer W_layer_pop">\n\t<div class="content layer_mini_info">\n\t\t<p class="main_txt">\n\t\t\t<span node-type="icon" class="W_icon icon_warnS"></span>\n\t\t\t<span node-type="text"></span>\n\t<a action-type="close" href="javascript:void(0);" class="W_ficon ficon_close S_ficon">X</a>\t</p>\n\t<div class="W_layer_arrow">\n\t\t\t<span node-type="arrow" class="W_arrow_bor"><i class="S_line3"></i><em class="S_bg2_br"></em></span>\n\t\t<div>\n\t</div>\n</div>',c=a.v6.conf.core.ui.bubble(b,{showWithAni:!1,hideWithAni:!1,showWithSetWidth:!1});c.on("close","click",function(){c.hide()});return{show:function(a,b){setTimeout(function(){if(b.box.offsetWidth){c.getDomList().text.innerHTML=a;c.show().beside(b.box,{offsetY:10})}},10)},hide:function(){c.hide()},destroy:function(){c.destroy()}}}()},parseParam:function(){h=a.parseParam(l,h||{});i=a.common.extra.parseLanguage(i)},parseDOM:function(){if(!a.core.dom.isNode(f))throw"Login form node is necessary";a.core.dom.isNode(a.kit.dom.firstChild(f))||(f.innerHTML=i.MAIN)},bind:function(){m=a.core.evt.delegatedEvent(f);m.add("btn_submit","click",x.submit.active);m.add("btn_change_verifycode","click",x.resetVerifycode);m.add("use_username","click",y.use_username);a.addEvent(p.username,"focus",y.stopCheckUsername);a.addEvent(p.username,"blur",y.checkUsername);a.addEvent(p.submitBtn,"focus",x.submit.focus);a.addEvent(p.submitBtn,"blur",x.submit.blur);a.foreach(o.ctls,function(b){b.pars.disabled||a.addEvent(b.node,"keydown",z.enter)});a.addEvent(p.submitBtn,"keydown",z.enter);a.addEvent(p.password,"keypress",z.capslock);a.custEvent.define(C,["closeTip"]);a.custEvent.add(C,"closeTip",x.errTip.hide);d.register("verify.update",A.verify.update);d.register("verify.failure",A.verify.failure);d.register("verify.complete",A.verify.complete);d.register("login.success",A.login.success);d.register("login.failure",A.login.failure);d.register("login.complete",A.login.complete);d.register("logout.success",A.logout.success);d.register("logout.failure",A.logout.failure);d.register("logout.complete",A.logout.complete);d.register("yalogin.active",A.yalogin.active);d.register("yalogin.deny",A.yalogin.deny)},unbind:function(){m.remove("btn_submit","click",x.submit.active);m.remove("btn_change_verifycode","click",x.resetVerifycode);m.remove("use_username","click",y.use_username);m.destroy();a.removeEvent(p.username,"focus",y.stopCheckUsername);a.removeEvent(p.username,"blur",y.checkUsername);a.removeEvent(p.submitBtn,"focus",x.submit.focus);a.removeEvent(p.submitBtn,"blur",x.submit.blur);a.foreach(o.ctls,function(b){a.removeEvent(b.node,"keydown",z.enter)});a.removeEvent(p.submitBtn,"keydown",z.enter);a.removeEvent(p.password,"keypress",z.capslock);a.custEvent.remove(C,"closeTip",x.errTip.hide);a.custEvent.undefine(C,["closeTip"]);d.remove("verify.update",A.verify.update);d.remove("verify.failure",A.verify.failure);d.remove("verify.complete",A.verify.complete);d.remove("login.success",A.login.success);d.remove("login.failure",A.login.failure);d.remove("login.complete",A.login.complete);d.remove("logout.success",A.logout.success);d.remove("logout.failure",A.logout.failure);d.remove("logout.complete",A.logout.complete);d.remove("yalogin.active",A.yalogin.active);d.remove("yalogin.deny",A.yalogin.deny)},destroy:function(){w.unbind();x.destroy();u.destroy();for(var a in r)r[a]&&clearTimeout(r[a]);m=r=x=z=B=A=C=w=u=customTip=v=null}},x={init:function(){q=a.common.setting.textCopy(f);a.custEvent.define(q,["focus","blur","keyup"]);a.custEvent.add(q,"focus",x.textCopyHandle);a.custEvent.add(q,"blur",x.textCopyHandle);o=a.common.setting.form(f);p=a.kit.dom.parseDOM(o.domList);var c;for(var d in p)a.inArray(d,b)&&j[d]&&x.item(d);B.verifycode.disable();B.vsncode.disable();t=a.common.layer.emailAutocomplete(p.username,{autoTrim:!0,autoCase:!0,offsetX:-35,offsetY:4,width:a.core.dom.getSize(p.username.parentNode).width-4});s=a.common.extra.inputMonitor(p.username);a.custEvent.add(s,"change",function(){x.changeExtra();k.reset();v.nopwd=!1;v.unChecked=!1});x.prenameBox()},item:function(b){_data=a.queryToJson(p[b].getAttribute("action-data")||"");o.add(b,j[b](p[b],a.core.json.merge({hook:o},_data)));a.core.util.browser.MOZ&&q.API.build({el:p[b],data:_data})},textCopyHandle:function(b,c){b.type=="focus"&&x.errTip.hide();a.inArray(c.el,[p.username,p.password,p.vsncode,p.verifycode])&&(b.type=="focus"?a.addClassName(c.el.parentNode,"W_input_focus"):b.type=="blur"&&a.removeClassName(c.el.parentNode,"W_input_focus"))},getData:function(){var a=o.states();if(o.check()){var b=o.getData();p.savestate.checked&&(b.savestate=7);if(v.yalogin!==!1){b.username=""+v.yalogin;b.logintype="sub"}return b}for(var c in B)if(B[c].isVisible()){B[c].reset();break}if(!a.password.state){v.unChecked||x.checkUsername();if(v.nopwd){a.password.state=!0;a.username.state=!1;a.username.msg=i.ERRTIP.CODE[4098]}}x.errTip.show(a,1);return!1},prenameBox:function(){if(!p.prename_box)x.usernameBox();else if(a.isNode(a.kit.dom.firstChild(p.prename_box))){v.yalogin=p.preuid.value;o.ctls.username.value(p.prename.value);a.setStyle(p.prename_box,"display","");x.checkUsername()}else d.fire("yalogin.verify")},usernameBox:function(){v.yalogin=!1;p.prename_box&&a.core.dom.removeNode(p.prename_box);a.setStyle(p.username_box,"display","");x.remember.place()},checkUsername:function(){r.checkUsername&&clearTimeout(r.checkUsername);r.checkUsername=setTimeout(function(){var a=o.ctls.username;if(a.check().state){a.value(a.value());var b=a.value();if(!k.cached(b)){x.lock("username");d.fire("verify.username",b);k.save(b)}}},200)},stopCheckUsername:function(){r.checkUsername&&clearTimeout(r.checkUsername);r.checkUsername=null},errTip:{show:function(b,c){for(var d in b)if(!b[d].state){var e=""+b[d].msg;if(typeof c!="undefined"&&a.getStyle(p[d+"_box"],"display")!="none"){p[d].blur();g.setCursor(p[d])}d=="username"&&a.getStyle(p[d+"_box"],"display")=="none"&&(d="password");u.show(e,{el:p[d],box:p[d+"_box"]});break}},hide:function(){u.hide()}},changeExtra:function(a){for(var b in B)typeof a!="undefined"&&a==b?B[b].isVisible()?B[b].reset():B[b].enable():B[b].isVisible()&&B[b].disable()},resetVerifycode:function(b){b&&a.preventDefault(b.evt);B.verifycode.reset();return!1},lock:function(b){if(typeof b!="undefined"&&o.ctls[b])a.getStyle(p[b+"_box"],"display")!="none"&&!o.ctls[b].pars.disabled&&o.ctls[b].disabled(1);else for(var b in o.ctls)a.getStyle(p[b+"_box"],"display")!="none"&&!o.ctls[b].pars.disabled&&o.ctls[b].disabled(1)},unlock:function(){for(var b in o.ctls)a.getStyle(p[b+"_box"],"display")!="none"&&o.ctls[b].pars.disabled&&o.ctls[b].disabled(0)},remember:{mark:function(){var b=o.ctls.username.value();b&&a.cookie.set(h.cookie.name,b,h.cookie.conf)},place:function(){var b=o.ctls.username.value();if(!b){var c=a.cookie.get(h.cookie.name);c=unescape(c);c&&o.ctls.username.value(c)}},clear:function(){a.cookie.remove(h.cookie.name,h.cookie.conf)}},customTip:{show:function(a){customTip.show(a.el,a.data.content)},hide:function(){customTip.hide()}},reset:function(){x.errTip.hide()},submit:{active:function(){r.checkUsername&&clearTimeout(r.checkUsername);a.preventDefault();x.errTip.hide();t.hide();var b=x.getData();if(b){x.submit.start();x.lock();d.fire("login",[b.username,b.password,b,b])}return!1},start:function(){p.submitStates.innerHTML=i.SUBMIT.ONSUBMIT},stop:function(){p.submitStates.innerHTML=i.SUBMIT.NORMAL},focus:function(b){b=a.fixEvent(b);a.addClassName(b.target,"W_btn_g_current")},blur:function(b){b=a.fixEvent(b);a.removeClassName(b.target,"W_btn_g_current")}},destroy:function(){x.stopCheckUsername();x.errTip.hide();a.custEvent.undefine(q);q.destroy();s.destroy();o.destroy();t.destroy();s=o=q=t=null}},y={use_username:function(b){a.preventDefault(b.evt);o.ctls.username.value("");o.ctls.password.value("");p.password.focus();p.password.blur();x.usernameBox();g.setCursor(p.username);return!1},checkUsername:function(b){a.preventDefault(b.evt);x.checkUsername();return!1},stopCheckusername:function(b){a.preventDefault(b.evt);x.stopCheckUsername();return!1}},z={enter:function(b){b=a.fixEvent(b);x.errTip.hide();if(b.keyCode===13){if(t.onActive())return;o.check();var c=o.states(),d=b.target.getAttribute("node-type");if(d=="password"&&v.nopwd){x.errTip.show({username:{state:!1,msg:i.ERRTIP.CODE[4098]}});return}d=="username"&&!v.unChecked&&x.checkUsername();if(c[d].state==!1&&c[d].type=="empty")return;for(var e in o.ctls)if(e!=d&&!o.ctls[e].pars.disabled&&c[e].state==!1){setTimeout(function(){g.setCursor(p[e])},0);return}x.submit.active()}},capslock:function(b){b=a.fixEvent(b);var c=b.keyCode||b.which,d=b.shiftKey||c==16||!1;(c>=65&&c<=90&&!d||c>=97&&c<=122&&d)&&x.errTip.show({password:{msg:i.CAPSLOCK}})}},A={login:{complete:function(){x.unlock();x.submit.stop()},success:function(a){x.remember.mark();if(a.result){var b;$CONFIG.redirect?b=$CONFIG.redirect:a.redirect?b=a.redirect:a.userinfo&&a.userinfo.userdomain?b="http://"+window.location.hostname+"/"+a.userinfo.userdomain:b="http://"+window.location.hostname;window.location.replace(b)}},failure:function(a){var b;a.code=="50113021"&&x.usernameBox();n(a.code)?b=c(i.ERRTIP.CODE[""+a.code],{USERNAME:o.ctls.username.value()}):b=!a.reason||a.reason===""?i.ERRTIP.CODE[9999]+"("+a.code+")":a.reason;var d={};d[a.type]={msg:b,state:!1};x.errTip.show(d,1)}},logout:{complete:function(){},success:function(){},failure:function(){}},verify:{complete:function(a){x.unlock();if(a.code&&a.code==4098){var b={};b[a.type]={msg:i.ERRTIP.CODE[""+a.code],state:!1};x.errTip.show(b);v.nopwd=!0}v.unChecked=!0},update:function(a){x.changeExtra(a);v.unChecked=!0},failure:function(a){x.changeExtra(a);p[a].value=""}},yalogin:{active:function(b){var d=!1,e=setTimeout(function(){d=!0;x.usernameBox()},2500);a.kit.io.jsonp({url:"http://"+(window.location.host=="www.weibo.com"?"www.weibo.com":"weibo.com")+"/a/aj/prelogin/status",onComplete:function(f){if(!d){e&&clearTimeout(e);if(f.code=="100000"){var g=f.data;if(g.uid==b){p.prename_box.innerHTML=c(i.PRENAME_BOX,{AVATAR:g.avatar,LOGIN_NAME_HAZY:g.account,NICKNAME:g.nickname});v.yalogin=g.uid;o.ctls.username.value(g.loginname);a.setStyle(p.username_box,"display","none");a.setStyle(p.prename_box,"display","");x.checkUsername();return}}x.usernameBox()}},onFail:function(){x.usernameBox()}}).request()},deny:function(){x.usernameBox()}}},B={verifycode:{enable:function(){p.verifycode_box.style.display="";o.ctls.verifycode.disabled(0);B.verifycode.reset();a.addEvent(p.verifycode,"keydown",z.enter)},disable:function(){r.verifycode_auto&&clearTimeout(r.verifycode_auto);p.verifycode_box.style.display="none";o.ctls.verifycode.disabled(1);a.removeEvent(p.verifycode,"keydown",z.enter)},reset:function(){r.verifycode_auto&&clearTimeout(r.verifycode_auto);r.verifycode_auto=setTimeout(B.verifycode.reset,h.verifyCodeDelay);e(p.verifycode_image);p.verifycode.value=""+o.ctls.verifycode.pars.text},isVisible:function(){return!o.ctls.verifycode.pars.disabled}},vsncode:{enable:function(){p.vsncode_box.style.display="";o.ctls.vsncode.disabled(0);B.vsncode.reset();a.addEvent(p.vsncode,"keydown",z.enter)},disable:function(){p.vsncode_box.style.display="none";o.ctls.vsncode.disabled(1);a.removeEvent(p.vsncode,"keydown",z.enter)},reset:function(){p.vsncode.value=""+o.ctls.vsncode.pars.text},isVisible:function(){return!o.ctls.vsncode.pars.disabled}}},C={destroy:w.destroy};w.init();return C}});
STK.register("common.channel.sso.qrcode",function(a){var b=["qrcode_scanned","qrcode_used","qrcode_timeout","qrcode_exception","login_success","login_failure","getQRcode","getQRcode_success","start","cancel","set"];return a.common.listener.define("common.channel.sso.qrcode",b)});
STK.register("common.login.qrcode",function(a){return function(b){var c,d=a.kit.extra.language,e=a.common.channel.sso.qrcode,f={init:function(){e.fire("set",{entry:"weibo",domain:"weibo.com"});f.parseDOM();f.bind()},parseDOM:function(){c=a.kit.dom.parseDOM(a.builder(b).list)},bind:function(){for(var b in f.handle)e.register(b,f.handle[b]);a.custEvent.define(g,["enable","disable"]);a.custEvent.add(g,"enable",f.enable);a.custEvent.add(g,"disable",f.disable)},unbind:function(){},handle:{getQRcode_success:function(a){c.qrcode_src.src=a.data.image;c.qrcode_src.hasCode=!0},qrcode_scanned:function(a){c.scan_mask.style.display="";c.scan_success.style.display=""},qrcode_used:function(a){f.getQRcode()},qrcode_timeout:function(a){f.getQRcode()},qrcode_exception:function(a){f.getQRcode()},login_success:function(a){window.location.reload()},login_failure:function(a){f.getQRcode()}},getQRcode:function(){e.fire("getQRcode")},enable:function(){c.qrcode_src.hasCode?e.fire("start"):f.getQRcode()},disable:function(){e.fire("cancel")},destroy:function(){}},g={enable:f.enable,disable:f.disable};f.init();return g}});
STK.register("common.channel.sso.desktop",function(a){var b=["getuserinfo_ready","getuserinfo_timeout","getuserticket_ready","getuserticket_timeout","init","login","login_success","login_error","getinfo_error"];return a.common.listener.define("common.channel.sso.desktop",b)});
STK.register("common.login.desktop",function(a){var b=a.kit.extra.language,c=a.core.util.templet,d={FRAME:b('<div node-type="logged_loading" style="display:none" class="logged_loading"></div><div node-type="logged_tip" style="display:none" class="wrong_tips"></div><div node-type="logged_acc_show" class="logged_acc_show"><p class="logged_tips W_tc S_txt2">#L{ç¹å»å¤´åç»å½ä½ çå¾®å}</p><div class="logged_acc_show_bg"><div class="logged_accs clearfix" node-type="logged_userlist"></div></div><a node-type="arrow" action-type="left" style="display:none" class="acc_arrow l_arrow" href="jsvascript:void(0);"></a><a node-type="arrow" action-type="right" style="display:none" class="acc_arrow r_arrow" href="jsvascript:void(0);"></a></div><div class="register_tips"><em class="S_txt2">#L{è¿æ²¡æå¾®åï¼}</em><a target="_blank" href="'+($CONFIG&&$CONFIG.register_url||"http://weibo.com/signup/signup.php")+'">#L{ç«å³æ³¨å}</a>'+"</div>"),USER:'<div class="logged_acc"><a action-type="login" action-data="uid=#{UID}" href="jsvascript:void(0);" class="logged_acc_bg"><img class="acc_avatar" src="#{AVATOR}"><div title="#{NICKNAME}" class="acc_name W_autocut">#{NICKNAME}</div></a></div>',TIP:b('<div class="W_f14 S_txt2">#{MSG}</div>')};return function(b){var e=a.common.channel.sso.desktop,f=!1,g,h,i={small_acc_width:75,current_acc:0,on_scroll:!1,play_duration:120},j=["loading","tip","acc_show"],k=!1,l=0,m=function(){l++;return l>5?!0:!1},n={init:function(){n.bind();n.scan()},bind:function(){h=a.core.evt.delegatedEvent(b);for(var c in n.domEvts)h.add(c,"click",n.domEvts[c]);a.custEvent.define(o,["desktop","refresh"]);for(var c in n.castEvts)a.custEvent.add(o,c,n.castEvts[c]);for(var c in n.handle)e.register(c,n.handle[c])},handle:{getuserinfo_ready:function(b){if(b.code==0){g=b.data;n.render();if(!k){a.custEvent.fire(o,"desktop",1);k=!0}}else a.custEvent.fire(o,"desktop",0)},getuserinfo_timeout:function(){a.custEvent.fire(o,"desktop",0)},getuserticket_timeout:function(){n.refresh()},login_success:function(a){a&&a.retcode==="0"&&window.location.reload()},login_failure:function(a){var b=a.msg;b.indexOf("|")>0&&(b=b.substr(0,b.indexOf("|")));nodes.logged_tip.innerHTML=c(d.TIP,{MSG:b});n.access("tip")},getinfo_error:function(b){a.custEvent.fire(o,"desktop",0)}},domEvts:{back:function(b){a.preventDefault(b.evt);n.back()},login:function(b){a.preventDefault(b.evt);n.access("loading");e.fire("login",b.data.uid)},left:function(b){a.preventDefault(b.evt);if(!i.on_scroll){i.on_scroll=!0;i.current_acc>=2?i.current_acc-=2:i.current_acc--;a.core.ani.tween(nodes.logged_userlist,{duration:i.play_duration,end:function(){a.setStyle(nodes.arrow[1],"display","");i.current_acc<=0&&a.setStyle(nodes.arrow[0],"display","none");i.on_scroll=!1}}).finish({marginLeft:i.current_acc*i.small_acc_width*-1})}},right:function(b){a.preventDefault(b.evt);if(!i.on_scroll){i.on_scroll=!0;g.length-3-i.current_acc>=2?i.current_acc+=2:i.current_acc++;a.core.ani.tween(nodes.logged_userlist,{duration:i.play_duration,end:function(){a.setStyle(nodes.arrow[0],"display","");g.length-i.current_acc<=3&&a.setStyle(nodes.arrow[1],"display","none");i.on_scroll=!1}}).finish({marginLeft:i.current_acc*i.small_acc_width*-1})}}},access:function(b){if(!!a.inArray(b,j))for(var c in j)a.setStyle(nodes["logged_"+j[c]],"display",b==j[c]?"":"none")},castEvts:{refresh:function(){n.refresh()}},refresh:function(){n.access("loading");n.scan()},render:function(){b.innerHTML=d.FRAME;nodes=a.kit.dom.parseDOM(a.builder(b).list);nodes.logged_acc_show.className="logged_acc_show";a.setStyles(nodes.arrow,"display","none");var e="avator";switch(g.length){case 1:e="avator_middle";break;case 2:e="avator_middle";a.addClassName(nodes.logged_acc_show,"multi_acc_two");break;case 3:e="avator_small";a.addClassName(nodes.logged_acc_show,"multi_acc_three");break;default:e="avator_small";a.addClassName(nodes.logged_acc_show,"multi_acc_three");a.setStyle(nodes.arrow[1],"display","")}var f=[];for(var h in g)f.push(c(d.USER,{NICKNAME:g[h].name,AVATOR:g[h][e],UID:g[h].uid}));nodes.logged_userlist.innerHTML=f.join("")},scan:function(){e.fire("init")}},o={};n.init();return o}});
STK.register("common.setting.mobile",function(a){var b={E01:"",E02:"#L{ç®åæ¯æå¤§éãæ¸¯æ¾³å°ææºå·æ³¨å}",E03:"#L{è¯·è¾å¥ææºå·ç }",E04:"#L{ææºå·é¿åº¦11ä½ï¼ä»¥13/14/15/17/18å¼å¤´}"};return function(c,d){var e=function(){var a=g.value(),b=!1;if(!g.pars.must&&g.rule.isEmpty(a)){g.msg.state=!0;g.msg.type="empty";g.msg.code="E01"}else{if(!b&&g.rule.isEmpty(a)){b=!0;g.msg.type="err";g.msg.code="E03"}if(!b&&!g.rule.isMobile(a)){b=!0;g.msg.type="err";g.msg.code="E04"}if(!b){g.msg.state=!0;g.msg.type="ok";g.msg.code="E01"}else g.msg.state=!1}},f={focus:function(){g.cache_value=g.value();if(g.rule.isEmpty(g.cache_value)){g.msg.state=!1;g.msg.action="focus";g.msg.type="tip";g.msg.code="E02";g.fire()}},blur:function(){c.value=g.rule.reNullChar(c.value);g.msg.action="blur";var b=g.value();if(!(b&&g.cache_value==b&&g.pars.proxy&&g.pars.iokey)){g.cache_value=null;if(g.pars.iodelay===0&&!g.pars.proxy&&!g.pars.iokey){e();g.fire()}else ioDelay=setTimeout(function(){e();if(g.msg.state&&g.pars.proxy&&g.pars.iokey){g.msg.type="loading";g.pars.iorecords=!0;g.pars.proxy.request(g.pars.iokey,{onSuccess:function(b){g.msg=a.parseParam(g.msg,b.data||{});g.msg.state=!0;g.fire()},onError:function(b){g.msg=a.parseParam(g.msg,b.data||{});g.msg.state=!1;g.fire()}},{type:g.type,value:encodeURIComponent(g.value())})}g.fire()},g.pars.iodelay)}}},g=a.common.setting.control(c,d,{evtAct:f,check:e}),h=a.core.obj.sup(g,["initPars"]);g.initPars=function(){h.initPars();g.errText=a.common.extra.parseLanguage(b);g.type="mobile"};g.pars.auto&&g.init();return g}});
STK.register("common.setting.activation",function(a){var b={E01:"",E02:"#L{è¯·è¾å¥ç­ä¿¡æ¿æ´»ç }",E03:"#L{æ¿æ´»ç è¾å¥æè¯¯}"};return function(c,d){var e=function(){var a=g.value().replace(/^\s+|\s+$/g,""),b=!1;if(!g.pars.must&&g.rule.isEmpty(a)){g.msg.state=!0;g.msg.type="empty";g.msg.code="E01"}else{if(!b&&g.rule.isEmpty(a)){b=!0;g.msg.type="err";g.msg.code="E02"}if(!b&&!g.rule.lenLimit(a,0,6)){b=!0;g.msg.type="err";g.msg.code="E03"}if(!b){g.msg.state=!0;g.msg.type="empty";g.msg.code="E01"}else g.msg.state=!1}},f={focus:function(){g.cache_value=g.value();if(g.rule.isEmpty(g.cache_value)){g.msg.state=!1;g.msg.action="focus";g.msg.type="tip";g.msg.code="E02";g.fire()}},blur:function(){c.value=g.rule.reNullChar(c.value);g.msg.action="blur";e();g.fire()}},g=a.common.setting.control(c,d,{evtAct:f,check:e}),h=a.core.obj.sup(g,["initPars"]);g.initPars=function(){h.initPars();g.errText=a.common.extra.parseLanguage(b);g.type="activation"};g.pars.auto&&g.init();return g}});
STK.register("common.setting.timer",function(a){var b={ss:1,mm:60,hh:3600,dd:86400};return function(c,d){var e={},f,g,h={init:function(){f=a.parseParam({time:0,loop:"ss"},c);d=d||function(){}},start:function(a){var a=f.time,c=function(){d({last:a,dd:Math.floor(a/b.dd),hh:Math.floor(a%b.dd/b.hh),mm:Math.floor(a%b.dd%b.hh/b.mm),ss:a%b.mm});a==0&&clearInterval(g);a-=b[f.loop]};g=setInterval(c,b[f.loop]*1e3)},stop:function(){clearInterval(g)},destroy:function(){}};h.init();e.start=h.start;e.stop=h.stop;e.destroy=h.destroy;return e}});
STK.register("kit.io.ajax",function(a){var b=function(b,c,d){c=c|0||1;d=d||"fail";var e=b.args;e.__rnd&&delete e.__rnd;(new Image).src="http://weibolog.sinaapp.com/?t="+c+"&u="+encodeURIComponent(b.url)+"&p="+encodeURIComponent(a.core.json.jsonToQuery(e))+"&m="+d};return function(c){var d={},e=[],f=null,g=!1,h=a.parseParam({url:"",method:"get",responseType:"json",timeout:3e4,onTraning:a.funcEmpty,isEncode:!0},c);h.onComplete=function(a){g=!1;c.onComplete(a,h.args);setTimeout(i,0)};h.onFail=function(a){g=!1;if(typeof c.onFail=="function")try{c.onFail(a,h.args)}catch(d){}setTimeout(i,0);try{b(h)}catch(d){}};h.onTimeout=function(a){try{b(h);c.onTimeout(a)}catch(d){}};var i=function(){if(!!e.length){if(g===!0)return;g=!0;h.args=e.shift();if(h.method.toLowerCase()=="post"){var b=a.core.util.URL(h.url);b.setParam("__rnd",+(new Date));h.url=b.toString()}f=a.ajax(h)}},j=function(a){while(e.length)e.shift();g=!1;if(f)try{f.abort()}catch(b){}f=null};d.request=function(a){a||(a={});c.noQueue&&j();if(!c.uniqueRequest||!f){e.push(a);a._t=0;i()}};d.abort=j;return d}});
STK.register("kit.io.ijax",function(a){return function(b){var c=a.parseParam({url:"",timeout:3e4,isEncode:!0,abaurl:null,responseName:null,varkey:"callback",abakey:"callback"},b),d=[],e=null,f=!1;c.onComplete=function(a,d){f=!1;b.onComplete(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};c.onFail=function(a,d){f=!1;b.onFail(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};var g=function(){var b;if(!!d.length){if(f===!0)return;f=!0;b=d.shift();c.args=b.args;c.form=b.form;e=a.ijax(c)}},h=function(a){while(d.length)d.shift();f=!1;if(e)try{e.abort()}catch(b){}e=null},i={};i.request=function(c,e){if(!a.isNode(c))throw"[kit.io.ijax.request] need a form as first parameter";e||(e={});b.noQueue&&h();d.push({form:c,args:e});g()};i.abort=h;return i}});
STK.register("kit.io.inter",function(a){var b=a.core.json.merge;return function(){var c={},d={},e={},f=function(a,b){return function(c,d){try{b.onComplete(c,d)}catch(f){}try{if(c.code==="100000")b.onSuccess(c,d);else{if(c.code==="100002"){location.href=c.data;return}b.onError(c,d)}}catch(f){}for(var g in e[a])try{e[a][g](c,d)}catch(f){}}};c.register=function(a,b){if(typeof d[a]!="undefined")throw a+" registered";d[a]=b;e[a]={}};c.addHook=function(b,c){var d=a.core.util.getUniqueKey();e[b][d]=c;return d};c.rmHook=function(a,b){e[a]&&e[a][b]&&delete e[a][b]};c.getTrans=function(c,e){var g=b(d[c],e);g.onComplete=f(c,e);var h=d[c].requestMode,i="ajax";if(h==="jsonp"||h==="ijax")i=h;return a.kit.io[i](g)};c.request=function(c,e,g){var h=b(d[c],e);h.onComplete=f(c,e);h=a.core.obj.cut(h,["noqueue"]);h.args=g;var i=d[c].requestMode;return i==="jsonp"?a.jsonp(h):i==="ijax"?a.ijax(h):a.ajax(h)};return c}});
STK.register("common.trans.sso.message",function(a){var b=a.kit.io.inter(),c=b.register;c("send_sms",{url:"http://login.sina.com.cn/sso/msglogin",requestMode:"jsonp",varkey:"callback"});return b});
STK.register("common.login.message",function(a){var b=["mobile","activation"],c=a.core.util.templet,d=a.common.channel.sso.login,e=a.common.trans.sso.message,f=a.kit.extra.textareaUtils,g={TIPS:{SEND_SMS_SUCCESS:"#L{éªè¯ç åéæåï¼60ç§åæªæ¶å°è¯·éæ°è·å}",SEND_SMS_ERROR:'#L{éªè¯ç æ æ³åéï¼è¯·ç¨<a href="javascript:window.location.reload()">å·æ°é¡µé¢</a>ååè¯}',LOGIN_SMS_ERROR:"#L{éªè¯ç è¾å¥æè¯¯}",MOBILE_FORMAT_ERROR:"#L{è¯·è¾å¥æ­£ç¡®çææºå·}",SEND_SMS_TOOFAST:"#L{åééªè¯ç è¿é¢ï¼è¯·ç¨ååè¯}",MOBILE_NOT_REGISTER:'#L{æ­¤å·ç å°æªæ³¨åï¼<a href="http://weibo.com/signup/signup.php">ç«å³æ³¨å</a>}',ACTIVATION_EMPTY:"#L{è¯·è¾å¥ç­ä¿¡éªè¯ç }"},ERRTIP:{CODE:a.common.form.ssoErrCode},SUBMIT:{NORMAL:"#L{ç»å½}",ONSUBMIT:'<b class="loading"></b>#L{ç»å½}'}},h=function(){var a,b={save:function(b){a=b},load:function(){return a},reset:function(){b.save("")},cached:function(b){return a===b}};return b}(),i,j=function(b){if(!i){i=[];for(var c in g.ERRTIP.CODE)i.push(c)}return a.inArray(""+b,i)};return function(i,k){var l,m,n,o,p,q,r={},s={unChecked:!1},t=null,u={init:function(){u.parseParam();u.initPlugins();u.bind()},parseParam:function(){g=a.common.extra.parseLanguage(g)},bind:function(){o=a.core.evt.delegatedEvent(i);for(var b in u.domEvt)o.add(b,"click",u.domEvt[b]);a.addEvent(m.mobile,"focus",v.stopCheckUsername);a.addEvent(m.mobile,"blur",v.checkUsername);a.addEvent(m.submitBtn,"focus",v.submit.focus);a.addEvent(m.submitBtn,"blur",v.submit.blur);a.custEvent.define(x,["disable"]);a.custEvent.add(x,"disable",u.disable);d.register("verify.update",w.verify.update);d.register("verify.failure",w.verify.failure);d.register("verify.complete",w.verify.complete);d.register("login.success",w.login.success);d.register("login.failure",w.login.failure);d.register("login.complete",w.login.complete);d.register("logout.success",w.logout.success);d.register("logout.failure",w.logout.failure);d.register("logout.complete",w.logout.complete)},unbind:function(){for(var b in u.domEvt)o.remove(b,"click",u.domEvt[b]);o.destroy();a.removeEvent(m.mobile,"focus",v.stopCheckUsername);a.removeEvent(m.mobile,"blur",v.checkUsername);a.removeEvent(m.submitBtn,"focus",v.submit.focus);a.removeEvent(m.submitBtn,"blur",v.submit.blur);a.custEvent.remove(x,"closeTip",v.errTip.hide);a.custEvent.undefine(x,["closeTip"]);d.remove("verify.update",w.verify.update);d.remove("verify.failure",w.verify.failure);d.remove("verify.complete",w.verify.complete);d.remove("login.success",w.login.success);d.remove("login.failure",w.login.failure);d.remove("login.complete",w.login.complete);d.remove("logout.success",w.logout.success);d.remove("logout.failure",w.logout.failure);d.remove("logout.complete",w.logout.complete)},initPlugins:function(){v.init();q=function(){var b='<div class="W_layer W_layer_pop">\n\t<div class="content layer_mini_info">\n\t\t<p class="main_txt">\n\t\t\t<span node-type="icon" class="W_icon icon_warnS"></span>\n\t\t\t<span node-type="text"></span>\n\t<a action-type="close" href="javascript:void(0);" class="W_ficon ficon_close S_ficon">X</a>\t</p>\n\t<div class="W_layer_arrow">\n\t\t\t<span node-type="arrow" class="W_arrow_bor"><i class="S_line3"></i><em class="S_bg2_br"></em></span>\n\t\t<div>\n\t</div>\n</div>',c=a.v6.conf.core.ui.bubble(b,{showWithAni:!1,hideWithAni:!1,showWithSetWidth:!1});c.on("close","click",function(){c.hide()});return{show:function(a,b){c.getDomList().text.innerHTML=a;c.show().beside(b.box,{offsetY:10})},hide:function(){c.hide()},destroy:function(){c.destroy()}}}()},domEvt:{btn_sms_activation:function(b){a.preventDefault();r.checkUsername&&clearTimeout(r.checkUsername);v.errTip.hide();var c=l.ctls.mobile.check();if(!c.state)v.errTip.show({mobile:c});else if(!s.unChecked){t=v.sendSMS;h.reset();v.checkUsername()}else v.sendSMS()},btn_submit:function(){a.preventDefault();v.submit.active()}},disable:function(){v.errTip.hide();p&&p.stop();for(var a in l.ctls)l.ctls[a].value(l.ctls[a].pars.text)},destroy:function(){u.unbind();v.destroy();q.destroy();p=q=r=s=t=null}},v={init:function(){n=a.common.setting.textCopy(i);a.custEvent.define(n,["focus","blur","keyup"]);a.custEvent.add(n,"focus",v.handle.textCopy);a.custEvent.add(n,"blur",v.handle.textCopy);l=a.common.setting.form(i);m=a.kit.dom.parseDOM(l.domList);var c,d;for(var e in b){d=b[e];if(a.common.setting[d]){c=a.queryToJson(m[d].getAttribute("action-data")||"");l.add(d,a.common.setting[d](m[d],a.core.json.merge({hook:l},c)));a.core.util.browser.MOZ&&n.API.build({el:m[d],data:c})}}monitor=a.common.extra.inputMonitor(m.mobile);a.custEvent.add(monitor,"change",function(){h.reset();s.unChecked=!1;typeof t=="function"&&(t=null)})},handle:{textCopy:function(b,c){b.type=="focus"&&v.errTip.hide();a.inArray(c.el,[m.mobile,m.activation])&&(b.type=="focus"?a.addClassName(c.el.parentNode,"W_input_focus"):b.type=="blur"&&a.removeClassName(c.el.parentNode,"W_input_focus"))}},errTip:{show:function(a,b){for(var c in a)if(!a[c].state){var d=""+a[c].msg;c=="username"&&(c="mobile");if(c=="mobile")switch(a[c].code){case"E04":d=g.TIPS.MOBILE_FORMAT_ERROR}if(c=="activation")switch(a[c].code){case"E02":d=g.TIPS.ACTIVATION_EMPTY}if(typeof b!="undefined"){m[c].blur();f.setCursor(m[c])}setTimeout(function(){q.show(d,{el:m[c],box:m[c+"_box"]})},0);break}},hide:function(){q.hide()}},getData:function(){var a=l.states();if(l.check()){var b=l.getData();m.savestate.checked&&(b.savestate=7);return b}v.errTip.show(a,1);return!1},lock:function(a){if(typeof a!="undefined"&&l.ctls[a])l.ctls[a].disabled(1);else for(var a in l.ctls)l.ctls[a].disabled(1)},unlock:function(){for(var b in l.ctls)a.getStyle(m[b+"_box"],"display")!="none"&&l.ctls[b].pars.disabled&&l.ctls[b].disabled(0)},submit:{active:function(){r.checkUsername&&clearTimeout(r.checkUsername);v.errTip.hide();var a=v.getData();if(a){v.submit.start();v.lock();a.cfrom=1;d.fire("login",[a.username,a.password,a,a])}return!1},start:function(){m.submitStates.innerHTML=g.SUBMIT.ONSUBMIT},stop:function(){m.submitStates.innerHTML=g.SUBMIT.NORMAL},focus:function(b){b=a.fixEvent(b);a.addClassName(b.target,"W_btn_g_current")},blur:function(b){b=a.fixEvent(b);a.removeClassName(b.target,"W_btn_g_current")}},checkUsername:function(){a.preventDefault();r.checkUsername&&clearTimeout(r.checkUsername);r.checkUsername=setTimeout(function(){var a=l.ctls.mobile;if(a.check().state){a.value(a.value());var b=a.value();if(!h.cached(b)){v.lock("mobile");d.fire("verify.username",b);h.save(b)}}},200)},stopCheckUsername:function(){a.preventDefault();r.checkUsername&&clearTimeout(r.checkUsername);r.checkUsername=null},sendSMS:function(){if(l.ctls.mobile.msg.state&&l.ctls.mobile.msg.type=="ok"){var b={type:"sendsms"};b.value=l.ctls.mobile.value();p=a.common.setting.timer({time:59},function(a){m.sms_timer.innerHTML=a.last;m.btn_sms_activation_disable.style.display=a.last==0?"none":"";m.btn_sms_activation.style.display=a.last==0?"":"none"});p.start();e.getTrans("send_sms",{onComplete:function(a){var b={activation:{state:!1,msg:a.msg}};if(a.retcode==2e7){b={activation:{state:!1,msg:g.TIPS.SEND_SMS_SUCCESS}};v.errTip.show(b)}else{a.retcode==50110801&&(b={mobile:{state:!1,msg:g.TIPS.MOBILE_NOT_REGISTER}});a.retcode==50110810&&(b={activation:{state:!1,msg:g.TIPS.SEND_SMS_TOOFAST}});v.errTip.show(b)}},onFailure:function(a){p.stop()}}).request({entry:"weibo",mobile:b.value,s:s.unChecked})}else v.errTip.show({mobile:l.ctls.mobile.msg},1);typeof t=="function"&&(t=null)},destroy:function(){v.stopCheckUsername();v.errTip.hide();a.custEvent.undefine(n);n.destroy();monitor.destroy();l.destroy();monitor=l=n=null}},w={login:{complete:function(){v.unlock();v.submit.stop()},success:function(a){if(a.result){var b;$CONFIG.redirect?b=$CONFIG.redirect:a.redirect?b=a.redirect:a.userinfo&&a.userinfo.userdomain?b="http://"+window.location.hostname+"/"+a.userinfo.userdomain:b="http://"+window.location.hostname;window.location.replace(b)}},failure:function(a){var b;j(a.code)?b=c(g.ERRTIP.CODE[""+a.code],{USERNAME:l.ctls.mobile.value()}):b=a.reason;if(a.code=="101"){a.type="activation";b=g.TIPS.LOGIN_SMS_ERROR;l.ctls.activation.value("")}var d={};d[a.type]={msg:b,state:!1};v.errTip.show(d,1)}},logout:{complete:function(){},success:function(){},failure:function(){}},verify:{complete:function(b){v.unlock();b.smsurl&&(s.unChecked=a.core.util.URL(b.smsurl).getParam("s"));typeof t=="function"&&(s.unChecked?t():v.errTip.show({activation:{state:!1,msg:g.TIPS.SEND_SMS_ERROR}}))},update:function(a){},failure:function(a){m[a].value=""}}},x={destroy:u.destroy};u.init();return x}});
STK.register("pl.login.joker.source.main",function(a){var b=a.v6.conf.core.ui,c=a.core.util.URL(window.location.href).getHash("type"),d=a.common.channel.sso.login;return function(c){function n(a){a=a||window.event;if(l(a,e.qrcode_src)){clearTimeout(k);e.qr_help.style.display="none"}}function m(a){a=a||window.event;if(l(a,e.qrcode_src)){clearTimeout(k);e.qr_help.style.display="block"}}function l(a,b){if(a&&a.type!="mouseout"&&a.type!="mouseover")return!1;var c=a.relatedTarget?a.relatedTarget:a.type=="mouseout"?a.toElement:a.fromElement;while(c&&c!=b)c=c.parentNode;return c!=b}var e,f,g={normal:null,qrcode:null,message:null},h="normal",i={init:function(){i.parseDOM();i.bind();i.checkState()},parseDOM:function(){e=a.kit.dom.parseDOM(a.builder(c).list)},bind:function(){f=a.core.evt.delegatedEvent(c);f.add("switchTab","click",i.domEvts.switchTab);d.register("verify.complete",function(c){if(h!=="message"||c.lm!==1)if(c.is_openlock===1){i.handle.form.qrcode();b.tipAlert(a.common.form.ssoErrCode[2071],{icon:"warnS",hideDelay:3e3}).beside(a.sizzle("img",e.qrcode_form)[0],{appendTo:document.body})}});d.register("login.failure",function(c){if(c.code=="2071"){i.handle.form.qrcode();b.tipAlert(a.common.form.ssoErrCode[2071],{icon:"warnS",hideDelay:3e3}).beside(a.sizzle("img",e.qrcode_form)[0],{appendTo:document.body})}})},checkState:function(){function c(){e.qrcode_src.style.visibility="";e.qrcode_src.onload=null;clearTimeout(b)}e.module_loading&&a.setStyle(e.module_loading,"display","none");var b;e.qrcode_src.onload=c;b=setTimeout(c,2e3);i.handle.form.qrcode()},handle:{form:{qrcode:function(){i.handle.switchForm("qrcode");g.normal&&a.custEvent.fire(g.normal,"closeTip");g.message&&a.custEvent.fire(g.message,"disable");g.qrcode||(g.qrcode=a.common.login.qrcode(e.qrcode_form));a.custEvent.fire(g.qrcode,"enable")},normal:function(){i.handle.switchForm("normal");g.qrcode&&a.custEvent.fire(g.qrcode,"disable");if(g.message){g.message.destroy();g.message=null}g.normal||(g.normal=a.common.login.form_new(e.normal_form))},message:function(){i.handle.switchForm("message");g.qrcode&&a.custEvent.fire(g.qrcode,"disable");if(g.normal){g.normal.destroy();g.normal=null}g.message||(g.message=a.common.login.message(e.message_form))}},switchForm:function(b){var c={normal:{tab:e.normal_tab,form:e.normal_form},qrcode:{tab:e.qrcode_tab,form:e.qrcode_form},message:{tab:e.message_tab,form:e.message_form}};b in c||(b="normal");h=b;b==="qrcode"?e.other.style.display="none":e.other.style.display="";a.foreach(c,function(c,d){if(d==b){d=="message"?a.removeClassName(c.tab,"qrcode_phone"):a.addClassName(c.tab,"cur");c.form.style.display=""}else{d=="message"?a.addClassName(c.tab,"qrcode_phone"):a.removeClassName(c.tab,"cur");c.form.style.display="none"}})}},domEvts:{switchTab:function(b){a.preventDefault(b.evt);b.data.type==="message"&&!a.core.dom.hasClassName(e.message_tab,"qrcode_phone")?i.handle.form.qrcode():i.handle.form[b.data.type]()}},is64IE:function(){return/win64;\sx64;/i.test(navigator.userAgent.toLowerCase())?!0:!1}},j={};i.init();var k;a.addEvent(e.qrcode_src,"mouseover",m);a.addEvent(e.qrcode_src,"mouseout",n);k=setTimeout(function(){e.qr_help.style.display="none"},3e3);var o=e.other_login_toggle;a.addEvent(o,"click",function(){var b=a.core.dom.prev(o);if(a.core.dom.hasClassName(o,"ficon_arrow_left")){a.addClassName(o,"ficon_arrow_right");a.removeClassName(o,"ficon_arrow_left");o.innerHTML="a";b.style.width="80px"}else{a.removeClassName(o,"ficon_arrow_right");a.addClassName(o,"ficon_arrow_left");o.innerHTML="b";b.style.width=""}});return j}});
STK.pageletM.register("pl.login.joker.index",function(a){return a.pl.login.joker.source.main(a.E("pl_login_form"))});
