KISSY.add("kg/tbar/2.0.0/third-party/xtemplate-shim/runtime/scope",function(t){function e(t,e){this.data=t||{},this.affix=e,this.root=this}return e.prototype={isScope:1,setParent:function(t){this.parent=t,this.root=t.root},getParent:function(){return this.parent},getRoot:function(){return this.root},set:function(t,e){this.affix||(this.affix={}),this.affix[t]=e},setData:function(t){this.data=t},getData:function(){return this.data},mix:function(e){this.affix||(this.affix={}),t.mix(this.affix,e)},has:function(t){var e=this.data,a=this.affix;return a&&t in a?!0:"object"==typeof e&&t in e},get:function(t){var e=this.data,a=this.affix;return a&&t in a?a[t]:"object"==typeof e&&t in e?e[t]:void 0},resolve:function(t,e){"."===t&&(t="this");var a,r,n,i,o,s=t.split("."),l=this;if("root"===s[0])s.shift(),l=l.root;else if(e)for(;l&&e--;)l=l.parent;var d=0;for(a=s.length;l;){for(o=1,n=l,r=0;a>r;r++)if(i=s[r],"this"!==i)if(n===l){if(!l.has(i)){o=0;break}n=l.get(i)}else{if("object"!=typeof n||!(i in n)){o=0;break}n=n[i]}else d=1;if(o)return n&&n.isScope&&(n=n.data),"function"==typeof n&&(n=n.call(this.data)),[n];if(d)break;l=l.parent}return!1}},e}),KISSY.add("kg/tbar/2.0.0/third-party/xtemplate-shim/runtime/commands",function(t,e){function a(){var e,a,n,i="",o=arguments,s=0;for(a=o.length-1;a>=0&&!s;a--)n=o[a],"string"==typeof n&&n&&(i=n+"/"+i,s="/"===n.charAt(0));return e=r(t.filter(i.split("/"),function(t){return!!t}),!s).join("/"),(s?"/":"")+e||"."}function r(t,e){for(var a,r=0,n=t.length-1,i=[];n>=0;n--)a=t[n],"."!==a&&(".."===a?r++:r?r--:i[i.length]=a);if(e)for(;r--;r)i[i.length]="..";return i=i.reverse()}var n;return n={each:function(a,r){var n,i,o,s=r.params,l=s[0],d=s[2]||"xindex",c=s[1],p="";if(l)if(i=new e,t.isArray(l)){n=l.length;for(var u=0;n>u;u++)i.data=l[u],o=i.affix={xcount:n},o[d]=u,c&&(o[c]=l[u]),i.setParent(a),p+=r.fn(i)}else for(var m in l)i.data=l[m],o=i.affix={},o[d]=m,c&&(o[c]=l[m]),i.setParent(a),p+=r.fn(i);else r.inverse&&(p=r.inverse(a));return p},"with":function(t,a){var r=a.params,n=r[0],i="";if(n){var o=new e(n);o.setParent(t),i=a.fn(o)}else a.inverse&&(i=a.inverse(t));return i},"if":function(t,e){var a=e.params,r=a[0],n="";return r?e.fn&&(n=e.fn(t)):e.inverse&&(n=e.inverse(t)),n},set:function(t,e){return t.mix(e.hash),""},include:function(r,n){var i=n.params;if(!i||1!==i.length)return t.error("include must has one param"),"";if(n.hash){var o=new e(n.hash);o.setParent(r),r=o}var s=this.config.name,l=i[0];if("."===l.charAt(0)){if("unspecified"===s)return t.error("parent template does not have name for relative sub tpl name: "+l),"";l=a(s,"../",l)}var d=this.config.loader.call(this,l);return n=t.merge(this.config),n.name=l,n.commands=this.config.commands,n.macros=this.config.macros,this.invokeEngine(d,r,n)},macro:function(a,r){var n=r.params,i=n[0],o=n.slice(1),s=this.config.macros;if(!r.fn){var l={},d=s[i];d||t.error("can not find macro:"+name),t.each(d.paramNames,function(t,e){l[t]=o[e]});var c=new e(l);return d.fn.call(this,c)}return s[i]||(s[i]={paramNames:o,fn:r.fn}),""},parse:function(t,a){return n.include.call(this,new e,a)}}},{requires:["./scope"]}),KISSY.add("kg/tbar/2.0.0/third-party/xtemplate-shim/runtime",function(t,e,a){function r(t){l.info(t)}function n(t,e){for(var a=e.split("."),r=t,n=a.length,i=0;n>i&&(r=r[a[i]],r);i++);return r}function i(e,a,r,i,o,s){var l,d=e.config,c=d.commands,p=n(c,i);if(p){try{l=p.call(e,a,r)}catch(u){t.error(u.message+': "'+i+'" at line '+o)}return{find:!0,value:l}}return s&&t.error("can not find command: "+i+'" at line '+o),{find:!1}}function o(e,a,n,i,o){var s,l=e.config,d=l.silent?r:t.error,c=a.resolve(n,i);return c===!1?d('can not find property: "'+n+'" at line '+o,"warn"):s=c[0],s}function s(a,r){var n=this;n.tpl=a,r=t.merge(p,r),r.commands=t.merge(r.commands,e),r.utils=c,r.macros=r.macros||{},this.config=r}var l,d=t.escapeHtml;l=t.getLogger?t.getLogger("s/xtemplate"):{info:function(){return t.log.apply(t,arguments)}};var c={runBlockCommand:function(e,a,i,o,s){var l=e.config,d=l.silent?r:t.error,c=l.commands,p=n(c,o);if(!p){if(i.params||i.hash)return t.error("can not find command: "+o+'" at line '+s),"";var u=a.resolve(o);u===!1?(d('can not find property: "'+o+'" at line '+s),u=""):u=u[0],p=c["if"],t.isArray(u)?p=c.each:"object"==typeof u&&(p=c["with"]),i.params=[u]}var m;try{m=p.call(e,a,i)}catch(g){t.error(g.message+': "'+o+'" at line '+s)}return m},renderOutput:function(t,e){return void 0===t&&(t=""),e&&t?d(t):t},getProperty:function(t,e,a,r,n){return o(t,e,a,r,n)},runInlineCommand:function(t,e,a,r,n){var o,s="";return o=i(t,e,a,r,n),o.find&&(s=o.value),s},getPropertyOrRunCommand:function(t,e,a,r,n,s){var l,d,c=a.hash||a.params;return d=i(t,e,a,r,s,c),d.find?l=d.value:c||(l=o(t,e,r,n,s)),l}},p={silent:!0,name:"unspecified",loader:function(e){var a=t.require(e);return a||t.error('template "'+e+'" does not exist, need to be required or used first!'),a}};return t.mix(s,{commands:e,utils:c,addCommand:function(t,a){e[t]=a},removeCommand:function(t){delete e[t]}}),s.prototype={constructor:s,invokeEngine:function(t,e,a){return new this.constructor(t,a).render(e,!0)},removeCommand:function(t){delete this.config.commands[t]},addCommand:function(t,e){this.config.commands[t]=e},render:function(e){var r=e;return r&&r.isScope||(r=new a(e)),this.tpl(r,t)}},s.Scope=a,s},{requires:["./runtime/commands","./runtime/scope"]}),KISSY.add("kg/tbar/2.0.0/toolbar-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);s.runBlockCommand,s.renderOutput,s.getProperty,s.runInlineCommand,s.getPropertyOrRunCommand;return i+='<div class="tb-toolbar tb-toolbar-shrinked" id="J_Toolbar" role="toolbar" data-spm="630"></div>\n'}}),KISSY.add("kg/tbar/2.0.0/toolbar-list-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);s.runBlockCommand,s.renderOutput,s.getProperty,s.runInlineCommand,s.getPropertyOrRunCommand;return i+='<ul class="tb-toolbar-list"></ul>'}}),KISSY.add("kg/tbar/2.0.0/items/ww/ww-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=(l.runBlockCommand,l.renderOutput),c=(l.getProperty,l.runInlineCommand,l.getPropertyOrRunCommand);i+='<li class="tb-toolbar-item" data-item="';var p=c(s,t,{},"name",0,1);i+=d(p,!1),i+='">\n    <span class="J_WangWang" data-nick="';var u=c(s,t,{},"nick",0,2);return i+=d(u,!0),i+='" data-icon="small" data-display="inline" data-encode="true"></span>\n    <a href="#" data-spm-click="gostr=/tbdetail;locaid=d1" class="tb-toolbar-item-hd tb-toolbar-item-hd-ww tb-toolbar-ww-offline" onclick="javascript:window.goldlog && goldlog.record && goldlog.record(\'/tbact.1212.12306.12\',\'\',\'\',\'H47641344\')">\n        <div class="tb-toolbar-item-icon">&#xe601;</div>\n        <div class="tb-toolbar-item-tip">\u5ba2\u670d<div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd">\n    </div>\n</li>\n'}}),KISSY.add("kg/tbar/2.0.0/items/ww/ww",function(t,e){function a(e){var a=e.split(".");return t.reduce(a,function(t,e){return"undefined"==typeof t?t:t[e]},window)}function r(t,e,r){if(a(t))r();else var n=setInterval(function(){a(t)&&(clearInterval(n),r())},e)}var n="";"undefined"!=typeof g_config&&(n=g_config.sellerNick);var i={nick:encodeURIComponent(n)},o="tb-toolbar-ww-offline";return{tpl:e,data:{nick:i.nick},listeners:{afterRender:function(e){var a=this,n=a.getItemEl(e);r("Light",200,function(){function r(){var i=t.one(".ww-light a",n);i&&i.length?i.hasClass("ww-online")?a.getItemHdEl(e).removeClass(o):i.hasClass("ww-offline")||setTimeout(r,200):setTimeout(r,200)}Light.light("#J_Toolbar"),t.one(".ww-light a",n)?r():setTimeout(r,200)}),setTimeout(function(){var e=t.one(".ww-light a",n);e&&e.length&&!e.hasClass("ww-online")&&!e.hasClass("ww-offline")&&Light.light("#J_Toolbar")},5e3)},click:function(e){t.one(".ww-light a",this.getItemEl(e)).fire("click")}},config:i}},{requires:["./ww-xtpl"]}),KISSY.add("kg/tbar/2.0.0/items/feedback/feedback-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=(l.runBlockCommand,l.renderOutput),c=(l.getProperty,l.runInlineCommand,l.getPropertyOrRunCommand);i+='<li class="tb-toolbar-item" data-item="';var p=c(s,t,{},"name",0,1);return i+=d(p,!1),i+='">\n    <a href="#" class="tb-toolbar-item-hd">\n        <div class="tb-toolbar-item-icon">&#xe60c;</div>\n        <div class="tb-toolbar-item-tip"><span class="tb-toolbar-item-tip-text">\u53cd\u9988</span><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n</li>\n'}}),KISSY.add("kg/tbar/2.0.0/items/feedback/feedback",function(t,e){var a={url:t.namespace("TB.Toolbar.gotop").url};return{tpl:e,data:{},listeners:{afterRender:function(t,e){var r=this;if(a.tip){var n=r.getItemEl(t);n.one(".tb-toolbar-item-tip-text").html(a.tip)}},click:function(e,r){var n=a.url;t.isFunction(a.url)?a.url(r):window.open(n)},message:{updateConfig:function(e,r){t.mix(a,r)}}},config:a}},{requires:["./feedback-xtpl"]}),KISSY.add("kg/tbar/2.0.0/items/gotop/gotop-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=(l.runBlockCommand,l.renderOutput),c=(l.getProperty,l.runInlineCommand,l.getPropertyOrRunCommand);i+='<li class="tb-toolbar-item tb-toolbar-item-gototop" data-item="';var p=c(s,t,{},"name",0,1);return i+=d(p,!1),i+='">\n    <a href="#" class="tb-toolbar-item-hd tb-toolbar-item-hd-gototop">\n        <div class="tb-toolbar-item-icon">&#xe602;</div>\n        <div class="tb-toolbar-item-tip"><span class="tb-toolbar-item-tip-text">\u8fd4\u56de\u9876\u90e8</span><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n</li>\n'}}),KISSY.add("kg/tbar/2.0.0/items/gotop/gotop",function(t,e,a){var r=e.all,n={scrollTop:1,animation:!1,easing:"easeBoth",duration:.5,complete:t.noop};return{tpl:a,data:{},listeners:{afterRender:function(t,e){var a=this;if(n.tip){var r=a.getItemEl(t);r.one(".tb-toolbar-item-tip-text").html(n.tip)}},click:function(){var t=window;n.animation?r(t).animate({scrollTop:n.scrollTop},n.duration,n.easing,n.complete):t.scrollTo(0,1)}},config:n}},{requires:["node","./gotop-xtpl"]}),KISSY.add("kg/tbar/2.0.0/items/cart/counter",function(t,e,a,r){function n(e){return d.userCookie&&"2"==d.userCookie.version?t.unparam(e,"&amp;"):t.unparam(e)}function i(e){var a=l(".J_ToolbarCartNum");return t.isNumber(e)?void(0>e?(w=-1===e,a.hide()):a.text(e).show()):void a.hide()}function o(t){if(t=t||0){var e={keys:"TCART_234_"+t+"_q"};a({type:"get",url:y,data:e,success:function(t){if(t){var a=b>=0?b:c?1:0;i(t[e.keys]),r.set("mt","ci="+t[e.keys]+"_"+a+(h?"&"+h:""),7,m)}else c()&&o()},dataType:"jsonp",cache:!1})}else a({type:"get",url:k+(u?"&appid="+u:""),success:i,dataType:"jsonp",cache:!1})}function s(){var t=l("#J_MiniCartNum"),e=0;if(t.length&&(e=parseInt(t.text(),10)),e>0)i(e);else if(c())g?1==b?i(v):o():o(r.get("unb"));else{var a=r.get("t");a?v>=0?i(v):o(a):i(0)}}var l=e.all,d=window,c=function(){var t=r.get("_nk_")||r.get("tracknick"),e=r.get("_l_g_"),a=r.get("lgc");return!!(e&&t||a)},p=!!~location.hostname.indexOf("daily.taobao.net"),u="g_config"in d&&"appId"in d.g_config?parseInt(d.g_config.appId):void 0,m=p?".daily.taobao.net":".taobao.com",g=n(r.get("mt")),f=g&&g.ci?g.ci.split("_"):[void 0,void 0],v=parseInt(f[0],10),b=parseInt(f[1],10),h=g?g.cp:void 0,k="//cart"+m+"/top_cart_quantity.htm?",y="//count."+(p?"config-vip.taobao.net:8888":"taobao.com")+"/counter6",w=0>v;return{init:s,num:i}},{requires:["node","io","cookie"]}),KISSY.add("kg/tbar/2.0.0/items/cart/cart-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=(l.runBlockCommand,l.renderOutput),c=(l.getProperty,l.runInlineCommand,l.getPropertyOrRunCommand);i+='<li class="tb-toolbar-item tb-toolbar-item-cart" data-item="';var p=c(s,t,{},"name",0,1);return i+=d(p,!1),i+='">\n    <a href="#" class="tb-toolbar-item-hd tb-toolbar-item-hd-cart J_TBToolbarCart">\n        <div class="tb-toolbar-item-icon tb-toolbar-item-icon-cart">&#xe603;</div><!--&#xf179;-->\n        <div class="tb-toolbar-item-label tb-toolbar-item-label-cart">\u8d2d\u7269\u8f66</div>\n        <div class="J_ToolbarCartNum tb-toolbar-item-badge-cart">0</div>\n        <div class="tb-toolbar-item-text"><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n        <div class="tb-toolbar-item-tip">\u6211\u7684\u8d2d\u7269\u8f66<div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd tb-toolbar-mini-cart tb-toolbar-loading">\n    </div>\n</li>\n'}}),KISSY.add("kg/tbar/2.0.0/items/cart/cart",function(t,e,a,r){var n=e.all,i=n("body");return{tpl:r,config:{login:"click",goldlog:["/sidebar.1001.104","","","H46926362"]},data:{},listeners:{message:{fly:function(t,e){var a=this;e.$target=a.getItemHdEl(t),a.fly(e)},num:function(t,e){a.num(e.num)}},afterRender:function(t){var e=this,r=e.getItemEl(t),n=e.getItemBdEl(t);r.delegate("click",".J_ShrinkMiniCartToolBar",function(a){a.preventDefault(),"none"===n.css("display")?e.expand(t,{el:n}):e.shrink()}),i.on("toolbar:login",function(){a.init()}),a.init()},click:function(t,e){var a=e.currentTarget;this.expand(t,{el:n(a).next()})},expand:function(e,a){var r=this;a.el.show(),t.use("tp/tb-mini-cart/2.9.6/plugin/toolbar/index",function(t,n){n.init({container:a.el,success:function(){a.el.removeClass("tb-toolbar-loading")},error:function(n){a.el.removeClass("tb-toolbar-loading"),1===n.error&&(t.use("tbc/mini-login/2.2.6/",function(t,n){var i=new n({zindex:2e8});i.on("login",function(){r.expand(e,a)}),i.show()}),r.shrink(e,a))}})})},shrink:function(t,e){e.el.hide(),e.el.html(""),e.el.addClass("tb-toolbar-loading")}}}},{requires:["node","./counter","./cart-xtpl"]}),KISSY.add("kg/tbar/2.0.0/items/history/history-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=(l.runBlockCommand,l.renderOutput),c=(l.getProperty,l.runInlineCommand,l.getPropertyOrRunCommand);i+='<li class="tb-toolbar-item tb-toolbar-history" data-item="';var p=c(s,t,{},"name",0,1);return i+=d(p,!1),i+='">\n    <a href="#" class="tb-toolbar-item-hd">\n        <div class="tb-toolbar-item-icon">&#xe609;</div><!--&#xe606;-->\n        <div class="tb-toolbar-item-text"><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n        <div class="tb-toolbar-item-tip">\u6211\u7684\u8db3\u8ff9<div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd tb-toolbar-loading">\n    </div>\n</li>\n'}}),KISSY.add("kg/tbar/2.0.0/items/history/history",function(t,e,a){var r={login:"click",goldlog:["/sidebar.1001.106","","","H46926364"]};return{tpl:a,config:r,data:{},listeners:{afterRender:function(t){var e=this,a=e.getItemEl(t);e.getItemBdEl(t);a.delegate("click",".J_Shrink",function(t){t.preventDefault(),e.shrink()})},click:function(t,a){var r=e.one(a.currentTarget);this.expand(t,{node:r.next()})},expand:function(e,a){var r=this,n=r.getItemBdEl(e);n.show(),t.use("act20141212/c/2014-1212/sidebar/history/",function(t,i){i.render(n,function(){n.removeClass("tb-toolbar-loading")},function(i){n.removeClass("tb-toolbar-loading"),i&&1===i.errorType&&(t.use("tbc/mini-login/2.2.6/",function(t,n){var i=new n({zindex:2e8});i.on("login",function(){r.expand(e,a),TB.Global.reload()}),i.show()}),r.shrink(e,a))},r)})},shrink:function(e,a){var r=this,n=r.getItemBdEl(e);n.hide(),n.html(""),n.addClass("tb-toolbar-loading"),t.use("act20141212/c/2014-1212/sidebar/history/",function(t,e){e.detach()})}}}},{requires:["node","./history-xtpl"]}),KISSY.add("kg/tbar/2.0.0/items/map/map-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=(l.runBlockCommand,l.renderOutput),c=(l.getProperty,l.runInlineCommand,l.getPropertyOrRunCommand);i+='\n<li class="tb-toolbar-item tb-map" data-item="';var p=c(s,t,{},"name",0,2);return i+=d(p,!1),i+='">\n    <a href="//nianhuo.taobao.com/" class="map-hd" title="\u963f\u91cc\u5e74\u8d27\u8282" target="_blank" onclick="javascript:window.goldlog && goldlog.record(\'/sidebar.1001.100\',\'\',\'\',\'H46926337\')"><img src="//img.alicdn.com/tps/TB1T1v6LXXXXXXjaXXXXXXXXXXX-59-132.gif" /></a>\n    <a href="#" class="tb-toolbar-item-hd map-trigger">\n        <span class="tb-toolbar-item-text"><i class="sidebar20151111">&#xe605;</i><span class="trigger-txt">\u4f1a\u573a\u5bfc\u822a</span><div class="tb-toolbar-item-arrow">\u25c6</div></span>\n        <div class="tb-toolbar-item-tip map-tip"> <span class="tb-toolbar-item-tip-text">\u4f1a\u573a\u5bfc\u822a</span><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd tb-toolbar-map-bd tb-toolbar-loading">\n\n    </div>\n\n</li>\n'}}),KISSY.add("kg/tbar/2.0.0/items/map/map-bd-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=l.runBlockCommand,c=l.renderOutput,p=l.getProperty,u=(l.runInlineCommand,l.getPropertyOrRunCommand);i+='\n<div class="map-body-bd">\n    <div class="map-body-img">\n        ';var m={},g=[],f=p(s,t,"img",0,4);g.push(f),m.params=g,m.fn=function(t){var e="";e+='\n            <a class="market-item market-item-main" href="';var a=u(s,t,{},"link",0,5);e+=c(a,!1),e+="\" target=\"_blank\" onclick=\"javascript:window.goldlog && goldlog.record('/nhj.2100.120','','','H46807173')\"><img src=\"";var r=u(s,t,{},"url",0,5);return e+=c(r,!1),e+='"></a>\n        '},i+=d(s,t,m,"each",4),i+='\n    </div>\n    <div class="map-body-group">\n        <span class="toolbar-shrink J_ShrinkMapToolBar sidebar20151111">&#xe604;</span>\n        <!--\n        <div class="market-group group0" style="display: none">\n            <div class="market-group-title">\u6211\u6700\u8fd1\u53bb\u8fc7\u7684\u4f1a\u573a</div>\n            <div class="market-group-wrap clearfix J_RecentMarket">\n            </div>\n        </div>\n        -->\n        <div class="market-group group-main">\n            <div class="market-group-title">';var v=u(s,t,{},"moduleinfo.title",0,18);i+=c(v,!1),i+="</div>\n            ";var b={},h=[],k=p(s,t,"main",0,19);h.push(k),b.params=h,b.fn=function(t){var e="";e+='\n            <a class="market-item market-item-main" href="';var a=u(s,t,{},"url",0,20);e+=c(a,!1),e+="\" target=\"_blank\" onclick=\"javascript:window.goldlog && goldlog.record('/sidebar.2100.102','','','H46926360')\"><span class=\"mapIconfont\">";var r=u(s,t,{},"icon",0,20);e+=c(r,!1),e+="</span>";var n=u(s,t,{},"title",0,20);return e+=c(n,!1),e+="</a>\n            "},i+=d(s,t,b,"each",19),i+='\n        </div>\n\n        <div class="market-group group-main-sub">\n            ';var y={},w=[],x=p(s,t,"feature",0,25);w.push(x),y.params=w,y.fn=function(t){var e="";e+='\n            <a class="market-item market-item-main-sub" href="';var a=u(s,t,{},"url",0,26);e+=c(a,!1),e+="\" target=\"_blank\" onclick=\"javascript:window.goldlog && goldlog.record('/sidebar.2100.104','','','H46926362')\"><span class=\"mapIconfont\">";var r=u(s,t,{},"icon",0,26);e+=c(r,!1),e+="</span>";var n=u(s,t,{},"title",0,26);return e+=c(n,!1),e+="</a>\n            "},i+=d(s,t,y,"each",25),i+='\n        </div>\n        \n        <div class="market-group group1">\n            <div class="market-group-wrap clearfix">\n                ';var I={},C=[],S=p(s,t,"sub",0,32);C.push(S),I.params=C,I.fn=function(t){var e="";e+='\n                <a class="market-item market-item-sub" href="';var a=u(s,t,{},"url",0,33);e+=c(a,!1),e+="\" target=\"_blank\" onclick=\"javascript:window.goldlog && goldlog.record('/sidebar.2100.101','','','H46926338')\"><span class=\"mapIconfont\">";var r=u(s,t,{},"icon",0,33);e+=c(r,!1),e+="</span>";var n=u(s,t,{},"title",0,33);return e+=c(n,!1),e+="</a>\n                "},i+=d(s,t,I,"each",32),i+='\n            </div>\n        </div>\n\n        <div class="market-group group2">\n            <div class="market-group-wrap clearfix">\n                ';var _={},T=[],P=p(s,t,"subFeature",0,40);return T.push(P),_.params=T,_.fn=function(t){var e="";e+='\n                <a class="market-item market-item-sub" href="';var a=u(s,t,{},"url",0,41);e+=c(a,!1),e+="\" target=\"_blank\" onclick=\"javascript:window.goldlog && goldlog.record('/sidebar.2100.105','','','H46926363')\">";var r=u(s,t,{},"title",0,41);return e+=c(r,!1),e+="</a>\n                "},i+=d(s,t,_,"each",40),i+="\n            </div>\n        </div>\n    </div>\n\n</div>\n"}}),KISSY.add("kg/tbar/2.0.0/items/map/map",function(t,e,a,r,n,i,o,s,l){function d(t,e){c=1,n({type:"get",url:m.api,success:function(t){var a=new l(s).render(t[79076].value);e.html(a),e.removeClass("tb-toolbar-loading")},dataType:"jsonp",jsonpCallback:"tce_79076"})}var c,p,u,m=(e.all,{api:"//tce.alicdn.com/api/data.htm?ids=79076",msg:"//tce.alicdn.com/api/data.htm?ids=100932",goldlog:["/sidebar.1001.101","","","H46926338"]});return{tpl:o,data:{},listeners:{afterRender:function(e){var a=this,r=a.getItemEl(e),n=a.getItemBdEl(e);p=r,u=n,r.delegate("click",".J_ShrinkMapToolBar",function(t){t.preventDefault(),"none"===n.css("display")?a.expand(e,{el:n}):a.shrink()}),m.narrow?t.one(".tb-toolbar-black").removeClass("tb-toolbar-wide"):t.one(".tb-toolbar-black").addClass("tb-toolbar-wide")},click:function(t,a){var r=e.one(a.currentTarget);this.expand(t,{node:r.next()})},expand:function(t,e){try{goldlog.record("/sidebar.1001.102","","","H46926360")}catch(a){}var r=this,n=r.getItemBdEl(t);n.show(),c||d(self,r.getItemBdEl(t))},shrink:function(t,e){var a=this.getItemBdEl(t);a.hide()}},config:m}},{requires:["node","event","dom","io","cookie","./map-xtpl","./map-bd-xtpl","../../third-party/xtemplate-shim/runtime"]}),KISSY.add("kg/tbar/2.0.0/items/redpaper/redpaper-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=(l.runBlockCommand,l.renderOutput),c=(l.getProperty,l.runInlineCommand,l.getPropertyOrRunCommand);i+='<li class="tb-toolbar-item tb-redpaper" data-item="';var p=c(s,t,{},"name",0,1);return i+=d(p,!1),i+='">\n    <a href="#" class="tb-toolbar-item-hd redpaper-trigger">\n        <span class="tb-toolbar-item-text"><i class="sidebar20151111">&#xe600;</i><span class="trigger-txt">\u5e74\u8d27\u4f18\u60e0</span><div class="tb-toolbar-item-arrow">\u25c6</div></span>\n        <div class="tb-toolbar-item-tip redpaper-tip"> <span class="tb-toolbar-item-tip-text">\u5e74\u8d27\u4f18\u60e0</span><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n    <div class="tb-toolbar-item-bd tb-toolbar-redpaper-bd tb-toolbar-loading">\n\n        <div class="redpaper-body-bd">\n            <span class="toolbar-shrink J_ShrinkMapToolBar sidebar20151111">&#xe604;</span>\n            <div class="market-group-title">\u5e74\u8d27\u4f18\u60e0</div>\n            <div class="shop-redpaper">\n            </div>\n\n        </div>\n    </div>\n</li>\n'}}),KISSY.add("kg/tbar/2.0.0/items/redpaper/redpaper-shop-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=l.runBlockCommand,c=l.renderOutput,p=l.getProperty,u=(l.runInlineCommand,l.getPropertyOrRunCommand);i+="";var m={},g=[],f=p(s,t,"vouchers",0,1);g.push(-1!==f),m.params=g,m.fn=function(t){var e="";e+='\n<div class="redpaper-group group0 mycoupon">\n    <div class="redpaper-mycoupon-numbox">\n        <a class="redpaper-mycoupon-numlink" href="//taoquan.taobao.com/framework/got_bonus.htm?tabIndex=53" target="_blank" onclick="javascript:window.goldlog && goldlog.record(\'/nhj.2100.121\',\'\',\'\',\'H46807174\')">\n            <span class="mycoupon-vouchers">\u5e74\u8d27\u8d2d\u7269\u5238 ';var a=u(s,t,{},"vouchers",0,5);return e+=c(a,!0),e+=' \u5143</span>\n            <span class="mycoupon-history">\u6211\u7684\u5238</span>\n        </a>\n    </div>\n    <div class="redpaper-mycoupon-imgbox">\n         <a class="redpaper-mycoupon-imglink" href="//pages.tmall.com/wow/jifen/act/year-coupon?channel=20204009" target="_blank" onclick="javascript:window.goldlog && goldlog.record(\'/nhj.2100.122\',\'\',\'\',\'H46807196\')">\n            <img src="//img.alicdn.com/tps/TB1V4IyLXXXXXX8XXXXXXXXXXXX-220-107.png">\n         </a>\n    </div>\n</div>\n'},i+=d(s,t,m,"if",1),i+='\n<div class="redpaper-group group1 myredpaper">\n    <div class="redpaper-group-title">\u5df2\u9886\u53d6\u5e97\u94fa\u7ea2\u5305\uff1a</div>\n    <ul class="redpaper-group-list clearfix J_MyRedPaper">\n        <li class="redpaper-no-data" style="display: none">\n            <p class="no-data-txt">\u4eb2\uff0c\u60a8\u8fd8\u6ca1\u6709\u9886\u53d6<br/>\u963f\u91cc\u5e74\u8d27\u8282\u7ea2\u5305\u5594</p>\n            <img class="no-data-gif" height="125" src="//img.alicdn.com/tps/TB1jwF4LpXXXXaMXXXXXXXXXXXX-125-125.png">\n        </li>\n        ';var v={},b=[],h=p(s,t,"myticket",0,23);b.push(h),v.params=b,v.fn=function(t){var e="";e+='\n        <li class="redpaper-item ';var a={},r=[],n=p(s,t,"isCurShop",0,24);r.push(n),a.params=r,a.fn=function(t){var e="";return e+="redpaper-current-shop"},e+=d(s,t,a,"if",24),e+='">\n            <a href="';var i=u(s,t,{},"shopUrl",0,25);e+=c(i,!1),e+='" target="_blank" class="redpaper-item-href" onclick="javascript:window.goldlog && goldlog.record(\'/sidebar.2200.100\',\'\',\'\',\'H46926337\')">\n                <div class="redpaper-bg-t"></div>\n                <div class="redpaper-bg-b">\n                    <div class="redpaper-shop-name">';var o=u(s,t,{},"shopName",0,28);e+=c(o,!1),e+='</div>\n                    <p class="redpaper-valid-time">\u4f7f\u7528\u65f6\u95f4\uff1a<br/>\n                        2016.1.17 00:00 -<br/>\n                        2016.1.21 23:59</p>\n                    <div class="redpaper-item-right">\n                        <p class="redpaper-item-price"><span class="redpaper-yen">&yen;</span>';var l=u(s,t,{},"price",0,33);return e+=c(l,!1),e+='</p>\n                    </div>\n                </div>\n                <div class="redpaper-bg-f"></div>\n            </a>\n        </li>\n        '},i+=d(s,t,v,"each",23),i+='\n    </ul>\n    <div class="redpaper-group-ft"><a class="redpaper-more-link" href="//taoquan.taobao.com/framework/got_bonus.htm?tabIndex=5" target="_blank" onclick="javascript:window.goldlog && goldlog.record(\'/sidebar.2200.101\',\'\',\'\',\'H46926338\')">\u67e5\u770b\u66f4\u591a</a></div>\n</div>\n<div class="redpaper-group group2 J_CurShopPaper">\n    <div class="redpaper-group-title">\u5f53\u524d\u5e97\u94fa\u53ef\u9886\u7ea2\u5305\uff1a</div>\n    <ul class="redpaper-group-list clearfix">\n        ';var k={},y=[],w=p(s,t,"curshopticket",0,46);y.push(w),k.params=y,k.fn=function(t){var e="";e+='\n        <li class="redpaper-item redpaper-current-shop " data-tempid="';var a=u(s,t,{},"tempId",0,47);e+=c(a,!1),e+='" data-sellerid = ';var r=u(s,t,{},"sellerId",0,47);e+=c(r,!0),e+='>\n            <div class="redpaper-bg-t"></div>\n            <div class="redpaper-bg-b">\n                <a href="';var n=u(s,t,{},"shopUrl",0,50);e+=c(n,!1),e+='" target="_blank" class="redpaper-item-href" onclick="javascript:window.goldlog && goldlog.record(\'/sidebar.2200.100\',\'\',\'\',\'H46926337\')">\n                    <span class="redpaper-shop-name">';var i=u(s,t,{},"shopName",0,51);e+=c(i,!1),e+='</span>\n                    <p class="redpaper-valid-time">\u4f7f\u7528\u65f6\u95f4\uff1a<br/>\n                        2016.1.17 00:00 -<br/>\n                        2016.1.21 23:59</p>\n                </a>\n                <a href="#" class="redpaper-item-right J_GetRedPaper" onclick="javascript:window.goldlog && goldlog.record(\'/sidebar.2200.102\',\'\',\'\',\'H46926360\')">\n                    <p class="redpaper-item-price"><span class="redpaper-yen">&yen;</span>';var o=u(s,t,{},"price",0,57);return e+=c(o,!1),e+='</p>\n                    <p class="redpaper-item-fetch"><span class="fetch-text">\u9886\u53d6</span></p>\n                </a>\n            </div>\n            <div class="redpaper-bg-f"></div>\n\n        </li>\n        '},i+=d(s,t,k,"each",46),i+='\n    </ul>\n</div>\n<div class="redpaper-group group3">\n    <div class="redpaper-group-title">\u597d\u5e97\u63a8\u8350\uff1a</div>\n    <ul class="redpaper-group-list clearfix">\n        ';var x={},I=[],C=p(s,t,"recomticket",0,70);return I.push(C),x.params=I,x.fn=function(t){var e="";e+='\n        <li class="redpaper-item " data-tempid="';var a=u(s,t,{},"tempId",0,71);e+=c(a,!1),e+='" data-sellerid="';var r=u(s,t,{},"sellerId",0,71);e+=c(r,!0),e+='" style="display: none;">\n            <div class="redpaper-bg-t"></div>\n            <div class="redpaper-bg-b">\n                <a href="';var n=u(s,t,{},"shopUrl",0,74);e+=c(n,!1),e+='" target="_blank" class="redpaper-item-href">\n                    <span class="redpaper-shop-name">';var i=u(s,t,{},"shopName",0,75);e+=c(i,!1),e+='</span>\n                    <p class="redpaper-valid-time">\u4f7f\u7528\u65f6\u95f4\uff1a<br/>\n                        2016.1.17 00:00 -<br/>\n                        2016.1.21 23:59</p>\n                </a>\n                <a href="#" class="redpaper-item-right J_GetRedPaper" onclick="javascript:window.goldlog && goldlog.record(\'/sidebar.2200.103\',\'\',\'\',\'H46926361\')">\n                    <p class="redpaper-item-price"><span class="redpaper-yen">&yen;</span>';var o=u(s,t,{},"price",0,81);return e+=c(o,!1),e+='</p>\n                    <p class="redpaper-item-fetch"><span class="fetch-text">\u9886\u53d6</span></p>\n                </a>\n            </div>\n            <div class="redpaper-bg-f"></div>\n        </li>\n        '},i+=d(s,t,x,"each",70),i+="\n    </ul>\n</div>"}}),KISSY.add("kg/tbar/2.0.0/items/redpaper/redpaper",function(t,e,a,r,n,i,o,s,l){function d(){var e=k.one(".shop-redpaper"),n={};window.g_config&&window.g_config.sellerId&&(n={sellerId:window.g_config.sellerId}),i({type:"get",url:w.api,data:n,success:function(n){if(n&&0!=n.success&&n.success){b=1;var i=n.value,o=new l(s).render(n.value);if(e.html(o),k.removeClass("tb-toolbar-loading"),i.myticket.length<1&&(e.one(".J_MyRedPaper").one(".redpaper-no-data").show(),e.one(".redpaper-more-link").hide()),(!i.curshopticket||i.curshopticket.length<1)&&e.one(".J_CurShopPaper").hide(),!i.recomticket||i.recomticket.length<1){var d=e.one(".group3");d.one(".redpaper-group-title").hide();var p=a.create('<div class="tb-toolbar-error"><a class="btn-back-main" href="//nianhuo.taobao.com/" target="_blank">\u524d\u5f80\u4e3b\u4f1a\u573a</a></div>');d.append(p)}else t.later(function(){g("shop")},50),r.on(window,"resize",function(t){g("shop")})}else{if(!n||"NOT_LOGIN"!=n.message)return void c(e);t.use("tbc/mini-login/2.2.6/",function(t,e){var a=new e({zindex:2e8});a.on("login",function(){f.expand(v)}),a.show()}),f.shrink(v)}},error:function(){c(e)},dataType:"jsonp"})}function c(t){t.html('<p class="error-txt">\u5509\u5440\uff0c\u6324\u7834\u5934\u4e86\u3002<br/>\u5148\u53bb\u522b\u5904\u770b\u770b~</p><div class="error-gif"></div><a class="btn-back-main" href="//nianhuo.taobao.com/" target="_blank">\u524d\u5f80\u4e3b\u4f1a\u573a</a> '),k.replaceClass("tb-toolbar-loading","tb-toolbar-error")}function p(){r.delegate(".redpaper-body-bd","click",".btn-back-main",function(t){window.goldlog&&goldlog.record("/sidebar.2200.105","","","H46926363")}),r.delegate(".redpaper-body-bd","click",".J_GetRedPaper",function(e){e.preventDefault();var a=t.one(e.currentTarget),r=a.parent(".redpaper-item"),n=r.attr("data-tempid"),o=r.attr("data-sellerid"),s=r.parent(".redpaper-group");h||(h=1,i({type:"get",url:w.fetch,data:{spreadId:n,sellerId:o},success:function(t){t.success?u(r,s):"NOT_LOGIN"==t.message?(miniLogin.show(),h=0):(h=0,m(t.message))},dataType:"jsonp",error:function(){h=0,m("\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5~");
}}))})}function u(e,a){var r=t.one(".J_MyRedPaper"),i=null,o=10;n.ie<10&&(o=0),e.addClass("disapear"),e.removeClass("J_GetRedPaper");var s=0,l=t.later(function(){var t=e.css("opacity");if(0==t&&0==s)i=e.clone(!0).addClass("disapear").insertBefore(r.one("li")),s=1;else if(1==s){a.all(".redpaper-item").length<2&&a.hide(),r.one(".redpaper-no-data")&&r.one(".redpaper-no-data").hide(),(i||r.one(".redpaper-item")).removeClass("disapear"),e.remove(),h=0,l.cancel();var n=a.all(".redpaper-item");n.length>0||a.one(".redpaper-group-title").hide()}},o,!0)}function m(e){var r=k.one(".readPaperTip");if(r)r.one(".readpapertiptext").text(e),r.show();else{var n=a.create('<div class="readPaperTip"><span class="readpapertiptext">'+e+"</span></div>");k.one(".redpaper-body-bd").append(n);var r=k.one(".readPaperTip")}t.later(function(){r.hide()},2e3)}function g(t){var e=k.one(".cashpaper-list"),r=k.all(".cashpaper-item");if("shop"==t&&(e=k.one(".group3"),r=e.all("li")),e&&!(r.length<1))for(var n=a.viewportHeight(),i=n-(e.offset().top-a.scrollTop()),o=Math.floor((i-30)/r.item(0).height()),s=0;s<r.length;s++)o>s?r.item(s).show():r.item(s).hide()}var f,v,b,h,k,y=(e.all,-1==location.host.indexOf("daily")?"taobao.com":"daily.taobao.net"),w={timeApi:"//t.alicdn.com/t/gettime",api:"//chest.t."+y+"/side_bar_query.htm",cash:"//marketingop."+y+"/red_envelope_sidebar.htm?_input_charset=utf-8",fetch:"//chest.t."+y+"/side_bar_apply.htm"};return{tpl:o,config:{login:"click",goldlog:["/sidebar.1001.102","","","H46926362"]},data:{},listeners:{afterRender:function(t){var e=this;f=this;var a=e.getItemEl(t),r=e.getItemBdEl(t);a.delegate("click",".J_ShrinkMapToolBar",function(a){a.preventDefault(),"none"===r.css("display")?e.expand(t,{el:r}):e.shrink()})},click:function(t,a){var r=e.one(a.currentTarget);this.expand(t,{node:r.next()})},expand:function(t){var e=this,a=e.getItemBdEl(t);k=a,v=t,a.show(),b?g("shop"):(d(),p())},shrink:function(t){var e=this.getItemBdEl(t);e.hide()}},config:w}},{requires:["node","dom","event","ua","io","./redpaper-xtpl","./redpaper-shop-xtpl","../../third-party/xtemplate-shim/runtime"]}),KISSY.add("kg/tbar/2.0.0/items/robot/robot-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=(l.runBlockCommand,l.renderOutput),c=(l.getProperty,l.runInlineCommand,l.getPropertyOrRunCommand);i+='<li class="tb-toolbar-item tb-robot" data-item="';var p=c(s,t,{},"name",0,1);return i+=d(p,!1),i+='">\n    <a href="#" class="tb-toolbar-item-hd robot-trigger">\n        <span><i class="tb-toolbar-item-icon">&#xe610;</i></span>\n        <div class="tb-toolbar-item-tip"><span class="tb-toolbar-item-tip-text">\u6dd8\u5b9d\u5ba2\u670d</span><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n</li>\n'}}),KISSY.add("kg/tbar/2.0.0/items/robot/robot",function(t,e){var a={url:"//service.taobao.com/support/minerva/robot.htm?spm=a215a.7683513.0.0.ikXnZg&source_id=1417115901",goldlog:["/sidebar.1001.107","","","H46926365"]};return{tpl:e,data:{},listeners:{click:function(e,r){var n=a.url;t.isFunction(a.url)?a.url(r):window.open(n)}},config:a}},{requires:["./robot-xtpl"]}),KISSY.add("kg/tbar/2.0.0/items/festival/festival-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);s.runBlockCommand,s.renderOutput,s.getProperty,s.runInlineCommand,s.getPropertyOrRunCommand;return i+="\n"}}),KISSY.add("kg/tbar/2.0.0/items/festival/festival",function(t,e){var a={url:"//www.taobao.com/markets/20151212/gonglve/index",goldlog:["/sidebar.1001.109","","","H46926367"]};return{tpl:e,data:{},listeners:{afterRender:function(t,e){},click:function(t,e){},message:{updateConfig:function(t,e){}}},config:a}},{requires:["./festival-xtpl"]}),KISSY.add("kg/tbar/2.0.0/items/strategy/strategy-xtpl",function(t,e,a,r){return function(t,e,a){var n,i="",o=this.config,s=this,l=o.utils;"undefined"!=typeof r&&r.kissy&&(n=r);var d=(l.runBlockCommand,l.renderOutput),c=(l.getProperty,l.runInlineCommand,l.getPropertyOrRunCommand);i+='<li class="tb-toolbar-item tb-my11" data-item="';var p=c(s,t,{},"name",0,1);return i+=d(p,!1),i+='">\n    <a href="#" class="tb-toolbar-item-hd my11-trigger">\n        <span class="tb-toolbar-item-text"><i class="sidebar20151111">&#xe60f;</i><span class="trigger-txt">\u5e74\u8d27\u653b\u7565</span><div class="tb-toolbar-item-arrow">\u25c6</div></span>\n        <div class="tb-toolbar-item-tip"><span class="tb-toolbar-item-tip-text">\u5e74\u8d27\u653b\u7565</span><div class="tb-toolbar-item-arrow">\u25c6</div></div>\n    </a>\n</li>\n'}}),KISSY.add("kg/tbar/2.0.0/items/strategy/strategy",function(t,e){var a={url:"//www.taobao.com/markets/nianhuo/gonglve",goldlog:["/sidebar.1001.110","","","H46926337"]};return{tpl:e,data:{},listeners:{afterRender:function(t,e){var r=this;if(a.tip){var n=r.getItemEl(t);n.one(".tb-toolbar-item-tip-text").html(a.tip)}},click:function(e,r){var n=a.url;t.isFunction(a.url)?a.url(r):window.open(n)},message:{updateConfig:function(e,r){t.mix(a,r)}}},config:a}},{requires:["./strategy-xtpl"]}),KISSY.add("kg/tbar/2.0.0/toolbar-config",function(t,e,a,r,n,i,o,s,l,d,c){var p=!!~location.hostname.indexOf("daily.taobao.net"),u=p?"//g-assets.daily.taobao.net":"//g.alicdn.com";return t.config({modules:{"pk/index":{requires:["./index.css"]}},packages:{pk:{base:u+"/tb/pk/0.1.0/",ignorePackageNameInUri:!0},tp:{base:u+"/tp/",ignorePackageNameInUri:!0},act20141212:{base:u+"/tb/activity/1.7.5/",ignorePackageNameInUri:!0,debug:!0}}}),{ww:e,feedback:a,gotop:r,cart:n,history:i,map:o,redpaper:s,robot:l,festival:d,strategy:c}},{requires:["./items/ww/ww","./items/feedback/feedback","./items/gotop/gotop","./items/cart/cart","./items/history/history","./items/map/map","./items/redpaper/redpaper","./items/robot/robot","./items/festival/festival","./items/strategy/strategy"]}),KISSY.add("kg/tbar/2.0.0/items/a11y/a11y",function(t,e){function a(t){9==t.keyCode&&i++,1==i&&(r=Date.parse(new Date)),i>10&&2e4>Date.parse(new Date)-r&&(o.detach("keydown",a),window.goldlog&&goldlog.record&&goldlog.record("/cact.1015.1","","url="+encodeURIComponent(location.host+location.pathname),"H46777383"))}var r,n=e.all,i=0,o=n(window);o.on("keydown",a)},{requires:["node"]}),KISSY.add("kg/tbar/2.0.0/index",function(t,e,a,r,n,i,o,s,l){var d="expand",c="shrink",p="afterShrink",u="tb-toolbar-item-hd-active",m=".tb-toolbar-item-hd",g=".tb-toolbar-item-bd",f=a.all,v=f("body"),b=!1,h=e.extend({initializer:function(){if(!b&&(b=!0,!this.hostIsInBlackList())){t.namespace("TB.Toolbar",!0).toolbar=this;var e=new i(o).render({}),a=new i(s).render({}),r=f(e);this.el=r;var n=this.get("items"),d=this,c=["black"],p=this.get("style");t.inArray(p,c)&&this.el.addClass("tb-toolbar-"+p),t.UA.ie<=8&&document.body.clientWidth<1366&&this.el.addClass("tb-toolbar-mini"),this.get("expandToRight")&&this.el.addClass("tb-toolbar-right");var u=d.get("defaultSpacing"),m=d.get("blackList");t.each(n,function(e,n){var o=f('<div class="tb-toolbar-space"></div>');e.topSpacing?o.css({height:e.topSpacing}):o.css(u[n]),r.append(o);var s=f(a),c=e.list?e.list.length:0;t.each(e.list||[],function(a,r){s.addClass("tb-toolbar-list-with-"+a);var n,o=a;if(t.isObject(a)&&(o=a.type,n=a.css),!t.inArray(o,m)){var p=l[o];if(p){var u=p.tpl;if(u){var g=p.data||{};g.name=o;var b=new i(u).render(g),a=f(b);d.items.push(o),d.set(o,a),n&&a.css(n),s.append(a),e.splitLine&&r!=c-1&&s.append('<li class="tb-toolbar-item-split"></li>')}var h=p.listeners,k=h&&h.init;k&&k.apply(d,[o]);var y=h&&h.message;if(t.isPlainObject(y))t.each(y,function(e,a){var r=["toolbar",o,a].join(":");v.on(r,t.bind(e,d,o))});else if(t.isFunction(y)){var w=["toolbar",o,"message"].join(":");v.on(w,t.bind(y,d,o))}}}}),e.css&&s.css(e.css),r.append(s)}),this.set("created",!0)}},destructor:function(){this.el.remove(),this.set("created",!1),this.set("rendered",!1),this.el=null},items:[],render:function(){if(!this.get("rendered")){f(this.get("render")).append(this.el),this.set("rendered",!0),this.binding();var e=this.items,a=this;t.each(e,function(t){var e=l[t].listeners,r=e&&e.afterRender;r&&r.apply(a,[t])})}},binding:function(){function e(e,a){function n(){var t=a.type,n=l[e].listeners;n&&n[t]&&n[t].apply(r,[e,a])}h.config(e).login!==a.type||TB.Global.isLogin?n():t.use("tbc/mini-login/2.2.6/",function(t,e){var a=new e({zindex:2e8});a.on("login",function(){v.fire("toolbar:login"),n()}),a.show()})}var a=this.el,r=this;a.delegate("click",".tb-toolbar-item-hd",function(t){t.preventDefault();var a=t.currentTarget,r=f(a).parent().attr("data-item");e(r,t)}),a.delegate("mouseenter mouseleave",".tb-toolbar-item",function(t){t.preventDefault();var a=t.currentTarget,r=f(a).attr("data-item");e(r,t)}),f(document).on("click",function(t){a.contains(t.target)||a.equals(t.target)||r.shrink()})},getExpanded:function(){return this.get("expanded").item},getItemEl:function(t){return this.get(t)},getItemHdEl:function(t){var e=this.getItemEl(t);return e&&e.all(m)},getItemBdEl:function(t){var e=this.getItemEl(t);return e&&e.all(g)},fly:function(e){var a=e.pos;if(e.trigger){var r=f(e.trigger).offset();r&&(a=r)}var n=e.$target,i=e.pic?e.pic.replace(/_(sum|\d{2,5}x\d{2,5})\.jpg$/,"_50x50.jpg"):"//g.alicdn.com/s.gif",o=f('<div class="tb-toolbar-flyer" style="background: url('+i+') no-repeat 50% 50%;"></div>').css("left",a.left).css("top",a.top).appendTo("body");t.use(["anim","ua"],function(t,a,r){var i=n.offset();a(o,{left:i.left-100,top:i.top},.5,"easeNone",function(){var t={left:i.left+10};(!r.ie||r.ie>8)&&(t.opacity=0),a(o,t,.8,"easeNone",function(){o.remove(),e.success&&e.success()}).run()}).run()})},expand:function(t,e){var a=this.get("expanded"),r=a.item;if(r&&(r!==t?this.shrink(null,null,!0):this.shrink()),t!==r){this.getItemHdEl(t).addClass(u);var i=l[t].listeners[d];i&&i.apply(this,[t,e]),this.set("expanded",{item:t,data:e}),this.el.removeClass("tb-toolbar-shrinked"),this.get("expandToRight")&&(n.stop(this.el,!0),new n(this.el,{right:this.getItemBdEl(t).outerWidth()},.3,"easeOut",function(){},!0).run())}},shrink:function(t,e,a){var r=this.get("expanded"),i=r.item;if(i){var o=r.data;this.getItemHdEl(i).removeClass(u);var s=l[i].listeners[c];this.set("expanded",{}),this.el.addClass("tb-toolbar-shrinked");var d=this;if(this.get("expandToRight")&&!a)return n.stop(this.el,!0),void new n(this.el,{right:0},.3,"easeOut",function(){s&&s.apply(d,[i,o]),v.fire("toolbar:shrink")},!0).run();s&&s.apply(this,[i,o]),v.fire("toolbar:shrink")}},afterShrink:function(){var t=this.get("shrinking"),e=t.item;if(e){var a=t.data,r=l[e].listeners[p];r&&r.apply(this,[e,a]),this.set("shrinking",{}),v.fire("toolbar:afterShrink")}},hostIsInBlackList:function(){var e=location.host,a=this.get("hostBLackList");return t.inArray(e,a)}},{ATTRS:{render:{value:document.body},created:{value:!1},rendered:{value:!1},expanded:{value:{}},shrinking:{value:{}},items:{value:[{list:["map","strategy","redpaper"],topSpacing:"0%"},{list:["cart","history"],splitLine:!0,topSpacing:"1%"},{list:["robot","gotop"],topSpacing:"0"}]},defaultSpacing:{value:[{height:"25%"},{height:"7%"}]},style:{value:"black"},expandToRight:{value:!0},blackList:{value:[]},hostBLackList:{value:["g.taobao.com","guang.taobao.com","lu.taobao.com","tw.taobao.com","sea.taobao.com","hk.taobao.com","cun.taobao.com"]}},ITEMS:l,register:function(t,e){return l[t]=e,l},config:function(){if(t.isObject(arguments[0]))return void t.each(arguments[0],function(e,a){var r=l[a];if(r){var n=r.config||{};e&&(r.config=t.mix(n,e))}});var e=arguments[0],a=arguments[1],r=l[e];if(r){var n=r.config||{};return a&&(r.config=t.mix(n,a)),n}}});if(window.TB){var k=t.namespace("TB.Toolbar",!0),y=k.auto,w=k.close,x=k.use;if((y&&!t.isFunction(y)||t.isFunction(y)&&y())&&(k.toolbar=new h(k.items)),w&&!t.isFunction(w)||t.isFunction(w)&&w()){var I=t.noop;h=I,h.prototype={expand:I,shrink:I,render:I,getExpanded:I,getItemHdEl:I,getItemBdEl:I,getItemEl:I},h.config=I}x&&(t.isFunction(x)&&(x=x(h)),t.use(x))}return h},{requires:["base","node","dom","anim","./third-party/xtemplate-shim/runtime","./toolbar-xtpl","./toolbar-list-xtpl","./toolbar-config","./items/a11y/a11y","./index.css"]});