KISSY.add("mui/pc-openshow/index",function(e,i,t,o,n,a,r){var c="//g.alicdn.com/de/prismplayer/1.2.17/prism-min.js";var l="//g.alicdn.com/de/prismplayer/1.2.17/prism-h5-min.js";var s="//img.alicdn.com/tps/TB1GWdhJVXXXXbJXXXXXXXXXXXX-1781-960.jpg";var d="2015-10-13 15:00:00";var m="2015-10-31 23:59:59";var p="tmall";var g="http://cloud.video.taobao.com/play/u/310946419/p/1/e/6/t/1/30752272.mp4";var f=0;var v=true;var u=false;var h;window._CTK6364=window._CTK6364||function(){var e={},i="",t=0;function o(e){var i=0,t,o,n;if(e.length===0)return i;for(t=0,n=e.length;t<n;t++){o=e.charCodeAt(t);i=(i<<5)-i+o;i|=0}return i}return function(n,a,r,c){c=c||{};if(c.reject){if(typeof c.reject!="object"){c.reject=[c.reject]}for(var l=c.reject.length-1;l>=0;l--){if(e[c.reject[l]]){return}}}if(!i){i=a}var s=(new Date).valueOf();e[a]=s;var d;if(a==i){var m=window.g_config&&g_config.startTime;d=m?s-m:0}else{d=s-(e[r||i]||e[i])}switch(c.autoGroup){case"time":c.group=c.autoGroup+"_"+(d<=0?0:Math.floor(Math.log(d)/Math.log(2)));break}if(typeof n=="object"){n=n[c.group||"_"]||Math.round(Math.log((undefined||8192)/(undefined||1/16))/Math.log(2))}var p=null,g=p&&p[Math.floor((s+288e5)/(864e5/144))%144]||1,f=Math.round(Math.max(Math.pow(2,n)*g/(undefined||8192),1));if(Math.floor(Math.random()*f)>0){return}function v(e,i){var n="undefined"+t++,a=window[n]=new Image;a.onload=a.onerror=function(){window[n]=null};var r=["type="+encodeURIComponent(c.type||"normal"),"name="+encodeURIComponent(e),"parent="+encodeURIComponent(i||""),"module="+encodeURIComponent(c.dataId||"32"),"msg="+encodeURIComponent(c.msg||""),"version="+encodeURIComponent("3.0.25"),"sample="+f,"time="+(d>0?d:0)].join("&");a.src="//gm.mmstat.com/tmjs.1.1?"+r+"&hash="+o(r)}if(c.group){v(a+"|"+c.group,a)}v(a,r)}}();_CTK6364(33,"codetrack.init");if(/\.taobao\./i.test(window.location.href)){p="taobao"}var w={init:function(){var i=this;var t=i.getEnv();u=i.detectFlash();var o=i.checkVideo();if(o){c=l;i.log("tmwap.200.10","H46807173")}else if(!u){c="";i.log("tmwap.200.11","H46807174")}else{v=false;i.log("tmwap.200.12","H46807196")}if(t&&c){i.getLoginStatus(function(t,o){if(t){i.getTime(function(t){var n=i.dateParse(d);var a=i.dateParse(m);if(t>n&&t<a){if(localStorage&&localStorage[o]!="whatched"){i.getUserState(function(){e.getScript(c,function(){i.showVideo(function(){i.createVideo()})})})}}})}})}else{i.log("tmwap.200.9","H46777412")}},createVideo:function(){var e=this;var t=this.getVedioPixel();var a=i.get("#J_11coming_prismPlayer");var r=i.get("#J_11coming_prismPlayer_container");var c=i.get("#J_11coming_prismPlayer_container_backgroundImage_con");var l;i.css(r,{width:t.clientWidth+"px",height:t.clientHeight+"px"});i.css(c,{"margin-left":"-"+t.imgW/2+"px",width:t.imgW+"px",height:t.imgH+"px"});if(t.videoConTop){i.css(c,{top:t.videoConTop+"px"})}var s={width:t.w+"px",height:t.h+"px",left:t.videoLeft+"px",top:t.videoTop+"px"};if(!v){s.visibility="visible"}i.css(a,s);var d=i.get(".J_11coming_prismPlayer_container_btn");i.show(d);e.bindEvent(d,function(){m.pause();e.hideContainer(r,t,d);e.log("tmwap.200.15","H46807199")});var m=new prismplayer({id:"J_11coming_prismPlayer",source:g,autoPlay:true,width:t.w+"px",height:t.h+"px",skinLayout:false});m.on("ready",function(){try{m.setToastEnabled(false);if(!v){m.play()}}catch(o){}var c=i.create("<div id='J_11coming_videoMask' style='width:"+t.w+"px;height:"+t.h+"px;position:absolute;top:0;left:0;z-index:999999999;'></div>");if(n.ie=="8"){c=i.create("<div id='J_11coming_videoMask' style='width:"+t.w+"px;height:"+t.h+"px;position:absolute;top:0;left:0;z-index:999999999;background:url(//img.alicdn.com/tps/TB1VQDdJFXXXXXUXVXXXXXXXXXX-53-53.png) repeat'></div>")}i.append(c,a);e.bindEvent(c,function(e){e.preventDefault()});l=i.get("#J_11coming_videoMask");i.addClass(i.get("body"),"html-body-overflow");i.addClass(i.get("html"),"html-body-overflow");var s=i.viewportWidth();var d=i.viewportHeight();i.css(r,{width:s+"px",height:d+"px"});if(n.ie==8){setTimeout(function(){i.css(a,{visibility:"visible"})},2e3)}else if(window.navigator.userAgent.indexOf("Safari")!=-1||n.ie){setTimeout(function(){i.css(a,{visibility:"visible"})},1e3)}else{i.css(a,{visibility:"visible"})}});if(!v&&u){m.on("videoRender",function(){if(f==1){var e=i.query("embed");i.css(e,"visibility","visible")}f++})}m.on("ended",function(){e.hideContainer(r,t,d)});o.on(window,"resize",function(){var t=e.getVedioPixel();i.css(r,{width:t.clientWidth+"px",height:t.clientHeight+"px"});i.css(c,{"margin-left":"-"+t.imgW/2+"px",width:t.imgW+"px",height:t.imgH+"px"});if(t.videoConTop){i.css(c,{top:t.videoConTop+"px"})}i.css(a,{width:t.w+"px",height:t.h+"px",left:t.videoLeft+"px",top:t.videoTop+"px"});if(!l){l=i.get("#J_11coming_videoMask")}i.css(l,{width:t.w+"px",height:t.h+"px"})})},hideContainer:function(e,o,n){i.remove(n);i.removeClass(i.get("body"),"html-body-overflow");i.removeClass(i.get("html"),"html-body-overflow");var a=new t(e,{top:"-"+o.clientHeight+"px"},{duration:.5,easing:"linear",complete:function(){i.remove(e)},useTransition:true});a.run()},bindEvent:function(e,i){if(n.ie=="8"){e.attachEvent("onclick",function(e){i&&i(e)})}else{o.on(e,"click",function(e){i&&i(e)})}},showVideo:function(e){var t="<div id='J_11coming_prismPlayer_container'><div id='J_11coming_prismPlayer_container_backgroundImage_con'><img id='J_11coming_prismPlayer_container_backgroundImage' src='"+s+"'/>";if(n.ie=="8"){t+="<div class='J_11coming_prismPlayer_container_btn J_11coming_prismPlayer_container_closeBtn_ie8'></div>"}else{t+="<div class='J_11coming_prismPlayer_container_btn J_11coming_prismPlayer_container_closeBtn'></div>"}t+="<div id='J_11coming_prismPlayer' class='prism-player'></div></div></div>";var o=i.create(t);i.append(o,i.get("body"));e&&e()},getVedioPixel:function(){var e={w:1280,h:720};var t={w:1781,h:960,videoTop:120,videoLeft:250};var o=i.viewportHeight();var n=i.viewportWidth();if(n/o<t.w/t.h){var a=n>t.w?t.w:n;var r=t.h/t.w*a;var c=t.videoTop/t.h*r;var l=t.videoLeft/t.w*a;var s=e.w/t.w*a;var d=e.h/t.h*r;var m=(o-r)/2;return{w:s,h:d,imgW:a,imgH:r,videoTop:c,videoLeft:l,clientWidth:n,clientHeight:o,videoConTop:m}}else{var r=o>t.h?t.h:o;var a=t.w/t.h*o;var c=t.videoTop/t.h*o;var l=t.videoLeft/t.w*a;var s=e.w/t.w*a;var d=e.h/t.h*o;return{w:s,h:d,imgW:a,imgH:r,videoTop:c,videoLeft:l,clientWidth:n,clientHeight:o}}},getEnv:function(){if(!n.ios&&!n.android){if(n.ie=="7"||n.ie=="6"||n.ie=="5"){return false}else{return true}}else{return false}},getUserState:function(e){var i=this;i.mtopCall("mtop.tmw.unveil.read",function(t){i.mtopWrap(t,function(t){if(t.watched){if(t.watched.toString()=="false"){e();if(localStorage){localStorage[h]="whatched"}try{i.mtopCall("mtop.tmw.unveil.record",function(){},function(){})}catch(o){}i.log("tmwap.200.14","H46807198")}}else{e()}})})},mtopWrap:function(e,i){if(e){var t=e.data;if(t){if(t.succ=="true"){var o=t.data;if(o){i&&i(o)}}}}},mtopCall:function(e,i){var t=this;_CTK6364(33,"mtopCall.init");t.getMtop(function(){window.lib.mtop.config.prefix="api";window.lib.mtop.config.subDomain="m";if(p=="taobao"){window.lib.mtop.config.mainDomain="taobao.com"}else{window.lib.mtop.config.mainDomain="tmall.com"}window.lib.mtop.request({api:e,v:"1.0",type:"GET",timeout:5e3,dataType:"jsonp",isSec:1,ecode:0},function(e){i&&i(e)},function(e){t.log("tmwap.200.7","H46777410");var i="none";if(e){i=e.retType;if(e.ret&&e.ret[0]){i=i+"msg: "+e.ret[0]}}_CTK6364(0,"error:mtopCallError","mtopCall.init",{msg:i,type:"error"})})})},getTime:function(e){var i=this;_CTK6364(33,"getTime.init");new a({type:"get",url:"//t.alicdn.com/t/gettime",timeout:5,success:function(i){e(i.time*1e3)},error:function(e,t,o){i.log("tmwap.200.13","H46807197");_CTK6364(0,"error:getTimeerror","getTime.init",{msg:t,type:"error"})},dataType:"jsonp"})},getMtop:function(i){if(window.lib&&window.lib.mtop){i()}else{e.getScript("//g.alicdn.com/mtb/??/lib-mtop/1.6.6/mtop.js",function(){i()})}},dateParse:function(e){var i=e.match(/\d+/g);if(i[0].length<4){i=[(new Date).getFullYear()].concat(i)}return+new Date(i[0],i[1]-1,i[2],i[3],i[4],i[5]||0)},log:function(e,i){if(window.goldlog&&window.goldlog.record&&i){try{goldlog.record("/"+e,"","",i)}catch(t){window.mmstatImg=(new Image).src="//wgo.mmstat.com/"+e+"?logtype=2&"}}else{window.mmstatImg=(new Image).src="//wgo.mmstat.com/"+e+"?logtype=2&"}},getUrlKey:function(i){var t=location.search.toLowerCase();var i=i.toLowerCase();if(!i){return e.unparam(t.substring(1))}return e.unparam(t.substring(1))[i]},getLoginStatus:function(e){var i=this;if(p=="taobao"){var t=r.get("_l_g_");if(t){h="os"+r.get("_nk_");e(true,h)}else{e(false);i.log("tmwap.200.8","H46777411")}}else{if(window.TB){TB.Global.loginStatusReady(function(t){if(t&&t.isLogin){h="os"+t.nick;e(true,h)}else{e(false);i.log("tmwap.200.8","H46777411")}})}}},detectFlash:function(){if(navigator.mimeTypes.length>0){var e=navigator.mimeTypes["application/x-shockwave-flash"];return e!=null?e.enabledPlugin!=null:false}else if(self.ActiveXObject){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return true}catch(i){return false}}},checkVideo:function(){if(document.createElement("video").canPlayType){var e=document.createElement("video");var i=e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');if(!i){return false}else{if(i=="probably"){return true}else{return false}}}else{return false}}};return w},{requires:["dom","anim","event","ua","io","cookie","mui/pc-openshow/index.css"]});