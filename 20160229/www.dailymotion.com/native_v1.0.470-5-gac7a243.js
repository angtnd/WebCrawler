/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.1.22 Copyright (c) 2010-2015, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

/*!
 * Copyright (c) 2014 Chris O'Hara <cohara87@gmail.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

// Copyright 2009-2012 by contributors, MIT License
// vim: ts=4 sts=4 sw=4 expandtab

/*!
 * jQuery-ajaxTransport-XDomainRequest - v1.0.4 - 2015-03-05
 * https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest
 * Copyright (c) 2015 Jason Moon (@JSONMOON)
 * Licensed MIT (/blob/master/LICENSE.txt)
 */

function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,r){return t&&eachProp(t,function(t,i){(n||!hasProp(e,i))&&(!r||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[i]=t:(e[i]||(e[i]={}),mixin(e[i],t,n,r)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,r){var i=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return i.requireType=e,i.requireModules=r,n&&(i.originalError=n),i}function newContext(e){function t(e){var t,n;for(t=0;t<e.length;t++)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,r){var i,o,a,s,u,c,l,d,p,f,h,A,v=n&&n.split("/"),m=_.map,g=m&&m["*"];if(e&&(e=e.split("/"),l=e.length-1,_.nodeIdCompat&&jsSuffixRegExp.test(e[l])&&(e[l]=e[l].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&v&&(A=v.slice(0,v.length-1),e=A.concat(e)),t(e),e=e.join("/")),r&&m&&(v||g)){a=e.split("/");e:for(s=a.length;s>0;s-=1){if(c=a.slice(0,s).join("/"),v)for(u=v.length;u>0;u-=1)if(o=getOwn(m,v.slice(0,u).join("/")),o&&(o=getOwn(o,c))){d=o,p=s;break e}!f&&g&&getOwn(g,c)&&(f=getOwn(g,c),h=s)}!d&&f&&(d=f,p=h),d&&(a.splice(0,p,d),e=a.join("/"))}return i=getOwn(_.pkgs,e),i?i:e}function r(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===E.contextName?(t.parentNode.removeChild(t),!0):void 0})}function i(e){var t=getOwn(_.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),E.require.undef(e),E.makeRequire(null,{skipMap:!0})([e]),!0):void 0}function o(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function a(e,t,r,i){var a,s,u,c,l=null,d=t?t.name:null,p=e,f=!0,h="";return e||(f=!1,e="_@r"+(x+=1)),c=o(e),l=c[0],e=c[1],l&&(l=n(l,d,i),s=getOwn(T,l)),e&&(l?h=s&&s.normalize?s.normalize(e,function(e){return n(e,d,i)}):-1===e.indexOf("!")?n(e,d,i):e:(h=n(e,d,i),c=o(h),l=c[0],h=c[1],r=!0,a=E.nameToUrl(h))),u=!l||s||r?"":"_unnormalized"+(D+=1),{prefix:l,name:h,parentMap:t,unnormalized:!!u,url:a,originalName:p,isDefine:f,id:(l?l+"!"+h:h)+u}}function s(e){var t=e.id,n=getOwn(C,t);return n||(n=C[t]=new E.Module(e)),n}function u(e,t,n){var r=e.id,i=getOwn(C,r);!hasProp(T,r)||i&&!i.defineEmitComplete?(i=s(e),i.error&&"error"===t?n(i.error):i.on(t,n)):"defined"===t&&n(T[r])}function c(e,t){var n=e.requireModules,r=!1;t?t(e):(each(n,function(t){var n=getOwn(C,t);n&&(n.error=e,n.events.error&&(r=!0,n.emit("error",e)))}),r||req.onError(e))}function l(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(E.defQueueMap[t]=!0),F.push(e)}),globalDefQueue=[])}function d(e){delete C[e],delete k[e]}function p(e,t,n){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,each(e.depMaps,function(r,i){var o=r.id,a=getOwn(C,o);!a||e.depMatched[i]||n[o]||(getOwn(t,o)?(e.defineDep(i,T[o]),e.check()):p(a,t,n))}),n[r]=!0)}function f(){var e,t,n=1e3*_.waitSeconds,o=n&&E.startTime+n<(new Date).getTime(),a=[],s=[],u=!1,l=!0;if(!g){if(g=!0,eachProp(k,function(e){var n=e.map,c=n.id;if(e.enabled&&(n.isDefine||s.push(e),!e.error))if(!e.inited&&o)i(c)?(t=!0,u=!0):(a.push(c),r(c));else if(!e.inited&&e.fetched&&n.isDefine&&(u=!0,!n.prefix))return l=!1}),o&&a.length)return e=makeError("timeout","Load timeout for modules: "+a,null,a),e.contextName=E.contextName,c(e);l&&each(s,function(e){p(e,{},{})}),o&&!t||!u||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,f()},50)),g=!1}}function h(e){hasProp(T,e[0])||s(a(e[0],null,!0)).init(e[1],e[2])}function A(e,t,n,r){e.detachEvent&&!isOpera?r&&e.detachEvent(r,t):e.removeEventListener(n,t,!1)}function v(e){var t=e.currentTarget||e.srcElement;return A(t,E.onScriptLoad,"load","onreadystatechange"),A(t,E.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function m(){var e;for(l();F.length;){if(e=F.shift(),null===e[0])return c(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));h(e)}E.defQueueMap={}}var g,y,E,b,w,_={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},C={},k={},I={},F=[],T={},P={},S={},x=1,D=1;return b={require:function(e){return e.require?e.require:e.require=E.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?T[e.map.id]=e.exports:e.exports=T[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(_.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},y=function(e){this.events=getOwn(I,e.id)||{},this.map=e,this.shim=getOwn(_.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(e,t,n,r){r=r||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,E.startTime=(new Date).getTime();var e=this.map;return this.shim?void E.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;P[e]||(P[e]=!0,E.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,r=this.depExports,i=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){try{i=E.execCb(n,o,r,i)}catch(a){e=a}if(this.map.isDefine&&void 0===i&&(t=this.module,t?i=t.exports:this.usingExports&&(i=this.exports)),e){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",c(this.error=e);"undefined"!=typeof console&&console.error?console.error(e):req.onError(e)}}else i=o;if(this.exports=i,this.map.isDefine&&!this.ignore&&(T[n]=i,req.onResourceLoad)){var s=[];each(this.depMaps,function(e){s.push(e.normalizedMap||e)}),req.onResourceLoad(E,this.map,s)}d(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(E.defQueueMap,n)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,r=a(e.prefix);this.depMaps.push(r),u(r,"defined",bind(this,function(r){var i,o,l,p=getOwn(S,this.map.id),f=this.map.name,h=this.map.parentMap?this.map.parentMap.name:null,A=E.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(r.normalize&&(f=r.normalize(f,function(e){return n(e,h,!0)})||""),o=a(e.prefix+"!"+f,this.map.parentMap),u(o,"defined",bind(this,function(e){this.map.normalizedMap=o,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),l=getOwn(C,o.id),void(l&&(this.depMaps.push(o),this.events.error&&l.on("error",bind(this,function(e){this.emit("error",e)})),l.enable()))):p?(this.map.url=E.nameToUrl(p),void this.load()):(i=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),i.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(C,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&d(e.map.id)}),c(e)}),i.fromText=bind(this,function(n,r){var o=e.name,u=a(o),l=useInteractive;r&&(n=r),l&&(useInteractive=!1),s(u),hasProp(_.config,t)&&(_.config[o]=_.config[t]);try{req.exec(n)}catch(d){return c(makeError("fromtexteval","fromText eval for "+t+" failed: "+d,d,[t]))}l&&(useInteractive=!0),this.depMaps.push(u),E.completeLoad(o),A([o],i)}),void r.load(e.name,A,i,_))})),E.enable(r,this),this.pluginMaps[r.id]=r},enable:function(){k[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,r,i;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,i=getOwn(b,e.id))return void(this.depExports[t]=i(this));this.depCount+=1,u(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?u(e,"error",bind(this,this.errback)):this.events.error&&u(e,"error",bind(this,function(e){this.emit("error",e)}))}n=e.id,r=C[n],hasProp(b,n)||!r||r.enabled||E.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(C,e.id);t&&!t.enabled&&E.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},E={config:_,contextName:e,registry:C,defined:T,urlFetched:P,defQueue:F,defQueueMap:{},Module:y,makeModuleMap:a,nextTick:req.nextTick,onError:c,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=_.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?(_[t]||(_[t]={}),mixin(_[t],e,!0,!0)):_[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(S[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,n){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=E.makeShimExports(e)),t[n]=e}),_.shim=t),e.packages&&each(e.packages,function(e){var t,n;e="string"==typeof e?{name:e}:e,n=e.name,t=e.location,t&&(_.paths[n]=e.location),_.pkgs[n]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(C,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t,null,!0))}),(e.deps||e.callback)&&E.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,i){function o(n,r,u){var l,d,p;return i.enableBuildCallback&&r&&isFunction(r)&&(r.__requireJsBuild=!0),"string"==typeof n?isFunction(r)?c(makeError("requireargs","Invalid require call"),u):t&&hasProp(b,n)?b[n](C[t.id]):req.get?req.get(E,n,t,o):(d=a(n,t,!1,!0),l=d.id,hasProp(T,l)?T[l]:c(makeError("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(m(),E.nextTick(function(){m(),p=s(a(null,t)),p.skipMap=i.skipMap,p.init(n,r,u,{enabled:!0}),f()}),o)}return i=i||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var r,i=e.lastIndexOf("."),o=e.split("/")[0],a="."===o||".."===o;return-1!==i&&(!a||i>1)&&(r=e.substring(i,e.length),e=e.substring(0,i)),E.nameToUrl(n(e,t&&t.id,!0),r,!0)},defined:function(e){return hasProp(T,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(T,e)||hasProp(C,e)}}),t||(o.undef=function(e){l();var n=a(e,t,!0),i=getOwn(C,e);i.undefed=!0,r(e),delete T[e],delete P[n.url],delete I[e],eachReverse(F,function(t,n){t[0]===e&&F.splice(n,1)}),delete E.defQueueMap[e],i&&(i.events.defined&&(I[e]=i.events),d(e))}),o},enable:function(e){var t=getOwn(C,e.id);t&&s(e).enable()},completeLoad:function(e){var t,n,r,o=getOwn(_.shim,e)||{},a=o.exports;for(l();F.length;){if(n=F.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);h(n)}if(E.defQueueMap={},r=getOwn(C,e),!t&&!hasProp(T,e)&&r&&!r.inited){if(!(!_.enforceDefine||a&&getGlobal(a)))return i(e)?void 0:c(makeError("nodefine","No define call for "+e,null,[e]));h([e,o.deps||[],o.exportsFn])}f()},nameToUrl:function(e,t,n){var r,i,o,a,s,u,c,l=getOwn(_.pkgs,e);if(l&&(e=l),c=getOwn(S,e))return E.nameToUrl(c,t,n);if(req.jsExtRegExp.test(e))s=e+(t||"");else{for(r=_.paths,i=e.split("/"),o=i.length;o>0;o-=1)if(a=i.slice(0,o).join("/"),u=getOwn(r,a)){isArray(u)&&(u=u[0]),i.splice(0,o,u);break}s=i.join("/"),s+=t||(/^data\:|\?/.test(s)||n?"":".js"),s=("/"===s.charAt(0)||s.match(/^[\w\+\.\-]+:/)?"":_.baseUrl)+s}return _.urlArgs?s+((-1===s.indexOf("?")?"?":"&")+_.urlArgs):s},load:function(e,t){req.load(E,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=v(e);E.completeLoad(t.id)}},onScriptError:function(e){var t=v(e);if(!i(t.id)){var n=[];return eachProp(C,function(e,r){0!==r.indexOf("_@r")&&each(e.depMaps,function(e){return e.id===t.id&&n.push(r),!0})}),c(makeError("scripterror",'Script error for "'+t.id+(n.length?'", needed by: '+n.join(", "):'"'),e,[t.id]))}}},E.require=E.makeRequire(),E}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.22",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,r){var i,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=n,n=r):e=[]),o&&o.context&&(a=o.context),i=getOwn(contexts,a),i||(i=contexts[a]=req.s.newContext(a)),o&&i.configure(o),i.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var r=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return r.type=e.scriptType||"text/javascript",r.charset="utf-8",r.async=!0,r},req.load=function(e,t,n){var r,i=e&&e.config||{};if(isBrowser)return r=req.createNode(i,t,n),i.onNodeCreated&&i.onNodeCreated(r,i,t,n),r.setAttribute("data-requirecontext",e.contextName),r.setAttribute("data-requiremodule",t),!r.attachEvent||r.attachEvent.toString&&r.attachEvent.toString().indexOf("[native code")<0||isOpera?(r.addEventListener("load",e.onScriptLoad,!1),r.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,r.attachEvent("onreadystatechange",e.onScriptLoad)),r.src=n,currentlyAddingScript=r,baseElement?head.insertBefore(r,baseElement):head.appendChild(r),currentlyAddingScript=null,r;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,o,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,n){var r,i;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(r=currentlyAddingScript||getInteractiveScript(),r&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")])),i?(i.defQueue.push([e,t,n]),i.defQueueMap[e]=!0):globalDefQueue.push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("requireLib",function(){}),define("unrulyAdCore/util/window",[],function(){return window.parent}),define("util/publisherWindow",[],function(){return window.top}),define("util/trackingEvent",[],function(){return{TAG_IMP:"pp_tag_imp",ADCALL:"pp_adcall",CREATIVE_RECEIVED:"creative_received",PP_IMP:"pp_imp",COMPLETED_VIEW:"pp_completed_view",LIGHTBOX_PLAY:"pp_lb_play",IMP:"imp",VIEW_IMP:"viewableImpression",CLICK:"click",VIDEO_CLICK:"video_click",POST_VIDEO_CLICK:"post_video_click",PRIVACY_POLICY:"privacy_policy",THREE:"three",TEN:"ten",THIRTY:"thirty",THUMB_IMP:"thumb_imp3",TWO_SECOND_VIEW_IMP:"two_second_view_imp",INFEED_VIDEO_VIEW:"pp_infeed_video_view",PP_PAUSE:"pp_pause",PP_RESUME:"pp_resume",share:{FACEBOOK:"share_facebook",TWITTER:"share_twitter",GOOGLEPLUS:"share_googleplus",LINKEDIN:"share_linkedin",PINTEREST:"share_pinterest"},error:{ERROR:"error",NO_ADS:"no_ads",NO_MATCHING_PLACEMENT:"no_matching_placement",ZERO_MATCHING_PLACEMENTS:"zero_matching_placements",NO_SKIN:"no_skin",UNSUPPORTED_BROWSER:"unsupported_browser",AD_REQUEST_FAILED:"error_ad_request_failed",AUDIENCE_TARGETING_REQUEST_FAILED:"error_audience_targeting_request_failed",SKIN_SETUP_FAILED:"error_skin_setup_failed",INFEED_VIDEO_SETUP_FAILED:"error_infeed_video_setup_failed",BLOCKED_CROSS_ORIGIN_FRAME:"error_blocked_cross_origin_frame",UNSUPPORTED_FALLBACK_CONFIG:"error_unsupported_fallback_config",PLACEMENT_ALREADY_FOUND:"placement_already_found",ELEMENT_STYLE_CLONE_ERROR:"element_style_clone_error",MEDIA_ERR_SRC_NOT_SUPPORTED:"media_err_src_not_supported",MEDIA_ERR_ABORTED:"media_err_aborted",MEDIA_ERR_NETWORK:"media_err_network",MEDIA_ERR_DECODE:"media_err_decode",CLICK_ACTION_CREATION_FAILURE:"click_action_creation_failure",SCHEME_NOT_SUPPORTED:"scheme_not_supported",AD_ERROR:"ad_error"},publisher_marker:{FALLBACK:"publisher_marker_fallback"},prefixed:{VAST_REQUEST_X:"vast_request_"},START:"start",FIRST_QUARTILE:"firstQuartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdQuartile",COMPLETE:"complete",UNMUTE:"unmute",MUTE:"mute",PAUSE:"pause",RESUME:"resume"}}),define("util/browser",["util/publisherWindow"],function(e){function t(){return/Android.*mobile|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e.navigator.userAgent)&&v()}function n(){var t=/CPU iPhone OS (6|7|8|9)/i,n=/Android (4|5|6|7|8|9)\.\d(\.\d)?;/i,r=e.navigator.userAgent;return(t.test(r)||n.test(r))&&v()&&!s()}function r(){return i()&&m()}function i(){var t=/iPad; CPU OS (6|7|8|9)/i,n=/Android (4|5|6|7|8|9)\.\d(\.\d)?;/i,r=e.navigator.userAgent;return t.test(r)||n.test(r)}function o(t){var n,r=e.navigator.userAgent,i=t.exec(r);return i&&2===i.length?n=parseFloat(i[1]):-1}function a(){var t=/MSIE (\d+\.\d+)/i,n=/Trident\/(\d+\.\d+)/i;if("CSS1Compat"===e.document.compatMode)return o(t)>=9?!0:o(n)>=7?!0:!1}function s(){var t=/CPU iPhone OS 8/i,n=e.navigator.userAgent,r=e.navigator.standalone;return t.test(n)&&r}function u(){var t=/ Chrome\/(\d+\.\d+)/i,n=/ OPR\/30/;return o(t)>=25&&!n.test(e.navigator.userAgent)}function c(){var t,n,r=/ Firefox\/(\d+\.\d+)/i,i=/\(Windows NT (\d+\.\d+)/i,a=/Macintosh; Intel Mac OS X/i,s=e.navigator.userAgent;return t=o(r)>=25&&o(i)>=6.1,n=o(r)>=35&&a.test(s),t||n}function l(){var e=/ Version\/(\d+\.\d+)(?:\.\d+)? Safari\/\d+\.\d+/i;return o(e)>=6}function d(){return a()?!0:u()?!0:c()?!0:l()?!0:n()||r()}function p(t){var n=e.open(t,"_blank");n||(n=e.open("","_blank"),n.location.href=t)}function f(t){e.location.href=t}function h(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.webkitEnterFullscreen&&e.webkitEnterFullscreen()}function A(e){e.exitFullscreen?e.exitFullscreen():e.webkitExitFullScreen?e.webkitExitFullScreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen()}function v(){var t,n,r=1150;return e.screen?(t=e.screen.width*e.screen.width,n=e.screen.height*e.screen.height,Math.sqrt(t+n)<r):!1}function m(){return e.screen?!v():!1}function g(){return e.navigator.language||e.navigator.userLanguage}function y(){return e.performance}function E(){return b(e.location.href)}function b(t){var n=e.document.createElement("a");return n.href=t,n.hostname}function w(){try{return new e.ActiveXObject("ShockwaveFlash.ShockwaveFlash"),!0}catch(t){return!1}}function _(){return!!e.navigator.plugins["Shockwave Flash"]}function C(){return e.ActiveXObject?w():_()}function k(){return!t()&&C()}function I(e,t){var n=298,r=398,i=12e4,o=16/9,a=.01;if(!u()&&!l())return!1;if(!e||!t)return!1;if(e>=r&&t>=n)return!1;var s=e/t;return Math.abs(s-o)<a&&e*t>=i?!1:!0}return{isMobile:t,isSupportedMobileDevice:n,isSupportedTablet:r,isTablet:i,isSupported:d,isSupportedFirefox:c,openWindow:p,requestFullscreen:h,exitFullscreen:A,getLanguage:g,getDomain:E,getDomainFromURL:b,getPerformance:y,supportsFlash:k,openInCurrentTab:f,isFlashBlocked:I}}),define("util/enable",["util/browser","util/publisherWindow"],function(e,t){function n(e,t){return e&&e.length&&-1!==e.indexOf(t)}var r=["88102","88229","88231","88372","88596","88597","88598","88599","88600","88601","88602","88604","88987","89678","89679","89772","90063","90064","90065","90066","90067","90068","90069"];return{mobileLightbox:!0,desktopLightbox:!0,audienceTargeting:!0,targetingXhrWithCredentials:!0,leoPlayerModule:!0,letterboxInFeedVideo:!1,mobileSharingLightbox:!0,quartileTracking:!0,mobileSharingLightboxClickThrough:!0,inFeedVideoIcons:!0,siteSupportsVPAIDInFeedVideo:!0,siteSupportsResponsiveInFeedVideo:!1,siteRequiresVPAIDEmbeddingDirectly:!1,videoClickthroughNewTab:!1,videoClickthroughCurrentTab:!1,reportSize:!1,inProduction:!0,siteSupportsHTTPS:!1,useDinkContainer:!0,alchemyPlayer:!1,supportsCurrentURLScheme:function(){var e="http:"===t.location.protocol;return this.siteSupportsHTTPS||e},supportsDesktopVideoContainer:function(){var t=!e.isMobile()&&!e.isTablet();return t},moatViewabilityTracking:function(e){return this.supportsDesktopVideoContainer()&&"true"===e.ve},isAlchemyPlayerCreative:function(e){var t=e.crid,r=["1234","21076"];return n(r,t)},supportsVPAID:function(){var e=this.supportsDesktopVideoContainer();return e&&this.siteSupportsVPAIDInFeedVideo},requiresStarAllianceOverride:function(e){var t=e.apid,i=n(r,t);return i},loggingServiceDoSample:!1,skinAttributeCopyToVideoContainer:!1,embedVPAIDDirectly:function(e){var t=e.cid,r=["8234","9112"],i=n(r,t);return i||this.siteRequiresVPAIDEmbeddingDirectly},inarticleHtml5Player:!0}}),define("util/stopwatch",[],function(){function e(){return(new Date).getTime()}function t(){a={}}function n(t,n){a[t]={start:n||e()}}function r(t){var n=a[t]||{};n.end=e()}function i(e){return a[e]}function o(e){var t=a[e];return t&&t.end?t.end-t.start:null}var a={};return{init:t,start:n,stop:r,getTime:o,getStopwatch:i,getStopwatches:function(){return a}}}),define("publisherConfigController",["jquery","util/trackingEvent","util/enable","util/stopwatch"],function(e,t,n,r){function i(e){if(e.featureOverrides)for(var t in e.featureOverrides)e.featureOverrides.hasOwnProperty(t)&&(n[t]=e.featureOverrides[t])}function o(n,o,a){var s="//video.unrulymedia.com/native/skins/skin-"+n+".json";n?(r.start("skin"),e.getJSON(s).done(function(e){r.stop("skin"),e.siteId!==n?a("siteid of skin does not match requested siteid",t.error.SKIN_SETUP_FAILED):(i(e),o(e))}).fail(function(e,n,i){r.stop("skin"),a("could not get skin ("+i+")",t.error.NO_SKIN)})):a("site id not provided",t.error.SKIN_SETUP_FAILED)}return{getPublisherConfig:o}}),define("placementController",["util/trackingEvent"],function(e){function t(e){return e.format&&e.format.inArticle}function n(e){return e.format&&e.format.inFeed}function r(e,t){return function(n){return e(n)&&t(n)}}function i(i){if(!i||!i.placements)throw{message:"no valid publisher config found",errorType:e.error.SKIN_SETUP_FAILED};if(0===i.placements.length)throw{message:"no placements found in publisher config",errorType:e.error.SKIN_SETUP_FAILED};if(i.placements.filter(r(t,n)).length>0)throw{message:"placements must be either in-feed or in-article, not both",errorType:e.error.SKIN_SETUP_FAILED};return i.placements}return{verifyConfig:i}}),define("placementFinder",["util/publisherWindow","jquery","util/trackingEvent"],function(e,t,n){function r(){}function i(e){var t=e.format,n=t.inFeed,r=t.inArticle;return r?r:n}function o(e,t,r){function i(i,o){var a,s,u;t.filter(function(e){return e.selector===o}).map(function(e){e.found=i}),s=t.filter(function(e){return"undefined"==typeof e.found}),s.length>0||(a=t.filter(function(e){return e.found===!1}).map(function(e){return e.selector}),a.length>0?(u="incorrect number of matches for "+a.join(", "),r({message:u,errorType:n.error.NO_MATCHING_PLACEMENT},void 0)):r(void 0,{config:e}))}t.forEach(function(e){a(e.selector,i)})}function a(n,r){function i(){"undefined"!=typeof s&&e.clearTimeout(s),t(n).waitUntilExists("remove")}function o(){i(),r(!1,n)}function a(){i(),t(n).length>1?r(!1,n):r(!0,n)}var s,u=25e3,c=!0;s=e.setTimeout(o,u),t(n).waitUntilExists(a,c)}return r.prototype.matchPlacement=function(r,a){var s=i(r),u=this.getRequiredPlacementSelectors(r);if(s.adInsertion){if(!s.adInsertion.selector)return void a({message:"adInsertion selector is not present",errorType:n.error.SKIN_SETUP_FAILED},void 0);if("function"!=typeof t(e)[s.adInsertion.mode])return void a({message:"adInsertion mode is unsupported",errorType:n.error.SKIN_SETUP_FAILED},void 0)}t(e.document).ready(function(){o(r,u,a)})},r.prototype.getRequiredPlacementSelectors=function(e){var t=i(e),n=[{selector:t.basePlacement.selector}];return t.adInsertion&&t.adInsertion.selector!==t.basePlacement.selector&&n.push({selector:t.adInsertion.selector}),n},r}),function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define("q",e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else Q=e()}(function(){"use strict";function e(e){return function(){return z.apply(e,arguments)}}function t(e){return e===Object(e)}function n(e){return"[object StopIteration]"===te(e)||e instanceof W}function r(e,t){if(V&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(ne)){for(var n=[],r=t;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(e.stack);var o=n.join("\n"+ne+"\n");e.stack=i(o)}}function i(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var i=t[r];s(i)||o(i)||!i||n.push(i)}return n.join("\n")}function o(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function a(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function s(e){var t=a(e);if(!t)return!1;var n=t[0],r=t[1];return n===Q&&r>=q&&ae>=r}function u(){if(V)try{throw new Error}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],r=a(n);if(!r)return;return Q=r[0],r[1]}}function c(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack),e.apply(e,arguments)}}function l(e){return m(e)?e:g(e)?F(e):I(e)}function d(){function e(e){t=e,o.source=e,K(n,function(t,n){G(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,r=void 0}var t,n=[],r=[],i=X(d.prototype),o=X(h.prototype);if(o.promiseDispatch=function(e,i,o){var a=Y(arguments);n?(n.push(a),"when"===i&&o[1]&&r.push(o[1])):G(function(){t.promiseDispatch.apply(t,a)})},o.valueOf=function(){if(n)return o;var e=v(t);return m(e)&&(t=e),e},o.inspect=function(){return t?t.inspect():{state:"pending"}},l.longStackSupport&&V)try{throw new Error}catch(a){o.stack=a.stack.substring(a.stack.indexOf("\n")+1)}return i.promise=o,i.resolve=function(n){
t||e(l(n))},i.fulfill=function(n){t||e(I(n))},i.reject=function(n){t||e(k(n))},i.notify=function(e){t||K(r,function(t,n){G(function(){n(e)})},void 0)},i}function p(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=d();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function f(e){return p(function(t,n){for(var r=0,i=e.length;i>r;r++)l(e[r]).then(t,n)})}function h(e,t,n){void 0===t&&(t=function(e){return k(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=X(h.prototype);if(r.promiseDispatch=function(n,i,o){var a;try{a=e[i]?e[i].apply(r,o):t.call(r,i,o)}catch(s){a=k(s)}n&&n(a)},r.inspect=n,n){var i=n();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function A(e,t,n,r){return l(e).then(t,n,r)}function v(e){if(m(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function m(e){return t(e)&&"function"==typeof e.promiseDispatch&&"function"==typeof e.inspect}function g(e){return t(e)&&"function"==typeof e.then}function y(e){return m(e)&&"pending"===e.inspect().state}function E(e){return!m(e)||"fulfilled"===e.inspect().state}function b(e){return m(e)&&"rejected"===e.inspect().state}function w(){re.length=0,ie.length=0,oe||(oe=!0)}function _(e,t){oe&&(ie.push(e),t&&"undefined"!=typeof t.stack?re.push(t.stack):re.push("(no stack) "+t))}function C(e){if(oe){var t=J(ie,e);-1!==t&&(ie.splice(t,1),re.splice(t,1))}}function k(e){var t=h({when:function(t){return t&&C(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return _(t,e),t}function I(e){return h({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return ee(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function F(e){var t=d();return G(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function T(e){return h({isDef:function(){}},function(t,n){return L(e,t,n)},function(){return l(e).inspect()})}function P(e,t,n){return l(e).spread(t,n)}function S(e){return function(){function t(e,t){var a;if("undefined"==typeof StopIteration){try{a=r[e](t)}catch(s){return k(s)}return a.done?a.value:A(a.value,i,o)}try{a=r[e](t)}catch(s){return n(s)?s.value:k(s)}return A(a,i,o)}var r=e.apply(this,arguments),i=t.bind(t,"next"),o=t.bind(t,"throw");return i()}}function x(e){l.done(l.async(e)())}function D(e){throw new W(e)}function R(e){return function(){return P([this,O(arguments)],function(t,n){return e.apply(t,n)})}}function L(e,t,n){return l(e).dispatch(t,n)}function O(e){return A(e,function(e){var t=0,n=d();return K(e,function(r,i,o){var a;m(i)&&"fulfilled"===(a=i.inspect()).state?e[o]=a.value:(++t,A(i,function(r){e[o]=r,0===--t&&n.resolve(e)},n.reject,function(e){n.notify({index:o,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function M(e){return A(e,function(e){return e=Z(e,l),A(O(Z(e,function(e){return A(e,H,H)})),function(){return e})})}function B(e){return l(e).allSettled()}function j(e,t){return l(e).then(void 0,void 0,t)}function N(e,t){return l(e).nodeify(t)}var V=!1;try{throw new Error}catch(U){V=!!U.stack}var Q,W,q=u(),H=function(){},G=function(){function e(){for(;t.next;){t=t.next;var n=t.task;t.task=void 0;var i=t.domain;i&&(t.domain=void 0,i.enter());try{n()}catch(a){if(o)throw i&&i.exit(),setTimeout(e,0),i&&i.enter(),a;setTimeout(function(){throw a},0)}i&&i.exit()}r=!1}var t={task:void 0,next:null},n=t,r=!1,i=void 0,o=!1;if(G=function(e){n=n.next={task:e,domain:o&&process.domain,next:null},r||(r=!0,i())},"undefined"!=typeof process&&process.nextTick)o=!0,i=function(){process.nextTick(e)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=function(){i=s,a.port1.onmessage=e,e()};var s=function(){a.port2.postMessage(0)};i=function(){setTimeout(e,0),s()}}else i=function(){setTimeout(e,0)};return G}(),z=Function.call,Y=e(Array.prototype.slice),K=e(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;r>n;n++)n in this&&(t=e(t,this[n],n));return t}),J=e(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Z=e(Array.prototype.map||function(e,t){var n=this,r=[];return K(n,function(i,o,a){r.push(e.call(t,o,a,n))},void 0),r}),X=Object.create||function(e){function t(){}return t.prototype=e,new t},$=e(Object.prototype.hasOwnProperty),ee=Object.keys||function(e){var t=[];for(var n in e)$(e,n)&&t.push(n);return t},te=e(Object.prototype.toString);W="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var ne="From previous event:";l.resolve=l,l.nextTick=G,l.longStackSupport=!1,l.defer=d,d.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(Y(arguments,1)):e.resolve(n)}},l.Promise=p,l.promise=p,p.race=f,p.all=O,p.reject=k,p.resolve=l,l.passByCopy=function(e){return e},h.prototype.passByCopy=function(){return this},l.join=function(e,t){return l(e).join(t)},h.prototype.join=function(e){return l([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},l.race=f,h.prototype.race=function(){return this.then(l.race)},l.makePromise=h,h.prototype.toString=function(){return"[object Promise]"},h.prototype.then=function(e,t,n){function i(t){try{return"function"==typeof e?e(t):t}catch(n){return k(n)}}function o(e){if("function"==typeof t){r(e,s);try{return t(e)}catch(n){return k(n)}}return k(e)}function a(e){return"function"==typeof n?n(e):e}var s=this,u=d(),c=!1;return G(function(){s.promiseDispatch(function(e){c||(c=!0,u.resolve(i(e)))},"when",[function(e){c||(c=!0,u.resolve(o(e)))}])}),s.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=a(e)}catch(r){if(n=!0,!l.onerror)throw r;l.onerror(r)}n||u.notify(t)}]),u.promise},l.when=A,h.prototype.thenResolve=function(e){return this.then(function(){return e})},l.thenResolve=function(e,t){return l(e).thenResolve(t)},h.prototype.thenReject=function(e){return this.then(function(){throw e})},l.thenReject=function(e,t){return l(e).thenReject(t)},l.nearer=v,l.isPromise=m,l.isPromiseAlike=g,l.isPending=y,h.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=E,h.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=b,h.prototype.isRejected=function(){return"rejected"===this.inspect().state};var re=[],ie=[],oe=!0;l.resetUnhandledRejections=w,l.getUnhandledReasons=function(){return re.slice()},l.stopUnhandledRejectionTracking=function(){w(),oe=!1},w(),l.reject=k,l.fulfill=I,l.master=T,l.spread=P,h.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},l.async=S,l.spawn=x,l["return"]=D,l.promised=R,l.dispatch=L,h.prototype.dispatch=function(e,t){var n=this,r=d();return G(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},l.get=function(e,t){return l(e).dispatch("get",[t])},h.prototype.get=function(e){return this.dispatch("get",[e])},l.set=function(e,t,n){return l(e).dispatch("set",[t,n])},h.prototype.set=function(e,t){return this.dispatch("set",[e,t])},l.del=l["delete"]=function(e,t){return l(e).dispatch("delete",[t])},h.prototype.del=h.prototype["delete"]=function(e){return this.dispatch("delete",[e])},l.mapply=l.post=function(e,t,n){return l(e).dispatch("post",[t,n])},h.prototype.mapply=h.prototype.post=function(e,t){return this.dispatch("post",[e,t])},l.send=l.mcall=l.invoke=function(e,t){return l(e).dispatch("post",[t,Y(arguments,2)])},h.prototype.send=h.prototype.mcall=h.prototype.invoke=function(e){return this.dispatch("post",[e,Y(arguments,1)])},l.fapply=function(e,t){return l(e).dispatch("apply",[void 0,t])},h.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},l["try"]=l.fcall=function(e){return l(e).dispatch("apply",[void 0,Y(arguments,1)])},h.prototype.fcall=function(){return this.dispatch("apply",[void 0,Y(arguments)])},l.fbind=function(e){var t=l(e),n=Y(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(Y(arguments))])}},h.prototype.fbind=function(){var e=this,t=Y(arguments);return function(){return e.dispatch("apply",[this,t.concat(Y(arguments))])}},l.keys=function(e){return l(e).dispatch("keys",[])},h.prototype.keys=function(){return this.dispatch("keys",[])},l.all=O,h.prototype.all=function(){return O(this)},l.allResolved=c(M,"allResolved","allSettled"),h.prototype.allResolved=function(){return M(this)},l.allSettled=B,h.prototype.allSettled=function(){return this.then(function(e){return O(Z(e,function(e){function t(){return e.inspect()}return e=l(e),e.then(t,t)}))})},l.fail=l["catch"]=function(e,t){return l(e).then(void 0,t)},h.prototype.fail=h.prototype["catch"]=function(e){return this.then(void 0,e)},l.progress=j,h.prototype.progress=function(e){return this.then(void 0,void 0,e)},l.fin=l["finally"]=function(e,t){return l(e)["finally"](t)},h.prototype.fin=h.prototype["finally"]=function(e){return e=l(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},l.done=function(e,t,n,r){return l(e).done(t,n,r)},h.prototype.done=function(e,t,n){var i=function(e){G(function(){if(r(e,o),!l.onerror)throw e;l.onerror(e)})},o=e||t||n?this.then(e,t,n):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),o.then(void 0,i)},l.timeout=function(e,t,n){return l(e).timeout(t,n)},h.prototype.timeout=function(e,t){var n=d(),r=setTimeout(function(){n.reject(new Error(t||"Timed out after "+e+" ms"))},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},l.delay=function(e,t){return void 0===t&&(t=e,e=void 0),l(e).delay(t)},h.prototype.delay=function(e){return this.then(function(t){var n=d();return setTimeout(function(){n.resolve(t)},e),n.promise})},l.nfapply=function(e,t){return l(e).nfapply(t)},h.prototype.nfapply=function(e){var t=d(),n=Y(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},l.nfcall=function(e){var t=Y(arguments,1);return l(e).nfapply(t)},h.prototype.nfcall=function(){var e=Y(arguments),t=d();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},l.nfbind=l.denodeify=function(e){var t=Y(arguments,1);return function(){var n=t.concat(Y(arguments)),r=d();return n.push(r.makeNodeResolver()),l(e).fapply(n).fail(r.reject),r.promise}},h.prototype.nfbind=h.prototype.denodeify=function(){var e=Y(arguments);return e.unshift(this),l.denodeify.apply(void 0,e)},l.nbind=function(e,t){var n=Y(arguments,2);return function(){function r(){return e.apply(t,arguments)}var i=n.concat(Y(arguments)),o=d();return i.push(o.makeNodeResolver()),l(r).fapply(i).fail(o.reject),o.promise}},h.prototype.nbind=function(){var e=Y(arguments,0);return e.unshift(this),l.nbind.apply(void 0,e)},l.nmapply=l.npost=function(e,t,n){return l(e).npost(t,n)},h.prototype.nmapply=h.prototype.npost=function(e,t){var n=Y(t||[]),r=d();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(e,t){var n=Y(arguments,2),r=d();return n.push(r.makeNodeResolver()),l(e).dispatch("post",[t,n]).fail(r.reject),r.promise},h.prototype.nsend=h.prototype.nmcall=h.prototype.ninvoke=function(e){var t=Y(arguments,1),n=d();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},l.nodeify=N,h.prototype.nodeify=function(e){return e?void this.then(function(t){G(function(){e(null,t)})},function(t){G(function(){e(t)})}):this};var ae=u();return l}),define("util/imageFactory",[],function(){return{createImage:function(e,t){return new Image(e,t)}}}),define("util/pixelService",["q","util/imageFactory"],function(e,t){function n(n){var r=e.defer(),i=t.createImage(1,1);return i.onload=function(){r.resolve()},i.onerror=function(){r.reject()},i.src=n,r.promise}return{fire:n}}),define("util/performanceMetrics",["util/stopwatch","util/browser"],function(e,t){function n(e,t){var n="&perf_"+e+"_start="+t.start;return t.end&&(n+="&perf_"+e+"_end="+t.end),n}function r(){var t,r="",i=e.getStopwatches();for(t in i)i.hasOwnProperty(t)&&(r+=n(t,i[t]));return r}function i(e){var n="",r=t.getPerformance();return r.timing[e]&&(n+="&",n+=a[e],n+="=",n+=r.timing[e]),n}function o(){var e,n="",r=t.getPerformance();if(r&&r.timing)for(e in a)a.hasOwnProperty(e)&&(n+=i(e));return n}var a={requestStart:"perf_req_start",responseStart:"perf_res_start",responseEnd:"perf_res_end",domContentLoadedEventEnd:"perf_dom_ready",loadEventEnd:"perf_onload"};return{buildParameters:function(){return o()+r()}}}),define("util/global",[],function(){return window}),define("session/sessionInfo",["util/browser","util/publisherWindow","unrulyAdCore/util/window","util/global"],function(e,t,n,r){function i(){return{site:{lang:e.getLanguage(),ref:t.document.referrer,page:t.location.href,domain:e.getDomain()}}}function o(){return n.unruly&&n.unruly["native"]&&n.unruly["native"].siteId||null}function a(){return r._sessionId}function s(){return"v1.0.470-5-gac7a243"}function u(){return t.document.referrer}function c(){return t.location.href}function l(){return encodeURIComponent(c())}function d(){return encodeURIComponent(l())}return{getSiteInfo:i,getGitHash:s,getSessionId:a,getSiteId:o,getRefUrl:u,getPageUrl:c,getEncodedPageURL:l,getDoubleEncodedPageURL:d}}),define("tracking",["util/pixelService","util/trackingEvent","util/performanceMetrics","session/sessionInfo"],function(e,t,n,r){function i(e){f=e.tracking,h={}}function o(t,i,o,a){var s="//"+d+"/blank.gif?"+t+"="+i+"&app=native&pid="+r.getSiteId();a=a||{};for(var c in o)o.hasOwnProperty(c)&&(s+="&"+c+"="+encodeURIComponent(o[c]));return s=u(s,a),a.noTopWindowAccess||(s+=n.buildParameters()),e.fire(s)}function a(e){var n=[t.CLICK,t.VIDEO_CLICK,t.POST_VIDEO_CLICK,t.error.ELEMENT_STYLE_CLONE_ERROR,t.UNMUTE,t.MUTE];return-1===n.indexOf(e)}function s(t,n){var r=f[t];"object"==typeof r&&(h[t]&&a(t)||(r.map(u).map(function(e){return c(e,n)}).forEach(e.fire),h[t]=!0))}function u(e,t){var n=/\[CACHEBUSTER\]/g,i=/\[ENCODED_URL\]/g,o=/\[DOUBLE_ENCODED_URL\]/g;return t=t||{},p.test(e)&&(e+="&id=[CACHEBUSTER]",e+="&d="+(new Date).getTime(),e+="&h="+r.getGitHash()),t.noTopWindowAccess||(e=e.replace(i,r.getEncodedPageURL()).replace(o,r.getDoubleEncodedPageURL())),e.replace(n,r.getSessionId())}function c(e,t){if(p.test(e)){for(var r in t)t.hasOwnProperty(r)&&(e+="&"+r+"="+encodeURIComponent(t[r]));e+=n.buildParameters()}return e}function l(e,t){t.placementId&&(e.placementId=t.placementId),t.name&&(e.placementName=t.name),t.format&&Object.keys(t.format).length>0&&"string"==typeof Object.keys(t.format)[0]&&(e.adf=Object.keys(t.format)[0].toLowerCase())}var d="stats3.unrulymedia.com",p=/stats3\.unrulymedia\.com/,f=[],h={};return{trackSplunk:function(e,t){return o("e",e,t)},trackActivate:function(e,t,n){return o("t",e,t,n)},trackThirdParty:s,setupThirdPartyTracking:i,enrichParametersFromPlacement:l}}),define("util/publisherAdServerHelper",["unrulyAdCore/util/window","jquery"],function(e,t){function n(){e.frameElement&&t(e.frameElement).setImportantStyle({width:"1px",height:"1px"}).attr({width:"1",height:"1"})}return{shrinkAdServerIFrame:n}}),define("util/publisherApi",["unrulyAdCore/util/window","util/publisherAdServerHelper","util/publisherWindow"],function(e,t,n){function r(t){return e.unruly&&e.unruly["native"]&&"function"==typeof e.unruly["native"][t]}function i(t){return!!e.unruly&&!!e.unruly["native"]&&!!e.unruly["native"].placements&&"object"==typeof e.unruly["native"].placements[t]&&"object"==typeof e.unruly["native"].placements[t].sourceWindow&&"function"==typeof e.unruly["native"].placements[t].sourceWindow.doAddFallback}function o(){r("onFinished")&&e.unruly["native"].onFinished.call(e)}function a(){try{if(n===e)return!1}catch(t){}return!0}function s(){if(a())if(r("onFallback")){var n=e.unruly["native"].onFallback.call(e);if("string"!=typeof n)throw new Error("unruly.native.onFallback function should return HTML string");e.document.open(),e.document.write(n),e.document.close()}else t.shrinkAdServerIFrame()}return{onFinished:o,onFallback:s,hasDFPCallback:i}}),define("audienceTargeting",["jquery","q","util/trackingEvent","util/global","util/publisherWindow","session/sessionInfo"],function(e,t,n,r,i,o){function a(){var r=t.defer(),i="unruly_infeed_audience_cb_"+(new Date).getTime()+"_"+Math.floor(1e7*Math.random());return e.ajax({url:"//segapi.quantserve.com/api/segments.json?a=p-e8Y0HwzVa2sIw&callback="+i,dataType:"jsonp",jsonp:!1,jsonpCallback:i,cache:!0,success:function(e){r.resolve(e)},error:function(e,t){r.reject({type:n.error.AUDIENCE_TARGETING_REQUEST_FAILED,message:"Audience Targeting Request Failed ("+t+" "+e.status+")"})}}),r.promise}function s(){var t,n="//video.unrulymedia.com/iframes/third-party-iframes.html?h="+o.getGitHash(),a=i.location.protocol;t=e("<iframe>"),t.attr("src",a+n),e("body",r.document).append(t)}function u(){setTimeout(function(){s()},1e3)}function c(){e(i).on("load",u)}return{request:a,syncData:c,_addDataSyncIFrameAfterTimeout:u}}),define("util/eventDispatcher",["jquery"],function(e){function t(t){this.target=e(t)}return t.prototype={addEventListener:function(e,t){this.target.on(e,t)},one:function(e,t){this.target.one(e,t)},removeEventListener:function(e,t){this.target.off(e,t)},dispatchEvent:function(e,t){this.target.trigger(e,t)}},t}),define("util/eventBus",["util/eventDispatcher"],function(e){var t=new e({});return t}),define("logging/crossDomainTransporter",["jquery"],function(e){function t(t,n){return e.ajax({url:t,data:n,type:"POST",dataType:"json",xhrFields:{withCredentials:!0},contentType:"application/json; charset=UTF-8",mimeType:"application/json"})}return{postJSON:t}}),define("logging/logSerialiser",[],function(){function e(e){return JSON.stringify(e)}return{serialise:e}}),define("logging/loggingService",["util/eventBus","logging/crossDomainTransporter","logging/logSerialiser","util/enable","session/sessionInfo","util/stopwatch"],function(e,t,n,r,i,o){function a(e,t){s(t)}function s(e){var t;for(t in e)e.hasOwnProperty(t)&&(f[t]=void 0!==e[t]?e[t]:"undefined")}function u(e,t){t&&f.messages.push(t)}function c(){return f}function l(){var t={gitHash:i.getGitHash(),sessionId:i.getSessionId(),siteId:i.getSiteId(),referrer:i.getRefUrl(),pageUrl:i.getPageUrl()};s(t),e.addEventListener("logContext",a),e.addEventListener("logMessages",u)}function d(e){p=r.loggingServiceDoSample?Math.random()>=h:!0,p&&(s({timings:o.getStopwatches()}),t.postJSON(e,n.serialise(c())))}var p,f={messages:[]},h=.5;return{init:l,getLogData:c,sendLog:d}}),define("logging/loggingController",["logging/loggingService","util/trackingEvent"],function(e,t){function n(n){var r="//targaryen.unrulymedia.com/error",o="//targaryen.unrulymedia.com/success",a=n.filter(function(e){return"rejected"===e.state}),s=n.filter(function(e){var n="rejected"===e.state&&e.reason.errorType===t.error.NO_ADS;return"fulfilled"===e.state||n}),u=a.filter(function(e){return-1===i.indexOf(e.reason.errorType)});u.length>0?e.sendLog(r):s.length>0&&e.sendLog(o)}function r(){i=[t.error.NO_ADS,t.error.NO_MATCHING_PLACEMENT,t.error.PLACEMENT_ALREADY_FOUND],e.init()}var i;return{log:n,init:r}}),define("actions/clickthroughAction",["tracking","util/browser","util/enable"],function(e,t,n){function r(r,i){e.trackSplunk("clickAction",{name:r}),n.videoClickthroughCurrentTab?t.openInCurrentTab(i):t.openWindow(i)}function i(){}return i.prototype.init=function(){},i.prototype.populate=function(){},i.prototype.trigger=function(e,t){r(e,t.clickThroughs[e].url)},i}),define("actions/mobileLightboxAction",["jquery","tracking","util/browser","util/trackingEvent","util/eventBus","util/enable"],function(e,t,n,r,i,o){function a(e){if(!n.isSupportedMobileDevice())throw new Error("mobile lightbox is not supported on this device");this.nativeAd=e}function s(){var t;t=e("<div>"),t.css({position:"absolute",opacity:0,"-khtml-opacity":0,"-moz-opacity":0,left:"-1000px"}),this.$video=e("<video>"),this.$video.addClass("unruly_native_video"),this.$video.attr("style","width: 1px !important; height: 2px !important;"),t.append(this.$video),this.nativeAd.append(t),this.handleFullscreen(this.$video)}function u(){var e=this,t=!1,r=this.$video[0];this.$video.on("webkitfullscreenchange mozfullscreenchange fullscreenchange webkitendfullscreen webkitenterfullscreen webkitbeginfullscreen",function(){t=!t,t||(r.pause(),i.dispatchEvent({type:"expandedvideo.close",target:e}))}),this.$video.on("ended",function(){r.pause(),e.rewindVideo(),n.exitFullscreen(r)})}function c(){this.$video[0].currentTime&&(this.$video[0].currentTime=0)}function l(){var e=this.$video[0],n=e.duration/4,i=Math.floor(e.currentTime/n);i>A&&v>i&&t.trackThirdParty(h[i-1]),e.currentTime>=3&&t.trackThirdParty(r.THREE),e.currentTime>=10&&t.trackThirdParty(r.TEN),e.currentTime>=30&&t.trackThirdParty(r.THIRTY)}function d(e){if(!e)throw new Error("campaign is missing video");o.quartileTracking&&(this.$video.on("timeupdate",this.checkQuartiles.bind(this)),this.$video.on("ended",p)),this.$video.attr({src:e})}function p(){t.trackThirdParty(r.COMPLETE)}function f(e){var o=this.$video[0];t.trackThirdParty(r.LIGHTBOX_PLAY,{name:e}),this.rewindVideo(),o.play(),n.requestFullscreen(o),i.dispatchEvent({type:"expandedvideo.open",target:this})}var h=[r.FIRST_QUARTILE,r.MIDPOINT,r.THIRD_QUARTILE],A=0,v=4;return a.prototype.init=s,a.prototype.populate=d,a.prototype.trigger=f,a.prototype.handleFullscreen=u,a.prototype.rewindVideo=c,a.prototype.checkQuartiles=l,a}),define("leo/leoPlayer",["jquery","unrulyAdCore/util/window","tracking","util/trackingEvent","util/publisherWindow","util/eventBus","util/enable","util/browser"],function(e,t,n,r,i,o,a,s){function u(t,n,r){var i,a;E=n,y=r,i={src:"about:blank",title:"",role:"presentation",name:"nativeLeoPlayerIframe",id:"nativeLeoPlayerIframe",scrolling:"no",frameborder:0},s.isSupportedFirefox()&&(i.src='javascript:"";'),a={width:"100%",height:"100%",border:0},m=e("<iframe>"),m.attr(i),m.setImportantStyle(a),m.load(function(){l(),h(),o.addEventListener("expandedvideo.close",c)}),t.append(m),g=m[0]}function c(){o.addEventListener("expandedvideo.open",h),o.removeEventListener("expandedvideo.close",c)}function l(){var e,n;try{e=g.contentWindow.document}catch(r){n=t.document.domain,g.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',e=g.contentWindow.document,e.domain=n}return e}function d(t){return e(t,g.contentWindow.document)}function p(){var e=g.contentWindow.document.createElement("link");return e.setAttribute("href",i.location.protocol+"//video.unrulymedia.com/native/native_leo-v1.0.470-5-gac7a243.css"),e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("media","all"),e.setAttribute("rel","stylesheet"),g.contentWindow.document.head.appendChild(e),e}function f(){var e=g.contentWindow.document.createElement("script");return e.src=i.location.protocol+"//video.unrulymedia.com/native/native_leo-v1.0.470-5-gac7a243.js",g.contentWindow.document.body.appendChild(e),e}function h(){var t,n,r=d("body");g.contentWindow.$=d,p(),n=f(),e(n).bind("load",function(){A(g)}),t=d("<div>").attr({id:"player_wrapper"}),r.addClass("no-sharebar").append(t).css({margin:0,padding:0})}function A(e){var t;e.contentWindow.unruly.browser.location.protocol=i.location.protocol,e.contentWindow.unruly.init(E),t=e.contentWindow.unruly.eventBus,v(t)}function v(e){e.addListener("play",function(){n.trackThirdParty(r.LIGHTBOX_PLAY,{name:y})}),e.addListener("unMute",function(){o.dispatchEvent("unmute")}),e.addListener("mute",function(){o.dispatchEvent("mute")}),a.quartileTracking&&(e.addListener("q2",function(){n.trackThirdParty(r.FIRST_QUARTILE)}),e.addListener("q3",function(){n.trackThirdParty(r.MIDPOINT)}),e.addListener("q4",function(){n.trackThirdParty(r.THIRD_QUARTILE)}),e.addListener("complete",function(){n.trackThirdParty(r.COMPLETE),n.trackThirdParty(r.COMPLETED_VIEW)}),e.addListener("three",function(){n.trackThirdParty(r.THREE)}),e.addListener("ten",function(){n.trackThirdParty(r.TEN)}),e.addListener("thirty",function(){n.trackThirdParty(r.THIRTY),n.trackThirdParty(r.COMPLETED_VIEW)}))}var m,g,y,E;return{create:u,_setupTracking:v,_initialiseLeo:A}}),define("leo/leoConfigCreator",[],function(){function e(e){return{campaign:{allowsHttps:!0,contents:[{alternateVideoSite:"html5",videos:{mp4:{high:{url:e}}}}]}}}return{createConfig:e}}),define("util/friendlyIframe",["jquery","unrulyAdCore/util/window"],function(e,t){function n(t,n){return i=e("<iframe>").attr({src:"about:blank",title:"",role:"presentation",name:t,id:t,scrolling:"no",frameborder:0}).setImportantStyle({border:0}),o=i[0],i.on("load",function(){r(),n(i)}),i}function r(){var e,n;try{e=o.contentWindow.document}catch(r){n=t.document.domain,o.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',e=o.contentWindow.document,e.domain=n}return e}var i,o;return{create:n}}),define("util/touchUtils",["jquery"],function(e){function t(){s>1&&(s=0),2>s?s+=1:s=2}function n(){s>0?s-=1:s=0}function r(e){i()||(e.stopPropagation(),e.preventDefault())}function i(){return 2===s}function o(i){e(i.body).off("touchstart",t),e(i.body).off("touchend",n),e(i.body).off("touchmove",r)}function a(i){e(i.body).on("touchstart",t),e(i.body).on("touchend",n),e(i.body).on("touchmove",r)}var s=0;return{disableScroll:a,enableScroll:o}}),define("util/lightbox",["jquery","util/eventDispatcher","util/friendlyIframe","util/publisherWindow","util/touchUtils"],function(e,t,n,r,i){function o(r){var i=this;r="object"==typeof r?r:{},r.background=r.background||"rgba(0,0,0,0.8)",r.name=r.name||"unrulyNativeLightbox_NoName",this._body=e("body"),this.element=e("<div>"),this._boundClose=this.close.bind(this),this.dispatcher=new t({}),this.$iframe=n.create(r.name,function(){e(i.$iframe[0].contentWindow.document.body).append(i.element)}),this.$iframe.addClass("unruly_native_lightbox"),this.$iframe.setImportantStyle({position:"fixed",display:"block",top:"0",left:"0",background:r.background,overflow:"auto","z-index":"2147483647","box-sizing":"content-box",width:"100%",height:"100%"}),this.element.css({width:"100%",height:"100%",position:"absolute",top:0,left:0})}return o.prototype.append=function(e){this.element.append(e)},o.prototype._disablePageScrolling=function(){this._oldBodyStyle=this._body.attr("style"),this._body.setImportantStyle({overflow:"hidden"}),i.disableScroll(this.$iframe[0].contentWindow.document)},o.prototype._enablePageScrolling=function(){this._body.attr("style",this._oldBodyStyle||""),i.enableScroll(this.$iframe[0].contentWindow.document)},o.prototype.open=function(){var t=e(r).scrollTop();this.element.on("click",this._boundClose),this._body.append(this.$iframe),this._disablePageScrolling(),e(r).scrollTop(t+1),this.dispatcher.dispatchEvent("open")},o.prototype.close=function(){this.element.off("click",this._boundClose),this._enablePageScrolling(),this.$iframe.detach(),this.dispatcher.dispatchEvent("close")},o}),define("actions/desktopLightboxAction",["jquery","util/publisherWindow","util/enable","leo/leoPlayer","leo/leoConfigCreator","util/lightbox","util/eventBus"],function(e,t,n,r,i,o,a){function s(){this.leoLoaded=!1}function u(){var n={},r={},i=.5625;return n.width=e(t.top).width(),n.height=e(t.top).height(),r.width=Math.ceil(.8*n.width),r.height=Math.ceil(r.width*i),r.height>=n.height&&(r.height=Math.ceil(.9*n.height),r.width=Math.ceil(1.8*r.height)),r}function c(){var n,r,i=this,s=u();this.lightbox=new o,this.lightbox.dispatcher.addEventListener("open",function(){a.dispatchEvent({type:"expandedvideo.open",target:i})}),this.lightbox.dispatcher.addEventListener("close",function(){a.dispatchEvent({type:"expandedvideo.close",target:i})}),this.iframeContainer=e("<div>"),this.iframeContainer.addClass("unruly_native_iframe_container"),n=e("<div>"),n.addClass("unruly_native_iframe_underlay"),n.setImportantStyle({position:"absolute",width:"100%",height:"100%",top:"0",left:"0","z-index":"-1","-moz-box-shadow":"0px 0px 70px #000","-webkit-box-shadow":"0px 0px 70px #000","box-shadow":"0px 0px 70px #000","box-sizing":"content-box"}),this.iframeContainer.append(n),r=this.createCloseButton(),this.iframeContainer.append(r),this.iframeContainer.setImportantStyle({position:"absolute",margin:"auto",width:s.width+"px",height:s.height+"px","min-height":2*m+v+"px","min-width":2*m+A+"px",background:"#000000",border:m+"px solid black","box-sizing":"content-box",top:0,right:0,bottom:0,left:0}),e(t).on("resize orientationchange",function(){var e=i.getLightboxDimensions();i.iframeContainer.setImportantStyle({width:e.width+"px",height:e.height+"px"})})}function l(){var t=e("<a>");return t.addClass("unruly_native_close"),t.setImportantStyle({display:"block",width:"30px",height:"30px",position:"absolute",top:"-25px",right:"-25px",cursor:"pointer","text-decoration":"none",background:'transparent url("//video.unrulymedia.com/native/closebox.png") no-repeat center center'}),t.on("click",this.lightbox.close.bind(this.lightbox)),t}function d(e){this.videoUrl=e}function p(e,t){if(!this.leoLoaded){var o=h+"#skid="+t.skid+"&apid="+t.apid+"&app=native";if(n.leoPlayerModule){var a=i.createConfig(this.videoUrl);r.create(this.iframeContainer,a,e)}else{var s=f(o);this.iframeContainer.append(s)}this.lightbox.append(this.iframeContainer),this.leoLoaded=!0}this.lightbox.open()}function f(t){var n=e("<iframe>");return n.addClass("unruly_native_iframe"),n.attr({src:t,frameborder:"0",scrolling:"no"}),n.setImportantStyle({width:"100%",height:"100%","min-width":A+"px","min-height":v+"px",position:"absolute",top:0,left:0}),n.on("click",function(e){e.stopPropagation()}),n}var h="//video.unrulymedia.com/leo-marmalade/leo.html",A=450,v=250,m=10;return s.prototype.init=c,s.prototype.populate=d,s.prototype.trigger=p,s.prototype.createCloseButton=l,s.prototype.getLightboxDimensions=u,s}),define("components/clickThroughButton",["jquery","util/browser","tracking","util/trackingEvent"],function(e,t,n,r){function i(i,o){var a,s;return a=e("<a>Find out more!</a>").addClass("unruly_clickthrough_button").attr("href","javascript:void(0);"),a.on("click",function(e){e.stopPropagation(),t.openWindow(o.clickThroughs.expandedVideo.url),n.trackSplunk(r.POST_VIDEO_CLICK),n.trackThirdParty(r.POST_VIDEO_CLICK)}),s=e("<div>").addClass("row text-row").append(a),i.append(s),a}return{create:i}}),define("actions/sharingLightboxAction",["util/lightbox","util/eventBus","jquery","util/enable","util/publisherWindow","util/browser","tracking","util/trackingEvent","components/clickThroughButton"],function(e,t,n,r,i,o,a,s,u){function c(){return n("<style>@font-face {font-family: 'sociconregular';src: url('data:application/octet-stream;base64,AAEAAAASAQAABAAgRkZUTWr1OZIAABK0AAAAHEdERUYAQwAEAAASGAAAACBPUy8yYgpLmwAAAagAAABWY21hcMvQi0QAAAJYAAABemN2dCAWYhMbAAAHuAAAAE5mcGdtU7QvpwAAA9QAAAJlZ2FzcAAAABAAABIQAAAACGdseWbHRN9hAAAIOAAAB2BoZWFkB5h5QgAAASwAAAA2aGhlYRAGB7gAAAFkAAAAJGhtdHhmAgLbAAACAAAAAFhsb2NhH7odUAAACAgAAAAubWF4cAEyAZsAAAGIAAAAIG5hbWVCG2UgAAAPmAAAAadwb3N0Hykz7QAAEUAAAADNcHJlcGDc+I8AAAY8AAABenZoZWELzxTOAAASkAAAACR2bXR4HDw1kwAAEjgAAABYAAEAAAAAAADjJGfbXw889QA/CAAAAAAA0CIWPgAAAADQIhY+AAD/xwgCCAIAAAAIAAIAAAAAAAAAAQAACAL/nwAACAIAAAAACAIAAQAAAAAAAAAAAAAAAAAAABYAAQAAABYAgQAEAAAAAAACAAEAAgAWAAABAAEWAAAAAAABBLMBkAAFAAQFMwWZAAABHgUzBZkAAAPXAGYCEgAAAgAFCQAAAAAAAAAAAAEAAAAAAAAAAAAAAABQZkVkAEAADeAABmb+ZgAACAIAYQAAAAEAAAAAAAAIAAAAAAAAAAgAAAAIAAAACAACDggAAAAIAADNCAAAAAQBAAAIAgAABAEAAAgCAAACqwAAAgAAAAFVAAABVQAAAQAAAAGaAAAAcQAAAZoAAAIAAAAIAgAAAAAAAwAAAAMAAAAcAAEAAAAAAHQAAwABAAAAHAAEAFgAAAASABAAAwACAAAADQBkAGogCiAvIF/gAP//AAAAAAANAGEAaiAAIC8gX+AA//8AAP/1/6L/neAI3+TftSAVAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAEGAAABAAAAAAAAAAECAAAAAgAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwQFBgAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwACywABNLsExQWLBKdlmwACM/GLAGK1g9WUuwTFBYfVkg1LABEy4YLbABLCDasAwrLbACLEtSWEUjWSEtsAMsaRggsEBQWCGwQFktsAQssAYrWCEjIXpY3RvNWRtLUlhY/RvtWRsjIbAFK1iwRnZZWN0bzVlZWRgtsAUsDVxaLbAGLLEiAYhQWLAgiFxcG7AAWS2wByyxJAGIUFiwQIhcXBuwAFktsAgsEhEgOS8tsAksIH2wBitYxBvNWSCwAyVJIyCwBCZKsABQWIplimEgsABQWDgbISFZG4qKYSCwAFJYOBshIVlZGC2wCiywBitYIRAbECFZLbALLCDSsAwrLbAMLCAvsAcrXFggIEcjRmFqIFggZGI4GyEhWRshWS2wDSwSESAgOS8giiBHikZhI4ogiiNKsABQWCOwAFJYsEA4GyFZGyOwAFBYsEBlOBshWVktsA4ssAYrWD3WGCEhGyDWiktSWCCKI0kgsABVWDgbISFZGyEhWVktsA8sIyDWIC+wBytcWCMgWEtTGyGwAVlYirAEJkkjiiMgikmKI2E4GyEhISFZGyEhISEhWS2wECwg2rASKy2wESwg0rASKy2wEiwgL7AHK1xYICBHI0ZhaoogRyNGI2FqYCBYIGRiOBshIVkbISFZLbATLCCKIIqHILADJUpkI4oHsCBQWDwbwFktsBQsswBAAUBCQgFLuBAAYwBLuBAAYyCKIIpVWCCKIIpSWCNiILAAI0IbYiCwASNCWSCwQFJYsgAgAENjQrIBIAFDY0KwIGOwGWUcIVkbISFZLbAVLLABQ2MjsABDYyMtAAAAuAH/hbABjQBLsAhQWLEBAY5ZsUYGK1ghsBBZS7AUUlghsIBZHbAGK1xYALADIEWwAytEsAQgRbIDDgIrsAMrRLAFIEWyBA4CK7ADK0SwBiBFugAFARcAAiuwAytEsAcgRbIGHgIrsAMrRLAIIEWyBxwCK7ADK0SwCSBFsggXAiuwAytEsAogRbIJFQIrsAMrRLALIEWyChMCK7ADK0SwDCBFugALAQgAAiuwAytEsA0gRbIMEAIrsAMrRLAOIEWyDRACK7ADK0QBsA8gRbADK0SwECBFsg8JAiuxA0Z2K0SwESBFshAJAiuxA0Z2K0SwEiBFshEoAiuxA0Z2K0SwEyBFshIiAiuxA0Z2K0SwFCBFshMXAiuxA0Z2K0SwFSBFshQSAiuxA0Z2K0SwFiBFshUOAiuxA0Z2K0SwFyBFshYMAiuxA0Z2K0SwGCBFshcKAiuxA0Z2K0SwGSBFshgJAiuxA0Z2K0SwGiBFshkJAiuxA0Z2K0RZsBQrAAACMAWHBdUAvQElAGMAZwCMAJUAtADKAN0A4QELAF4AKQHeAFEAZwB7ALQA6wEsAW4BmgHWACkBUAFSAD8BFgD/APQA2ABBAB8ASQCjAGUAAAAAAAwADAAMAHAAygISAvIDpAOkA6QDpAOkA6QDpAOkA6QDpAOkA6QDpAOkA7AAAAABAAAAAAfQCAAAAwAAMSERIQfQ+DAIAAABAAAAhwgABwcAMwAsALIAAAArsh4CACuyFiImMzMzsh4BACsBsDQvsTUBKwCxHgARErEZKjk5MDERFjMgNy4BJxYzMjcuAT0BFhcuATU0NxYEBSY1NDYzMhc2NwYHNjcGBxYVFA4EBCMgMjIBJeWI2CgqJTk1kcBaZVZlOZ4BwgECC/aut3yNfTCIfHVUfgIzZ5LK7f7Zov6jAUQGtAKjfwgPHuaYBTEDObhscmLC6A0xLq72hBxKmFEPM39aJBJ38+vVtIRKAAECDv/HBfIHxwAaAFoAshkAACuyCAIAK7AMM7QPBAANBCu0AQAZCA0rsBYztAEEAAwEK7AUMgGwGy+wGdawAjKxGBfpsBIyshgZCiuzQBgVCSuwDDKyGRgKK7NAGQAJK7EcASsAMDEBETMRND4CMzIWHwEDJiMiBh0CIQMhESERAg7+O3XDfT56Hh4IanNXOgF4Ef6Z/pIDiAFaAShZnX5JBwMD/r0BSk8Q7f6m/D8DwQAAAAQAAABTCAAHOwBBAFwAdACAARYAsgQAACuxWQXpsngCACuwJjOyeAIAK7QkDgBiBCuwYzKydgEAK7B6M7F1B+mwfDKydXYKK7NAdX8JK7RNOgR4DSu0TQ4ANwQrtG8xBHgNK7RvDgA3BCsBsIEvsC3WsV0U6bNCXS0IK7EAFOmwAC+xQhTpsF0QsTYBK7ERFemwERCxaQErsRoU6bNVGmkIK7QIEwAcBCuwGhCxfwErsHcysX4T6bB5MrJ+fwors0B+fAkrsn9+CiuzQH91CSuxggErsRE2ERK1MzpNUVlvJBc5sGkRsA45sBoSswwVJCUkFzmxfwgRErAmOQCxTVkRErAAObExOhESsgwRNjk5ObBvEbAzObB1ErEVFzk5sHYRsWktOTkwMREUFxYXJDc2NSYnJi8BJicmNTQ3Nj8BNjc2NzQnLgEnLgMjMzchIgcGBwYVFBcWFzI3BwYVFBcWFwYHBgcGBwYXNDc2NzY/ATY3NjMyMzIXFhcWFRQHBgcmJyYTNDU0NzY3FhcWFxYVFAcGBwYHIicmJyYFNSERMxEhFSERIxF6ePUBJZuVATU4Sk8PFBUVFhBFHhk2AQ8VLB4EEQoNBZCQ/i5nYHBekWZhux8rDgkXFBlGh3tyZCcoxhkWISIfMkpKLxwJCBYehDs6VFikuWhvdDI/X0k1NiFHBQkdPV1JODclSgNBAYV7AYX+e3sBoIRgZgMFh4Kqd0pIPUEPGRgkJhwhED4fJEx8RDM2Rh4EEQkIUhMbToyqj2pyAwUoFR4zJScgARQVQTxPUg0/LCocHA4VFgsEAl08QVptRUgBA09PBKQFBVhLSgMDJypEjIoaNDArPwMsLECJVY8Bhf57j/56AYYAAQDN/8cHMwfHAFIAywCyHwAAK7IWAAArsTkK6bIqAgArsioCACuyCgIAK7FACukBsFMvsADWsUQV6bJEAAors0BESAkrsEQQsSYBK7EtGOmwLRCxPAErsRIW6bFUASuwNhq6PgzwUAAVKwoOsCMQsCTAsRwf+bAzwLMaHDMTK7IaHDMgiiCKIwYOERI5ALQaHCMkMy4uLi4uAbQaHCMkMy4uLi4usEAaAbEmRBESsh4hTTk5ObAtEbIKNUA5OTmwPBKxFjk5OQCxKjkRErQSADxETiQXOTAxEzQ3Njc2NzY3NjMyFxYXFhcWFRAHBiEiJyYnAgcGByMmNTQ3EyY1NDc2MzIWFRQHBgcGBwYVFBcWMzISETQnJiMgBwYVFBcWFRQHBgcOAScmJybNIiJJSGRpi5Kmq5CSYmM3OLe3/t5iUlQhTQgmh1MLFp0nRERiT1QRFRsWFAYrO2Cq2IaG7v7zpKVQEwIIEAYiFXs/PwTPa2loZWNMUCstOjtgYX5/hf6X7OwsLT/+zx6PwWdYe10Clk50hFtaaE42QU9VRU8aGEAzRgF6AQ3PgYGqq/CMZBYaCQoeQxcQCDN9fQAAAAMAAP/NCAAHwQAOACAAUAB5ALI6AAArsR1MMzOyBAIAK7QMBAAJBCu0MUM6BA0rtDEEAAsEKwGwUS+wD9awADKxGhnpsAgysBoQsSEBK7FIGemxLC8yMrBIELE+ASuxNhDpsVIBK7EaDxESsgsMBDk5ObE+SBESsDE5ALExQxESsxUlFC8kFzkwMRE0NzYzMhcWFRQHBiInJhMRNDc2MyEyFxYVERQGIyEiJiURNDYzITIXFhcWFxUWFTYzIBcWFREUBiMhIicmNRE0JyYjIgcGFREUBwYjISInJklKZWZJSUlJzElJDRAPFQFuFQ8QIBT+khQgAp0eFgFjFAsKBQIDAYrjAP+PkCAU/ooVEA8oJ2aENDUPEBb+kxUQDwbJZUtISEtlZEtJSUv5nAUJFRAPDxAV+vcUICAUBQkWHgcGFhAKCwwLgX+A+fyZFCAQDxUDEmczMUxNiP1EFQ8QEA8AAAAAAQAAAAAIAggCAAMAADERIREIAggC9/4AAAAMAJYAAQAAAAAAAQAHABAAAQAAAAAAAgAHACgAAQAAAAAAAwAlAHwAAQAAAAAABAAPAMIAAQAAAAAABQALAOoAAQAAAAAABgAIAQgAAwABBAkAAQAOAAAAAwABBAkAAgAOABgAAwABBAkAAwBKADAAAwABBAkABAAeAKIAAwABBAkABQAWANIAAwABBAkABgAQAPYAUwBvAGMAaQBjAG8AbgAAU29jaWNvbgAAUgBlAGcAdQBsAGEAcgAAUmVndWxhcgAARgBvAG4AdABGAG8AcgBnAGUAIAAyAC4AMAAgADoAIABmAG8AbgB0ADIAOQA4ADUAIAA6ACAAMgA5AC0AMQAwAC0AMgAwADEAMwAARm9udEZvcmdlIDIuMCA6IGZvbnQyOTg1IDogMjktMTAtMjAxMwAAUwBvAGMAaQBjAG8AbgAgAFIAZQBnAHUAbABhAHIAAFNvY2ljb24gUmVndWxhcgAAVgBlAHIAcwBpAG8AbgAgADEALgAwAABWZXJzaW9uIDEuMAAAZgBvAG4AdAAyADkAOAA1AABmb250Mjk4NQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFgAAAQIBAwBEAEUARgBHAE0BBAEFAQYBBwEIAQkBCgELAQwBDQEOAQ8BEAERBmdseXBoMQd1bmkwMDBEB3VuaTIwMDAHdW5pMjAwMQd1bmkyMDAyB3VuaTIwMDMHdW5pMjAwNAd1bmkyMDA1B3VuaTIwMDYHdW5pMjAwNwd1bmkyMDA4B3VuaTIwMDkHdW5pMjAwQQd1bmkyMDJGB3VuaTIwNUYHdW5pRTAwMAAAAAABAAH//wAPAAEAAAAOAAAAGAAAAAAAAgABAAEAFQABAAQAAAACAAAAtAgAAAAAAAgAAAAAtAcHALQHxwC0BzsAtAfHALQHwQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQBAgCAAEQAAQC/AAAABAE/8f4tAgCAAAAAQAAAAAAAAAAAAAAAAAWAAAAAQAAAADMPaLPAAAAAM6VgI8AAAAA0CIWMw==') format('truetype');font-weight: normal;font-style: normal;}.close-button {position: absolute;top: 0;right: 0;margin: 30px;width: 10%;height: auto;}@media (orientation: landscape) {.close-button {width: auto;height: 10%;}}.container {position: absolute;top: 50%;left: 50%;}.unruly_sharing_icon {font-family: 'sociconregular';color: white;font-size: 12%;}.unruly_sharing_button {text-decoration:none;display:inline-block;width: 20%;height: 20%;margin: 3%;line-height: 20%;overflow:hidden;}.unruly_sharing_button_facebook {position:relative;line-height:12%;vertical-align:bottom;}.unruly_sharing_button_facebook .unruly_sharing_icon {position:absolute;bottom:0;right:5%;}.row {text-align:center;}.text-row {color: #1591aa;font-family: Helvetica, Arial, sans-serif;font-weight: bold;font-size: 8%;display:block;padding:3%;}.text-row:first-of-type {margin-top:3%}.text-row.big-row {margin-top:14%;}.unruly_clickthrough_button {display: block;background: #0bbbef;width: 80%;margin: 0 5%;padding: 3% 5%;color: #ffffff;text-decoration: none;}</style>");
}function l(e){var t=n("<img>").addClass("close-button").attr("src",w+"/in-feed-close-icon-128x128.png");return t.on("click",function(t){t.stopPropagation(),e.close()}),t}function d(e,t){var r=n("<div>").addClass("row text-row"),i=n("<span>Share the Video!</span>");m(t)||r.addClass("big-row"),r.append(i),e.append(r)}function p(e,t){var r,i,o,a,s=f(t),u=0;for(i in s)s.hasOwnProperty(i)&&(o=s[i],r=h(o,i),_[i]=r,u%3===0&&(a=n("<div>").addClass("row"),e.append(a)),a.append(r),u++)}function f(e){var t,n,r={facebook:{icon:"b",url:"https://www.facebook.com/sharer.php?u=%{url}",color:"#3b5998",eventName:s.share.FACEBOOK},twitter:{icon:"a",url:"https://twitter.com/intent/tweet?text=%{title}%20-%20%{url}",color:"#00aced",eventName:s.share.TWITTER},pinterest:{icon:"d",url:"https://pinterest.com/pin/create/button/?url=%{url}&description=%{title}&media=%{thumbnail}",color:"#cc2127",eventName:s.share.PINTEREST},linkedin:{icon:"j",url:"https://www.linkedin.com/shareArticle?mini=true&url=%{url}&title=%{title}&summary=&source=",color:"#0977b5",eventName:s.share.LINKEDIN},googleplus:{icon:"c",url:"https://plus.google.com/share?url=%{url}",color:"#cc3732",eventName:s.share.GOOGLEPLUS}};for(t in r)r.hasOwnProperty(t)&&(n=r[t],n.url=n.url.replace("%{title}",encodeURIComponent(e.items.title.text)).replace("%{thumbnail}",encodeURIComponent(e.items.thumbnail.attributes.src)).replace("%{url}",encodeURIComponent(e.sharing.sharingUrl)));return r}function h(e,t){var r=n('<a href="javascript:void(0);"></a>').addClass("unruly_sharing_button").addClass("unruly_sharing_button_"+t).css({backgroundColor:e.color}),i=n("<span>"+e.icon+"</span>");return i.addClass("unruly_sharing_icon"),r.append(i),r.on("click",function(t){t.stopPropagation(),o.openWindow(e.url),a.trackThirdParty(e.eventName)}),r}function A(e){var t=i.document.documentElement.clientWidth,n=i.document.documentElement.clientHeight,r=Math.min(t,n),o=Math.ceil(r/2);e.css({width:r+"px",height:r+"px","margin-top":-o+"px","margin-left":-o+"px","font-size":r+"px"})}function v(e,t){m(t)&&u.create(e,t)}function m(e){return r.mobileSharingLightboxClickThrough&&e.clickThroughs.expandedVideo&&e.clickThroughs.expandedVideo.url}function g(r){var o=new e({background:"rgba(255,255,255,0.9)"}),a=n("<div>").addClass("container unruly-sharing-lightbox");return d(a,r),p(a,r),v(a,r),o.append(c()),o.append(l(o)),o.append(a),o.dispatcher.addEventListener("open",function(){A(a),n(i).on("resize",A.bind(void 0,a)),t.dispatchEvent({type:"sharinglightbox.open"})}),o.dispatcher.addEventListener("close",function(){n(i).off("resize",A.bind(void 0,a)),t.dispatchEvent({type:"sharinglightbox.close"})}),o}function y(e){this.campaignConfig=e}function E(){var e=g(this.campaignConfig);e.open()}var b=i.location.protocol,w=b+"//video.unrulymedia.com/native",_={};return y.prototype.init=function(){},y.prototype.populate=function(){},y.prototype.trigger=E,y.prototype.createSharingPlatforms=f,y.prototype.sharingButtonElements=_,y});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("actions/videoClickthroughAction",["tracking","util/browser","util/trackingEvent"],function(e,t,n){var r=function(){function r(e){_classCallCheck(this,r),this.player=e}return _createClass(r,[{key:"init",value:function(){}},{key:"populate",value:function(){}},{key:"trigger",value:function(e,t){this._clickThrough(t.clickThroughs[e].url)}},{key:"_clickThrough",value:function(r){this.player.paused()?this.player.play():(this.player.pause(),r&&(e.trackThirdParty(n.VIDEO_CLICK),t.openWindow(r)))}}]),r}();return r}),define("actions/nullAction",[],function(){function e(){}return e.prototype.init=function(){},e.prototype.populate=function(){},e.prototype.trigger=function(){},e}),define("videoPlayers/utils/mediaFilesUtil",[],function(){var e=function(e){return"string"==typeof e},t=function(t){if(!t)return!1;var n=t.type,r=t.delivery,i=t.url;return"video/mp4"===n&&"progressive"===r&&e(i)},n=function(t){if(!t)return!1;var n=t.type,r=t.apiFramework,i=t.url;return"application/x-shockwave-flash"===n&&"VPAID"===r&&e(i)},r=function(e,t){return e.bitrate>t.bitrate?1:e.bitrate<t.bitrate?-1:0},i=function(e){return e.filter(t).sort(r)[0]},o=function(e){return e.filter(n)[0]},a=function(e){return function(t){return!!t.filter(e).length}},s=a(t),u=a(n);return{isMP4:t,isFlashVPAID:n,byBitrate:r,getSmallestMP4:i,getFlashVPAID:o,containsMP4:s,containsFlashVPAID:u}}),define("actions/actionFactory",["util/browser","util/enable","actions/clickthroughAction","actions/mobileLightboxAction","actions/desktopLightboxAction","actions/sharingLightboxAction","actions/videoClickthroughAction","actions/nullAction","videoPlayers/utils/mediaFilesUtil"],function(e,t,n,r,i,o,a,s,u){function c(o,c){var l=u.isMP4,d=u.isFlashVPAID;return c.supports().clickThrough()?new a(c):t.videoClickthroughNewTab||t.videoClickthroughCurrentTab?new n:t.mobileLightbox&&e.isMobile()?new r(o):t.desktopLightbox&&l(c.mediaFile)&&!e.isMobile()?new i:d(c.mediaFile)?new s:new n}function l(n){return t.mobileSharingLightbox&&e.isMobile()&&n.sharing.sharingUrl?new o(n):new s(n)}return{createClickAction:c,createExpandedVideoCloseAction:l}}),define("adEventHandler",["actions/actionFactory","util/trackingEvent"],function(e,t){function n(){this.clickThroughElements={}}function r(n,r,i,o){try{this.action=e.createClickAction(n,i)}catch(a){return void o(a.message,t.error.CLICK_ACTION_CREATION_FAILURE)}this.clickThroughElements=r,this.action.init()}function i(e,t,n){n.stopPropagation(),this.action.trigger(t,e)}function o(e,n,r){var o,a;for(a in this.clickThroughElements)o=this.clickThroughElements[a],o.on("click",i.bind(this,e,a)),o.css("cursor","pointer");try{this.action.populate(n)}catch(s){r(s.message,t.error.NO_MATCHING_PLACEMENT)}}return n.prototype.setupClickListeners=r,n.prototype.populate=o,n.prototype.clickEventHandler=i,n}),define("viewability/viewability",["jquery","util/publisherWindow","util/eventDispatcher","util/eventBus"],function(e,t,n,r){function i(t){this.elementToWatch=e(t.elementToWatch),this.viewablePercentage=t.viewablePercentage,this.dispatcher=new n(this),this.viewable=null,this._lightboxOpen=!1,this._boundCheckViewabilty=this.checkViewability.bind(this),this._pollId=setInterval(this._boundCheckViewabilty,100),this._setLightboxStateOpen=this.setLightboxStateOpen.bind(this),r.addEventListener("expandedvideo.open",this._setLightboxStateOpen),this._setLightboxStateClose=this.setLightboxStateClose.bind(this),r.addEventListener("expandedvideo.close",this._setLightboxStateClose)}function o(e,t){var n=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),r=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n*r}var a=e(t);return i.prototype.setLightboxStateOpen=function(){this._lightboxOpen=!0},i.prototype.setLightboxStateClose=function(){this._lightboxOpen=!1},i.prototype.destroy=function(){clearInterval(this._pollId),this._pollId=void 0,r.removeEventListener("expandedvideo.open",this._setLightboxStateOpen),r.removeEventListener("expandedvideo.close",this._setLightboxStateClose)},i.prototype.checkViewability=function(){var e=this.isViewable(this.elementToWatch,this.viewablePercentage);e!==this.viewable&&(this.viewable=e,this.viewable?this.dispatcher.dispatchEvent("inview"):this.dispatcher.dispatchEvent("outofview"))},i.prototype.isViewable=function(n,r){var i,s,u,c,l,d=n.offset(),p=a.scrollTop(),f=a.scrollLeft();return this._lightboxOpen?!1:e.contains(t.document.documentElement,n[0])?(i={left:d.left,top:d.top,right:d.left+n.width(),bottom:d.top+n.height()},s={top:p,bottom:p+t.innerHeight,left:f,right:f+t.innerWidth},u=o(i,s),l=n.width()*n.height(),c=l*r,u>=c):!1},{Viewability:i}}),define("viewability/adViewabilityHandler",["util/publisherWindow","viewability/viewability","tracking","util/trackingEvent","util/eventBus"],function(e,t,n,r,i){function o(){var e=m&&g;!f&&e&&(f=setTimeout(s,h))}function a(){f&&(clearTimeout(f),f=void 0)}function s(){i.dispatchEvent({type:"viewability.in_feed_video_view",target:v}),a(),A.dispatcher.removeEventListener("inview",u),A.dispatcher.removeEventListener("outofview",c),i.removeEventListener("player.playing",l),i.removeEventListener("player.paused",d),A.destroy()}function u(){m=!0,o()}function c(){m=!1,a()}function l(){g=!0,o()}function d(){g=!1,a()}function p(e){A=new t.Viewability(e),h=e.viewableTimeout,v=e.elementToWatch,i.addEventListener("player.setupcomplete",function(){A.dispatcher.addEventListener("inview",u),A.dispatcher.addEventListener("outofview",c),i.addEventListener("player.playing",l),i.addEventListener("player.paused",d),A.checkViewability()})}var f,h,A,v,m=!1,g=!1;return{init:p}}),define("videoPlayers/playerStates",[],function(){return{unstarted:-1,ended:0,playing:1,paused:2,buffering:3,cued:5}}),define("util/jqueryElementFactory",["jquery"],function(e){return{create:function(t){return e(t)}}}),define("util/elementStyleReset",["jquery"],function(e){var t={DIV:"block",IFRAME:"inline"};return{resetStyles:function(n){var r=e(n),i=t[r.prop("tagName")];return r.setImportantStyle({margin:0,padding:0,border:0,"line-height":"normal"}),i&&r.setImportantStyle({display:i}),n}}});var compose=function(e,t){return function(){return e(t.apply(void 0,arguments))}};define("util/dom/jqueryReset",["util/jqueryElementFactory","util/elementStyleReset"],function(e,t){return{createAndReset:compose(t.resetStyles,e.create)}}),define("videoPlayers/videoPlayerTypes",[],function(){return{FLASH_VPAID_DIRECT_EMBED:"flash_vpaid_direct_embed",HTML5:"html5",FLASH_VPAID_SANDBOX:"flash_vpaid_sandbox",DINK:"dink",ALCHEMY:"alchemy",values:function(){return[this.ALCHEMY,this.FLASH_VPAID_DIRECT_EMBED,this.FLASH_VPAID_SANDBOX,this.HTML5,this.DINK]}}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("videoPlayers/dinkPlayer",["util/enable","jquery","util/global","util/eventDispatcher","videoPlayers/playerStates","util/eventBus","util/dom/jqueryReset","videoPlayers/videoPlayerTypes","videoPlayers/utils/mediaFilesUtil"],function(e,t,n,r,i,o,a,s,u){var c=/\.(mp4)(\?.*)?$/,l=function(e){return e.replace(c,".dink")},d=function(){function c(t,n){if(_classCallCheck(this,c),!t)throw new Error("mediaFiles not provided");if(this.mediaFile=u.getSmallestMP4(t),!this.mediaFile)throw new Error("No valid mediaFiles provided");var o=this.mediaFile.url;if(!n)throw new Error("Element not provided");if(this.container=n,e.useDinkContainer){var s=a.createAndReset("<img>");s.addClass("unruly_native_thumbnail"),s.setImportantStyle({position:"relative",top:"50%",transform:"translateY(-50%)"}),this.container.appendChild(s.get(0)),this.imageElement=s.get(0)}else this.imageElement=this.container;this.videoUrl=o,this.dinkUrl=l(o),this.dispatcher=new r(this),this.playerState=i.unstarted}return _createClass(c,[{key:"supports",value:function(){return{ownPlayerTimer:function(){return!1},clickThrough:function(){return!1}}}},{key:"load",value:function(){function e(e){var t=[];return"string"!=typeof e.dataUriPrefix||"object"!=typeof e.frames?t:(e.frames.forEach(function(n){t.push(e.dataUriPrefix+n)}),t)}var n=this;this.playerState=i.buffering,this.dispatcher.dispatchEvent({type:"loadstart"}),t.getJSON(this.dinkUrl).done(function(t){if(n.frames=e(t),0===n.frames.length||"number"!=typeof t.fps){var r="invalid dink json";return n.playerState=i.unstarted,void n.dispatcher.dispatchEvent({type:"error",message:r,mediaFileUrl:n.dinkUrl})}n.fps=t.fps,n.imageElement.src=n.frames[0],n.playerState=i.cued,o.one("placement.addedtodom",function(){n.dispatcher.dispatchEvent({type:"readytoplay"}),n.dispatcher.dispatchEvent({type:"adimpression"})}),n.dispatcher.dispatchEvent({type:"setupcomplete"})}).fail(function(e,t,r){var o="failed to load dink json: "+e.status+" : "+t+" : "+r+" - "+n.dinkUrl;n.playerState=i.unstarted,n.dispatcher.dispatchEvent({type:"error",message:o,mediaFileUrl:n.dinkUrl})})}},{key:"play",value:function(){function e(){r.imageElement.src=r.frames[r.currentFrameIndex]}function t(){r.currentFrameIndex++,r.currentFrameIndex>a&&(r.currentFrameIndex=0,r.dispatcher.dispatchEvent({type:"loop"})),e(),r.frameTimeout=n.setTimeout(t,o)}if(this.canPlay()){var r=this,o=Math.floor(1e3/this.fps),a=this.frames.length-1;this.playerState!==i.paused&&(this.currentFrameIndex=0),e(),this.frameTimeout=n.setTimeout(t,o),this.playerState=i.playing,this.dispatcher.dispatchEvent({type:"playing"})}}},{key:"pause",value:function(){this.playerState===i.playing&&(n.clearTimeout(this.frameTimeout),this.playerState=i.paused,this.dispatcher.dispatchEvent({type:"pause"}))}},{key:"paused",value:function(){}},{key:"canPlay",value:function(){return this.playerState===i.paused||this.playerState===i.ended||this.playerState===i.cued}},{key:"getDuration",value:function(){}},{key:"getPlayerType",value:function(){return s.DINK}}]),c}();return{DinkPlayer:d}}),define("videoPlayers/videoPlayerFeatures",[],function(){return{LOOP:"loop",CLICK_THROUGH:"click_through",values:function(){return[this.LOOP,this.CLICK_THROUGH]}}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("videoPlayers/html5Player",["util/eventDispatcher","videoPlayers/videoPlayerFeatures","jquery","util/eventBus","videoPlayers/videoPlayerTypes","videoPlayers/utils/mediaFilesUtil"],function(e,t,n,r,i,o){var a=function(){function a(r,i,s){var u=this;if(_classCallCheck(this,a),!r)throw new Error("mediaFiles not provided");if(this.mediaFile=o.getSmallestMP4(r),!this.mediaFile)throw new Error("No valid mediaFiles provided");var c=this.mediaFile.url;if(!i)throw new Error("Element not provided");this.videoUrl=c,this.video=n("<video>").addClass("unruly_native_in_feed_video"),this.video.setImportantStyle({width:"100%",height:"100%"}),this.video.setImportantStyle({"background-color":"black"}),this.dispatcher=new e(this),this._videoElementDispatcher=new e(this.video),this.setVideoAttributes(),this.supportsVideoPlayerFeature=function(e){return!!s&&!!s.supportsVideoPlayerFeature&&s.supportsVideoPlayerFeature(e)},this.supportsVideoPlayerFeature(t.LOOP)&&this.setVideoToLoopWhenEnded(),this.container=n(i),this.video.one("canplaythrough",function(e,t){u.container.append(u.video),u.dispatcher.dispatchEvent("setupcomplete",t)})}return _createClass(a,[{key:"supports",value:function(){var e=this;return{ownPlayerTimer:function(){return!1},clickThrough:function(){return e.supportsVideoPlayerFeature(t.CLICK_THROUGH)}}}},{key:"setVideoAttributes",value:function(){this.video.prop("autoplay",!1),this.video.prop("muted",!0),this.video.prop("loop",!1),this.video.prop("preload","auto")}},{key:"setVideoToLoopWhenEnded",value:function(){var e=this;this._videoElementDispatcher.one("ended",function(){e.play(),e.video.prop("loop",!0)})}},{key:"load",value:function(){var e=this,t=["playing","pause","ended","error"];r.one("placement.addedtodom",function(){e.dispatcher.dispatchEvent("readytoplay"),e.dispatcher.dispatchEvent("adimpression")}),this._videoElementDispatcher.addEventListener("timeupdate",function(t,n){var r=e.video.prop("currentTime");n=n||{},n.currentTime=r,e.dispatcher.dispatchEvent("timeupdate",n)}),t.forEach(function(t){e._videoElementDispatcher.addEventListener(t,function(n,r){e.dispatcher.dispatchEvent(t,r)})}),this.video.attr("src",this.videoUrl)}},{key:"play",value:function(){this.video[0].play()}},{key:"pause",value:function(){this.video[0].pause()}},{key:"paused",value:function(){return this.video.prop("paused")}},{key:"mute",value:function(){this.video.prop("muted",!0)}},{key:"unmute",value:function(){this.video.prop("muted",!1)}},{key:"getDuration",value:function(){return this.video.prop("duration")}},{key:"getCurrentTime",value:function(){return this.video.prop("currentTime")}},{key:"getPlayerType",value:function(){return i.HTML5}}]),a}();return{Html5Player:a}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("videoPlayers/nullPlayer",["util/eventDispatcher"],function(e){var t=function(){function t(n){if(_classCallCheck(this,t),!n)throw new Error("Media files not provided");this.dispatcher=new e(this),n[0]&&(this.mediaFile=n[0]),this.videoUrl=n[0].url}return _createClass(t,[{key:"supports",value:function(){return{ownPlayerTimer:function(){return!1},clickThrough:function(){return!1}}}},{key:"getDuration",value:function(){}},{key:"load",value:function(){this.dispatcher.dispatchEvent({type:"error",message:"No compatible media file found",mediaFileUrl:this.videoUrl})}}]),t}();return{NullPlayer:t}}),define("util/iframeBridge",["util/global"],function(e){function t(e){try{e.jquery&&(e=e.get(0))}catch(t){}try{if(e.contentWindow)return e.contentWindow}catch(t){}return e}function n(e,n,r){var i=t(e),o={name:n};r&&(o.payload=r),i&&"undefined"!=typeof i.postMessage&&i.postMessage(o,"*")}function r(t,n){e.addEventListener("message",function(e){e.data&&e.data.name===t&&n(e.data.payload,e.source)},!1)}function i(t,n){var r=function i(r){r.data&&r.data.name===t&&(e.removeEventListener("message",i),n(r.data.payload,r.source))};e.addEventListener("message",r,!1)}return{postMessage:n,receiveMessage:r,receiveOnce:i}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("vpaid/vpaidBroker",["util/eventDispatcher","util/dom/jqueryReset","util/iframeBridge"],function(e,t,n){var r=function(){function r(t){_classCallCheck(this,r),this.parentElement=t.parentElement,this.dispatcher=new e({})}return _createClass(r,[{key:"load",value:function(){var e=this,n="nativeLoaderIframe";this.iframeElement=t.createAndReset('<iframe class="unruly_vpaid_iframe_container" scrolling="no">'),this.iframeElement.setImportantStyle({width:"100%",height:"100%"}),this.iframeElement.attr("src","//video.cdn-unrulymedia-1.com/native/vpaid_wrapper_v1.0.470-5-gac7a243.html#"+n),this.iframeElement.load(function(){e.iframeReady=!0}),this.parentElement.append(this.iframeElement),this.dispatcher.dispatchEvent("setupcomplete")}},{key:"consume",value:function(e,t){var r=this,i=["AdLoaded","AdStarted","AdVideoStart","AdLog","AdError","AdVideoComplete","AdVolumeChange","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdStopped","AdClickThru","videoProgress"];i.forEach(function(e){n.receiveMessage(e,function(t){r.dispatcher.dispatchEvent(e,t)})}),n.receiveMessage("VPAIDCreativeLoaded",function(){t()});var o=function(){var t=!0;n.receiveOnce("vpaidIframeHandshakeConfirmed",function(){t=!1,n.postMessage(r.iframeElement,"consumeVPAID",{url:e})});var i=function o(){t&&(n.postMessage(r.iframeElement,"vpaidIframeHandshake"),setTimeout(o,10))};i()};this.iframeReady?o():this.iframeElement.load(function(){o()})}},{key:"unmute",value:function(){n.postMessage(this.iframeElement,"unmute")}},{key:"initAd",value:function(e,t,r,i,o,a){n.postMessage(this.iframeElement,"initAd",{args:[e,t,r,i,o,a]})}},{key:"getAdVolume",value:function(e){n.postMessage(this.iframeElement,"getAdVolume"),n.receiveOnce("getAdVolume:Response",function(t){"function"==typeof e&&e(t.volume)})}},{key:"setAdVolume",value:function(e){n.postMessage(this.iframeElement,"setAdVolume",{args:[e]})}},{key:"startAd",value:function(){n.postMessage(this.iframeElement,"startAd")}},{key:"resumeAd",value:function(){n.postMessage(this.iframeElement,"resumeAd")}},{key:"pauseAd",value:function(){n.postMessage(this.iframeElement,"pauseAd")}},{key:"stopAd",value:function(){n.postMessage(this.iframeElement,"stopAd")}},{key:"mute",value:function(){n.postMessage(this.iframeElement,"mute")}},{key:"on",value:function(e,t){this.dispatcher.addEventListener(e,t)}}]),r}();return{VPAIDBroker:r}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("videoPlayers/flashVPAIDPlayer",["util/eventDispatcher","jquery","util/eventBus","util/trackingEvent","util/elementStyleReset","vpaid/vpaidBroker","videoPlayers/videoPlayerTypes","videoPlayers/utils/mediaFilesUtil"],function(e,t,n,r,i,o,a,s){var u=function(){function i(r,a){var u=this;if(_classCallCheck(this,i),!r)throw new Error("mediaFiles not provided");if(this.mediaFile=s.getFlashVPAID(r),!this.mediaFile)throw new Error("No valid mediaFiles provided");var c=this.mediaFile.url;if(!a)throw new Error("Element not provided");this.videoUrl=c,this.startAdCalled=!1,this.adLoaded=!1,this.adStarted=!1,this.adStopped=!1,this.muted=!0;var l=a.jquery?a:t(a);this.VPAIDConfig={parentElement:l,width:"100%",height:"100%",flashBridgeName:"__testFlashBridge",consumerUrl:"//video.unrulymedia.com/native/flash-vpaid-consumer-v1.0.470-5-gac7a243.swf"},this.container=l,this.dispatcher=new e(this),this.vpaidBroker=new o.VPAIDBroker(this.VPAIDConfig),this.vpaidBroker.dispatcher.addEventListener("videoProgress",function(e,t){u.dispatcher.dispatchEvent("videoProgress",t)}),this.vpaidBroker.dispatcher.addEventListener("SetupError",function(e,t){n.dispatchEvent("player.error",t)})}return _createClass(i,[{key:"supports",value:function(){return{ownPlayerTimer:function(){return!0},clickThrough:function(){return!1}}}},{key:"getDuration",value:function(){}},{key:"getPlayerType",value:function(){return a.FLASH_VPAID_SANDBOX}},{key:"load",value:function(e){var i=this;n.one("placement.addedtodom",function(){i.vpaidBroker.consume(i.videoUrl,function(){i.vpaidBroker.dispatcher.addEventListener("AdLoaded",function(){i.adLoaded=!0,i.dispatcher.dispatchEvent("readytoplay"),i.dispatcher.dispatchEvent("adimpression")}),i.vpaidBroker.dispatcher.addEventListener("AdStarted",function(){i.adStarted=!0}),i.vpaidBroker.dispatcher.addEventListener("AdVideoStart",function(){i.dispatcher.dispatchEvent("playing"),i.muted&&i.vpaidBroker.setAdVolume(0)}),i.vpaidBroker.dispatcher.addEventListener("AdLog",function(e,t){i.dispatcher.dispatchEvent(e,t)}),i.vpaidBroker.dispatcher.addEventListener("AdError",function(e,t){i.dispatcher.dispatchEvent(e,t)}),i.vpaidBroker.dispatcher.addEventListener("AdVideoComplete",function(){i.dispatcher.dispatchEvent(r.COMPLETE),i.dispatcher.dispatchEvent("AdVideoComplete"),i.vpaidBroker.stopAd(),setTimeout(function(){i.adStopped||i.dispatcher.dispatchEvent("adstoptimeout")},1e3)}),i.vpaidBroker.dispatcher.addEventListener("AdVolumeChange",function(){i.vpaidBroker.getAdVolume(function(e){e>0&&i.vpaidBroker.unmute()})}),i.vpaidBroker.dispatcher.addEventListener("AdVideoFirstQuartile",function(){i.dispatcher.dispatchEvent(r.FIRST_QUARTILE)}),i.vpaidBroker.dispatcher.addEventListener("AdVideoMidpoint",function(){i.dispatcher.dispatchEvent(r.MIDPOINT)}),i.vpaidBroker.dispatcher.addEventListener("AdVideoThirdQuartile",function(){i.dispatcher.dispatchEvent(r.THIRD_QUARTILE)}),i.vpaidBroker.dispatcher.addEventListener("AdStopped",function(){i.adStopped=!0,i.dispatcher.dispatchEvent("AdStopped")}),i.vpaidBroker.dispatcher.addEventListener("AdClickThru",function(){i.dispatcher.dispatchEvent("AdClickThru")}),i.vpaidBroker.initAd(t(i.VPAIDConfig.parentElement).width(),t(i.VPAIDConfig.parentElement).height(),"normal",999,e&&e.adParameters)}),i.muted&&i.vpaidBroker.mute()}),i.vpaidBroker.dispatcher.addEventListener("setupcomplete",function(){i.dispatcher.dispatchEvent("setupcomplete")}),i.vpaidBroker.load()}},{key:"play",value:function(){this.adLoaded&&(this.startAdCalled?this.vpaidBroker.resumeAd():(this.vpaidBroker.startAd(),this.startAdCalled=!0))}},{key:"pause",value:function(){this.adStarted&&this.vpaidBroker.pauseAd()}},{key:"paused",value:function(){}},{key:"mute",value:function(){this.vpaidBroker.setAdVolume(0),this.vpaidBroker.mute()}},{key:"unmute",value:function(){this.vpaidBroker.setAdVolume(1),this.vpaidBroker.unmute()}}]),i}();return{FlashVPAIDPlayer:u}}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("vpaid-consumer/vpaid-consumer",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.VPAIDConsumer=e()}}(function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){var r=e("./lib/vpaid-consumer");t.exports=r},{"./lib/vpaid-consumer":4}],2:[function(e,t,n){function r(e){var t,n={type:"application/x-shockwave-flash",data:e.swfUrl,width:e.width,height:e.height,style:"width: "+e.width+" !important; height: "+e.height+" !important;"};return t=o.createElement("object"),o.addAttributes(t,n),i(t,e),o.addClass(t,"unruly_vpaid_player"),o.appendChild(e.parentElement,t),t}function i(e,t){var n,r,i={allowScriptAccessParam:{name:"allowScriptAccess",value:"always"},allowFullscreenParam:{name:"allowFullScreen",value:"true"},wmodeParam:{name:"wmode",value:"opaque"},qualityParam:{name:"quality",value:"high"},menuParam:{name:"menu",value:"false"},flashvarsParam:{name:"flashvars",value:"onConsumerReady="+t.flashVars.onConsumerReady+"&onFlashEvent="+t.flashVars.onFlashEvent}};for(n in i)i.hasOwnProperty(n)&&(r=o.createElement("param",n),o.addAttributes(r,i[n]),o.appendChild(e,r))}var o=e("./utils/dom-utils");t.exports={embed:r}},{"./utils/dom-utils":3}],3:[function(e,t,n){t.exports={createElement:function(e){return document.createElement(e)},addAttributes:function(e,t){for(var n in t)e.setAttribute(n,t[n])},appendChild:function(e,t){e.appendChild(t)},addClass:function(e,t){var n=e.className;""==n?e.className=t:e.className=n+" "+t}}},{}],4:[function(e,t,n){function r(e){this.width=e.width,this.height=e.height,this.parentElement=e.parentElement,this.flashBridgeName=e.flashBridgeName||"__unrulyFlashBridge",this._emitter=new a.EventEmitter,this.consumerUrl=e.consumerUrl,this.isReady=!1}var i=e("./swf-embedder"),o=e("./vpaid-creative"),a=e("events");r.prototype.init=function(){var e,t,n,r=this.consumerUrl,a=this.parentElement.ownerDocument,s=a.defaultView||a.parentWindow,u=this;return s[this.flashBridgeName]={onConsumerReady:function(){u.isReady=!0,u._emitter.emit("ready",!0)},onFlashEvent:function(e,t){var n;t=decodeURIComponent(t);try{n=JSON.parse(t)}catch(r){n={type:"Error",message:"Could not deserialise the flash event "+t}}"VPAIDCreativeLoaded"===e?(u.vpaidCreative=o.create({flashObject:u._flashObj}),u._emitter.emit(e,u.vpaidCreative)):u.vpaidCreative&&u.vpaidCreative.trigger(e,n)}},e={onConsumerReady:this.flashBridgeName+".onConsumerReady",onFlashEvent:this.flashBridgeName+".onFlashEvent"},t={allowScriptAccess:"always",allowFullScreen:"true",wmode:"opaque",quality:"high",menu:"false"},n={width:this.width,height:this.height,parentElement:this.parentElement,flashVars:e,flashParams:t,swfUrl:r},this._flashObj=i.embed(n),this._flashObj},r.prototype.on=function(e,t){this._emitter.on(e,t)},r.prototype.consume=function(e,t){function n(t){t&&r._flashObj.consumeVPAIDCreative(e)}var r=this;this.isReady?n(!0):this.on("ready",n),this.on("VPAIDCreativeLoaded",function(e){t(void 0,e)})},r.prototype.mute=function(){function e(e){e&&t._flashObj.masterVolume(0)}var t=this;this.isReady?e(!0):this.on("ready",e)},r.prototype.unmute=function(){function e(e){e&&t._flashObj.masterVolume(1)}var t=this;this.isReady?e(!0):this.on("ready",e)},t.exports={VPAIDConsumer:r}},{"./swf-embedder":2,"./vpaid-creative":5,events:6}],5:[function(e,t,n){function r(e){e=e||{},this._flashObject=e.flashObject,this._emitter=new i.EventEmitter}var i=e("events");r.prototype.trigger=function(e,t){this._emitter.emit(e,t)},r.prototype.on=function(e,t){this._emitter.on(e,t)},r.prototype.once=function(e,t){this._emitter.once(e,t)},r.prototype.handshakeVersion=function(e){return this._flashObject.handshakeVersion(e)},r.prototype.initAd=function(e,t,n,r,i,o){return this._flashObject.initAd(e,t,n,r,i,o)},r.prototype.resizeAd=function(e,t,n){return this._flashObject.resizeAd(e,t,n)},r.prototype.setAdVolume=function(e){return this._flashObject.adVolume(e)},r.prototype.getAdVolume=function(){return this._flashObject.adVolume()},r.prototype.adDuration=function(){return this._flashObject.adDuration?this._flashObject.adDuration():void 0},r.prototype.adRemainingTime=function(){return this._flashObject.adRemainingTime?this._flashObject.adRemainingTime():void 0},function(){["startAd","stopAd","pauseAd","resumeAd","expandAd","collapseAd","skipAd"].forEach(function(e){r.prototype[e]=function(){return this._flashObject[e]?this._flashObject[e]():void 0}})}(),t.exports={create:function(e){return new r(e)}}},{events:6}],6:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,o,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),u=1;r>u;u++)o[u-1]=arguments[u];n.apply(this,o)}else if(a(n)){for(r=arguments.length,o=new Array(r-1),u=1;r>u;u++)o[u-1]=arguments[u];for(c=n.slice(),r=c.length,u=0;r>u;u++)c[u].apply(this,o)}return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned){var n;n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;
if(n=this._events[e],o=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=o;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?i(e._events[t])?1:e._events[t].length:0}},{}]},{},[1])(1)}),define("vpaid-consumer",["vpaid-consumer/vpaid-consumer"],function(e){return e}),define("vpaidWrapper/vpaidController/videoProgressWatcher",["util/iframeBridge"],function(e){return{init:function(t,n){function r(){var o=t.percentComplete();e.postMessage(n,"videoProgress",{percentComplete:o}),100>o&&setTimeout(r,i)}var i=100;r()}}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("videoPlayers/flashVPAIDDirectEmbedPlayer",["util/eventDispatcher","vpaid-consumer","jquery","util/eventBus","util/trackingEvent","util/elementStyleReset","vpaidWrapper/vpaidController/videoProgressWatcher","util/global","util/iframeBridge","videoPlayers/videoPlayerTypes","videoPlayers/utils/mediaFilesUtil"],function(e,t,n,r,i,o,a,s,u,c,l){var d=function(){function d(n,r){if(_classCallCheck(this,d),!n)throw new Error("mediaFiles not provided");if(this.mediaFile=l.getFlashVPAID(n),!this.mediaFile)throw new Error("No valid mediaFiles provided");var i=this.mediaFile.url;if(!r)throw new Error("Element not provided");this.videoUrl=i,this.startAdCalled=!1,this.adLoaded=!1,this.adStarted=!1,this.adStopped=!1,this.muted=!0,this.container=r,this.VPAIDConfig={width:"100%",height:"100%",parentElement:r&&r.jquery?r[0]:r,flashBridgeName:"__testFlashBridge",consumerUrl:"//video.unrulymedia.com/native/flash-vpaid-consumer-v1.0.470-5-gac7a243.swf"},this.dispatcher=new e(this),this.vpaidConsumer=new t.VPAIDConsumer(this.VPAIDConfig),o.resetStyles(this.vpaidConsumer.init())}return _createClass(d,[{key:"supports",value:function(){return{ownPlayerTimer:function(){return!0},clickThrough:function(){return!1}}}},{key:"getDuration",value:function(){}},{key:"getPlayerType",value:function(){return c.FLASH_VPAID_DIRECT_EMBED}},{key:"percentComplete",value:function p(){var e=this.vpaidConsumer.vpaidCreative;if(!(e.adRemainingTime&&e.adRemainingTime()&&e.adDuration&&e.adDuration()))return 0;var p=(e.adDuration()-e.adRemainingTime())/e.adDuration()*100;return Math.max(p,0)}},{key:"load",value:function(e){var t=this,o=this;r.one("placement.addedtodom",function(){o.vpaidConsumer.consume(o.videoUrl,function(r,c){o.VPAIDCreative=c,c.on("AdLoaded",function(){o.adLoaded=!0,o.dispatcher.dispatchEvent("readytoplay"),o.dispatcher.dispatchEvent("adimpression")}),c.on("AdStarted",function(){o.adStarted=!0}),c.on("AdVideoStart",function(){o.dispatcher.dispatchEvent("playing"),o.muted&&o.VPAIDCreative.setAdVolume(0),a.init(t,s),u.receiveMessage("videoProgress",function(e){o.dispatcher.dispatchEvent("videoProgress",e)})}),c.on("AdLog",function(e){o.dispatcher.dispatchEvent("AdLog",e)}),c.on("AdError",function(e){o.dispatcher.dispatchEvent("AdError",e)}),c.on("AdVideoComplete",function(){o.dispatcher.dispatchEvent(i.COMPLETE),o.dispatcher.dispatchEvent("AdVideoComplete"),o.VPAIDCreative.stopAd(),setTimeout(function(){o.adStopped||o.dispatcher.dispatchEvent("adstoptimeout")},1e3)}),c.on("AdVolumeChange",function(){o.VPAIDCreative.getAdVolume()>0&&o.vpaidConsumer.unmute()}),c.on("AdVideoFirstQuartile",function(){o.dispatcher.dispatchEvent(i.FIRST_QUARTILE)}),c.on("AdVideoMidpoint",function(){o.dispatcher.dispatchEvent(i.MIDPOINT)}),c.on("AdVideoThirdQuartile",function(){o.dispatcher.dispatchEvent(i.THIRD_QUARTILE)}),c.on("AdStopped",function(){o.adStopped=!0,o.dispatcher.dispatchEvent("AdStopped")}),c.on("AdClickThru",function(){o.dispatcher.dispatchEvent("AdClickThru")}),c.initAd(n(o.VPAIDConfig.parentElement).width(),n(o.VPAIDConfig.parentElement).height(),"normal",999,e&&e.adParameters)}),o.muted&&o.vpaidConsumer.mute()}),o.dispatcher.dispatchEvent("setupcomplete")}},{key:"play",value:function(){this.VPAIDCreative&&this.adLoaded&&(this.startAdCalled?this.VPAIDCreative.resumeAd():(this.VPAIDCreative.startAd(),this.startAdCalled=!0))}},{key:"pause",value:function(){this.adStarted&&this.VPAIDCreative.pauseAd()}},{key:"paused",value:function(){}},{key:"mute",value:function(){this.VPAIDCreative.setAdVolume(0),this.vpaidConsumer.mute()}},{key:"unmute",value:function(){this.VPAIDCreative.setAdVolume(1)}}]),d}();return{FlashVPAIDDirectEmbedPlayer:d}}),define("util/dom/styles",["jquery"],function(e){return{setImportantStyle:function(t,n){e(t).setImportantStyle(n)}}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("videoPlayers/alchemyPlayer",["util/eventDispatcher","videoPlayers/videoPlayerFeatures","util/eventBus","videoPlayers/videoPlayerTypes","videoPlayers/utils/mediaFilesUtil","util/publisherWindow","util/dom/jqueryReset","util/dom/styles"],function(e,t,n,r,i,o,a,s){var u=function(){function t(n,r){if(_classCallCheck(this,t),!r)throw new Error("Element not provided");if(!n)throw new Error("mediaFiles not provided");if(this.mediaFile=i.getSmallestMP4(n),!this.mediaFile)throw new Error("No valid mediaFiles provided");this.videoUrl=this.mediaFile.url,this.dispatcher=new e(this),this.videoElementId="unruly_mobile_video_player_id",this.loadAlchemyScript(),this.playerElement=a.createAndReset('<div id="'+this.videoElementId+'" class="unruly_mobile_video_player">'),s.setImportantStyle(this.playerElement,{width:"100%",height:"100%"}),this.container=r,this.container.appendChild(this.playerElement[0])}return _createClass(t,[{key:"loadAlchemyScript",value:function(){var e=this,t=o.document,n=t.createElement("script");o._alchemyPlayerUnitLoaded=function(){e.dispatcher.dispatchEvent("setupcomplete")},n.type="text/javascript",n.src="https://d.alcvid.com/tag-unit-player/56aa222809fa09b67a8b4568/56af7d61edfd09494e8b456f";var r=t.querySelector("head");r.insertBefore(n,r.firstChild)}},{key:"supports",value:function(){return{ownPlayerTimer:function(){return!1},clickThrough:function(){return!1}}}},{key:"load",value:function(){var e=this,t=this.mediaFile,r=this.dispatcher,i=function(){var t=e.player;t.on("playing",function(){return r.dispatchEvent("playing")}),t.on("timeupdate",function(){return r.dispatchEvent("timeupdate")}),t.on("ended",function(){return r.dispatchEvent("ended")}),r.dispatchEvent("readytoplay")},a={vastConfig:{assets:[t]},onload:i,onfailure:function(){}};n.one("placement.addedtodom",function(){e.player=new o.AlchemyPlayerUnit(e.videoElementId,a)})}},{key:"play",value:function(){this.player.play()}},{key:"pause",value:function(){this.player.pause()}},{key:"paused",value:function(){}},{key:"mute",value:function(){}},{key:"unmute",value:function(){}},{key:"getDuration",value:function(){return this.player.duration}},{key:"getCurrentTime",value:function(){return this.player.currentTime}},{key:"getPlayerType",value:function(){return r.ALCHEMY}}]),t}();return{AlchemyPlayer:u}}),define("playerTimer",["util/eventBus","util/trackingEvent"],function(e,t){function n(e){var n=e.getDuration(),i=n/4,o=e.getCurrentTime();o>=i&&2*i>o?r(t.FIRST_QUARTILE,e):o>=2*i&&3*i>o?r(t.MIDPOINT,e):o>=3*i&&n>o&&r(t.THIRD_QUARTILE,e)}function r(e,t){s[e]||(i(e,t),s[e]=!0)}function i(t,n){-1!==u.indexOf(t)&&e.dispatchEvent({type:"player."+t,target:n})}function o(e){var n=30;e.getCurrentTime()>=n&&r(t.COMPLETED_VIEW,e)}function a(){e.addEventListener("player.timeupdate",function(e){var t=e.target;n(t),o(t)}),e.addEventListener("player.ended",function(e){r(t.COMPLETE,e.target),r(t.COMPLETED_VIEW,e.target)}),e.addEventListener("player.playing",function(e){r(t.IMP,e.target),r(t.START,e.target)})}var s={},u=[t.FIRST_QUARTILE,t.MIDPOINT,t.THIRD_QUARTILE];return{init:a}}),define("videoPlayers/videoPlayerFactory",["videoPlayers/html5Player","videoPlayers/dinkPlayer","videoPlayers/nullPlayer","videoPlayers/flashVPAIDPlayer","videoPlayers/flashVPAIDDirectEmbedPlayer","videoPlayers/alchemyPlayer","playerTimer","videoPlayers/videoPlayerTypes"],function(e,t,n,r,i,o,a,s){function u(u,c,l){var d,p=void 0,f=void 0,h=(d={},_defineProperty(d,s.FLASH_VPAID_DIRECT_EMBED,i.FlashVPAIDDirectEmbedPlayer),_defineProperty(d,s.HTML5,e.Html5Player),_defineProperty(d,s.FLASH_VPAID_SANDBOX,r.FlashVPAIDPlayer),_defineProperty(d,s.DINK,t.DinkPlayer),_defineProperty(d,s.ALCHEMY,o.AlchemyPlayer),d),A=!1;return s.values().forEach(function(e){A||l.supportsVideoPlayerType(e)&&(f=h[e],A=!0)}),A||(f=n.NullPlayer),p=new f(c,u,l),p.supports().ownPlayerTimer()||a.init(),p}return{createPlayer:u}}),define("playerTimerTracker",["util/eventBus","tracking","util/trackingEvent"],function(e,t,n){function r(e){s[e]||(i(e),s[e]=!0)}function i(e){t.trackThirdParty(e)}function o(e){var t=30;e.currentTime>=t&&r(n.COMPLETED_VIEW)}function a(){e.addEventListener("player.timeupdate",function(e,t){o(t)}),e.addEventListener("player.ended",function(e){r(n.COMPLETE,e.target),r(n.COMPLETED_VIEW,e.target)}),e.addEventListener("player.playing",function(e){r(n.IMP,e.target),r(n.START,e.target)}),e.addEventListener("player.firstQuartile",function(e){r(n.FIRST_QUARTILE,e.target)}),e.addEventListener("player.midpoint",function(e){r(n.MIDPOINT,e.target)}),e.addEventListener("player.thirdQuartile",function(e){r(n.THIRD_QUARTILE,e.target)}),e.addEventListener("player.complete",function(e){r(n.COMPLETE,e.target)})}var s={};return{init:a}}),define("videoPlayers/videoEventDispatcher",["util/eventBus","util/trackingEvent","util/global"],function(e,t,n){function r(r){var i,o=!1,a={};a[n.MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED]=t.error.MEDIA_ERR_SRC_NOT_SUPPORTED,a[n.MediaError.MEDIA_ERR_ABORTED]=t.error.MEDIA_ERR_ABORTED,a[n.MediaError.MEDIA_ERR_NETWORK]=t.error.MEDIA_ERR_NETWORK,a[n.MediaError.MEDIA_ERR_DECODE]=t.error.MEDIA_ERR_DECODE,i=["timeupdate","firstQuartile","midpoint","thirdQuartile","ended","complete"],i.forEach(function(t){r.dispatcher.addEventListener(t,function(n,i){e.dispatchEvent({type:"player."+t,target:r},i)})}),r.dispatcher.addEventListener("playing",function(){e.dispatchEvent({type:"player.playing",target:r}),o&&(e.dispatchEvent({type:"player.resume",target:r}),o=!1)}),r.dispatcher.addEventListener("pause",function(){e.dispatchEvent({type:"player.pause",target:r}),o=!0}),r.dispatcher.addEventListener("error",function(t){var n={type:t.type,message:t.message,src:t.mediaFileUrl};t.originalEvent&&t.originalEvent.target&&(t.originalEvent.target.error&&t.originalEvent.target.error.code&&(n.type=a[t.originalEvent.target.error.code]),t.originalEvent.target.src&&(n.message="Unable to play file "+t.originalEvent.target.src,n.src=t.originalEvent.target.src)),e.dispatchEvent({type:"player.error",target:r},[n])})}return{setupPlayerEventReFiring:r}}),define("videoPlayers/videoPlayerViewability",["viewability/viewability"],function(e){return{init:function(t){t.dispatcher.one("readytoplay",function(){var n=new e.Viewability({elementToWatch:t.container,viewablePercentage:.5});n.dispatcher.addEventListener("inview",t.play.bind(t)),n.dispatcher.addEventListener("outofview",t.pause.bind(t)),n.checkViewability()})}}}),define("videoPlayers/videoPlayerDirector",["playerTimerTracker","videoPlayers/videoEventDispatcher","videoPlayers/videoPlayerViewability"],function(e,t,n){function r(r){t.setupPlayerEventReFiring(r),e.init(),n.init(r)}return{direct:r}});var _get=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return;e=c,t=o,n=a,r=!0,s=c=void 0}},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("adFormats/adFormatCapabilities",["videoPlayers/videoPlayerTypes","videoPlayers/videoPlayerFeatures","util/enable","util/browser","videoPlayers/utils/mediaFilesUtil"],function(e,t,n,r,i){var o=function(){function e(){_classCallCheck(this,e),this.supportedVideoPlayers={},this.supportedPlayerFeatures={}}return _createClass(e,[{key:"supportsVideoPlayerType",value:function(e){return!!this.supportedVideoPlayers[e]}},{key:"supportsVideoPlayerFeature",value:function(e){return!!this.supportedPlayerFeatures[e]}}]),e}(),a=function(o){function a(o){var s,u;_classCallCheck(this,a),_get(Object.getPrototypeOf(a.prototype),"constructor",this).call(this);var c=n.supportsDesktopVideoContainer();this.supportedVideoPlayers=(s={},_defineProperty(s,e.FLASH_VPAID_DIRECT_EMBED,n.embedVPAIDDirectly(o)&&i.containsFlashVPAID(o.mediaFiles)&&c),_defineProperty(s,e.HTML5,n.inarticleHtml5Player&&c&&i.containsMP4(o.mediaFiles)),_defineProperty(s,e.FLASH_VPAID_SANDBOX,r.supportsFlash()&&c&&i.containsFlashVPAID(o.mediaFiles)),_defineProperty(s,e.DINK,!1),_defineProperty(s,e.ALCHEMY,n.alchemyPlayer&&n.isAlchemyPlayerCreative(o)&&i.containsMP4(o.mediaFiles)),s),this.supportedPlayerFeatures=(u={},_defineProperty(u,t.LOOP,!1),_defineProperty(u,t.CLICK_THROUGH,!0),u)}return _inherits(a,o),a}(o),s=function(r){function o(r){var a;_classCallCheck(this,o),_get(Object.getPrototypeOf(o.prototype),"constructor",this).call(this);var s=n.supportsDesktopVideoContainer(),u=n.embedVPAIDDirectly(r)&&i.containsFlashVPAID(r.mediaFiles)&&s;this.supportedVideoPlayers[e.FLASH_VPAID_DIRECT_EMBED]=u,this.supportedVideoPlayers[e.HTML5]=s&&i.containsMP4(r.mediaFiles),this.supportedVideoPlayers[e.FLASH_VPAID_SANDBOX]=n.supportsVPAID(r)&&i.containsFlashVPAID(r.mediaFiles),this.supportedVideoPlayers[e.DINK]=!s&&i.containsMP4(r.mediaFiles),this.supportedVideoPlayers[e.ALCHEMY]=!1,this.supportedPlayerFeatures=(a={},_defineProperty(a,t.LOOP,!0),_defineProperty(a,t.CLICK_THROUGH,!1),a)}return _inherits(o,r),o}(o);return{InArticleCapabilities:a,InFeedCapabilities:s}}),define("videoPlayers/inFeedVideo",["jquery","videoPlayers/dinkPlayer","tracking","util/stopwatch","util/enable","util/eventBus","util/global","util/trackingEvent","videoPlayers/videoPlayerFactory","videoPlayers/videoPlayerDirector","adFormats/adFormatCapabilities"],function(e,t,n,r,i,o,a,s,u,c,l){function d(e,t){function i(){s(),o.dispatchEvent({type:"player.setupcomplete",target:p})}function a(){r.start("infeed_vid_load"),p.dispatcher.removeEventListener("loadstart",a)}function s(){var e;r.stop("infeed_vid_load"),e=r.getTime("infeed_vid_load"),n.trackSplunk("infeed_vid_load",{tsr:e})}function d(){n.trackSplunk("infeedvid_complete"),p.dispatcher.removeEventListener("loop",d)}var p,f=new l.InFeedCapabilities(t);return p=u.createPlayer(e,t.mediaFiles,f),c.direct(p),p.dispatcher.addEventListener("loadstart",a),p.dispatcher.one("setupcomplete",i),p.dispatcher.addEventListener("loop",d),p}return{createPlayer:d}}),define("util/layout/letterbox",["jquery","util/publisherWindow"],function(e,t){function n(n,i){function o(){var e=i.outerWidth(),t=i.outerHeight(),o=e/r.horizontal,a=r.vertical*o,s=Math.round((t-a)/2);n.setImportantStyle({"border-width":s+"px 0px",width:e+"px",height:t+"px"})}n.setImportantStyle({border:"0px solid #000000","box-sizing":"border-box"}),o(),e(t).on("resize",o)}var r={horizontal:16,vertical:9};return{letterbox:n}}),define("util/elementWatcher",["jquery","util/eventDispatcher"],function(e,t){function n(e){this.elementToWatch=e.elementToWatch,this.dispatcher=new t(this),this.position=this.getPosition(this.elementToWatch),this.size=this.getSize(this.elementToWatch),this._boundCallback=this.checkIfElementChanges.bind(this),this._pollId=setInterval(this._boundCallback,100)}return n.prototype.destroy=function(){clearInterval(this._pollId),this._pollId=void 0},n.prototype.comparePositions=function(e,t){return e.top===t.top&&e.left===t.left},n.prototype.compareSize=function(e,t){return e.height===t.height&&e.width===t.width},n.prototype.checkSizeChange=function(){var e=this.getSize(this.elementToWatch);this.compareSize(this.size,e)||(this.size=e,this.dispatcher.dispatchEvent({type:"sizeChanged",target:this}))},n.prototype.checkIfElementChanges=function(){this.checkPositionChange(),this.checkSizeChange()},n.prototype.checkPositionChange=function(){var e=this.getPosition(this.elementToWatch);this.comparePositions(this.position,e)||(this.position=e,this.dispatcher.dispatchEvent({type:"positionChanged",target:this}))},n.prototype.getSize=function(e){return{width:e.width(),height:e.height()}},n.prototype.getPosition=function(e){var t=e.offset();return{top:t.top,left:t.left}},n}),define("util/positionUtil",[],function(){function e(e,t,n){var r=e.offset(),i={top:r.top,left:r.left+e.outerWidth()};return t&&(i.left-=t.width()),n&&(i.top+=e.outerHeight()*n/100,i.left-=e.outerWidth()*n/100),i}function t(e,t,n){var r=e.offset(),i={top:r.top,left:r.left};return n&&(i.top+=e.outerHeight()*n/100,i.left+=e.outerWidth()*n/100),i}function n(e,t,n){var r=e.offset(),i={top:r.top+e.outerHeight(),left:r.left+e.outerWidth()};return t&&(i.top-=t.height(),i.left-=t.width()),n&&(i.top-=e.outerHeight()*n/100,i.left-=e.outerWidth()*n/100),i}function r(e,t,n){var r=e.offset(),i={top:r.top+e.outerHeight(),left:r.left};return t&&(i.top-=t.height()),n&&(i.top-=e.outerHeight()*n/100,i.left+=e.outerWidth()*n/100),i}return{topRight:e,topLeft:t,bottomLeft:r,bottomRight:n}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("adIconHandler",["jquery","util/elementWatcher","tracking","util/trackingEvent","util/positionUtil","util/browser","util/enable"],function(e,t,n,r,i,o,a){var s=function(){function s(e){_classCallCheck(this,s),this.elementWatcher=new t({elementToWatch:e.elementToWatch}),this.icons=[{onClickCallback:function(){n.trackActivate(r.PRIVACY_POLICY),o.openWindow("http://video.unrulymedia.com/rtbprivacypolicy/index.html")},className:"unruly_native_optout_icon",position:"topRight",scaling:!1,imageDimensions:{standard:[19,19]},imgDataUri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzE5MTkyMDQ3QzlFMTFFNEI4M0Q4NDVDMjhCMDZDRTQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzE5MTkyMDM3QzlFMTFFNEI4M0Q4NDVDMjhCMDZDRTQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjUzMkYyQzJEQjBFRDExRTJBMjNDRjBENEFCMzNGREQ1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjUzMkYyQzJFQjBFRDExRTJBMjNDRjBENEFCMzNGREQ1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/ILl8AAAAl5JREFUeNqsVM+LUlEY9Rfjw0lRnGmEmBiyTRs37SIScaGgLkZcqP9B/gsiIuJqtm6kbDEb0RgZFJztRNkuUCES0kKHJ8kUlaU+JbTvDPfGTZTZzIXDve+755z33e/+UKvWt3uEB4R9wg7BSPhF+ELoEz4SPq+K1Cvfu4THhEcEk2pzGxHeEt4QLtcRDghPCTm9Xv8sk8m8arVa8ng8VpbU0OMbccyDx/gHqjUZXRk5nc7SYDD4vmRtOp3OhsPhT/Q8hnnwBMNd0eyQG3FRs9m8CIVCpxqNJmc0Gp+nUqnzaDRaQZz/RDA8FIt9hNR5RsVisQETRsx5vd6TxWKxdLvdLxHHPM+QLfmI+ah8EKAWPCPRiMNqtb7gY8zzDKFjcZ+GOwYCATv6dDr9jrL4t36Px2ONx+P3/X7/bR7DPHiiDhsBs22M7Hb7jqIo83K5PBSLScvQJJPJJzabTRLj4IEPHQvNYKbHyGAw6EejkSJmhSbLsqLT6bSFQkEW4+CBDx0L6WCmYDSZTGYmk0mievxnFg6H73Y6nct+v6+IcfDAh46FtqCcYtTtdr9KkrQVDAb3RJHL5dqv1+sXqwcTPPChY6FvMOtiVK1Wr/pEIvGQZ0fnS+twOO7UajWZztyemBV4oo7aj7XnrFQqNbH9Pp/vBN+VSuU9FfqYHwvMbzpnG29AJBKpxGKxM7PZnIcJbsR1N+DG7qaWmU0IKKSx1+uZs9nsB8rkN2Wks1gsBuq35/P5n3a7Pczn8w0q/msqPDauQTgjDG78PVNf89JaCLfYCsZsx6bspf20KvorwADLaKBWBKZQ9wAAAABJRU5ErkJggg==",isEnabled:function(){return a.audienceTargeting}}],this.config=e}return _createClass(s,[{key:"initIcons",value:function(){var e=this;this.icons.filter(function(e){return e.isEnabled()}).forEach(function(t){e.createIcon(e.elementWatcher,e.config.elementToWatch,t)})}},{key:"destroyIcons",value:function(){this.elementWatcher.destroy(),this.icons.forEach(function(t){e("."+t.className).hide()})}},{key:"setIconSize",value:function(e,t){e.setImportantStyle({width:t[0]+"px",height:t[1]+"px"})}},{key:"createIcon",value:function(t,n,r){function o(){var e,t=n.width();u=r.scaling&&t>l?"large":r.scaling&&t>c?"medium":"standard",e=i[r.position](n,a,r.percentageOffset),a.setImportantStyle({position:"absolute",left:e.left+"px",top:e.top+"px",width:r.imageDimensions[u][0]+"px",height:r.imageDimensions[u][1]+"px","min-width":"0","min-height":"0","max-width":"none","max-height":"none"})}var a=e('<img style="cursor:pointer;" src="'+r.imgDataUri+'">'),s=n.width(),u="standard",c=300,l=400;a.on("click",r.onClickCallback),a.addClass(r.className),r.scaling&&s>l?u="large":r.scaling&&s>c&&(u="medium"),this.setIconSize(a,r.imageDimensions[u]),e("body").append(a),t.dispatcher.addEventListener("positionChanged",o),t.dispatcher.addEventListener("sizeChanged",o)}}]),s}();return s}),define("util/elementStyleClone",["jquery","util/publisherWindow"],function(e,t){function n(e,n){var r,o={},a=0;if(!e)throw new Error("No DOMElement passed");if(r=t.getComputedStyle(e),0===r.length)throw new Error("DOMElement seems to not be attached to the DOM");for(n=n||i;a<r.length;a++){var s=r[a],u=r.getPropertyValue(s);n.indexOf(s)>=0&&(o[s]=u)}return o}function r(t){var n={};return e.each(t.attributes,function(){n[this.name]=this.value}),n}var i=["margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-collapse","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-right-color","border-right-style","border-right-width","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","width","height","min-width","min-height","box-sizing","float","overflow","vertical-align","position"];return{clone:n,cloneAttributes:r}}),define("util/nativeAdModificationUtil",["util/jqueryElementFactory"],function(e){function t(e,t){t&&t.forEach(function(t){-1!==t.selectors.indexOf(".unruly_native_placement")&&e.addClass(t.classNames.join(" ")),e.find(t.selectors.join(",")).addClass(t.classNames.join(" "))})}function n(e,t){t&&t.forEach(function(t){-1!==t.selectors.indexOf(".unruly_native_placement")&&e.attr(t.attributes),e.find(t.selectors.join(",")).attr(t.attributes)})}function r(t,n){n&&n.forEach(function(n){var r,i,o=n.selectors.join(","),a=n.classNames.join(" "),s="<"+n.tagName+">",u=n.location;i=e.create(s),i.addClass(a),i.attr(n.attributes||{}),"string"==typeof n.text&&n.text.length>0&&i.text(n.text),r=-1!==n.selectors.indexOf(".unruly_native_placement")?t:t.find(o),r[u](i)})}function i(e,t){t&&t.forEach(function(t){-1!==t.selectors.indexOf(".unruly_native_placement")&&e.setImportantStyle(t.css),e.find(t.selectors.join(",")).setImportantStyle(t.css)})}return{addClasses:t,addAttributes:n,addElements:r,addStyles:i}}),define("videoPlayers/inFeedVideoContainer",["jquery","util/enable","util/elementStyleClone","tracking","util/trackingEvent","unrulyAdCore/util/window","util/elementWatcher","util/nativeAdModificationUtil"],function(e,t,n,r,i,o,a,s){function u(e,t,n){n.on("click",e.clickEventHandler.bind(e,t,"thumbnail")),n.setImportantStyle({cursor:"pointer"})}function c(s,c,l,h,A){var v=e("<div>");f=v,t.skinAttributeCopyToVideoContainer&&v.attr(n.cloneAttributes(A)),v.addClass("unruly_native_html5_container"),u(h,c,v),e(A).replaceWith(v);var m,g=e(l.basePlacement.selector),y=l.thumbnail.selectors.join(", "),E=g.find(y),b=E[0];if(o&&o.unruly&&o.unruly["native"]&&(350130===o.unruly["native"].siteId||548193===o.unruly["native"].siteId));else try{d(b,v),p(s,l,v),t.siteSupportsResponsiveInFeedVideo&&(m=new a({elementToWatch:E}),m.dispatcher.addEventListener("sizeChanged",function(){d(b,v),p(s,l)}))}catch(w){r.trackActivate(i.error.ELEMENT_STYLE_CLONE_ERROR)}return v}function l(n,r,i,o){var a=i.thumbnail.selectors,s=n.find(a.join(","))[0];return f=t.useDinkContainer||t.supportsDesktopVideoContainer()?c(n,r,i,o,s):e(s),f[0]}function d(e,t){t.setImportantStyle(n.clone(e))}function p(e,t){var n;t.toAdd&&(n=t.toAdd.styles,s.addStyles(e,n))}var f;return{create:l,getPlayerContainer:function(){return f}}}),define("viewability/moat",["util/publisherWindow","util/eventBus","session/sessionInfo"],function(e,t,n){function r(e){function n(t){e.dispatchEvent({type:t,adVolume:0})}function r(e){u[e]||n(e),u[e]=!0}function i(e,t){for(o in e)e.hasOwnProperty(o)&&(a=e[o],t(o,a))}var o,a,s,u={},c=t.addEventListener.bind(t),l=t.removeEventListener.bind(t);s={"player.firstQuartile":n.bind(this,"AdVideoFirstQuartile"),"player.midpoint":n.bind(this,"AdVideoMidpoint"),"player.thirdQuartile":n.bind(this,"AdVideoThirdQuartile"),"player.pause":n.bind(this,"AdPaused"),"player.playing":function(){r("AdVideoStart"),n("AdPlaying")},"player.ended":function(){u.AdVideoComplete||i(s,l),r("AdVideoComplete")}},i(s,c)}var i="unrulymediajsv2134447588468";return{init:function(e){var t=e.campaignConfig,o=e.container,a=e.duration,s=e.videoUrl,u=t.aid,c=t.cid,l=t.crid,d=t.vid,p={level1:u,level2:c,level3:l,level4:d,slicer1:n.getSiteId(),slicer2:"In-Feed"},f=this._initMoatTracking(o,p,a,i,s);r(f)},_initMoatTracking:function(t,n,r,i,o){var a=e.location.protocol,s="https:"===a?"z":"js",u=e.document.createElement("script"),c=[],l={adData:{ids:n,duration:r,url:o},dispatchEvent:function(e){this.sendEvent?(c&&(c.push(e),e=c,c=!1),this.sendEvent(e)):c.push(e)}},d="_moatApi"+Math.floor(1e8*Math.random());return e[d]=l,u.type="text/javascript",t&&t.insertBefore(u,t.childNodes[0]||null),u.src=a+"//"+s+".moatads.com/"+i+"/moatvideo.js#"+d,l}}});var _get=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var c=Object.getPrototypeOf(i);if(null===c)return;e=c,t=o,n=a,r=!0,s=c=void 0}};define("trackableError",[],function(){var e=function(e){function t(e,n,r){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.message=e,this.type=n,this.errorParams=r}return _inherits(t,e),t}(Error);return{TrackableError:e}});var _slicedToArray=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();define("adFormats/inFeed/inFeedAd",["jquery","tracking","adEventHandler","util/trackingEvent","viewability/adViewabilityHandler","videoPlayers/inFeedVideo","util/enable","util/eventBus","util/layout/letterbox","actions/actionFactory","util/browser","util/publisherAdServerHelper","adIconHandler","videoPlayers/inFeedVideoContainer","viewability/moat","util/nativeAdModificationUtil","trackableError","q"],function(e,t,n,r,i,o,a,s,u,c,l,d,p,f,h,A,v,m){function g(e){var t=function(e,t,n){throw new z(e,t,n)};Q=e.config.format.inFeed,q=w(Q,t),q&&(y(q),E(q,Q.toRemove),b(q,Q),_(q,Q,t))}function y(e){e.find("[href]").removeAttr("href"),e.find("[onclick]").removeAttr("onclick")}function E(e,t){t.elements.forEach(function(t){e.find(t.selectors.join(",")).remove()}),t.classes.forEach(function(t){-1!==t.selectors.indexOf(".unruly_native_placement")&&e.removeClass(t.classNames.join(" ")),e.find(t.selectors.join(",")).removeClass(t.classNames.join(" "))}),t.attributes.forEach(function(t){-1!==t.selectors.indexOf(".unruly_native_placement")&&e.removeAttr(t.attributeNames.join(" ")),e.find(t.selectors.join(",")).removeAttr(t.attributeNames.join(" "))}),t.textNodes&&t.textNodes.forEach(function(t){e.find(t.selectors.join(",")).text("")})}function b(e,t){var n=t.toAdd;A.addClasses(e,n.classes),A.addAttributes(e,n.attributes),A.addElements(e,n.elements),A.addStyles(e,n.styles)}function w(t,n){return W=e(t.basePlacement.selector),0===W.length?void n("base placement not found",r.error.SKIN_SETUP_FAILED):(q=W.clone(),q.addClass("unruly_native_placement"),q)}function _(e,t,n){var i,o,a,s,u,c,l=["disclosureMessage","title","thumbnail"],d=["description"],p=["basePlacement","clickThroughs","toRemove","toAdd"],f=t.items||t;for(i in f)if(o=t[i],s=-1===l.indexOf(i),u=-1===d.indexOf(i),c="undefined"==typeof o||!o.selectors||o.selectors.length<1,-1===p.indexOf(i)){if(!s&&c)return void n(i+" not defined",r.error.SKIN_SETUP_FAILED);if(!s||!c){if(a=e.find(o.selectors.join(",")),u&&0===a.length)return void n(i+" not found",r.error.NO_MATCHING_PLACEMENT);a.addClass("unruly_native_"+i),G[i]=a}}}function C(e){var t=["title"];return-1!==t.indexOf(e)}function k(e,t){return{name:t.name,elements:e.find(t.config.selectors.join(","))}}function I(e,t,n){var i=Object.getOwnPropertyNames(t).map(function(e){return Object({name:e,config:t[e]})}),o=T(i,function(e){return C(e.name)}),a=_slicedToArray(o,2),s=a[0],u=a[1],c=T(s,F),l=_slicedToArray(c,2),d=l[0],p=l[1];if(p.length>0){var f=p[0].name+" clickthrough not defined";return void n(f,r.error.SKIN_SETUP_FAILED)}var h=function(e,t,n){return n[e]=t,n},A=u.filter(F).concat(d).map(function(t){return k(e,t)}),v=T(A,function(e){return e.elements&&e.elements.length>0}),m=_slicedToArray(v,2),g=m[0],y=m[1];return y.forEach(function(e){return n(e.name+" clickthrough not found",r.error.NO_MATCHING_PLACEMENT)}),y.length>0?void 0:g.reduce(function(e,t){return h(t.name,t.elements,e)},{})}function F(e){return e.config&&e.config.selectors&&e.config.selectors.length>0}function T(e,t){var n=[],r=[];return e.forEach(function(e){t(e)?n.push(e):r.push(e)}),[n,r]}function P(e){var t=m.defer(),r=t.resolve.bind(t),i=function(e,n,r){t.reject(new z(e,n,r))};D(e);var o=new n,a=I(q,Q.clickThroughs,i);return a&&S(e,o,i,function(t){o.setupClickListeners(q,a,t,i),o.populate(e,t.videoUrl,i),V(e),x(t,e,i,r)}),t.promise}function S(e,t,n,i){s.addEventListener("player.error",function(t,i){n(i.message,r.error.INFEED_VIDEO_SETUP_FAILED,{src:i.src,apid:e.apid})});try{var o=B(Q,e,t);i(o)}catch(a){
n(a.message,r.error.INFEED_VIDEO_SETUP_FAILED,{apid:e.apid})}}function x(t,n,i,o){function u(){q.hide(),H&&H.destroyIcons()}function c(){u(),i("VPAID Creative resulted in AdError",r.error.INFEED_VIDEO_SETUP_FAILED,{apid:n.apid})}function l(){u()}t.dispatcher.one("setupcomplete",function(){d.shrinkAdServerIFrame(),Q.adInsertion&&Q.adInsertion.mode&&Q.adInsertion.selector?e(Q.adInsertion.selector)[Q.adInsertion.mode](q):W.after(q),a.moatViewabilityTracking(n)&&h.init({container:f.getPlayerContainer()[0],duration:t.getDuration(),campaignConfig:n,videoUrl:t.videoUrl}),s.dispatchEvent("placement.addedtodom")}),t.dispatcher.one("AdError",c),t.dispatcher.one("AdStopped",u),t.dispatcher.one("adstoptimeout",u),t.dispatcher.one("adimpression",function(){t.dispatcher.removeEventListener("AdError",c),t.dispatcher.addEventListener("AdError",l),o()}),t.load({adParameters:n.adParameters})}function D(e){var t,n,r;for(r in G)t=G[r],n=e.items[r],R(t,n);a.letterboxInFeedVideo&&L()}function R(e,t){if(t.attributes)for(var n in t.attributes)e.attr(n,t.attributes[n]);"undefined"!=typeof t.text&&e.text(t.text)}function L(){var e=W.find(Q.thumbnail.selectors.join(","));u.letterbox(G.thumbnail,e)}function O(){t.trackThirdParty(r.PAUSE),t.trackActivate(r.PP_PAUSE)}function M(){t.trackThirdParty(r.RESUME),t.trackActivate(r.PP_RESUME)}function B(n,i,u){var c,d,p=O,h=M,A=function(){O=p,M=h},v=function(){};return c=f.create(q,i,n,u),d=o.createPlayer(c,i),j(3e3,r.INFEED_VIDEO_VIEW,e(c)),d.dispatcher.one("setupcomplete",function(){var t="expandedvideo.open",n="expandedvideo.close",r=a.mobileSharingLightbox&&l.isMobile();r&&(n="sharinglightbox.close"),s.addEventListener(t,function(){O=v,M=v,d.pause()}),s.addEventListener(n,function(){M=A,d.play()}),N(e(c))}),d.dispatcher.addEventListener("AdLog",function(e,n){n&&n.data&&(n.data=JSON.stringify(n.data)),n&&n.message&&(n.message=JSON.stringify(n.message)),t.trackActivate("ad_log",n)}),d.dispatcher.addEventListener("AdError",function(e,n){n=n||{},n.data&&(n.data=JSON.stringify(n.data)),n.message&&(n.message=JSON.stringify(n.message)),i&&i.apid&&(n.apid=i.apid),t.trackActivate(r.error.AD_ERROR,n)}),d.dispatcher.addEventListener("AdClickThru",function(){t.trackThirdParty(r.VIDEO_CLICK)}),s.addEventListener("expandedvideo.close",function(){s.dispatchEvent("mute")}),s.addEventListener("expandedvideo.open",function(){s.dispatchEvent("unmute")}),s.addEventListener("unmute",function(){t.trackThirdParty(r.UNMUTE),t.trackActivate(r.UNMUTE)}),s.addEventListener("mute",function(){t.trackThirdParty(r.MUTE),t.trackActivate(r.MUTE)}),s.addEventListener("player.pause",function(){O()}),s.addEventListener("player.resume",function(){M()}),d}function j(e,n,r){var o={elementToWatch:r,viewableTimeout:e,viewablePercentage:.5};i.init(o),s.addEventListener("viewability.in_feed_video_view",function(){t.trackThirdParty(n)})}function N(e){a.inFeedVideoIcons&&(H=new p({elementToWatch:e}),H.initIcons())}function V(e){var t;t=c.createExpandedVideoCloseAction(e),t.init(),s.addEventListener("expandedvideo.close",t.trigger.bind(t))}function U(){return a.reportSize?{width:G.thumbnail.width(),height:G.thumbnail.height()}:null}var Q,W,q,H,G={},z=v.TrackableError;return{createAd:g,populate:P,_fetchClickthroughElements:I,getPotentialVideoSize:U,_setNativeAd:function(e){q=e}}}),define("util/collections",[],function(){return{forOwnProperty:function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n)}}}),define("util/events",["util/collections"],function(e){return{map:function(t,n,r){e.forOwnProperty(r,function(e){t.addEventListener(e,function(){return n.dispatchEvent(r[e])})})}}}),define("util/layout/proportional",[],function(){return{initContainer:function(e,t){e.setImportantStyle({position:"relative","padding-bottom":1/t*100+"%",height:0})},initElement:function(e){e.setImportantStyle({width:"100%",height:"100%",position:"absolute",top:0,left:0})}}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("adFormats/inArticle/inArticleTopBar",["util/dom/jqueryReset","util/eventBus"],function(e,t){function n(){var n=e.createAndReset('<img class="unruly_ia_closebutton">');return n.attr("src","//cloud-video.unrulymedia.com/native/in-art-countdown-icon-128x128x3s.gif?d="+(new Date).getTime()+1e6*Math.random()),n.setImportantStyle({height:"18px",width:"18px","float":"right",opacity:.25,transition:"all 0.25s cubic-bezier(0.445, 0.05, 0.55, 0.95)",margin:"1px 0",outline:"1px solid transparent","min-width":"0"}),t.addEventListener("inarticle.mouseenter",function(){return n.setImportantStyle({opacity:"unset"})}),t.addEventListener("inarticle.mouseleave",function(){return n.setImportantStyle({opacity:.25})}),n}var r=function(){function t(){_classCallCheck(this,t),this.canClose=!1;var r=e.createAndReset('<div class="unruly_ia_furniture"></div>');this.closeButton=n(),r.append(this.closeButton);var i=e.createAndReset('<div class="unruly_ia_disclosure">');i.html("&ndash;&ndash; ADVERTISEMENT &ndash;&ndash;"),i.setImportantStyle({"font-family":"sans-serif","font-size":"10px","text-align":"center",opacity:.5,margin:"0 18px","padding-top":"2px"}),r.setImportantStyle({height:"22px"}),r.append(i),this.topBar=r[0]}return _createClass(t,[{key:"attachTo",value:function(e){e.append(this.topBar)}},{key:"onCloseClick",value:function(e){var t=this;this.closeButton.click(function(){t.canClose&&e()})}},{key:"allowToClose",value:function(){this.canClose=!0,this.closeButton.setImportantStyle({cursor:"pointer"})}}]),t}();return r});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("adFormats/inArticle/inArticleVolumeButton",["util/dom/jqueryReset","util/eventBus","tracking","util/trackingEvent"],function(e,t,n,r){var i=function(){function i(n){var r=this;_classCallCheck(this,i),this.muted=!0,this.volumeImg=e.createAndReset('<img class="unruly_ia_volume"/>'),this.volumeImg.attr("src","//video.unrulymedia.com/native/in-art-soundanimation-icon-41x48.gif"),this.volumeImg.setImportantStyle({height:"18px",width:"18px","float":"right",cursor:"pointer",opacity:.25,transition:"all 0.25s cubic-bezier(0.445, 0.05, 0.55, 0.95)","margin-top":"1px",outline:"1px solid transparent","min-width":"0"}),t.addEventListener("inarticle.mouseenter",function(){return r.volumeImg.setImportantStyle({opacity:"unset"})}),t.addEventListener("inarticle.mouseleave",function(){return r.volumeImg.setImportantStyle({opacity:.25})}),this.volumeImg.click(function(){r.volumeImg.attr("src",r.chooseImageUrl()),r.toggleSound(n),r.muted=!r.muted}),this.preloadSoundOnImage()}return _createClass(i,[{key:"toggleSound",value:function(e){this.muted?(e.unmute(),n.trackActivate(r.UNMUTE)):(e.mute(),n.trackActivate(r.MUTE))}},{key:"preloadSoundOnImage",value:function(){var e=new Image;e.onload=function(){},e.src=this.chooseImageUrl()}},{key:"chooseImageUrl",value:function(){var e=this.muted?"on":"off";return"//video.unrulymedia.com/native/in-art-sound"+e+"-icon-128x128.png"}},{key:"attachTo",value:function(e){e.append(this.volumeImg)}}]),i}();return i});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("adFormats/inArticle/inArticleBottomBar",["util/dom/jqueryReset","adFormats/inArticle/inArticleVolumeButton"],function(e,t){var n=function(){function n(r){_classCallCheck(this,n),this.player=r;var i=e.createAndReset('<div class="unruly_ia_bottombar"></div>'),o=e.createAndReset('<div class="unruly_ia_progressbar"></div>');o.setImportantStyle({height:"2px",width:0,"background-color":"#0bbbef",transition:"all 0.1s linear"}),i.append(o),this.progressBar=o,this.bottomBar=i[0],i.setImportantStyle({height:"20px"}),new t(r).attachTo(i)}return _createClass(n,[{key:"attachTo",value:function(e){e.append(this.bottomBar)}},{key:"populate",value:function(){var e=this,t=function(t,n){var r=n.percentComplete;100>=r&&e.progressBar.setImportantStyle({width:r+"%"})};this.player.player.dispatcher.addEventListener("videoProgress",t)}}]),n}();return n});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("adFormats/inArticle/inArticleAdSpace",["util/dom/jqueryReset","util/layout/proportional","viewability/viewability","videoPlayers/flashVPAIDPlayer","util/eventBus","util/publisherAdServerHelper","videoPlayers/videoPlayerDirector","adFormats/adFormatCapabilities","videoPlayers/videoPlayerFactory","adEventHandler"],function(e,t,n,r,i,o,a,s,u,c){var l=function(){function n(r){_classCallCheck(this,n),this.videoContainer=e.createAndReset('<div class="unruly_in_article_video_content_container">'),t.initElement(this.videoContainer),this.options=r||{}}return _createClass(n,[{key:"populate",value:function(e){var t=this;this.videoContainer.setImportantStyle({"background-color":"transparent"});var n=new c,r=new s.InArticleCapabilities(e),l=u.createPlayer(this.videoContainer[0],e.mediaFiles,r),d={thumbnail:this.videoContainer};a.direct(l),l.dispatcher.one("setupcomplete",function(){o.shrinkAdServerIFrame(),i.dispatchEvent("placement.addedtodom"),n.setupClickListeners(l.container,d,l,function(){}),n.populate(e,l.videoUrl,function(){})}),this.options.onFinished&&!function(){var e=!1;["AdError","AdStopped","adstoptimeout","ended","error"].forEach(function(n){return l.dispatcher.addEventListener(n,function(){e||t.options.onFinished(n),e=!0})})}(),l.load({adParameters:e.adParameters}),this.player=l}},{key:"mute",value:function(){this.player.mute()}},{key:"unmute",value:function(){this.player.unmute()}}]),n}();return{InArticleAdSpace:l}});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();define("adFormats/inArticle/inArticleAd",["viewability/viewability","util/eventDispatcher","util/events","tracking","util/elementStyleReset","util/publisherWindow","util/jqueryElementFactory","util/layout/proportional","adFormats/inArticle/inArticleTopBar","adFormats/inArticle/inArticleBottomBar","util/enable","util/eventBus","util/trackingEvent","adFormats/inArticle/inArticleAdSpace","trackableError","util/browser"],function(e,t,n,r,i,o,a,s,u,c,l,d,p,f,h,A){function v(e){return function(){return setTimeout(e,3e3)}}function m(){E=a.create('<div class="unruly_in_article_placement">'),b=a.create('<div class="unruly_in_article_video_container">'),b.setImportantStyle({"background-color":"transparent"}),i.resetStyles(E),i.resetStyles(b),s.initContainer(b,y),E.setImportantStyle({transition:"all 0.5s cubic-bezier(0.445, 0.05, 0.55, 0.95) 0.2s",overflow:"hidden"}),E.setImportantStyle({"max-height":"1px"}),E.mouseenter(function(){return d.dispatchEvent("inarticle.mouseenter")}),E.mouseleave(function(){return d.dispatchEvent("inarticle.mouseleave")})}var g=new t({}),y=16/9,E=void 0,b=void 0,w=function(){function t(e){if(_classCallCheck(this,t),this.basePlacementSelector=e.basePlacement.selector,this.basePlacement=a.create(this.basePlacementSelector),1!==this.basePlacement.length)throw new h.TrackableError("Cannot find base placement: "+e.basePlacement.selector,p.error.NO_MATCHING_PLACEMENT);this.checkThatDeviceIsSupported(),m(),this.topBar=new u,this.topBar.attachTo(E),this.topBar.onCloseClick(this.collapse),this.videoAdSpace=new f.InArticleAdSpace({onFinished:this.collapse}),b.append(this.videoAdSpace.videoContainer),E.append(b),this.bottomBar=new c(this.videoAdSpace),this.bottomBar.attachTo(E)}return _createClass(t,[{key:"checkThatDeviceIsSupported",value:function(){if(A.isMobile()&&!l.alchemyPlayer)throw new h.TrackableError("Mobile not supported on InArticle Format",p.error.UNSUPPORTED_BROWSER);var e=this.getPotentialVideoSize(),t=e.width,n=e.height;if(A.isFlashBlocked(t,n)){var r={width:t,height:n};throw new h.TrackableError("Browser not supported on InArticle Format",p.error.UNSUPPORTED_BROWSER,r)}}},{key:"populate",value:function(t){var r=this;if(A.isMobile()&&!l.isAlchemyPlayerCreative(t))throw new h.TrackableError("Mobile not supported on InArticle Format",p.error.UNSUPPORTED_BROWSER);this.basePlacement.append(E);var i=new e.Viewability({elementToWatch:E,viewablePercentage:.25});n.map(i.dispatcher,g,{inview:"expanded"}),o.addEventListener("message",function(e){var t=["unruly-complete","unruly-aderror"];t.indexOf(e.data)>-1&&r.collapse(e.data)}),this.onExpanded(function(){return r.videoAdSpace.populate(t)}),this.onExpanded(this.expand),this.onExpanded(v(function(){return r.topBar.allowToClose()})),this.onExpanded(function(){return r.bottomBar.populate()})}},{key:"onExpanded",value:function(e){g.one("expanded",e)}},{key:"collapse",value:function(e){E.setImportantStyle({"max-height":0,"margin-top":0}),r.trackActivate("ia_collapsed",{collapseReason:e}),o.setTimeout(function(){return E.remove()},1e3)}},{key:"expand",value:function(){var e=E.width()/y+50;E.setImportantStyle({"max-height":e+"px","margin-top":"16px"}),r.trackActivate("ia_expanded")}},{key:"getInArticleContainer",value:function(){return E}},{key:"getPotentialVideoSize",value:function(){var e=this.basePlacement.width(),t=Math.floor(e/y);return{width:e,height:t}}}]),t}();return{InArticleAd:w}}),define("adFormats/adFactory",["adFormats/inFeed/inFeedAd","adFormats/inArticle/inArticleAd"],function(e,t){return{createAd:function(n){return n&&n.config&&n.config.format&&n.config.format.inArticle?new t.InArticleAd(n.config.format.inArticle):(e.createAd(n),e)}}}),define("fallbackManager",["unrulyAdCore/util/window","util/publisherApi","util/publisherWindow","tracking","util/trackingEvent"],function(e,t,n,r,i){function o(o){if(o&&t.hasDFPCallback(o)){var a=e.unruly["native"].placements[o].sourceWindow;n!==a&&(r.trackActivate(i.publisher_marker.FALLBACK,{placementId:o}),a.doAddFallback())}}function a(t,n){if(!t||"object"!=typeof n)throw{message:"You must pass placementId and placementConfig",errorType:"ArgumentError"};e.unruly["native"].placements=e.unruly["native"].placements||{},e.unruly["native"].placements[t]=n}function s(){e.unruly["native"].registerPlacement=a}return{executeFallbackWithPlacementId:o,registerPlacement:a,register:s}}),define("vast-parser/util/window",[],function(){return window}),define("vast-parser/xml-parser",["./util/window"],function(e){function t(e){return e.nodeType===o.TEXT||e.nodeType===o.CDATA}function n(e){return e.nodeType===o.ELEMENT&&!e.prefix}function r(e){if("undefined"==typeof e)return this;if(e.hasChildNodes()){var i,o,a,s,u="";for(s=0;s<e.childNodes.length;s++)i=e.childNodes.item(s),t(i)?u+=i.nodeValue.trim():n(i)&&(o=i.nodeName,a=new r(i),this.hasOwnProperty(o)?(this[o].constructor!==Array&&(this[o]=[this[o]]),this[o].push(a)):this[o]=a);u&&(this.nodeValue=u.trim())}if(e.hasAttributes&&e.hasAttributes()){var c,l;for(l=0;l<e.attributes.length;l++)c=e.attributes.item(l),this["@"+c.name]=c.value.trim()}}var i=i||{},o={ELEMENT:i.ELEMENT_NODE||1,TEXT:i.TEXT_NODE||3,CDATA:i.CDATA_SECTION_NODE||4};return{parse:function(t){var n;return t.xml&&(n=new e.DOMParser,t=n.parseFromString(t.xml,"text/xml")),new r(t)}}}),define("vast-parser/vast-parser",["./xml-parser"],function(e){function t(e){var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function n(e){return void 0===e||"object"==typeof e&&t(e)||null===e||"number"==typeof e&&0!==e&&!e?[]:Array.isArray(e)?e:[e]}function r(e){return e.Creatives&&(e.Creatives.Creative=n(e.Creatives.Creative)),e.Extensions&&(e.Extensions.Extension=n(e.Extensions.Extension)),e.Impression=n(e.Impression),e}function i(e,t){"use strict";if(void 0===e||null===e)throw new TypeError;var n=Object(e),r=n.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i=[],o=arguments.length>=3?arguments[2]:void 0,a=0;r>a;a++)if(a in n){var s=n[a];t.call(o,s,a,n)&&i.push(s)}return i}function o(e,t){for(var n=0;n<e.length;n+=1)t(e[n])}function a(e){var t=e.Creatives.Creative,r=i(t,function(e){return e.NonLinearAds&&e.NonLinearAds.NonLinear},t),a=i(t,function(e){return e.Linear},t);return o(r,function(e){e.NonLinearAds.NonLinear.NonLinearClickTracking=n(e.NonLinearAds.NonLinear.NonLinearClickTracking)}),o(a,function(e){e.Linear.MediaFiles&&(e.Linear.MediaFiles.MediaFile=n(e.Linear.MediaFiles.MediaFile))}),e}function s(t){var n=e.parse(t);return n.VAST&&!n.VAST.Error&&n.VAST.Ad?(n.VAST.Ad.Wrapper?(n.VAST.Ad.Wrapper=r(n.VAST.Ad.Wrapper),n.VAST.Ad.Wrapper.Creatives&&(n.VAST.Ad.Wrapper=a(n.VAST.Ad.Wrapper))):n.VAST.Ad.InLine&&(n.VAST.Ad.InLine=r(n.VAST.Ad.InLine),n.VAST.Ad.InLine=a(n.VAST.Ad.InLine)),n):n}return{parse:s}}),define("vast-parser",["vast-parser/vast-parser"],function(e){return e}),define("vast-parser/vastErrorCodes",[],function(){return{XML_PARSE_ERROR:{code:100,message:"XML parsing error."},VAST_SCHEMA_ERROR:{code:101,message:"VAST schema validation error."},GENERAL_WRAPPER_ERROR:{code:300,message:"General Wrapper error."},WRAPPER_URI_TIMEOUT:{code:301,message:"Timeout of VAST URI provided in Wrapper element, or of VAST URI provided in a subsequent Wrapper element. (URI was either unavailable or reached a timeout as defined by the video player.)"},NO_ADS:{code:303,message:"No Ads VAST response after one or more Wrappers."},NO_AD_AT_URI:{code:401,message:"File not found. Unable to find Linear/MediaFile from URI."}}}),define("vast-parser/util/objectUtil",[],function(){function e(e,n,r){var i=t(e,n,r);return i=parseInt(i,10),isNaN(i)?r:i}function t(e,t,r){var o=n(e,t);return i(o[0])?o[0]:r}function n(e,t){var r,a,s,u=t.split("."),c=[];if(e instanceof Array)return o(e.map(function(e){return n(e,t)}));if(e=e||c,1===u.length){var l=e[t];return i(l)?(l instanceof Array||(l=[l]),l):c}return r=u[0],a=u.slice(1).join("."),s=e[r],i(s)?n(s,a):c}function r(e){return e?e.nodeValue:void 0}function i(e){return"undefined"!=typeof e&&null!==e}function o(e){return[].concat.apply([],e)}return{getArrayFromObjectPath:n,getIntegerFromObjectPath:e,getFromObjectPath:t,pluckNodeValue:r,isDefined:i,flatten:o}}),define("vast-parser/vastError",["./vastErrorCodes","./util/objectUtil"],function(e,t){function n(t){var n,r;for(n in e)if(e.hasOwnProperty(n)&&(r=e[n],r.code===t))return r.message;return"Unknown error code"}function r(e){var t,n=[];return e&&(t=o(e,"wrappers").map(function(e){return[].concat(o(e,"VAST.Error")).concat(o(e,"VAST.Ad.Wrapper.Error"))}),n=u(t).concat(o(e,"inline.VAST.Error")).concat(o(e,"inline.VAST.Ad.InLine.Error")).map(a).filter(s)),n}function i(e,t,i){this.name="VastError",this.code=e,this.message="VAST Error: ["+e+"] - "+(i||n(e)),this.stack=(new Error).stack,this.errorURIs=r(t),this.vastResponse=t}var o=t.getArrayFromObjectPath,a=t.pluckNodeValue,s=t.isDefined,u=t.flatten;return i.prototype=new Error,i.prototype.constructor=i,i.prototype.getErrorURIs=function(){return this.errorURIs},i}),function(e,t){"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&"object"==typeof define.amd?define("vast-parser/../../node_modules/validator/validator",t):this[e]=t()}("validator",function(e){"use strict";function t(e,t){e=e||{};for(var n in t)"undefined"==typeof e[n]&&(e[n]=t[n]);return e}function n(e){var t="(\\"+e.symbol.replace(/\./g,"\\.")+")"+(e.require_symbol?"":"?"),n="-?",r="[1-9]\\d*",i="[1-9]\\d{0,2}(\\"+e.thousands_separator+"\\d{3})*",o=["0",r,i],a="("+o.join("|")+")?",s="(\\"+e.decimal_separator+"\\d{2})?",u=a+s;return e.allow_negatives&&!e.parens_for_negatives&&(e.negative_sign_after_digits?u+=n:e.negative_sign_before_digits&&(u=n+u)),e.allow_negative_sign_placeholder?u="( (?!\\-))?"+u:e.allow_space_after_symbol?u=" ?"+u:e.allow_space_after_digits&&(u+="( (?!$))?"),e.symbol_after_digits?u+=t:u=t+u,e.allow_negatives&&(e.parens_for_negatives?u="(\\("+u+"\\)|"+u+")":e.negative_sign_before_digits||e.negative_sign_after_digits||(u=n+u)),new RegExp("^(?!-? )(?=.*\\d)"+u+"$")}e={version:"3.33.0"};var r=/((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))/,i=/([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~\.]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~\.]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\s)*/,o=new RegExp("^"+r.source+"$","i"),a=new RegExp("^"+i.source+"<"+r.source+">$","i"),s=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,u=/^(?:[0-9]{9}X|[0-9]{10})$/,c=/^(?:[0-9]{13})$/,l=/^(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)$/,d=/^::|^::1|^([a-fA-F0-9]{1,4}::?){1,7}([a-fA-F0-9]{1,4})$/,p={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i},f=/^[a-zA-Z]+$/,h=/^[a-zA-Z0-9]+$/,A=/^[-+]?[0-9]+$/,v=/^(?:[-+]?(?:0|[1-9][0-9]*))$/,m=/^(?:[-+]?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/,g=/^[0-9a-fA-F]+$/,y=/^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,E=/^[\x00-\x7F]+$/,b=/[^\x00-\x7F]/,w=/[^\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,_=/[\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,C=/[\uD800-\uDBFF][\uDC00-\uDFFF]/,k=/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$/,I={"zh-CN":/^(\+?0?86\-?)?1[345789]\d{9}$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-HK":/^(\+?852\-?)?[569]\d{3}\-?\d{4}$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"pt-PT":/^(\+351)?9[1236]\d{7}$/,"el-GR":/^(\+30)?((2\d{9})|(69\d{8}))$/};e.extend=function(t,n){e[t]=function(){var t=Array.prototype.slice.call(arguments);return t[0]=e.toString(t[0]),n.apply(e,t)}},e.init=function(){for(var t in e)"function"==typeof e[t]&&"toString"!==t&&"toDate"!==t&&"extend"!==t&&"init"!==t&&e.extend(t,e[t])},e.toString=function(e){return"object"==typeof e&&null!==e&&e.toString?e=e.toString():null===e||"undefined"==typeof e||isNaN(e)&&!e.length?e="":"string"!=typeof e&&(e+=""),e},e.toDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)?e:(e=Date.parse(e),isNaN(e)?null:new Date(e))},e.toFloat=function(e){return parseFloat(e)},e.toInt=function(e,t){return parseInt(e,t||10)},e.toBoolean=function(e,t){return t?"1"===e||"true"===e:"0"!==e&&"false"!==e&&""!==e},e.equals=function(t,n){return t===e.toString(n)},e.contains=function(t,n){return t.indexOf(e.toString(n))>=0},e.matches=function(e,t,n){return"[object RegExp]"!==Object.prototype.toString.call(t)&&(t=new RegExp(t,n)),t.test(e)};var F={allow_display_name:!1};e.isEmail=function(e,n){return n=t(n,F),o.test(e)||n.allow_display_name===!0&&a.test(e)};var T={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1};e.isURL=function(n,r){if(!n||n.length>=2083)return!1;if(0===n.indexOf("mailto:"))return!1;r=t(r,T);var i,o,a,s,u,c,l,d,p,f,h,A;if(A=n.split("://"),A.length>1){if(i=A.shift(),-1===r.protocols.indexOf(i))return!1}else{if(r.require_protocol)return!1;r.allow_protocol_relative_urls&&"//"===n.substr(0,2)&&(A[0]=n.substr(2))}if(n=A.join("://"),A=n.split("#"),n=A.shift(),h=A.join("#"),h&&/\s/.test(h))return!1;if(A=n.split("?"),n=A.shift(),f=A.join("?"),f&&/\s/.test(f))return!1;if(A=n.split("/"),n=A.shift(),p=A.join("/"),p&&/\s/.test(p))return!1;if(A=n.split("@"),A.length>1&&(s=A.shift(),s.indexOf(":")>=0)){if(s=s.split(":"),o=s.shift(),!/^\S+$/.test(o))return!1;if(a=s.join(":"),!/^\S*$/.test(o))return!1}return c=A.join("@"),A=c.split(":"),u=A.shift(),A.length&&(d=A.join(":"),l=parseInt(d,10),!/^[0-9]+$/.test(d)||0>=l||l>65535)?!1:e.isIP(u)||e.isFQDN(u,r)||"localhost"===u?r.host_whitelist&&-1===r.host_whitelist.indexOf(u)?!1:r.host_blacklist&&-1!==r.host_blacklist.indexOf(u)?!1:!0:!1},e.isIP=function(t,n){if(n=e.toString(n),!n)return e.isIP(t,4)||e.isIP(t,6);if("4"===n){if(!l.test(t))return!1;var r=t.split(".").sort(function(e,t){return e-t});return r[3]<=255}return"6"===n&&d.test(t)};var P={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1};e.isFQDN=function(e,n){n=t(n,P),n.allow_trailing_dot&&"."===e[e.length-1]&&(e=e.substring(0,e.length-1));var r=e.split(".");if(n.require_tld){var i=r.pop();if(!r.length||!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(i))return!1}for(var o,a=0;a<r.length;a++){if(o=r[a],n.allow_underscores){if(o.indexOf("__")>=0)return!1;o=o.replace(/_/g,"")}if(!/^[a-z\u00a1-\uffff0-9-]+$/i.test(o))return!1;if("-"===o[0]||"-"===o[o.length-1]||o.indexOf("---")>=0)return!1}return!0},e.isAlpha=function(e){return f.test(e)},e.isAlphanumeric=function(e){return h.test(e)},e.isNumeric=function(e){return A.test(e)},e.isHexadecimal=function(e){return g.test(e)},e.isHexColor=function(e){return y.test(e)},e.isLowercase=function(e){return e===e.toLowerCase()},e.isUppercase=function(e){return e===e.toUpperCase()},e.isInt=function(e){return v.test(e)},e.isFloat=function(e){return""!==e&&m.test(e)},e.isDivisibleBy=function(t,n){return e.toFloat(t)%e.toInt(n)===0},e.isNull=function(e){return 0===e.length},e.isLength=function(e,t,n){var r=e.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g)||[],i=e.length-r.length;return i>=t&&("undefined"==typeof n||n>=i)},e.isByteLength=function(e,t,n){return e.length>=t&&("undefined"==typeof n||e.length<=n)},e.isUUID=function(e,t){var n=p[t?t:"all"];return n&&n.test(e)},e.isDate=function(e){return!isNaN(Date.parse(e))},e.isAfter=function(t,n){var r=e.toDate(n||new Date),i=e.toDate(t);return!!(i&&r&&i>r)},e.isBefore=function(t,n){var r=e.toDate(n||new Date),i=e.toDate(t);return i&&r&&r>i},e.isIn=function(t,n){var r;if("[object Array]"===Object.prototype.toString.call(n)){var i=[];for(r in n)i[r]=e.toString(n[r]);return i.indexOf(t)>=0}return"object"==typeof n?n.hasOwnProperty(t):n&&"function"==typeof n.indexOf?n.indexOf(t)>=0:!1},e.isCreditCard=function(e){var t=e.replace(/[^0-9]+/g,"");if(!s.test(t))return!1;for(var n,r,i,o=0,a=t.length-1;a>=0;a--)n=t.substring(a,a+1),r=parseInt(n,10),i?(r*=2,o+=r>=10?r%10+1:r):o+=r,i=!i;return!!(o%10===0?t:!1)},e.isISBN=function(t,n){if(n=e.toString(n),!n)return e.isISBN(t,10)||e.isISBN(t,13);var r,i=t.replace(/[\s-]+/g,""),o=0;if("10"===n){if(!u.test(i))return!1;for(r=0;9>r;r++)o+=(r+1)*i.charAt(r);if(o+="X"===i.charAt(9)?100:10*i.charAt(9),o%11===0)return!!i}else if("13"===n){if(!c.test(i))return!1;var a=[1,3];for(r=0;12>r;r++)o+=a[r%2]*i.charAt(r);if(i.charAt(12)-(10-o%10)%10===0)return!!i}return!1},e.isMobilePhone=function(e,t){return t in I?I[t].test(e):!1};var S={symbol:"$",require_symbol:!1,allow_space_after_symbol:!1,symbol_after_digits:!1,allow_negatives:!0,parens_for_negatives:!1,negative_sign_before_digits:!1,negative_sign_after_digits:!1,allow_negative_sign_placeholder:!1,thousands_separator:",",decimal_separator:".",allow_space_after_digits:!1};e.isCurrency=function(e,r){return r=t(r,S),n(r).test(e)},e.isJSON=function(e){try{JSON.parse(e)}catch(t){return!1}return!0},e.isMultibyte=function(e){return b.test(e)},e.isAscii=function(e){return E.test(e)},e.isFullWidth=function(e){return w.test(e)},e.isHalfWidth=function(e){return _.test(e)},e.isVariableWidth=function(e){return w.test(e)&&_.test(e)},e.isSurrogatePair=function(e){return C.test(e)},e.isBase64=function(e){return k.test(e)},e.isMongoId=function(t){return e.isHexadecimal(t)&&24===t.length},e.ltrim=function(e,t){var n=t?new RegExp("^["+t+"]+","g"):/^\s+/g;return e.replace(n,"")},e.rtrim=function(e,t){var n=t?new RegExp("["+t+"]+$","g"):/\s+$/g;return e.replace(n,"")},e.trim=function(e,t){var n=t?new RegExp("^["+t+"]+|["+t+"]+$","g"):/^\s+|\s+$/g;return e.replace(n,"")},e.escape=function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;")},e.stripLow=function(t,n){var r=n?"\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F":"\\x00-\\x1F\\x7F";return e.blacklist(t,r)},e.whitelist=function(e,t){return e.replace(new RegExp("[^"+t+"]+","g"),"")},e.blacklist=function(e,t){return e.replace(new RegExp("["+t+"]+","g"),"")};var x={lowercase:!0};return e.normalizeEmail=function(n,r){if(r=t(r,x),!e.isEmail(n))return!1;var i=n.split("@",2);if(i[1]=i[1].toLowerCase(),"gmail.com"===i[1]||"googlemail.com"===i[1]){if(i[0]=i[0].toLowerCase().replace(/\./g,""),"+"===i[0][0])return!1;i[0]=i[0].split("+")[0],i[1]="gmail.com"}else r.lowercase&&(i[0]=i[0].toLowerCase());return i.join("@")},e.init(),e}),define("vast-parser/util/helpers",["../../../node_modules/validator/validator"],function(e){function t(t){var n,r=0;if("string"==typeof t&&(n=t.split(":").filter(function(t,n){return e.isNumeric(t)||2===n&&e.isFloat(t)}),3===n.length))return n.forEach(function(e,t){r+=parseFloat(e,10)*Math.pow(60,2-t)}),r}function n(e){return e.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}function r(e){return 0===e.indexOf("https")?e:0===e.indexOf("http")?e.substr(5):e}return{getSecondsFromTimeString:t,decodeXML:n,convertProtocol:r,isURL:e.isURL}}),define("vast-parser/model/vastMediaFile",["../util/objectUtil","../util/helpers"],function(e,t){function n(n){this.url=t.convertProtocol(e.getFromObjectPath(n,"nodeValue")),this.apiFramework=e.getFromObjectPath(n,"@apiFramework"),this.type=e.getFromObjectPath(n,"@type"),this.width=e.getIntegerFromObjectPath(n,"@width"),this.height=e.getIntegerFromObjectPath(n,"@height"),this.delivery=e.getFromObjectPath(n,"@delivery"),this.bitrate=e.getIntegerFromObjectPath(n,"@bitrate")}return n.prototype.isMP4=function(){return"progressive"===this.delivery&&"video/mp4"===this.type},n.prototype.isFlashVPAID=function(){return"VPAID"===this.apiFramework&&"application/x-shockwave-flash"===this.type},n.prototype.isJavascriptVPAID=function(){return"VPAID"===this.apiFramework&&"application/javascript"===this.type},n}),define("vast-parser/model/vastLinearCreative",["../util/objectUtil","../util/helpers","../model/vastMediaFile"],function(e,t,n){function r(t){this.vastResponse=t,this.linearInline=e.getFromObjectPath(this.vastResponse,"inline.VAST.Ad.InLine.Creatives.Creative.Linear"),this.linearWrappers=e.getArrayFromObjectPath(this.vastResponse,"wrappers.VAST.Ad.Wrapper.Creatives.Creative.Linear")}return r.prototype.getDuration=function(){var n=e.getFromObjectPath(this.linearInline,"Duration.nodeValue");return t.getSecondsFromTimeString(n)},r.prototype.getClickTrackers=function(n){var r=e.getArrayFromObjectPath(this.linearWrappers,"VideoClicks.ClickTracking"),i=e.getArrayFromObjectPath(this.linearInline,"VideoClicks.ClickTracking"),o=i.concat(r);
return o.filter(function(e){return t.isURL(e.nodeValue,{allow_protocol_relative_urls:!0})}).filter(function(e){return"undefined"==typeof e["@id"]?!0:n?e["@id"]===n:!0}).map(function(e){return t.convertProtocol(e.nodeValue)})},r.prototype.getClickThrough=function(){return e.getFromObjectPath(this.linearInline,"VideoClicks.ClickThrough.nodeValue")},r.prototype.getTrackingEvents=function(n){function r(){return e.getArrayFromObjectPath(this.linearInline,"TrackingEvents.Tracking").concat(e.getArrayFromObjectPath(this.linearWrappers,"TrackingEvents.Tracking"))}return this.trackingEvents=this.trackingEvents||r.call(this),this.trackingEvents.filter(function(e){return e["@event"]===n&&t.isURL(e.nodeValue,{allow_protocol_relative_urls:!0})}).map(function(e){return t.convertProtocol(e.nodeValue)})},r.prototype.getAdParameters=function(){var n=e.getFromObjectPath(this.linearInline,"AdParameters.nodeValue"),r=e.getFromObjectPath(this.linearInline,"AdParameters.@xmlEncoded");return"true"===r&&"string"==typeof n&&(n=t.decodeXML(n)),n},r.prototype.getMediaFiles=function(t){var r=e.getArrayFromObjectPath(this.linearInline,"MediaFiles.MediaFile");return t=t||{},r=r.map(function(e){return new n(e)}),r=r.filter(function(e){var n,r=!0;for(n in t)t.hasOwnProperty(n)&&(r=r&&e[n]===t[n]);return r})},r.prototype.getFlashVPAIDMediaFiles=function(){return this.getMediaFiles({apiFramework:"VPAID",type:"application/x-shockwave-flash"})},r.prototype.getJavascriptVPAIDMediaFiles=function(){return this.getMediaFiles({apiFramework:"VPAID",type:"application/javascript"})},r.prototype.getMp4MediaFiles=function(){return this.getMediaFiles({type:"video/mp4",delivery:"progressive"})},r.prototype.hasFlashVPAID=function(){return this.getFlashVPAIDMediaFiles().length>0},r.prototype.hasJavascriptVPAID=function(){return this.getJavascriptVPAIDMediaFiles().length>0},r.prototype.hasMp4=function(){return this.getMp4MediaFiles().length>0},{VastLinearCreative:r}}),define("vast-parser/model/vastNonLinearCreative",["../util/objectUtil","../util/helpers"],function(e,t){function n(t){this.nonLinearInline=e.getFromObjectPath(t,"inline.VAST.Ad.InLine.Creatives.Creative.NonLinearAds")}return n.prototype.getStaticResource=function(){var n=e.getFromObjectPath(this.nonLinearInline,"NonLinear.StaticResource.nodeValue");return n?t.convertProtocol(n):void 0},{VastNonLinearCreative:n}}),define("vast-parser/model/vastExtension",["../util/objectUtil"],function(e){function t(e){this.extension=e}return t.prototype.getExtensionNodes=function(){return this.extension},t.prototype.getDetailsByPath=function(t){return e.getArrayFromObjectPath(this.extension,t)},t}),define("vast-parser/model/vastModelFactory",["./vastExtension"],function(e){return{createVastExtension:function(t){return new e(t)}}}),define("vast-parser/model/vastResponse",["../util/helpers","../util/objectUtil","./vastLinearCreative","./vastNonLinearCreative","./vastExtension","./vastModelFactory"],function(e,t,n,r,i,o){function a(e){this.wrappers=[],this.inline=void 0,this._raw=[],e&&(this.wrappers=e.wrappers,this.inline=e.inline),this._vastChain=e}function s(t){return e.isURL(t,{allow_protocol_relative_urls:!0})}return a.prototype.getImpressions=function(){var e=t.getArrayFromObjectPath(this.inline,"VAST.Ad.InLine.Impression.nodeValue"),n=t.getArrayFromObjectPath(this.wrappers,"VAST.Ad.Wrapper.Impression.nodeValue");return e.concat(n).filter(s)},a.prototype.getAdTitle=function(){return this.inline.VAST.Ad.InLine.AdTitle.nodeValue},a.prototype.getLinearCreative=function(){if(!this.linearCreative){var e=t.getFromObjectPath(this.inline,"VAST.Ad.InLine.Creatives.Creative.Linear");e&&(this.linearCreative=new n.VastLinearCreative(this))}return this.linearCreative},a.prototype.getNonLinearCreative=function(){if(!this.nonLinearCreative){var e=t.getFromObjectPath(this.inline,"VAST.Ad.InLine.Creatives.Creative.NonLinearAds");e&&(this.nonLinearCreative=new r.VastNonLinearCreative(this))}return this.nonLinearCreative},a.prototype.getRawResponses=function(){return this._raw},a.prototype.addRawResponse=function(e){this._raw.push(e)},a.prototype.getExtensions=function(){var e=t.getArrayFromObjectPath(this.inline,"VAST.Ad.InLine.Extensions.Extension"),n=t.getArrayFromObjectPath(this.wrappers,"VAST.Ad.Wrapper.Extensions.Extension"),r=e.concat(n);return r.map(function(e){return o.createVastExtension(e)})},a}),define("vast-parser/vastChainer",["jquery","./vast-parser","q","./vastErrorCodes","./vastError","./model/vastResponse","./util/helpers"],function(e,t,n,r,i,o,a){function s(e){var t=new o;return l(t,e)}function u(e,t){f.on(e,t)}function c(e){var t=window.document.createElement("a");return t.href=e,t.hostname}function l(o,s){var u,h,A=s.url,v=n.defer(),m=p++;return s.extraParams&&s.extraParams.length>0&&(A+=-1!==s.url.indexOf("?")?"&"+s.extraParams:"?"+s.extraParams),h={url:A,headers:s.headers||{},dataType:"xml"},s.corsCookieDomains instanceof Array&&-1!==s.corsCookieDomains.indexOf(c(A))&&(h.xhrFields={withCredentials:!0}),h.timeout=d,h.success=function(n,u,c){var d,p,h,g;return g=e.Event("requestEnd",{requestNumber:m,uri:A,vastResponse:o}),o.addRawResponse({requestNumber:m,uri:A,response:c.responseText,headers:c.getAllResponseHeaders().trim()}),n?(d=t.parse(n),d.VAST.Error?(f.trigger(g),void v.reject(new i(r.NO_ADS.code,o,"VAST request returned no ads and contains error tag"))):d.VAST.Ad?void(d.VAST&&d.VAST.Ad&&d.VAST.Ad.InLine?(o.inline=d,f.trigger(g),v.resolve(o)):(o.wrappers.push(d),f.trigger(g),p=d.VAST&&d.VAST.Ad&&d.VAST.Ad.Wrapper&&d.VAST.Ad.Wrapper.VASTAdTagURI.nodeValue,h={url:a.convertProtocol(p),extraParams:s.extraParams,corsCookieDomains:s.corsCookieDomains},l(o,h).then(v.resolve).fail(v.reject).done())):(f.trigger(g),void v.reject(new i(r.NO_ADS.code,o,"VAST request returned no ads")))):(f.trigger(g),void v.reject(new i(r.XML_PARSE_ERROR.code,o)))},h.error=function(t,n){var a,s,u;200!==t.status||t.responseXML?(a=r.WRAPPER_URI_TIMEOUT.code,u=t.statusText):(a=r.XML_PARSE_ERROR.code,u=r.XML_PARSE_ERROR.message),s=e.Event("requestEnd",{requestNumber:m,uri:A,vastResponse:o,error:{status:t.status,statusText:u}}),o.addRawResponse({requestNumber:m,uri:A,response:t.responseText,headers:t.getAllResponseHeaders().trim()}),f.trigger(s),v.reject(new i(a,o,"VAST Request Failed ("+n+" "+t.status+")"))},u=e.Event("requestStart",{requestNumber:m,uri:A,vastResponse:o}),f.trigger(u),e.ajax(h),v.promise}var d=1e4,p=0,f=e({});return{getVastChain:s,addEventListener:u,on:u}}),define("vast-parser/vastAdManager",["./vastChainer"],function(e){return{requestVastChain:e.getVastChain,addEventListener:e.addEventListener}}),define("util/url",["util/publisherWindow"],function(e){function t(t){var n,r,i;return n=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),r=new RegExp("[\\?&]"+n+"=([^&#]*)"),i=r.exec(e.location.search),i&&2===i.length?decodeURIComponent(i[1]):""}function n(t){if(0===t.indexOf("//")){var n=e.location.protocol;return n+t}return t}return{getQueryParameterValue:t,ensureProtocolPrefix:n}}),define("vast/vastHelper",["vast-parser/util/helpers"],function(e){function t(e){var t={},n=["apid","skid"];return e?(e.getExtensions().forEach(function(e){var r=e.getDetailsByPath("Property");r.forEach(function(e){-1!==n.indexOf(e["@id"])&&(t[e["@id"]]=e.nodeValue)})}),t):{}}function n(t){var n=t.getExtensions(),r=[];return n.forEach(function(t){var n=t.getDetailsByPath("CustomTrackingEvents.CustomTracking");n&&(n.forEach(function(t){t.nodeValue=e.convertProtocol(t.nodeValue)}),r=r.concat(n))}),r.filter(function(t){return e.isURL(t.nodeValue,{allow_protocol_relative_urls:!0})})}return{extractApidSkidFromVastResponse:t,extractCustomTrackingFromVastResponse:n}}),define("vast/vastTransformer",["util/trackingEvent","util/enable","util/url","vast/vastHelper"],function(e,t,n,r){function i(e){var t,n=e.inline.VAST.Ad.InLine;return t={skid:null,apid:null,adParameters:void 0,items:{title:{text:n.AdTitle.nodeValue},description:{text:n.Description&&n.Description.nodeValue||""},disclosureMessage:{text:"Advertisement"},thumbnail:{attributes:{alt:n.AdTitle.nodeValue,title:n.AdTitle.nodeValue}}},clickThroughs:{title:{},thumbnail:{},disclosureMessage:{},expandedVideo:{},video:{}},tracking:{},sharing:{}},o(t,e),a(t,e),d(t,e),c(t,e),t}function o(e,t){var n,r=t.getNonLinearCreative();r&&(n=r.getStaticResource(),e.items.thumbnail.attributes.src=n||"")}function a(e,t){var n=t.getLinearCreative();if(n){e.mediaFiles=n.getMediaFiles().map(s);var r=n.getClickThrough();e.clickThroughs.expandedVideo.url=r,e.clickThroughs.thumbnail.url=r,e.clickThroughs.title.url=r,e.clickThroughs.disclosureMessage.url=r,e.clickThroughs.video.url=r,e.adParameters=n.getAdParameters()}}function s(e){var t=e.type,r=e.delivery,i=e.url,o=e.bitrate,a=e.width,s=e.height,u=e.apiFramework;return{type:t,delivery:r,url:n.ensureProtocolPrefix(i),bitrate:o,width:a,height:s,apiFramework:u}}function u(e){return void 0===e||null===e||"number"==typeof e&&0!==e&&!e?[]:Array.isArray(e)?e:[e]}function c(e,n){n.wrappers.forEach(function(t){var n=t.VAST.Ad.Wrapper;n.Extensions&&n.Extensions.Extension&&u(n.Extensions.Extension).filter(function(e){return!!e.VASTOverrides}).forEach(function(t){if(t.VASTOverrides.Ignore){var n=u(t.VASTOverrides.Ignore);n.forEach(function(t){"AdTitle"===t["@elementName"]?e.items.title.text="See today's promoted video":"Description"===t["@elementName"]&&(e.items.description.text="Click or tap to view the video in full")})}})}),t.requiresStarAllianceOverride(e)&&(e.items.title.text="A maneira que o Brasil se conecta com o mundo")}function l(e,t){return e instanceof Array!=!0&&(e=[]),e.concat(t)}function d(t,n){var i=n.inline.VAST.Ad.InLine;for(var o in e)t.tracking[e[o]]=[];t.tracking[e.IMP]=n.getImpressions(),n.linearCreative&&(["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","mute","unmute","pause","rewind","resume","fullscreen","exitFullscreen","expand","collapse","acceptInvitationLinear","closeLinear","skip","progress"].forEach(function(e){var r=t.tracking[e]||[];t.tracking[e]=r.concat(n.linearCreative.getTrackingEvents(e))}),[e.POST_VIDEO_CLICK,e.VIDEO_CLICK].forEach(function(e){t.tracking[e]=n.linearCreative.getClickTrackers(e)})),r.extractCustomTrackingFromVastResponse(n).forEach(function(e){var n=e["@event"];t.tracking[n]=l(t.tracking[n],e.nodeValue)}),n.wrappers.forEach(function(n){var r,i=n.VAST.Ad.Wrapper,o=i.Creatives&&i.Creatives.Creative||[];r=o.filter(function(e){return e.NonLinearAds&&e.NonLinearAds.NonLinear}),r.forEach(function(n){u(n.NonLinearAds.NonLinear.NonLinearClickTracking).forEach(function(n){t.tracking[e.CLICK]=t.tracking[e.CLICK].concat(n.nodeValue)})}),i.Extensions&&i.Extensions.Extension&&u(i.Extensions.Extension).filter(function(e){return e.Property}).forEach(function(e){var n=e.Property;n.forEach(function(e){t[e["@id"]]=e.nodeValue})})}),i.Extensions&&i.Extensions.Extension&&u(i.Extensions.Extension).forEach(function(e){e.SharingUrl&&(t.sharing.sharingUrl=e.SharingUrl.nodeValue),e.DisclosureMessage&&(t.items.disclosureMessage.text=e.DisclosureMessage.nodeValue)})}return{transform:i,_overrideVASTElements:c}}),define("audienceTargetingTransformer",["q","util/trackingEvent"],function(e,t){function n(n){var r=e.defer();return"undefined"==typeof n?(r.reject({type:t.error.AUDIENCE_TARGETING_REQUEST_FAILED,message:"Audience Targeting Transformer Data object is undefined"}),r.promise):n.segments?(n.quantcast={segments:n.segments},delete n.segments,r.resolve(n),r.promise):(r.reject({type:t.error.AUDIENCE_TARGETING_REQUEST_FAILED,message:'Audience Targeting Transformer Data missing "segments" object'}),r.promise)}return{transform:n}}),define("vast/vastErrorMapper",["vast-parser/vastErrorCodes","util/trackingEvent","vast/vastHelper"],function(e,t,n){function r(e){var n,r,a=o[e.code];return a=a||t.error.ERROR,r=i(e),n={type:a,message:e.message},r&&(n.errorParams=r),n}function i(e){var t=n.extractApidSkidFromVastResponse(e.vastResponse);return 0===Object.keys(t).length&&(t=void 0),t}var o={};return o[e.NO_ADS.code]=t.error.NO_ADS,o[e.GENERAL_WRAPPER_ERROR.code]=t.error.NO_ADS,o[e.VAST_SCHEMA_ERROR.code]=t.error.AD_REQUEST_FAILED,o[e.XML_PARSE_ERROR.code]=t.error.AD_REQUEST_FAILED,o[e.WRAPPER_URI_TIMEOUT.code]=t.error.AD_REQUEST_FAILED,{getUnrulyError:r}}),define("util/dom/videoSize",[],function(){function e(e){return"number"==typeof e&&e>0}return{getForAd:function(t){var n=t.getPotentialVideoSize(),r=n&&"object"==typeof n&&e(n.width)&&e(n.height);return r?n:null}}}),define("util/getUnrulyOverride",["util/publisherWindow","util/url"],function(e,t){function n(t){var n=e.unruly&&e.unruly["native"]&&e.unruly["native"].placements&&e.unruly["native"].placements[t],r=null;return n&&(r=e.unruly["native"].placements[t].tagId),r}function r(){return t.getQueryParameterValue("unruly_override")}return function(e){return r()||n(e)||null}}),define("campaignConfigController",["jquery","util/enable","vast-parser/vastAdManager","vast/vastTransformer","session/sessionInfo","util/trackingEvent","audienceTargeting","audienceTargetingTransformer","tracking","q","util/url","vast/vastErrorMapper","util/stopwatch","util/eventBus","vast/vastHelper","util/dom/videoSize","util/getUnrulyOverride"],function(e,t,n,r,i,o,a,s,u,c,l,d,p,f,h,A,v){function m(e){var t=i.getSiteInfo();return t.user=t.user||{},t.user.profile=e,t}function g(e){var t={};e&&e.getRawResponses?t.raw=e.getRawResponses():t.raw="raw response not recorded",f.dispatchEvent({type:"logContext"},[t])}function y(e){var t=e.config&&e.config.format&&e.config.format.inArticle;return t?"//targeting.unrulymedia.com/in_article?uuid=":"//targeting.unrulymedia.com/pp?uuid="}function E(e,t,n){var r=y(e),i=e.config.targetingUUID,o="&",a=encodeURIComponent(JSON.stringify(n)),s=A.getForAd(t),u=s?"&video_width="+s.width+"&video_height="+s.height:"";return""+r+i+o+"tj="+a+u}function b(e,l){function p(t){var n=E(e,l,t);return{url:n,corsCookieDomains:["targeting.unrulymedia.com"]}}function f(t){var n=v(e.config.placementId);return n&&(t.headers=t.headers||{},t.headers["X-Unruly-Override"]=n),t}function h(t){var n={tj:JSON.stringify(t)};return u.enrichParametersFromPlacement(n,e.config),u.trackActivate(o.ADCALL,n),t}function A(e){var t={apid:e.apid,skid:e.skid};return u.trackActivate(o.CREATIVE_RECEIVED,t),e}var y;return e&&e.config&&e.config.targetingUUID?"undefined"==typeof JSON?c.reject({type:o.error.UNSUPPORTED_BROWSER,message:"JSON is not defined"}):(y=t.audienceTargeting?a.request().then(s.transform).then(m).fail(function(e){return u.trackActivate(o.error.AUDIENCE_TARGETING_REQUEST_FAILED,{message:e.message}),i.getSiteInfo()}):c.fcall(function(){return i.getSiteInfo()}),y.then(h).then(p).then(f).then(n.requestVastChain).fail(function(e){throw g(e.vastResponse),d.getUnrulyError(e)}).then(function(e){return g(e),r.transform(e)}).then(A)):c.reject({type:o.error.SKIN_SETUP_FAILED,message:"no targeting uuid in skin"})}return function(){n.addEventListener("requestStart",function(e){p.start("vast_"+e.requestNumber)}),n.addEventListener("requestEnd",function(e){var t;p.stop("vast_"+e.requestNumber),t=h.extractApidSkidFromVastResponse(e.vastResponse),t.vast_url=e.uri,u.trackActivate(o.prefixed.VAST_REQUEST_X+e.requestNumber,t)})}(),{getCampaignConfig:b}}),function(e){"function"==typeof define?define("es5shim",e):"function"==typeof YUI?YUI.add("es5",e):e()}(function(){function e(){}function t(e){return e=+e,e!==e?e=0:0!==e&&e!==1/0&&e!==-(1/0)&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}function n(e){var t=typeof e;return null===e||"undefined"===t||"boolean"===t||"number"===t||"string"===t}function r(e){var t,r,i;if(n(e))return e;if(r=e.valueOf,"function"==typeof r&&(t=r.call(e),n(t)))return t;if(i=e.toString,"function"==typeof i&&(t=i.call(e),n(t)))return t;throw new TypeError}8!==parseInt("08")&&(parseInt=function(e){var t=/^0[xX]/;return function(n,r){return n=String(n).trim(),+r||(r=t.test(n)?16:10),e(n,r)}}(parseInt)),Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if("function"!=typeof n)throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var r=p.call(arguments,1),i=function(){if(this instanceof u){var e=n.apply(this,r.concat(p.call(arguments)));return Object(e)===e?e:this}return n.apply(t,r.concat(p.call(arguments)))},o=Math.max(0,n.length-r.length),a=[],s=0;o>s;s++)a.push("$"+s);var u=Function("binder","return function("+a.join(",")+"){return binder.apply(this,arguments)}")(i);return n.prototype&&(e.prototype=n.prototype,u.prototype=new e,e.prototype=null),u});var i,o,a,s,u,c=Function.prototype.call,l=Array.prototype,d=Object.prototype,p=l.slice,f=c.bind(d.toString),h=c.bind(d.hasOwnProperty);if((u=h(d,"__defineGetter__"))&&(i=c.bind(d.__defineGetter__),o=c.bind(d.__defineSetter__),a=c.bind(d.__lookupGetter__),s=c.bind(d.__lookupSetter__)),2!=[1,2].splice(0).length){var A=Array.prototype.splice,v=Array.prototype.push,m=Array.prototype.unshift;!function(){function e(e){for(var t=[];e--;)t.unshift(e);return t}var t,n=[];return n.splice.bind(n,0,0).apply(null,e(20)),n.splice.bind(n,0,0).apply(null,e(26)),t=n.length,n.splice(5,0,"XXX"),t+1==n.length?!0:void 0}()?Array.prototype.splice=function(e,t){var n,r=p.call(arguments,2),i=r.length;if(!arguments.length)return[];if(void 0===e&&(e=0),void 0===t&&(t=this.length-e),i>0){if(0>=t){if(e==this.length)return v.apply(this,r),[];if(0==e)return m.apply(this,r),[]}return n=p.call(this,e,e+t),r.push.apply(r,p.call(this,e+t,this.length)),r.unshift.apply(r,p.call(this,0,e)),r.unshift(0,this.length),A.apply(this,r),n}return A.call(this,e,t)}:Array.prototype.splice=function(e,t){return arguments.length?A.apply(this,[void 0===e?0:e,void 0===t?this.length-e:t].concat(p.call(arguments,2))):[]}}if(1!=[].unshift(0)){var m=Array.prototype.unshift;Array.prototype.unshift=function(){return m.apply(this,arguments),this.length}}Array.isArray||(Array.isArray=function(e){return"[object Array]"==f(e)});var g=Object("a"),y="a"!=g[0]||!(0 in g),E=!0;if(Array.prototype.forEach&&Array.prototype.forEach.call("foo",function(e,t,n){"object"!=typeof n&&(E=!1)}),Array.prototype.forEach&&E||(Array.prototype.forEach=function(e){var t=L(this),n=y&&"[object String]"==f(this)?this.split(""):t,r=arguments[1],i=-1,o=n.length>>>0;if("[object Function]"!=f(e))throw new TypeError;for(;++i<o;)i in n&&e.call(r,n[i],i,t)}),Array.prototype.map||(Array.prototype.map=function(e){var t=L(this),n=y&&"[object String]"==f(this)?this.split(""):t,r=n.length>>>0,i=Array(r),o=arguments[1];if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");for(var a=0;r>a;a++)a in n&&(i[a]=e.call(o,n[a],a,t));return i}),Array.prototype.filter||(Array.prototype.filter=function(e){var t,n=L(this),r=y&&"[object String]"==f(this)?this.split(""):n,i=r.length>>>0,o=[],a=arguments[1];if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");for(var s=0;i>s;s++)s in r&&(t=r[s],e.call(a,t,s,n)&&o.push(t));return o}),Array.prototype.every||(Array.prototype.every=function(e){var t=L(this),n=y&&"[object String]"==f(this)?this.split(""):t,r=n.length>>>0,i=arguments[1];if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");for(var o=0;r>o;o++)if(o in n&&!e.call(i,n[o],o,t))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e){var t=L(this),n=y&&"[object String]"==f(this)?this.split(""):t,r=n.length>>>0,i=arguments[1];if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");for(var o=0;r>o;o++)if(o in n&&e.call(i,n[o],o,t))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=L(this),n=y&&"[object String]"==f(this)?this.split(""):t,r=n.length>>>0;if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");if(!r&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var i,o=0;if(arguments.length>=2)i=arguments[1];else for(;;){if(o in n){i=n[o++];break}if(++o>=r)throw new TypeError("reduce of empty array with no initial value")}for(;r>o;o++)o in n&&(i=e.call(void 0,i,n[o],o,t));return i}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){var t=L(this),n=y&&"[object String]"==f(this)?this.split(""):t,r=n.length>>>0;if("[object Function]"!=f(e))throw new TypeError(e+" is not a function");if(!r&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var i,o=r-1;if(arguments.length>=2)i=arguments[1];else for(;;){if(o in n){i=n[o--];break}if(--o<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>o)return i;do o in this&&(i=e.call(void 0,i,n[o],o,t));while(o--);return i}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(e){var n=y&&"[object String]"==f(this)?this.split(""):L(this),r=n.length>>>0;if(!r)return-1;var i=0;for(arguments.length>1&&(i=t(arguments[1])),i=i>=0?i:Math.max(0,r+i);r>i;i++)if(i in n&&n[i]===e)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(e){var n=y&&"[object String]"==f(this)?this.split(""):L(this),r=n.length>>>0;if(!r)return-1;var i=r-1;for(arguments.length>1&&(i=Math.min(i,t(arguments[1]))),i=i>=0?i:r-Math.abs(i);i>=0;i--)if(i in n&&e===n[i])return i;return-1}),!Object.keys){var b=!0,w=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],_=w.length;for(var C in{toString:null})b=!1;Object.keys=function O(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var O=[];for(var t in e)h(e,t)&&O.push(t);if(b)for(var n=0,r=_;r>n;n++){var i=w[n];h(e,i)&&O.push(i)}return O}}var k=-621987552e5,I="-000001";Date.prototype.toISOString&&-1!==new Date(k).toISOString().indexOf(I)||(Date.prototype.toISOString=function(){var e,t,n,r,i;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(r=this.getUTCFullYear(),i=this.getUTCMonth(),r+=Math.floor(i/12),i=(i%12+12)%12,e=[i+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],r=(0>r?"-":r>9999?"+":"")+("00000"+Math.abs(r)).slice(r>=0&&9999>=r?-4:-6),t=e.length;t--;)n=e[t],10>n&&(e[t]="0"+n);return r+"-"+e.slice(0,2).join("-")+"T"+e.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"});var F=!1;try{F=Date.prototype.toJSON&&null===new Date(NaN).toJSON()&&-1!==new Date(k).toJSON().indexOf(I)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(T){}F||(Date.prototype.toJSON=function(e){var t,n=Object(this),i=r(n);if("number"==typeof i&&!isFinite(i))return null;if(t=n.toISOString,"function"!=typeof t)throw new TypeError("toISOString property is not callable");return t.call(n)}),!Date.parse,Date=function(e){function t(n,r,i,o,a,s,u){var c=arguments.length;if(this instanceof e){var l=1==c&&String(n)===n?new e(t.parse(n)):c>=7?new e(n,r,i,o,a,s,u):c>=6?new e(n,r,i,o,a,s):c>=5?new e(n,r,i,o,a):c>=4?new e(n,r,i,o):c>=3?new e(n,r,i):c>=2?new e(n,r):c>=1?new e(n):new e;return l.constructor=t,l}return e.apply(this,arguments)}function n(e,t){var n=t>1?1:0;return o[t]+Math.floor((e-1969+n)/4)-Math.floor((e-1901+n)/100)+Math.floor((e-1601+n)/400)+365*(e-1970)}function r(t){return Number(new e(1970,0,1,0,0,0,t))}var i=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),o=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(var a in e)t[a]=e[a];return t.now=e.now,t.UTC=e.UTC,t.prototype=e.prototype,t.prototype.constructor=t,t.parse=function(t){var o=i.exec(t);if(o){var a,s=Number(o[1]),u=Number(o[2]||1)-1,c=Number(o[3]||1)-1,l=Number(o[4]||0),d=Number(o[5]||0),p=Number(o[6]||0),f=Math.floor(1e3*Number(o[7]||0)),h=Boolean(o[4]&&!o[8]),A="-"===o[9]?1:-1,v=Number(o[10]||0),m=Number(o[11]||0);return(d>0||p>0||f>0?24:25)>l&&60>d&&60>p&&1e3>f&&u>-1&&12>u&&24>v&&60>m&&c>-1&&c<n(s,u+1)-n(s,u)&&(a=60*(24*(n(s,u)+c)+l+v*A),a=1e3*(60*(a+d+m*A)+p)+f,h&&(a=r(a)),a>=-864e13&&864e13>=a)?a:NaN}return e.parse.apply(this,arguments)},t}(Date),Date.now||(Date.now=function(){return(new Date).getTime()}),Number.prototype.toFixed&&"0.000"===8e-5.toFixed(3)&&"0"!==.9.toFixed(0)&&"1.25"===1.255.toFixed(2)&&"1000000000000000128"===0xde0b6b3a7640080.toFixed(0)||!function(){function e(e,t){for(var n=-1;++n<a;)t+=e*s[n],s[n]=t%o,t=Math.floor(t/o)}function t(e){for(var t=a,n=0;--t>=0;)n+=s[t],s[t]=Math.floor(n/e),n=n%e*o}function n(){for(var e=a,t="";--e>=0;)if(""!==t||0===e||0!==s[e]){var n=String(s[e]);""===t?t=n:t+="0000000".slice(0,7-n.length)+n}return t}function r(e,t,n){return 0===t?n:t%2===1?r(e,t-1,n*e):r(e*e,t/2,n)}function i(e){for(var t=0;e>=4096;)t+=12,e/=4096;for(;e>=2;)t+=1,e/=2;return t}var o,a,s;o=1e7,a=6,s=[0,0,0,0,0,0],Number.prototype.toFixed=function(o){var a,s,u,c,l,d,p,f;if(a=Number(o),a=a!==a?0:Math.floor(a),0>a||a>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(s=Number(this),s!==s)return"NaN";if(-1e21>=s||s>=1e21)return String(s);if(u="",0>s&&(u="-",s=-s),c="0",s>1e-21)if(l=i(s*r(2,69,1))-69,d=0>l?s*r(2,-l,1):s/r(2,l,1),d*=4503599627370496,l=52-l,l>0){for(e(0,d),p=a;p>=7;)e(1e7,0),p-=7;for(e(r(10,p,1),0),p=l-1;p>=23;)t(1<<23),p-=23;t(1<<p),e(1,1),t(2),c=n()}else e(0,d),e(1<<-l,0),c=n()+"0.00000000000000000000".slice(2,2+a);return a>0?(f=c.length,c=a>=f?u+"0.0000000000000000000".slice(0,a-f+2)+c:u+c.slice(0,f-a)+"."+c.slice(f-a)):c=u+c,c}}();var P=String.prototype.split;if(2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var e=void 0===/()??/.exec("")[1];String.prototype.split=function(t,n){var r=this;if(void 0===t&&0===n)return[];if("[object RegExp]"!==Object.prototype.toString.call(t))return P.apply(this,arguments);var i,o,a,s,u=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),l=0,t=new RegExp(t.source,c+"g");for(r+="",e||(i=new RegExp("^"+t.source+"$(?!\\s)",c)),n=void 0===n?-1>>>0:n>>>0;(o=t.exec(r))&&(a=o.index+o[0].length,!(a>l&&(u.push(r.slice(l,o.index)),!e&&o.length>1&&o[0].replace(i,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(o[e]=void 0)}),o.length>1&&o.index<r.length&&Array.prototype.push.apply(u,o.slice(1)),s=o[0].length,l=a,u.length>=n)));)t.lastIndex===o.index&&t.lastIndex++;return l===r.length?(s||!t.test(""))&&u.push(""):u.push(r.slice(l)),u.length>n?u.slice(0,n):u}}():"0".split(void 0,0).length&&(String.prototype.split=function(e,t){return void 0===e&&0===t?[]:P.apply(this,arguments)}),"".substr&&"b"!=="0b".substr(-1)){var S=String.prototype.substr;String.prototype.substr=function(e,t){return S.call(this,0>e&&(e=this.length+e)<0?0:e,t)}}var x="	\n\x0B\f\r Â áá ââââââââââââ¯âã\u2028\u2029\ufeff";if(!String.prototype.trim||x.trim()){x="["+x+"]";var D=new RegExp("^"+x+x+"*"),R=new RegExp(x+x+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(D,"").replace(R,"")}}var L=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)}}),define("adManager",["unrulyAdCore/util/window","util/publisherWindow","publisherConfigController","placementController","placementFinder","tracking","util/trackingEvent","util/browser","util/publisherApi","audienceTargeting","q","util/eventBus","logging/loggingController","adFormats/adFactory","util/enable","fallbackManager","campaignConfigController"],function(e,t,n,r,i,o,a,s,u,c,l,d,p,f,h,A,v){function m(e){return e.type&&(e.errorType=e.type),e}function g(e,t){d.dispatchEvent("logMessages",{message:e,errorType:t})}function y(e,t,n){return t=t||a.error.ERROR,n=n||{},n.message=e,g(e,t),t===a.error.PLACEMENT_ALREADY_FOUND?l.resolve():o.trackActivate(t,n)}function E(e,t){y(e,t),u.onFinished(),u.onFallback()}function b(n,r){if(null!==t.location.search.match(/[&|?]UnrulyDisableIFPP=1(\&|$)/)||!e.unruly||!e.unruly["native"])return void u.onFinished();p.init(),A.register();var i=function(e){u.onFinished(),u.onFallback(),r(e)};s.isSupported()?n():i(a.error.UNSUPPORTED_BROWSER)}function w(e){var t=!1;return e.map(function(e){var n=l.defer(),r=new i;return r.matchPlacement(e,function(r,i){if(r)return void n.reject({message:r.message,errorType:r.errorType});if(t)return void n.reject({message:"placement_already_found",errorType:a.error.PLACEMENT_ALREADY_FOUND});t=!0;var s=void 0;l.fcall(function(){s=f.createAd(i)}).then(function(){return v.getCampaignConfig(i,s)}).then(function(e){return o.setupThirdPartyTracking(e),e}).then(function(e){return s.populate(e)}).then(function(){_()}).then(function(){n.resolve()}).fail(function(t){A.executeFallbackWithPlacementId(e.placementId),n.reject(m(t))})}),n.promise.fail(function(t){var n=t.errorParams||{};return o.enrichParametersFromPlacement(n,e),y(t.message,t.errorType,n)["finally"](function(){throw t})})})}function _(){o.trackThirdParty(a.PP_IMP),d.dispatchEvent("logMessages",{message:"Ad impression",event:a.PP_IMP})}function C(){var t;return h.inProduction&&c.syncData(),require(["es5shim"],function(){n.getPublisherConfig(e.unruly["native"].siteId,function(e){var n,i;try{if(n=r.verifyConfig(e),!1===h.supportsCurrentURLScheme())throw{message:"URL Scheme not supported (HTTPS)",errorType:a.error.SCHEME_NOT_SUPPORTED}}catch(o){return void E(o.message,o.errorType)}i=w(n),t=l.allSettled(i).then(function(e){var t=l.defer(),n=e.filter(function(e){return e.reason&&e.reason.errorType===a.error.NO_MATCHING_PLACEMENT});return n.length===e.length?y("All placements failed",a.error.ZERO_MATCHING_PLACEMENTS).then(function(){t.resolve(e)}):t.resolve(e),t.promise}).then(function(e){var t=e.filter(function(e){return"rejected"===e.state});p.log(e),u.onFinished(),t.length===e.length&&u.onFallback()})},E)}),t}return{init:b,load:C,_trackError:y}}),define("mainInitialiser",["adManager","util/stopwatch","tracking","util/trackingEvent","util/global"],function(e,t,n,r,i){function o(){function o(){e.load()}function a(e){e=e||r.error.ERROR,n.trackActivate(e)}t.init(),t.start("corejs",i._adLoaderTime),t.stop("corejs"),e.init(o,a)}return{init:o}}),require([],function(){try{!function(){return window.top.document}(),require(["mainInitialiser"],function(e){e.init()})}catch(e){require(["tracking","util/trackingEvent"],function(t,n){t.trackActivate(n.error.BLOCKED_CROSS_ORIGIN_FRAME,{message:e.message},{noTopWindowAccess:!0})})}}),define("main",function(){}),function(e){"function"==typeof define&&define.amd?define("jqueryxdomainrequest",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){if(e.support.cors||!e.ajaxTransport||!window.XDomainRequest)return e;var t=/^(https?:)?\/\//i,n=/^get|post$/i,r=new RegExp("^(//|"+location.protocol+")","i");return e.ajaxTransport("* text html xml json",function(i,o,a){if(i.crossDomain&&i.async&&n.test(i.type)&&t.test(i.url)&&r.test(i.url)){var s=null;return{send:function(t,n){var r="",a=(o.dataType||"").toLowerCase();s=new XDomainRequest,/^\d+$/.test(o.timeout)&&(s.timeout=o.timeout),s.ontimeout=function(){n(500,"timeout")},s.onload=function(){var t="Content-Length: "+s.responseText.length+"\r\nContent-Type: "+s.contentType,r={code:200,message:"success"},i={text:s.responseText};try{if("html"===a||/text\/html/i.test(s.contentType))i.html=s.responseText;else if("json"===a||"text"!==a&&/\/json/i.test(s.contentType))try{i.json=e.parseJSON(s.responseText)}catch(o){r.code=500,r.message="parseerror"}else if("xml"===a||"text"!==a&&/\/xml/i.test(s.contentType)){var u=new ActiveXObject("Microsoft.XMLDOM");u.async=!1;try{u.loadXML(s.responseText)}catch(o){u=void 0}if(!u||!u.documentElement||u.getElementsByTagName("parsererror").length)throw r.code=500,r.message="parseerror","Invalid XML: "+s.responseText;i.xml=u}}catch(c){throw c}finally{n(r.code,r.message,i,t)}},s.onprogress=function(){},s.onerror=function(){n(500,"error",{text:s.responseText})},o.data&&(r="string"===e.type(o.data)?o.data:e.param(o.data)),
s.open(i.type,i.url),s.send(r)},abort:function(){s&&s.abort()}}}}),e}),define("jQueryPlugins/importantStyle",["jquery"],function(e){function t(e){for(var t,n=/(\w+(?:\-\w+)*)\s*:\s*([^;!]+)\s*(!important)?\s*;?/gi,r={};t=n.exec(e);)r[t[1]]={value:t[2].trim(),important:!!t[3]};return r}function n(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];t.push(n+": "+r.value+(r.important?" !important":""))}return t.join("; ")+";"}e.fn.setImportantStyle=function(e,r){if(r&&"string"==typeof e){var i=e;e={},e[i]=r}var o=t(this.attr("style"));for(var a in e)o[a]={value:e[a],important:!0};return this.attr("style",n(o)),this}}),define("jQueryPlugins/waitUntilExists",["jquery","../util/publisherWindow"],function(e,t){var n={},r=function(e){n[e]&&(t.clearInterval(n[e]),n[e]=null)},i="waitUntilExists.found";e.fn.waitUntilExists=function(o,a,s){var u=this.selector,c=e(u,t.document),l=c.not(function(){return e(this).data(i)});return"remove"===o?r(u):(l.data(i,!0),l.length>0&&o(),a&&c.length?r(u):s||(n[u]=t.setInterval(function(){c.waitUntilExists(o,a,!0)},500))),c}}),requirejs.config({baseUrl:".",paths:{jquery:"//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min"},map:{"*":{jquery:"util/unruly-jquery"},"util/unruly-jquery":{jquery:"jquery"},jqueryxdomainrequest:{jquery:"jquery"},"jQueryPlugins/importantStyle":{jquery:"jquery"},"jQueryPlugins/waitUntilExists":{jquery:"jquery"}}}),define("util/unruly-jquery",["util/publisherWindow","jquery","jqueryxdomainrequest","../jQueryPlugins/importantStyle","../jQueryPlugins/waitUntilExists"],function(e,t,n,r,i){var o=function(n,r){try{return t(n,r||e.document)}catch(i){}};for(var a in t)t.hasOwnProperty(a)&&(o[a]=t[a]);return t.support.cors=!0,o});