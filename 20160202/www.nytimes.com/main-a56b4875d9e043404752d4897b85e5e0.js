define("ab/libs/tracker/tagx_tracker",["ab/vendor/jquery","ab/libs/utils","ab/libs/logger"],function(e,t,r){"use strict";var n=function(e,t){t=t||{},this.attrs={priority:!0},this.queue=[],this.logger=r.get("tagxTracker"),this.isLiteTracking=t.isLiteTracking||!1,e&&this.setAttrs(e),t.liteTracking&&(this.liteTracking=t.liteTracking)};return n.prototype={liteTracking:["allocation"],setAttrs:function(t){this.attrs=e.extend(!0,{},this.attrs,t)},sendImpression:function(e){this.setAttrs({treatment:e}),this.trackEvent({name:"abtest",subject:"adx-ab-allocation",action:"allocation",url:window.location.href}),this.logger.debug("Sending impression with id: "+e),this.setAttrs({subject:"module-interactions"})},trackEvent:function(t){var r,n;if(t=e.extend(!0,{},this.attrs,t),this.isLiteTracking&&-1===e.inArray(t.action,this.liteTracking))return void this.logger.debug("Event Tracker Lite skipped "+JSON.stringify(t));r=t.name||"module-interactions",delete t.name,n="allocation"===t.action?"":"interaction",t.hasOwnProperty("type")&&delete t.type;try{this._send({name:r,data:t,type:n})}catch(a){this._addToQueue({name:r,data:t,type:n})}},_getTracker:function(){return this._trackerInst||(this._trackerInst=TAGX.EventProxy),this._trackerInst},_send:function(e){e.type=e.type||"",this._getTracker().trigger(e.name,e.data,e.type),this.logger.info("Event sent: "+JSON.stringify(e))},_addToQueue:function(e){this.queue.push(e),this._isWorkerSpawned()||this._spawnWorker()},_isWorkerSpawned:function(){return!!this._worker},_spawnWorker:function(){this._worker=setTimeout(e.proxy(this._clearQueue,this),500)},_clearQueue:function(){var e;try{for(;e=this.queue.shift();)this._send(e)}catch(t){this._addToQueue(e),this._spawnWorker()}}},n}),define("ab/tests/bar1/ft_upsell_nyt_0116/tracking",[],function(){"use strict";return{shared:[{selector:"#nyt-button-sub",category:"hover",action:"hover",eventType:"mouseover",label:"bar1_hoverCardDisplay"}],ctrl:[{selector:"#nyt-button-sub",category:"cta",action:"click",label:"bar1_dualCta"},{selector:".bar1-digi-offer a",category:"cta",action:"click",label:"bar1_hoverDigiCta"},{selector:".bar1-hd-offer a",category:"cta",action:"click",label:"bar1_hoverHdCta"},{selector:".split-all-button",category:"link",action:"click",label:"bar1_hoverDualCta"}],"var":[{selector:"#nyt-button-sub",category:"cta",action:"click",label:"bar1_buttonCta"},{selector:".ft-button",category:"cta",action:"click",label:"bar1_hoverCta"}]}}),define("ab/tests/gateway/ft_upsell_nyt_0116/shared_ft_module/internationalize",["ab/vendor/jquery","ab/libs/utils","ab/libs/url"],function(e,t,r){"use strict";var n={bodyCurrencySet:function(t){var r,n=Object.keys(t.currencyClassMap);for(r=0;r<n.length;r++)if(e("body").hasClass(n[r]))return n[r];return""},getCurrencyCodeAsync:function(a,i,o){var c,s=e.Deferred(),u=o.tryInterval,l=o.tryCount;return"draft"===i&&(c=r.parseCurrentUri().queryKey.currency,c&&(window.NYTD=window.NYTD||{},NYTD.countryCode=c)),t.runWhenReady(function(){return!!window.NYTD&&NYTD.countryCode||""!==n.bodyCurrencySet(a)},function(){var e;window.NYTD&&NYTD.countryCode||(e=n.bodyCurrencySet(a),""!==e&&(window.NYTD=window.NYTD||{},NYTD.countryCode=a.currencyClassMap[e])),s.resolve()},u,l),setTimeout(function(){"resolved"!==s.state()&&s.reject()},u*(l+1)),s},changeCurrencyAsync:function(t,r,a){var i=n.getCurrencyCodeAsync(t,r,a);i.always(function(){if(window.NYTD&&NYTD.countryCode&&t.currencyData[NYTD.countryCode]){var r=t.currencyData[NYTD.countryCode];e("span.trialprice-InCurrency").html(r.trialprice),e("body").addClass(r.currencyCode),("AUD"===r.currencyCode||"CAN"===r.currencyCode)&&e("body").addClass("shorten_currency")}})},getCurrencyCode:function(e,t){var n;return"draft"===t&&(n=r.parseCurrentUri().queryKey.currency,n&&(window.NYTD=window.NYTD||{},NYTD.countryCode=n)),window.NYTD&&NYTD.countryCode&&e.currencyData[NYTD.countryCode]?NYTD.countryCode:""},changeCurrency:function(t,r){var a=n.getCurrencyCode(t,r);if(""!==a){var i=t.currencyData[a];e("span.trialprice-InCurrency").html(i.trialprice),e("body").addClass(i.currencyCode),("AUD"===i.currencyCode||"CAN"===i.currencyCode)&&e("body").addClass("shorten_currency")}},readInternational:function(e){var t;return"draft"===e&&(t=r.parseCurrentUri().queryKey.internationalFlag,void 0!==t&&(window.NYTD=window.NYTD||{},NYTD.internationalFlag=parseInt(t,10))),window.NYTD&&1===NYTD.internationalFlag},modifyLPLinks:function(t,r,n){if(n&&n.US&&n.INYT){var a=this.readInternational(t);a&&e(r).each(function(){var t=e(this).attr("href");t=t.replace(encodeURIComponent(n.US),encodeURIComponent(n.INYT)),e(this).attr("href",t)})}}};return n}),define("ab/tests/gateway/ft_upsell_nyt_0116/shared_ft_module/data",["ab/vendor/jquery","ab/libs/utils"],function(e,t){"use strict";return{currencyData:{UKP:{currencyCode:"UKP",trialprice:"&pound;1"},EUR:{currencyCode:"EUR",trialprice:"&euro;1"},AUD:{currencyCode:"AUD",trialprice:"AUD &#36;1"},CAN:{currencyCode:"CAN",trialprice:"CAD &#36;1"}},currencyClassMap:{euro:"EUR",pound:"UKP",aud:"AUD",loonie:"CAN"}}}),define("ab/tests/bar1/ft_upsell_nyt_0116/main",["ab/vendor/jquery","ab/libs/utils","ab/libs/cookie","ab/libs/url","ab/libs/tracking_strategies/delegation_tracking_strategy","ab/libs/tracking_facade","ab/libs/test/strict_test","ab/libs/variation","ab/libs/engine/ga","ab/libs/tracker/tagx_tracker","ab/tests/bar1/ft_upsell_nyt_0116/tracking","ab/tests/bar1/ft_upsell_nyt_0116/config","ab/tests/gateway/ft_upsell_nyt_0116/shared_ft_module/internationalize","ab/tests/gateway/ft_upsell_nyt_0116/shared_ft_module/data"],function(e,t,r,n,a,i,o,c,s,u,l,d,y,p){"use strict";var _=t.inherits(o,{name:"ft_upsell_nyt_0116"}),g=e("#Bar1, #memberTools, .masthead-tools"),f=function(){t.getMeter().v;e("head").append(t.Template("bar1_ft_upsell_nyt_0116_styles")),g.removeClass("hidden"),e.getScript("http://static01.nyt.com/marketing/ADX/testing/bar1_ft.js")},b=t.inherits(c,{name:"control",changeDom:function(){var r="bar1_ft_upsell_nyt_0116_ctrl";e(".adxInfo").each(function(t,n){return e(n).attr("campaign")&&e(n).attr("campaign").match(/ft_upsell_inyt_0116/)?(r="bar1_ft_upsell_nyt_0116_ctrl_int",!1):void 0}),f(),g.prepend(t.Template(r)),y.changeCurrencyAsync(p,d.gaStatus,d.options.loadDelay),t.appendToHref(d.options.campaignIds.ctrl),this.logger.info("control is applied")},setTracking:function(e){e.setTracking(l.shared.concat(l.ctrl))}}),h=t.inherits(c,{name:"Variation1",changeDom:function(){var a=encodeURIComponent("&url="+n.getLocationHref());f(),g.prepend(t.Template("bar1_ft_upsell_nyt_0116_var")),t.appendToHref(d.options.campaignIds.var1),e.each(d.options.campaignIds.var1,function(e,r){t.appendToHref([{selector:r.selector,code:a}])}),this.logger.info("Variation1 is applied"),r.setCookie("nyt_ft_upsell_krux_flag",1,d.options.cookieExpires)},setTracking:function(e){e.setTracking(l.shared.concat(l["var"]))}}),C=t.inherits(c,{name:"Variation2",changeDom:function(){var a=encodeURIComponent("&url="+n.getLocationHref());f(),g.prepend(t.Template("bar1_ft_upsell_nyt_0116_var")),t.appendToHref(d.options.campaignIds.var2),e.each(d.options.campaignIds.var2,function(e,r){t.appendToHref([{selector:r.selector,code:a}])}),this.logger.info("Variation2 is applied"),r.setCookie("nyt_ft_upsell_krux_flag",1,d.options.cookieExpires)},setTracking:function(e){e.setTracking(l.shared.concat(l["var"]))}}),T=new s({experimentId:d.experimentId,variationId:s.getForcedVariationId(d.gaStatus,d.forcedVariationId)}),k=new u({expId:d.experimentId,testName:"ft_upsell_nyt_0116",module:"bar1"},{isLiteTracking:!0});T.getUid().done(function(e){k.setAttrs({UIDplatform:"Google",globalUID:e})});var m=new _({variations:[b,h,C],trackerFacade:new i({gua:T,tagx:k}),engine:T,trackers:d.trackers||{},trackingStrategy:a});return m.runExperiment(),m});
//# sourceMappingURL=main.js.map