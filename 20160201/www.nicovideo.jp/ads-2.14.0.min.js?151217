/*
 Advertisement Library 
  Version     2.14.0.b4fdb2a0f3a0c0ac28676716c402211abe23ff6c
  Build Date  20160108


 This library using SWFObject.js and part of prototype.js.
 - SWFObject is (c) 2007 Geoff Stearns and is released under the MIT License:
   http://www.opensource.org/licenses/mit-license.php
 - Prototype is freely distributable under the terms of an MIT-style license.
   For details, see the Prototype web site: http://www.prototypejs.org/

 This library makes use of the "prototypejs", but does not global pollution.
*/
(function(){var m=(new Function("return this;"))(),e=m.Ads=m.Ads||{},f=e.__internal__={},r;e.pathBase=e.pathBase||"http://ads.nicovideo.jp";e.version="2.14.0.b4fdb2a0f3a0c0ac28676716c402211abe23ff6c";e.buildDate="20160108";e.ALL=-1;e.isDebugMode=!1;e.removeLoadedSctipt=!0;for(var q=document.getElementsByTagName("meta"),n=0;n<q.length;n++)"ads-pagevariant"==q[n].name&&(e.pageVariant=q[n].content),"ads-loaderinterval"==q[n].name&&(e.loaderInterval=q[n].content);e.pageVariant=e.pageVariant||"";e.loaderInterval=
e.loaderInterval||500;(function(){if("undefined"==typeof a)var a={};"undefined"==typeof a.util&&(a.util={});"undefined"==typeof a.SWFObjectUtil&&(a.SWFObjectUtil={});a.SWFObject=function(b,c,d,f,e,k,l,s,m,p){document.getElementById&&(this.DETECT_KEY=p?p:"detectflash",this.skipDetect=a.util.getRequestParameter(this.DETECT_KEY),this.params={},this.variables={},this.attributes=[],b&&this.setAttribute("swf",b),c&&this.setAttribute("id",c),d&&this.setAttribute("width",d),f&&this.setAttribute("height",
f),e&&this.setAttribute("version",new a.PlayerVersion(e.toString().split("."))),this.installedVer=a.SWFObjectUtil.getPlayerVersion(),!window.opera&&(document.all&&7<this.installedVer.major)&&!a.unloadSet&&(a.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",a.SWFObjectUtil.cleanupSWFs)},window.attachEvent("onbeforeunload",a.SWFObjectUtil.prepUnload),a.unloadSet=!0),k&&this.addParam("bgcolor",k),this.addParam("quality",
l?l:"high"),this.setAttribute("useExpressInstall",!1),this.setAttribute("doExpressInstall",!1),this.setAttribute("xiRedirectUrl",s?s:window.location),this.setAttribute("redirectUrl",""),m&&this.setAttribute("redirectUrl",m))};a.SWFObject.prototype={useExpressInstall:function(a){this.xiSWFPath=a?a:"expressinstall.swf";this.setAttribute("useExpressInstall",!0)},setAttribute:function(a,c){this.attributes[a]=c},getAttribute:function(a){return this.attributes[a]||""},addParam:function(a,c){this.params[a]=
c},getParams:function(){return this.params},addVariable:function(a,c){this.variables[a]=c},getVariable:function(a){return this.variables[a]||""},getVariables:function(){return this.variables},getVariablePairs:function(){var a=[],c,d=this.getVariables();for(c in d)a[a.length]=c+"="+d[c];return a},getSWFHTML:function(){var a="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType","PlugIn"),this.setAttribute("swf",
this.xiSWFPath));var a='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+(this.getAttribute("style")||"")+'"',a=a+(' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" '),c=this.getParams(),d;for(d in c)a+=[d]+'="'+c[d]+'" ';d=this.getVariablePairs().join("&");0<d.length&&(a+='flashvars="'+d+'"');a+="/>"}else{this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType",
"ActiveX"),this.setAttribute("swf",this.xiSWFPath));a='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+(this.getAttribute("style")||"")+'">';a+='<param name="movie" value="'+this.getAttribute("swf")+'" />';c=this.getParams();for(d in c)a+='<param name="'+d+'" value="'+c[d]+'" />';d=this.getVariablePairs().join("&");0<d.length&&(a+='<param name="flashvars" value="'+
d+'" />');a+="</object>"}return a},write:function(b){if(this.getAttribute("useExpressInstall")){var c=new a.PlayerVersion([6,0,65]);this.installedVer.versionIsValid(c)&&!this.installedVer.versionIsValid(this.getAttribute("version"))&&(this.setAttribute("doExpressInstall",!0),this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl"))),document.title=document.title.slice(0,47)+" - Flash Player Installation",this.addVariable("MMdoctitle",document.title))}if(this.skipDetect||this.getAttribute("doExpressInstall")||
this.installedVer.versionIsValid(this.getAttribute("version")))return("string"==typeof b?document.getElementById(b):b).innerHTML=this.getSWFHTML(),!0;""!=this.getAttribute("redirectUrl")&&document.location.replace(this.getAttribute("redirectUrl"));return!1}};a.SWFObjectUtil.getPlayerVersion=function(){var b=new a.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var c=navigator.plugins["Shockwave Flash"];c&&c.description&&(b=new a.PlayerVersion(c.description.replace(/([a-zA-Z]|\s)+/,
"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")))}else if(navigator.userAgent&&0<=navigator.userAgent.indexOf("Windows CE"))for(var c=1,d=3;c;)try{d++,c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d),b=new a.PlayerVersion([d,0,0])}catch(f){c=null}else{try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(e){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),b=new a.PlayerVersion([6,0,21]),c.AllowScriptAccess="always"}catch(k){if(6==b.major)return b}try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(l){}}null!=
c&&(b=new a.PlayerVersion(c.GetVariable("$version").split(" ")[1].split(",")))}return b};a.PlayerVersion=function(a){this.major=null!=a[0]?parseInt(a[0]):0;this.minor=null!=a[1]?parseInt(a[1]):0;this.rev=null!=a[2]?parseInt(a[2]):0};a.PlayerVersion.prototype.versionIsValid=function(a){return this.major<a.major?!1:this.major>a.major?!0:this.minor<a.minor?!1:this.minor>a.minor?!0:this.rev<a.rev?!1:!0};a.util={getRequestParameter:function(a){var c=document.location.search||document.location.hash;if(null==
a)return c;if(c)for(var c=c.substring(1).split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return c[d].substring(c[d].indexOf("=")+1);return""}};a.SWFObjectUtil.cleanupSWFs=function(){for(var a=document.getElementsByTagName("OBJECT"),c=a.length-1;0<=c;c--){a[c].style.display="none";for(var d in a[c])"function"==typeof a[c][d]&&(a[c][d]=function(){})}};!document.getElementById&&document.all&&(document.getElementById=function(a){return document.all[a]});r=a.SWFObject})();(function(){f.Class=
{create:function(a){var b=function(){this.initialize&&this.initialize.apply(this,arguments)};if(a)for(var c in a)b[c]=a[c];return b},mixin:function(a,b){for(var c in b)b.hasOwnProperty(c)&&"undefined"===typeof a[c]&&("[object Object]"===Object.prototype.toString.call(b[c])?a[c]=this.mixin({},b[c]):"[object Array]"===Object.prototype.toString.call(b[c])?a[c]=this.mixin([],b[c]):a[c]=b[c]);return a}}})();(function(){f.Utility=f.Class.create({setup:function(){if("undefined"===typeof document.hasFocus||
/Android 2\.2/.test(navigator.userAgent)||/Android 2\.3/.test(navigator.userAgent)){var a=!0;this.addEvent(window,"focus",function(){a=!0});this.addEvent(window,"blur",function(){a=!1});this.hasFocus=function(){return a}}else this.hasFocus=function(){return document.hasFocus()}},extend:function(a,b){for(var c in b)a[c]=b[c]},hasFocus:function(){},addEvent:function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d):a.attachEvent?a.attachEvent("on"+b,c):a[b]=function(){a["on"+b]();c()}},isBackCompat:!document.compatMode||
!!document.compatMode.match(/.*BackCompat.*/i),toQueryString:function(a){var b="",c;for(c in a)null!==a[c]&&"undefined"!==typeof a[c]&&(b+=c+"="+encodeURIComponent(a[c])+"&");return b.slice(0,b.length-1)},deleteEmptyFromArray:function(a){for(var b=[],c=0;c<a.length;c++)a[c]&&""!==a[c]&&b.push(a[c]);return b},unique:function(a){for(var b={},c=[],d=0;d<a.length;d++)a[d]in b||(b[a[d]]=!0,c.push(a[d]));return c},map:function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(b(a[d]));return c},indexOf:function(a,
b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},count:function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},hasIntersection:function(a,b){for(var c=0,d=a.length;c<d;c++)for(var f=0,e=b.length;f<e;f++)if(a[c]===b[f])return!0;return!1},getScroll:function(){return"undefined"!==typeof m.pageXOffset&&"undefined"!==typeof m.pageYOffset?{left:m.pageXOffset,top:m.pageYOffset}:{left:document.documentElement.scrollLeft||document.body.scrollLeft,top:document.documentElement.scrollTop||
document.body.scrollTop}},getPageUrl:function(a){a=a||decodeURI(location.href);if(512<encodeURIComponent(a).length){for(var b="",c=0;c<a.length&&!(512<encodeURIComponent(b+a.charAt(c)).length);c++)b+=a.charAt(c);return b}return a},getPageVariant:function(){return e.pageVariant.match(/\W/)||64<e.pageVariant.length?"":e.pageVariant},getElementFromNameForSWF:function(a){return(a=-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a])?a:null},toArray:function(a){if(!a)return[];for(var b=a.length||
0,c=Array(b);b--;)c[b]=a[b];return c},TABLE_ELEMENT_INNERHTML_BUGGY:function(){try{var a=document.createElement("table");if(a&&a.tBodies)return a.innerHTML="<tbody><tr><td>test</td></tr></tbody>","undefined"==typeof a.tBodies[0]}catch(b){return!0}}(),getContentFromAnonymousElement:function(a,b,c){var d=f.Utility.INSERTION_TRANSLATIONS.tags[a];a=document.createElement("div");var e=!!d;!e&&c&&(e=!0,d=["","",0]);if(e)for(a.innerHTML="&#160;"+d[0]+b+d[1],a.removeChild(a.firstChild),b=d[2];b--;)a=a.firstChild;
else a.innerHTML=b;return f.Utility.toArray(a.childNodes)},INSERTION_TRANSLATIONS:{before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>",
"</select>",1]}},updateElement:function(a,b){var c=a.getElementsByTagName("*").length,c=a.tagName.toUpperCase();if(f.Utility.TABLE_ELEMENT_INNERHTML_BUGGY)if(c in f.Utility.INSERTION_TRANSLATIONS.tags)for(var d=f.Utility.getContentFromAnonymousElement(c,b),c=0,e;e=d[c];c++)a.appendChild(e);else a.innerHTML+=b;else a.innerHTML+=b},cumulativeOffset:function(a){var b=0,c=0;if(a.parentNode){do b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;while(a)}return{left:c,top:b}},canPlayMp4:function(){var a=
document.createElement("video");return"undefined"==typeof a.canPlayType?!1:!!a.canPlayType('video/mp4; codecs="avc1.4D401E, mp4a.40.2"')}})})();(function(){f.Event={definedEvents:{},addListener:function(a,b,c){"undefined"===typeof this.definedEvents[a]&&(this.definedEvents[a]=[]);this.definedEvents[a].push({func:b,scope:c||this})},fireEvent:function(a){var b=Array.prototype.slice.call(arguments).slice(1);if("undefined"!==typeof this.definedEvents[a])for(var c=0,d=this.definedEvents[a].length;c<d;c++){var f=
this.definedEvents[a][c];f.func.apply(f.scope,b)}},removeListener:function(a,b){if("undefined"!==typeof this.definedEvents[a]&&"function"===typeof b)for(var c=0,d=this.definedEvents[a].length;c<d;c++)if(this.definedEvents[a][c].func===b){this.definedEvents[a].splice(c,1);break}}}})();(function(){e.Advertisement=f.Class.create();f.Utility.extend(e.Advertisement.prototype,{zone:null,category:null,segments:null,elementId:null,view:null,template:null,count:null,impression:null,video:null,option:null,
follow:null,migiue:null,initialize:function(a){if("number"!==typeof a.zone)throw Error("zone is not number.");this.zone=a.zone;this.category=[].concat(a.category||[]);this.segments=a.segments||{};this.option=[].concat(a.option||[]);this.count="number"===typeof a.count?a.count:1;this.impression="number"===typeof a.impression?a.impression:1;this.video="string"===typeof a.video?a.video:null;this.view=a.view&&a.view.display?a.view:new e.View;this.follow=a.follow||null;this.migiue="string"===typeof a.migiue?
a.migiue:null;if(this.count===e.ALL&&2===this.impression)throw Error("You can not set [count: ALL] and [impression: 2] at a time.");},set:function(a,b){if(!document.getElementById(a))throw Error(a+" is not found.");if(b&&"function"!==typeof b)throw Error("template is not function.");this.elementId=a;this.template=b;f.AdvertisementLoader.register(this);this.follow&&new e.Follow(this.follow.elementId||this.elementId,this.follow.margin,this.follow.bottom);return this},getElement:function(){var a=document.getElementById(this.elementId);
a&&(this.getElement=function(){return a});return a}})})();(function(){f.AdvertisementAssembler=f.Class.create();f.Utility.extend(f.AdvertisementAssembler.prototype,{parameters:null,segments:null,impression:null,videoid:null,option:null,all:!1,initialize:function(a){this.parameters={};this.parameters.zone=[];this.parameters.category=[];this.segments={};for(var b=0;b<a.length;b++){var c=a[b];this.all||(this.all=c.count===e.ALL);for(var d=0;d<(c.count===e.ALL?1:c.count);d++)for(var h in this.parameters)this.parameters[h]=
this.parameters[h].concat(c[h]);null===this.impression&&(this.impression="number"===typeof c.impression?c.impression:null);null===this.videoid&&(this.videoid="string"===typeof c.video?c.video:null);null===this.option&&"[object Array]"==Object.prototype.toString.call(c.option)&&(this.option=c.option);0!==f.Utility.count(c.segments)&&f.Utility.extend(this.segments,c.segments)}},isAll:function(){return this.all},getOption:function(){return this.option},getZone:function(){return f.Utility.deleteEmptyFromArray(this.parameters.zone)},
getCategory:function(){var a=f.Utility.map(this.parameters.category,function(a){a=parseInt(a,10);return isNaN(a)?null:a});return f.Utility.deleteEmptyFromArray(f.Utility.unique(a)).sort(function(a,c){return a-c})}})})();(function(){f.AdvertisementLoader=f.Class.create({group:[],register:function(a){for(var b=0,c=this.group.length;b<c;b++)if(this.group[b].checkRequestGroup(a)){this.group[b].add(a);return}this.group[b]=new f.AdvertisementLoader;this.group[b].add(a)},registers:function(a){for(var b=
0,c=this.group.length;b<c;b++)if(this.group[b].checkRequestGroup(a)){this.group[b].interlockAdd(a);return}this.group[b]=new f.AdvertisementLoader;this.group[b].interlockAdd(a)},unload:function(a){for(var b=0;b<this.group.length;b++)this.group[b]===a&&this.group.splice(b,1)}});f.Utility.extend(f.AdvertisementLoader.prototype,{advertisements:null,timer:null,interval:0,isSend:!1,initialize:function(){if("undefined"===typeof e.loaderInterval)throw Error("Argument Ads.loaderInterval is required");var a=
parseInt(e.loaderInterval,10);if(isNaN(a))throw Error("Argument Ads.loaderInterval must be numeric.");if(0>a)throw Error("Argument Ads.loaderInterval must be bigger than 0.");this.interval=a;this.advertisements=[]},add:function(a){if(this.isSend)return!1;this.advertisements.push(a);if(!this.timer){var b=this;this.timer=setTimeout(function(){b.isSend=!0;b.send()},this.interval)}return!0},interlockAdd:function(a){for(var b=0,c=a.zoneIds.length;b<c;b++){var d={};f.Utility.extend(d,a);d.zone=a.zoneIds[b];
d.elementId=a.elementIds[b];d.template=a.templates[b];this.add(d)}},checkRequestGroup:function(a){if(this.isSend)return!1;for(var b=0,c=this.advertisements.length;b<c;b++)if(f.Utility.hasIntersection(this.advertisements[b].zoneIds||[this.advertisements[b].zone],a.zoneIds||[a.zone]))return!1;b=new f.AdvertisementAssembler(this.advertisements);a=new f.AdvertisementAssembler([a]);if(b.isAll()!==a.isAll()||b.getCategory().join(",")!==a.getCategory().join(",")||null!==b.impression&&b.impression!==a.impression||
null!==b.videoid&&b.videoid!==a.videoid)return!1;var c=[].concat(b.getOption()),d=[].concat(a.getOption());if(c.sort().toString()!==d.sort().toString())return!1;if(0!==this.advertisements.length)if(f.Utility.count(b.segments)===f.Utility.count(a.segments))for(var e in b.segments){if(!a.segments[e]||a.segments[e]!==b.segments[e])return!1}else return!1;return!0},send:function(){this.timer=null;var a=new f.AdvertisementAssembler(this.advertisements),b=a.getZone(),c=a.getCategory(),d=a.segments,h=a.videoid,
g=a.getOption(),k=e.Option.AOF.DEFAULT;-1!==f.Utility.indexOf(g,e.Option.SELECTROTATION_SEGMENT_MATCH_ALL)&&(k|=e.Option.AOF.SELECTROTATION_SEGMENT_MATCH_ALL);var l=this;a.isAll()?f.Api.getAllAdvertisements(b,c,d,k,function(a){l.callback(a)}):2===a.impression?null!==h&&-1!==f.Utility.indexOf(g,e.Option.RCP)?f.Api.getAdvertisementsAndLogImpressionForRcp(b,c,h,d,function(a){l.callback(a)}):f.Api.getAdvertisementsAndLogImpression(b,c,d,function(a){l.callback(a)}):f.Api.getAdvertisements(b,c,d,function(a){l.callback(a)})},
callback:function(a){if(a.message)throw Error(a.message);for(var b=[],c=[],d=0;d<this.advertisements.length;d++){for(var h=this.advertisements[d],g=[],k=0;k<a.data.length;k++)if(h.zone===parseInt(a.data[k].zoneid,10)||h.zone===parseInt(a.data[k].chainid,10))h.zoneIds&&-1!==f.Utility.indexOf(h.zoneIds,h.zone)?(c.push(a.data[k]),b.push(h)):g.push(a.data[k]),a.data.splice(k--,1);0<g.length&&h.view.display(h,g)}0<c.length&&e.InterlockAds.display(b,c);f.AdvertisementLoader.unload(this)}})})();(function(){f.Api=
f.Class.create({count:0,prefix:"ads_callback",url:{OxBannerService:{getAdvertisements:"/api/OxBannerService/getAdvertisements.jsonp?",getAllAdvertisements:"/api/OxBannerService/getAllAdvertisements.jsonp?",getAdvertisementsAndLogImpression:"/api/OxBannerService/getAdvertisementsAndLogImpression.jsonp?",getAdvertisementsAndLogImpressionForRcp:"/api/OxBannerService/getAdvertisementsAndLogImpressionForRcp.jsonp?",logImpression:"/api/OxBannerService/logImpression.jsonp?",logImpressionForRcp:"/api/OxBannerService/logImpressionForRcp.jsonp?"}},
getAdvertisements:function(a,b,c,d){var h=f.Utility.getPageUrl(),g=f.Utility.getPageVariant();f.Utility.extend(c,{zone:a.join(","),category:b.join(","),pageurl:h,pagevariant:g,callback:this.setCallback(d)});this.loadScript(e.pathBase+this.url.OxBannerService.getAdvertisements,c)},getAllAdvertisements:function(a,b,c,d,h){var g=f.Utility.getPageUrl(),k=f.Utility.getPageVariant();f.Utility.extend(c,{zone:a.join(","),category:b.join(","),pageurl:g,pagevariant:k,aof:d,callback:this.setCallback(h)});this.loadScript(e.pathBase+
this.url.OxBannerService.getAllAdvertisements,c)},getAdvertisementsAndLogImpression:function(a,b,c,d){var h=f.Utility.getPageUrl(),g=f.Utility.getPageVariant();f.Utility.extend(c,{zone:a.join(","),category:b.join(","),pageurl:h,pagevariant:g,callback:this.setCallback(d)});this.loadScript(e.pathBase+this.url.OxBannerService.getAdvertisementsAndLogImpression,c)},getAdvertisementsAndLogImpressionForRcp:function(a,b,c,d,h){var g=f.Utility.getPageUrl(),k=f.Utility.getPageVariant();f.Utility.extend(d,{zone:a.join(","),
category:b.join(","),videoid:c,pageurl:g,pagevariant:k,callback:this.setCallback(h)});this.loadScript(e.pathBase+this.url.OxBannerService.getAdvertisementsAndLogImpressionForRcp,d)},logImpression:function(a,b,c){this.loadScript(e.pathBase+this.url.OxBannerService.logImpression,{bannerid:a,zoneid:b,callback:this.setCallback(c)})},logImpressionForRcp:function(a,b,c,d){this.loadScript(e.pathBase+this.url.OxBannerService.logImpressionForRcp,{bannerid:a,zoneid:b,videoid:c,callback:this.setCallback(d)})},
loadScript:function(a,b){var c=document.createElement("script");c.src=a+f.Utility.toQueryString(b)+"&_="+(new Date).getTime();c.type="text/javascript";c.charset="utf-8";e.removeLoadedSctipt&&(c.onload=c.onreadystatechange=function(){c.readyState&&"complete"!==c.readyState&&"loaded"!==c.readyState||(c.onload=c.onreadystatechange=null,c.parentNode&&c.parentNode.removeChild(c),c=null)});document.getElementsByTagName("head")[0].appendChild(c)},setCallback:function(a){var b=f.Api.prefix+"_"+f.Api.count++;
window[b]=function(c){a(c);window[b]=void 0};return b}})})();(function(){e.Follow=f.Class.create({followBaseName:"ads_follow_",containers:{},locate:function(a,b){var c=f.Utility.getScroll(),d=this.containers[a];d.top-d.margin<c.top?(d.bottom-d.follower.clientHeight-d.margin>c.top?(d.follower.style.position="fixed",d.follower.style.top=d.margin+"px"):(d.follower.style.position="absolute",d.follower.style.top=d.bottom-d.follower.clientHeight+"px"),d.follower.style.left=b.left+"px"):(d.follower.style.position=
"static",b.top>d.top&&(d.top=b.top))},fix:function(a){var b=f.Utility.cumulativeOffset(this.containers[a].follower);e.Follow.locate(a,b)},resize:function(a){this.containers[a].follower.style.position="static";var b=f.Utility.cumulativeOffset(this.containers[a].follower);e.Follow.locate(a,b)},setMargin:function(a,b){this.containers[this.followBaseName+a]&&(this.containers[this.followBaseName+a].margin=b)},setBottom:function(a,b){this.containers[this.followBaseName+a]&&(this.containers[this.followBaseName+
a].bottom=b)}});f.Utility.extend(e.Follow.prototype,{initialize:function(a,b,c){var d=e.Follow.followBaseName+a,h=document.getElementById(a),g=f.Utility.cumulativeOffset(h);e.Follow.containers[d]={follower:h,margin:b||0,bottom:c||0,left:g.left,top:g.top};if(!e.Follow.containers[d].follower)throw Error(a+" is not found.");if(b&&"number"!==typeof b)throw Error("margin is not number.");if(c&&"number"!==typeof c)throw Error("bottom is not number.");f.Utility.addEvent(window,"scroll",function(){e.Follow.fix(d)},
!1);f.Utility.addEvent(window,"resize",function(){e.Follow.resize(d)},!1)}})})();(function(){f.Frequency=f.Class.create({domainPath:"domain=.nicovideo.jp; path=/;"});f.Utility.extend(f.Frequency.prototype,{initialize:function(){this.display=this.checked=!1},checkFrequency:function(a){this.checked||(0>a.views?this.display=!0:this.getFrequency(a.campaignid)<a.views&&(this.display=!0,this.logFrequency(a.campaignid)),this.checked=!0);return this.display},getCampaigns:function(){for(var a=document.cookie.split(";"),
b=a.length,c=0;c<b;c++)if(a[c].match(/^\s*nicoads_fc/))return f.Utility.deleteEmptyFromArray(a[c].replace(/^\s*nicoads_fc=/,"").split("|"));return[]},getFrequency:function(a){for(var b=this.getCampaigns(),c=b.length,d=0;d<c;d++)if(b[d].match("^"+a+"="))return b[d].split("=")[1]-0;return 0},logFrequency:function(a){var b=this.getFrequency(a)+1,c=new Date;c.setDate(c.getDate()+1);c.setHours(0);c.setMinutes(0);c.setSeconds(0);for(var d=this.getCampaigns(),e=d.length,g=0;g<e;g++)if(d[g].match("^"+a+"=")){d.splice(g,
1);break}d.push(a+"="+b);document.cookie="nicoads_fc="+d.join("|")+"; "+f.Frequency.domainPath+"; expires="+c.toGMTString()}})})();(function(){f.InterlockContainerSetting=f.Class.create();f.Utility.extend(f.InterlockContainerSetting.prototype,{variable:{},param:{},allowContainerMode:["is","im"],initialize:function(a,b){this.variable={};this.param={wmode:"opaque"};if("string"!==typeof a||"undefined"===typeof b)throw Error('Argument "containterMode" and "selfId" are required and must be string.');if(-1===
f.Utility.indexOf(this.allowContainerMode,a))throw Error('Argument "containerMode" must string "is" or "im".');this.setVariable("containerMode",a);this.setVariable("selfId",b)},setMasterId:function(a){if("undefined"===typeof a)throw Error('Argument "masterId" is required.');this.setVariable("masterId",a)},setSlaveIds:function(a){if("undefined"===typeof a)throw Error('Argument "slaveId" is required.');this.setVariable("slaveIds",a)},setVariable:function(a,b){if("undefined"===typeof b)throw Error('Argument "key" and "value" are required.');
this.variable[a]=b},setParam:function(a,b){if("undefined"===typeof b)throw Error('Argument "key" and "value" are required.');this.param[a]=b},getVariable:function(){return this.variable},getParam:function(){return this.param}})})();(function(){e.InterlockAds=f.Class.create({display:function(a,b){if(!f.Utility.canPlayMp4())for(var c=0,d=b.length;c<d;c++)if("mp4"==b[c].contenttype)return;var c=e.InterlockAds.getInterlockInfo(b),h=c.campaignids,g=c.swfLength,k=e.InterlockAds.categorizeAdvertisement(a,
b),l=k.stdAds,d=k.sidewallAds,m=e.InterlockAds.findInterlockMaster(k,c),n=m.elementId,k=[];m.isSidewall&&(k.push(d.instances[1].elementId),g-=2);for(c=l.length-1;0<=c;c--){if(""!==m.elementId&&-1!==f.Utility.indexOf(h,l.adData[c].campaignid)&&"swf"===l.adData[c].contenttype){var p=new f.InterlockContainerSetting("is",l.instances[c].elementId);p.setMasterId(n);m.elementId===l.instances[c].elementId?(p=new f.InterlockContainerSetting("im",l.instances[c].elementId),p.setSlaveIds(k)):k.push(l.instances[c].elementId);
var q=c,t=l.instances[c].time;f.Utility.extend(l.instances[c],{isInterlock:!0,getContainerSettings:function(){return p},getSwfEmbedId:function(){return"interlock_"+q},getSwfTime:function(){return t}});g--}l.instances[c].view.display(l.instances[c],[l.adData[c]])}2===d.adData.length&&(h=new f.InterlockContainerSetting("im",d.instances[0].elementId),h.setSlaveIds(k),h.setParam("wmode","transparent"),g=new f.InterlockContainerSetting("is",d.instances[1].elementId),g.setMasterId(d.instances[0].elementId),
g.setParam("wmode","transparent"),e.Sidewall.setContainerSettings(h,g),e.Sidewall.setAdjust(),e.Sidewall.callback({data:d.adData}))},getInterlockInfo:function(a){var b={length:0,swfLength:0,campaignids:[]};if(2>a.length)return b;for(var c=f.Utility.map(a,function(a){return a.campaignid}),d=0,e=a.length;d<e;d++){var g=a[d],k=f.Utility.indexOf(c,g.interlock_campaign_id);-1!==k&&(0===b.length&&(b.campaignids.push(a[k].campaignid),b.length++,"swf"===a[k].contenttype&&b.swfLength++),b.campaignids.push(g.campaignid),
b.length++,"swf"===g.contenttype&&b.swfLength++)}return b},categorizeAdvertisement:function(a,b){for(var c={stdAds:{instances:[],adData:[],length:0},sidewallAds:{instances:[],adData:[],length:0}},d=0,e=b.length;d<e;d++)a[d].sidewall&&-1!==f.Utility.indexOf(a[d].sidewall,a[d].zone)?(c.sidewallAds.instances.push(a[d]),c.sidewallAds.adData.push(b[d]),c.sidewallAds.length++):(c.stdAds.instances.push(a[d]),c.stdAds.adData.push(b[d]),c.stdAds.length++);return c},findInterlockMaster:function(a,b){var c=
{elementId:"",isSidewall:!1},d=a.stdAds,e=a.sidewallAds;if(2===e.length&&"swf"===e.adData[0].contenttype&&"swf"===e.adData[1].contenttype)c.elementId=a.sidewallAds.instances[0].elementId,c.isSidewall=!0;else if(1<b.swfLength)for(var e=0,g=d.length;e<g;e++)if(-1!==f.Utility.indexOf(b.campaignids,d.adData[e].campaignid)&&"swf"===d.adData[e].contenttype){c.elementId=a.stdAds.instances[e].elementId;c.isSidewall=!1;break}return c}});f.Utility.extend(e.InterlockAds.prototype,{initialize:function(a){this.elementId=
this.zone=null;this.zoneIds=[];this.elementIds=[];this.templates=[];this.sidewall=[];this.sidewallElementIds=[];this.count=1;this.view=new e.View;this.time=(new Date).getTime()+Math.floor(1E6*Math.random());this.advertisements=a.advertisements||[];this.category=[].concat(a.category||[]);this.segments=a.segments||{};this.option=[].concat(a.option||[]);this.impression="number"===typeof a.impression?a.impression:1;this.video="string"===typeof a.video?a.video:null;this.contentsWidth="number"===typeof a.contentsWidth?
a.contentsWidth:0;this.activatesAdjust="boolean"===typeof a.activatesAdjust?a.activatesAdjust:!0;a=0;for(var b=this.advertisements.length;a<b;a++)this.zoneIds.push(this.advertisements[a].zoneId),this.elementIds.push(this.advertisements[a].elementId),this.templates.push(this.advertisements[a].template),this.advertisements[a].hasOwnProperty("sidewall")&&this.advertisements[a].sidewall&&(this.sidewall.push(this.advertisements[a].zoneId),this.sidewallElementIds.push(this.advertisements[a].elementId));
2===this.sidewall.length&&2===this.sidewallElementIds.length&&e.Sidewall.setParameters({zoneIds:this.sidewall,locations:this.sidewallElementIds,contentsWidth:this.contentsWidth,segments:this.segments,impression:this.impression,activatesAdjust:this.activatesAdjust,time:this.time})},set:function(){f.AdvertisementLoader.registers(this)},getElement:function(){return document.getElementById(this.elementId)}})})();e.Option=f.Class.create({RCP:1,SELECTROTATION_SEGMENT_MATCH_ALL:2,AOF:{DEFAULT:0,SELECTROTATION_SEGMENT_MATCH_ALL:1}});
(function(){e.Sidewall=f.Class.create({EVENT_SET_DEFERRED_TIMER:"SET_DEFERRED_TIMER",EVENT_INVOKE_VIEW_DISPLAY:"INVOKE_VIEW_DISPLAY",callbackName:"ads_sidewall_callback",zoneIds:null,elementIds:null,adContainers:[],adContainerWidth:0,adContainerHeight:0,swf:{},count:1,isInterlock:!0,view:null,segments:null,impression:null,activatesAdjust:null,contentsWidth:0,margin:0,deferredSettings:{active:!1,deferredTimes:[],marginTimeBefore:300,marginTimeAfter:300,randomCoefficient:240,useDeferredTimeRange:{start:"20:00",
end:"23:59"},deferredProbability:0.5},setParameters:function(a){this.adContainerHeight=this.adContainerWidth=0;this.zoneIds=[].concat(a.zoneIds||[]);this.elementIds=[].concat(a.locations||[]);if(2!==this.zoneIds.length||2!==this.elementIds.length)throw Error("zoneIds and locations need both left and right.");this.impression="number"===typeof a.impression?a.impression:1;this.segments=a.segments||{};this.activatesAdjust="boolean"===typeof a.activatesAdjust?a.activatesAdjust:!0;this.adContainers=[document.getElementById(this.elementIds[0]),
document.getElementById(this.elementIds[1])];this.contentsWidth=a.contentsWidth;this.margin=a.margin||0;if("object"===typeof a.deferredSettings){var b=a.deferredSettings;"boolean"===typeof b.active&&(this.deferredSettings.active=b.active);"number"===typeof b.marginTimeBefore&&(this.deferredSettings.marginTimeBefore=b.marginTimeBefore);"number"===typeof b.marginTimeAfter&&(this.deferredSettings.marginTimeAfter=b.marginTimeAfter);"number"===typeof b.randomCoefficient&&(this.deferredSettings.randomCoefficient=
b.randomCoefficient);for(var c=[].concat(b.deferredTimes||[]),d=0,h=c.length;d<h;d++)if("object"===typeof c[d]&&"number"===typeof c[d].time&&"string"===typeof c[d].id)this.deferredSettings.deferredTimes.push(c[d]);else throw Error("Argument deferredTimes must be object. Argument deferredTimes[].time must be number. Argument deferredTimes[].id must be string.");if("object"===typeof b.useDeferredTimeRange){c=b.useDeferredTimeRange;if("string"===typeof c.start&&null!==c.start.match(/^[0-2][0-9]:[0-5][0-9]$/)&&
"24:00">c.start)this.deferredSettings.useDeferredTimeRange.start=c.start;else throw Error('Argument useDeferredTimeRange.start must be match this pattern "^[0-2][0-9]:[0-5][0-9]$".');if("string"===typeof c.end&&null!==c.end.match(/^[0-2][0-9]:[0-5][0-9]$/)&&"24:00">c.end)this.deferredSettings.useDeferredTimeRange.end=c.end;else throw Error('Argument useDeferredTimeRange.end must be match this pattern "^[0-2][0-9]:[0-5][0-9]$".');}if("number"===typeof b.deferredProbability)if(0<b.deferredProbability&&
1>=b.deferredProbability)this.deferredSettings.deferredProbability=b.deferredProbability;else throw Error("Argument deferredProbability must be more than 0");}if(this.deferredSettings.useDeferredTimeRange.start===this.deferredSettings.useDeferredTimeRange.end)throw Error("Argument useDeferredTimeRange.start and useDeferredTimeRange.end must be set to a different value. If want to enable all day, please set useDeferredTimeRange {'00:00','23:59'}");b=new f.InterlockContainerSetting("im",this.elementIds[0]);
b.setSlaveIds(this.elementIds[1]);b.setParam("wmode","transparent");c=new f.InterlockContainerSetting("is",this.elementIds[1]);c.setMasterId(this.elementIds[0]);c.setParam("wmode","transparent");this.swf={time:a.time||(new Date).getTime()+Math.floor(1E6*Math.random()),containerSettings:[b,c]};this.count="number"===typeof a.count?a.count:1;this.view=a.view&&a.view.display?a.view:new e.SidewallView;if(this.count!==e.ALL&&1!==this.count)throw Error("Argument count must be numeric 1 or Ads.ALL(-1).");
if(this.count===e.ALL&&2===this.impression)throw Error("You can not set [count: ALL] and [impression: 2] at a time.");},setContainerSettings:function(a,b){this.swf.containerSettings=[a,b]},adjust:function(){e.Sidewall.adContainers[0].style.width=0;e.Sidewall.adContainers[1].style.width=0;var a=Math.max(document.documentElement.clientWidth,document.body.clientWidth)-e.Sidewall.contentsWidth;if(!(0>=a)){var a=Math.floor(a/2),a=a>e.Sidewall.adContainerWidth?e.Sidewall.adContainerWidth:a,b=a+e.Sidewall.margin;
e.Sidewall.adContainers[0].style.display="block";e.Sidewall.adContainers[0].style.width=a+"px";e.Sidewall.adContainers[0].style.left=-b+"px";e.Sidewall.adContainers[1].style.display="block";e.Sidewall.adContainers[1].style.width=a+"px";e.Sidewall.adContainers[1].style.right=-b+"px"}},setAdjust:function(){e.Sidewall.activatesAdjust&&(f.Utility.addEvent(window,"resize",e.Sidewall.adjust),e.Sidewall.adjust())},invoke:function(){this.setAdjust();window[this.callbackName]=e.Sidewall.callback;var a=f.Utility.getPageUrl(),
b=f.Utility.getPageVariant(),a={zone:this.zoneIds.join(","),pageurl:a,pagevariant:b,aof:e.Option.AOF.DEFAULT,callback:this.callbackName};f.Utility.extend(a,this.segments);this.count===e.ALL?(a.aof|=e.Option.AOF.SELECTROTATION_SEGMENT_MATCH_ALL,f.Api.loadScript(e.pathBase+"/api/OxBannerService/getAllAdvertisements.jsonp?",a)):2===this.impression?f.Api.loadScript(e.pathBase+"/api/OxBannerService/getAdvertisementsAndLogImpression.jsonp?",a):f.Api.loadScript(e.pathBase+"/api/OxBannerService/getAdvertisements.jsonp?",
a)},setMaxWidth:function(a){for(var b=0,c=0,d=a.length;c<d;c++)parseInt(a[c].width||0,10)>b&&(b=parseInt(a[c].width,10));0<b&&(this.adContainerWidth=b)},setMaxHeight:function(a){for(var b=0,c=0,d=a.length;c<d;c++)parseInt(a[c].height||0,10)>b&&(b=parseInt(a[c].height,10));0<b&&(this.adContainerHeight=b)},callback:function(a){var b=a.data;if(0!==b.length&&0===b.length%2){e.Sidewall.setMaxWidth(b);e.Sidewall.setMaxHeight(b);e.Sidewall.activatesAdjust&&e.Sidewall.adjust();var c=b.splice(0,b.length/2),
d=[],h=f.Utility.map(b,function(a){return a.interlock_campaign_id}),g=f.Utility.map(c,function(a){return a.campaignid}),k=[];for(a=0;a<g.length;a++)-1===f.Utility.indexOf(h,g[a])&&k.push(g[a]);for(var g=[],l=0,h=c.length;l<h;l++)g[c[l].campaignid]=l;for(a in b)if(0==b[a].interlock_campaign_id)h=k.shift(),d.push(c[g[h]]);else for(l=0,h=c.length;l<h;l++)if(b[a].interlock_campaign_id==c[l].campaignid){d.push(c[l]);break}var m={left:e.Sidewall.getExtendedSidewall(0),right:e.Sidewall.getExtendedSidewall(1)},
n={left:d,right:b},b=e.Sidewall.deferredSettings;a=new Date;a=(10>a.getHours()?"0"+a.getHours():a.getHours())+":"+(10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes());h=b.useDeferredTimeRange;c=!1;if(h.end<h.start){if(h.start<=a||a<=h.end)c=!0}else h.start<=a&&a<=h.end&&(c=!0);if(b.active&&c){c=b.deferredTimes;d=!1;a=0;for(h=c.length;a<h;a++){var p="number"===typeof c[a].randomCoefficient?c[a].randomCoefficient:b.randomCoefficient,k="number"==typeof c[a].deferredProbability&&0<c[a].deferredProbability&&
1>=c[a].deferredProbability?c[a].deferredProbability:b.deferredProbability,g=c[a].time-("number"===typeof c[a].marginTimeBefore?c[a].marginTimeBefore:b.marginTimeBefore),l=c[a].time+("number"===typeof c[a].marginTimeAfter?c[a].marginTimeAfter:b.marginTimeAfter),q=(new Date).getTime()/1E3,p=1E3*Math.random()*p;if(g<=q&&q<l&&Math.random()<k){e.Sidewall.fireEvent(e.Sidewall.EVENT_SET_DEFERRED_TIMER,p);setTimeout(function(){e.Sidewall.fireEvent(e.Sidewall.EVENT_INVOKE_VIEW_DISPLAY);e.Sidewall.view.display(m,
n)},p);d=!0;break}}d||(e.Sidewall.fireEvent(e.Sidewall.EVENT_INVOKE_VIEW_DISPLAY),e.Sidewall.view.display(m,n))}else e.Sidewall.fireEvent(e.Sidewall.EVENT_INVOKE_VIEW_DISPLAY),e.Sidewall.view.display(m,n)}},getExtendedSidewall:function(a){var b={};f.Utility.extend(b,this);f.Utility.extend(b,{getElement:function(){return b.adContainers[a]},getSwfEmbedId:function(){return["sidewallad",a,""].join("_")},getContainerSettings:function(){return b.swf.containerSettings[a]},getSwfTime:function(){return b.swf.time}});
return b}});f.Class.mixin(e.Sidewall,f.Event)})();(function(){e.SidewallSwitchView=f.Class.create();f.Utility.extend(e.SidewallSwitchView.prototype,{switchViewLeft:null,switchViewRight:null,interval:0,second:0,responseLength:0,index:0,switchAdIntervalID:0,ignoreScreen:!1,ignoreFocus:!1,wasActive:!0,initialize:function(a){if(a&&"number"!==typeof a)throw Error("interval is not number.");if(0>a)throw Error("The interval must be greater than or equal to 0.");this.interval=a||30},setIgnoreScreen:function(){this.ignoreScreen=
!0;return this},setIgnoreFocus:function(){this.ignoreFocus=!0;return this},display:function(a,b){a.left&&(a.right&&b.left&&b.right)&&b.left.length===b.right.length&&(this.responseLength=b.left.length,this.switchViewLeft=new f.SidewallSwitchViewChild(a.left,b.left),this.switchViewRight=new f.SidewallSwitchViewChild(a.right,b.right),this.show(),this.startSwitchAdTimer())},startSwitchAdTimer:function(){var a=this;this.switchAdIntervalID=setInterval(function(){a.switchAdTimerHandler()},1E3)},switchAdTimerHandler:function(){if(this.switchViewLeft.isZombie()||
this.switchViewRight.isZombie())this.stopSwitchAdTimer(),this.switchViewLeft.destroy(),this.switchViewRight.destroy();else{var a=this.isActive();a&&1<this.responseLength&&this.second++>=this.interval&&this.switchNext();this.wasActive!==a&&((this.wasActive=a)?(this.switchViewLeft.callSWFPlay(),this.switchViewRight.callSWFPlay()):(this.switchViewLeft.callSWFPause(),this.switchViewRight.callSWFPause()))}},stopSwitchAdTimer:function(){clearInterval(this.switchAdIntervalID)},isActive:function(){return(this.switchViewLeft.isScreen()&&
this.switchViewRight.isScreen()||this.ignoreScreen)&&(f.Utility.hasFocus()||this.ignoreFocus)?!0:!1},switchNext:function(){var a=this;a.second=0;setTimeout(function(){a.show()},500)},show:function(){var a=(new Date).getTime()+Math.floor(1E6*Math.random());this.switchViewLeft.showAd(this.index,a);this.switchViewRight.showAd(this.index,a);this.index===this.responseLength-1?this.index=0:this.index++}})})();(function(){f.SidewallSwitchViewChild=f.Class.create();f.Utility.extend(f.SidewallSwitchViewChild.prototype,
{advertisement:null,responses:null,canvas:null,time:null,template:null,initialize:function(a,b){1>b.length||(this.advertisement=a,this.responses=b,this.canvas=document.createElement("div"),this.canvas.id=this.advertisement.getElement().id+"_child",this.advertisement.getElement().appendChild(this.canvas))},initCanvas:function(a){a.getWidth()&&a.getHeight()&&(this.canvas.style.width=a.getWidth()+"px",this.canvas.style.height=a.getHeight()+"px");this.canvas.innerHTML=""},showAd:function(a,b){if("number"===
typeof a&&"number"===typeof b&&!(a>this.responses.length-1)){var c=this.responses[a];this.advertisement.swf.time=b;this.template=new f.Template(this.advertisement,c);this.initCanvas(this.template);e.AdContainerConnector.clearMemberVariable(this.advertisement.getSwfEmbedId());f.Utility.updateElement(this.canvas,this.template.getString());1===this.advertisement.impression&&f.Api.logImpression(c.bannerid,c.zoneid,this.logimpressionCallback);c.optional&&(document.body.style.backgroundColor=c.optional)}},
isScreen:function(){var a=this.advertisement.getElement();if("fixed"===(a.currentStyle||m.getComputedStyle(a,null)).position)return!0;var a=f.Utility.getScroll(),b=f.Utility.isBackCompat?{width:document.body.clientWidth||window.innerWidth,height:document.body.clientHeight||window.innerHeight}:{width:document.documentElement.clientWidth||window.innerWidth,height:document.documentElement.clientHeight||window.innerHeight},c=this.canvas;if(!this.advertisement.activatesAdjust&&b.width<=this.advertisement.contentsWidth)return!1;
var d=c.currentStyle||m.document.defaultView.getComputedStyle(c,null);if(d.position&&"fixed"===d.position)return!0;d=this.advertisement.getElement();d=d.currentStyle||m.document.defaultView.getComputedStyle(d,null);if(d.position&&"fixed"===d.position)return!0;var d=c,e=0,g=0,k=0,l=0;do e+=d.offsetTop||0,g+=d.offsetLeft||0;while(d=d.offsetParent);k=g+c.offsetWidth;l=e+c.offsetHeight;return 0===this.advertisement.getElement().clientWidth||k<=a.left||l<=a.top||g>=b.width+a.left||e>=b.height+a.top?!1:
!0},logimpressionCallback:function(a){if(!a.success&&a.message)throw Error(a.message);},callSWFPause:function(){null!==this.template&&this.template.isSwf()&&e.AdContainerConnector.callContentPause(this.advertisement.getSwfEmbedId())},callSWFPlay:function(){null!==this.template&&this.template.isSwf()&&e.AdContainerConnector.callContentPlay(this.advertisement.getSwfEmbedId())},isZombie:function(){var a=this.canvas;do if("BODY"===a.nodeName)return!1;while(a=a.parentNode);return!0},destroy:function(){this.canvas.innerHTML=
"";this.canvas=null}})})();(function(){e.SidewallView=f.Class.create();f.Utility.extend(e.SidewallView.prototype,{frequency:null,initialize:function(){this.frequency=new f.Frequency},display:function(a,b){a.left&&(a.right&&b.left&&b.right)&&b.left.length===b.right.length&&(this.setAd(a.left,b.left[0]),this.setAd(a.right,b.right[0]))},setAd:function(a,b){this.frequency.checkFrequency(b)&&(f.Utility.updateElement(a.getElement(),(new f.Template(a,b)).getString()),1===a.impression&&f.Api.logImpression(b.bannerid,
b.zoneid,this.logimpressionCallback),b.optional&&(document.body.style.backgroundColor=b.optional))},logimpressionCallback:function(a){if(!a.success&&a.message)throw Error(a.message);}})})();(function(){e.SwitchView=f.Class.create();f.Class.mixin(e.SwitchView.prototype,f.Event);f.Utility.extend(e.SwitchView.prototype,{EVENT_AD_VISIBLE:"EVENT_VISIBLE_AD",EVENT_AD_INVISIBLE:"EVENT_INVISIBLE_AD",advertisement:null,responses:null,index:0,second:0,interval:0,canvas:null,prevVisibility:!0,ignoreScreen:!1,
ignoreFocus:!1,backgroundColor:null,switchAdIntervalID:0,activeVisibilityEvent:!1,eVisible:!0,activeSingleRotation:!1,initialize:function(a,b){if(a&&"number"!==typeof a)throw Error("interval is not number.");this.interval=a||30;this.backgroundColor="string"===typeof b?b:"#efefef";this.addListener(this.EVENT_AD_VISIBLE,function(){this.eVisible=!0},this);this.addListener(this.EVENT_AD_INVISIBLE,function(){this.eVisible=!1},this)},setIgnoreScreen:function(){this.ignoreScreen=!0;return this},setIgnoreFocus:function(){this.ignoreFocus=
!0;return this},setActiveVisibilityEvent:function(){this.activeVisibilityEvent=!0;return this},setActiveSingleRotation:function(){this.activeSingleRotation=!0;return this},display:function(a,b){this.setting(a,b);if(!0===this.activeSingleRotation||!1===this.activeSingleRotation&&1<b.length){var c=this;this.switchAdIntervalID=setInterval(function(){c.isZombie()?c.destroy():c.isActive()&&c.switchNext()},1E3)}},stopSwitchAdTimer:function(){clearInterval(this.switchAdIntervalID)},setting:function(a,b){this.advertisement=
a;this.responses=b;this.canvas=document.createElement("div");this.advertisement.getElement().appendChild(this.canvas);var c=this.getNextResponse();this.initCanvas(c);this.show(c)},getNextResponse:function(){return this.responses[this.index++%this.responses.length]},switchNext:function(){var a=this.getNextResponse();this.initCanvas(a);var b=this;setTimeout(function(){b.show(a);b.second=0},500)},initCanvas:function(a){a=new f.Template(this.advertisement,a);a.getWidth()&&a.getHeight()&&(this.canvas.style.width=
a.getWidth()+"px",this.canvas.style.height=a.getHeight()+"px");a.isText()||(this.canvas.style.backgroundColor=this.backgroundColor);this.canvas.innerHTML=""},show:function(a){this.canvas.innerHTML=(new f.Template(this.advertisement,a)).getString();1===this.advertisement.impression&&(-1!==f.Utility.indexOf(this.advertisement.option,e.Option.RCP)?f.Api.logImpressionForRcp(a.bannerid,a.zoneid,this.advertisement.video||"",this.logimpressionCallback):f.Api.logImpression(a.bannerid,a.zoneid,this.logimpressionCallback))},
isActive:function(){var a;a=this.activeVisibilityEvent?this.eVisible:this.isScreen()&&(f.Utility.hasFocus()||this.ignoreFocus);return this.prevVisibility!==a&&(this.prevVisibility=a)?!0:this.prevVisibility&&this.isIntervalPass()},isIntervalPass:function(){return this.second<this.interval?(this.second++,!1):!0},isScreen:function(){if(this.ignoreScreen)return!0;for(var a=this.canvas,b=a;b.parentNode;b=b.parentNode)if("none"===b.style.display)return!1;var b=f.Utility.getScroll(),c=f.Utility.isBackCompat?
{width:document.body.clientWidth||window.innerWidth,height:document.body.clientHeight||window.innerHeight}:{width:document.documentElement.clientWidth||window.innerWidth,height:document.documentElement.clientHeight||window.innerHeight},d=a,e=0,g=0,k=0,l=0;do e+=d.offsetTop||0,g+=d.offsetLeft||0;while(d=d.offsetParent);k=g+a.offsetWidth;l=e+a.offsetHeight;return k<b.left||l<b.top||g>c.width+b.left||e>c.height+b.top?!1:!0},logimpressionCallback:function(a){if(!a.success&&a.message)throw Error(a.message);
},isZombie:function(){var a=this.canvas;do if("BODY"===a.nodeName)return!1;while(a=a.parentNode);return!0},destroy:function(){this.stopSwitchAdTimer();this.canvas.innerHTML="";this.canvas=null}})})();(function(){f.Template=f.Class.create();f.Utility.extend(f.Template.prototype,{advertisement:null,response:null,flashVars:null,initialize:function(a,b){this.advertisement=a;this.response=b;this.flashVars={};this.videoTagCount=0},getTag:function(){var a=null;if(this.isVideo()&&f.Utility.canPlayMp4()){var b=
"ads_video_id_"+this.getRandomId();navigator&&navigator.userAgent&&(a='<div style="position: relative; width: '+this.getWidth()+"px; height: "+this.getHeight()+'px; background-color: #000;">',a=-1!==navigator.userAgent.toLowerCase().indexOf("firefox")?a+this.linkWithEvent(this.getVideoMaskTagForFirefox(),"onclick=\"(function() {document.getElementById('"+b+"').pause();})();\"")+this.getTagForVideo(b)+"</div>":navigator.userAgent.toLowerCase().match("ie 9.0.*trident/5.0")?'<div style="position: relative;">'+
this.linkWithEvent(this.getVideoMaskTagForIE9(),"onclick=\"(function() {document.getElementById('"+b+"').pause();})();\"")+this.getTagForIE9Video(b)+"</div>":a+this.linkWithEvent(this.getTagForVideo(b),"onclick=\"(function() {document.getElementById('"+b+"').pause();})();\""))}else this.isText()?a=this.link(this.getBannertext()):this.isImage()?a=this.link(this.getTagForImage()):this.isSwf()&&this.advertisement.isInterlock?a=this.getTagForInterlockSwf():this.isSwf()?a=this.getTagForSwf():this.isHtml()&&
(a=this.getTagForHtml());return a},getRandomId:function(){for(var a="",b=0;5>b;b++)a+="ABCDEFGHIJKLMNOPQURSTUVWXYZabcdefghijklmnopqurstuvwxyz".charAt(Math.floor(54*Math.random()));return a+"_"+(new Date).getTime()},getBannertext:function(){return this.response.bannertext||""},getAppend:function(){return this.response.append||""},getTagForImage:function(){var a;a='<img src="%IMAGE_PATH%" alt="%BANNERTEXT%" width="%WIDTH%" height="%HEIGHT%" border="0" />'.replace("%IMAGE_PATH%",this.getImagePath());
a=a.replace("%BANNERTEXT%",this.getBannertext());a=a.replace("%WIDTH%",this.getWidth());return a=a.replace("%HEIGHT%",this.getHeight())},getTagForSwf:function(){var a=new r(this.getImagePath(),(new Date).getTime()+Math.floor(1E6*Math.random()),this.getWidth(),this.getHeight());this.setFlashVars("clickTAG",this.getClickPath());this.advertisement.migiue&&this.setFlashVars("migiue",this.advertisement.migiue);for(var b in this.flashVars)a.addVariable(b,encodeURIComponent(this.flashVars[b]));a.addParam("wmode",
"opaque");return a.getSWFHTML()+" "},getVideoMaskTagForFirefox:function(){var a;a='<img style="position: absolute; width:%WIDTH%px; height:%HEIGHT%px; z-index: 1; border: none;">'.replace("%WIDTH%",this.getWidth());return a=a.replace("%HEIGHT%",this.getHeight()-25)},getVideoMaskTagForIE9:function(){var a;a='<img src="data:image/gif;base64,R0lGODlhAQABAJEAAAAAAP///////wAAACH5BAEHAAIALAAAAAABAAEAAAICVAEAOw==" style="position: absolute; width:%WIDTH%px; height:%HEIGHT%px; z-index: 1; border: none;">'.replace("%WIDTH%",
this.getWidth());return a=a.replace("%HEIGHT%",this.getHeight()-44)},getTagForVideo:function(a){a=('<video id="'+a+'" width="%WIDTH%" height="%HEIGHT%" autoplay muted controls style="background-color: #000; z-index: 0; display: none;" oncanplay="(function () { document.getElementById(\''+a+'\').style.display = \'block\';})()"><source src="%IMAGEURL%" type="video/mp4"></video>').replace("%WIDTH%",this.getWidth());a=a.replace("%HEIGHT%",this.getHeight());return a=a.replace("%IMAGEURL%",this.getImageUrl())},
getTagForIE9Video:function(a){a=('<video poster="data:image/gif;base64,R0lGODlhAQABAJEAAAAAAP///////wAAACH5BAEHAAIALAAAAAABAAEAAAICVAEAOw==" id="'+a+'" width="%WIDTH%" height="%HEIGHT%" autoplay controls style="background-color: #000; z-index: 0; display: none;" oncanplay="(function () { document.getElementById(\''+a+"').style.display = 'block'; document.getElementById('"+a+'\').muted = true;})()"><source src="%IMAGEURL%" type="video/mp4"></video>').replace("%WIDTH%",this.getWidth());a=a.replace("%HEIGHT%",
this.getHeight());return a=a.replace("%IMAGEURL%",this.getImageUrl())},setFlashVars:function(a,b){this.flashVars[a]=b},getTagForHtml:function(){var a="",a=navigator&&navigator.userAgent&&-1===navigator.userAgent.toLowerCase().indexOf("firefox")?'<iframe src="%TEXT_PATH%" vspace="0" hspace="0" marginwidth="0" marginheight="0" width="%WIDTH%" height="%HEIGHT%" frameborder="0" scrolling="no" allowTransparency="true" noresize></iframe>':'<object data="%TEXT_PATH%" vspace="0" hspace="0" marginwidth="0" marginheight="0" type="text/html" width="%WIDTH%" height="%HEIGHT%" border="0"></object>',
a=a.replace("%TEXT_PATH%",this.getBannertextPath()),a=a.replace("%WIDTH%",this.getWidth());return a=a.replace("%HEIGHT%",this.getHeight())},getTagForInterlockSwf:function(){var a=e.pathBase+"/assets/swf/adContainer-2.0.0.swf";e.isDebugMode&&(a+="?"+(new Date).getTime());a=new r(a,this.getSwfEmbedId(),this.getWidth(),this.getHeight());a.addVariable("defaultWidth",this.getWidth());a.addVariable("defaultHeight",this.getHeight());a.addVariable("clickTAG",encodeURIComponent(this.getClickPath()));a.addVariable("file",
encodeURIComponent(this.getImagePath()));a.addVariable("x","0");a.addVariable("now",this.getSwfTime());a.addParam("AllowScriptAccess","always");var b=this.getContainerSettings();if("function"===typeof b.getVariable){var c=b.getVariable(),d;for(d in c)c.hasOwnProperty(d)&&a.addVariable(d,c[d])}if("function"===typeof b.getParam)for(d in b=b.getParam(),b)b.hasOwnProperty(d)&&a.addParam(d,b[d]);return a.getSWFHTML()},getSwfEmbedId:function(){return this.advertisement.hasOwnProperty("getSwfEmbedId")?this.advertisement.getSwfEmbedId():
""},getSwfTime:function(){return this.advertisement.hasOwnProperty("getSwfTime")?this.advertisement.getSwfTime():0},getContainerSettings:function(){return this.advertisement.hasOwnProperty("getContainerSettings")?this.advertisement.getContainerSettings():{}},getImagePath:function(){return e.pathBase+"/assets/images/"+this.response.filename},getClickPath:function(){return e.pathBase+"/click?"+f.Utility.toQueryString({bannerid:this.response.bannerid,zoneid:this.response.zoneid})},getBannertextPath:function(){return e.pathBase+
"/bannertext?"+f.Utility.toQueryString({bannerid:this.response.bannerid})},getImageUrl:function(){return this.response.imageurl},getWidth:function(){return 0<parseInt(this.response.width||0,10)?parseInt(this.response.width||0,10):parseInt(this.advertisement.getElement().offsetWidth||0,10)},getHeight:function(){return 0<parseInt(this.response.height||0,10)?parseInt(this.response.height,10):parseInt(this.advertisement.getElement().offsetHeight||0,10)},link:function(a){var b;b='<a href="%CLICK_PATH%" target="_blank">%HTML%</a>'.replace("%CLICK_PATH%",
this.getClickPath());return b=b.replace("%HTML%",a)},linkWithEvent:function(a,b){var c;c=("<a "+b+' href="%CLICK_PATH%" target="_blank">%HTML%</a>').replace("%CLICK_PATH%",this.getClickPath());return c=c.replace("%HTML%",a)},isImage:function(){return"gif"===this.response.contenttype||"jpeg"===this.response.contenttype||"png"===this.response.contenttype},isText:function(){return"txt"===this.response.contenttype},isSwf:function(){return"swf"===this.response.contenttype},isHtml:function(){return"html"===
this.response.contenttype},isVideo:function(){return"mp4"===this.response.contenttype&&""!=this.getImageUrl()},getString:function(){return"function"===typeof this.advertisement.template?(this.getString=function(){return this.getTag()},this.advertisement.template.apply(this)):this.getTag()}})})();(function(){e.View=f.Class.create();f.Utility.extend(e.View.prototype,{advertisement:null,responses:[],display:function(a,b){this.advertisement=a;this.responses=b;for(var c=0;c<b.length;c++){var d=(new f.Template(a,
b[c])).getString();if(!d)break;f.Utility.updateElement(a.getElement(),d);1===a.impression&&(-1!==f.Utility.indexOf(a.option,e.Option.RCP)?f.Api.logImpressionForRcp(b[c].bannerid,b[c].zoneid,a.video||"",this.logimpressionCallback):f.Api.logImpression(b[c].bannerid,b[c].zoneid,this.logimpressionCallback))}},update:function(){var a=this.advertisement.getElement();a&&a.innerHTML&&(a.innerHTML="");this.advertisement.set(this.advertisement.elementId,this.advertisement.template)},logimpressionCallback:function(a){if(!a.success&&
a.message)throw Error(a.message);}})})();(function(){e.AdContainerConnector=f.Class.create({contentsLoadState:[],bufferedMethod:{},clearMemberVariable:function(a){if("undefined"===typeof a)throw Error("\u5f15\u6570 id \u306f\u5fc5\u9808\u3067\u3059");var b=f.Utility.indexOf(e.AdContainerConnector.contentsLoadState,a);-1!==b&&e.AdContainerConnector.contentsLoadState.splice(b,1);e.AdContainerConnector.bufferedMethod.hasOwnProperty(a)&&delete e.AdContainerConnector.bufferedMethod[a]},callbackContentLoadComplete:function(a){if("undefined"===
typeof a)throw Error("\u5f15\u6570 id \u306f\u5fc5\u9808\u3067\u3059");e.AdContainerConnector.contentsLoadState.push(a);e.AdContainerConnector.doBufferedMethod(a);return!0},setBufferMethod:function(a,b){if("undefined"===typeof a)throw Error("\u5f15\u6570 id \u306f\u5fc5\u9808\u3067\u3059");if("function"!==typeof b)throw Error("\u5f15\u6570 method \u306f Function\u578b \u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002");"[object Array]"!==Object.prototype.toString.call(e.AdContainerConnector.bufferedMethod[a])&&
(e.AdContainerConnector.bufferedMethod[a]=[]);e.AdContainerConnector.bufferedMethod[a].push(b)},removeBufferedMethod:function(a,b){if("undefined"===typeof a)throw Error("\u5f15\u6570 id \u306f\u5fc5\u9808\u3067\u3059");if("function"!==typeof b)throw Error("\u5f15\u6570 method \u306f Function\u578b \u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002");if("[object Array]"===Object.prototype.toString.call(e.AdContainerConnector.bufferedMethod[a])){var c=f.Utility.indexOf(e.AdContainerConnector.bufferedMethod[a],
b);if(-1!==c)return e.AdContainerConnector.bufferedMethod[a].splice(c,1)}return null},doBufferedMethod:function(a){if("undefined"===typeof a)throw Error("\u5f15\u6570 id \u306f\u5fc5\u9808\u3067\u3059");if("undefined"!==typeof e.AdContainerConnector.bufferedMethod[a]){for(var b=[],c=0,d=e.AdContainerConnector.bufferedMethod[a].length;c<d;c++){var f=e.AdContainerConnector.bufferedMethod[a].shift();Boolean(f())||b.push(f)}e.AdContainerConnector.bufferedMethod[a]=b}},callContentPlay:function(a){if("undefined"===
typeof a)throw Error("\u5f15\u6570 id \u306f\u5fc5\u9808\u3067\u3059");if(-1!==f.Utility.indexOf(e.AdContainerConnector.contentsLoadState,a)){var b=f.Utility.getElementFromNameForSWF(a);if(null!==b){var c;try{c=b.contentPlay()}catch(d){c=!1}return c}}e.AdContainerConnector.setBufferMethod(a,function(){return e.AdContainerConnector.callContentPlay(a)});return!1},callContentPause:function(a){if("undefined"===typeof a)throw Error("\u5f15\u6570 id \u306f\u5fc5\u9808\u3067\u3059");if(-1!==f.Utility.indexOf(e.AdContainerConnector.contentsLoadState,
a)){var b=f.Utility.getElementFromNameForSWF(a);if(null!==b){var c;try{c=b.contentPause()}catch(d){c=!1}return c}}e.AdContainerConnector.setBufferMethod(a,function(){return e.AdContainerConnector.callContentPause(a)});return!1}})})();f.Utility.setup()})();
