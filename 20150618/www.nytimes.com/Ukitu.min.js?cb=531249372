(function(e,t,n){function Y(){var e=function(){},t=function(t,n,r){var i;return n&&n.hasOwnProperty("constructor")?i=n.constructor:i=function(){return t.apply(this,arguments)},f(i,t),e.prototype=t.prototype,i.prototype=new e,n&&f(i.prototype,n),r&&f(i,r),i.prototype.constructor=i,i.__super__=t.prototype,i};return function(e,n){var r=t(this,e,n);return r.extend=Y(),r}}var r=e.FLITE,s=e.F,o=r._,u=o.contains,a=o.each,f=o.extend,c=o.filter,h=o.keys,p=o.values,d=o.map,v=r.Metrics,m=r.URLFactory,g=o.is&&o.is.browser||{},y=o.is&&o.is.platform||{},b=new s.ScriptHelper(t.getElementsByTagName("body")[0]),w="wbx_thumb",E=1e3/30,S=["x","y","width","height","alpha","rotation","scale"],x=["backgroundColor","borderColor","borderThickness","cornerRadius"],T={borderThickness:"borderWidth",cornerRadius:"borderRadius"},N={b:"boolean",f:"function",n:"number",o:"object",s:"string",u:"undefined"},C={h:"hidden",v:"visible",a:"auto",s:"scroll"},k={x:0,y:0,width:100,height:100,scale:1,rotation:0,alpha:1},L="a440818a-3051-4e9c-b807-848028ad3b17";e.bind=e.addEventListener,e.unbind=e.removeEventListener;var A=setInterval,O=setTimeout,M=[],_=[],D=function(e,t){return function(n,r){var i=Array.prototype.slice.call(arguments,2),s=e(function(){try{n.apply(this,i)}catch(e){}},r);return t.push(s),s}};e.setInterval=D(A,M),e.setTimeout=D(O,_);var P=function(){a(M,function(e){clearInterval(e)}),a(_,function(e){clearTimeout(e)})},H={editor:!1,studio:!1,location:v&&v.getWindowLocation&&v.getWindowLocation()||e.location,mobile:function(){return y.ios||y.android}(),retina:e.devicePixelRatio>1,touch:"ontouchstart"in e,touchPreview:!1,prefix:function(){var e=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,n="",r=t.getElementsByTagName("script")[0].style;for(var i in r)if(e.test(i)){n=i.match(e)[0];break}return n||"WebkitOpacity"in r&&(n="Webkit"),n||"KhtmlOpacity"in r&&(n="Khtml"),n.toLowerCase()}(),secure:o&&o.is&&o.is.secureLocation&&o.is.secureLocation(),coppa:!1,screenshot:!1};H.stylePrefix=H.prefix?["-",H.prefix,"-"].join(""):"";var B=function(e){return e&&e.nodeType&&e.nodeType===1},j=function(e,t,n,r,i,s){return n=n||t,r=r||"%v",function(o){return N.u!==typeof o&&e[t]!==o&&(o=parseFloat(o),e[t]=o,e.css(n,r.replace(/%v/gi,o)),u(["_width","_height"],t)&&e.trigger(ut.events.RESIZE)),e[t]||i&&i[s]||parseInt(e.css(n)||0,10)}},F=function(e,t){return function(n){if(N.u!==typeof n){e[t]=n;var r=Math.floor(parseFloat(e._x)),i=Math.floor(parseFloat(e._offsetX)),s=Math.floor(parseFloat(e._y)),o=Math.floor(parseFloat(e._offsetY)),u=parseFloat(e._rotation),a=parseFloat(e._scale),f="",l="",c="rotate("+u+"deg)";H.editor||g.chrome&&g.version===32||!y.ios&&!y.android&&!g.webkit&&!g.firefox?(f="translate("+(r+i)+"px, "+(s+o)+"px)",l="scale("+a+","+a+")"):(f="translate3d("+(r+i)+"px, "+(s+o)+"px, 0px)",l="scale3d("+a+","+a+",1)"),e.css("transform",[f,c,l].join(" ").trim());if(g.msie&&g.version<=9){var h=e.dom.className;e.dom.className="",e.dom.className=h}}return e[t]}},I=function(e,t){t=N.u===typeof t?1:t;var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),t]:null},q=function(e){return e&&(e=e.trim(),e.indexOf("#")===-1&&(e=["#",e].join(""))),e},R=function(e){return e&&(N.b===typeof e||N.s===typeof e&&e.toLowerCase()==="true"||!isNaN(parseFloat(e))&&parseFloat(e)!==0)},U=function(e,t,n,r){return r=N.u===typeof r?!0:r,r?e>=t&&e<=n:e>t&&e<n},z=function(e,t){return N.f===typeof t&&e instanceof t},W=function(e,t){return o.bind(t,e)},X=function(e){var t={},n=e&&e.configParams;if(n){var r=h(n);a(r,function(e){t[e]=n[e].valueMap||n[e].value})}return t},V=function(e,t){return t=t.replace(/\\\./g,"#DELIM#"),t=t.split("."),a(t,function(t){e&&(t=t.replace(/\#DELIM\#/,"."),e=e[t])},this),e},$=function(e,n){var r=t.createElement("a");r.setAttribute("href",e),r.setAttribute("target",n);var i;t.createEvent?(i=t.createEvent("MouseEvents"),i.initEvent("click",!0,!0),i.eventName="click",g.msie&&!i.isTrusted?location.href=e:r.dispatchEvent(i)):t.createEventObject&&(i=t.createEventObject(),r.fireEvent("onclick",i))},J=function(e){var t=e;try{t=decodeURIComponent(e)}catch(n){}return!t.match(/^tel\:/i)&&!t.match(/^mailto\:/i)&&!t.match(/^sms\:/i)&&!t.match(/\/\//i)&&!t.match(/https?\:/i)&&(e=["http://",e].join("")),e},K=function(e){var t=e.split("-");return e=t[0],t=d(t.splice(1),function(e){return e.charAt(0).toUpperCase()+e.substr(1)}),e+t.join("")},Q=function(e,n){var r=t.elementFromPoint(e,n);if(r){var i=At.containers[r.id];while(!i&&r.parentNode)r=r.parentNode,i=At.containers[r.id];return i}},G={EVENTS:{MESSAGE:"message"},eventListeners:{},bind:function(t,n,r){if(!this.EVENTS.hasOwnProperty(t.toUpperCase()))return;this.eventListeners[t]||(this.eventListeners[t]={numComponents:0},e.bind(t,this.windowEvent_RECEIVED)),this.eventListeners[t][r]||(this.eventListeners[t][r]=[],++this.eventListeners[t].numComponents),this.eventListeners[t][r].push(n)},unbind:function(t,n,r){if(!this.eventListeners[t]||!this.eventListeners[t][r]||!u(this.eventListeners[t][r],n))return;this.eventListeners[t][r].splice(this.eventListeners[t][r].indexOf(n),1),this.eventListeners[t][r].length===0&&(delete this.eventListeners[t][r],--this.eventListeners[t].numComponents===0&&(delete this.eventListeners[t],e.unbind(t,this.windowEvent_RECEIVED)))},windowEvent_RECEIVED:function(e){var t=JSON.parse(e.data).componentKey;if(!this.eventListeners[e.type][t])return;this.obscureWindowObject(e),a(this.eventListeners[e.type][t],function(t){t(e)},this)},obscureWindowObject:function(e){delete e.source,delete e.srcElement,delete e.target,delete e.currentTarget}};G.windowEvent_RECEIVED=W(G,G.windowEvent_RECEIVED);var Z=function(){};Z.extend=Y();var et=Z.extend({element:null,style:null,_filter:null,_svgBlur:null,constructor:function(e){this.element=e,this.style=e&&e.style,this._filter={}},setStyle:function(e,t){if(this.style)if(e in et.fn)et.fn[e].set.call(this,t);else if(e in this.style)this.style[e]=t;else if("setProperty"in this.style){try{this.style.setProperty(e,t)}catch(n){}if(H.stylePrefix)try{this.style.setProperty([H.stylePrefix,e].join(""),t)}catch(n){}}},getStyle:function(t){var n="";this.style&&(t in et.fn?n=et.fn[t].get.call(this):t in this.style?n=this.style[t]:"getPropertyValue"in this.style&&(n=this.style.getPropertyValue(t)||this.style.getPropertyValue([H.stylePrefix,t].join(""))||""));if(N.u===typeof n){var r=e.getComputedStyle(this.element.dom);n=r&&r[t]||n}return n},hasStyle:function(e){return this.style&&(e in et.fn||K(e)in this.style||K([H.stylePrefix,e].join(""))in this.style||K([H.prefix,e].join("-"))in this.style)},buildFilterValue:function(){var e=[];return a(this._filter,function(t,n){e.push(n,"(",t,") ")}),e.join("").trim()},determineGradientAngle:function(e){var t="";return U(e,0,44,!0)||e===360?t="0% 50%, 100% 50%":U(e,45,89,!0)?t="0% 100%, 100% 0%":U(e,90,134)?t="50% 100%, 50% 0%":U(e,135,179)?t="100% 100%, 0% 0%":U(e,180,224)?t="100% 50%, 0% 50%":U(e,225,269)?t="100% 0%, 0% 100%":U(e,270,314)?t="50% 0%, 50% 100%":U(e,315,359)&&(t="0% 0%, 100% 100%"),t},_createBlurSVG:function(e){if(!this._svgBlur){var n=t.createElement("svg");n.id="svgBlur",t.body.appendChild(n),this._svgBlur=n}this._svgBlur.innerHTML=['<svg version="1.1" xmlns="http://www.w3.org/2000/svg" height="0" width="0">',"<defs>",'<filter id="svgBlurFilter" x="0" y="0">','<feGaussianBlur stdDeviation="'+e+'" />',"</filter>","</defs>","</svg>"].join("")}},{fn:{gradient:{set:function(e){if(e===""||e==="none")g.msie&&g.version<=9?this.style.removeProperty("background-color"):this.style.removeProperty("background-image");else{var t=e.type&&e.type.toLowerCase()||"linear",n=e.angle||0,r=e.position||"50% 50%",i=e.from||"#FFF",s=e.to||"#000",o="",u="",a=H.stylePrefix;g.msie&&g.version<=9?this.setStyle("background-color",i):(g.msie&&(a="",n=90-n),o=a+t+"-gradient("+(t==="linear"?n+"deg":r)+", "+i+", "+s+")",y.android&&(u=t==="linear"?this.determineGradientAngle(n):r+", 0, "+r+", "+Math.max(this.element.width(),this.element.height()),o=a+"gradient("+t+","+u+", from("+i+"), to("+s+"))"),this.setStyle("background-image",o),this.setStyle("background-size","100%"))}},get:function(){return g.msie&&g.version<=9?this.getStyle("background-color"):this.getStyle("background-image")}},shadow:{set:function(e){(!g.msie||g.msie&&g.version>=10)&&this.setStyle("text-shadow",e.horizontal+" "+e.vertical+" "+e.radius+" "+e.color)},get:function(){return!g.msie||g.msie&&g.version>=10?this.getStyle("text-shadow"):""}},alpha:{set:function(e){g.msie&&g.version<=8?(this._filter.alpha="opacity="+parseFloat(e)*100,this.setStyle("filter",this.buildFilterValue())):this.setStyle("opacity",e)},get:function(){return g.msie&&g.version<=8?parseInt(this._filter.alpha||100,10)/100:this.getStyle("opacity")}},blur:{set:function(e){g.msie&&g.version<=9?(this._filter.blur="add=0,direction=270,strength="+e,this.setStyle("filter",this.buildFilterValue())):g.gecko||g.msie&&g.version==10?(this._createBlurSVG(e),this.setStyle("filter","url(#svgBlurFilter)")):(this._filter.blur=e+"px",this.setStyle(H.stylePrefix+"filter",this.buildFilterValue()))},get:function(){var e;return g.msie&&g.version<=9?e=this._filter.blur&&this._filter.blur.split(",")[2].substr(9):g.gecko||g.msie&&g.version==10?e=this._svgElement&&this._svgElement.getElementsByTagName("feGaussianBlur")[0].getAttribute("stdDeviation"):e=parseFloat(this._filter.blur||0),e||0}},grayscale:{set:function(e){this._filter.grayscale=e,this.setStyle(H.stylePrefix+"filter",this.buildFilterValue())},get:function(){return parseFloat(this._filter.grayscale||0)}},sepia:{set:function(e){this._filter.sepia=e,this.setStyle(H.stylePrefix+"filter",this.buildFilterValue())},get:function(){return parseFloat(this._filter.sepia||0)}},saturate:{set:function(e){this._filter.saturate=e,this.setStyle(H.stylePrefix+"filter",this.buildFilterValue())},get:function(){return parseFloat(this._filter.saturate||0)}},borderRadius:{set:function(e){this.setStyle("border-radius",e),parseFloat(e)>0&&(g.safari?this.setStyle("mask-image","-webkit-linear-gradient(black, black)"):this.setStyle("mask-image",""))},get:function(){return parseFloat(this.getStyle("border-radius"))}}}}),tt=Z.extend({__listeners__:null,__enabled__:!0,bind:function(e,t){N.s===typeof e&&(e=e.split(" "));if(!o.isArray(e))throw"Cannot bind, invalid argument";var n=this.__listeners__||(this.__listeners__={});a(e,function(e){n[e]||(n[e]=[]),(!this.bound(e)||!o.find(n[e],function(e){return e===t}))&&n[e].push(t)},this)},unbind:function(e,t){N.s===typeof e&&(e=e.split(" "));if(!o.isArray(e))throw"Cannot unbind, invalid argument";a(e,function(e){var n=this.__listeners__&&this.__listeners__[e];n&&n.length>0&&(t?this.__listeners__[e]=c(n,function(e){return e!==t}):this.__listeners__[e]=[])},this)},trigger:function(e,t){if(!this.__enabled__)return;var n=this;N.s===typeof e&&(e={type:e}),e.target=e.target||n,e.currentTarget=n,e.halt=W(e,n.__halt__);var r=e.type&&n.__listeners__&&n.__listeners__[e.type];r&&r.length>0&&a(r,function(t){t.call(null,e)},n);if(t&&!e._doHalt&&n.parent&&n.parent.trigger)try{n.parent.trigger.call(n.parent,e,t)}catch(i){}},bound:function(e){return this.__listeners__&&this.__listeners__[e]&&this.__listeners__[e].length>0},getCallbacksForEventType:function(e){if(!this.bound(e))return[];[].concat(this.__listeners__[e])},enabled:function(e){return N.u!==typeof e&&(this.__enabled__=e),this.__enabled__},__halt__:function(){this._doHalt=!0}}),nt=tt.extend({_instance:null,_adapter:null,constructor:function(e,t){this._instance=e,this._adapter=t,this.openExpansion=this.expansionMethod(r.createExpansion),this.openStage=this.expansionMethod(r.showStage),this._instance.bind("childDestroyed",W(this,this.onStageDestroyed))},expansionMethod:function(t){var n=this;return function(r){r=r||{},r.type==="lightbox"&&e.parent.scrollTo(0,0);if(n._adapter||H.touchPreview)r.config=r.config||{},n._adapter&&(r.config.adapter=n._adapter),H.touchPreview&&(r.config.adapter_mode="touchpreview");t(n._instance,r)}},resize:function(e){var t=f({trigger:null,animate:!0,duration:0},e);this._instance.view.resizeContainer(parseInt(t.width,10),parseInt(t.height,10),t)},closeSelf:function(e){var t=this;t._instance.parent||!t._adapter?t._instance.destroy(e):t._instance.view.destroy(e)},closeExpansions:function(e){this._instance.destroyAllChildren(e)},onStageDestroyed:function(e){this.trigger({type:nt.events.STAGE_UNLOADED,triggerSequence:e.metrics.sequence-1,scope:e.stage})}},{events:{STAGE_UNLOADED:"stageunloaded"}}),rt=tt.extend({constructor:function(){St.register(this)},send:function(e,t,n){t&&o.is.truly(t.globalMessage)&&r.MessageBus?r.MessageBus.triggerGlobalMessageHandler(this,e,t,n):St.dispatchMessage(this,e,t,n)},receive:function(e,t,n){this.trigger({type:rt.events.MESSAGE_RECEIVED,message:e,payload:t,trigger:n})}},{events:{MESSAGE_RECEIVED:"messagereceived"}}),it=tt.extend({_object:null,_startTime:0,_duration:0,_ease:null,_interval:null,_startValues:null,_endValues:null,_deltaValues:null,constructor:function(e){this._ease=it.easing.linear,this._object=e,this._tick=W(this,this._tick)},run:function(e,t,n){var r=this;r.isRunning()&&r.cease(),r._startTime=+(new Date),r._ease=n||r._ease,r._duration=t,r._startValues={},r._deltaValues={},r._endValues=e,a(r._endValues,function(e,t){r._startValues[t]=r._getValue(t)},r),a(r._startValues,function(e,t){r._deltaValues[t]=r._endValues[t]-e},r),r._interval=setInterval(r._tick,E)},cease:function(){if(this.isRunning()){var e=this;setTimeout(function(){clearInterval(e._interval),e._interval=null},E)}},end:function(){a(this._endValues,function(e,t){this._setValue(t,e)},this),this.trigger({type:it.events.COMPLETE}),this.cease()},beginning:function(){a(this._startValues,function(e,t){this._setValue(t,e)},this),this.cease()},isRunning:function(){return!!this._interval},_tick:function(){var e=+(new Date)-this._startTime,t=e/this._duration;t>=1?this.end():(a(this._startValues,function(t,n){this._setValue(n,this._ease(e,this._duration,t,this._deltaValues[n]))},this),this.trigger({type:it.events.UPDATE}))},_setValue:function(e,t){var n=this._object;e in n&&(N.f===typeof n[e]?n[e](t):n[e]=t)},_getValue:function(e){var t=this._object;return e in t&&N.f===typeof t[e]?t[e]():t[e]}},{events:{COMPLETE:"tween_complete",UPDATE:"tween_update"},easing:{linear:function(e,t,n,r){return r*(e/t)+n},easeOut:function(e,t,n,r){return e/=t,r*(Math.pow(--e,3)+1)+n},easeIn:function(e,t,n,r){return e/=t,r*Math.pow(e,3)+n},easeInOut:function(e,t,n,r){return e/=t/2,e<1?r/2*Math.pow(e,3)+n:(e-=2,r/2*(Math.pow(e,3)+2)+n)}}}),st=function(){var n={swipe:!0,swipe_time:400,swipe_min_distance:20,drag:!0,drag_vertical:!0,drag_horizontal:!0,drag_min_distance:5,pinch:!0,pinch_min_dist:20,pinch_time:200,zoom:!0,zoom_min_dist:20,zoom_time:200,transform:!0,scale_treshold:.1,rotation_treshold:15,tap:!0,tap_double:!0,tap_max_interval:300,tap_max_distance:10,tap_double_distance:20,hold:!1,hold_timeout:500,click:!0,mouseup:!0,mousedown:!0,mouseover:!0,mousemove:!0,mouseout:!0},r={"user-select":"none","touch-callout":"none","user-drag":"none","tap-highlight-color":"rgba(0,0,0,0)"},i,s,u,l,c,h,p,d,v,m,g,b,w,E,S,x,T,N,C=function(e){return{originalEvent:e,mode:u,position:g,direction:b,distance:w,distanceX:E,distanceY:S,angle:x,scale:T,rotation:N}},k=function(){i=null,l=c=h=p=d=v=!1,m&&(m.cancel(),m=null)},L=function(e,t){if(t.hold&&!p)return p=!0,new ot(st.events.HOLD,C(e),e,t.hold_timeout)},A=function(e,t){if(t.transform&&R(e)>=2){var n=h?st.events.TRANSFORM:st.events.TRANSFORM_START;return h=!0,e.preventDefault(),new ot(n,C(e),e)}},O=function(e,t){if(t.drag&&w>t.drag_min_distance){var n=c?st.events.DRAG:st.events.DRAG_START;return c=!0,new ot(n,C(e),e)}},M=function(e,t){var n=s.time-i.time,r=null;T<1?(t.pinch&&!d&&Math.abs(s.spread-i.spread)>=t.pinch_min_dist&&t.pinch_time>n&&(d=!0,r=st.events.PINCH),v=!1):T>1&&(t.zoom&&!v&&Math.abs(s.spread-i.spread)>=t.zoom_min_dist&&t.zoom_time>n&&(v=!0,r=st.events.ZOOM),d=!1);if(r)return new ot(r,C(e),e)},_=function(e,t){if(t.swipe){var n=s.time-i.time;if(t.swipe_time>n&&w>t.swipe_min_distance)return new ot(st.events.SWIPE,C(e),e)}},D=function(e,t){if(t.tap){var n=s.time-i.time;if(!t.hold||n<t.hold_timeout)return new ot(st.events.TAP,C(e),e)}},P=function(e){var t=F(e),n=I(t),r=(new Date).getTime();u=Object.prototype.toString.call(e).indexOf("Touch")>-1?"touch":"mouse";if(!i||!l)i={event:e,positions:t,spread:n,time:r};i.spread||(i.spread=n),s={event:e,positions:t,spread:n,time:r};var o=i.positions[0],a=s.positions[0];g=t.length>0?t:g,o&&a&&(x=U(o,a),b=X(x),w=I([o,a]),E=a.x-o.x,S=a.y-o.y),R(e)>=2&&t&&(T=t.length>=2?V(i.positions,s.positions):1,N=t.length>=2?$(i.positions,s.positions):0),st.position=g&&g[0],st.instance&&st.instance.view&&(st.instance.view.clientX=st.position.x,st.instance.view.clientY=st.position.y)},B=function(t,r,i){t=t||e.event,r=r||n;var s=[];P(t);var o=t.type.toLowerCase();o.indexOf("mouse")===-1&&s.push(new ot(o,C(t),t));switch(o){case"touchstart":case"mousedown":l=!0,m||(m=L(t,r,i),m&&s.push(m));break;case"touchmove":case"mousemove":if(l){var u=A(t,r,i);if(!u)u=O(t,r,i);else{var a=M(t,r,i);a&&s.push(a)}u&&s.push(u)}break;case"touchend":case"touchcancel":case"mouseup":if(o==="touchcancel"&&t.target!==i.dom)return;if(l){h&&s.push(new ot(st.events.TRANSFORM_END,C(t),t));if(c){var f=_(t,r,i);f&&s.push(f),s.push(new ot(st.events.DRAG_END,C(t),t))}if(!h&&!c&&o!=="mouseout"){var p=D(t,r,i);p&&(s.push(p),s.push(new ot(st.events.SELECT,C(t),t)))}}s.push(new ot(st.events.RELEASE,C(t),t)),k()}return s},j=function(t,r,i){t=t||e.event,r=r||n;var s=[];P(t);var o=t.type.toLowerCase();if(r[o]){s.push(new ot(o,C(t),t));switch(o){case"mousedown":l=!0,m||(m=L(t,r,i),m&&s.push(m));break;case"mousemove":if(l){var u=O(t,r,i);u&&s.push(u)}break;case"mouseup":l&&c&&s.push(new ot(st.events.DRAG_END,C(t),t)),o==="mouseup"&&s.push(new ot(st.events.RELEASE,C(t),t)),k();break;case"click":k(),s.push(new ot(st.events.SELECT,C(t),t));break;default:}}return s},F=function(e){var n=[],r;if(e.touches)for(var i=0,s=e.touches.length;i<s;i++)r=e.touches[i],n.push({x:r.pageX,y:r.pageY});else{var o=t.body;n.push({x:e.pageX||e.clientX+(t&&t.documentElement&&t.documentElement.scrollLeft||o&&o.scrollLeft||0)-(t&&t.documentElement&&t.documentElement.clientLeft||o&&o.clientLeft||0),y:e.pageY||e.clientY+(t&&t.documentElement&&t.documentElement.scrollTop||o&&o.scrollTop||0)-(t&&t.documentElement&&t.documentElement.clientTop||o&&o.clientTop||0)})}return n},I=function(e){if(e.length>=2&&e[0]&&e[1]){var t=e[0],n=e[1],r=t.x-n.x,i=t.y-n.y;return q(r,i)}return 0},q=function(e,t){return Math.sqrt(e*e+t*t)},R=function(e){return e.touches?e.touches.length:1},U=function(e,t){return e&&t?Math.atan2(t.y-e.y,t.x-e.x)*180/Math.PI:0},X=function(e){var t={down:e>=45&&e<135,left:e>=135||e<=-135,up:e<-45&&e>-135,right:e>=-45&&e<=45},n,r;for(r in t)if(t[r]){n=r;break}return n},V=function(e,t){if(e&&e.length>=2&&t&&t.length>=2){var n,r;n=e[0].x-e[1].x,r=e[0].y-e[1].y;var i=q(n,r);n=t[0].x-t[1].x,r=t[0].y-t[1].y;var s=q(n,r);return s/i}return 0},$=function(e,t){if(e&&e.length>=2&&t&&t.length>=2){var n,r;n=e[0].x-e[1].x,r=e[0].y-e[1].y;var i=Math.atan2(r,n)*180/Math.PI;n=t[0].x-t[1].x,r=t[0].y-t[1].y;var s=Math.atan2(r,n)*180/Math.PI;return s-i}return 0},J=function(e,n,r){n=n.split(" "),a(n,function(n){var i=e.dom;i.addEventListener?i.addEventListener(n,r,!1):t.attachEvent&&i.attachEvent("on"+n,r)},self)};return Z.extend({element:null,options:null,enabled:!0,constructor:function(e,t){var i=this;if(!z(e,ut))throw"No Element";i.options=f({},n,t),i.options.instance&&!st.instance&&(st.instance=i.options.instance,st.instance.bind("childDestroyed",function(){k()})),a(r,function(t,n){e.css(n,t)},self),H.touch&&J(e,"touchstart touchmove touchend touchcancel",W(i,i.handleTouchEvent)),!H.touch&&H.touchPreview?J(e,"mouseup mousedown mousemove mouseout",W(i,i.handleTouchEvent)):!y.android&&!y.ios&&J(e,"click mouseup mousedown mouseover mousemove mouseout",W(i,i.handleMouseEvent)),i.element=e},handleGenericEvent:function(e,t){var n=this;if(n.enabled){var r=t(e,n.options,n.element);n.trigger(r)}},handleTouchEvent:function(e){this.handleGenericEvent(e,B)},handleMouseEvent:function(e){this.handleGenericEvent(e,j)},trigger:function(e){o.isArray(e)?a(e,function(e){e.trigger()},this):e.trigger()}},{events:{SELECT:"tapclick",TAP:"tap",DOUBLE_TAP:"doubletap",HOLD:"hold",DRAG:"drag",DRAG_START:"dragstart",DRAG_END:"dragend",SWIPE:"swipe",PINCH:"pinch",ZOOM:"zoom",TRANSFORM:"transform",TRANSFORM_START:"transformstart",TRANSFORM_END:"transformend",TOUCH_START:"touchstart",TOUCH_END:"touchend",TOUCH_MOVE:"touchmove",TOUCH_CANCEL:"touchcancel",RELEASE:"release",CLICK:"click",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout",MOUSE_MOVE:"mousemove",MOUSE_WHEEL:"mousewheel"},position:{},instance:null})}(),ot=Z.extend({type:null,info:null,element:null,event:null,timer:null,triggered:!1,delay:null,constructor:function(e,t,n,r){var i=this;i.type=e,i.info=t,i.event=n,i.delay=r},trigger:function(){function s(t,n){var r=t&&(t.bound(e.type)||e.cascadeMatch(t,e.type));return r}var e=this;if(!e.delay&&!e.triggered){e.triggered=!0;var t=ut.getById(e.event.target.id);if(s(t,e.type))e.element=t;else{var n=e.event.target,r=n&&(n.parent||n.parentNode);while(r&&!e.element){t=ut.getById(r.id);if(s(t,e.type)){e.element=t;break}r=r.parent||r.parentNode}}if(e.element){var i=o.flatten(ot.cascades);u(i,e.type)&&e.event.preventDefault(),e.element.trigger({type:e.type,info:e.info},!0)}}else N.n===typeof e.delay&&e.delay>0&&(e.timer=setTimeout(function(){e.delay=0,e.trigger()},e.delay))},cancel:function(){clearTimeout(this.timer)},cascadeMatch:function(e,t){var n=!1,r=c(ot.cascades,function(e){return u(e,t)});return r.length>0&&(r=o.flatten(r),n=o.any(r,function(t){return e.bound(t)})),n}},{cascades:{drag:[st.events.DRAG_START,st.events.DRAG,st.events.DRAG_END,st.events.SWIPE],transform:[st.events.TRANSFORM_START,st.events.TRANSFORM,st.events.TRANSFORM_END,st.events.PINCH,st.events.ZOOM]}}),ut=tt.extend({_x:0,_y:0,_width:0,_height:0,_scale:1,_rotation:0,_alpha:1,_blur:0,_grayscale:0,_sepia:0,_saturate:1,_visible:1,_offsetX:0,_offsetY:0,_children:null,_gestures:null,_styleHelper:null,_oldLeft:null,id:null,dom:null,parent:null,style:null,constructor:function(e,n){if(!ut.holder){var r=ut.holder=t.createElement("div");r.id="__ELEMENTS__",r.style.position="fixed",r.style.top=r.style.left="-1px",r.style.width=r.style.height="1px",r.style.visibility=C.h,r.style.overflow=C.v,r.style.pointerEvents="none",r.style.zIndex="-1000",t.body.appendChild(r)}var i=this;N.s===typeof e&&!u(ut.blacklist,e)&&(e=t.createElement(e));if(!B(e))throw"Invalid Type";i.dom=e,i.id=i.dom.id||e.nodeName.toLowerCase()+ut.domCount++,i.dom.id=i.dom.id||i.id,i.dom.parentElement||ut.holder.appendChild(i.dom),a([st.events.MOUSE_ENTER,st.events.MOUSE_LEAVE],function(e){i.dom.addEventListener(e,function(e){i.trigger(e.type,!1)})}),i._children=[],n&&i.setAttribute(n),i.style=e.style,i._styleHelper=new et(i),i.css({position:i.style.position||"absolute",overflow:i.style.overflow||C.h,padding:i.style.padding||"0px",margin:i.style.margin||"0px",top:i.style.top||"0px",left:i.style.left||"0px",cursor:i.style.cursor||"inherit"}),i._oldLeft=i.style.left,i._setPointerEvents(),i.dom.tagName&&!u(ut.gestureBlackList,i.dom.tagName.toLowerCase())&&(i.css("user-drag","none"),i.css("user-select","none")),i.width=j(i,"_width","width","%vpx",i.dom,"offsetWidth"),i.height=j(i,"_height","height","%vpx",i.dom,"offsetHeight"),i.alpha=j(i,"_alpha","alpha","%v",i.style,"opacity"),i.blur=j(i,"_blur","blur","%v",i.style,"blur"),i.grayscale=j(i,"_grayscale","grayscale","%v",i.style,"grayscale"),i.sepia=j(i,"_sepia","sepia","%v",i.style,"sepia"),i.saturate=j(i,"_saturate","saturate","%v",i.style,"saturate"),i.x=F(i,"_x"),i.y=F(i,"_y"),i.offsetX=F(i,"_offsetX"),i.offsetY=F(i,"_offsetY"),i.scale=F(i,"_scale"),i.rotation=F(i,"_rotation"),i.x(0),i.y(0),ut.map[i.id]=i},setAttribute:function(e){if(N.s===typeof e&&N.u!==typeof arguments[1])this.dom.setAttribute(e,arguments[1]);else if(N.o===typeof e){var t=h(e);a(t,function(t){this.dom.setAttribute(t,e[t])},this)}},getAttribute:function(e){if(N.s===typeof e)return this.dom.getAttribute(e);if(N.o===typeof e){var t=h(e),n={};return a(t,function(t){n[t]=e[t]},this),n}},html:function(e){return e&&(this.dom.innerHTML=e),this.dom.innerHTML},text:function(e){return e&&(this.dom.textContent=e),this.dom.textContent},css:function(e){if(N.s===typeof e){if("undefined"==typeof arguments[1])return this._styleHelper.getStyle(e);this._styleHelper.hasStyle(e)&&this._styleHelper.setStyle(e,arguments[1])}else if(N.o===typeof e){var t=h(e);a(t,function(t){this._styleHelper.setStyle(t,e[t])},this)}},addChild:function(e){if(!e)return;!z(e,ut)&&B(e)&&(e=new ut(e)),e.parent||(e.parent=this,this.dom.appendChild(e.dom),this._children.push(e),e.trigger({type:ut.events.ADDED_TO_DOM}))},removeChild:function(e){if(!e)return;z(e,ut)&&e.parent===this&&(e.parent=null,this.dom.removeChild(e.dom),this._children=c(this._children,function(t){return t!==e}))},getChild:function(e){return this._children[e]},visible:function(e){var t=this;if(N.u!==typeof e){var n=e!==this._visible;this._visible=e,n&&!this._visible&&(this._oldLeft=this.style.left),this.style.left=t._visible?this._oldLeft:"-10000px",this._setPointerEvents(),n&&this.trigger({type:ut.events.VISIBILITY_CHANGE,visible:e})}return this._visible},enabled:function(e){var t=this,n=ut.__super__.enabled.call(t,e);return N.u!==typeof e&&t._setPointerEvents(),n},tactileEvents:p(st.events),bind:function(e,t){ut.__super__.bind.call(this,e,t),u(this.tactileEvents,e)||this.dom.addEventListener.apply(this.dom,arguments)},unbind:function(e,t){ut.__super__.unbind.call(this,e,t),!u(this.tactileEvents,e)&&t&&this.dom.removeEventListener.apply(this.dom,arguments)},_setPointerEvents:function(){this.style.pointerEvents=this.visible()&&this.enabled()?"auto":"none"},_isGestureBound:function(){var e=p(st.events).concat(p(ft.events)),t=p(e);for(i=0,l=t.length;i<l;i++)if(this.bound(t[i]))return!0;return!1}},{domCount:0,blackList:["script"],gestureBlackList:["input","option","select","textarea"],holder:null,map:{},events:{ADDED_TO_DOM:"element_added_to_dom",RESIZE:"element_resize",VISIBILITY_CHANGE:"element_visibilitychange"},getById:function(e){return ut.map[e]}}),at=tt.extend({_startValues:null,_endValues:null,_ease:null,_duration:0,_container:null,_running:!1,_endHandler:null,_tween:null,constructor:function(e,t,n){var r=this;this._startValues={},this._endValues={};if(!e||!z(e,ut))throw"Invalid object";this._container=e,this._container.bind(at.events.STARTED,function(e){e.animation!==r&&r.cease()}),at.useCSS||(this._tween=new it(this._container)),this._duration=t||this._duration,this._ease=this._mapEase(n),o.bindAll(this)},update:function(e,t){this._duration=e||this._duration,this._ease=this._mapEase(t)},run:function(e){var t=this,n=e.to,r=e.from;!n&&!r&&(n=e),t.cease(),t._endValues=f({},n);if(t._duration-E*3<=0){t.end();return}t._endHandler=t._generateEndHandler(),at.useCSS?t._container.bind(at.transitionEndEventName,this._endHandler,!0):t._tween.bind(it.events.COMPLETE,this._endHandler),t._running=!0,t._container.trigger({type:at.events.STARTED,animation:t}),r?("alpha"in r&&t._container.alpha(r.alpha),t._requestFrame(function(){r=f({},r);var e=h(r);t._requestFrame(function(){a(e,function(e){t._container[e](r[e])},t),t._requestFrame(t._handleFrame)})})):t._requestFrame(t._handleFrame)},beginning:function(){this._reset();if(at.useCSS)for(var e in this._startValues){if(!this._startValues.hasOwnProperty(e))continue;this._container[e](this._startValues[e])}else this._tween.beginning()},end:function(){this._reset();if(at.useCSS)for(var e in this._endValues){if(!this._endValues.hasOwnProperty(e))continue;this._container[e](this._endValues[e])}else this._tween.end();this.trigger({type:at.events.COMPLETE})},cease:function(){this.isRunning()&&(this._reset(),this.trigger({type:at.events.CANCELLED}))},isRunning:function(){return this._running},_requestFrame:function(e){this._frame=at.requestAnimationFrame(e)},_cancelFrame:function(e){at.cancelAnimationFrame(e)},_handleFrame:function(){var e=this,t=Math.floor(e._duration-E*3);if(at.useCSS){e._container.css("transition-property","all"),e._container.css("transition-duration",t+"ms"),e._container.css("transition-timing-function",e._ease);var n=h(e._endValues);g.firefox&&(n=c(n,function(e){return e!=="blur"}),"blur"in e._endValues&&delete e._endValues.blur),a(n,function(t){e._startValues[t]=e._container[t]()},e),o.isEqual(e._startValues,e._endValues)?e.end():a(n,function(t){e._container[t](e._endValues[t])},e)}else e._tween.run(e._endValues,t,e._mapTweenEase(e._ease))},_reset:function(){this._cancelFrame(this._frame),this._running=!1,at.useCSS?(this._container.unbind(at.transitionEndEventName,this._endHandler,!0),this._container.css("transition-property","none"),this._container.css("transition-duration","0"),this._container.css("transition-timing-function","")):(this._tween.unbind(it.events.COMPLETE,this._endHandler),this._tween.cease()),this._endHandler=null},_generateEndHandler:function(){return W(this,function(e){(e.target===this._container.dom||e.target===this._tween)&&this.end()})},_mapEase:function(e){var t={easeIn:at.eases.EASE_IN,easeOut:at.eases.EASE_OUT,easeInOut:at.eases.EASE_IN_OUT,easeNone:at.eases.LINEAR};return t[e]||at.eases.LINEAR},_mapTweenEase:function(e){var t={"ease-in":it.easing.easeIn,"ease-out":it.easing.easeOut,"ease-in-out":it.easing.easeInOut,linear:it.easing.linear};return t[e]||it.easing.linear}},{transitionEndEventName:"transitionend",animationFrame:null,cancelFrame:null,animationFrameSupported:!0,useCSS:!0,requestAnimationFrame:function(t){var n;return at.animationFrameSupported?n=e[at.animationFrame](t):n=setTimeout(t,E),n},cancelAnimationFrame:function(t){at.animationFrameSupported?e[at.cancelFrame](t):clearTimeout(t)},events:{COMPLETE:"animation_complete",CANCELLED:"animation_cancelled",STARTED:"animation_started"},eases:{LINEAR:"linear",EASE_IN:"ease-in",EASE_OUT:"ease-out",EASE_IN_OUT:"ease-in-out"}});(function(){"requestAnimationFrame"in e?at.animationFrame="requestAnimationFrame":H.prefix+"RequestAnimationFrame"in e&&(at.animationFrame=H.prefix+"RequestAnimationFrame"),"cancelAnimationFrame"in e?at.cancelFrame="cancelAnimationFrame":H.prefix+"RequestAnimationFrame"in e&&(at.cancelFrame=H.prefix+"CancelAnimationFrame"),at.animationFrameSupported=at.animationFrame&&!/iP(ad|hone|od).*OS 6/.test(e.navigator.userAgent),H.prefix==="webkit"&&(at.transitionEndEventName="webkitTransitionEnd"),at.useCSS=!g.msie||g.version>9})();var ft=tt.extend({_element:null,_holder:null,_content:null,_options:null,_origOverflow:null,_scrollStart:null,_nativeScroll:null,_rules:null,_keyLock:null,_useTouch:!1,_initialized:!1,_scrollOffsetX:0,_scrollOffsetY:0,_trackVert:null,_trackHorz:null,_animation:null,_dragging:null,_tween:null,_tweenOn:null,_enabled:null,_thickness:null,_defaults:{initialPosition:null,hide:!0,sliderColor:"#000",thickness:7},constructor:function(e,t){var n=this;if(!e||!z(e,ut))throw"No Element";n._element=e,n._content=e.getChild(0),n._options=o.defaults(t||{},n._defaults),n._thickness=n._options.thickness,n._origOverflow=e.style&&e.style.overflow,n._useTouch=H.touch||H.touchPreview,n._nativeScroll={},n._rules={},o.bindAll(n),n.enable()},enable:function(){var e=this;e._enabled=!0;if(!e._element.visible()&&!e._initialized){e._element.bind(ut.events.VISIBILITY_CHANGE,function(t){t.visible&&e._enabled&&e.enable()});return}if(!e._holder){e._holder=new ut("div",{"data-label":"scrollholder"}),e._holder.x(0),e._holder.y(0),g.msie&&e._holder.css("background-color","rgba(0, 0, 0, 0.01)");var t=[];while(e._element.getChild(0)){var n=e._element.getChild(0);t.push(n),e._element.removeChild(n)}a(t,function(t){e._holder.addChild(t)}),e._element.addChild(e._holder);var r=e._element.width,i=e._element.height;e._element.width=function(t){return e._holder.width(t),r(t)},e._element.height=function(t){return e._holder.height(t),i(t)}}e._holder.width(e._element.width()),e._holder.height(e._element.height());var s=e._holder.style;s.overflow=C.a,e._holder.bind("scroll",e._handleNativeScrollEvent),e._holder.bind("keyup",e._handleKeyUp),e._rules=e._getRules(),e._initialized?(e._holder.width(e._holder.width()+e._scrollOffsetX),e._holder.height(e._holder.height()+e._scrollOffsetY)):(e._scrollOffsetX=e._holder.width()-e._holder.dom.clientWidth,e._scrollOffsetY=e._holder.height()-e._holder.dom.clientHeight,e._scrollOffsetX===0&&g.mozilla&&y.mac&&(e._scrollOffsetX=16),e._scrollOffsetY===0&&g.mozilla&&y.mac&&(e._scrollOffsetY=16),e._content.height()>e._holder.height()&&e._holder.width(e._holder.width()+e._scrollOffsetX),e._content.width()>e._holder.width()&&e._holder.height(e._holder.height()+e._scrollOffsetY)),e._useTouch&&(s.overflow=y.android||y.ios||H.touchPreview?C.h:C.a,e._holder.bind(st.events.DRAG_START,e._onDragStart),e._holder.bind(st.events.DRAG,e._onDrag),e._holder.bind(st.events.DRAG_END,e._onDragEnd)),e._animation||(e._animation=new at(e._content,200,at.eases.EASE_OUT)),e._options.initialPosition&&e._holder&&(e._options.initialPosition.x&&(e._holder.dom.scrollLeft=-1*e._options.initialPosition.x),e._options.initialPosition.y&&(e._holder.dom.scrollTop=-1*e._options.initialPosition.y)),e._tween||(e._tween=new it(e._holder.dom)),e._initializeTrack(),e._initialized=!0},disable:function(){var e=this;e._enabled=!1;var t=this._holder.style;e._useTouch&&(e._holder.unbind(st.events.DRAG_START,this._onDragStart),e._holder.unbind(st.events.DRAG,this._onDrag),e._holder.unbind(st.events.DRAG_END,this._onDragEnd)),e.stopScroll(),e._holder.unbind("scroll",this._handleNativeScrollEvent),e._holder.unbind("keyup",this._handleKeyUp),t.overflow=this._origOverflow},thickness:function(){return this._thickness+8},getScrollPosition:function(){return{y:this._holder.dom.scrollTop,x:this._holder.dom.scrollLeft,scrollHeight:this._holder.dom.scrollHeight,scrollWidth:this._holder.dom.scrollWidth,offsetX:this._content.x(),offsetY:this._content.y()}},scrollTo:function(e,t){var n=this;t=N.u===typeof t||isNaN(t)?0:t,e=e||{};if(t===0)N.u!==typeof e.x&&e.x!==n._holder.dom.scrollLeft&&(n._holder.dom.scrollLeft=e.x),N.u!==typeof e.y&&e.y!==n._holder.dom.scrollTop&&(n._holder.dom.scrollTop=e.y);else if(n._tween){n._tween.isRunning()&&n._tween.cease();var r=n.getScrollPosition(),i=o.defaults({scrollLeft:e.x,scrollTop:e.y},{scrollLeft:r.x,scrollTop:r.y});n._tweenOn=!0,n._tween.run(i,t,it.easing.easeOut)}},stopScroll:function(){this._tween&&this._tween.cease()},_getRules:function(){var e=this._getDimensions(this._element),t=this._getDimensions(this._content);return{scrollX:e.width<t.width,scrollY:e.height<t.height}},_getDimensions:function(e){return{width:e.width(),height:e.height()}},_onDragStart:function(e){e.halt(),this._blurActive(),this._scrollStart=this.getScrollPosition(),this._rules=this._getRules(),this._animation.isRunning()&&this._animation.cease()},_onDrag:function(e){e.halt();var t=this._scrollStart.x+e.info.distanceX*-1,n=this._scrollStart.y+e.info.distanceY*-1;this._rules.scrollX&&(t<0?this._content.x(this._scrollStart.offsetX+t*-1):t>this._scrollStart.scrollWidth-this._holder.width()?this._content.x(this._scrollStart.offsetX+this._scrollStart.scrollWidth-this._holder.width()-t):this._holder.dom.scrollLeft=t),this._rules.scrollY&&(n<0?this._content.y(this._scrollStart.offsetY+n*-1):n>this._scrollStart.scrollHeight-this._holder.height()?this._content.y(this._scrollStart.offsetY+this._scrollStart.scrollHeight-this._holder.height()-n):this._holder.dom.scrollTop=n)},_onDragEnd:function(e){e.halt();var t={};this._content.y()!==this._scrollStart.offsetY&&(t.y=this._scrollStart.offsetY),this._content.x()!==this._scrollStart.offsetX&&(t.x=this._scrollStart.offsetX),this._animation&&this._animation.isRunning()&&this._animation.cease(),this._animation.run({to:t})},_handleKeyUp:function(e){this._keyLock=!0,this._resetKeyLock()},_handleNativeScrollEvent:function(e){var t=this;if(t._keyLock)return;t._blurActive();var n=t.getScrollPosition(),r=t._rules.scrollY&&t._rules.scrollX?t._thickness:0;t._trackVert&&!t._trackVert.dragging&&t._trackVert.y(4+(t._holder.height()-t._trackVert.height()-t._scrollOffsetY-r-8)*(n.y/(n.scrollHeight-this._holder.height()+t._scrollOffsetY))),t._trackHorz&&!t._trackHorz.dragging&&t._trackHorz.x(4+(t._holder.width()-t._trackHorz.width()-t._scrollOffsetX-r-8)*(n.x/(n.scrollWidth-this._holder.width()+t._scrollOffsetX))),!t._nativeScroll.start&&!t._tween.isRunning()?(t._nativeScroll.start=!0,t.trigger({type:ft.events.SCROLL_START,info:n})):t._tween.isRunning()||t.trigger({type:ft.events.SCROLL,info:n}),clearTimeout(t._nativeScroll.timeout),t._nativeScroll.timeout=setTimeout(function(){t._nativeScrollEnd()},500)},_nativeScrollEnd:function(){var e=this.getScrollPosition();this._tween.isRunning()||(this._nativeScroll.start=!1,this._tweenOn?this._tweenOn=!1:this.trigger({type:ft.events.SCROLL_END,info:e}))},_endKeyLock:function(){this._keyLock=!1},_resetKeyLock:function(){var e=this;clearTimeout(this._nativeScroll.keyTimeout),this._nativeScroll.keyTimeout=setTimeout(function(){e._endKeyLock()},50)},_blurActive:function(){try{H.mobile&&(t.activeElement.blur(),e.focus())}catch(n){}},_initializeTrack:function(){function t(t,n,r){var i=new ut("div",{"data-label":"scrollthumb"});return i.width(t-1),i.height(n-1),i.css("background-color",e._options.sliderColor||"#000"),i.css("border","1px solid #FFF"),i.css("border-radius",r*2+"px"),i.css("background-clip","padding-box"),i.visible(!1),i.alpha(.6),i}function n(t,n,r,i,s,o,u){var a,f,l=ft.helper;t.bind(st.events.MOUSE_DOWN,function(r){e.stopScroll(),a=t[n](),e._dragging=t.dragging=!0,f=e._element.dom.getBoundingClientRect(),l.visible(!0),l.enabled(!0),l.x(0),l.y(0)});var c=function(f){if(t.dragging){var l=e.getScrollPosition(),c=a+f.info[i],h=e._rules.scrollY&&e._rules.scrollX?e._thickness:0,p=4+(e._holder[r]()-t[r]()-e[s]-h-8);c<4&&(c=4),c>p&&(c=p),e._holder.dom[o]=(c-4)/(p-4)*(l[u]-e._holder[r]()+e[s]),t[n](c)}},h=function(){t.dragging&&(e._dragging=t.dragging=!1,a=t[n](),l.x(-l.width()),l.y(-l.height()),l.visible(!1),l.enabled(!1))};l.bind(st.events.MOUSE_MOVE,c),l.bind([st.events.MOUSE_UP,st.events.MOUSE_OUT],h)}var e=this;if(e._rules.scrollY)if(!e._trackVert){var r=t(e._thickness,Math.max(30,e._holder.height()*(e._holder.height()/e._content.height())),e._thickness);r.x(e._holder.width()-r.width()-4-e._scrollOffsetX),r.y(4),e._element.addChild(r),e._trackVert=r,n(e._trackVert,"y","height","distanceY","_scrollOffsetY","scrollTop","scrollHeight")}else e._trackVert.height(Math.max(30,e._holder.height()*(e._holder.height()/e._content.height())));else e._trackVert&&e._trackVert.visible(!1);if(e._rules.scrollX)if(!e._trackHorz){var i=t(Math.max(30,e._holder.width()*(e._holder.width()/e._content.width())),e._thickness,e._thickness);i.y(e._holder.height()-i.height()-4-e._scrollOffsetY),i.x(4),e._element.addChild(i),e._trackHorz=i,n(e._trackHorz,"x","width","distanceX","_scrollOffsetX","scrollLeft","scrollWidth")}else e._trackHorz.width(Math.max(30,e._holder.width()*(e._holder.width()/e._content.width())));else e._trackHorz&&e._trackHorz.visible(!1);if(!e._initialized&&e._rules.scrollY||e._rules.scrollX)e._options.hide?(e._element.bind(st.events.MOUSE_OVER,function(){e._trackVert&&e._trackVert.visible(!0),e._trackHorz&&e._trackHorz.visible(!0)}),e._element.bind(st.events.MOUSE_OUT,function(){e._trackVert&&!e._dragging&&e._trackVert.visible(!1),e._trackHorz&&!e._dragging&&e._trackHorz.visible(!1)})):(e._trackVert&&e._trackVert.visible(!0),e._trackHorz&&e._trackHorz.visible(!0))}},{events:{SCROLL_START:"scrollstart",SCROLL:"scroll",SCROLL_END:"scrollend"},helper:function(){var e=new ut("div",{"data-label":"scrollhelper"});return e.x(-100),e.y(-100),e.width(100),e.height(100),e.alpha(0),e.css("background-color","#000"),e}()});(function(){var e=new ut("style",{type:"text/css",id:"flt-scrollbar-style"});e.text(":not(.flt-force-scroll)::-webkit-scrollbar { display: none; overflow: visible; width: 0px; height: 0px;}"),t.getElementsByTagName("body")[0].appendChild(e.dom)})();var lt=ut.extend({constructor:function(e){lt.__super__.constructor.call(this,t.createElement("div"),{"data-label":"spinner"});var n=e&&e.spinnerOptions,r=32,i=12,s=r*.12,o=r*.25,u=r*.445,a=r*.37,f=o*1.42,l=360/i,c=1e3/i,h=n&&n.spinnerColor||"#CCCCCC";this.width(r),this.height(r);for(var p=0;p<i;++p){var d=new ut("div");d.width(s),d.height(o);var v=d.style;v.left=u+"px",v.top=a+"px",v.backgroundColor=q(h),d.css("animation","flt-spinner-fade 1s linear infinite"),d.css("border-radius","5px"),d.css("box-shadow","0 0 3px rgba(0, 0, 0, 0.1)"),d.css("transform","rotate("+(0+l*p)+"deg) translate(0, -"+f+"px)"),d.css("animation-delay",0-(1e3-c*p)+"ms"),this.addChild(d)}n&&n.backgroundColor&&(this.style.backgroundColor=q(n.backgroundColor))}});(function(){var e=new ut("style",{type:"text/css",id:"flt-spinner-style"});e.text("@"+H.stylePrefix+"keyframes flt-spinner-fade { from {opacity: 0.8;} to {opacity: 0;} }"),t.getElementsByTagName("body")[0].appendChild(e.dom)})();var ct=Z.extend({_instance:null,_adapter:null,_enabled:!0,_sequence:0,_iframe:null,_iframeName:null,constructor:function(e,n){this._instance=e,this._adapter=n,this._enabled=!u(["edit","test","preview"],this._adapter),this.logInteraction=this._generateLogger("metrics:logInteraction"),this.logContent=this._generateLogger("metrics:logContent"),this.logNotation=this._generateLogger("metrics:logNotation"),this.sendTracker=this._sendTracker;var r=t.createElement("iframe");t.body.appendChild(r),r.style.display="none",this._iframeName="metricsFrame",r.contentWindow.name=this._iframeName,this._iframe=r},_generateLogger:function(e){var t=this;return function(n){return t._enabled?(t._sequence=t._instance.metrics.sequence,n=f(n,{eventDelegate:function(e,n,r){t._touchDelegate(e,n,r)}}),t._instance.trigger(e,n)):t._sequence++,t._sequence}},_touchDelegate:function(e,t,n){p(t).join("").length>2048?this._postDelegate(e,t,n):v.loadImageTrackingUrl(e,t,n)},_postDelegate:function(e,n,r){r!==!0&&(e+="?et=P");var i=t.createElement("form");i.style.display="none",i.action=e,i.target=this._iframeName,i.method="POST",n=n||{},o.each(n,function(e,n){var r=t.createElement("input");r.setAttribute("name",n),r.setAttribute("value",e),i.appendChild(r)}),i.submit()},_sendTracker:function(e){v.loadImageTrackingUrl(v.replaceAllTokens(this._instance,e),null,!0)}},{type:{IMPRESSION:12,INTERACTION:13,CONTENT:14,NOTATION:15},mode:{UNKNOWN:0,CLICK:1,DRAG:2,ROLLOVER:3,ROLLOUT:4,TOUCH:5,MOTION:6},subtype:{INTERACTION_HOVER:20,INTERACTION_SELECT:21,INTERACTION_DESELECT:22,INTERACTION_NAVIGATE:23,INTERACTION_SCROLL:24,INTERACTION_SUBMIT:25,INTERACTION_CONTROL:26,INTERACTION_COMPONENT:27,INTERACTION_LEGACY:28,CONTENT_VIEW:40,CONTENT_PLAY:41,CONTENT_NOTATION:42,CONTENT_CLICKTHROUGH:43,CONTENT_SHARE:44,CONTENT_FORM:45,CONTENT_POLL:46,CONTENT_CALL_PHONE:47,NOTATION_UPDATE:60,NOTATION_ACTION:62,NOTATION_CONTENTDATA:64}}),ht=tt.extend({dataId:null,schema:null,form:null,counter:null,_data:null,_instance:null,constructor:function(e,t){var n=this;this.dataId=e,this._instance=t;var r={POST:function(e,t){var n=this,r=function(e){n._data=e,t&&n._logNotation(t,e.success),n.trigger({type:e.success?ht.events.COMPLETE:ht.events.ERROR,response:e},!0)},i=m.getDataUrl(m.dataApiEndpoints.FORM_POST,n.getOptions({data:e},r));b.loadUncachedScript(i,null,null)}},i={INCR:function(e,t){var n=this,r=function(e){n._data=e,t&&n._logNotation(t,e.success),n.trigger({type:e.success?ht.events.COMPLETE:ht.events.ERROR,response:e},!0)},i=m.getDataUrl(m.dataApiEndpoints.COUNTER_INCR,n.getOptions({schema:JSON.stringify(n.schema),label:e},r));b.loadUncachedScript(i,null,function(){n.trigger({type:ht.events.ERROR},!0)})},GET:function(e){var t=this,n=function(e){t._data=e,t.trigger({type:e.success?ht.events.COMPLETE:ht.events.ERROR,response:e},!0)},r=m.getDataUrl(m.dataApiEndpoints.COUNTER_GET,t.getOptions({data:{labelId:e}},n));b.loadUncachedScript(r,null,function(){t.trigger({type:ht.events.ERROR},!0)})}};r.POST=W(n,r.POST),i.INCR=W(n,i.INCR),i.GET=W(n,i.GET),n.form=r,n.counter=i},getOptions:function(e,t){var n=this;return f(e||{},{dataId:n.dataId,schema:JSON.stringify(n.schema),regId:n._instance.getConfig().regId,appId:n._instance.getConfig().appId,isPreviewInstance:n._instance.getConfig().isPreviewInstance,sid:n._instance.sessionId,callback:b.getCallbackName(t)})},setSchema:function(e){this.schema=e},_logNotation:function(e,t){var n=isNaN(t)?this._data.success:Boolean(t),r={bucketid:this.dataId,success:n};n||(r.message=ht.DEFAULT_IO_ERROR),e.logNotation({subtype:ct.subtype.NOTATION_UPDATE,detail:"Data Submitted",eventData:r})}},{DEFAULT_IO_ERROR:"Failed to access remote data URL",events:{COMPLETE:"oncomplete",ERROR:"onerror"}}),pt=Z.extend({_metrics:null,id:null,component:null,type:null,constructor:function(e,t,n,r){this._metrics=e,this.id=t,this.type=N.u===typeof n?ct.type.IMPRESSION:n,this.component=r},clone:function(e,t,n){return new pt(this._metrics,e||this.id,t||this.type,n||this.component)},logInteraction:function(e){e=f(e,{component:this.component});if(N.u===typeof e.subtype||!U(e.subtype,20,39,!0))throw"Invalid subtype";N.u===typeof e.mode&&(e.mode=ct.mode.UNKNOWN),this.type===ct.type.CONTENT&&(e=f(e,{context:this.id}));var t=this._metrics.logInteraction(e);return this.clone(t,ct.type.INTERACTION)},logContent:function(e){e=f(e,{component:this.component});if(N.u===typeof e.subtype||!U(e.subtype,40,59,!0))throw"Invalid subtype";u([ct.type.INTERACTION,ct.type.IMPRESSION],this.type)&&(e=f(e,{trigger:this.id}));var t=this._metrics.logContent(e);return this.clone(t,ct.type.CONTENT)},logNotation:function(e){e=f(e,{component:this.component,context:this.id});if(N.u===typeof e.subtype||!U(e.subtype,60,79,!0))throw"Invalid subtype";this._metrics.logNotation(e)}}),dt=Z.extend({_info:null,_values:null,constructor:function(e,t){if(!e)throw"No Info";this._info=e,this._values={},t&&f(dt.variables,X(this._info))},getValue:function(e,t){var n=this;if(n._values[e])return n._values[e];var r=V(n._info,"configParams."+e.replace(/\./g,"\\."));r=r&&(n._info.configParams[e].valueMap||n._info.configParams[e].value),r=r||n._info[e],t||(r=this._replaceVariables(r));if(N.s===typeof r&&(r.indexOf("{")===0||r.indexOf("[")===0))try{r=JSON.parse(r)}catch(i){}return t||n.setValue(e,r),r},setValue:function(e,t){this._values[e]=t},getInt:function(e){return parseInt(this.getValue(e),10)},getFloat:function(e){return parseFloat(this.getValue(e))},getBoolean:function(e){return R(this.getValue(e))},getDataId:function(){return this.getValue("wbx.dataApiKey")},getColor:function(e){var t=this.getValue(e);return t&&(t=q(t)),t},getFont:function(e){var t=this.getValue(e);return t&&t.css},_replaceVariables:function(e){var t=typeof e;if(t===N.u)return;try{t!==N.s?t===N.o&&e.__varParsed__!==dt.parsedFlag&&(e.__varParsed__=dt.parsedFlag,a(e,function(t,n){e[n]=this._replaceVariables(t)},this)):e=o.variableReplacement(e,dt.variables)}catch(n){}return e}},{variables:{},parsedFlag:+(new Date)}),vt=tt.extend({_states:null,_triggers:null,_nodes:null,_baseTrigger:null,constructor:function(e){this._states={},this._triggers={},this._nodes={},this._baseTrigger=e},trackNode:function(e){e&&e.id&&N.u===typeof this._states[e.id]&&(this._states[e.id]=vt.states.DISABLED,this._triggers[e.id]=this._baseTrigger,this._nodes[e.id]=e)},getState:function(e){return e&&N.u!==typeof this._states[e]&&this._states[e]||vt.states.UNKNOWN},getStateTrigger:function(e){return e&&N.u!==typeof this._triggers[e]&&this._triggers[e]||this._baseTrigger},setState:function(e,t,n){if(e&&N.u!==typeof this._states[e]&&N.n===typeof t&&this._states[e]!==t){n=n||this.getStateTrigger(e);var r=this._getStateBranch(e,t);a(r,function(e){var r=this._nodes[e];this._states[e]=t,this._triggers[e]=n.clone(null,null,r.component||e)},this),this.trigger({type:vt.events.STATE_CHANGE,branch:r,state:t,trigger:n})}},_getStateBranch:function(e,t){var n=[];N.u!==typeof this._states[e]&&n.push(e);var r=this._nodes[e];if(t===vt.states.ENABLED)r.parent&&this._nodes[r.parent]&&r.parent!==e&&(n=this._getStateBranch(r.parent,t).concat(n));else if(t===vt.states.DISABLED||t===vt.states.UNLOADED)if(r.children&&h(r.children).length>0){var i=h(r.children);a(i,function(e){var i=r.children[e];i&&a(i,function(e){n=this._getStateBranch(e.id,t).concat(n)},this)},this)}return n}},{states:{UNKNOWN:-1,ENABLED:1,DISABLED:2,PRELOADED:3,UNLOADED:4},events:{STATE_CHANGE:"statechange",LOADED:"loaded"}}),mt=ut.extend({_node:null,_state:null,_trigger:null,_stateManager:null,_factory:null,_editMode:!1,_geometryLock:!1,visibilityEnabled:null,label:null,constructor:function(e,n,r){var i=this;r=r||t.createElement("div"),r.id=r.id||e.id,mt.__super__.constructor.call(i,r,{"data-label":"container","data-layer":e.label||e.id}),i._setVisible(!1),i._node=e,i._factory=n,i._stateManager=n.getStateManager(),i._state=this._stateManager.getState(e.id),i._trigger=this._stateManager.getStateTrigger(e.id),i.elementAlpha=i.alpha,i.alpha=i.containerAlpha,i.style.borderStyle="solid",i.style.borderWidth="0px",i._node.overflow&&(i.style.overflow=i._node.overflow),i.label=e.label,i._editMode||i._factory.getActionController().register(i),i.visibilityEnabled=i._state===vt.states.ENABLED||e.visibility!=="hidden",i._editMode=i._factory.getAdapter()==="edit",i.draw(e),i.visible(this.visibilityEnabled),i._editMode&&i.enabled(!1),i._state===vt.states.ENABLED&&i.trigger({type:vt.events.STATE_CHANGE,state:i._state,trigger:i._trigger})},getProperty:function(){return!1},update:function(e){"component"in e&&delete e.component;var t={};this._geometryLock&&(t={width:this._node.width,height:this._node.height,x:this._node.x,y:this._node.y}),f(this._node,e);for(var n in t)this._node[n]=t[n];this.label=this._node.label,this._factory.getActionController().tearDownActions(this),this._editMode||this._factory.getActionController().register(this),this.draw(this._node)},reload:function(e){var t=this._factory.getComponentDefinition(this._node.component);f(t.localConfig,e);if(t.info&&t.info.configParams){var n={};for(var r in e){if(!e.hasOwnProperty(r))continue;n[r]={name:r,value:e[r]}}f(t.info.configParams,n)}this._stateManager.setState(this._node.id,vt.states.DISABLED),this._stateManager.setState(this._node.id,vt.states.UNLOADED)},draw:function(e){e=f({},e);var t=N.u!==typeof e.borderThickness&&N.u!==typeof e.borderColor&&parseFloat(e.borderThickness)>0&&e.borderColor!=="";if(t){var n=Math.min(e.width,e.height)/2;e.borderThickness>n&&(e.borderThickness=n)}else e.borderThickness=0;e.width=t?e.width-e.borderThickness*2:e.width,e.height=t?e.height-e.borderThickness*2:e.height,a(S,function(t){this[t]&&N.u!=typeof e[t]&&this[t].call(this,e[t])},this);if(N.u!==typeof e.backgroundAlpha&&N.u!==typeof e.backgroundColor){var r=I(q(e.backgroundColor),e.backgroundAlpha);r&&(e.backgroundColor="rgba("+r.join(",")+")")}else e.backgroundColor=q(e.backgroundColor);t&&(e.borderThickness.indexOf("px")===-1&&(e.borderThickness=e.borderThickness+"px"),e.borderColor=q(e.borderColor)),e.cornerRadius&&e.cornerRadius.indexOf("px")===-1&&(e.cornerRadius=e.cornerRadius+"px"),a(x,function(t){var n=T[t]||t;N.u!=typeof e[t]&&this.css(n,e[t])},this)},_setVisible:function(e){mt.__super__.visible.call(this,e)},geometryLock:function(e){return N.u!==typeof e&&(this._geometryLock=e),this._geometryLock},stateChange:function(e){if(this._state!==e.state){this._state=e.state;var t=e.trigger;t&&(this._trigger=t,t=t.clone(null,null,this._node.component||this._node.id),e.trigger=t),this._checkState()}},_checkState:function(){var e=this._stateManager&&this._stateManager.getState(this._node.id);if(this._state===vt.states.ENABLED||e===vt.states.ENABLED)this.visibilityEnabled=!0},containerAlpha:function(e){return e>this._node.alpha?this.elementAlpha(this._node.alpha):this.elementAlpha(e)},visible:function(e,t,n,r){var i=this;i._checkState();if(N.u!=typeof e&&this.visibilityEnabled){var s=this._visible;if(e!=s){var u=t;if(!u){var f=o.find(this._node.animations,function(t){return e?t.trigger==="visibilityshown":t.trigger==="visibilityhidden"});f&&(u=f.options)}if(this._editMode||!u)this.animation&&this.animation.cease(),this.animation=this._factory.getAnimation(this),this._setVisible(e),e&&this.alpha(N.u===typeof this._node.alpha?1:this._node.alpha),n&&n();else{this.animation&&this.animation.cease(),this.animation=this._factory.getAnimation(this,u.duration*1e3,u.easing.ease),this.animation.bind(at.events.COMPLETE,function(e){i._visible||i._setVisible(!1),n&&n()}),this.animation.bind(at.events.CANCELLED,function(e){i._visible||i._setVisible(!1),r&&r()});if(e){if(u.from){var l=h(u.from);a(l,function(e){this[e](u.from[e])},this)}this._setVisible(!0)}this.animation.run({from:u.from,to:u.to})}this._visible=e,this.trigger({type:mt.events.VISIBILITY_CHANGE,visible:e})}else n&&n()}return this._visible},type:function(){return this._node.type}},{events:{VISIBILITY_CHANGE:"container_visibilitychange"}}),gt=mt.extend({external:null,reloadTimeout:null,constructor:function(e,t,n){gt.__super__.constructor.call(this,e,t,n)},load:function(e){},addExternal:function(e,n){return this.external=this._factory.getElement(t.createElement("div"),{"data-label":n},e),this.external.css({position:"relative",overflow:this.style.overflow}),this.css("borderRadius")?this.external.css("borderRadius",this.css("borderRadius")-this._node.borderThickness+"px"):this.external.css("borderRadius","0px"),this.external.width(this.width()),this.external.height(this.height()),this.addChild(this.external),this.external},update:function(e){var t=this.width(),n=this.height();gt.__super__.update.call(this,e);if(this.external){this.external.width(this.width()),this.external.height(this.height()),this.css("borderRadius")?this.external.css("borderRadius",this.css("borderRadius")-this._node.borderThickness+"px"):this.external.css("borderRadius","0px");if(t!==this.width()||n!==this.height())this.external.flite&&this.external.flite.resize?this.external.flite.resize.call(this.external,{width:this.width(),height:this.height()}):(clearTimeout(this.reloadTimeout),this.reloadTimeout=setTimeout(W(this,function(){this.reload()}),200))}},reload:function(e){var t=this._state;gt.__super__.reload.call(this,e),this.external&&(this.removeChild(this.external),this.external=null,this.load(this._node),this._stateManager.setState(this._node.id,t))},stateChange:function(e){var t=this._state;gt.__super__.stateChange.call(this,e),this.external&&this.external.flite&&this.external.flite.stateChange&&this.external.flite.stateChange.call(this.external,e),this._state!==t&&this.trigger({type:vt.events.STATE_CHANGE,state:this._state,trigger:e.trigger})},getProperty:function(e){return this.external&&V(this.external,["flite","properties",e].join("."))},cloneNodeLists:function(e){var t={};return a(e,function(e,n){t[n]=e.slice(0)}),t}},{events:{ENABLED:"wrapper_enabled"}}),yt=mt.extend({childHolder:null,childNodes:null,children:null,childVisible:null,nodeVisibility:null,scroll:null,rendered:!1,preloaded:!1,preloadedChildren:null,spinner:null,offsets:null,constructor:function(e,n,r){yt.__super__.constructor.call(this,e,n,r),this.preloaded=e.id!=="__MAIN__"||this._editMode,this.preloadedChildren=[],this.childNodes=e.children&&e.children.nodes||[],this.children={},this.childVisible={},this.nodeVisibility={},this.offsets={x:0,y:0,width:this.width(),height:this.height()},this.childHolder=this._factory.getElement(t.createElement("div"),{"data-label":"view-children"}),this.childHolder.style.position="relative",this.childHolder.width(e.width),this.childHolder.height(e.height),this.addChild(this.childHolder),this._calculateOffsets(),this.childHolder.x(this.offsets.x),this.childHolder.y(this.offsets.y),this.childHolder.width(this.offsets.width),this.childHolder.height(this.offsets.height),this._handleScroll=W(this,this._handleScroll),this._reducePreload(),this.preloaded||(this.spinner=this._factory.getSpinner(),this.spinner.x(.5*(this.width()-this.spinner.width())),this.spinner.y(.5*(this.height()-this.spinner.height())),this.addChild(this.spinner))},stateChange:function(e){var t=this._state;yt.__super__.stateChange.call(this,e),this._state===vt.states.ENABLED?(this.rendered||(this.rendered=!0,a(this.childNodes,this._doLayout,this),this._scrollCheck()),this.preloaded||this._checkPreload()):this._state===vt.states.DISABLED&&a(this.children,function(e,t){this.childVisible[t]=e.visible()},this),this._state!==t&&(this.preloaded?a(this.childNodes,this._doChangeState,this):this._checkPreload());if(e.child&&e.child.state===vt.states.ENABLED){var n=this.children[e.child.key];n&&n.visible(!0)}this._state!==t&&this.trigger({type:vt.events.STATE_CHANGE,state:this._state,trigger:e.trigger})},update:function(e){yt.__super__.update.call(this,e),this.childHolder.width(this.offsets.width),this.childHolder.height(this.offsets.height),this._scrollCheck()},visible:function(e,t,n,r){var i=yt.__super__.visible.call(this,e,t,n,r);return i},enabled:function(e){var t=yt.__super__.enabled.call(this,e);return t},_setPointerEvents:function(){this.style.pointerEvents=this.visible()&&this.enabled()&&this.style.overflow!==C.v&&this._isGestureBound()?"auto":"none",this.childHolder&&(this.childHolder.style.pointerEvents=this.style.pointerEvents)},_scrollCheck:function(){if(this.childHolder){var e=this._node&&this._node.overflow;e&&e!==""&&e!==C.h?e===C.v?(this.style.overflow=C.v,this._disableScroll()):e===C.a?(this.style.overflow=C.h,this._enableScroll()):(this._disableScroll(),this.style.overflow=e):(this._disableScroll(),this.style.overflow=C.h,this.childHolder.x(this.offsets.x),this.childHolder.y(this.offsets.y)),this.childHolder.style.overflow=this.style.overflow,this._setPointerEvents()}},_enableScroll:function(){this.childHolder.x(0),this.childHolder.y(0),this.scroll?this.scroll.enable():(this.scroll=this._factory.getScroller(this,{initialPosition:{x:this.offsets.x,y:this.offsets.y}}),this.scroll.bind(ft.events.SCROLL_END,this._handleScroll))},_disableScroll:function(){this.childHolder.x(this.offsets.x),this.childHolder.y(this.offsets.y),this.scroll&&this.scroll.disable()},_doLayout:function(e){var t=this;t.nodeVisibility[e.id]=e.visibility,t.preloaded||(e.visibility="hidden");var n=t._factory.getContainer(e);t.children[e.id]=n,t.childHolder.addChild(n),n.offsetX(Math.abs(t.offsets.x)),n.offsetY(Math.abs(t.offsets.y)),t.preloaded||(z(n,gt)&&n.getProperty("supportsPreload")&&t.nodeVisibility[e.id]!=="hidden"?(n.addComponentListener(vt.events.LOADED,W(t,t._handleChildComplete)),t._stateManager.setState(e.id,vt.states.PRELOADED)):t.preloadedChildren.push(n.id))},_doChangeState:function(e){var t=this.children[e.id];t&&t.visibilityEnabled&&this.childVisible[e.id]!==!1&&this._stateManager.setState(e.id,this._state,this._trigger)},_handleScroll:function(e){this._trigger.logInteraction({subtype:ct.subtype.INTERACTION_SCROLL,mode:ct.mode.DRAG,detail:this._node.label,eventData:e.info})},_handleChildComplete:function(e){e.target.unbind(e.type,arguments.callee),this.preloadedChildren.push(e.target.id),this._checkPreload()},_doSetVisibility:function(e,t){e.visible(!0),this.childVisible[t]=e.visible()},_reducePreload:function(){var e=this;e.preloaded=o.reduce(e.childNodes,function(t,n){var r=n.component,i=!1;if(r){var s=e._factory.getComponentDefinition(r);i=V(s,"flite.properties.supportsPreload")}return t&&!i},!0)},_checkPreload:function(){if(!this.preloaded&&this.preloadedChildren.length===this.childNodes.length){this.preloaded=!0,this.spinner&&(this.removeChild(this.spinner),this.spinner=null);var e=p(this.children);a(e,function(e){var t=e._node.id;e.visibilityEnabled=e.visibilityEnabled||this._state===vt.states.ENABLED&&this.nodeVisibility[e._node.id]!=="hidden",(e.visibilityEnabled||this.nodeVisibility[e._node.id]!=="hidden")&&this._doSetVisibility(e,t)},this),a(this.childNodes,this._doChangeState,this),this.trigger({type:vt.events.LOADED})}},_calculateOffsets:function(){a(this.childNodes,function(e,t,n){this.offsets.x=Math.min(this.offsets.x,e.x),this.offsets.y=Math.min(this.offsets.y,e.y)},this),this.offsets.width=-1*this.offsets.x+this.offsets.width,this.offsets.height=-1*this.offsets.y+this.offsets.height,a(this.childNodes,function(e,t,n){this.offsets.width=Math.max(this.offsets.width,-1*this.offsets.x+e.x+e.width),this.offsets.height=Math.max(this.offsets.height,-1*this.offsets.y+e.y+e.height)},this)}}),bt=Z.extend({animation:null,dom:null,environment:null,factory:null,messenger:null,meta:null,metrics:null,net:null,script:null,state:null,urls:null,util:null,window:null,constructor:function(t,n){var i=n.getStateManager(),s=n.getInstance(),u=s.guid,a=this;a.animation={events:f({},at.events),getAnimation:W(n,n.getAnimation),requestAnimationFrame:at.requestAnimationFrame,cancelAnimationFrame:at.cancelAnimationFrame},a.dom={events:f({},st.events,ft.events),getElement:W(n,n.getElement),makeScrollable:W(n,n.getScroller),getIframe:function(e,t){return n.getIframe(t,e)}},a.environment={editor:H.editor,studio:H.studio,auto:!H.mobile&&!H.editor,touch:H.touch||H.touchPreview,location:H.location,mobile:H.mobile,prefix:H.prefix,retina:H.retina,stylePrefix:H.stylePrefix,secure:H.secure,coppa:H.coppa,screenshot:H.screenshot},a.factory={getAnimation:a.animation.getAnimation,getContainer:function(e,r){if(e){var i=n.getComponentDefinition(e.component);return e.type&&e.type==="part"||i&&i.type&&i.type.toLowerCase()==="part"?t.part.call(t,e,r):n.getContainer.call(n,e,r)}},getContainerById:W(n,n.getContainerById),getPartName:W(n,n.getPartName),getPartConfig:W(n,n.getPartConfig),getSpinner:W(n,n.getSpinner),getData:W(n,n.getData)},a.messenger=n.getMessenger(),a.meta={adId:s.config.regId,placementId:u},a.metrics={subtype:ct.subtype,mode:ct.mode};var l=["count"],c=function(e,t,n){var r={count:25,endpoint:"userTimeline",user:e,callback:b.getCallbackName(t)};n=f(r,n),b.loadUncachedScript(m.getProxiedTwitterUrl(f(n,{instanceGuid:u})))},h=["max"],d=function(e,t,n){var r={max:20,id:e,callback:b.getCallbackName(t)};n=f(r,n),b.loadUncachedScript(m.getProxiedFacebookUrl(f(n,{instanceGuid:u})))},v=function(e,t){var n={};return e&&t&&(n=o.pick.apply(null,[t].concat(e))),n},g=function(e,t,n){n=f({json:!1,minify:!1,raw:!0,callback:b.getCallbackName(t)},n),b.loadUncachedScript(m.getProxiedFeedUrl(e,f(n,{instanceGuid:u})))};this.net={cookies:{deleteCookie:o.deleteCookie,getCookie:o.getCookie,setCookie:o.setCookie,available:o.cookiesEnabled},open:function(e,t,r,i){e=n.getClickthroughUrl({url:e,trigger:r&&r.id,component:r&&r.component,detail:e}),e&&s.view.openWindow(e,t,i)},proxyFeed:function(e,t,n){n=f({json:!0,minify:!0,raw:!1},n),g(e,t,n)},proxyManagedContent:function(e,t){g(m.getManagedContentUrl(e),t,{json:!0})},proxy:function(e,t,n){g(e,t,n)},twitter:{requestTimeline:function(e,t,n){c(e,t,v(l,n))},requestFilteredTimeline:function(e,t,n,r){c(e,n,f(v(l,r),{endpoint:"userSearch",search:t}))},requestSingleTweet:function(e,t,n){c(e,n,{endpoint:"singleTweet",id:t})}},facebook:{requestFeed:function(e,t,n){d(e,t,v(h,n))}},share:f(function(e,t,r){var i=n.getShareUrl(f(t,{url:e}));i&&s.view.openWindow(i,"_blank",r)},{services:{TWITTER:"TWITTER",TWITTER_RETWEET:"TWITTER_RETWEET",LINKEDIN:"LINKED_IN"}}),geo:{getLocation:function(e){var t={callback:b.getCallbackName(e)};b.loadUncachedScript(m.getGeoLocationURL(f(t,{instanceGuid:u})))}},events:ht.events},a.script={isScriptLoaded:W(b,b.isScriptLoaded),loadScript:function(e,t){return b.loadScript(m.getProxiedFeedUrl(e,{raw:!0,minify:!1}),t)},loadWindowedScript:function(e,t){return b.loadWindowedScript(m.getProxiedFeedUrl(e,{raw:!0,minify:!1}),t)},jsonp:function(e,t){return b.loadUncachedScript(m.getProxiedFeedUrl(e,{json:!0,raw:!0,minify:!1,callback:b.getCallbackName(t)}))}},a.state={ENABLED:vt.states.ENABLED,DISABLED:vt.states.DISABLED,PRELOADED:vt.states.PRELOADED,UNLOADED:vt.states.UNLOADED,getState:W(i,i.getState),setState:W(i,i.setState),events:vt.events},a.urls=f(r.URLS,m),a.urls.getProxiedImageUrl=function(e,t){return m.getProxiedImageUrl(e,f(t,{instanceGuid:u}))},a.urls.getProxiedFeedUrl=function(e,t){return m.getProxiedFeedUrl(e,f(t,{instanceGuid:u}))},a.urls.getProxiedTwitterUrl=function(e){return m.getProxiedTwitterUrl(f(e,{instanceGuid:u}))},a.util={setInterval:e.setInterval,clearInterval:e.clearInterval,setTimeout:e.setTimeout,clearTimeout:e.clearTimeout,delegate:W,hexToRgba:I,inRange:U,parseBoolean:R,extend:f,values:p,_:o},a.window={EVENTS:G.EVENTS,bind:W(G,G.bind),unbind:W(G,G.unbind),top:o.getExpandableWindow()}}}),wt=gt.extend({name:null,component:null,definition:null,constructor:function(e,t,n,r,i){wt.__super__.constructor.call(this,e,t,n),this.definition=r,this.component=i,this.load(e)},load:function(e){var t=this;if(e&&t.definition){var n=t._factory.getComponentDefinition(e.component);t.name=n&&n.partName;var r=ut.extend(t.definition);t.external=t.addExternal(r,"part");var i=h(t.definition);a(i,function(e){e!=="flite"&&!(e in t)&&(N.f===typeof t.external[e]&&(t.external[e]=W(t.external,t.external[e])),Object.defineProperty(t,e,{get:function(){return t.external[e]},set:function(n){t.external[e]=n}}))},t),t.trigger({type:gt.events.ENABLED});var s=new dt(n&&n.localConfig||{});if(t.external.flite){var o=t.cloneNodeLists(e.children||{});t.external.flite.initialize.call(t.external,{api:new bt(t.component,t._factory),buckets:o,containers:o,config:s,label:t._node.label,id:t._node.id,name:t.name,component:t.component.external,rectangle:{x:0,y:0,width:t.width(),height:t.height()}})}}}}),Et=gt.extend({partDefinitions:null,componentListeners:null,lastMethod:null,constructor:function(e,t,n){Et.__super__.constructor.call(this,e,t,n),this.componentListeners={},this.partDefinitions={},this.load(e)},load:function(e){var t=this,n=t._factory.getComponentDefinition(e.component);if(n&&n.guid&&n.info&&n.info.scriptContent){var r=n.guid,i=Et.components[r]||(Et.components[r]=ut.extend(n.info.scriptContent));t.external=t.addExternal(i,"component"),t.trigger({type:gt.events.ENABLED});if(t.external.flite){var s=t.external.flite.parts;if(s){var o=h(s);a(o,function(e){t.partDefinition(e,s[e])},t)}if(t.external.flite.initialize){var u=t.cloneNodeLists(e.children||{});t.external.flite.initialize.call(t.external,{api:new bt(t,t._factory),buckets:u,containers:u,config:new dt(n.info),label:t._node.label,id:t._node.id,rectangle:{x:0,y:0,width:t.width(),height:t.height()}})}t.stateChange({state:t._state,trigger:t._trigger})}}},stateChange:function(e){Et.__super__.stateChange.call(this,e),this._state===vt.states.ENABLED&&this.lastMethod&&this.external?(this.callComponentFn(this.lastMethod.name,this.lastMethod.args,this.lastMethod.trigger),this.lastMethod=null):this._state===vt.states.DISABLED&&(this.lastMethod=null)},callComponentFn:function(e,t,n){if(this._state===vt.states.ENABLED&&this.external&&this.external.flite&&this.external.flite[e]){try{t=(t||[]).concat([n]),this.external.flite[e].apply(this.external,t)}catch(r){}this.lastMethod&&(this.lastMethod=null)}else this.lastMethod={name:e,args:t,trigger:n}},addComponentListener:function(e,t){if(this.external)try{this.external.bind(e,t)}catch(n){}},removeComponentListener:function(e,t){if(this.external&&this.external.bound(e))try{this.external.unbind(e,t)}catch(n){}},partDefinition:function(e,t){return N.u!==typeof t&&(this.partDefinitions[e]=t),this.partDefinitions[e]},part:function(e,t){var n=this._factory.getPartName(e),r=new wt(e,this._factory,t,this.partDefinition(n),this);return At.containers[e.id]=r,r}},{components:{}}),St={_messages:[],register:function(e){this._messages.push(e)},dispatchMessage:function(e,t,n,r){a(this._messages,function(i){e!==i&&i.receive(t,n,r)})}};r.MessageBus&&r.MessageBus.registerGlobalMessageHandler(o.bind(St.dispatchMessage,St)),function(e){function t(){this._callbacks=[]}function n(e){function o(e){return function(){i+=1,r[e]=Array.prototype.slice.call(arguments),i===s&&n.done(r)}}var n=new t,r=[];if(!e||!e.length)return n.done(r),n;var i=0,s=e.length;for(var u=0;u<s;u++)e[u].then(o(u));return n}function r(e,n){var i=new t;return e.length===0?i.done.apply(i,n):e[0].apply(null,n).then(function(){e.splice(0,1),r(e,arguments).then(function(){i.done.apply(i,arguments)})}),i}t.prototype.then=function(e,n){var r;return this._isdone?r=e.apply(n,this.result):(r=new t,this._callbacks.push(function(){var t=e.apply(n,arguments);t&&typeof t.then=="function"&&t.then(r.done,r)})),r},t.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var e=0;e<this._callbacks.length;e++)this._callbacks[e].apply(null,arguments);this._callbacks=[]};var i={Promise:t,join:n,chain:r};typeof define=="function"&&define.amd?define(function(){return i}):e.promise=i}(this);var xt=this.promise,Tt;(function(e,t,n){function r(){this.hasDeviceMotion="ondevicemotion"in e,this.hasDeviceOrientation="ondeviceorientation"in e,this.threshold=8,this.orientationThreshold=90,this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null;if(!t.createEvent)return;this.event=t.createEvent("Event"),this.event.initEvent("shake",!0,!0)}r.prototype.reset=function(){this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null,this.lastBeta=null,this.lastGamma=null},r.prototype.start=function(){this.reset(),this.hasDeviceMotion?e.addEventListener("devicemotion",this,!1):this.hasDeviceOrientation&&e.addEventListener("deviceorientation",this,!1)},r.prototype.stop=function(){this.hasDeviceMotion?e.removeEventListener("devicemotion",this,!1):this.hasDeviceOrientation&&e.removeEventListener("deviceorientation",this,!1),this.reset()},r.prototype.deviceorientation=function(t){var r,i,s=0,o=0;if(this.lastBeta===null&&this.lastGamma===null){this.lastBeta=t.beta,this.lastGamma=t.gamma;return}s=n.abs(this.lastBeta-t.beta),o=n.abs(this.lastGamma-t.gamma);if(s>=this.orientationThreshold||o>=this.orientationThreshold)r=new Date,i=r.getTime()-this.lastTime.getTime(),i>1e3&&(e.dispatchEvent(this.event),this.lastTime=new Date)},r.prototype.devicemotion=function(t){var r=t.accelerationIncludingGravity,i,s,o=0,u=0,a=0;if(this.lastX===null&&this.lastY===null&&this.lastZ===null){this.lastX=r.x,this.lastY=r.y,this.lastZ=r.z;return}o=n.abs(this.lastX-r.x),u=n.abs(this.lastY-r.y),a=n.abs(this.lastZ-r.z);if(o>this.threshold&&u>this.threshold||o>this.threshold&&a>this.threshold||u>this.threshold&&a>this.threshold)i=new Date,s=i.getTime()-this.lastTime.getTime(),s>1e3&&(e.dispatchEvent(this.event),this.lastTime=new Date)},r.prototype.handleEvent=function(e){if(typeof this[e.type]=="function")return this[e.type](e)},Tt=new r})(e,t,Math);var Nt=function(e,t){var n=0,r=function(){Nt.dimensions={width:e.innerWidth,height:e.innerHeight}},i="orientation"in e,s="onorientationchange"in e,o="matchMedia"in e;return tt.extend({timeout:null,constructor:function(){var t=this,n=function(){try{clearTimeout(t.timeout),t.timeout=setTimeout(function(){t.checkOrientation()},250)}catch(r){e.removeEventListener("orientationchange",n),e.removeEventListener("resize",n)}};s?e.addEventListener("orientationchange",n):e.addEventListener("resize",n)},checkOrientation:function(t){var n=this;r();var s=Nt.dimensions.width>Nt.dimensions.height?90:0;o&&(e.matchMedia("(orientation: portrait)").matches?s=0:e.matchMedia("(orientation: landscape)").matches&&(s=90)),y.ios&&i&&(s=e.orientation),n.updateOrientation(s,t)},updateOrientation:function(e,r){e=t.floor(t.abs(e)/90);var i=this;if(n!=e||r)n=e,Nt.orientation=n%2===0?"portrait":"landscape",i.trigger({type:Nt.events.ORIENTATION_CHANGE,info:{dimensions:Nt.dimensions,orientation:Nt.orientation}})}},{orientation:"portrait",dimensions:null,events:{ORIENTATION_CHANGE:"devicemotion_orientationchange"}})}(o.getExpandableWindow(),Math),Ct=new Nt,kt=Z.extend({_listeners:null,_triggers:null,_timeouts:null,_delayedMouseOutFns:null,_paths:null,_stateManager:null,_stateChangeCallbacks:null,_componentEnabledCallbacks:null,_componentCallbacks:null,_pathLoopData:null,_expansion:null,_messengers:null,constructor:function(e,t){this._listeners={},this._triggers={},this._timeouts={},this._delayedMouseOutFns={},this._paths={},this._factory=e,this._stateManager=this._factory.getStateManager(),this._stateChangeCallbacks={},this._componentEnabledCallbacks={},this._componentCallbacks={},this._pathLoopData={},this._expansion=this._factory.getExpansion(),this._messengers={},this._actions=t,o.bindAll(this)},_convertOldActions:function(e){var t=[],n={paths:{},actions:{}};return a(e,function(e){var r=this._convertToNewTrigger(e),i=r.paths[0];t.push(r),n.paths[i]=[];if(e.delay&&e.delay!==""){var s=this._convertToNewAction(e,!0);n.paths[i].push(s.actionId),n.actions[s.actionId]=s.actionObj}var o=this._convertToNewAction(e);n.paths[i].push(o.actionId),n.actions[o.actionId]=o.actionObj},this),{newTriggers:t,newActions:n}},_convertToNewTrigger:function(e){var t={};return t.eventType=e.trigger,e.triggerpayload&&(t.payload=e.triggerpayload),e.triggerduration&&(t.duration=e.triggerduration),t.paths=["path_"+o.generateGuid().substring(0,8)],t},_convertToNewAction:function(e,t){var n="action_"+o.generateGuid().substring(0,8);return t?{actionId:n,actionObj:{payload:e.delay,type:"delay"}}:{actionId:n,actionObj:{payload:e.payload,options:o.clone(e.options),type:e.type}}},register:function(t){var n=this,r=t._node.triggers;typeof r=="string"&&(r=JSON.parse(r));if(!r||!r.length)if(t._node.actions){var i=this._convertOldActions(t._node.actions);r=i.newTriggers,this._actions||(this._actions={paths:{},actions:{}}),this._actions.paths=o.extend(this._actions.paths,i.newActions.paths),this._actions.actions=o.extend(this._actions.actions,i.newActions.actions)}if(r&&r.length>0){n._triggers[t.id]=o.groupBy(r,function(e){return e.eventType});var s=kt.triggers;n.setListener(s.TAP,t,t,st.events.TAP,n.handleTap),n.setListener(s.CLICK,t,t,st.events.CLICK,n.handleClick),n.setListener(s.SELECT,t,t,st.events.SELECT,n.handleTapClick),n.setListener(s.MOUSE_OVER,t,t,st.events.MOUSE_ENTER,n.handleMouseOver),n.setListener(s.MOUSE_OUT,t,t,st.events.MOUSE_LEAVE,n.handleMouseOut),(n.hasTrigger(s.TAP,t)||n.hasTrigger(s.CLICK,t)||n.hasTrigger(s.SELECT,t))&&t.css("cursor","pointer"),n.setListener(s.SWIPE,t,t,st.events.SWIPE,n.handleSwipe),n.setListener(s.VISIBILITY_SHOWN,t,t,mt.events.VISIBILITY_CHANGE,n.handleVisibilityShown,!0),n.setListener(s.VISIBILITY_HIDDEN,t,t,mt.events.VISIBILITY_CHANGE,n.handleVisibilityHidden,!0),n._stateChangeCallbacks[t.id]=n.callbackWithContainer(t,n.handleStateChange),t.bind(vt.events.STATE_CHANGE,n._stateChangeCallbacks[t.id]),n.setListener(s.PINCH,t,t,st.events.PINCH,n.handlePinch),n.setListener(s.ZOOM,t,t,st.events.ZOOM,n.handleZoom),n.setListener(s.SHAKE,t,e,s.SHAKE,n.handleShake),n.setListener(s.ORIENTATION_CHANGE,t,Ct,Nt.events.ORIENTATION_CHANGE,n.handleOrientationChange),n._messengers[t.id]=n._factory.getMessenger(),n.setListener(s.ON_MESSAGE,t,n._messengers[t.id],rt.events.MESSAGE_RECEIVED,n.handleMessage),n._componentEnabledCallbacks[t.id]=n.callbackWithContainer(t,n.handleComponentEnabled),t.bind(gt.events.ENABLED,n._componentEnabledCallbacks[t.id]),n.setListener(s.STAGE_UNLOADED,t,n._expansion,nt.events.STAGE_UNLOADED,n.handleStageUnloaded)}},setListener:function(e,t,n,r,i,s){if(this.hasTrigger(e,t)||s){var o=this.callbackWithContainer(t,i);this._listeners[t.id]=this._listeners[t.id]||[],this._listeners[t.id].push({triggerEvent:e,target:n,tactileEvent:r,callback:o}),n.bind(r,o)}},callbackWithContainer:function(e,t){return function(n){t(n,e)}},hasTrigger:function(e,t){return this._triggers[t.id]&&this._triggers[t.id][e]&&this._triggers[t.id][e].length>0},setComponentListeners:function(e,t){this.hasTrigger(kt.triggers.COMPONENT,t)&&z(t,Et)&&a(this._triggers[t.id][kt.triggers.COMPONENT],function(n){if(n.payload)if(e){this._componentCallbacks[t.id]=this._componentCallbacks[t.id]||[];var r=this.callbackWithContainer(t,this.handleComponent);this._componentCallbacks[t.id].push(r),t.addComponentListener(n.payload,r)}else if(this._componentCallbacks[t.id]){var i=this._componentCallbacks[t.id].pop();i&&t.removeComponentListener(n.payload,i)}},this)},handleTap:function(e,t){var n=this._stateManager.getStateTrigger(t.id);n=n.logInteraction({subtype:ct.subtype.INTERACTION_SELECT,mode:ct.mode.TOUCH,detail:t._node.label}),this.startTriggerPath(this._triggers[t.id][kt.triggers.TAP],t,n)},handleClick:function(e,t){var n=this._stateManager.getStateTrigger(t.id);n=n.logInteraction({subtype:ct.subtype.INTERACTION_SELECT,mode:ct.mode.CLICK,detail:t._node.label}),this.startTriggerPath(this._triggers[t.id][kt.triggers.CLICK],t,n)},handleTapClick:function(e,t){var n=e.info.mode==="mouse"?ct.mode.CLICK:ct.mode.TOUCH,r=this._stateManager.getStateTrigger(t.id);r=r.logInteraction({subtype:ct.subtype.INTERACTION_SELECT,mode:n,detail:t._node.label}),this.startTriggerPath(this._triggers[t.id][kt.triggers.SELECT],t,r)},handleMouseOver:function(e,t){var n=this._stateManager.getStateTrigger(t.id);n=n.logInteraction({subtype:ct.subtype.INTERACTION_HOVER,mode:ct.mode.ROLLOVER,detail:t._node.label});var r=this._triggers[t.id][kt.triggers.MOUSE_OVER];if(r&&r.length>0){var i=function(e){var t=parseFloat(e);return isNaN(t)?0:t},s=c(r,function(e){var t=i(e.duration);return t&&t>0});if(s.length>0){var o=this;a(s,function(e){var r=i(e.duration);this.createTimeout(t,"delayedmouseover",function(){o.startTriggerPath([e],t,n)},r*1e3)},this);var u=this.callbackWithContainer(t,this.handleDelayMouseOut);t.bind(st.events.MOUSE_OUT,u),this._delayedMouseOutFns[t.id]=u}var f=c(r,function(e){var t=i(e.duration);return!t});this.startTriggerPath(f,t,n)}},createTimeout:function(e,t,n,r){this._timeouts[e.id]||(this._timeouts[e.id]={}),this._timeouts[e.id][t]||(this._timeouts[e.id][t]=[]),this._timeouts[e.id][t].push(setTimeout(n,r))},clearTimeouts:function(e,t){if(t){var n=this._timeouts[e.id][t];n&&n.length>0&&(a(n,function(e){clearTimeout(e)}),this._timeouts[e.id][t]=[])}else a(this._timeouts[e.id],function(t,n){this.clearTimeouts(e,n)},this)},handleDelayMouseOut:function(e,t){Q(e.info.position[0].x,e.info.position[0].y)!==t&&(this.clearTimeouts(t,"delayedmouseover"),t.unbind(st.events.MOUSE_OUT,this._delayedMouseOutFns[t.id]))},handleMouseOut:function(e,t){var n=this._stateManager.getStateTrigger(t.id);n=n.logInteraction({subtype:ct.subtype.INTERACTION_HOVER,mode:ct.mode.ROLLOUT,detail:t._node.label}),this.startTriggerPath(this._triggers[t.id][kt.triggers.MOUSE_OUT],t,n)},handleSwipe:function(e,t){var n=this._stateManager.getStateTrigger(t.id),r=c(this._triggers[t.id][kt.triggers.SWIPE],function(t){return t.payload==="any"||t.payload===e.info.direction});r.length>0&&(n=n.logInteraction({subtype:ct.subtype.INTERACTION_SELECT,mode:ct.mode.TOUCH,detail:t._node.label,eventData:{swipe:e.info.direction}}),this.startTriggerPath(r,t,n))},handleVisibilityShown:function(e,t){if(e.visible!==!0)return;var n=this._stateManager.getStateTrigger(t.id);this.startTriggerPath(this._triggers[t.id][kt.triggers.VISIBILITY_SHOWN],t,n)},handleVisibilityHidden:function(e,t){if(e.visible!==!1)return;var n=this._stateManager.getStateTrigger(t.id);this.startTriggerPath(this._triggers[t.id][kt.triggers.VISIBILITY_HIDDEN],t,n)},handleStateChange:function(e,t){if(e.state!==vt.states.ENABLED&&e.state!==vt.states.DISABLED)return;e.state===vt.states.DISABLED&&this.clearTimeouts(t);var n=e.state===vt.states.ENABLED?kt.triggers.STATE_ENABLED:kt.triggers.STATE_DISABLED,r=this._stateManager.getStateTrigger(t.id);this.startTriggerPath(this._triggers[t.id][n],t,r)},handlePinch:function(e,t){var n=this._stateManager.getStateTrigger(t.id);n=n.logInteraction({subtype:ct.subtype.INTERACTION_SELECT,mode:ct.mode.TOUCH,detail:t._node.label}),this.startTriggerPath(this._triggers[t.id][kt.triggers.PINCH],t,n)},handleZoom:function(e,t){var n=this._stateManager.getStateTrigger(t.id);n=n.logInteraction({subtype:ct.subtype.INTERACTION_SELECT,mode:ct.mode.TOUCH,detail:t._node.label}),this.startTriggerPath(this._triggers[t.id][kt.triggers.ZOOM],t,n)},handleShake:function(e,t){if(t._state!==vt.states.ENABLED)return;var n=this._stateManager.getStateTrigger(t.id);n=n.logInteraction({subtype:ct.subtype.INTERACTION_SELECT,mode:ct.mode.MOTION,detail:t._node.label}),this.startTriggerPath(this._triggers[t.id][kt.triggers.SHAKE],t,n)},handleOrientationChange:function(e,t){if(t._state!==vt.states.ENABLED)return;var n=this._stateManager.getStateTrigger(t.id),r=c(this._triggers[t.id][kt.triggers.ORIENTATION_CHANGE],function(t){return t.payload==="any"||t.payload===e.info.orientation});r.length>0&&(n=n.logNotation({subtype:ct.subtype.NOTATION_UPDATE,detail:"Orientation Change",eventData:{component:t._node.label,orientation:e.info.orientation}}),this.startTriggerPath(r,t,n))},handleMessage:function(e,t){if(t._state!==vt.states.ENABLED)return;var n=c(this._triggers[t.id][kt.triggers.ON_MESSAGE],function(t){return t.payload===e.message}),r=e.trigger||this._stateManager.getStateTrigger(t.id);this.startTriggerPath(n,t,r)},handleComponentEnabled:function(e,t){t.unbind(gt.events.ENABLED,this._componentEnabledCallbacks[t.id]),this.setComponentListeners(!0,t)},handleComponent:function(e,t){componentTriggerMatches=c(this._triggers[t.id][kt.triggers.COMPONENT],function(t){return t.payload===e.type});if(componentTriggerMatches.length>0&&this.isStateEnabled(t)){var n=e.trigger||this._stateManager.getStateTrigger(t.id);this.startTriggerPath(componentTriggerMatches,t,n)}},handleStageUnloaded:function(e,t){var n=this._stateManager.getStateTrigger(t.id);n=e.triggerSequence?n.clone(e.triggerSequence):n,this.startTriggerPath(this._triggers[t.id][kt.triggers.STAGE_UNLOADED],t,n)},isStateEnabled:function(e){return this._stateManager.getState(e._node.id)===vt.states.ENABLED},startTriggerPath:function(e,t,n){var r=this;a(e,function(e){a(e.paths,function(e){r.startPath(e,t,n)})})},startPath:function(e,t,n){var r=this,i=r.createPathActionPromises(e,t,n);xt.chain(i)},createPathActionPromises:function(e,t,n){var r=this,i=[];i.push(function(t,r){var i=new xt.Promise;return i.done(null,{pathKey:e,metricsHelper:n}),i});var s=c(r._actions.paths[e],function(e){var t=r._actions.actions[e];return t.type&&t.type!==-1&&r["do"+t.type]});return i=i.concat(d(s,function(e){var n=r._actions.actions[e];return n.key=e,function(e,i){if(e){var s=new xt.Promise;return s.done(e,null),s}return r["do"+n.type](n,i,t)}})),i},doloop:function(e,t,n){var r=this,i=[t.pathKey,"-",e.key].join(""),s=r._pathLoopData[i];s||(s={count:0},r._pathLoopData[i]=s),s.promise=new xt.Promise;var o=e.payload,u=e.options||{},a=parseInt(u.count,10);return o==="forever"||!isNaN(a)&&a>0&&s.count<a?(s.promise.done("voided loop"),at.requestAnimationFrame(function(){r.startPath(t.pathKey,n,t.metricsHelper)}),s.count++):(s.count=0,s.promise.done(null,t)),s.promise},dolink:function(e,t,n){var r=t.metricsHelper,i=this._factory.getClickthroughUrl({url:e.payload,trigger:r&&r.id,component:r&&r.component,detail:e.payload}),s=e.options&&e.options.window?e.options.window:"_blank";if(s==="lightbox")return this.doexpand({payload:L,type:"lightbox",options:{config:{widget_url:i,widget_width:e.options.width||800,widget_height:e.options.height||600,widget_noScrolling:e.options.hideScrollbar}}},t,n);var o=new xt.Promise;return i&&this._factory.getInstance().view.openWindow(i,s),o.done(null,t),o},doapplink:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise;return r.logNotation({subtype:ct.subtype.NOTATION_UPDATE,detail:"App Link",eventData:{url:e.payload}}),$(e.payload,"_top"),i.done(null,t),i},dophone:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise;return r.logNotation({subtype:ct.subtype.NOTATION_UPDATE,detail:"Phone",eventData:{number:e.payload}}),$("tel:"+e.payload,"_top"),i.done(null,t),i},dochangevisibility:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise,s=e.options.visible==="true",o=e.payload==="self"?n.id:e.payload;this._stateManager.setState(o,s?vt.states.ENABLED:vt.states.DISABLED,r);var u=e.payload==="self"?n:this._factory.getContainerById(e.payload);if(u){var a=function(){i.done(null,t)},f=function(){i.done("cancelled",null)};u.visible(s,e.options.animate,a,f),u.trigger(kt.events.TARGETED_ACTION)}else i.done(null,t);return i},doanimate:function(e,t,n){var r=t.metricsHelper,i=this,s=new xt.Promise,o=e.payload==="self"?n:this._factory.getContainerById(e.payload);if(!o||!this.isStateEnabled(o))s.done(null,t);else{var u=i._factory.getAnimation(o,e.options.duration*1e3,e.options.easing.ease),a=function(e){s.done(null,t)},f=function(e){s.done("cancelled",null)};u.cease(),u.bind(at.events.COMPLETE,a),u.bind(at.events.CANCELLED,f),at.requestAnimationFrame(function(){u.run({from:e.options.from,to:e.options.to})}),o.trigger(kt.events.TARGETED_ACTION)}return s},dostage:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise,s=f({stage:parseInt(e.payload,10),type:e.type,trigger:r&&r.id},e.options);return this._expansion.openStage(s),i.done(null,t),i},doexpand:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise,s=f({id:e.payload,type:e.type,trigger:r&&r.id},e.options);return this._expansion.openExpansion(s),i.done(null,t),i},dolightbox:function(e,t,n){return this.dostage(e,t,n)},doresize:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise,s=f({id:e.payload,trigger:r&&r.id},e.options);return this._expansion.resize(s),i.done(null,t),i},dotarget:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise,s=this._factory.getContainerById(e.payload);if(s&&z(s,Et)&&this.isStateEnabled(s)){var o=e.options.args?[e.options.args]:[];s.callComponentFn(e.options.fn,o,r),s.trigger(kt.events.TARGETED_ACTION)}return i.done(null,t),i},dosendmessage:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise;return this.isStateEnabled(n)&&this._messengers[n.id].send(e.payload,e.options,r),i.done(null,t),i},docloseself:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise;return this._expansion.closeSelf({trigger:r&&r.id}),i.done(null,t),i},docloseexpansions:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise;return this._expansion.closeExpansions({trigger:r&&r.id}),i.done(null,t),i},dotracker:function(e,t,n){var r=new xt.Promise;return e.payload&&this._factory.getMetrics().sendTracker(e.payload),r.done(null,t),r},doshare:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise;e.options=e.options||{};var s={url:e.payload,service:e.options.service,body:e.options.description,subject:e.options.title,image:e.options.image,trigger:r},o=this._factory.getShareUrl(s);return o&&this._factory.getInstance().view.openWindow(o,"_blank"),i.done(null,t),i},doemail:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise;return e.options=e.options||{},r.logNotation({subtype:ct.subtype.NOTATION_UPDATE,detail:"Email",eventData:{to:e.payload,subject:e.options.subject,body:e.options.body}}),$("mailto:"+e.payload+"?subject="+encodeURIComponent(e.options.subject)+"&body="+encodeURIComponent(e.options.body),"_top"),i.done(null,t),i},docalendar:function(e,t,n){var i=t.metricsHelper,s=new xt.Promise;e.options=e.options||{};var u={title:e.payload,date:e.options.date};i.logNotation({subtype:ct.subtype.NOTATION_UPDATE,detail:"Calendar",eventData:u});var a;if(o.is.platform.android){var f=e.options.date.split("/"),l=f[2]+f[0]+f[1]+"/"+f[2]+f[0]+f[1];a="http://www.google.com/calendar/event?action=TEMPLATE&text="+e.payload+"&sprop=website:"+r.URLS.runtimeCdn+"&dates="+l}else a=m.getDataUrl("cal",{data:u,regId:this._factory.getInstance().getConfig().regId,appId:this._factory.getInstance().getConfig().appId});return $(a,"_top"),s.done(null,t),s},dojs:function(e,t,n){var r=t.metricsHelper,i=new xt.Promise;e.options=e.options||{name:""};var s=function(e,t){var n="fjs-"+(+(new Date)).toString().substring(7,11),r=o.make("script",{doc:e,attributes:{id:n}});r.text="try { (function() { "+t+"} )(); } catch(ignored) {}; var flite_s=document.getElementById('"+n+"');if(flite_s)document.body.removeChild(flite_s);",e.body.appendChild(r)};return r.logNotation({subtype:ct.subtype.NOTATION_UPDATE,detail:"Execute Javascript",eventData:{name:e.options.name}}),s(o.getExpandableWindow().document,e.payload),i.done(null,t),i},dodelay:function(e,t,n){var r=new xt.Promise,i=parseFloat(e.payload);return i=isNaN(i)?0:i,this.createTimeout(n,"action-"+e.type,function(){r.done(null,t)},i*1e3),r},dometric:function(e,t,n){var r=new xt.Promise,i=t.metricsHelper;return N.u!=typeof e.payload&&""!==e.payload&&i.logNotation({subtype:ct.subtype.NOTATION_ACTION,detail:e.payload}),r.done(null,t),r},tearDownActions:function(e){a(this._listeners[e.id],function(e){e.target.unbind(e.tactileEvent,e.callback)}),this._listeners[e.id]=[],e.unbind(vt.events.STATE_CHANGE,this._stateChangeCallbacks[e.id]),e.unbind(gt.events.ENABLED,this._componentEnabledCallbacks[e.id]),this.setComponentListeners(!1,e),e.css("cursor","default")}},{triggers:{CLICK:"click",COMPONENT:"component",MOUSE_OUT:"mouseout",MOUSE_OVER:"mouseover",ON_MESSAGE:"onmessage",ORIENTATION_CHANGE:"orientationchange",PINCH:"pinch",SELECT:"tapclick",SHAKE:"shake",STATE_ENABLED:"stateenabled",STATE_DISABLED:"statedisabled",SWIPE:"swipe",TAP:"tap",VISIBILITY_HIDDEN:"visibilityhidden",VISIBILITY_SHOWN:"visibilityshown",ZOOM:"zoom",STAGE_UNLOADED:"stageunloaded"},events:{TARGETED_ACTION:"action_targeted"}}),Lt=Z.extend({_instance:null,_config:null,_theme:null,_stateManager:null,_adapter:null,_metrics:null,constructor:function(e,t,n,r,i){this._instance=e,this._config=t,this._stateManager=n,this._adapter=r,this._metrics=i,this._actionController=new kt(this,this._config.getValue("actions")),this._theme=this._config.getValue("theme")||{}},getAdapter:function(){return this._adapter},getStateManager:function(){return this._stateManager},getActionController:function(){return this._actionController},getMetrics:function(){return this._metrics},getContainer:function(e,t){if(e){var n=e.component?new Et(e,this,t):new yt(e,this,t);return At.containers[e.id]=n,n}},getContainerById:function(e){return At.containers[e]},getPartName:function(e){var t=e.component;N.s===typeof e&&(t=e);var n=this.getComponentDefinition(t);return n&&n.partName||""},getPartConfig:function(e){var t=e.component;N.s===typeof e&&(t=e);var n=this.getComponentDefinition(t),r=n&&n.localConfig||{};return new dt(r)},getElement:function(e,t,n){return n=n||ut,e=new n(e,t),this._adapter==="edit"&&(e._setPointerEvents=function(){this.style.pointerEvents="auto"},e.enabled(!1)),e},getComponentDefinition:function(e){var t=Lt.definitions[e];return t||(t=this._config.getValue("components")[e]||this._instance.getConfigValue("components")[e],Lt.definitions[e]=t),t},getAnimation:function(e,t,n){return t=this._adapter!=="edit"?t:0,new at(e,t,n)},getClickthroughUrl:function(e){var t=J(e.url);return!this._adapter&&!e.url.match(/^tel\:/i)&&!e.url.match(/^sms\:/i)&&(t=v.getClickthroughUrl(this._instance,e)),t},getShareUrl:function(e){return v.getShareUrl(this._instance,f(e,{trigger:e.trigger&&e.trigger.id,detail:e.url,component:e.trigger&&e.trigger.component}))},getExpansion:function(){return new nt(this._instance,this._adapter)},getMessenger:function(){return new rt},getSpinner:function(){return new lt(this._theme)},getScroller:function(e,t){var n=this._theme.scrollbarOptions||{};return t=f(t,{sliderColor:q(n.sliderColor)||"#000000",trackColor:q(n.trackColor)||"#FFFFFF"}),new ft(e,t)},getInstance:function(){return this._instance},getData:function(e){return new ht(e,this._instance)},getIframe:function(e,t){var n=this;return t=z(t,ut)?t.dom:t,s.IFrameUtils.getIframe(function(t,r,i){var s=n.getElement(t);e.call(null,s,r,i)},t)}},{definitions:{}}),At=Z.extend({instance:null,assets:null,components:null,mainStage:null,config:null,stateManager:null,layout:null,factory:null,metrics:null,metricsHelper:null,stageId:"__MAIN__",constructor:function(e){At.stage=e.stage,this.instance=e.instance},init:function(){var e=this,t=new xt.Promise;e.config=new dt(e.instance.config,!0),f(dt.variables,e.instance.getAllVariablesMap()),e.adapter=e.config.getValue("adapter"),H.editor=e.adapter==="edit",H.studio=u(["edit","test","preview"],e.adapter),H.screenshot=e.config.getBoolean("screenshot"),H.mobile&&Tt.start(),H.touchPreview=e.config.getValue("adapter_mode")==="touchpreview",H.coppa=e.config.getValue("ed")&&e.config.getValue("ed").coppa==="1",e.assets=e.config.getValue("assets")||{};var n=e.config.getValue("global_assets");o.extend(e.assets,n),e.metrics=new ct(e.instance,e.adapter),e.metricsHelper=new pt(e.metrics,e.instance.metrics.trigger||0),e.stateManager=new vt(e.metricsHelper),e.stateManager.bind(vt.events.STATE_CHANGE,W(e,e._onStateChange)),e.instance.bind("destroy",W(e,function(){var e=this;try{P(),e.stateManager.setState(e.stageId,vt.states.DISABLED),e.stateManager.setState(e.stageId,vt.states.UNLOADED)}catch(t){}}));var r=e.config.getValue("layout"),i=e.config.getValue("components");if(e.instance.view.dataManager){var s=e.config.getValue("actions");e.instance.view.dataManager.fetchData(e.stageId,r,i,s,this.assets,!H.editor).then(function(n,r,i){e.config.setValue("components",r),e.config.setValue("actions",i),e.load(n,r),t.done()})}else e.load(r,i),t.done();return t},load:function(e,t){var n=this;n.factory=new Lt(n.instance,n.config,n.stateManager,n.adapter,n.metrics),n.components=t,n._logInitialData(),n.layout=n.walkTree(e)},walkTree:function(e,t){var n=this,r=[];return a(e,function(e){var i=f({},k,e);i.parent=t||n.stageId;if(i.visibility&&i.visibility.toLowerCase()==="disabled")return;n.stateManager.trackNode(i);var s="view";i.component&&n.factory.getComponentDefinition(i.component)&&(s=n.factory.getComponentDefinition(i.component).type.toLowerCase(),u(["registration","instance"],s)&&(s="component")),i.type=s;if(!i.thumbnail&&i.component){var l=n.factory.getComponentDefinition(i.component);V(l,"info.configParams."+w+".value")&&(i.thumbnail=o.variableReplacement(l.info.configParams[w].value,l.info.configParams))}var c=h(k);a(c,function(e){if("number"==typeof k[e]){var t=parseFloat(i[e]);isNaN(t)?i[e]=k[e]:i[e]=t}});if(i.children)if(z(i.children,Array))i.children=n.walkTree(i.children,i.id);else for(var p in i.children)i.children.hasOwnProperty(p)&&i.children[p]&&(i.children[p]=n.walkTree(i.children[p],i.id));At.nodes[i.id]=i,r.push(i)}),r},render:function(e){var t=this,n=f({},t.config.getValue("stage"),{id:t.stageId,children:{nodes:this.layout},x:e.x,y:e.y,width:e.width,height:e.height,type:"view",overflow:C.h}),r=t.config.getValue("flt.preloader");if(r&&r.clickthrough){var i=[{id:"initialLayer",label:"Initial Layer",x:e.x,y:e.y,width:e.width,height:e.height,overflow:C.h,actions:[{trigger:"tap",payload:r.clickthrough,delay:"",options:{},type:"link"}]}];n.children.nodes=i.concat(this.layout)}return t.mainStage=t.factory.getContainer(n,At.stage),t.gesture=new st(t.mainStage,{instance:t.instance}),t.mainStage.bind(vt.events.LOADED,function(e){Ct.checkOrientation()}),ft.helper.width(e.width),ft.helper.height(e.height),ft.helper.x(-e.width),ft.helper.y(-e.height),t.mainStage.addChild(ft.helper),t.stateManager.trackNode(n),t.stateManager.setState(t.stageId,vt.states.ENABLED),t},_logInitialData:function(){this._logListData(this.components,"Component List"),this._logListData(this.assets,"Asset List")},_logListData:function(e,t){if(e){var n=[],r={};for(var i in e)if(e.hasOwnProperty(i))try{var s=e[i].info.regId;r[s]||(r[s]={regGuid:s,count:0},n.push(r[s])),r[s].count++}catch(o){}n.length>0&&this.metricsHelper.logNotation({subtype:ct.subtype.NOTATION_UPDATE,detail:t,eventData:{components:JSON.stringify(n)}})}},_onStateChange:function(e){for(var t=0,n=e.branch.length;t<n;++t){var r=e.branch[t],i=this.factory.getContainerById(r),s=t<n-1?e.branch[t+1]:null;if(!i){var o=At.nodes[r]&&At.nodes[r].parent;o&&(i=this.factory.getContainerById(o),i&&(s=r,r=o))}if(!i)continue;var u={state:this.stateManager.getState(r),trigger:this.stateManager.getStateTrigger(r)};s&&(u.child={key:s,state:this.stateManager.getState(s),trigger:this.stateManager.getStateTrigger(s)}),i.stateChange(u)}},update:function(e){var t=this,n=e&&e.id&&t.factory.getContainerById(e.id);if(n){var r=At.nodes[e.id],i=f({},e.properties);r&&i.children&&t.walkTree([i],r.parent),t.instance.view.dataManager&&t.instance.view.dataManager.updateData(e.id,i),n.update(i)}},select:function(e){if(!this.factory)return;var t=e&&e.id&&this.factory.getContainerById(e.id),n=e&&e.id&&(t&&t._node||At.nodes[e.id]);if(n){var r={x:n.x,y:n.y,width:n.width,height:n.height,rotation:n.rotation||0},i=n.visibility!=="hidden",s=n;while(i&&s)i=s.visibility!=="hidden",s=s.parent&&At.nodes[s.parent];i&&this.stateManager.setState(e.id,vt.states.ENABLED);if(t){var o=t.rotation();t.rotation(0);var u=t.dom.getBoundingClientRect();if(u.top||u.left||u.height||u.width)r.x=u.left,r.y=u.top,r.rotation=o;t.rotation(o);if(n.overflow&&n.overflow==="visible"&&n.children&&h(n.children).length>0){r.x=r.y=r.width=r.height=null;var f=h(n.children);a(f,function(e){var t=n.children[e];t.length>0&&a(t,function(e){var t=this.select(e),n={x:r.x,y:r.y,width:r.width,height:r.height};r.x=null!==r.x?Math.min(r.x,t.x):t.x,r.y=null!==r.y?Math.min(r.y,t.y):t.y,r.x<n.x&&(r.width+=n.x-r.x),r.y<n.y&&(r.height+=n.y-r.y),r.width=null!==r.width?Math.max(r.width,t.x+t.width-r.x):t.width,r.height=null!==r.height?Math.max(r.height,t.y+t.height-r.y):t.height},this)},this)}}return{x:parseFloat(r.x),y:parseFloat(r.y),width:parseFloat(r.width),height:parseFloat(r.height),rotation:parseFloat(r.rotation)}}},reload:function(e){var t=this,n=At.nodes[e.id],r=e&&e.id&&this.factory.getContainerById(e.id);if(r){var i=f({},e.localConfig);a(i,function(e,t){i[t]=o.variableReplacement(e,dt.variables)}),t.instance.view.dataManager&&t.instance.view.dataManager.replaceData(e.id,r,i),r.reload(i)}else if(n&&n.parent)return t.reload({id:n.parent});return t.select(e)},click:function(e){var t=Q(e.x,e.y);t&&r.flashCallback("layer",t._node.id)},setVariable:function(e){f(dt.variables,e),dt.parsedFlag=+(new Date)}},{stage:null,containers:{},nodes:{}});e.Ukitu=At})(window,document);