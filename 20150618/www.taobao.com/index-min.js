/*! mini-login 2014-07-17 */
KISSY.add("tbc/mini-login/1.4.3/index",function(a,b,c,d,e){function f(){var a='<div id="J_LoginContainer" class="login-container" style="display:none" style="width:'+(y.width+2)+"px;height:"+(y.height+30)+'px">'+'<div class="login-wrapper">'+'<div class="login-hd">\u6dd8\u5b9d\u4f1a\u5458</div>'+'<div class="login-bd">'+'<iframe data-status="0" frameborder="0" width="'+y.width+'" height="'+y.height+'" scrolling="no" id="J_LoginFrame" name="LoginFrame" src="about:blank" onload="_TBC_MiniLogin_Check(this.id, this.name)"></iframe>'+"</div>"+'<div class="login-ft">'+'<a class="login-close J_LoginClose" target="_self" title="\u5173\u95ed\u6b64\u7a97\u53e3" href="javascript:void(0)">\xd7</a>'+"</div>"+"</div>"+"</div>",c=b.create(a);return b.addStyleSheet(A),b.append(c,document.body),g(c),c}function g(a){c.on(a,"click",function(a){var c=a.target;b.hasClass(c,"J_LoginClose")&&m()})}function h(a){a=a||"m";var b=e.get("_l_g_"),c=e.get("lgc");return"m"===a?!!b:"l"==a?!!c:void 0}function i(a,b){return u&&!h(a)?(b&&j(),!1):(d.getScript(w,function(){"undefined"!=typeof loginIndicator&&(loginIndicator.hasLoggedIn?n():b&&j())}),void 0)}function j(){var a,c,d=b.get("#J_LoginContainer");d||(d=f()),a=b.get("#J_LoginFrame"),c=t.build(v,{redirect_url:y.redirect_url,from:y.from}),b.css(d,"display","block"),k(),b.attr(a,"data-status","0"),a.src=z}function k(){l(),c.on(window,C,l)}function l(){var c,d,e=b.get("#J_LoginContainer");a.isObject(q)?(c=q.left||0,d=q.top||0):(c=parseInt(b.viewportWidth()/2)-parseInt(e.offsetWidth/2)+"px",d=(B?b.scrollTop():0)+parseInt(b.viewportHeight()/2)-parseInt(e.offsetHeight/2)+"px"),b.css(e,{top:d,left:c})}function m(){var a=b.get("#J_LoginContainer");return a?(b.css(a,"display","none"),c.remove(window,C,l),void 0):!1}function n(){m(),o&&o()}var o,p,q,r=a.unparam(location.search.slice(1))._login_daily_,s=r||-1!==location.host.indexOf(".daily."),t={getServer:function(a){var b,c,d=/\{(.+?)Server\}/i,e=d.exec(a);return e&&e[1]?(b=e[1],c=s?a.replace(d,"daily."+b+".net"):a.replace(d,b+".com")):c=a,c},build:function(b,c){var d=-1!==b.indexOf("?"),e=d?"&":"?";return a.isObject(c)?b+e+a.param(c):b+e+c}},u=/taobao|tmall/.test(location.host),v=t.getServer("https://login.{taobaoServer}/member/login.jhtml?style=mini&is_ignore=false"),w=t.getServer("http://buy.{taobaoServer}/auction/buy.htm?from=itemDetail"),x=window.g_config?g_config.loginCfg:{},y=a.merge({width:328,height:285,redirect_url:(s?"http://www.daily.taobao.net/":"http://www.taobao.com/")+"go/act/loginsuccess/taobao.php"},x||{}),z=t.build(v,{redirect_url:y.redirect_url,from:y.from}),A=".login-container{opacity:1;position:fixed;_position:absolute;z-index:100000000;background-color:#fafafa;padding:0;overflow:hidden;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;border:3px solid #D5D5D5;}.login-container .login-wrapper{border:1px solid #aaa}.login-container .login-hd{height:35px;line-height:35px;padding-left:14px;font-weight:700;font-size:14px;margin-bottom:25px;background-color:#f2f2f2;}.login-container .login-ft{background-color:#F5F5F5;}.login-container .login-close{color:#9c9c97;font-family:Tahoma,sans;font-size:22px;position:absolute;right:8px;text-decoration:none;top:0;}",B=6===a.UA.ie,C=B?"scroll resize":"resize";return window._TBC_MiniLogin_Check=function(a,c){var d=b.get("#"+a),e=!1;if("0"===b.attr(d,"data-status"))b.attr(d,"data-status","1");else{try{href=win.frames[c].location.host,href?-1===href.indexOf("login")&&n():e=!0}catch(f){e=!0}e&&("m"==p?i():h(p)&&n())}},{check:h,show:function(b,c){a.isFunction(b)?(c=b,type="m"):(b=a.isObject(b)?b:{type:a.isString(b)?b:"m"},type=b.type||"m",q=b.position),p=type,o=c,"m"===type?i(type,!0):h(type)?o&&o():j()},hide:function(){m()},ajax:function(a,b,c){var e=this,f=a.success,g=function(){d(a)};return f?(c=c||"m",a.success=function(a){b(a)?f(a):e.show(c,g)},u&&!h(c)?e.show(c,g):(g(),void 0)):!1}}},{requires:["dom","event","ajax","cookie"]});