/*
 banner_changer-1.1.0.js
 Copyright (c) 2016 Rakuten.Inc
 Date : 2016-02-05 16:28:08
*/
(function(f){if("function"===typeof f){var d={noopF:function(){return!1},getSeconds:function(){return(new Date).getTime()/1E3|0}};d.Storage=function(b){this.isAvailable=function(){if(!window.JSON||!window.JSON.stringify)return!1;try{return window.localStorage.setItem("__testKey__","1"),window.localStorage.removeItem("__testKey__"),!0}catch(b){return!1}};this.set=function(c,a,e){a={d:a};if(0<=e)a.t=d.getSeconds()+e;try{window.localStorage.setItem(b+":"+c,window.JSON.stringify(a))}catch(f){return!1}return!0};
this.get=function(c){var a=window.localStorage.getItem(b+":"+c);if(a)if(a=window.JSON.parse(a),a.t&&a.t<d.getSeconds())this.remove(c);else return a.d};this.remove=function(c){c=b+":"+c;window.localStorage.removeItem(c)};(function(){if(!this.isAvailable())this.set=d.noopF,this.get=f.noop,this.clear=this.remove=d.noopF}).apply(this,arguments)};var j=new d.Storage("bannerChanger"),g=f("#bannerChangerConfig"),l=+g.attr("data-cache-period")||15552E3,k=g.attr("data-target-class")||"bannerChangerTarget",
m=g.attr("data-tgif-url")||"http://yesno.event.rakuten.co.jp/t.gif";f("."+k).each(function(){var b=f(this),c=+b.attr("data-banner-type"),a,e=b.attr("id")+"/"+b.attr("data-round"),d=+b.attr("data-max-times"),i=+j.get(e)||0;a="after";d>i&&(a="before",j.set(e,i+1,l));var i=b.attr("data-image-"+a),h=b.attr("data-tgif-"+a),e=b.attr("data-width-"+a),d=b.attr("data-height-"+a);a=b.attr("data-link-"+a);var h=f("<img>").attr("src",m+(h?"?"+h:"")),g=b.find("a");a&&g.attr("href",a);1===c?(b.css("background-image",
"url("+i+")"),e&&h.attr("width",e),d&&h.attr("height",d),g.append(h)):2===c&&(c=f("<img>").attr("src",i),e&&c.attr("width",e),d&&c.attr("height",d),b.append(h.css("display","none")),g.append(c));b.removeClass(k)})}})(window.jQuery);
