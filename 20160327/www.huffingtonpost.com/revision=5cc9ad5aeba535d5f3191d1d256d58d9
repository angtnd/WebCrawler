!function(){"use strict";function i(i,a){this.pmData=i,this.options=a||{},this.debugTime("Allpapr() created"),e.piximedia.PAM.EventEmitter.forObject(this);var t=i.saleMode;i.minEngagementTime=i.minEngagementTime?parseInt(i.minEngagementTime,10):0,i.minExposureTime=i.minExposureTime?parseInt(i.minExposureTime,10):0,"cpc"===t&&i.minEngagementTime>0?t="cpc":"cpm"===t&&i.minExposureTime>0&&(t="cpmview"),this.salemode=t}var e=window;i.prototype.doWait=function(i){return i()},i.prototype.start=function(){var i=this.pmData,a=i.framedAd,t=a.pam,r=this;this.framedPam=t,this.debugTime("Allpapr.start()"),a&&a.args&&a.args.doNotScaleAllpapr&&(i.doNotScaleAllpapr=a.args.doNotScaleAllpapr),t.loadLibrary("sweetlib.js",function(){r.first=!0;var t=e.piximedia.SweetLib;r.debugTime("Allpapr ready to inject"),a.inject(i.position||"1x1",{},function o(p,n,d,s){if(r.debugTime("Allpapr injected"),n.piximedia=e.piximedia,t.fixTracking(i,d),r.first&&0===d.injectionIndex)for(var l=i.pixelUrl||[],m=0;m<l.length;m++)t.PixelPrinter(l[m]);var c=!0,h=t.startViewTracking(i);s.emit("register-visibility-callback",{callback:"visibility-changed",threshold:70}),s.on("visibility-changed",function(i){h.isVisible=i,c&&(c=!1,d.loadEvent("AP_ALLPAPRHASBEENSEEN"),a.loadEventOnce("AP_SOMETHINGHASBEENSEEN"))}),r.injectedDocument=p,r.injectedWindow=n,i.iframe=s,i.position=d;var g=i.allpapr,u=d.pageContainerWidth,b=t.getPageContainerHints()||{},f=function(){r.debugTime("Allpapr proceed()"),i.wrapper=p.createElement("div"),i.wrapper.id="allpapr-wrapper",p.body.appendChild(i.wrapper),i.decorate_extra_immediately=!0;var a=new e.piximedia.Decoratr({data:i,meta:{adaptive:!!i.doNotScaleAllpapr}});i.asset=a,a.decorate(),a.main.options&&("undefined"!=typeof a.main.options.arch_height&&(g.arch_height=parseInt(a.main.options.arch_height,10)),"undefined"!=typeof a.main.options.container_width&&(g.pc_width=parseInt(a.main.options.container_width,10))),i.allpapr_header&&(g.arch_height=Math.max(g.arch_height,(i.allpapr_header.height||0)+(i.allpapr_header.top||0)));var l=g.inset||b.inset||{},m=l.thickness?parseFloat(l.thickness,10):0,c=u+2*m,h=i.doNotScaleAllpapr?1:c/g.pc_width,f=Math.round(h*g.arch_height)+m,T=Math.round(h*g.width),v=Math.round(h*g.height);r.debugTime("asset.resize()"),a.resize(T),r.debugTime("Allpapr about to resize"),s.emit("resize",{wallpaper:!0,moveTop:f,width:T,height:v,stickToTop:!!r.pmData.stickToTop,moveTopOptions:{duration:0},bodyBackgroundColor:r.pmData.enableBodyBackgroundColor?r.pmData.enableBodyBackgroundColor.bodyBackgroundColor:void 0}),r.debugTime("Allpapr just resized"),i.externalScriptsForPositions&&i.externalScriptsForPositions[d.positionId]&&t.each(i.externalScriptsForPositions[d.positionId],function(e){var a=p.createElement("script");a.src=i.externalScriptsForPositions[d.positionId][e],p.getElementsByTagName("head")[0].appendChild(a)}),setTimeout(function(){r.registeredResponsiveCallback||(r.registeredResponsiveCallback=!0,s.registerResponsiveCallback(function(){return p.close(),p.open(),r.first=!1,null===p.body&&(p.write("<html></html>"),e.piximedia.PAM.emit("ad.inject",p,n,d)),o(p,n,d,s)}))},0)};r.debugTime("Allpapr ready to proceed"),r.first?r.doWait(f):f()})})},i.prototype.debugTime=function(i){this.pmData&&this.pmData.framedAd&&this.pmData.framedAd.pam&&this.pmData.framedAd.pam.debugTime&&this.pmData.framedAd.pam.debugTime("["+(this.pmData.position&&this.pmData.position.positionId?this.pmData.position.positionId:this.pmData.position)+"] "+i)},e.piximedia.Allpapr20150917=i,e.piximedia.libraryLoader&&e.piximedia.libraryLoader["allpapr.20150917.js"]&&(e.piximedia.libraryLoader["allpapr.20150917.js"].complete=!0)}(),function(){var i=window,e="allpapr.20150917.js";i.piximedia.libraryLoader=i.piximedia.libraryLoader||{};var a=i.piximedia.libraryLoader[e];if(a&&(a.complete=!0,a.onloads))for(var t=0;t<a.onloads.length;t++)a.onloads[t]()}();