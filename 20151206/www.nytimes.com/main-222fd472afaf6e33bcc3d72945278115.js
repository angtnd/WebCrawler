define("ab/libs/tracker/tagx_tracker",["ab/vendor/jquery","ab/libs/utils","ab/libs/logger"],function(t,e,r){"use strict";var a=function(t,e){e=e||{},this.attrs={priority:!0},this.queue=[],this.logger=r.get("tagxTracker"),this.isLiteTracking=e.isLiteTracking||!1,t&&this.setAttrs(t),e.liteTracking&&(this.liteTracking=e.liteTracking)};return a.prototype={liteTracking:["allocation"],setAttrs:function(e){this.attrs=t.extend(!0,{},this.attrs,e)},sendImpression:function(t){this.setAttrs({treatment:t}),this.trackEvent({name:"abtest",subject:"adx-ab-allocation",action:"allocation",url:window.location.href}),this.logger.debug("Sending impression with id: "+t),this.setAttrs({subject:"module-interactions"})},trackEvent:function(e){var r,a;if(e=t.extend(!0,{},this.attrs,e),this.isLiteTracking&&-1===t.inArray(e.action,this.liteTracking))return void this.logger.debug("Event Tracker Lite skipped "+JSON.stringify(e));r=e.name||"module-interactions",delete e.name,a="allocation"===e.action?"":"interaction",e.hasOwnProperty("type")&&delete e.type;try{this._send({name:r,data:e,type:a})}catch(i){this._addToQueue({name:r,data:e,type:a})}},_getTracker:function(){return this._trackerInst||(this._trackerInst=TAGX.EventProxy),this._trackerInst},_send:function(t){t.type=t.type||"",this._getTracker().trigger(t.name,t.data,t.type),this.logger.info("Event sent: "+JSON.stringify(t))},_addToQueue:function(t){this.queue.push(t),this._isWorkerSpawned()||this._spawnWorker()},_isWorkerSpawned:function(){return!!this._worker},_spawnWorker:function(){this._worker=setTimeout(t.proxy(this._clearQueue,this),500)},_clearQueue:function(){var t;try{for(;t=this.queue.shift();)this._send(t)}catch(e){this._addToQueue(t),this._spawnWorker()}}},a}),define("ab/tests/bar1/bar1_inyt_hd_1015/main",["ab/vendor/jquery","ab/libs/utils","ab/libs/url","ab/libs/tracking_strategies/delegation_tracking_strategy","ab/libs/tracking_facade","ab/libs/test/strict_test","ab/libs/variation","ab/libs/engine/ga","ab/libs/tracker/tagx_tracker","ab/tests/bar1/bar1_inyt_hd_1015/config"],function(t,e,r,a,i,n,o,s,c,d){"use strict";function u(r){g.removeClass("hidden"),e.appendToHref(d.options.campaignId[r].macros),t.getScript(d.options.adScript)}var l,p=e.inherits(n,{name:"bar1_inyt_hd_1015"}),g=t("#Bar1, #memberTools, .masthead-tools"),h=t.Deferred(),b=200,y=50;"draft"===d.gaStatus&&(l=r.parseCurrentUri().queryKey.country,l&&(window.NYTD=window.NYTD||{},NYTD.countryGroupCode=l)),e.runWhenReady(function(){return!!window.NYTD&&NYTD.countryGroupCode},function(){h.resolve()},b,y),setTimeout(function(){"resolved"!==h.state()&&h.reject()},b*(y+1));var _=[{selector:"#nyt-button-sub, #subscribe_small",category:"cta",action:"click",label:"bar1DualCta"}],m=e.inherits(o,{name:"control",changeDom:function(){this.logger.info("control is applied"),g.prepend(e.Template("bar1_inyt_hd_1015_ctrl")),t("head").append(e.Template("bar1_inyt_hd_1015_style_ctrl")),u("ctrl")},setTracking:function(t){t.setTracking(_)}}),f=function(r){var a=t("#"+r)[0],i=a.innerHTML;if(window.NYTD&&NYTD.countryGroupCode&&d.options.countryGroupData[NYTD.countryGroupCode]){var n=d.options.countryGroupData[NYTD.countryGroupCode];if(n.price&&(i=i.replace(/(<span class="bar1_hdprice_exp">)[^<]*/g,n.price)),n.hdcode){var o=new RegExp(d.options.commonhdlink,"g");i=i.replace(o,d.options.commonhdlink+n.hdcode)}if(d.options.currencyData[n.currency]){var s=d.options.currencyData[n.currency];s.price&&(i=i.replace(/(<span class="bar1_price_exp">)[^<]*/g,s.price)),s.cur&&(i=i.replace(/(%26campaignId)/g,"%26currency%3D"+s.cur+"$1"))}}a.innerHTML=i,e.appendToHref([{selector:"#nyt-button-sub",code:"%26hdCampId%3D"+d.options.countryGroupData[NYTD.countryGroupCode].hdcode},{selector:"#subscribe_small",code:"%26hdCampId%3D"+d.options.countryGroupData[NYTD.countryGroupCode].hdcode},{selector:".split-all-button",code:"%26hdCampId%3D"+d.options.countryGroupData[NYTD.countryGroupCode].hdcode}])},k=e.inherits(o,{name:"Variation1",changeDom:function(){var a=this.logger;h.always(function(){a.info("Variation1 is applied"),g.prepend(e.Template("bar1_inyt_hd_1015_var1")),t("head").append(e.Template("bar1_inyt_hd_1015_style_var1")),u("var1"),f(d.options.var1Selector),d.options.campaignId.var1.params&&r.appendParamsToLinks(d.options.campaignId.var1.params,!1)})},setTracking:function(t){var e=[{selector:"#nyt-button-sub",category:"hover",action:"hover",eventType:"mouseover",label:"hoverCardDisplay"},{selector:".bar1-hd-offer a",category:"cta",action:"click",label:"bar1HoverHdCta"},{selector:".bar1-digi-offer a",category:"cta",action:"click",label:"bar1HoverDigiCta"},{selector:".split-all-button",category:"link",action:"click",label:"bar1HoverDualCta"}];t.setTracking(e.concat(_))}}),T=new s({experimentId:d.experimentId,variationId:s.getForcedVariationId(d.gaStatus,d.forcedVariationId)}),v=new c({expId:d.experimentId,testName:"bar1_inyt_hd_1015",module:"Bar1"},{isLiteTracking:!0});T.getUid().done(function(t){v.setAttrs({UIDplatform:"Google",globalUID:t})});var D=new p({variations:[m,k],trackerFacade:new i({gua:T,tagx:v}),engine:T,trackers:d.trackers||{},trackingStrategy:a});return D.runExperiment(),D});
//# sourceMappingURL=main.js.map