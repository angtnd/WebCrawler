function cnnad_getTransactionID(){return null==cnnad_transactionID&&(cnnad_transactionID="",cnnad_transactionID=Math.round((new Date).getTime()/1e3)+""+Math.floor(9007199254740992*Math.random())),cnnad_transactionID}function cnnad_readCookie(e){if(""==document.cookie)return null;for(var t=document.cookie.split(";"),n=e+"=",i=0;i<t.length;i++){for(var r=t[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(n))return r.substring(n.length,r.length)}return null}function cnnad_haveCookie(e){return document.cookie&&(-1<document.cookie.indexOf("; "+e+"=")||0==document.cookie.indexOf(e+"="))}function cnnad_ugsync(){cnnad_haveCookie("ugs")||document.write('<script src="http://www.ugdturner.com/xd.sjs"></script>')}function krux_getDESegments(){var e="&kxid=";return Krux.user&&(e+=Krux.user),e+="&kxseg="+kvs.join(",")}function krux_getFWSegments(){return"kxseg="+kvs.join(",kxseg=")}function amzn_ads(e){"use strict";try{amznads.updateAds(e)}catch(t){try{console.log("amzn_ads: "+t)}catch(n){}}}function aax_write(e,t){e.write(t),e.close()}function aax_render_ad(e){if(e.passback)return void aax_write(document,e.html);var t=e.slotSize;if(!t)return void aax_write(document,e.html);var n=t.indexOf("x"),i=t.substring(0,n),r=t.substring(n+1),s="amznad"+Math.round(1e6*Math.random());aax_write(document,'<iframe id="'+s+'" width="'+i+'" height="'+r+'" src="javascript:\'\'" scrolling="no" frameborder="0" marginwidth="0" marginheight="0" bgcolor="#FFFFFF" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"></iframe>');var o;try{o=document.getElementById(s);var a=o.contentWindow||o.contentDocument;a.document&&(a=a.document),aax_write(a,e.html)}catch(l){o&&(o.style.display="none")}}function nativoComplete(){"use strict";jQuery(".zn.zn-staggered").each(function(){$staggeredZone=jQuery(this),layoutSize=$staggeredZone.attr("data-eq-state"),$staggeredZone.find(".zn__containers .column").each(function(){$staggeredColumn=jQuery(this),void 0!==$staggeredColumn.attr("class")&&$staggeredColumn.attr("class").indexOf("ntv")>-1&&($nativeContainer=$staggeredColumn.find(".cn").addClass("nativeSponsor").clone(),$staggeredColumn.remove(),$staggeredNativo=$staggeredZone.find(".column"),$staggeredNativo="xsmall"===layoutSize?$staggeredNativo.eq(0).find(".cn").eq(1):$staggeredNativo.eq(1).find(".cn").eq(0),$staggeredNativo.before($nativeContainer))})}),jQuery(".pg-wrapper").find("section.nativeSponsor").addClass("zn-loaded"),jQuery(window).load(function(){$nativeHubCarousel=jQuery(document.getElementById("ntv-videoZone")).find(".js-owl-carousel"),$nativeHubCarousel.length>0&&!isGalleryRendered&&(CNN.Carousel.restore($nativeHubCarousel.parent()),isGalleryRendered=!0)})}function onNativoRenderAd(e){"use strict";nativo.fbFeed=e.facebook_feed,nativo.twFeed=e.twitter_feed,nativo.twitterImage=e.twitter_image,nativo.authorName=e.author_name,nativo.epicAdName=e.native_adv,$nativeEmbedVideo=jQuery(document.getElementById("prx_full_ad_video")),$nativeEmbedVideo.length>0&&$nativeEmbedVideo.parent().addClass("ntv_video_p"),$bigPicture=jQuery(document.getElementById("bigPicture")),$bigPicture.length>0&&!isGalleryRendered&&(nativo.renderGallery(),isGalleryRendered=!0),jQuery(window).load(function(){nativo.renderAuthor(),nativo.renderFacebook(),nativo.renderTwitter(),nativo.renderEpic()})}function changeOwlCarousalWidth(){"use strict";var e=jQuery(".js-pg-sponsor .owl-stage-outer .owl-stage"),t=e.find(".owl-item").length;e.css("width",70*t)}window.Modernizr=function(e,t,n){function i(e){v.cssText=e}function r(e,t){return typeof e===t}function s(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var i in e){var r=e[i];if(!s(r,"-")&&v[r]!==n)return"pfx"==t?r:!0}return!1}function a(e,t,i){for(var s in e){var o=t[e[s]];if(o!==n)return i===!1?e[s]:r(o,"function")?o.bind(i||t):o}return!1}function l(e,t,n){var i=e.charAt(0).toUpperCase()+e.slice(1),s=(e+" "+b.join(i+" ")+i).split(" ");return r(t,"string")||r(t,"undefined")?o(s,t):(s=(e+" "+T.join(i+" ")+i).split(" "),a(s,t,n))}var c,u,d,h="2.8.3",p={},g=!0,f=t.documentElement,m="modernizr",_=t.createElement(m),v=_.style,y=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),C="Webkit Moz O ms",b=C.split(" "),T=C.toLowerCase().split(" "),w={},A=[],P=A.slice,E=function(e,n,i,r){var s,o,a,l,c=t.createElement("div"),u=t.body,d=u||t.createElement("body");if(parseInt(i,10))for(;i--;)a=t.createElement("div"),a.id=r?r[i]:m+(i+1),c.appendChild(a);return s=["&#173;",'<style id="s',m,'">',e,"</style>"].join(""),c.id=m,(u?c:d).innerHTML+=s,d.appendChild(c),u||(d.style.background="",d.style.overflow="hidden",l=f.style.overflow,f.style.overflow="hidden",f.appendChild(d)),o=n(c,e),u?c.parentNode.removeChild(c):(d.parentNode.removeChild(d),f.style.overflow=l),!!o},S={}.hasOwnProperty;d=r(S,"undefined")||r(S.call,"undefined")?function(e,t){return t in e&&r(e.constructor.prototype[t],"undefined")}:function(e,t){return S.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=P.call(arguments,1),i=function(){if(this instanceof i){var r=function(){};r.prototype=t.prototype;var s=new r,o=t.apply(s,n.concat(P.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(P.call(arguments)))};return i}),w.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:E(["@media (",y.join("touch-enabled),("),m,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=9===e.offsetTop}),n},w.geolocation=function(){return"geolocation"in navigator},w.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},w.textshadow=function(){return""===t.createElement("div").style.textShadow},w.csscolumns=function(){return l("columnCount")},w.csstransforms3d=function(){var e=!!l("perspective");return e&&"webkitPerspective"in f.style&&E("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e},w.fontface=function(){var e;return E('@font-face {font-family:"font";src:url("https://")}',function(n,i){var r=t.getElementById("smodernizr"),s=r.sheet||r.styleSheet,o=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"";e=/src/i.test(o)&&0===o.indexOf(i.split(" ")[0])}),e},w.localstorage=function(){try{return localStorage.setItem(m,m),localStorage.removeItem(m),!0}catch(e){return!1}},w.webworkers=function(){return!!e.Worker};for(var k in w)d(w,k)&&(u=k.toLowerCase(),p[u]=w[k](),A.push((p[u]?"":"no-")+u));return p.addTest=function(e,t){if("object"==typeof e)for(var i in e)d(e,i)&&p.addTest(i,e[i]);else{if(e=e.toLowerCase(),p[e]!==n)return p;t="function"==typeof t?t():t,"undefined"!=typeof g&&g&&(f.className+=" "+(t?"":"no-")+e),p[e]=t}return p},i(""),_=c=null,function(e,t){function n(e,t){var n=e.createElement("p"),i=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",i.insertBefore(n.lastChild,i.firstChild)}function i(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function r(e){var t=_[e[f]];return t||(t={},m++,e[f]=m,_[m]=t),t}function s(e,n,i){if(n||(n=t),u)return n.createElement(e);i||(i=r(n));var s;return s=i.cache[e]?i.cache[e].cloneNode():g.test(e)?(i.cache[e]=i.createElem(e)).cloneNode():i.createElem(e),!s.canHaveChildren||p.test(e)||s.tagUrn?s:i.frag.appendChild(s)}function o(e,n){if(e||(e=t),u)return e.createDocumentFragment();n=n||r(e);for(var s=n.frag.cloneNode(),o=0,a=i(),l=a.length;l>o;o++)s.createElement(a[o]);return s}function a(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return v.shivMethods?s(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+i().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function l(e){e||(e=t);var i=r(e);return v.shivCSS&&!c&&!i.hasCSS&&(i.hasCSS=!!n(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||a(e,i),e}var c,u,d="3.7.0",h=e.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,g=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f="_html5shiv",m=0,_={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",c="hidden"in e,u=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(n){c=!0,u=!0}}();var v={elements:h.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:d,shivCSS:h.shivCSS!==!1,supportsUnknownElements:u,shivMethods:h.shivMethods!==!1,type:"default",shivDocument:l,createElement:s,createDocumentFragment:o};e.html5=v,l(t)}(this,t),p._version=h,p._prefixes=y,p._domPrefixes=T,p._cssomPrefixes=b,p.testProp=function(e){return o([e])},p.testAllProps=l,p.testStyles=E,f.className=f.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(g?" js "+A.join(" "):""),p}(this,this.document),function(e,t,n){function i(e){return"[object Function]"==m.call(e)}function r(e){return"string"==typeof e}function s(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function a(){var e=_.shift();v=1,e?e.t?g(function(){("c"==e.t?h.injectCss:h.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),a()):v=0}function l(e,n,i,r,s,l,c){function u(t){if(!p&&o(d.readyState)&&(y.r=p=1,!v&&a(),d.onload=d.onreadystatechange=null,t)){"img"!=e&&g(function(){b.removeChild(d)},50);for(var i in E[n])E[n].hasOwnProperty(i)&&E[n][i].onload()}}var c=c||h.errorTimeout,d=t.createElement(e),p=0,m=0,y={t:i,s:n,e:s,a:l,x:c};1===E[n]&&(m=1,E[n]=[]),"object"==e?d.data=n:(d.src=n,d.type=e),d.width=d.height="0",d.onerror=d.onload=d.onreadystatechange=function(){u.call(this,m)},_.splice(r,0,y),"img"!=e&&(m||2===E[n]?(b.insertBefore(d,C?null:f),g(u,c)):E[n].push(d))}function c(e,t,n,i,s){return v=0,t=t||"j",r(e)?l("c"==t?w:T,e,t,this.i++,n,i,s):(_.splice(this.i++,0,e),1==_.length&&a()),this}function u(){var e=h;return e.loader={load:c,i:0},e}var d,h,p=t.documentElement,g=e.setTimeout,f=t.getElementsByTagName("script")[0],m={}.toString,_=[],v=0,y="MozAppearance"in p.style,C=y&&!!t.createRange().compareNode,b=C?p:f.parentNode,p=e.opera&&"[object Opera]"==m.call(e.opera),p=!!t.attachEvent&&!p,T=y?"object":p?"script":"img",w=p?"script":T,A=Array.isArray||function(e){return"[object Array]"==m.call(e)},P=[],E={},S={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};h=function(e){function t(e){var t,n,i,e=e.split("!"),r=P.length,s=e.pop(),o=e.length,s={url:s,origUrl:s,prefixes:e};for(n=0;o>n;n++)i=e[n].split("="),(t=S[i.shift()])&&(s=t(s,i));for(n=0;r>n;n++)s=P[n](s);return s}function o(e,r,s,o,a){var l=t(e),c=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(r&&(r=i(r)?r:r[e]||r[o]||r[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,r,s,o,a):(E[l.url]?l.noexec=!0:E[l.url]=1,s.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":n,l.noexec,l.attrs,l.timeout),(i(r)||i(c))&&s.load(function(){u(),r&&r(l.origUrl,a,o),c&&c(l.origUrl,a,o),E[l.url]=2})))}function a(e,t){function n(e,n){if(e){if(r(e))n||(d=function(){var e=[].slice.call(arguments);h.apply(this,e),p()}),o(e,d,t,0,c);else if(Object(e)===e)for(l in a=function(){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(),e)e.hasOwnProperty(l)&&(!n&&!--a&&(i(d)?d=function(){var e=[].slice.call(arguments);h.apply(this,e),p()}:d[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),p()}}(h[l])),o(e[l],d,t,l,c))}else!n&&p()}var a,l,c=!!e.test,u=e.load||e.both,d=e.callback||s,h=d,p=e.complete||s;n(c?e.yep:e.nope,!!u),u&&n(u)}var l,c,d=this.yepnope.loader;if(r(e))o(e,0,d,0);else if(A(e))for(l=0;l<e.length;l++)c=e[l],r(c)?o(c,0,d,0):A(c)?h(c):Object(c)===c&&a(c,d);else Object(e)===e&&a(e,d)},h.addPrefix=function(e,t){S[e]=t},h.addFilter=function(e){P.push(e)},h.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",d=function(){t.removeEventListener("DOMContentLoaded",d,0),t.readyState="complete"},0)),e.yepnope=u(),e.yepnope.executeStack=a,e.yepnope.injectJs=function(e,n,i,r,l,c){var u,d,p=t.createElement("script"),r=r||h.errorTimeout;p.src=e;for(d in i)p.setAttribute(d,i[d]);n=c?a:n||s,p.onreadystatechange=p.onload=function(){!u&&o(p.readyState)&&(u=1,n(),p.onload=p.onreadystatechange=null)},g(function(){u||(u=1,n(1))},r),l?p.onload():f.parentNode.insertBefore(p,f)},e.yepnope.injectCss=function(e,n,i,r,o,l){var c,r=t.createElement("link"),n=l?a:n||s;r.href=e,r.rel="stylesheet",r.type="text/css";for(c in i)r.setAttribute(c,i[c]);o||(f.parentNode.insertBefore(r,f),g(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("ios",function(){"use strict";return!!navigator.userAgent.match(/(iPod|iPhone|iPad)/i)}),Modernizr.addTest("android",function(){"use strict";return!!navigator.userAgent.match(/android/i)}),Modernizr.addTest("iemobile",function(){"use strict";return!!navigator.userAgent.match(/iemobile/i)}),Modernizr.addTest("flexbox",Modernizr.testAllProps("flexBasis")),Modernizr.addTest("ie8",function(){"use strict";var e,t=-1,n=navigator.userAgent,i=!1;return n.match(/MSIE/i)&&(e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==e.exec(n)&&(t=parseFloat(RegExp.$1),8===t&&(i=!0))),i}),window.matchMedia||(window.matchMedia=function(){"use strict";var e=window.styleMedia||window.media;if(!e){var t=document.createElement("style"),n=document.getElementsByTagName("script")[0],i=null;t.type="text/css",t.id="matchmediajs-test",n.parentNode.insertBefore(t,n),i="getComputedStyle"in window&&window.getComputedStyle(t,null)||t.currentStyle,e={matchMedium:function(e){var n="@media "+e+"{ #matchmediajs-test { width: 1px; } }";return t.styleSheet?t.styleSheet.cssText=n:t.textContent=n,"1px"===i.width}}}return function(t){return{matches:e.matchMedium(t||"all"),media:t||"all"}}}()),function(e,t,n){"use strict";function i(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t:"function"==typeof define&&define.amd&&define("picturefill",function(){return t}),"object"==typeof e&&(e.picturefill=t)}function r(e){var t,n,i,r,s,l=e||{};t=l.elements||o.getAllElements();for(var c=0,u=t.length;u>c;c++)if(n=t[c],i=n.parentNode,r=void 0,s=void 0,"IMG"===n.nodeName.toUpperCase()&&(n[o.ns]||(n[o.ns]={}),l.reevaluate||!n[o.ns].evaluated)){if(i&&"PICTURE"===i.nodeName.toUpperCase()){if(o.removeVideoShim(i),r=o.getMatch(n,i),r===!1)continue}else r=void 0;(i&&"PICTURE"===i.nodeName.toUpperCase()||!o.sizesSupported&&n.srcset&&a.test(n.srcset))&&o.dodgeSrcset(n),r?(s=o.processSourceSet(r),o.applyBestCandidate(s,n)):(s=o.processSourceSet(n),(void 0===n.srcset||n[o.ns].srcset)&&o.applyBestCandidate(s,n)),n[o.ns].evaluated=!0}}function s(){function n(){clearTimeout(i),i=setTimeout(a,60)}o.initTypeDetects(),r();var i,s=setInterval(function(){return r(),/^loaded|^i|^c/.test(t.readyState)?void clearInterval(s):void 0},250),a=function(){r({reevaluate:!0})};e.addEventListener?e.addEventListener("resize",n,!1):e.attachEvent&&e.attachEvent("onresize",n)}if(e.HTMLPictureElement)return void i(function(){});t.createElement("picture");var o=e.picturefill||{},a=/\s+\+?\d+(e\d+)?w/;o.ns="picturefill",function(){o.srcsetSupported="srcset"in n,o.sizesSupported="sizes"in n,o.curSrcSupported="currentSrc"in n}(),o.trim=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},o.makeUrl=function(){var e=t.createElement("a");return function(t){return e.href=t,e.href}}(),o.restrictsMixedContent=function(){return"https:"===e.location.protocol},o.matchesMedia=function(t){return e.matchMedia&&e.matchMedia(t).matches},o.getDpr=function(){return e.devicePixelRatio||1},o.getWidthFromLength=function(e){var n;if(!e||e.indexOf("%")>-1!=!1||!(parseFloat(e)>0||e.indexOf("calc(")>-1))return!1;e=e.replace("vw","%"),o.lengthEl||(o.lengthEl=t.createElement("div"),o.lengthEl.style.cssText="border:0;display:block;font-size:1em;left:0;margin:0;padding:0;position:absolute;visibility:hidden",o.lengthEl.className="helper-from-picturefill-js"),o.lengthEl.style.width="0px";try{o.lengthEl.style.width=e}catch(i){}return t.body.appendChild(o.lengthEl),n=o.lengthEl.offsetWidth,0>=n&&(n=!1),t.body.removeChild(o.lengthEl),n},o.detectTypeSupport=function(t,n){var i=new e.Image;return i.onerror=function(){o.types[t]=!1,r()},i.onload=function(){o.types[t]=1===i.width,r()},i.src=n,"pending"},o.types=o.types||{},o.initTypeDetects=function(){o.types["image/jpeg"]=!0,o.types["image/gif"]=!0,o.types["image/png"]=!0,o.types["image/svg+xml"]=t.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),o.types["image/webp"]=o.detectTypeSupport("image/webp","data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=")},o.verifyTypeSupport=function(e){var t=e.getAttribute("type");if(null===t||""===t)return!0;var n=o.types[t];return"string"==typeof n&&"pending"!==n?(o.types[t]=o.detectTypeSupport(t,n),"pending"):"function"==typeof n?(n(),"pending"):n},o.parseSize=function(e){var t=/(\([^)]+\))?\s*(.+)/g.exec(e);return{media:t&&t[1],length:t&&t[2]}},o.findWidthFromSourceSize=function(n){for(var i,r=o.trim(n).split(/\s*,\s*/),s=0,a=r.length;a>s;s++){var l=r[s],c=o.parseSize(l),u=c.length,d=c.media;if(u&&(!d||o.matchesMedia(d))&&(i=o.getWidthFromLength(u)))break}return i||Math.max(e.innerWidth||0,t.documentElement.clientWidth)},o.parseSrcset=function(e){for(var t=[];""!==e;){e=e.replace(/^\s+/g,"");var n,i=e.search(/\s/g),r=null;if(-1!==i){n=e.slice(0,i);var s=n.slice(-1);if((","===s||""===n)&&(n=n.replace(/,+$/,""),r=""),e=e.slice(i+1),null===r){var o=e.indexOf(",");-1!==o?(r=e.slice(0,o),e=e.slice(o+1)):(r=e,e="")}}else n=e,e="";(n||r)&&t.push({url:n,descriptor:r})}return t},o.parseDescriptor=function(e,t){var n,i=t||"100vw",r=e&&e.replace(/(^\s+|\s+$)/g,""),s=o.findWidthFromSourceSize(i);if(r)for(var a=r.split(" "),l=a.length-1;l>=0;l--){var c=a[l],u=c&&c.slice(c.length-1);if("h"!==u&&"w"!==u||o.sizesSupported){if("x"===u){var d=c&&parseFloat(c,10);n=d&&!isNaN(d)?d:1}}else n=parseFloat(parseInt(c,10)/s)}return n||1},o.getCandidatesFromSourceSet=function(e,t){for(var n=o.parseSrcset(e),i=[],r=0,s=n.length;s>r;r++){var a=n[r];i.push({url:a.url,resolution:o.parseDescriptor(a.descriptor,t)})}return i},o.dodgeSrcset=function(e){e.srcset&&(e[o.ns].srcset=e.srcset,e.srcset="",e.setAttribute("data-pfsrcset",e[o.ns].srcset))},o.processSourceSet=function(e){var t=e.getAttribute("srcset"),n=e.getAttribute("sizes"),i=[];return"IMG"===e.nodeName.toUpperCase()&&e[o.ns]&&e[o.ns].srcset&&(t=e[o.ns].srcset),t&&(i=o.getCandidatesFromSourceSet(t,n)),i},o.backfaceVisibilityFix=function(e){var t=e.style||{},n="webkitBackfaceVisibility"in t,i=t.zoom;n&&(t.zoom=".999",n=e.offsetWidth,t.zoom=i)},o.setIntrinsicSize=function(){var n={},i=function(e,t,n){t&&e.setAttribute("width",parseInt(t/n,10))};return function(r,s){var a;r[o.ns]&&!e.pfStopIntrinsicSize&&(void 0===r[o.ns].dims&&(r[o.ns].dims=r.getAttribute("width")||r.getAttribute("height")),r[o.ns].dims||(s.url in n?i(r,n[s.url],s.resolution):(a=t.createElement("img"),a.onload=function(){if(n[s.url]=a.width,!n[s.url])try{t.body.appendChild(a),n[s.url]=a.width||a.offsetWidth,t.body.removeChild(a)}catch(e){}r.src===s.url&&i(r,n[s.url],s.resolution),r=null,a.onload=null,a=null},a.src=s.url)))}}(),o.applyBestCandidate=function(e,t){var n,i,r;e.sort(o.ascendingSort),i=e.length,r=e[i-1];for(var s=0;i>s;s++)if(n=e[s],n.resolution>=o.getDpr()){r=n;break}r&&(r.url=o.makeUrl(r.url),t.src!==r.url&&(o.restrictsMixedContent()&&"http:"===r.url.substr(0,"http:".length).toLowerCase()?void 0!==window.console&&console.warn("Blocked mixed content image "+r.url):(t.src=r.url,o.curSrcSupported||(t.currentSrc=t.src),o.backfaceVisibilityFix(t))),o.setIntrinsicSize(t,r))},o.ascendingSort=function(e,t){return e.resolution-t.resolution},o.removeVideoShim=function(e){var t=e.getElementsByTagName("video");if(t.length){for(var n=t[0],i=n.getElementsByTagName("source");i.length;)e.insertBefore(i[0],n);n.parentNode.removeChild(n)}},o.getAllElements=function(){for(var e=[],n=t.getElementsByTagName("img"),i=0,r=n.length;r>i;i++){var s=n[i];("PICTURE"===s.parentNode.nodeName.toUpperCase()||null!==s.getAttribute("srcset")||s[o.ns]&&null!==s[o.ns].srcset)&&e.push(s)}return e},o.getMatch=function(e,t){for(var n,i=t.childNodes,r=0,s=i.length;s>r;r++){var a=i[r];if(1===a.nodeType){if(a===e)return n;if("SOURCE"===a.nodeName.toUpperCase()){null!==a.getAttribute("src")&&void 0!==typeof console&&console.warn("The `src` attribute is invalid on `picture` `source` element; instead, use `srcset`.");var l=a.getAttribute("media");if(a.getAttribute("srcset")&&(!l||o.matchesMedia(l))){var c=o.verifyTypeSupport(a);if(c===!0){n=a;break}if("pending"===c)return!1}}}}return n},s(),r._=o,i(r)}(window,window.document,new window.Image),!function(e){"use strict";function t(){return c&&c.call(l)||(new Date).getTime()}var n=[],i={},r={},s=function(){},o="-----";o+=o,o+=o,o+=o,o+=o;var a="\n\n\n\n\n\n",l=window.performance,c=l&&(l.now||l.mozNow||l.msNow||l.oNow||l.webkitNow);e.log||(e.log=s),e.profile||(e.profile=s),e.profileEnd||(e.profileEnd=s),e.timeStamp||(e.timeStamp=s),e.trace||(e.trace=s),e.debug||(e.debug=e.log),e.info||(e.info=e.log),e.warn||(e.warn=e.log),e.error||(e.error=e.log),e.dir||(e.dir=e.log),e.dirxml||(e.dirxml=e.dir);var u=!1;(u||!e.group)&&(e.group=function(t){n.push(t),e.log(o+"\nBEGIN GROUP: "+t)}),(u||!e.groupCollapsed)&&(e.groupCollapsed=e.group),(u||!e.groupEnd)&&(e.groupEnd=function(){e.log("END GROUP: "+n.pop()+"\n"+o)}),(u||!e.time)&&(e.time=function(e){i[e]=t()}),(u||!e.timeEnd)&&(e.timeEnd=function(n){e.log(n+": "+(t()-i[n]).toFixed(3)+"ms"),delete i[n]}),(u||!e.assert)&&(e.assert=function(t,n){t||e.error("Assertion failed: "+n)}),(u||!e.count)&&(e.count=function(t){r[t]||(r[t]=0),r[t]++,e.log(t+": "+r[t])}),(u||!e.clear)&&(e.clear=function(){e.log(a)})}(window.console=window.console||{}),!window.addEventListener&&function(e,t,n,i,r,s,o){e[i]=t[i]=n[i]=function(e,t){var n=this;o.unshift([n,e,t,function(e){e.currentTarget=n,e.preventDefault=function(){e.returnValue=!1},e.stopPropagation=function(){e.cancelBubble=!0},e.target=e.srcElement||n,t.call(n,e)}]),this.attachEvent("on"+e,o[0][3])},e[r]=t[r]=n[r]=function(e,t){for(var n,i=0;n=o[i];++i)if(n[0]==this&&n[1]==e&&n[2]==t)return this.detachEvent("on"+e,o.splice(i,1)[0][3])},e[s]=t[s]=n[s]=function(e){return this.fireEvent("on"+e.type,e)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),("undefined"==typeof CustomEvent||"function"!=typeof CustomEvent)&&!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n;return document.createEvent?(n=document.createEvent("CustomEvent"),n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail)):document.createEventObject&&(n=document.createEventObject()),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(0===r)return-1;var s=+t||0;if(1/0===Math.abs(s)&&(s=0),s>=r)return-1;for(n=Math.max(s>=0?s:r-Math.abs(s),0);r>n;){if(n in i&&i[n]===e)return n;n++}return-1}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),window.domLoadEventFired=!1,window.addEventListener?window.addEventListener("DOMContentLoaded",function(){window.domLoadEventFired=!0},!1):window.attachEvent&&window.attachEvent("onDOMContentLoaded",function(){window.domLoadEventFired=!0});var googletag=googletag||{};googletag.cmd=googletag.cmd||[];var slots=slots||[];!function(){"use strict";var e=document.createElement("script"),t="https:"===document.location.protocol,n=document.getElementsByTagName("script")[0];e.async=!1,e.type="text/javascript",e.src=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js",n.parentNode.insertBefore(e,n)}(),function(){"use strict";if("undefined"==typeof window.AMPTManager)try{window.AMPTManager={activeRegistry:-1,debug:!1,networkId:"8663477",capTargeting:{adTargets:{},slotTargets:{}},userID:null,docDomain:"",adTileIDGroup:[],tileExemptions:[],existingDivs:[],clearedDivs:[],newTileIDIteration:0,requestSent:!1,slotCount:0,pageSlots:[],pageSlotsObj:{},clientWidth:0,passedTargeting:[],requestScriptText:[],initialized:!1,focused:!0,refreshOnFocusOnly:!1,addEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},init:function(){var e=function(){var e=[];return e.push=function(){var e=Array.prototype.push.apply(this,arguments);return AMPTManager.networkId=AMPTManager.registry[e-1][0].gpt_id,AMPTManager.activeRegistry=e-1,AMPTManager.setCapTargeting(e-1),AMPTManager.registry[e-1][0].requested=!1,AMPTManager.registry[e-1][0].rktr_id,AMPTManager.requestAndRenderAds(),e},e};AMPTManager.registry=new e,AMPTManager.getViewportDimensions(),AMPTManager.setFocusListener(),AMPTManager.setSlotRenderedListener(),this.initialized=!0},setSlotRenderedListener:function(){googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",function(e){var t=new CustomEvent("GPTRenderComplete",{detail:{asset:e.slot,pos:e.slot.getTargeting("pos"),empty:e.isEmpty}});document.dispatchEvent(t)})})},setCapTargeting:function(e){var t;if(t="undefined"!=typeof AMPTManager.registry[e][0].root?AMPTManager.registry[e][0].root.toUpperCase():AMPTManager.registry[e][0].site.toUpperCase(),AMPTManager.registry[e][0].capTargeting={adTargets:[],slotTargets:{}},"undefined"!=typeof window[t]){AMPTManager.capTargeting.adTargets=window[t].adTargets?JSON.parse(JSON.stringify(window[t].adTargets)):[],AMPTManager.capTargeting.slotTargets=window[t].slotTargets?JSON.parse(JSON.stringify(window[t].slotTargets)):{},AMPTManager.registry[e][0].capTargeting=AMPTManager.capTargeting;for(var n in AMPTManager.capTargeting)AMPTManager.capTargeting.hasOwnProperty(n)&&AMPTManager.passedTargeting.indexOf(n)<0&&AMPTManager.passedTargeting.push(n);AMPTManager.capTargeting=AMPTManager.registry[e][0].capTargeting}},addPageLevelTarget:function(e,t){var n=AMPTManager.capTargeting;n.adTargets[e]=t,AMPTManager.capTargeting=n;try{googletag.pubads().setTargeting(e,t)}catch(i){AMPTManager.logit({error_calling_setTargeting:i})}},removePageLevelTarget:function(e){var t=AMPTManager.capTargeting;delete t.adTargets[e],AMPTManager.capTargeting=t;try{googletag.pubads().clearTargeting(e)}catch(n){AMPTManager.logit({error_calling_clearTargeting:n})}},addSlotLevelTarget:function(e,t,n){googletag.cmd.push(function(){var i=AMPTManager.capTargeting;"undefined"==typeof i.slotTargets[e]&&(i.slotTargets[e]={}),i.slotTargets[e][t]=n,AMPTManager.capTargeting=i,AMPTManager.pageSlotsObj[e].setTargeting(t,n)})},removeSlotLevelTargets:function(e){var t=AMPTManager.capTargeting;t.slotTargets[e]={},AMPTManager.capTargeting=t;var n=AMPTManager.pageSlotsObj[e].getTargeting("pos");AMPTManager.pageSlotsObj[e].clearTargeting(),AMPTManager.addSlotLevelTarget(e,"pos",n)},setFocusListener:function(){AMPTManager.addEvent(window,"focus",function(){AMPTManager.focused=!0}),AMPTManager.addEvent(window,"blur",function(){AMPTManager.focused=!1})},getViewportDimensions:function(){AMPTManager.clientWidth=document.documentElement.clientWidth,AMPTManager.clientHeight=document.documentElement.clientHeight,AMPTManager.windowOrientation=window.orientation?window.orientation:0,(90==AMPTManager.windowOrientation||-90==AMPTManager.windowOrientation)&&AMPTManager.clientWidth<AMPTManager.clientHeight&&(AMPTManager.clientWidth=AMPTManager.clientHeight,AMPTManager.clientHeight=document.documentElement.clientWidth)},readCookie:function(e){if(""===document.cookie)return null;for(var t=document.cookie.split(";"),n=e+"=",i=0;i<t.length;i++){for(var r=t[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(n))return r.substring(n.length,r.length)}return null},logit:function(e,t){(window.location.href.indexOf("debug=true")>-1||1==AMPTManager.debug)&&(t=t?t:"MESSAGE FROM ADFUEL.JS: ","undefined"!=typeof console&&"undefined"!=typeof console.log&&(console.group(t),"string"==typeof e?console.log(e):console.dir(e),console.groupEnd()))},convertToArray:function(e){var t,n=[];for(t in e)n.push([t,e[t]]);return n},addContentTargeting:function(e,t,n){var i={};i[e]=[],i[e].push(t),i[e].push(n),AMPTManager.capTargeting.push(i)},addTargetingToSlot:function(e,t,n){var i,r,s,o,a,l,c,u,d,h,p;Array.isArray(n[0])===!1&&(n=[n]);for(i in e)if(r=e[i],r.rktr_slot_id==t){a=r.targeting,Array.isArray(a)===!1&&(a=[a]);for(o in n){h=!1,u=n[o][0],d=n[o][1];for(s in a)if(l=a[s][0],c=a[s][1],l==u){if(h=!0,1!=Array.isArray(c)&&(c=[c]),Array.isArray(d))for(p in d)c.indexOf(d[p])<0&&c.push(d[p]);else c.indexOf(d)<0&&c.push(d);a[s][1]=c}h===!1&&(a.push([u,d]),h=!0),e[i].targeting=a}}return e},combineTargeting:function(e,t){var n,i,r=e[0];for(var s in t.adTargets){if(t.adTargets.hasOwnProperty(s)){var n=s,i=t.adTargets[n];(1==i||0==i)&&(i=String(i))}r.targeting.push([n,i])}if(e[0]=r,"undefined"!=typeof r.orig_slot_id){for(var s in t.slotTargets)if(t.slotTargets.hasOwnProperty(s)){var o=s;if(o==r.orig_slot_id)for(var a in t.slotTargets[s]){if(t.slotTargets[s].hasOwnProperty(a)){var n=a,i=t.slotTargets[s][a];(1==i||0==i)&&(i=String(i))}e[1].targeting.push([n,i])}}}else for(var l=1;l<e.length;l++){var c=e[l];for(var s in t.slotTargets)if(t.slotTargets.hasOwnProperty(s)){var o=s;if(o==c.rktr_slot_id)for(var a in t.slotTargets[s]){if(t.slotTargets[s].hasOwnProperty(a)){var n=a,i=t.slotTargets[s][a];(1==i||0==i)&&(i=String(i))}c.targeting.push([n,i])}}e[l]=c}return e},incrementDivId:function(e,t){var n=this.registry,i=n[e][t],r=document.getElementById("ad-clear-script").previousElementSibling,s=r.id,o=s.split("_"),a=parseInt(o[o.length-1]),l=a+1;10>l?(l="0"+String(l),a="0"+String(a)):(l=String(l),a=String(a)),o[o.length-1]=l;var s=o.join("_");return i.rktr_slot_id=s,r.id=r.id.replace(a,l),AMPTManager.logit({regSlot:i,pageSlot:r}),this.registry[e][t]=i,AMPTManager.existingDivs.indexOf(r.id)<0&&AMPTManager.existingDivs.push(r.id),!0},mangleDivId:function(e,t){var n=(this.registry,this.registry[e][t]);if("undefined"!=typeof n&&n.rktr_slot_id.indexOf("ad_mod_")<0){var i=n.rktr_slot_id.split("_"),r=i[i.length-1],s=i.join("_"),o=i.join("_");for(AMPTManager.logit(s,"Mangling Div Id");this.existingDivs.indexOf(o)>=0;)r=parseInt(r)+1,r=10>r?"0"+String(r):String(r),i[i.length-1]=r,o=i.join("_");AMPTManager.logit(o,"Mangled Div Id"),n.rktr_slot_id=o;var a=document.querySelectorAll("div#"+s);if(a.length>1){var l=document.querySelectorAll("div#"+s)[1];l.id=o}return this.registry[e][t]=n,this.existingDivs.indexOf(o)<0&&this.existingDivs.push(o),n.rktr_slot_id}return""},buildSlotMapping:function(e,t){for(var n="var "+e+"_mapping = googletag.sizeMapping()\n",i=0;i<t.length;i++){var r=t[i];n+="		.addSize(["+r[0][0]+", "+r[0][1]+"], [";for(var s=0;s<r[1].length;s++){var o=r[1][s];"suppress"!==o&&(n+="["+o[0]+", "+o[1]+"], ")}"suppress"!==r[1][0]&&(n=n.substr(0,n.length-2)),n+="]",n+=")\n"}return n+="		.build();"},processNewRegistry:function(e){AMPTManager.logit(e,"Processing New Registry");var t=document.createElement("script");t.src=e,t.type="text/javascript";var n=document.getElementsByTagName("head")[0];n.appendChild(t),AMPTManager.requestAndRenderAds()},generateMiniGUID:function(){return"xxxxyxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;
return n.toString(16)}).toString()},clearSlot:function(e){AMPTManager.logit("CLEARING SLOT: "+e);var t=AMPTManager.pageSlotsObj[e];if(AMPTManager.logit({div:e,slot:t},"Clearing Slot"),"undefined"!=typeof t)try{googletag.cmd.push(function(){googletag.pubads().clear([t]);var n=AMPTManager.existingDivs.indexOf(e);AMPTManager.existingDivs.splice(n,1),AMPTManager.logit({div:e,slot:t},"Slot Cleared"),AMPTManager.clearedDivs.indexOf(e)<0&&AMPTManager.clearedDivs.push(e)})}catch(n){AMPTManager.logit({error_calling_clear:n})}},clearSlots:function(e){for(var t in e){var n=AMPTManager.pageSlotsObj[t];if("undefined"!=typeof n)try{googletag.cmd.push(function(){googletag.pubads().clear([n]);var e=AMPTManager.existingDivs.indexOf(t);AMPTManager.existingDivs.splice(e,1),AMPTManager.clearedDivs.push(t)})}catch(i){AMPTManager.logit({error_calling_clear:i})}}},clearAllSlots:function(){try{googletag.pubads().clear()}catch(e){AMPTManager.logit({error_calling_clear:e})}AMPTManager.clearedDivs=JSON.parse(JSON.stringify(existingDivs))},renderSingleSlot:function(e,t,n,i,r){var s=0;if(0==this.initialized)for(this.init();0==this.initialized&&(s++,!(1==this.initialized||s>1e3)););var o,a=AMPTManager.networkId,l="ad_mod_"+AMPTManager.generateMiniGUID(),c=document.getElementById(e),u=document.querySelectorAll("div#"+e),d=e;if("undefined"!=typeof c&&u.length>1&&(c.id=l,e=l),r.indexOf("/")>=0){if(o=r.split("/")[0],parseInt(o)>0){a=o,o=r.split("/")[1];var h=r.split("/");h.splice(0,1),r=h.join("/")}}else o=r;var p={rktr_slot_id:"page",rktr_id:"sponsoredAdPage",gpt_id:a,orig_slot_id:d,site:o,root:o,targeting:[],responsive:[],requested:!1};if(document.location.search.indexOf("adsqa=")>0){AMPTManager.passedTargeting.push("status");var g=this.getURLParam("adsqa").split("%3D");p.targeting.push(["status",g])}for(var f=["transId","kuid","ksg","guid"],m=0;m<=n.length;m++){var _=n[m];"undefined"!=typeof _&&f.indexOf(_[0])>=0&&(p.targeting.push(_),n.splice(m,1),m-=1)}for(var v in p.targeting)if(p.targeting.hasOwnProperty(v))for(var y=p.targeting[v],m=0;m<n.length;m++)if(n.hasOwnProperty(m)){var _=n[m];y[0]==_[0]&&(n.splice(m,1),m-=1)}t=t?t:[[88,31]],n=n?n:[],i=i?i:[];var C={};C.present=!0,C.responsive=i,C.rktr_slot_id=e,C.sizes=t,C.targeting=n,C.rktr_ad_id=r;var b=[p,C];"undefined"!=typeof p&&"undefined"!=typeof C&&AMPTManager.registry.push(b)},buildRequest:function(e,t){var n,i,r,s,o,a,l;this.targeting=t?t:this.capTargeting;var c=e,u=this.registry[e];if(null==u[u.length-1]&&u.pop(),o=AMPTManager.networkId,"undefined"!=typeof u&&(i=u[0],"undefined"==typeof i.requestScriptText)){u=this.combineTargeting(u,u[0].capTargeting),i.responsive=i.responsive?i.responsive:{};var n="";for(n+="googletag.cmd.push(function(){\n",this.pageLevelSettings=i,r=1;r<u.length;r++){if(s=u[r],"undefined"!=typeof s&&"undefined"!=typeof document.getElementById(s.rktr_slot_id)&&null!=document.getElementById(s.rktr_slot_id)){this.slotCount,s.present=!0,s.index=this.slotCount;var d=!0;if(AMPTManager.logit({existing:AMPTManager.existingDivs,cleared:AMPTManager.clearedDivs}),this.existingDivs.indexOf(s.rktr_slot_id)>=0&&this.mangleDivId(c,r),AMPTManager.logit({slot:s.rktr_slot_id}),this.clearedDivs.indexOf(s.rktr_slot_id)>=0&&this.incrementDivId(c,r),1==d){this.existingDivs.indexOf(s.rktr_slot_id)<0&&this.existingDivs.push(s.rktr_slot_id),n+=s.rktr_slot_id.indexOf("_oop")>=1?"	AMPTManager.pageSlotsObj['"+s.rktr_slot_id+"'] = googletag.defineOutOfPageSlot('/"+o+"/"+s.rktr_ad_id+"', '"+s.rktr_slot_id+"')\n":"	AMPTManager.pageSlotsObj['"+s.rktr_slot_id+"'] = googletag.defineSlot('/"+o+"/"+s.rktr_ad_id+"', "+JSON.stringify(s.sizes)+", '"+s.rktr_slot_id+"')\n",n+="		.addService(googletag.pubads())\n";var h=s.targeting;Array.isArray(h)===!1&&(h=[h]);for(a in h)if(h.hasOwnProperty(a)){var p;if(p="undefined"!=typeof h[a]?JSON.stringify(h[a][1]):"","undefined"!=typeof p&&""!=p){try{p=p.replace(/"/g,"'",!0)}catch(g){}if("exclusions"==h[a][0])if(1==h[a][1].isArray())for(var f in h[a][1])p=h[a][1][f],n+="		.setCategoryExclusion('"+p+"')";else n+="		.setCategoryExclusion('"+p+"')";else n+="		.setTargeting('"+h[a][0]+"', ",n+=p+")";a==h.length-1&&(n+=";"),n+="\n"}}if(s.responsive=s.responsive?s.responsive:[],s.responsive.length>0){var m=this.buildSlotMapping(s.rktr_slot_id,s.responsive);n+="	"+m+"\n",n+='	AMPTManager.pageSlotsObj["'+s.rktr_slot_id+'"].defineSizeMapping('+s.rktr_slot_id+"_mapping);\n"}this.slotCount++}}else"undefined"!=typeof s?AMPTManager.logit(s.rktr_slot_id,"Div ID is not present."):AMPTManager.logit(s,"Slot is undefined.");u[r]=s}this.registry[c]=u,n+="	googletag.pubads()\n";var _=AMPTManager.readCookie("gptgeo");AMPTManager.logit({latlong1:_}),null!=_?(AMPTManager.logit({latlong2:_}),_=_.split("%2C"),AMPTManager.logit({latlong3:_}),n+="		.setLocation("+parseFloat(_[0])+","+parseFloat(_[1])+")\n"):AMPTManager.logit("Unable to retrieve location cookie.");for(l in i.targeting){var p=i.targeting[l][1];if("undefined"!=typeof p&&"function"!=typeof p&&null!=p&&""!=p){try{p=p.replace(/"/g,"'",!0)}catch(g){}if("exclusions"==i.targeting[l][0])if(1==i.targeting[l][1].isArray())for(var f in i.targeting[l][1])p=i.targeting[l][1][f],n+="		.setCategoryExclusion('"+p+"')\n";else n+="		.setCategoryExclusion('"+p+"')\n";else n+="		.setTargeting('"+i.targeting[l][0]+"', ";p.indexOf(",")>=0&&(p=p.split(",")),0==Array.isArray(p)&&(p=[p]),n+=JSON.stringify(p)+")",n+="\n"}if(l==i.targeting.length-1&&document.location.search.indexOf("adsqa=")>0){AMPTManager.passedTargeting.push("status");var v=this.getURLParam("adsqa").split("%3D");n+="		.setTargeting('"+decodeURIComponent(v[0])+"', '"+decodeURIComponent(v[1])+"');\n"}}return"undefined"==typeof i.singleSlot&&(n+="	googletag.pubads().collapseEmptyDivs(true);\n",n+="	googletag.pubads().enableSingleRequest();\n"),n+="	googletag.enableServices();\n",n+="});",this.requestScriptText.push(n),u[0].requestScriptText=n,AMPTManager.logit(n,"Generated GPT Request"),n}},sendRequest:function(e){var t=AMPTManager.registry[e];if("undefined"!=typeof t&&"undefined"!=typeof t[0]&&0==t[0].requested){"undefined"==typeof t[0].requestScriptText&&(t[0].requestScriptText=AMPTManager.buildRequest(e,AMPTManager.capTargeting));var n,i;t[0].requestScriptText,n=document.createElement("script"),n.type="text/javascript",n.text=this.requestScriptText[this.requestScriptText.length-1],i=document.getElementsByTagName("head")[0],AMPTManager.logit(n,"Sending GPT Request"),i.appendChild(n),t[0].requested=!0,AMPTManager.requestSent=!0}else"undefined"!=typeof t&&t[0].requestScriptText;var r=new CustomEvent("AdFuelRequestComplete",{detail:{asset:JSON.parse(JSON.stringify(t)),index:JSON.parse(JSON.stringify(e))}});try{document.dispatchEvent(r)}catch(s){AMPTManager.logit(JSON.stringify({evt:r,eventName:"AdFuelRequestComplete",err:s}))}},displayAds:function(e){console.groupCollapsed("Displaying Ads for Registry"),console.log({asset:e.detail.asset});for(var t=e.detail.asset,n=[],i=1;i<t.length;i++){var r=t[i];"undefined"!=typeof r&&(AMPTManager.logit(r,"Attempting to Display Slot"),this.existingDivs.indexOf(r.rktr_slot_id)>=0&&n.push(r.rktr_slot_id))}for(var i=0;i<n.length;i++){var s=n[i];console.log({slot:s}),googletag.cmd.push(function(){googletag.display(s)})}console.groupEnd()},reloadAd:function(e,t,n){if(1==AMPTManager.focused||0==AMPTManager.refreshOnFocusOnly){if(n=n?n:!1,t=t?t:!1,0!=n)try{googletag.pubads().updateCorrelator()}catch(i){AMPTManager.logit({error_calling_updateCorrelator:i})}if(0!=t){AMPTManager.pageSlotsObj[e].setTargeting("pageload","ref");try{googletag.pubads().setTargeting("pageload","ref")}catch(i){AMPTManager.logit({error_calling_setTargeting:i})}AMPTManager.passedTargeting.push("pageload")}else if(AMPTManager.passedTargeting.indexOf("pageload")>=0){AMPTManager.pageSlotsObj[e].setTargeting("pageload","");try{googletag.pubads().clearTargeting("pageload")}catch(i){AMPTManager.logit({error_calling_clearTargeting:i})}AMPTManager.passedTargeting.splice(passedTargeting.indexOf("pageload"),1)}try{googletag.pubads().refresh([AMPTManager.pageSlotsObj[e]])}catch(i){AMPTManager.logit({error_calling_refresh:i})}}},refreshAd:function(e,t,n,i){return 1==AMPTManager.focused||0==AMPTManager.refreshOnFocusOnly?(i=i?i:!0,n=n?n:!1,t=t?t:0,"undefined"!=typeof t&&parseInt(t)>0?(t=parseInt(t),function(e,t,n,i){setInterval(function(){AMPTManager.reloadAd(e,i,n)},1e3*t)}(e,t,i,n)):!function(e,t,n){AMPTManager.reloadAd(e,n,t)}(e,i,n),n):void 0},refreshAds:function(e,t,n,i){return 1==AMPTManager.focused||0==AMPTManager.refreshOnFocusOnly?(i=i?i:!0,n=n?n:!1,t=t?t:0,e.length>=1&&!function(e,t,n,i){var r=[];for(var s in e)if(e.hasOwnProperty(s)){var o=e[s],a=AMPTManager.pageSlotsObj[o];r.push(a)}"undefined"!=typeof t&&parseInt(t)>0?(t=parseInt(t),function(e,t,n,i){setInterval(function(){if(0!=n)try{googletag.pubads().updateCorrelator()}catch(t){AMPTManager.logit({error_calling_updateCorrelator:t})}if(0!=i)try{googletag.pubads().setTargeting("pageload","ref")}catch(t){AMPTManager.logit({error_calling_setTargeting:t})}try{googletag.pubads().refresh(e)}catch(t){AMPTManager.logit({error_calling_refresh:t})}},1e3*t)}(r,t,n,i)):!function(e,t,n){if(0!=t)try{googletag.pubads().updateCorrelator()}catch(i){AMPTManager.logit({error_calling_updateCorrelator:i})}if(0!=n)try{googletag.pubads().setTargeting("pageload","ref")}catch(i){AMPTManager.logit({error_calling_setTargeting:i})}try{googletag.pubads().refresh(e)}catch(i){AMPTManager.logit({error_calling_refresh:i})}}(r,n,i)}(e,t,i,n),n):void 0},refreshAllAds:function(e,t,n){if(1==AMPTManager.focused||0==AMPTManager.refreshOnFocusOnly){n=n?n:!0,t=t?t:!1,e=e?e:0;var i=[];for(var r in AMPTManager.pageSlotsObj)if(AMPTManager.pageSlotsObj.hasOwnProperty(r))if("undefined"!=typeof document.getElementById(r)&&null!=document.getElementById(r)){var s=AMPTManager.pageSlotsObj[r];i.push(s)}else delete AMPTManager.pageSlotsObj[r];return function(e,t,n,i){"undefined"!=typeof t&&parseInt(t)>0?(t=parseInt(t),function(e,t,n){setInterval(function(){if(0!=n)try{googletag.pubads().updateCorrelator()}catch(t){AMPTManager.logit({error_calling_updateCorrelator:t})}if(0!=i)try{googletag.pubads().setTargeting("pageload","ref")}catch(t){AMPTManager.logit({error_calling_setTargeting:t})}else try{googletag.pubads().clearTargeting("pageload")}catch(t){AMPTManager.logit({error_calling_clearTargeting:t})}try{googletag.pubads().refresh(e)}catch(t){AMPTManager.logit({error_calling_refresh:t})}},1e3*t)}(e,t,n,i)):!function(e,t,n){if(0!=t)try{googletag.pubads().updateCorrelator()}catch(i){AMPTManager.logit({error_calling_updateCorrelator:i})}if(0!=n)try{googletag.pubads().setTargeting("pageload","ref")}catch(i){AMPTManager.logit({error_calling_setTargeting:i})}else try{googletag.pubads().clearTargeting("pageload")}catch(i){AMPTManager.logit({error_calling_clearTargeting:i})}try{googletag.pubads().refresh(e)}catch(i){AMPTManager.logit({error_calling_refresh:i})}}(e,n,i)}(i,e,n,t),t}},getURLParam:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",n=new RegExp(t),i=n.exec(window.location.href);return null===i?"":i[1]},requestAndRenderAds:function(){for(var e=0;e<AMPTManager.registry.length;e++){var t=AMPTManager.registry[e];"undefined"!=typeof t&&"undefined"!=typeof t[0]&&(AMPTManager.buildRequest(e,AMPTManager.registry[e][0].capTargeting),0==t[0].requested&&(AMPTManager.logit(t,"Requesting and Rendering Ads"),AMPTManager.addEvent(document,"AdFuelRequestComplete",function(e){AMPTManager.displayAds(e)}),AMPTManager.sendRequest(e),t[0].requested=!0,googletag.cmd.push(function(){try{googletag.pubads().updateCorrelator()}catch(e){console.group("Error calling UpdateCorrelator"),console.dir(e),console.log("If you see this error, the GPT Library has not fully loaded and the correlator cannot be updated."),console.log("Please notify rocketeerdevs@turner.com with the details of the error."),console.groupEnd()}})))}}}}catch(e){console.group("Error creating the AMPTManager object."),console.dir(e),console.log("If you see this error, a problem occurred when creating the main AMPTManager object."),console.log("Please notify rocketeerdevs@turner.com with the details of the error."),console.groupEnd()}}(),0==AMPTManager.initialized&&AMPTManager.init(),AMPTManager.addEvent(window,"DOMContentLoaded",function(){setTimeout(function(){AMPTManager.requestAndRenderAds()},250)}),AMPTManager.addEvent(document,"AdFuelRequestComplete",function(e){AMPTManager.logit({requestEvent:e})}),AMPTManager.addEvent(document,"GPTRenderComplete",function(e){AMPTManager.logit({renderEvent:e})});var AIS_VERSION="ais.cnn.8",cnnad_transactionID=null;cnnad_getTransactionID(),cnnad_ugsync(),window.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]),function(){var e="ITb_4eqO";window.location.hostname.toLowerCase().match(/^edition\.cnn\.com/)&&(e="ITb_9Zup");var t=document.createElement("script");t.type="text/javascript",t.async=!0;var n,i=(n=location.href.match(/\bkxsrc=([^&]+)/))&&decodeURIComponent(n[1]);t.src=/^https?:\/\/([^\/]+\.)?krxd\.net(:\d{1,5})?\//i.test(i)?i:"disable"===i?"":("https:"===location.protocol?"https:":"http:")+"//cdn.krxd.net/controltag?confid="+e;var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(t,r)}(),window.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]),window.kvs=[],function(){function e(e){var t,n="kx"+e;return window.localStorage?window.localStorage[n]||"":navigator.cookieEnabled?(t=document.cookie.match(n+"=([^;]*)"),t&&unescape(t[1])||""):""}Krux.user=e("user"),Krux.segments=e("segs")&&e("segs").split(",")||[];for(var t=0;t<Krux.segments.length;t++)kvs.length<20&&kvs.push(Krux.segments[t])}();var pageHost=window.location.hostname.toLowerCase();pageHost.match(/^(etrain|stage)\.next\.cnn\.com/)&&function(){var e=document,t=e.createElement("script"),e=e.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src="http://s.moatads.com/turner817ylrv53/moatcontent.js",e.parentNode.insertBefore(t,e)}(),!function(e,t){"function"==typeof define&&define.amd?define([],function(){return e.CVP=t()}):e.CVP=t()}(this,function(){var requirejs,require,define;return function(e){function t(e,t){return _.call(e,t)}function n(e,t){var n,i,r,s,o,a,l,c,u,d,h=t&&t.split("/"),p=f.map,g=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(h=h.slice(0,h.length-1),e=h.concat(e.split("/")),c=0;c<e.length;c+=1)if(d=e[c],"."===d)e.splice(c,1),c-=1;else if(".."===d){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||g)&&p){for(n=e.split("/"),c=n.length;c>0;c-=1){if(i=n.slice(0,c).join("/"),h)for(u=h.length;u>0;u-=1)if(r=p[h.slice(0,u).join("/")],r&&(r=r[i])){s=r,o=c;break}if(s)break;!a&&g&&g[i]&&(a=g[i],l=c)}!s&&a&&(s=a,o=l),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function i(t,n){return function(){return u.apply(e,v.call(arguments,0).concat([t,n]))}}function r(e){return function(t){return n(t,e)}}function s(e){return function(t){p[e]=t}}function o(n){if(t(g,n)){var i=g[n];delete g[n],m[n]=!0,c.apply(e,i)}if(!t(p,n)&&!t(m,n))throw new Error("No "+n);return p[n]}function a(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function l(e){return function(){return f&&f.config&&f.config[e]||{}}}var c,u,d,h,p={},g={},f={},m={},_=Object.prototype.hasOwnProperty,v=[].slice;d=function(e,t){var i,s=a(e),l=s[0];return e=s[1],l&&(l=n(l,t),i=o(l)),l?e=i&&i.normalize?i.normalize(e,r(t)):n(e,t):(e=n(e,t),s=a(e),l=s[0],e=s[1],l&&(i=o(l))),{f:l?l+"!"+e:e,n:e,pr:l,p:i}},h={require:function(e){return i(e)},exports:function(e){var t=p[e];return"undefined"!=typeof t?t:p[e]={}},module:function(e){return{id:e,uri:"",exports:p[e],config:l(e)}}},c=function(n,r,a,l){var c,u,f,_,v,y,C=[];if(l=l||n,"function"==typeof a){for(r=!r.length&&a.length?["require","exports","module"]:r,v=0;v<r.length;v+=1)if(_=d(r[v],l),u=_.f,"require"===u)C[v]=h.require(n);else if("exports"===u)C[v]=h.exports(n),y=!0;else if("module"===u)c=C[v]=h.module(n);else if(t(p,u)||t(g,u)||t(m,u))C[v]=o(u);else{if(!_.p)throw new Error(n+" missing "+u);_.p.load(_.n,i(l,!0),s(u),{}),C[v]=p[u]}f=a.apply(p[n],C),n&&(c&&c.exports!==e&&c.exports!==p[n]?p[n]=c.exports:f===e&&y||(p[n]=f))}else n&&(p[n]=a)},requirejs=require=u=function(t,n,i,r,s){return"string"==typeof t?h[t]?h[t](n):o(d(t,n).f):(t.splice||(f=t,n.splice?(t=n,n=i,i=null):t=e),n=n||function(){},"function"==typeof i&&(i=r,r=s),r?c(e,t,n,i):setTimeout(function(){c(e,t,n,i)},4),u)},u.config=function(e){return f=e,f.deps&&u(f.deps,f.callback),u},requirejs._defined=p,define=function(e,n,i){n.splice||(i=n,n=[]),t(p,e)||t(g,e)||(g[e]=[e,n,i])},define.amd={jQuery:!0}}(),define("almondLib",function(){}),define("core/app",["require","exports","module"],function(e,t,n){var i=/\bdmtdebug=(\w+)/.exec(window.location.href);if(!i&&window!==window.top)try{i=/\bdmtdebug=(\w+)/.exec(window.top.location.href)}catch(r){}var s=!!i,o="https:"===window.location.protocol,a=o?"https://s.cdn.turner.com":"http://z.cdn.turner.com",l={VERSION:"2.8.3.4",BUILD_DATE:"2015-01-20T19:00:49",FLASH_VERSION:"10.1.0.0",HTML5:"html5",FLASH:"flash",CDN_ORIGIN:a,DEBUG:s,DEBUG_LEVEL:s?i[1]:null,MAPPING_PATH:a+"/xslo/cvp/config/{site}/",MAPPING_FILE:"mapping.xml",OMNITURE_JS_URL:"",AD_MANAGER_URL:a+"/xslo/cvp/ads/freewheel/js/0/AdManager.js",AD_DFP_URL:"//www.google.com/uds/api/ima/1.7/9fd415db3bb953707e811e4827fe957b/default.IN.js",EXPRESS_INSTALL_URL:a+"/xslo/cvp/assets/flash/expressInstall.swf",FLASHXHR_SWF_URL:a+"/xslo/cvp/plugins/cvp/xhr/1.0/cvp_flashXhr.swf",LOG4JAVASCRIPT_URL:a+"/xslo/cvp/js/logging/log4javascript.js",EASYXDM_JS_URL:a+"/xslo/cvp/easyxdm/js/easyXDM.ugly.js",EASYXDM_SWF_URL:a+"/xslo/cvp/easyxdm/swf/easyxdm.swf",BLANK_MP4_URL:a+"/xslo/cvp/assets/video/blank.mp4",BLANK_IMG_URL:a+"/xslo/cvp/assets/video/blank.png",EXPIRED_MP4_URL:a+"/xslo/cvp/assets/video/video_not_available.mp4",EXPIRED_IMG_URL:a+"/xslo/cvp/assets/video/video_not_available.png",ERROR_CMS_PARSE:"CVP0201",ERROR_CMS_IO:"CVP0202",ERROR_CMS_LOADER:"CVP0206",ERROR_CONTENT_EXPIRED:"CVP2052"};n.exports=l}),define("Class",["require","exports","module"],function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/,n=function(){};return n.extend=function i(n){function r(){!e&&this.init&&this.init.apply(this,arguments)}var s=this.prototype;e=!0;var o=new this;e=!1;for(var a in n)o[a]="function"==typeof n[a]&&"function"==typeof s[a]&&t.test(n[a])?function(e,t){return function(){var n=this._super;this._super=s[e];var i=t.apply(this,arguments);return this._super=n,i}}(a,n[a]):n[a];return r.prototype=o,r.prototype.constructor=r,r.extend=i,r},n}),function(e){define("when",[],function(){function t(e,t,n,r){return i(e).then(t,n,r)}function n(e,t){this.then=e,this.inspect=t}function i(e){return o(function(t){t(e)})}function r(e){return t(e,u)}function s(){function e(e,s,o){t.resolve=t.resolver.resolve=function(t){return r?i(t):(r=!0,e(t),n)},t.reject=t.resolver.reject=function(e){return r?i(u(e)):(r=!0,s(e),n)},t.notify=t.resolver.notify=function(e){return o(e),e}}var t,n,r;return t={promise:j,resolve:j,reject:j,notify:j,resolver:{resolve:j,reject:j,notify:j}},t.promise=n=o(e),t}function o(e){return a(e,N.PromiseStatus&&N.PromiseStatus())}function a(e,t){function i(e,n,i){var r=a(function(t,r,s){function o(o){o.then(e,n,i).then(t,r,s)}f?f.push(o):P(function(){o(g)})},t&&t.observed());return r}function r(){return g?g.inspect():A()}function s(e){f&&(g=l(e),h(f,g),f=j,t&&g.then(function(){t.fulfilled()},function(e){t.rejected(e)}))}function o(e){s(u(e))}function c(e){f&&h(f,d(e))}var p,g,f=[];p=new n(i,r);try{e(s,o,c)}catch(m){o(m)}return p}function l(e){return e instanceof n?e:e===Object(e)&&"then"in e?o(function(t,n,i){P(function(){try{var r=e.then;"function"==typeof r?I(r,e,t,n,i):t(c(e))}catch(s){n(s)}})}):c(e)}function c(e){var t=new n(function(n){try{return"function"==typeof n?l(n(e)):t}catch(i){return u(i)}},function(){return T(e)});return t}function u(e){var t=new n(function(n,i){try{return"function"==typeof i?l(i(e)):t}catch(r){return u(r)}},function(){return w(e)});return t}function d(e){var t=new n(function(n,i,r){try{return"function"==typeof r?d(r(e)):t}catch(s){return d(s)}});return t}function h(e,t){P(function(){for(var n,i=0;n=e[i++];)n(t)})}function p(e){return e&&"function"==typeof e.then}function g(e,n,i,r,s){return t(e,function(e){function a(i,r,s){function o(e){p(e)}function a(e){h(e)}var l,c,u,d,h,p,g,f;if(g=e.length>>>0,l=Math.max(0,Math.min(n,g)),u=[],c=g-l+1,d=[],l)for(p=function(e){d.push(e),--c||(h=p=S,r(d))},h=function(e){u.push(e),--l||(h=p=S,i(u))},f=0;g>f;++f)f in e&&t(e[f],a,o,s);else i(u)}return o(a).then(i,r,s)})}function f(e,t,n,i){function r(e){return t?t(e[0]):e[0]}return g(e,1,r,n,i)}function m(e,t,n,i){return C(e,S).then(t,n,i)}function _(){return C(arguments,S)}function v(e){return C(e,T,w)}function y(e,t){return C(e,t)}function C(e,n,i){return t(e,function(e){function r(r,s,o){function a(e,a){t(e,n,i).then(function(e){l[a]=e,--u||r(l)},s,o)}var l,c,u,d;if(u=c=e.length>>>0,l=[],!u)return void r(l);for(d=0;c>d;d++)d in e?a(e[d],d):--u}return o(r)})}function b(e,n){var i=I(x,arguments,1);return t(e,function(e){var r;return r=e.length,i[0]=function(e,i,s){return t(e,function(e){return t(i,function(t){return n(e,t,s,r)})})},k.apply(e,i)})}function T(e){return{state:"fulfilled",value:e}}function w(e){return{state:"rejected",reason:e}}function A(){return{state:"pending"}}function P(e){1===R.push(e)&&M(E)}function E(){for(var e,t=0;e=R[t++];)e();R=[]}function S(e){return e}t.promise=o,t.resolve=i,t.reject=r,t.defer=s,t.join=_,t.all=m,t.map=y,t.reduce=b,t.settle=v,t.any=f,t.some=g,t.isPromise=p,n.prototype={otherwise:function(e){return this.then(j,e)},ensure:function(e){function t(){return i(e())}return this.then(t,t)["yield"](this)},"yield":function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return m(t,function(t){return e.apply(j,t)})})},always:function(e,t){return this.then(e,e,t)}};var k,x,I,M,R,L,O,D,F,N,j;return R=[],N="undefined"!=typeof console?console:t,L=e.setTimeout,M="function"==typeof setImmediate?setImmediate.bind(e):"object"==typeof process&&process.nextTick?process.nextTick:"object"==typeof vertx?vertx.runOnLoop:function(e){L(e,0)},O=Function.prototype,D=O.call,I=O.bind?D.bind(D):function(e,t){return e.apply(t,x.call(arguments,2))},F=[],x=F.slice,k=F.reduce||function(e){var t,n,i,r,s;if(s=0,t=Object(this),r=t.length>>>0,n=arguments,n.length<=1)for(;;){if(s in t){i=t[s++];break}if(++s>=r)throw new TypeError}else i=n[1];for(;r>s;++s)s in t&&(i=e(i,t[s],s,t));return i},t})}(this),function(e){function t(e){if("bug-string-char-index"==e)return"a"!="a"[0];var t,n='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}',i="json"==e;if(i||"json-stringify"==e||"json-parse"==e){if("json-stringify"==e||i){var o=a.stringify,c="function"==typeof o&&l;if(c){(t=function(){return 1}).toJSON=t;try{c="0"===o(0)&&"0"===o(new Number)&&'""'==o(new String)&&o(s)===r&&o(r)===r&&"1"===o(t)&&"[1]"==o([t])&&"[null]"==o([r])&&"null"==o(null)&&"[null,null,null]"==o([r,s,null])&&o({a:[t,!0,!1,null,"\x00\b\n\f\r	"]})==n&&"1"===o(null,t)&&"[\n 1,\n 2\n]"==o([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==o(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==o(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==o(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==o(new Date(-1))}catch(u){c=!1}}if(!i)return c}if("json-parse"==e||i){var d=a.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){t=d(n);var h=5==t.a.length&&1===t.a[0];if(h){try{h=!d('"	"')}catch(u){}if(h)try{h=1!==d("01")}catch(u){}}}}catch(u){h=!1}if(!i)return h}return c&&h}}var n,i,r,s={}.toString,o=!0,a="object"==typeof exports&&exports;a||o?"object"==typeof JSON&&JSON?a?(a.stringify=JSON.stringify,a.parse=JSON.parse):a=JSON:o&&(a=e.JSON={}):a=e.JSON||(e.JSON={});var l=new Date(-0xc782b5b800cec);try{l=-109252==l.getUTCFullYear()&&0===l.getUTCMonth()&&1===l.getUTCDate()&&10==l.getUTCHours()&&37==l.getUTCMinutes()&&6==l.getUTCSeconds()&&708==l.getUTCMilliseconds()}catch(c){}if(!t("json")){var u="[object Function]",d="[object Date]",h="[object Number]",p="[object String]",g="[object Array]",f="[object Boolean]",m=t("bug-string-char-index");if(!l)var _=Math.floor,v=[0,31,59,90,120,151,181,212,243,273,304,334],y=function(e,t){return v[t]+365*(e-1970)+_((e-1969+(t=+(t>1)))/4)-_((e-1901+t)/100)+_((e-1601+t)/400)};(n={}.hasOwnProperty)||(n=function(e){var t,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=s?n=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=i.constructor,n=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),i=null,n.call(this,e)});var C={"boolean":1,number:1,string:1,undefined:1},b=function(e,t){var n=typeof e[t];return"object"==n?!!e[t]:!C[n]};if(i=function(e,t){var i,r,o,a,l=0;(i=function(){this.valueOf=0}).prototype.valueOf=0,r=new i;for(o in r)n.call(r,o)&&l++;return i=r=null,l?a=2==l?function(e,t){var i,r={},o=s.call(e)==u;for(i in e)o&&"prototype"==i||n.call(r,i)||!(r[i]=1)||!n.call(e,i)||t(i)}:function(e,t){var i,r,o=s.call(e)==u;for(i in e)o&&"prototype"==i||!n.call(e,i)||(r="constructor"===i)||t(i);(r||n.call(e,i="constructor"))&&t(i)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],a=function(e,t){var i,o,a=s.call(e)==u,l=!a&&"function"!=typeof e.constructor&&b(e,"hasOwnProperty")?e.hasOwnProperty:n;for(i in e)a&&"prototype"==i||!l.call(e,i)||t(i);for(o=r.length;i=r[--o];l.call(e,i)&&t(i));}),a(e,t)},!t("json-stringify")){var T={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},w="000000",A=function(e,t){return(w+(t||0)).slice(-e)},P="\\u00",E=function(e){var t,n='"',i=0,r=e.length,s=r>10&&m;for(s&&(t=e.split(""));r>i;i++){var o=e.charCodeAt(i);switch(o){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=T[o];break;default:if(32>o){n+=P+A(2,o.toString(16));break}n+=s?t[i]:m?e.charAt(i):e[i]}}return n+'"'},S=function(e,t,o,a,l,c,u){var m,v,C,b,T,w,P,k,x,I,M,R,L,O,D,F,N=t[e];try{N=t[e]}catch(j){}if("object"==typeof N&&N)if(m=s.call(N),m!=d||n.call(N,"toJSON"))"function"==typeof N.toJSON&&(m!=h&&m!=p&&m!=g||n.call(N,"toJSON"))&&(N=N.toJSON(e));else if(N>-1/0&&1/0>N){if(y){for(b=_(N/864e5),v=_(b/365.2425)+1970-1;y(v+1,0)<=b;v++);for(C=_((b-y(v,0))/30.42);y(v,C+1)<=b;C++);b=1+b-y(v,C),T=(N%864e5+864e5)%864e5,w=_(T/36e5)%24,P=_(T/6e4)%60,k=_(T/1e3)%60,x=T%1e3}else v=N.getUTCFullYear(),C=N.getUTCMonth(),b=N.getUTCDate(),w=N.getUTCHours(),P=N.getUTCMinutes(),k=N.getUTCSeconds(),x=N.getUTCMilliseconds();N=(0>=v||v>=1e4?(0>v?"-":"+")+A(6,0>v?-v:v):A(4,v))+"-"+A(2,C+1)+"-"+A(2,b)+"T"+A(2,w)+":"+A(2,P)+":"+A(2,k)+"."+A(3,x)+"Z"}else N=null;if(o&&(N=o.call(t,e,N)),null===N)return"null";if(m=s.call(N),m==f)return""+N;if(m==h)return N>-1/0&&1/0>N?""+N:"null";if(m==p)return E(""+N);if("object"==typeof N){for(L=u.length;L--;)if(u[L]===N)throw TypeError();if(u.push(N),I=[],O=c,c+=l,m==g){for(R=0,L=N.length;L>R;D||(D=!0),R++)M=S(R,N,o,a,l,c,u),I.push(M===r?"null":M);F=D?l?"[\n"+c+I.join(",\n"+c)+"\n"+O+"]":"["+I.join(",")+"]":"[]"}else i(a||N,function(e){var t=S(e,N,o,a,l,c,u);t!==r&&I.push(E(e)+":"+(l?" ":"")+t),D||(D=!0)}),F=D?l?"{\n"+c+I.join(",\n"+c)+"\n"+O+"}":"{"+I.join(",")+"}":"{}";return u.pop(),F}};a.stringify=function(e,t,n){var i,r,o;if("function"==typeof t||"object"==typeof t&&t)if(s.call(t)==u)r=t;else if(s.call(t)==g){o={};for(var a,l=0,c=t.length;c>l;a=t[l++],(s.call(a)==p||s.call(a)==h)&&(o[a]=1));}if(n)if(s.call(n)==h){if((n-=n%1)>0)for(i="",n>10&&(n=10);i.length<n;i+=" ");}else s.call(n)==p&&(i=n.length<=10?n:n.slice(0,10));return S("",(a={},a[""]=e,a),r,o,i,"",[])}}if(!t("json-parse")){var k,x,I=String.fromCharCode,M={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},R=function(){throw k=x=null,SyntaxError()},L=function(){for(var e,t,n,i,r,s=x,o=s.length;o>k;)switch(r=s.charCodeAt(k)){case 9:case 10:case 13:case 32:k++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=m?s.charAt(k):s[k],k++,e;case 34:for(e="@",k++;o>k;)if(r=s.charCodeAt(k),32>r)R();else if(92==r)switch(r=s.charCodeAt(++k)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=M[r],k++;break;case 117:for(t=++k,n=k+4;n>k;k++)r=s.charCodeAt(k),r>=48&&57>=r||r>=97&&102>=r||r>=65&&70>=r||R();e+=I("0x"+s.slice(t,k));break;default:R()}else{if(34==r)break;for(r=s.charCodeAt(k),t=k;r>=32&&92!=r&&34!=r;)r=s.charCodeAt(++k);e+=s.slice(t,k)}if(34==s.charCodeAt(k))return k++,e;R();default:if(t=k,45==r&&(i=!0,r=s.charCodeAt(++k)),r>=48&&57>=r){for(48==r&&(r=s.charCodeAt(k+1),r>=48&&57>=r)&&R(),i=!1;o>k&&(r=s.charCodeAt(k),r>=48&&57>=r);k++);if(46==s.charCodeAt(k)){for(n=++k;o>n&&(r=s.charCodeAt(n),r>=48&&57>=r);n++);n==k&&R(),k=n}if(r=s.charCodeAt(k),101==r||69==r){for(r=s.charCodeAt(++k),(43==r||45==r)&&k++,n=k;o>n&&(r=s.charCodeAt(n),r>=48&&57>=r);n++);n==k&&R(),k=n}return+s.slice(t,k)}if(i&&R(),"true"==s.slice(k,k+4))return k+=4,!0;if("false"==s.slice(k,k+5))return k+=5,!1;if("null"==s.slice(k,k+4))return k+=4,null;R()}return"$"},O=function(e){var t,n;if("$"==e&&R(),"string"==typeof e){if("@"==(m?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=L(),"]"!=e;n||(n=!0))n&&(","==e?(e=L(),"]"==e&&R()):R()),","==e&&R(),t.push(O(e));return t}if("{"==e){for(t={};e=L(),"}"!=e;n||(n=!0))n&&(","==e?(e=L(),"}"==e&&R()):R()),(","==e||"string"!=typeof e||"@"!=(m?e.charAt(0):e[0])||":"!=L())&&R(),t[e.slice(1)]=O(L());return t}R()}return e},D=function(e,t,n){var i=F(e,t,n);i===r?delete e[t]:e[t]=i},F=function(e,t,n){var r,o=e[t];if("object"==typeof o&&o)if(s.call(o)==g)for(r=o.length;r--;)D(o,r,n);else i(o,function(e){D(o,e,n)});return n.call(e,t,o)};a.parse=function(e,t){var n,i;return k=0,x=""+e,n=O(L()),"$"!=L()&&R(),k=x=null,t&&s.call(t)==u?F((i={},i[""]=n,i),"",t):n}}}o&&define("JSON",[],function(){return a})}(this),define("cvp/version",["require","exports","module"],function(e,t,n){function i(e){if("string"!=typeof e)throw new TypeError("Version() only accepts a string");this.raw=e,this.major=0/0,this.minor=0/0,this.revision=0/0;var t=r.exec(e);if(!t)throw new SyntaxError('Version string "'+this.raw+'" failed to parse as a valid version number');var n=t[1],i=t[3],o=t[5];this.major=n,i&&!s.test(t[2])&&(this.minor=i,o&&!s.test(t[4])&&(this.revision=o))}var r=/(\d+)(?:(\D)(\d+))?(?:(\D)(\d+))?/,s=/^[abd]$/;i.prototype.toString=function(){return this.toArray().join(".")},i.prototype.toArray=function(e){for(var t,n=[this.major,this.minor,this.revision],i=[],r=0,s=n.length;s>r&&(t=+n[r],e||!isNaN(t));++r)i.push(t);return i},i.prototype.compare=function(e,t){if(!(e instanceof i))return this.compare(new i(e),t);var n,r,s,o=0,a=0,l=this.toArray(!0);for(n=t?e.toArray():e.toArray(!0),a=n.length;a>o;++o){if(r=+l[o]||0,s=+n[o]||0,r>s)return 1;if(s>r)return-1}return 0},i.prototype.is=function(e){return 0===this.compare(e,!0)},i.prototype.eq=function(e){return 0===this.compare(e)},i.prototype.gt=function(e){return this.compare(e)>0},i.prototype.lt=function(e){return this.compare(e)<0},i.prototype.isnt=function(e){return!this.is(e)},i.prototype.ne=function(e){return!this.eq(e)},i.prototype.lte=function(e){return!this.gt(e)},i.prototype.gte=function(e){return!this.lt(e)},n.exports=i}),define("cvp/browser",["require","exports","module","cvp/version"],function(e,t,n){function i(e){var t={};for(var n in d)t[n]=d[n].exec(e);return t}var r=e("cvp/version"),s=window.navigator.userAgent,o="object"==typeof console&&"function"==typeof console.log?function(){console.log.apply(console,arguments)}:function(){},a={IOS:"iOS",OSX:"OSX",ANDROID:"Android",SAFARI:"Safari",SILK:"Silk",CHROME:"Chrome",FIREFOX:"Firefox",OPERA:"Opera",IE:"Internet Explorer",IPAD:"iPad",IPOD:"iPod",IPHONE:"iPhone",KINDLE:"Kindle",DESKTOP:"desktop",MOBILE:"mobile",TABLET:"tablet"},l=document.createElement("video"),c=/^(maybe|probably)$/,u=function(e){try{return c.test(l.canPlayType(e))}catch(t){return!1
}};a.supports={},a.supports.video="function"==typeof l.canPlayType,a.supports.mp4=a.supports.video&&u("video/mp4"),a.supports.m3u8=a.supports.video&&(u("application/x-mpegURL")||u("application/vnd.apple.mpegURL"));var d={Safari:/ Safari\/\d+(?:\.\d+){0,2}/,Version:/ Version\/(\d+(?:\.\d+){0,2})/,Opera:/^Opera\/\d+(?:\.\d+){0,2}/,Silk:/ Silk\/(\d+(?:\.\d+){0,2})/,InternetExplorer:/; MSIE (\d+(?:\D\d+){0,2})/,InternetExplorer11:/; Trident\/[^)]*; rv:(\d+(?:\D\d+){0,2})/,Firefox:/ Firefox\/(\d+(?:\D\d+){0,2})/,Chrome:/ Chrome\/(\d+(?:\D\d+){0,2})/,RenderingEngine:/ (AppleWebKit|Trident|Gecko|Presto)\/(\d+(?:\D\d+){0,2})/,AppleDevice:/ \((iP(?:[ao]d|hone));/,Android:/; Android(?: (\d+(?:\D\d+){0,2}))?[;)]/,iOS:/ OS (\d+(?:\D\d+){0,2}) like(?: Mac)? OS X/,OSX:/ OS X (\d+(?:\D\d+){0,2})/,MobileSafari:/ Mobile(?:\/\S+)? Safari\//,MobileFirefox:/; Mobile; .+ Firefox\/| Fennec\//,TabletFirefox:/; Tablet; .+ Firefox\//,IEMobile:/; IEMobile\/(\d+(?:\.\d+){0,2})/,OperaMobile:/; Opera (Mini|Mobi)\//,OperaTablet:/; Opera Tablet\//,SilkAccelerated:/ Silk-Accelerated=(true|false)/};!function(e){function t(e,t){var n=t||window,i=[].slice.call(arguments,2);return function(){return e.apply(n,i.concat([].slice.call(arguments)))}}e.Firefox?(a.name=a.FIREFOX,a.version=new r(e.Firefox[1])):e.InternetExplorer?(a.name=a.IE,a.version=new r(e.InternetExplorer[1])):e.InternetExplorer11?(a.name=a.IE,a.version=new r(e.InternetExplorer11[1])):e.Opera&&e.Version?(a.name=a.OPERA,a.version=new r(e.Version[1])):e.Silk?(a.name=a.SILK,a.version=new r(e.Silk[1])):e.Chrome?(a.name=a.CHROME,a.version=new r(e.Chrome[1])):e.Safari&&e.Version&&(a.name=a.SAFARI,a.version=new r(e.Version[1])),a.engine={},e.RenderingEngine&&(a.engine.name=e.RenderingEngine[1],a.engine.version=new r(e.RenderingEngine[2])),a.os={},e.Android?(a.os.name=a.ANDROID,"undefined"!=typeof e.Android[1]&&(a.os.version=new r(e.Android[1]))):e.iOS?(a.os.name=a.IOS,a.os.version=new r(e.iOS[1])):e.OSX&&(a.os.name=a.OSX,a.os.version=new r(e.OSX[1])),a.device={},e.AppleDevice?a.device.name=e.AppleDevice[1]:e.Silk&&(a.device.name=a.KINDLE),a.device.type=a.DESKTOP,(e.MobileSafari||e.MobileFirefox||e.IEMobile||e.OperaMobile)&&(a.device.type=a.MOBILE),(e.TabletFirefox||e.OperaTablet||e.Android&&a.device.type!==a.MOBILE)&&(a.device.type=a.TABLET);var n=function(e,t,n){var i,r=/^(!?~|[!=><]=?)?(\d.*)$/,s=function(e,t){var n,i=r.exec(t),s=e.is;if(!i)throw new Error("checkVersion: The pattern -- "+t+" -- was not considered valid.");switch(i[1]){case"~":s=e.is;break;case"!~":s=e.isnt;break;case"=":case"==":s=e.eq;break;case"!":case"!=":s=e.ne;break;case">":s=e.gt;break;case">=":s=e.gte;break;case"<":s=e.lt;break;case"<=":s=e.lte}return n=s.call(e,i[2])};switch(e){case"browser":i=t===a.name,n&&(i=i&&s(a.version,n));break;case"engine":i=t===a.engine.name,n&&(i=i&&s(a.engine.version,n));break;case"os":i=t===a.os.name,n&&(i=i&&s(a.os.version,n));break;case"device":i=t===a.device.name;break;case"platform":i=t===a.device.type;break;default:o('Browser.is() did not understand property "'+e+'"')}return i};a.isBrowser=t(n,this,"browser"),a.isEngine=t(n,this,"engine"),a.isOS=t(n,this,"os"),a.isDevice=t(n,this,"device"),a.isPlatform=t(n,this,"platform"),a.isOS(a.ANDROID,"<4")&&(a.supports.m3u8=!1),a.device.name===a.KINDLE&&(a.device.type=a.MOBILE),a.device.name===a.IPAD&&(a.device.type=a.TABLET),a.forcesFullscreen=a.isPlatform(a.MOBILE)}(i(s)),n.exports=a}),define("cvp/log",["require","exports","module","core/app","cvp/browser","JSON"],function(e,t,n){for(var i=e("core/app"),r=e("cvp/browser"),s=e("JSON"),o=Object.prototype.hasOwnProperty,a=Array.prototype.slice,l="function"==typeof Date.now?Date.now:function(){return(new Date).getTime()},c=function(){for(var e=["undefined","boolean","function","number","string"],t=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},n={},i=null,r=0,s=e.length;s>r;++r)i=e[r],n[i]=t(i);return function(e){var t,i=typeof e;return null===e?"Null":e!==e?"NaN":window===e?"Global":"object"===i&&(void 0!==window.Element&&e instanceof Element||void 0!==e.nodeType)?"Element":n[i]||n[t=n.toString.call(e)]||(n[t]=t.slice(8,-1))}}(),u=function(e,t,n){var i,r,l,d,h,p,g;null==t&&(t=0),null==n&&(n=0),l=[];try{h=s.stringify(e)}catch(f){h=""}if(""!==h&&"{}"!==h)return h;r=function(e){return n>=t?"â¦":u(e,t,++n)};for(i in e)if(o.call(e,i)){try{g=e[i]}catch(f){continue}switch(d=[i],p=c(g)){case"Null":d.push("null");break;case"Element":d.push(g.nodeName?"<"+g.nodeName+(g.id?"#"+g.id:"")+(g.className?"."+g.className.replace(/\s+/,"."):"")+"/>":"[Element]");break;case"Number":d.push(String(g));break;case"Boolean":d.push(String(g));break;case"String":d.push('"'+g+'"');break;case"Undefined":d.push("undefined");break;case"Function":d.push("function {â¦}");break;case"RegExp":d.push(String(g));break;case"Date":d.push(g.toLocaleString());break;case"Array":d.push("["+r(g)+"]");break;case"Arguments":d.push("["+r(a.call(g))+"]");break;case"Object":d.push("{"+r(g)+"}");break;default:d.push("["+p+"]{"+r(g)+"}")}l.push(d.join(": "))}return"["+c(e)+"]{"+(0!==l.length?" "+l.join(", ")+" ":"")+"}"},d=l(),h=r.isOS(r.ANDROID)&&!r.isBrowser(r.CHROME,">=31")||r.isOS(r.IOS,"<6")||r.isBrowser(r.IE,"<10"),p="CVP",g=window.self===window.top?"_top":window.name?window.name:"",f=["error","warn","info","debug","log"],m=[].concat("fatal",f,"trace"),_=[].concat("none",m,"all"),v={},y=null,C=0,b=_.length;b>C;++C)y=_[C],v[y.toUpperCase()]=C;var T=v.WARN,w=/NO|NONE|OFF|SILENT|QUIET/,A={},P=Function.prototype,E="object"==typeof console?"function"==typeof console.log?function(){console.log.apply(console,arguments)}:"object"==typeof console.log?function(e){var t=arguments.length;t>1?console.log(a.call(arguments).join(" â¢ ")):1===t&&console.log(e)}:P:P,S=function(e){return e=e.toUpperCase(),v[e]||(w.test(e)?v.NONE:v.ALL)},k=function(e){switch(typeof e){case"string":return S(e);case"number":return e;default:return T}};i.DEBUG_LEVEL&&(T=k(i.DEBUG_LEVEL));for(var x={},I=0,M=m.length;M>I;++I)(function(e){A[e]=function(){if("object"==typeof console)switch(typeof console[e]){case"object":return A[e]="function"==typeof Function.prototype.bind?P.call.bind(console[e],console):E,A[e].apply(null,arguments);case"function":return console[e].apply(console,arguments);default:return E.apply(null,arguments)}},x[e]=function(){var t=a.call(arguments);if(h){for(var n,i=0,r=t.length;r>i;++i)n=t[i],"object"==typeof n&&(t[i]=u(n));t=[t.join(" â¢ ")]}A[e].apply(this,t)}})(m[I]);var R=function(){function e(e){var t=this;this.id=e||"",this.setLevel(T),this._logger={};for(var n in x)(function(e,n){t._logger[e]=function(){var i,r;return r=e.toUpperCase(),t.getLevel()>=v[r]?(i=a.call(arguments),i.unshift("["+p+"|"+g+"|"+t.id+"|"+(l()-d)+"]",r),n.apply(t,i)):void 0},t[e]=function(){return t._logger[e].apply(t._logger,arguments)}})(n,x[n])}return e.prototype.useLog4JS=function(e){var t=this,n=0;!function(i,r){var s;return setTimeout(s=function(){if(!(r&&++n>r))if("object"==typeof window.log4javascript&&"function"==typeof window.log4javascript.getDefaultLogger){t.warn("switching '"+p+"|"+g+"|"+t.id+"' logger to send future messages to log4javascript");var o=e?window.log4javascript.getLogger(e):window.log4javascript.getDefaultLogger();for(var l in x)(function(e){t._logger[e]=function(){var n=a.call(arguments);return n.unshift("["+p+"|"+g+"|"+t.id+"]"),o[e].apply(o,n)}})(l)}else setTimeout(s,i)},i)}(2e3,10)},e.prototype.setLevel=function(e){return this.loggerLevel=k(e),this.loggerLevel},e.prototype.getLevel=function(){return this.loggerLevel},e}(),L=[],O=function(e){return null==e&&(e=""),L[e]=L[e]||new R(e)};n.exports={Level:v,getDefaultLevel:function(){return T},setDefaultLevel:function(e){return T=k(e)},getLogger:O}}),define("cvp/utils",["require","exports","module","when","JSON","core/app","cvp/log"],function(e,t){function n(e){if(!e)return document.cookie;for(var t,n=encodeURIComponent(e)+"=",i=document.cookie.split("; "),r=0,s=i.length;s>r;++r)if(t=i[r],0===t.indexOf(n))return decodeURIComponent(t.substring(n.length,t.length));return null}function i(e,t,n){if(e){var i=null;n&&(i=isNaN(Number(n))?n:new Date(n).toUTCString()),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+(i?"; expires="+n:"")+"; path=/"}}function r(e){e&&i(e,"",-1)}function s(e){return"undefined"==typeof e}function o(e){return s(e)||null===e}function a(e){if(o(e))return!0;if(d(e)||at(e))return 0===e.length;for(var t in e)if(ct(e,t))return!1;return!0}function l(e){return"function"==typeof e}function c(e){return"object"==typeof e}function u(e){return"[object Object]"===Object.prototype.toString.call(e)}function d(e){return"string"==typeof e}function h(e){return"boolean"==typeof e}function p(e,t){if(h(e))return e;if(a(e))return t;switch(e.toLowerCase()){case"yes":case"true":case"on":return!0;default:return!1}}function g(e,t){var n,i,r,s,o=arguments.length>2?x(arguments,1):t?[t]:[];for(e=e||{},n=0,i=o.length;i>n;++n)if(r=o[n],r&&c(r))for(s in r)e[s]=r[s];return e}function f(e,t,n){var i,r,s;if(at(e))for(r=0,s=e.length;s>r&&(i=t.call(n||e[r],e[r],r,e),i!==!1);++r);else for(r in e)if(ct(e,r)&&(i=t.call(n||e[r],r,e[r],e),i===!1))break}function m(e){var t=[];for(var n in e)ct(e,n)&&t.push(n);return t}function _(e,t,n){var i=[];return null==e?i:(f(e,function(e,r,s){i.push(t.call(n,e,r,s))}),i)}function v(e){var t=[];return f(e,function(e){-1===lt(t,e)&&t.push(e)}),t}function y(e){return e}function C(e,t,n){t=t||y;var i=!0;return null==e?i:(f(e,function(e,r,s){return(i=i&&t.call(n,e,r,s))?void 0:!1}),!!i)}function b(e,t,n){t=t||y;var i=!1;return null==e?i:(f(e,function(e,r,s){return i||(i=t.call(n,e,r,s))?!1:void 0}),!!i)}function T(e,t,n){t=t||y;var i=[];return null==e?i:(f(e,function(e,r,s){t.call(n,e,r,s)&&i.push(e)}),i)}function w(e,t,n){return t=t||y,T(e,function(e,i,r){return!t.call(n,e,i,r)},n)}function A(e,t,n){t=t||y;var i;return b(e,function(e,r,s){return t.call(n,e,r,s)?(i=e,!0):void 0}),i}function P(e,t,n){t=t||y;var i=-1;return b(e,function(e,r,s){return t.call(n,e,r,s)?(i=r,!0):void 0}),i}function E(e,t,n){var i,r,s,o=null,a=0;n=n||{},t=t||250;var l=function(){a=n.leading===!1?0:ot(),o=null,s=e.apply(i,r)};return function(){var c=ot();a||n.leading!==!1||(a=c);var u=t-(c-a);return i=this,r=arguments,0>=u?(window.clearTimeout(o),o=null,a=c,s=e.apply(i,r)):o||n.trailing===!1||(o=window.setTimeout(l,u)),s}}function S(e,t,n){var i,r,s,o,a;return t=t||250,function(){s=this,r=arguments,o=ot();var l=function(){var c=ot()-o;t>c?i=window.setTimeout(l,t-c):(i=null,n||(a=e.apply(s,r)))},c=n&&!i;return i||(i=window.setTimeout(l,t)),c&&(a=e.apply(s,r)),a}}function k(e){return document.getElementById(e)}function x(e,t){return Array.prototype.slice.call(e,t||0)}function I(e,t){var n=x(arguments,2);return function(){var i=n.concat(x(arguments));return e.apply(t,i)}}function M(e){var t=e.match(/\{[^{}]*\}/g),n=0,i=0,r=x(arguments,1),s=r.length;if(t)for(n=0,i=t.length;i>n&&s>n;++n)e=e.replace(t[n],r[n]);else it.info("No {placeholders} present in template: ",e);return e}function R(e,t){var n,i=[];o(t)&&(t=",");for(n in e)ct(e,n)&&i.push(n+"="+e[n]);return i.join(t)}function L(e){return 0===e.indexOf("//")||-1!==e.indexOf("://")}function O(e){return!L(e)}function D(e){var t=document.createElement("a");t.href=e;var n=t.href;t=null;var i=ut.exec(n);return i?{href:i[0]||"",origin:i[1]||"",protocol:i[2]||"",scheme:i[3]||"",host:i[4]||"",hostname:i[5]||"",port:i[6]||"",pathname:i[7]||"",dir:i[8]||"",file:i[9]||"",search:i[10]||"",query:i[11]||"",hash:i[12]||"",anchor:i[13]||""}:void 0}function F(e){var t={};return o(e)?t:(e.replace(dt,function(e,n,i){return t[n]=i?window.decodeURIComponent(i):"",e}),t)}function N(e){var t={},n=e||window.location.href,i=D(n);return i.query&&(t=F(i.query)),t}function j(e){return N()[e]}function B(e){var t,n,i=[],r=window.encodeURIComponent;for(t in e)ct(e,t)&&(n=e[t],i.push(r(t)+(""!==n?"="+r(c(n)?Z.stringify(n):n):"")));return i.join("&").replace(/%20/g,"+")}function q(e){var t=B(e),n=t?"?"+t:"";return n}function V(e,t){var n=D(e),i=F(n.query);i=g(i,t);var r=q(i);return n.origin+n.pathname+r+n.hash}function U(e){var t={"http:":"80","https:":"443"};return e=D(e),e.hostname.toLowerCase()!==location.hostname.toLowerCase()||(e.port||t[e.protocol])!==(location.port||t[location.protocol])||e.protocol.toLowerCase()!==location.protocol.toLowerCase()}function z(){window.console&&window.console.log&&tt&&window.console.log(x(arguments).join(" | "))}function Q(e,t){var n;"nested"!==t&&it.info("Print all values for ",t);for(n in e)if(ct(e,n)){if(!n)continue;c(e[n])?(it.info("Printing nested object value",n),Q(e[n],"nested")):it.info("nested"===t?"	":"","key:",n,"value:",e[n])}"nested"!==t&&it.info("End Print all values for ",t)}function W(e){var t=Y.defer();return setTimeout(t.resolve,e),t.promise}function K(e,t){var n=Y.defer();return e.then(n.resolve,n.reject),setTimeout(function(){n.reject(new Error("timed out"))},t),n.promise}function H(e,t){return 1===arguments.length?Math.floor(Math.random()*e):Math.floor(Math.random()*(t-e+1))+e}function $(e){return+e}function J(e){return parseInt(e,10)}function G(e){var t,n="",i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");for(e||(e=H(i.length)),t=0;e>t;t++)n+=i[H(i.length)];return n}function X(e,t,n){return a(e)?e:e.replace(new RegExp(t+"$","i"),n)}var Y=e("when"),Z=e("JSON"),et=e("core/app"),tt=et.DEBUG,nt=e("cvp/log"),it=nt.getLogger(),rt=function(){var e=/^[\s\xA0]+|[\s\xA0]+$/g,t=String.prototype.trim;return l(t)?function(e){return o(e)?"":t.call(e)}:function(t){return o(t)?"":String(t).replace(e,"")}}(),st=function(){function e(e,t,n){return n.toUpperCase()}if("getComputedStyle"in window)return function(e,t){return window.getComputedStyle(e,null).getPropertyValue(t)};var t=/(-([a-z]))/g;return function(n,i){return"currentStyle"in n?("float"===i&&(i="styleFloat"),i=i.replace(t,e),n.currentStyle[i]||null):null}}(),ot="function"==typeof Date.now?Date.now:function(){return(new Date).getTime()},at="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},lt=function(){var e=Array.prototype.indexOf,t="function"==typeof e?e:function(e,t){if(this){var n=this.length;for(t=t?0>t?Math.max(0,n+t):t:0;n>t;++t)if(t in this&&this[t]===e)return t}return-1};return function(e,n,i){return d(e)?e.indexOf(n,i):at(e)?t.call(e,n,i):void 0}}(),ct="function"==typeof Object.prototype.hasOwnProperty?function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}:function(e,t){return e[t]!==Object.prototype[t]},ut=/^((([^:\/?#]+):)?(?:\/\/(([^\/?#]*)(?::(\d+))?))?)(([^?#]*\/)([^\/?#]*)?)(\?([^#]*))?(#(.*))?$/,dt=/[?&]?([^&=]+)(?:=([^&=]+))?/g;t.trim=rt,t.getStyle=st,t.now=ot,t.getCookie=n,t.setCookie=i,t.deleteCookie=r,t.undef=s,t.isUndefined=s,t.nil=o,t.isNull=o,t.empty=a,t.isEmpty=a,t.isFunc=l,t.isFunction=l,t.isObject=c,t.isSimpleObject=u,t.isString=d,t.isBoolean=h,t.isArray=at,t.indexOf=lt,t.isFlagActive=p,t.extend=g,t.each=f,t.keys=m,t.map=_,t.uniq=v,t.identity=y,t.every=C,t.some=b,t.filter=T,t.reject=w,t.find=A,t.findIndex=P,t.throttle=E,t.debounce=S,t.byId=k,t.slice=x,t.hasOwn=ct,t.bind=I,t.template=M,t.joinKeys=R,t.isAbsolute=L,t.isRelative=O,t.isRelativePath=O,t.parseUrl=D,t.parseQueryString=F,t.getQueryParams=N,t.getQueryParam=j,t.encodeParams=B,t.toQueryString=q,t.augmentQueryString=V,t.isCrossDomain=U,t.log=z,t.print=Q,t.delay=W,t.timeout=K,t.getRandomInt=H,t.toNum=$,t.toInt=J,t.randomString=G,t.replaceExtension=X}),define("swfobject",["require","exports","module"],function(){var e=function(){function t(){if(!H&&document.getElementsByTagName("body")[0]){try{var e,t=v("span");t.style.display="none",e=q.getElementsByTagName("body")[0].appendChild(t),e.parentNode.removeChild(e),e=null,t=null}catch(n){return}H=!0;for(var i=z.length,r=0;i>r;r++)z[r]()}}function n(e){H?e():z[z.length]=e}function i(e){if(typeof B.addEventListener!==M)B.addEventListener("load",e,!1);else if(typeof q.addEventListener!==M)q.addEventListener("load",e,!1);else if(typeof B.attachEvent!==M)C(B,"onload",e);else if("function"==typeof B.onload){var t=B.onload;B.onload=function(){t(),e()}}else B.onload=e}function r(){var e=q.getElementsByTagName("body")[0],t=v(R);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",D);var n=e.appendChild(t);if(n){var i=0;!function r(){if(typeof n.GetVariable!==M)try{var o=n.GetVariable("$version");o&&(o=o.split(" ")[1].split(","),X.pv=[y(o[0]),y(o[1]),y(o[2])])}catch(a){X.pv=[8,0,0]}else if(10>i)return i++,void setTimeout(r,10);e.removeChild(t),n=null,s()}()}else s()}function s(){var e=Q.length;if(e>0)for(var t=0;e>t;t++){var n=Q[t].id,i=Q[t].callbackFn,r={success:!1,id:n};if(X.pv[0]>0){var s=_(n);if(s)if(!b(Q[t].swfVersion)||X.wk&&X.wk<312)if(Q[t].expressInstall&&a()){var u={};u.data=Q[t].expressInstall,u.width=s.getAttribute("width")||"0",u.height=s.getAttribute("height")||"0",s.getAttribute("class")&&(u.styleclass=s.getAttribute("class")),s.getAttribute("align")&&(u.align=s.getAttribute("align"));for(var d={},h=s.getElementsByTagName("param"),p=h.length,g=0;p>g;g++)"movie"!==h[g].getAttribute("name").toLowerCase()&&(d[h[g].getAttribute("name")]=h[g].getAttribute("value"));l(u,d,n,i)}else c(s),i&&i(r);else w(n,!0),i&&(r.success=!0,r.ref=o(n),r.id=n,i(r))}else if(w(n,!0),i){var f=o(n);f&&typeof f.SetVariable!==M&&(r.success=!0,r.ref=f,r.id=f.id),i(r)}}}function o(e){var t=null,n=_(e);return n&&"OBJECT"===n.nodeName.toUpperCase()&&(t=typeof n.SetVariable!==M?n:n.getElementsByTagName(R)[0]||n),t}function a(){return!$&&b("6.0.65")&&(X.win||X.mac)&&!(X.wk&&X.wk<312)}function l(e,t,n,i){var r=_(n);if(n=m(n),$=!0,S=i||null,k={success:!1,id:n},r){"OBJECT"===r.nodeName.toUpperCase()?(P=u(r),E=null):(P=r,E=n),e.id=F,(typeof e.width===M||!/%$/.test(e.width)&&y(e.width)<310)&&(e.width="310"),(typeof e.height===M||!/%$/.test(e.height)&&y(e.height)<137)&&(e.height="137");var s=X.ie?"ActiveX":"PlugIn",o="MMredirectURL="+encodeURIComponent(B.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+s+"&MMdoctitle="+encodeURIComponent(q.title.slice(0,47)+" - Flash Player Installation");if(typeof t.flashvars!==M?t.flashvars+="&"+o:t.flashvars=o,X.ie&&4!=r.readyState){var a=v("div");n+="SWFObjectNew",a.setAttribute("id",n),r.parentNode.insertBefore(a,r),r.style.display="none",g(r)}h(e,t,n)}}function c(e){if(X.ie&&4!=e.readyState){e.style.display="none";var t=v("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(u(e),t),g(e)}else e.parentNode.replaceChild(u(e),e)}function u(e){var t=v("div");if(X.win&&X.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(R)[0];if(n){var i=n.childNodes;if(i)for(var r=i.length,s=0;r>s;s++)1==i[s].nodeType&&"PARAM"===i[s].nodeName||8==i[s].nodeType||t.appendChild(i[s].cloneNode(!0))}}return t}function d(e,t){var n=v("div");return n.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",n.firstChild}function h(e,t,n){var i,r=_(n);if(n=m(n),X.wk&&X.wk<312)return i;if(r){var s,o,a,l=v(X.ie?"div":R);typeof e.id===M&&(e.id=n);for(a in t)t.hasOwnProperty(a)&&"movie"!==a.toLowerCase()&&p(l,a,t[a]);X.ie&&(l=d(e.data,l.innerHTML));for(s in e)e.hasOwnProperty(s)&&(o=s.toLowerCase(),"styleclass"===o?l.setAttribute("class",e[s]):"classid"!==o&&"data"!==o&&l.setAttribute(s,e[s]));X.ie?W[W.length]=e.id:(l.setAttribute("type",D),l.setAttribute("data",e.data)),r.parentNode.replaceChild(l,r),i=l}return i}function p(e,t,n){var i=v("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}function g(e){var t=_(e);t&&"OBJECT"===t.nodeName.toUpperCase()&&(X.ie?(t.style.display="none",function n(){if(4==t.readyState){for(var e in t)"function"==typeof t[e]&&(t[e]=null);t.parentNode.removeChild(t)}else setTimeout(n,10)}()):t.parentNode.removeChild(t))}function f(e){return e&&e.nodeType&&1===e.nodeType}function m(e){return f(e)?e.id:e}function _(e){if(f(e))return e;var t=null;try{t=q.getElementById(e)}catch(n){}return t}function v(e){return q.createElement(e)}function y(e){return parseInt(e,10)}function C(e,t,n){e.attachEvent(t,n),K[K.length]=[e,t,n]}function b(e){e+="";var t=X.pv,n=e.split(".");return n[0]=y(n[0]),n[1]=y(n[1])||0,n[2]=y(n[2])||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function T(e,t,n,i){var r=q.getElementsByTagName("head")[0];if(r){var s="string"==typeof n?n:"screen";if(i&&(x=null,I=null),!x||I!=s){var o=v("style");o.setAttribute("type","text/css"),o.setAttribute("media",s),x=r.appendChild(o),X.ie&&typeof q.styleSheets!==M&&q.styleSheets.length>0&&(x=q.styleSheets[q.styleSheets.length-1]),I=s}x&&(typeof x.addRule!==M?x.addRule(e,t):typeof q.createTextNode!==M&&x.appendChild(q.createTextNode(e+" {"+t+"}")))}}function w(e,t){if(J){var n=t?"visible":"hidden",i=_(e);H&&i?i.style.visibility=n:"string"==typeof e&&T("#"+e,"visibility:"+n)}}function A(e){var t=/[\\\"<>\.;]/,n=null!==t.exec(e);return n&&typeof encodeURIComponent!==M?encodeURIComponent(e):e}var P,E,S,k,x,I,M="undefined",R="object",L="Shockwave Flash",O="ShockwaveFlash.ShockwaveFlash",D="application/x-shockwave-flash",F="SWFObjectExprInst",N="DOMContentLoaded",j="onreadystatechange",B=window,q=document,V=navigator,U=!1,z=[],Q=[],W=[],K=[],H=!1,$=!1,J=!0,G=!1,X=function(){var e=typeof q.getElementById!==M&&typeof q.getElementsByTagName!==M&&typeof q.createElement!==M,t=V.userAgent.toLowerCase(),n=V.platform.toLowerCase(),i=/win/.test(n?n:t),r=/mac/.test(n?n:t),s=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,o="Microsoft Internet Explorer"===V.appName,a=[0,0,0],l=null;if(typeof V.plugins!==M&&typeof V.plugins[L]===R)l=V.plugins[L].description,l&&typeof V.mimeTypes!==M&&V.mimeTypes[D]&&V.mimeTypes[D].enabledPlugin&&(U=!0,o=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=y(l.replace(/^(.*)\..*$/,"$1")),a[1]=y(l.replace(/^.*\.(.*)\s.*$/,"$1")),a[2]=/[a-zA-Z]/.test(l)?y(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof B.ActiveXObject!==M)try{var c=new ActiveXObject(O);c&&(l=c.GetVariable("$version"),l&&(o=!0,l=l.split(" ")[1].split(","),a=[y(l[0]),y(l[1]),y(l[2])]))}catch(u){}return{w3:e,pv:a,wk:s,ie:o,win:i,mac:r}}();return function(){X.w3&&((typeof q.readyState!==M&&"complete"===q.readyState||typeof q.readyState===M&&(q.getElementsByTagName("body")[0]||q.body))&&t(),H||(typeof q.addEventListener!==M&&q.addEventListener(N,function e(){q.removeEventListener(N,e,!1),t()},!1),X.ie&&(q.attachEvent(j,function n(){"complete"===q.readyState&&(q.detachEvent(j,n),t())}),B===top&&!function r(){if(!H){try{q.documentElement.doScroll("left")}catch(e){return void setTimeout(r,10)}t()}}()),X.wk&&!function s(){return H?void 0:/^(loaded|complete)$/.test(q.readyState)?void t():void setTimeout(s,10)}(),i(t)))}(),z[0]=function(){U?r():s()},function(){X.ie&&window.attachEvent("onunload",function(){for(var t=K.length,n=0;t>n;n++)K[n][0].detachEvent(K[n][1],K[n][2]);for(var i=W.length,r=0;i>r;r++)g(W[r]);for(var s in X)X[s]=null;X=null;for(var o in e)e[o]=null;e=null})}(),{registerObject:function(e,t,n,i){if(X.w3&&e&&t){var r={};r.id=e,r.swfVersion=t,r.expressInstall=n,r.callbackFn=i,Q[Q.length]=r,w(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){return X.w3?o(e):void 0},embedSWF:function(e,t,i,r,s,o,c,u,d,p){var g=m(t),f={success:!1,id:g};X.w3&&!(X.wk&&X.wk<312)&&e&&t&&i&&r&&s?(w(g,!1),n(function(){i+="",r+="";var n={};if(d&&typeof d===R)for(var m in d)n[m]=d[m];n.data=e,n.width=i,n.height=r;var _={};if(u&&typeof u===R)for(var v in u)_[v]=u[v];if(c&&typeof c===R)for(var y in c)if(c.hasOwnProperty(y)){var C=G?encodeURIComponent(y):y,T=G?encodeURIComponent(c[y]):c[y];typeof _.flashvars!==M?_.flashvars+="&"+C+"="+T:_.flashvars=C+"="+T}if(b(s)){var A=h(n,_,t);n.id==g&&w(g,!0),f.success=!0,f.ref=A,f.id=A.id}else{if(o&&a())return n.data=o,void l(n,_,t,p);w(g,!0)}p&&p(f)})):p&&p(f)},switchOffAutoHideShow:function(){J=!1},enableUriEncoding:function(e){G=typeof e===M?!0:e},ua:X,getFlashPlayerVersion:function(){return{major:X.pv[0],minor:X.pv[1],release:X.pv[2]}},hasFlashPlayerVersion:b,createSWF:function(e,t,n){return X.w3?h(e,t,n):void 0},showExpressInstall:function(e,t,n,i){X.w3&&a()&&l(e,t,n,i)},removeSWF:function(e){X.w3&&g(e)},createCSS:function(e,t,n,i){X.w3&&T(e,t,n,i)},addDomLoadEvent:n,addLoadEvent:i,getQueryParamValue:function(e){var t=q.location.search||q.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),!e)return A(t);for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return A(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if($){var e=_(F);e&&P&&(e.parentNode.replaceChild(P,e),E&&(w(E,!0),X.ie&&(P.style.display="block")),S&&S(k)),$=!1}},version:"2.3"}}();return e}),define("cvp/customevent",["require","exports","module","Class","cvp/utils","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/log"),o=s.getLogger(),a=i.extend({init:function(e){this._type=e,this._listeners=[]},addListener:function(e,t){r.isFunc(e)||o.warn("A function was not provided to `addListener`."),this._listeners.push({fn:e,ctxt:t})},removeListener:function(e,t){for(var n,i=0,r=this._listeners;i<r.length;)n=r[i],n.fn===e&&n.ctxt===t?r.splice(i,1):++i},dispatch:function(){for(var e,t=0,n=this._listeners.slice(),i=n.length;i>t;++t)e=n[t],e.fn.apply(e.ctxt,arguments)}});n.exports=a}),define("cvp/events",["require","exports","module","swfobject","cvp/utils","cvp/customevent"],function(e,t){function n(e){a.addDomLoadEvent(e)}function i(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=u++),e._cvpStoredEvents||(e._cvpStoredEvents={});var i=e._cvpStoredEvents[t];i||(i=e._cvpStoredEvents[t]={},e["on"+t]&&(i[0]=e["on"+t]),e["on"+t]=s),i[n.$$guid]=n}}function r(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e._cvpStoredEvents&&e._cvpStoredEvents[t]&&n.$$guid&&delete e._cvpStoredEvents[t][n.$$guid]}function s(e){e=e||o(window.event);var t,n=!0,i=this._cvpStoredEvents[e.type];for(t in i)l.hasOwn(i,t)&&(this.$$handler=i[t],this.$$handler(e)===!1&&(n=!1));return this.$$handler&&(this.$$handler=null),n}function o(e){return e.preventDefault=o._preventDefault,e.stopPropagation=o._stopPropagation,e}var a=e("swfobject"),l=e("cvp/utils"),c=e("cvp/customevent"),u=1;o._preventDefault=function(){this.returnValue=!1},o._stopPropagation=function(){this.cancelBubble=!0},t.onReady=n,t.addListener=i,t.removeListener=r,t.CustomEvent=c}),define("cvp/detectors/pageorientationdetector",["require","exports","module","Class","cvp/utils","cvp/events"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/events"),o=i.extend({init:function(e){e=r.extend({callback:function(){}},e),this._callback=e.callback,this.handleOrientationBind=r.bind(this._handleScroll,this)},_handleScroll:function(){var e;switch(window.orientation){case-90:case 90:e="landscape";break;default:e="portrait"}this._callback&&this._callback(e)},start:function(){s.addListener(window,"orientationchange",this.handleOrientationBind)},stop:function(){s.removeListener(window,"orientationchange",this.handleOrientationBind)}});n.exports=o}),define("cvp/detectors/basestrategy",["require","exports","module","Class"],function(e,t,n){var i=e("Class"),r=i.extend({getType:function(){throw new Error("'getType' must be implemented by child class.")},canUse:function(){throw new Error("'canUse' must be implemented by child class.")},isComposable:function(){return!0},start:function(){throw new Error("'start' must be implemented by child class.")},stop:function(){throw new Error("'stop' must be implemented by child class.")}});n.exports=r}),define("cvp/detectors/pagevisibilitystrategy",["require","exports","module","cvp/detectors/basestrategy","cvp/utils","cvp/events"],function(e,t,n){var i=e("cvp/detectors/basestrategy"),r=e("cvp/utils"),s=e("cvp/events"),o=i.extend({init:function(e){e=r.extend({callback:null},e),this._callback=e.callback,this._eventName=null,this._propName=null;for(var t=[{event:"msvisibilitychange",prop:"msHidden"},{event:"webkitvisibilitychange",prop:"webkitHidden"},{event:"mozvisibilitychange",prop:"mozHidden"},{event:"visibilitychange",prop:"hidden"}],n=0;n<t.length;++n)t[n].prop in document&&(this._propName=t[n].prop,this._eventName=t[n].event);this._onChangeBind=r.bind(this._onChange,this)},getType:function(){return"PageVisibilityStrategy"},canUse:function(){return null!=this._propName},_onChange:function(){var e=this._getHiddenValue();this._callback&&this._callback(!e)},_getHiddenValue:function(){return document[this._propName]},start:function(){s.addListener(document,this._eventName,this._onChangeBind)},stop:function(){s.removeListener(document,this._eventName,this._onChangeBind)}});n.exports=o}),define("cvp/detectors/pagefocusstrategy",["require","exports","module","cvp/detectors/basestrategy","cvp/utils","cvp/browser","cvp/events"],function(e,t,n){var i=e("cvp/detectors/basestrategy"),r=e("cvp/utils"),s=e("cvp/browser"),o=e("cvp/events"),a=i.extend({init:function(e){e=r.extend({callback:null},e),this._delayFireBlur=!1,this._timerId=null,this._callback=e.callback,this._onFocusFiredBind=r.bind(this._onFocusFired,this),this._onBlurFiredBind=r.bind(this._onBlurFired,this),this._fireBlurBind=r.bind(this._fireBlur,this)},getType:function(){return"PageFocusStrategy"},canUse:function(){return s.isBrowser(s.IE)===!1},_onFocusFired:function(){return this._delayFireBlur?(this._timerId&&window.clearTimeout(this._timerId),void(this._delayFireBlur=!1)):void this._onChange(!0)},_onBlurFired:function(){this._delayFireBlur=!0,this._timerId=window.setTimeout(this._fireBlurBind,500)},_fireBlur:function(){this._delayFireBlur&&this._callback&&this._onChange(!1),this._delayFireBlur=!1},_onChange:function(e){this._callback&&this._callback(e)},start:function(){o.addListener(window,"focus",this._onFocusFiredBind),o.addListener(window,"blur",this._onBlurFiredBind)},stop:function(){o.removeListener(window,"focus",this._onFocusFiredBind),o.removeListener(window,"blur",this._onBlurFiredBind)}});n.exports=a}),define("cvp/detectors/pagefocusinstrategy",["require","exports","module","cvp/detectors/basestrategy","cvp/utils","cvp/browser","cvp/events"],function(e,t,n){var i=e("cvp/detectors/basestrategy"),r=e("cvp/utils"),s=e("cvp/browser"),o=e("cvp/events"),a=i.extend({init:function(e){e=r.extend({callback:null},e),this._delayFireBlur=!1,this._timerId=null,this._callback=e.callback,this._onFocusFiredBind=r.bind(this._onFocusFired,this),this._onBlurFiredBind=r.bind(this._onBlurFired,this),this._fireBlurBind=r.bind(this._fireBlur,this)},getType:function(){return"PageFocusInStrategy"},canUse:function(){return s.isBrowser(s.IE)===!0},_onFocusFired:function(){return this._delayFireBlur?(this._timerId&&window.clearTimeout(this._timerId),void(this._delayFireBlur=!1)):void this._onChange(!0)},_onBlurFired:function(){this._delayFireBlur=!0,this._timerId=window.setTimeout(this._fireBlurBind,500)},_fireBlur:function(){this._delayFireBlur&&this._callback&&this._onChange(!1),this._delayFireBlur=!1},_onChange:function(e){this._callback&&this._callback(e)},start:function(){o.addListener(document,"focusin",this._onFocusFiredBind),o.addListener(document,"focusout",this._onBlurFiredBind)},stop:function(){o.removeListener(document,"focusin",this._onFocusFiredBind),o.removeListener(document,"focusout",this._onBlurFiredBind)}});n.exports=a}),define("cvp/detectors/pagefocusdetector",["require","exports","module","Class","cvp/utils","cvp/log","cvp/detectors/pagevisibilitystrategy","cvp/detectors/pagefocusstrategy","cvp/detectors/pagefocusinstrategy"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/log"),o=e("cvp/detectors/pagevisibilitystrategy"),a=e("cvp/detectors/pagefocusstrategy"),l=e("cvp/detectors/pagefocusinstrategy"),c=s.getLogger(),u=i.extend({init:function(e){e=r.extend({callback:null,strategies:null,mode:u.AGGRESSIVE},e),this._mode=e.mode,this._callback=e.callback,this._visible=null,this._onChangeBind=r.bind(this._onChange,this),this._availableStrategies=e.strategies||[new o({callback:this._onChangeBind}),new a({callback:this._onChangeBind}),new l({callback:this._onChangeBind})],this._strategies=[];
for(var t=0;t<this._availableStrategies.length;++t)if(this._availableStrategies[t].canUse()){if(this._strategies.length>0&&!this._availableStrategies[t].isComposable())continue;if(this._strategies.push(this._availableStrategies[t]),c.log("[PageFocusDetector] Using detection strategy: "+this._availableStrategies[t].getType()),this._mode!==u.AGGRESSIVE){c.log("[PageFocusDetector] Conservative mode - sticking with one strategy");break}}this._strategies.length||c.log("[PageFocusDetector] Warning - no valid detection strategies found.")},_onChange:function(e){(null==this._visible||this._visible!==e)&&(this._visible=e,this._callback&&this._callback(e))},start:function(){r.each(this._strategies,function(e){e.start()})},stop:function(){r.each(this._strategies,function(e){e.stop()})}});u.CONSERVATIVE="conservative",u.AGGRESSIVE="aggressive",n.exports=u}),define("cvp/detectors/scrolldetector",["require","exports","module","Class","cvp/utils","cvp/events","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/events"),o=e("cvp/log"),a=o.getLogger(),l=i.extend({init:function(e){e=r.extend({callback:function(){},delay:500},e),this._callback=e.callback,this._interval=e.interval,a.log("[ScrollDetector] debouncing with a delay of: "+e.delay),this.handleScrollBind=r.debounce(r.bind(this._handleScroll,this),e.delay)},_handleScroll:function(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this._callback&&this._callback({scrollTop:e,scrollLeft:t,windowWidth:n,windowHeight:i})},start:function(){s.addListener(window,"scroll",this.handleScrollBind),s.addListener(window,"resize",this.handleScrollBind)},stop:function(){s.removeListener(window,"scroll",this.handleScrollBind),s.removeListener(window,"resize",this.handleScrollBind)}});n.exports=l}),define("cvp/detectors/viewportdetector",["require","exports","module","Class","cvp/utils","cvp/detectors/scrolldetector"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/detectors/scrolldetector"),o=i.extend({init:function(e){e=r.extend({delay:500},this._validateTargetOptions(e)),this._targets=[],this.addTarget(e),this._scrollDetector=new s({callback:r.bind(this._onScroll,this),delay:e.delay})},_validateTargetOptions:function(e){return r.extend({elementId:null,callback:function(){}},e)},addTarget:function(e){if(e=this._validateTargetOptions(e),null!=e.elementId){var t=e.elementId,n=e.callback;this._targets.push({elementId:t,callback:n,clipped:!1})}},_onScroll:function(e){function t(e){var t,n,r={top:0,left:0};return(t=e&&e.ownerDocument)?(n=t.documentElement,"undefined"!=typeof e.getBoundingClientRect&&(r=e.getBoundingClientRect()),{top:r.top+i-(n.clientTop||0),left:r.left+s-(n.clientLeft||0),width:e.offsetWidth,height:e.offsetHeight}):null}function n(e,t,n){return e!=t&&n&&n(!e),e}var i=e.scrollTop,s=e.scrollLeft,o=e.windowWidth,a=e.windowHeight;r.each(this._targets,function(e){var l=e.elementId;if(r.isString(l)&&(l=r.byId(l)),l){var c=t(l);c&&(i>=c.top+c.height||s>=c.left+c.width||c.top>=i+a||c.left>=s+o?e.clipped=n(!0,e.clipped,e.callback):c.top>i&&c.top+c.height<i+a&&(e.clipped=n(!1,e.clipped,e.callback)))}})},start:function(){this._scrollDetector.start()},stop:function(){this._scrollDetector.stop()}});n.exports=o}),define("cvp/static",["require","exports","module","core/app","cvp/detectors/pageorientationdetector","cvp/detectors/pagefocusdetector","cvp/detectors/viewportdetector","cvp/utils","cvp/log"],function(e,t,n){var i=e("core/app"),r=e("cvp/detectors/pageorientationdetector"),s=e("cvp/detectors/pagefocusdetector"),o=e("cvp/detectors/viewportdetector"),a=e("cvp/utils"),l=e("cvp/log"),c=l.getLogger(),u={},d={initialized:!1,init:function(){var e=this;this.initialized||(this._pageOrientationDetector=new r({callback:function(t){e._sendToAllInstances("onPageOrientationChange",t)}}),this._pageFocusDetector=new s({callback:function(t){e._sendToAllInstances("onPageVisibilityChange",t)}}),this._viewportDetector=new o,this._pageOrientationDetector.start(),this._pageFocusDetector.start(),this._viewportDetector.start(),this.initialized=!0)},registerInstance:function(e){var t=u.findInstance(e);t&&this._addViewportTarget(e)},unregisterInstance:function(){},_addViewportTarget:function(e){var t=this;this._viewportDetector.addTarget({elementId:e,callback:function(n){t._sendToInstance(e,"onViewportVisibilityChange",n)}})},_sendToAllInstances:function(){var e=a.slice(arguments);a.each(u.instances,function(t,n){n.send.apply(n,e)})},_sendToInstance:function(e){var t=a.slice(arguments,1),n=u.instances[e];n&&n.send.apply(n,t)}};u.HTML5=i.HTML5,u.FLASH=i.FLASH,u.version=i.VERSION,u.buildDate=i.BUILD_DATE,u.VIDEO_NOT_FOUND_ERROR="video not found",u.VIDEO_XML_NOT_FOUND_ERROR="cms error",u.MEDIA_ERR_UNKNOWN="Unknown error.",u.MEDIA_ERR_ABORTED="The fetching process for the media resource was aborted by the user agent at the user's request.",u.MEDIA_ERR_NETWORK="A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.",u.MEDIA_ERR_DECODE="An error of some description occurred while decoding the media resource, after the resource was established to be usable.",u.MEDIA_ERR_SRC_NOT_SUPPORTED="The media resource indicated by the src attribute was not suitable.",u.instances={},u.registerInstance=function(e,t,n){u.instances[e]={instance:t,send:n},d.initialized||d.init(),d.registerInstance(e)},u.unregisterInstance=function(e){e in u.instances&&(window[e+"_callback_handler"]=null,u.instances[e]=null,delete u.instances[e])},u.findInstance=function(e){var t=u.instances[e];return t&&t.instance||t},u.onCallback=function(e,t){var n=u.instances[e];if(!n)throw c.error("onCallback - unable to find instance "+e),new Error("onCallback - unable to find instance "+e);return n.send.apply(n.instance,["handleCallBack"].concat(a.slice(t)))},u.cleanup=function(){a.each(u.instances,function(e,t){try{t.instance.destroy(),u.unregisterInstance(e)}catch(n){}})},n.exports=u}),define("cvp/shared",["require","exports","module","cvp/static","cvp/version","core/app","cvp/utils","cvp/log"],function(e,t){function n(e){var t=e+"_callback_handler";return l.isFunc(window[t])?!1:(window[t]=function(){return arguments.length&&"_pluginRequest"===arguments[0]?s.PluginManager.onPluginHostRequest(e,l.slice(arguments,1)):s.onCallback(e,arguments)},!0)}function i(e){if(e===a.FLASH_VERSION)return e;try{var t=new o(e);if(t.gt(a.FLASH_VERSION))return t.toString()}catch(n){u.warn("Failure to compare Flash versions",a.FLASH_VERSION,e)}return a.FLASH_VERSION}function r(e){var t=window.onbeforeunload;window.onbeforeunload="function"!=typeof window.onbeforeunload?e:function(){t&&t(),e()}}var s=e("cvp/static"),o=e("cvp/version"),a=e("core/app"),l=e("cvp/utils"),c=e("cvp/log"),u=c.getLogger();t.createCallbackHandler=n,t.validateFlashVersion=i,t.addBeforeUnLoadEvent=r}),define("cvp/api",["require","exports","module","cvp/utils","cvp/static","cvp/shared","swfobject","cvp/events"],function(e,t,n){var i=e("cvp/utils"),r=e("cvp/static"),s=e("cvp/shared"),o=e("swfobject"),a=e("cvp/events"),l={getDOMPlayer:-1!==navigator.appName.indexOf("Microsoft")?function(){return window[this.getId()]}:function(){return document[this.getId()]},sendMessage:function(e,t){return this.getDOMPlayer().sendMessage(e,t),this},getPlayer:function(e){return this._playerType===r.FLASH?(this.getDOMPlayer().getPlayerJS(e),this):this.getDOMPlayer()},setDefaultPlayer:function(e){return this.getDOMPlayer().setDefaultPlayer(e),this},embedSWF:function(){return this.embed.apply(this,arguments)},embed:function(e){if(this._playerType===r.FLASH){var t=this.getId(),n=this.getFlashVars();n.domId=t,n.cvpSessionToken=r.getSessionToken();var l=this.getEmbed(),c=l.containerSwf,u=l.options,d=l.expressInstallSwf,h=s.validateFlashVersion(l.flashVersion),p={id:t,name:t};o.hasFlashPlayerVersion("1.0.0")||r.onCallback(t,["onNoFlashDetected"]),o.embedSWF(c,e,this.getWidth(),this.getHeight(),h,d,n,u,p)}else{var g=this.getPlayer();i.isFunc(g.embed)&&a.onReady(function(){g.embed(e)})}return this},removeSWF:function(){return this.remove.apply(this,arguments)},remove:function(){if(this.stop(),this._playerType===r.FLASH)o.removeSWF(this.getId());else{var e=this.getPlayer();i.isFunc(e.remove)&&e.remove()}return this},destroy:function(){var e=this.getId();if(r.findInstance(e)){if(this.remove(),this._playerType===r.FLASH);else{var t=this.getPlayer();i.isFunc(t.dispose)&&t.dispose()}r.unregisterInstance(e)}},play:function(e,t){return this.getDOMPlayer().playContent(e,t||{}),this},playFromObject:function(e,t){return this.getDOMPlayer().playFromObject(e,t||{}),this},reportAnalytics:function(e,t){return this.getDOMPlayer().reportAnalytics(e,t),this},replay:function(){return this.getDOMPlayer().replayContent(),this},playNextInQueue:function(){return this.getDOMPlayer().playNextInQueue(),this},pause:function(){return this.getDOMPlayer().pause(),this},resume:function(){return this.getDOMPlayer().resume(),this},stop:function(){return this.getDOMPlayer().stopContent(),this},queue:function(e,t,n){return"undefined"==typeof n&&(n=-1),this.getDOMPlayer().queue(e,t||{},n),this},queueFromObject:function(e,t,n){return"undefined"==typeof n&&(n=-1),this.getDOMPlayer().queueFromObject(e,t||{},n),this},dequeue:function(e){return this.getDOMPlayer().dequeue(e),this},emptyQueue:function(){return this.getDOMPlayer().emptyQueue(),this},setQueueAutoplay:function(e){return this.getDOMPlayer().setQueueAutoplay(e),this},getQueue:function(){return this.getDOMPlayer().getQueue()},seek:function(e){return this.getDOMPlayer().seek(e),this},mute:function(){return this.getDOMPlayer().mute(),this},unmute:function(){return this.getDOMPlayer().unmute(),this},setVolume:function(e){return this.getDOMPlayer().setVolume(e),this},getVolume:function(){return this.getDOMPlayer().getVolume()},isMuted:function(){return this.getDOMPlayer().isMuted()},getContentEntry:function(e){return this.getDOMPlayer().getContentEntry(e)},goFullscreen:function(){return this.getDOMPlayer().goFullscreen(),this},resize:function(e,t,n){return this.getDOMPlayer().resize(e,t,n),this},setMaxBitrate:function(e){return this.getDOMPlayer().setMaxBitrate(e),this},switchBitrateId:function(e){return this.getDOMPlayer().switchBitrateId(e),this},setAutoBitrateSwitch:function(e){return this.getDOMPlayer().setAutoBitrateSwitch(e),this},getAvailableBitrates:function(e){return this.getDOMPlayer().getAvailableBitrates(e)},getBitrateId:function(){return this.getDOMPlayer().getBitrateId()},setGroupOrder:function(e){return this.getDOMPlayer().setGroupOrder(e),this},getShareOptions:function(){return this.getDOMPlayer().getShareOptions()},setClosedCaptions:function(e,t){return this.getDOMPlayer().setClosedCaptions(e,t),this},setAdSection:function(e){return this.getDOMPlayer().setAdSection(e),this},setAdKeyValue:function(e,t){return this.getDOMPlayer().setAdKeyValue(e,t),this},getAdKeyValues:function(){return this.getDOMPlayer().getAdKeyValues()},clearAdKeyValues:function(){return this.getDOMPlayer().clearAdKeyValues(),this},setAdExchangeValue:function(e,t){return this.getDOMPlayer().setAdExchangeValue(e,t),this},setAdVisibility:function(e){return this.getDOMPlayer().setAdVisibility(e),this},switchAdContext:function(e){return this.getDOMPlayer().switchAdContext(e),this},switchTrackingContext:function(e){return this.getDOMPlayer().switchTrackingContext(e),this},setTrackingInterval:function(e){return this.getDOMPlayer().setTrackingInterval(e),this},setDataSrc:function(e){return this.getDOMPlayer().setDataSrc(e),this},setFileKey:function(e){return this.getDOMPlayer().setFileKey(e),this},sendUIMessage:function(e,t){return this.getDOMPlayer().sendUIMessage(e,t),this},sendUserReportedIssue:function(e){return this.getDOMPlayer().sendUserReportedIssue(e),this}};n.exports=l}),define("cvp/players/null",["require","exports","module","Class"],function(e,t,n){var i=e("Class"),r=i.extend({init:function(){for(var e,t="sendMessage setDefaultPlayer play playFromObject replay playNextInQueue pause resume stop queue queueFromObject dequeue emptyQueue setQueueAutoplay getQueue seek mute unmute setVolume getVolume isMuted getContentEntry goFullscreen resize setMaxBitrate switchBitrateId setAutoBitrateSwitch getAvailableBitrates getBitrateId setGroupOrder getShareOptions setClosedCaptions setAdSection setAdKeyValue getAdKeyValues clearAdKeyValues setAdExchangeValue setAdVisibility switchAdContext switchTrackingContext setTrackingInterval setDataSrc setFileKey sendUIMessage sendUserReportedIssue".split(" "),n=function(){},i=0,r=t.length;r>i;++i)e=t[i],this[e]||(this[e]=n)}});n.exports=r}),define("cvp/utils/commandqueue",["require","exports","module","Class","cvp/utils"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=i.extend({init:function(){this._queue=[]},clear:function(){this._queue.length=0},push:function(e,t,n){var i=this._queue.length;return this._queue.push({fn:e,scope:t,args:n}),i},remove:function(e){e="number"!=typeof e?this._queue.length-1:e,this._queue.splice(e,1)},execute:function(){for(var e,t=0,n=this._queue.length;n>t;++t)e=this._queue[t],e.fn.apply(e.scope,e.args)},executeAsync:function(e){e=r.undef(e)?10:e;var t,n=this._queue.length;n&&(t=this._queue.shift(),t.fn.apply(t.scope,t.args),setTimeout(r.bind(this.executeAsync,this,e),e))}});n.exports=s}),define("cvp/ajax",["require","exports","module","when","cvp/utils","JSON","cvp/log"],function(e,t,n){var i=e("when"),r=e("cvp/utils"),s=e("JSON"),o=e("cvp/log"),a=o.getLogger(),l={get:function(e){return e.method="GET",this._request(e)},getXml:function(e){return e.type="xml",this.get(e)},getJSON:function(e){var t=i.defer(),n=e.success;return e.type="json",e.success=function(e){try{var n=s.parse(e);t.resolve(n)}catch(i){t.reject(i)}},this.get(e),i(t.promise,n,e.error),t.promise},getJSONP:function(e){return this.JSONP._request(e)},post:function(e){return e.method="POST",this._request(e)},_request:function(e){var t=new XMLHttpRequest,n=i.defer();return t.onreadystatechange=function(){4===t.readyState&&(200<=t.status&&t.status<300||304===t.status?n.resolve(t.responseText):n.reject(t),t.onreadystatechange=Function.prototype,t.abort(),t=null)},i(n.promise,e.success,e.error),t.open(e.method,e.url,!0),t.send("POST"===e.method?e.data:null),n.promise}};l.JSONP={requestTimeout:5e3,maxRetries:0,_externalRoutes:{},requestMap:{},_counter:0,_request:function(e){return e=r.extend({timeout:this.requestTimeout,maxRetries:this.maxRetries},e),e.tries=0,e.deferred=i.defer(),a.debug("JSONP - creating request with timeout ",e.timeout," and maxRetries ",e.maxRetries),this._sendRequest(e),i(e.deferred.promise,e.success,e.error),e.deferred.promise},_sendRequest:function(e){var t=this,n=this._createCallback(e),i=this._createScript(n,e.url);if(!i){var r="JSONP - unable to create script for request "+e.url;throw a.error(r),e.deferred.reject(e.url),new Error(r)}e.timeout&&setTimeout(function(){t._onError(n,e)},e.timeout)},_onSuccess:function(e,t,n){if(this.requestMap[e]){if(this._destroyRequest(e,t),r.isString(n))try{n=s.parse(n)}catch(i){a.error("JSON.parse failed")}a.info("JSONP","success",t.url),t.deferred.resolve(n)}},_onError:function(e,t){if(this.requestMap[e]){if(this._destroyRequest(e,t),++t.tries,t.maxRetries&&t.tries<t.maxRetries)return a.warn("Request failed - resending"),void this._sendRequest(t);a.error("JSONP","error",t.url),t.deferred.reject(t.url)}},_destroyRequest:function(e,t){this._deregisterExternalCallback(t.jsonpCallback,e),delete this.requestMap[e],this._counter--;var n=document.getElementById(this._getScriptName(e));n&&(n.parentNode.removeChild(n),n=null)},_createScript:function(e,t){var n="script",i=document.getElementsByTagName(n)[0],r=document.createElement(n);return r.type="text/javascript",e&&(r.id=this._getScriptName(e)),r.src=t,r.async=!0,i.parentNode.insertBefore(r,i),r},_getScriptName:function(e){return"cvp_jsonp_"+e},_createCallback:function(e){var t=this;if(r.empty(e.jsonpCallback))return null;++this._counter;var n="request_"+this._counter+"_"+r.now();this.requestMap[n]=function(i){t._onSuccess(n,e,i)};var i=function(e){a.debug("JSONP","Internal CB received for request:",n),t.requestMap[n]?t.requestMap[n](e):a.debug("Request response came in after allotted time: ",n)};return this._registerExternalCallback(e.jsonpCallback,n,i),n},_registerExternalCallback:function(e,t,n){window[e]||this._createExternalCallback(e,this._routeExternalCallback(e)),this._externalRoutes[e]||(this._externalRoutes[e]=[]),this._externalRoutes[e].push({id:t,cb:n})},_routeExternalCallback:function(e){var t=this;return function(n){if(a.info("JSONP","routing:",e),!t._externalRoutes)return void a.error("JSONP","routes haven't been initialized");if(!t._externalRoutes[e])return void a.error("JSONP","routing hasn't been initialized for:",e);if(!t._externalRoutes[e].length)return void a.error("JSONP","no waiting requests for route:",e);var i=t._externalRoutes[e].shift();a.info("JSONP","request retrieved - id: ",i.id,"cb:",typeof i.cb),r.isFunc(i.cb)&&i.cb(n)}},_createExternalCallback:function(e,t){window[e]=t},_deregisterExternalCallback:function(e,t){for(var n=0,i=this._externalRoutes[e].length;i>n;n++){var r=this._externalRoutes[e][n];if(r.id===t)return a.info("JSONP","removing request from route:",e,"with id:",t),void this._externalRoutes[e].splice(n,1)}}},n.exports=l}),define("cvp/utils/xml",["require","exports","module","cvp/utils"],function(e,t){function n(e){return 1===e.nodeType}function i(e){var t=l.slice(e.children||e.childNodes||[]);return t.length?l.filter(t,n):t}function r(e,t){if(!e)return null;if(!t)return l.isNull(e.firstChild)?null:e.firstChild.nodeValue;var n=e.getElementsByTagName(t);return n.length>0&&n[0].firstChild?n[0].firstChild.nodeValue:void 0}function s(e,t){if(!e||!t)return null;for(var n,i=e.getElementsByTagName("param"),r=0,s=i.length;s>r;++r)if(n=i[r],o(n,"name")===t)return o(n,"value")}function o(e,t){if(e&&e.attributes&&t){var n=e.attributes.getNamedItem(t);return n?n.nodeValue:null}}function a(e,t){for(var n,i=0,r=t&&t.length||0;r>i;++i)n=t[i],e[n.nodeName]=n.nodeValue}var l=e("cvp/utils"),c="DOMParser",u="XMLSerializer",d="ActiveXObject",h=function(){var e,t;return c in window?(e=new window[c],t=function(e){var t=e.getElementsByTagName("parsererror");return t&&0!==t.length},function(n){var i;return n?(i=e.parseFromString(l.trim(n),"text/xml"),t(i)?null:i):null}):d in window?(t=function(e){var t=e.parseError;return t&&0!==t.errorCode},function(e){var n;return e?(n=new window[d]("Microsoft.XMLDOM"),n.async="false",n.loadXML(e),t(n)?null:n):null}):void 0}(),p=function(){if(u in window){var e=new window[u];return function(t){return e.serializeToString(t)}}return d in window?function(e){return e.xml}:void 0}(),g=function(){var e=/>\s+</g,t=/\t+/g,n=/[\r\n]+/g,i=/<!--(.*?)-->/g,r=/&(?!amp;)/g,s=/xmlns(?::[^\s=]+)?=['"][^'"]*['"]/g;return function(o){return o=o.replace(e,"><"),o=o.replace(t," "),o=o.replace(n," "),o=o.replace(i,""),o=o.replace(r,"&amp;"),o=o.replace(s,"")}}();t.stringToDoc=h,t.docToString=p,t.cleanString=g,t.getChildElements=i,t.getNodeValue=r,t.getParamValue=s,t.getAttribute=o,t.assignAttributes=a}),define("cvp/utils/jsonconverter",["require","exports","module","JSON","cvp/utils/xml","cvp/utils","cvp/log"],function(e,t){function n(e){return C.test(e.nodeName)}function i(e){return e.nodeName}function r(e){var t=f.map(e,i),n=f.uniq(t);return t.length!==n.length}function s(e){return!n(e)}function o(e){return f.filter(f.slice(e.attributes),s)}function a(e,t){return t=t||{},e.length?(f.each(e,function(e){t[e.nodeName]=e.nodeValue}),t):t}function l(e){if(!e.hasChildNodes())return null;var t=e.textContent||e.innerText||"";return f.trim(t).replace(y," ")}function c(e,t){t=f.isSimpleObject(t)?t:{};var n,i=e.nodeName,s=e.nodeType,u={};switch(s){case _.DOCUMENT_NODE:n=g.getChildElements(e),t=n.length?c(n[0]):null;break;case _.ELEMENT_NODE:n=g.getChildElements(e);var d=o(e);if(n.length)r(n)?u=f.map(n,function(e){return c(e)}):(d.length&&a(d,u),f.each(n,function(e){return c(e,u)}));else{var h=l(e);d.length?(a(d,u),null!==h&&(u.text=h)):u=h||""}t[i]=u;break;default:v.debug("Ignoring type "+s+' node with name "'+i+'"')}return t}function u(e){if(!e||!e.nodeType||!e.nodeName||e.nodeType!==_.ELEMENT_NODE||"video"!==e.nodeName)return v.debug('Not a "video" node; passing through.'),c(e);v.debug('Processing "video" children...');var t={},n=g.getChildElements(e),i=o(e);if(n.length)i.length&&a(i,t),f.each(n,function(e){return c(e,t)});else{var r=l(e);i.length?(a(i,t),null!==r&&(t.text=r)):t=r||""}return{video:t}}function d(e){e.normalize();var t=u(e);if(t)for(var n in t)return t[n];return null}function h(e){return p.stringify(d(e),null,"	")}var p=e("JSON"),g=e("cvp/utils/xml"),f=e("cvp/utils"),m=e("cvp/log"),_=window.Node,v=m.getLogger("JSONConverter"),y=/[\t\n\r\xA0]+/g,C=/^xmlns($|:)/;t.encodeXmlObject=h,t.xmlToJson=h,t.xmlToObject=d}),define("cvp/utils/dependencymanager",["require","exports","module","Class","cvp/customevent"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=i.extend({init:function(){this._dependencies=[],this._currentDependency=null,this.eSuccess=new r,this.eFailure=new r,this.eDependencySuccess=new r,this.eDependencyFailure=new r},addDependency:function(e){e.setManager(this),this._dependencies.push(e)},load:function(){this._currentDependency=this._dependencies.shift(),this._currentDependency.eSuccess.addListener(this._onDependencySuccess,this),this._currentDependency.eFailure.addListener(this._onDependencyFailure,this);var e=this;window.setTimeout(function(){e._currentDependency.load()},10)},_onDependencySuccess:function(e){this.eDependencySuccess.dispatch(this._currentDependency,e),this._next()},_onDependencyFailure:function(e){return this.eDependencyFailure.dispatch(this._currentDependency,e),this._currentDependency.required?void this._onFailure(this._currentDependency.getDesc()):void this._next()},_next:function(){this._currentDependency.eSuccess.removeListener(this._onDependencySuccess,this),this._currentDependency.eFailure.removeListener(this._onDependencyFailure,this),this._currentDependency=null,this._dependencies.length?this.load():this._onSuccess()},_onSuccess:function(){this.eSuccess.dispatch()},_onFailure:function(e){this.eFailure.dispatch(e)}});n.exports=s}),define("cvp/utils/asset",["require","exports","module","Class","cvp/utils","cvp/customevent","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/customevent"),o=e("cvp/log"),a=o.getLogger(),l=i.extend({init:function(e,t){this._firedSuccess=!1,this._url=e,this._type=r.empty(t)?this._determineType():t,this.id="cvp_asset_"+r.getRandomInt(1,1e3),this.eSuccess=new s,this.eFailure=new s},_determineType:function(){var e=r.empty(this._url)?"":this._url.substring(this._url.lastIndexOf(".")+1);return e},load:function(){switch(a.info("Asset","loading type",this._type),this._type){case"js":this._loadJs();break;case"css":this._loadCss();break;default:this._failure()}},_success:function(){a.info("Asset","successfully loaded asset",this._url),this.eSuccess.dispatch(),this._firedSuccess=!0},_failure:function(){a.error("Asset","failed to load asset",this._url),this.eFailure.dispatch()},_loadJs:function(){var e=document.getElementsByTagName("head")[0];if(!e)return void this._failure();var t=document.createElement("script");t.id=this.id,t.type="text/javascript";var n=r.bind(function(){this._firedSuccess||(this._success(),t.onload=t.onreadystatechange=null,e.removeChild(t))},this);t.onload=n,t.onerror=r.bind(this._failure,this),t.onreadystatechange=function(){("loaded"===this.readyState||"complete"===this.readyState)&&n()},t.src=this._url,e.appendChild(t)},_loadCss:function(){var e,t=document.getElementsByTagName("head")[0];return t?(e=document.createElement("link"),e.type="text/css",e.rel="stylesheet",e.href=this._url,e.media="screen",t.appendChild(e),void this._success()):void this._failure()}});n.exports=l}),define("cvp/utils/dependency",["require","exports","module","Class","cvp/customevent","cvp/utils/asset","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("cvp/utils/asset"),o=e("cvp/log"),a=o.getLogger(),l=i.extend({init:function(e,t){this._assetUrl=e,this.required=t,this._manager=null,this.eSuccess=new r,this.eFailure=new r},load:function(){a.info("Dependency","loading asset",this._assetUrl),this._assetLoader=new s(this._assetUrl),this._assetLoader.eSuccess.addListener(this._success,this),this._assetLoader.eFailure.addListener(this._failure,this),this._assetLoader.load()},_success:function(){a.info("Dependency","successfully loaded dependency",this._assetUrl),this.eSuccess.dispatch.apply(this.eSuccess,arguments),this._complete()},_failure:function(){a.error("Dependency","failed to load dependency",this._assetUrl),this.eFailure.dispatch.apply(this.eFailure,arguments),this._complete()},_complete:function(){this._assetLoader&&(this._assetLoader.eSuccess.removeListener(this._success,this),this._assetLoader.eFailure.removeListener(this._failure,this),this._assetLoader=null)},setManager:function(e){this._manager=e},getDesc:function(){return this._assetUrl}});n.exports=l}),define("cvp/store",["require","exports","module","cvp/utils"],function(e,t,n){var i=e("cvp/utils"),r={};n.exports={get:function(e,t){var n=r[e];return t&&delete r[e],n},keys:function(){var e=[];for(var t in r)i.hasOwn(r,t)&&e.push(t);return e},set:function(e,t){r[e]=t}}}),define("cvp/transports/flashxhr",["require","exports","module","core/app","cvp/utils","cvp/store","cvp/customevent","cvp/utils/commandqueue","cvp/log","Class","swfobject"],function(e,t,n){var i=e("core/app"),r=e("cvp/utils"),s=e("cvp/store"),o=e("cvp/customevent"),a=e("cvp/utils/commandqueue"),l=e("cvp/log"),c=e("Class"),u=e("swfobject"),d=l.getLogger(),h=c.extend({init:function(e){d.debug("[Transport.init]"),this.ready=!1,this.queue=new a,this.events={dataReceived:new o("dataReceived"),dataReceivedError:new o("dataReceivedError")},this.channelId=h.nextChannel(),h.registerInstance(this),e=r.undef(e)?!1:e,e||h.loadDependencies()},onReady:function(){d.debug("[Transport.onReady] channel: "+this.channelId),this.createListeners(),this.ready=!0,this.queue.executeAsync()},createListeners:function(){var e=this;s.set(h.getResponseCallback(this.channelId),function(t,n){setTimeout(function(){e.fireDataReceived(t,n)},0)}),s.set(h.getResponseErrorCallback(this.channelId),function(t,n){setTimeout(function(){e.fireDataReceivedError(t,n)},0)})},request:function(e,t){return h.dependenciesLoaded||h.loadDependencies(),this.ready?(d.debug("[Transport.request] channel: "+this.channelId),void h.getSwf().request(this.channelId,e,t)):void this.queue.push(this.request,this,arguments)},on:function(e,t){this.events.hasOwnProperty(e)&&this.events[e].addListener(t)},fireDataReceived:function(e,t){this.events.dataReceived.dispatch(e,t)},fireDataReceivedError:function(e,t){this.events.dataReceivedError.dispatch(e,t)}});h.instances=[],h.registerInstance=function(e){var t={instance:e,ready:!1};h.dependenciesLoaded&&(e.onReady(),t.ready=!0),h.instances.push(t)},h.callPrefix="cvp_flash_xhr",h.readySuffix="ready",h.responseSuffix="response",h.responseErrorSuffix="response_error",h.getReadyCallback=function(){return[h.callPrefix,h.readySuffix].join("_")},h.getResponseCallback=function(e){return[h.callPrefix,e,h.responseSuffix].join("_")},h.getResponseErrorCallback=function(e){return[h.callPrefix,e,h.responseErrorSuffix].join("_")},h.channelIndex=0,h.nextChannel=function(){return"flaxhr."+ ++h.channelIndex},h.dependenciesLoading=!1,h.dependenciesLoaded=!1,h.loadDependencies=function(){h.dependenciesLoading||h.dependenciesLoaded||(h.dependenciesLoading=!0,h.embed(r.bind(h.onDependenciesLoaded,h)))},h.onDependenciesLoaded=function(){h.dependenciesLoading=!1,h.dependenciesLoaded=!0;for(var e=h.instances,t=0;t<e.length;t++)e[t].ready||(e[t].instance.onReady(),e[t].ready=!0)},h.swfId="cvpXhrFlash",h.swfUrl=i.FLASHXHR_SWF_URL,h.getSwf=function(){return document.getElementById(h.swfId)},h.embed=function(e){function t(e){if(!e||!e.success||!e.ref)return d.warn("[Transport.embed] failed to embed!");var t=e.ref.style;t.position="fixed",t.top=0,t.left=0}d.debug("[Transport.embed] Checking if xhr is required on the page");var n=h.swfUrl,o=h.swfId;if(h.getSwf())return d.debug("[Transport.embed] cvpXhrFlash already present on the page. Proceeding."),void(r.isFunc(e)&&e());var a=this.swfId+"_container",l=document.createElement("div");l.id=a,l.style.height="1px",l.style.width="1px",l.style.position="fixed",l.style.overflow="hidden",l.style.right=0,l.style.top=0,document.body.appendChild(l),s.set(h.getReadyCallback(),function(){d.debug("[Transport.ready] Callback received"),r.isFunc(e)&&e()});var c={callPrefix:this.callPrefix,log:"true"},p={menu:"false",scale:"noScale",allowScriptAccess:"always",wmode:"transparent"},g={id:o};d.debug("[Transport.embed] Embedding xhr swf"),u.embedSWF(n,a,"10","10","8.0.0",i.EXPRESS_INSTALL_URL,c,p,g,t)},n.exports=h}),define("cvp/convert",["require","exports","module","JSON","cvp/utils","cvp/utils/jsonconverter","cvp/utils/xml","cvp/log"],function(require,exports,module){function jsonTextToJsObject(jsontext){if(logger.log("Convert::jsonTextToJsObject"),Utils.isNull(jsontext))return null;if(jsontext=Utils.trim(jsontext),""===jsontext)return null;var jsobject=null;try{jsobject=JSON.parse(jsontext)}catch(e){if(logger.warn("Provided text was not valid JSON.  Attempting to eval()..."),isValidJSON(jsontext))try{jsobject=eval("("+jsontext+")")}catch(e2){logger.error("Unable to eval text into JS object.")}}return jsobject}function xmlTextToXmlDoc(e){logger.log("Convert::xmlTextToXmlDoc");var t;return e?(t=XML.stringToDoc(e),t||(logger.warn("Provided text was not valid XML.  Attempting to clean and parse again..."),e=XML.cleanString(e),t=XML.stringToDoc(e)),t):null}function xmlDocToXmlText(e){return logger.log("Convert::xmlDocToXmlText"),XML.docToString(e)}function xmlDocToJsonText(e){return logger.log("Convert::xmlDocToJsonText"),JsonConverter.xmlToJson(e)}function xmlDocToJsObject(e){return logger.log("Convert::xmlDocToJsObject"),JsonConverter.xmlToObject(e)}function xmlTextToJsonText(e){return logger.log("Convert::xmlTextToJsonText"),xmlDocToJsonText(xmlTextToXmlDoc(e))}function xmlTextToJsObject(e){return logger.log("Convert::xmlTextToJsObject"),jsonTextToJsObject(xmlTextToJsonText(e))}var JSON=require("JSON"),Utils=require("cvp/utils"),JsonConverter=require("cvp/utils/jsonconverter"),XML=require("cvp/utils/xml"),Log=require("cvp/log"),logger=Log.getLogger(),re_allBackslashPairs=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,re_allSimpleValueTokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,re_allOpenBrackets=/(?:^|:|,)(?:\s*\[)+/g,re_onlyValidLeftoverChars=/^[\],:{}\s]*$/,isValidJSON=function(e){return re_onlyValidLeftoverChars.test(e.replace(re_allBackslashPairs,"@").replace(re_allSimpleValueTokens,"]").replace(re_allOpenBrackets,""))};module.exports={jsonTextToJsObject:jsonTextToJsObject,xmlTextToXmlDoc:xmlTextToXmlDoc,xmlDocToXmlText:xmlDocToXmlText,xmlDocToJsonText:xmlDocToJsonText,xmlDocToJsObject:xmlDocToJsObject,xmlTextToJsonText:xmlTextToJsonText,xmlTextToJsObject:xmlTextToJsObject}}),function(e,t,n,i,r,s){function o(e,t){var n=typeof e[t];return"function"==n||!("object"!=n||!e[t])||"unknown"==n}function a(e,t){return!("object"!=typeof e[t]||!e[t])}function l(e){return"[object Array]"===Object.prototype.toString.call(e)}function c(){var e="Shockwave Flash",t="application/x-shockwave-flash";if(!y(navigator.plugins)&&"object"==typeof navigator.plugins[e]){var n=navigator.plugins[e].description;n&&!y(navigator.mimeTypes)&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(k=n.match(/\d+/g))}if(!k){var i;
try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),k=Array.prototype.slice.call(i.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),i=null}catch(r){}}if(!k)return!1;var s=parseInt(k[0],10),o=parseInt(k[1],10);return x=s>9&&o>0,!0}function u(){if(!Q){Q=!0;for(var e=0;e<W.length;e++)W[e]();W.length=0}}function d(e,t){return Q?void e.call(t):void W.push(function(){e.call(t)})}function h(){var e=parent;if(""!==j)for(var t=0,n=j.split(".");t<n.length;t++)e=e[n[t]];return e.easyXDM}function p(t){return e.easyXDM=q,j=t,j&&(V="easyXDM_"+j.replace(".","_")+"_"),B}function g(e){return e.match(D)[3]}function f(e){return e.match(D)[4]||""}function m(e){var t=e.toLowerCase().match(D),n=t[2],i=t[3],r=t[4]||"";return("http:"==n&&":80"==r||"https:"==n&&":443"==r)&&(r=""),n+"//"+i+r}function _(e){if(e=e.replace(N,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":n.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=n.protocol+"//"+n.host+t+e}for(;F.test(e);)e=e.replace(F,"");return e}function v(e,t){var n="",i=e.indexOf("#");-1!==i&&(n=e.substring(i),e=e.substring(0,i));var r=[];for(var o in t)t.hasOwnProperty(o)&&r.push(o+"="+s(t[o]));return e+(U?"#":-1==e.indexOf("?")?"?":"&")+r.join("&")+n}function y(e){return"undefined"==typeof e}function C(e,t,n){var i;for(var r in t)t.hasOwnProperty(r)&&(r in e?(i=t[r],"object"==typeof i?C(e[r],i,n):n||(e[r]=t[r])):e[r]=t[r]);return e}function b(){var e=t.body.appendChild(t.createElement("form")),n=e.appendChild(t.createElement("input"));n.name=V+"TEST"+L,S=n!==e.elements[n.name],t.body.removeChild(e)}function T(e){y(S)&&b();var n;S?n=t.createElement('<iframe name="'+e.props.name+'"/>'):(n=t.createElement("IFRAME"),n.name=e.props.name),n.id=n.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=t.getElementById(e.container)),e.container||(C(n.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=t.body);var i=e.props.src;if(e.props.src="javascript:false",C(n,e.props),n.border=n.frameBorder=0,n.allowTransparency=!0,e.container.appendChild(n),e.onLoad&&I(n,"load",e.onLoad),e.usePost){var r,s=e.container.appendChild(t.createElement("form"));if(s.target=n.name,s.action=i,s.method="POST","object"==typeof e.usePost)for(var o in e.usePost)e.usePost.hasOwnProperty(o)&&(S?r=t.createElement('<input name="'+o+'"/>'):(r=t.createElement("INPUT"),r.name=o),r.value=e.usePost[o],s.appendChild(r));s.submit(),s.parentNode.removeChild(s)}else n.src=i;return e.props.src=i,n}function w(e,t){"string"==typeof e&&(e=[e]);for(var n,i=e.length;i--;)if(n=e[i],n=new RegExp("^"==n.substr(0,1)?n:"^"+n.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),n.test(t))return!0;return!1}function A(i){var r,s=i.protocol;if(i.isHost=i.isHost||y(H.xdm_p),U=i.hash||!1,i.props||(i.props={}),i.isHost)i.remote=_(i.remote),i.channel=i.channel||"default"+L++,i.secret=Math.random().toString(16).substring(2),y(s)&&(s=m(n.href)==m(i.remote)?"4":o(e,"postMessage")||o(t,"postMessage")?"1":i.swf&&o(e,"ActiveXObject")&&c()?"6":"Gecko"===navigator.product&&"frameElement"in e&&-1==navigator.userAgent.indexOf("WebKit")?"5":i.remoteHelper?"2":"0");else if(i.channel=H.xdm_c.replace(/["'<>\\]/g,""),i.secret=H.xdm_s,i.remote=H.xdm_e.replace(/["'<>\\]/g,""),s=H.xdm_p,i.acl&&!w(i.acl,i.remote))throw new Error("Access denied for "+i.remote);switch(i.protocol=s,s){case"0":if(C(i,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),i.isHost){if(!i.local){for(var a,l=n.protocol+"//"+n.host,u=t.body.getElementsByTagName("img"),d=u.length;d--;)if(a=u[d],a.src.substring(0,l.length)===l){i.local=a.src;break}i.local||(i.local=e)}var h={xdm_c:i.channel,xdm_p:0};i.local===e?(i.usePolling=!0,i.useParent=!0,i.local=n.protocol+"//"+n.host+n.pathname+n.search,h.xdm_e=i.local,h.xdm_pa=1):h.xdm_e=_(i.local),i.container&&(i.useResize=!1,h.xdm_po=1),i.remote=v(i.remote,h)}else C(i,{channel:H.xdm_c,remote:H.xdm_e,useParent:!y(H.xdm_pa),usePolling:!y(H.xdm_po),useResize:i.useParent?!1:i.useResize});r=[new B.stack.HashTransport(i),new B.stack.ReliableBehavior({}),new B.stack.QueueBehavior({encode:!0,maxLength:4e3-i.remote.length}),new B.stack.VerifyBehavior({initiate:i.isHost})];break;case"1":r=[new B.stack.PostMessageTransport(i)];break;case"2":i.isHost&&(i.remoteHelper=_(i.remoteHelper)),r=[new B.stack.NameTransport(i),new B.stack.QueueBehavior,new B.stack.VerifyBehavior({initiate:i.isHost})];break;case"3":r=[new B.stack.NixTransport(i)];break;case"4":r=[new B.stack.SameOriginTransport(i)];break;case"5":r=[new B.stack.FrameElementTransport(i)];break;case"6":k||c(),r=[new B.stack.FlashTransport(i)]}return r.push(new B.stack.QueueBehavior({lazy:i.lazy,remove:!0})),r}function P(e){for(var t,n={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},i=0,r=e.length;r>i;i++)t=e[i],C(t,n,!0),0!==i&&(t.down=e[i-1]),i!==r-1&&(t.up=e[i+1]);return t}function E(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}var S,k,x,I,M,R=this,L=Math.floor(1e4*Math.random()),O=Function.prototype,D=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,F=/[\-\w]+\/\.\.\//,N=/([^:])\/\//g,j="",B={},q=e.easyXDM,V="easyXDM_",U=!1;if(o(e,"addEventListener"))I=function(e,t,n){e.addEventListener(t,n,!1)},M=function(e,t,n){e.removeEventListener(t,n,!1)};else{if(!o(e,"attachEvent"))throw new Error("Browser not supported");I=function(e,t,n){e.attachEvent("on"+t,n)},M=function(e,t,n){e.detachEvent("on"+t,n)}}var z,Q=!1,W=[];if("readyState"in t?(z=t.readyState,Q="complete"==z||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==z||"interactive"==z)):Q=!!t.body,!Q){if(o(e,"addEventListener"))I(t,"DOMContentLoaded",u);else if(I(t,"readystatechange",function(){"complete"==t.readyState&&u()}),t.documentElement.doScroll&&e===top){var K=function(){if(!Q){try{t.documentElement.doScroll("left")}catch(e){return void i(K,1)}u()}};K()}I(e,"load",u)}var H=function(e){e=e.substring(1).split("&");for(var t,n={},i=e.length;i--;)t=e[i].split("="),n[t[0]]=r(t[1]);return n}(/xdm_e=/.test(n.search)?n.search:n.hash),$=function(){var e={},t={a:[1,2,3]},n='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===n?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===n&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=n.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?($=function(){return e},e):null)};C(B,{version:"2.4.19.3",query:H,stack:{},apply:C,getJSONObject:$,whenReady:d,noConflict:p}),B.DomHelper={on:I,un:M,requiresJSON:function(n){a(e,"JSON")||t.write('<script type="text/javascript" src="'+n+'"></script>')}},function(){var e={};B.Fn={set:function(t,n){e[t]=n},get:function(t,n){if(e.hasOwnProperty(t)){var i=e[t];return n&&delete e[t],i}}}}(),B.Socket=function(e){var t=P(A(e).concat([{incoming:function(t,n){e.onMessage(t,n)},callback:function(t){e.onReady&&e.onReady(t)}}])),n=m(e.remote);this.origin=m(e.remote),this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,n)},t.init()},B.Rpc=function(e,t){if(t.local)for(var n in t.local)if(t.local.hasOwnProperty(n)){var i=t.local[n];"function"==typeof i&&(t.local[n]={method:i})}var r=P(A(e).concat([new B.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=m(e.remote),this.destroy=function(){r.destroy()},r.init()},B.stack.SameOriginTransport=function(e){var t,r,s,o;return t={outgoing:function(e,t,n){s(e),n&&n()},destroy:function(){r&&(r.parentNode.removeChild(r),r=null)},onDOMReady:function(){o=m(e.remote),e.isHost?(C(e.props,{src:v(e.remote,{xdm_e:n.protocol+"//"+n.host+n.pathname,xdm_c:e.channel,xdm_p:4}),name:V+e.channel+"_provider"}),r=T(e),B.Fn.set(e.channel,function(e){return s=e,i(function(){t.up.callback(!0)},0),function(e){t.up.incoming(e,o)}})):(s=h().Fn.get(e.channel,!0)(function(e){t.up.incoming(e,o)}),i(function(){t.up.callback(!0)},0))},init:function(){d(t.onDOMReady,t)}}},B.stack.FlashTransport=function(e){function r(e){i(function(){a.up.incoming(e,c)},0)}function o(n){var i=e.swf+"?host="+e.isHost,r="easyXDM_swf_"+Math.floor(1e4*Math.random());B.Fn.set("flash_loaded"+n.replace(/[\-.]/g,"_"),function(){B.stack.FlashTransport[n].swf=u=h.firstChild;for(var e=B.stack.FlashTransport[n].queue,t=0;t<e.length;t++)e[t]();e.length=0}),e.swfContainer?h="string"==typeof e.swfContainer?t.getElementById(e.swfContainer):e.swfContainer:(h=t.createElement("div"),C(h.style,x&&e.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),t.body.appendChild(h));var o="callback=flash_loaded"+s(n.replace(/[\-.]/g,"_"))+"&proto="+R.location.protocol+"&domain="+s(g(R.location.href))+"&port="+s(f(R.location.href))+"&ns="+s(j);h.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+r+"' data='"+i+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+i+"'></param><param name='flashvars' value='"+o+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+o+"' allowScriptAccess='always' wmode='transparent' src='"+i+"' height='1' width='1'></embed></object>"}var a,l,c,u,h;return a={outgoing:function(t,n,i){u.postMessage(e.channel,t.toString()),i&&i()},destroy:function(){try{u.destroyChannel(e.channel)}catch(t){}u=null,l&&(l.parentNode.removeChild(l),l=null)},onDOMReady:function(){c=e.remote,B.Fn.set("flash_"+e.channel+"_init",function(){i(function(){a.up.callback(!0)})}),B.Fn.set("flash_"+e.channel+"_onMessage",r),e.swf=_(e.swf);var t=g(e.swf),s=function(){B.stack.FlashTransport[t].init=!0,u=B.stack.FlashTransport[t].swf,u.createChannel(e.channel,e.secret,m(e.remote),e.isHost),e.isHost&&(x&&e.swfNoThrottle&&C(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),C(e.props,{src:v(e.remote,{xdm_e:m(n.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:V+e.channel+"_provider"}),l=T(e))};B.stack.FlashTransport[t]&&B.stack.FlashTransport[t].init?s():B.stack.FlashTransport[t]?B.stack.FlashTransport[t].queue.push(s):(B.stack.FlashTransport[t]={queue:[s]},o(t))},init:function(){d(a.onDOMReady,a)}}},B.stack.PostMessageTransport=function(t){function r(e){if(e.origin)return m(e.origin);if(e.uri)return m(e.uri);if(e.domain)return n.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function s(e){var n=r(e);n==c&&e.data.substring(0,t.channel.length+1)==t.channel+" "&&o.up.incoming(e.data.substring(t.channel.length+1),n)}var o,a,l,c;return o={outgoing:function(e,n,i){l.postMessage(t.channel+" "+e,n||c),i&&i()},destroy:function(){M(e,"message",s),a&&(l=null,a.parentNode.removeChild(a),a=null)},onDOMReady:function(){if(c=m(t.remote),t.isHost){var r=function(n){n.data==t.channel+"-ready"&&(l="postMessage"in a.contentWindow?a.contentWindow:a.contentWindow.document,M(e,"message",r),I(e,"message",s),i(function(){o.up.callback(!0)},0))};I(e,"message",r),C(t.props,{src:v(t.remote,{xdm_e:m(n.href),xdm_c:t.channel,xdm_p:1}),name:V+t.channel+"_provider"}),a=T(t)}else I(e,"message",s),l="postMessage"in e.parent?e.parent:e.parent.document,l.postMessage(t.channel+"-ready",c),i(function(){o.up.callback(!0)},0)},init:function(){d(o.onDOMReady,o)}}},B.stack.FrameElementTransport=function(r){var s,o,a,l;return s={outgoing:function(e,t,n){a.call(this,e),n&&n()},destroy:function(){o&&(o.parentNode.removeChild(o),o=null)},onDOMReady:function(){l=m(r.remote),r.isHost?(C(r.props,{src:v(r.remote,{xdm_e:m(n.href),xdm_c:r.channel,xdm_p:5}),name:V+r.channel+"_provider"}),o=T(r),o.fn=function(e){return delete o.fn,a=e,i(function(){s.up.callback(!0)},0),function(e){s.up.incoming(e,l)}}):(t.referrer&&m(t.referrer)!=H.xdm_e&&(e.top.location=H.xdm_e),a=e.frameElement.fn(function(e){s.up.incoming(e,l)}),s.up.callback(!0))},init:function(){d(s.onDOMReady,s)}}},B.stack.NameTransport=function(e){function t(t){var n=e.remoteHelper+(a?"#_3":"#_2")+e.channel;l.contentWindow.sendMessage(t,n)}function n(){a?2!==++u&&a||o.up.callback(!0):(t("ready"),o.up.callback(!0))}function r(e){o.up.incoming(e,p)}function s(){h&&i(function(){h(!0)},0)}var o,a,l,c,u,h,p,g;return o={outgoing:function(e,n,i){h=i,t(e)},destroy:function(){l.parentNode.removeChild(l),l=null,a&&(c.parentNode.removeChild(c),c=null)},onDOMReady:function(){a=e.isHost,u=0,p=m(e.remote),e.local=_(e.local),a?(B.Fn.set(e.channel,function(t){a&&"ready"===t&&(B.Fn.set(e.channel,r),n())}),g=v(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),C(e.props,{src:g+"#"+e.channel,name:V+e.channel+"_provider"}),c=T(e)):(e.remoteHelper=e.remote,B.Fn.set(e.channel,r));var t=function(){var r=l||this;M(r,"load",t),B.Fn.set(e.channel+"_load",s),function o(){"function"==typeof r.contentWindow.sendMessage?n():i(o,50)}()};l=T({props:{src:e.local+"#_4"+e.channel},onLoad:t})},init:function(){d(o.onDOMReady,o)}}},B.stack.HashTransport=function(t){function n(e){if(f){var n=t.remote+"#"+p++ +"_"+e;(l||!_?f.contentWindow:f).location=n}}function r(e){h=e,a.up.incoming(h.substring(h.indexOf("_")+1),v)}function s(){if(g){var e=g.location.href,t="",n=e.indexOf("#");-1!=n&&(t=e.substring(n)),t&&t!=h&&r(t)}}function o(){c=setInterval(s,u)}var a,l,c,u,h,p,g,f,_,v;return a={outgoing:function(e){n(e)},destroy:function(){e.clearInterval(c),(l||!_)&&f.parentNode.removeChild(f),f=null},onDOMReady:function(){if(l=t.isHost,u=t.interval,h="#"+t.channel,p=0,_=t.useParent,v=m(t.remote),l){if(C(t.props,{src:t.remote,name:V+t.channel+"_provider"}),_)t.onLoad=function(){g=e,o(),a.up.callback(!0)};else{var n=0,r=t.delay/50;!function s(){if(++n>r)throw new Error("Unable to reference listenerwindow");try{g=f.contentWindow.frames[V+t.channel+"_consumer"]}catch(e){}g?(o(),a.up.callback(!0)):i(s,50)}()}f=T(t)}else g=e,o(),_?(f=parent,a.up.callback(!0)):(C(t,{props:{src:t.remote+"#"+t.channel+new Date,name:V+t.channel+"_consumer"},onLoad:function(){a.up.callback(!0)}}),f=T(t))},init:function(){d(a.onDOMReady,a)}}},B.stack.ReliableBehavior=function(){var e,t,n=0,i=0,r="";return e={incoming:function(s,o){var a=s.indexOf("_"),l=s.substring(0,a).split(",");s=s.substring(a+1),l[0]==n&&(r="",t&&t(!0)),s.length>0&&(e.down.outgoing(l[1]+","+n+"_"+r,o),i!=l[1]&&(i=l[1],e.up.incoming(s,o)))},outgoing:function(s,o,a){r=s,t=a,e.down.outgoing(i+","+ ++n+"_"+s,o)}}},B.stack.QueueBehavior=function(e){function t(){if(e.remove&&0===a.length)return void E(n);if(!l&&0!==a.length&&!o){l=!0;var r=a.shift();n.down.outgoing(r.data,r.origin,function(e){l=!1,r.callback&&i(function(){r.callback(e)},0),t()})}}var n,o,a=[],l=!0,c="",u=0,d=!1,h=!1;return n={init:function(){y(e)&&(e={}),e.maxLength&&(u=e.maxLength,h=!0),e.lazy?d=!0:n.down.init()},callback:function(e){l=!1;var i=n.up;t(),i.callback(e)},incoming:function(t,i){if(h){var s=t.indexOf("_"),o=parseInt(t.substring(0,s),10);c+=t.substring(s+1),0===o&&(e.encode&&(c=r(c)),n.up.incoming(c,i),c="")}else n.up.incoming(t,i)},outgoing:function(i,r,o){e.encode&&(i=s(i));var l,c=[];if(h){for(;0!==i.length;)l=i.substring(0,u),i=i.substring(l.length),c.push(l);for(;l=c.shift();)a.push({data:c.length+"_"+l,origin:r,callback:0===c.length?o:null})}else a.push({data:i,origin:r,callback:o});d?n.down.init():t()},destroy:function(){o=!0,n.down.destroy()}}},B.stack.VerifyBehavior=function(e){function t(){i=Math.random().toString(16).substring(2),n.down.outgoing(i)}var n,i,r;return n={incoming:function(s,o){var a=s.indexOf("_");-1===a?s===i?n.up.callback(!0):r||(r=s,e.initiate||t(),n.down.outgoing(s)):s.substring(0,a)===r&&n.up.incoming(s.substring(a+1),o)},outgoing:function(e,t,r){n.down.outgoing(i+"_"+e,t,r)},callback:function(){e.initiate&&t()}}},B.stack.RpcBehavior=function(e,t){function n(e){e.jsonrpc="2.0",s.down.outgoing(o.stringify(e))}function i(e,t){var i=Array.prototype.slice;return function(){var r,s=arguments.length,o={method:t};s>0&&"function"==typeof arguments[s-1]?(s>1&&"function"==typeof arguments[s-2]?(r={success:arguments[s-2],error:arguments[s-1]},o.params=i.call(arguments,0,s-2)):(r={success:arguments[s-1]},o.params=i.call(arguments,0,s-1)),c[""+ ++a]=r,o.id=a):o.params=i.call(arguments,0),e.namedParams&&1===o.params.length&&(o.params=o.params[0]),n(o)}}function r(e,t,i,r){if(!i)return void(t&&n({id:t,error:{code:-32601,message:"Procedure not found."}}));var s,o;t?(s=function(e){s=O,n({id:t,result:e})},o=function(e,i){o=O;var r={id:t,error:{code:-32099,message:e}};i&&(r.error.data=i),n(r)}):s=o=O,l(r)||(r=[r]);try{var a=i.method.apply(i.scope,r.concat([s,o]));y(a)||s(a)}catch(c){o(c.message)}}var s,o=t.serializer||$(),a=0,c={};return s={incoming:function(e){var i=o.parse(e);if(i.method)t.handle?t.handle(i,n):r(i.method,i.id,t.local[i.method],i.params);else{var s=c[i.id];i.error?s.error&&s.error(i.error):s.success&&s.success(i.result),delete c[i.id]}},init:function(){if(t.remote)for(var n in t.remote)t.remote.hasOwnProperty(n)&&(e[n]=i(t.remote[n],n));s.down.init()},destroy:function(){for(var n in t.remote)t.remote.hasOwnProperty(n)&&e.hasOwnProperty(n)&&delete e[n];s.down.destroy()}}},define("easyXDM",B)}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent),define("cvp/request",["require","exports","module","core/app","cvp/utils","cvp/log","cvp/transports/flashxhr","JSON","swfobject","cvp/convert","when"],function(e,t,n){function i(){return L.apply(this,arguments)}var r=e("core/app"),s=e("cvp/utils"),o=e("cvp/log"),a=e("cvp/transports/flashxhr"),l=e("JSON"),c=e("swfobject"),u=e("cvp/convert"),d=e("when"),h=o.getLogger(),p="GET",g="POST",f="withCredentials",m=function(e,t,n){return function(){if(e&&4===e.readyState)try{200<=e.status&&e.status<300||304===e.status?n.resolve(e.responseText):n.reject(e.status+" "+e.statusText)}catch(t){h.error("Exception with XHR: ",t),n.reject(t.message)}finally{e.onreadystatechange=Function.prototype,e.abort(),e=null}}},_=function(e,t){for(var n in t)s.hasOwn(t,n)&&e.setRequestHeader(n,t[n])},v=function(e){return s.isNull(e)?e:s.isObject(e)?s.encodeParams(e):window.encodeURIComponent(e).replace(/%20/g,"+")},y={accepts:function(e){return!s.isCrossDomain(e.url)},request:function(e){h.log("Request::AjaxTransport.request",e.url),e.method===p&&e.data&&(e.url=s.augmentQueryString(e.url,e.data),e.data=null);var t=d.defer(),n=new window.XMLHttpRequest;n.onreadystatechange=m(n,e,t.resolver),n.open(e.method,e.url,!0),_(n,e.headers);var i=v(e.data);return n.send(e.method===g?i:null),t.promise}},C={_uniqId:0,_paramRE:/([^?&]+)=\?(?=&|$)/,createCallbackName:function(e){return"cvp_jsonp_"+e+"_"+s.now()},determineCallbackParam:function(e){var t=this._paramRE.exec(e);return t?t[1]:void 0},accepts:function(e){return"jsonp"===e.type||e.jsonpCallback},request:function(e){h.log("Request::JSONPTransport.request",e.url);var t=++this._uniqId;e.data=e.data||{},e.timeout=e.timeout||5e3;var n,i=d.defer(),r=function(e){n=e,i.resolve(e)},o="script",a=document.getElementsByTagName(o)[0],l=document.createElement(o),c=/^(complete|loaded)$/,u=!1,p=e.jsonpParam||this.determineCallbackParam(e.url),g=e.jsonpCallback||this.createCallbackName(t),f=window[g];window[g]=r,p&&(e.data[p]=g),e.cache===!1&&(e.data._=s.now()),e.url=s.augmentQueryString(e.url,e.data);var m=function(){u||"readyState"in l&&!c.test(l.readyState)||(u=!0,h.info("installed "+this.src))},_=function(){var e="failed to install "+this.src;u=!0,h.error(e),i.reject(e)},v=function(){if(!u){var t="timeout while attempting to load "+e.url;u=!0,h.warn(t),i.reject(t)}},y="number"==typeof e.timeout?window.setTimeout(v,e.timeout):null,C=function(){window[g]=f,window.clearTimeout(y),l.onload=l.onreadystatechange=l.onerror=null,l.parentElement.removeChild(l),n&&s.isFunction(f)&&f(n),a=l=f=n=void 0,void 0===window[g]&&delete window[g]};return i.promise.ensure(C),l.onload=l.onreadystatechange=m,l.onerror=_,l.id=e.id||this.createCallbackName(t),l.src=e.url,a.parentNode.insertBefore(l,a),i.promise}},b={accepts:function(){return c.hasFlashPlayerVersion("8.0.0")},request:function(e){h.log("Request::FlashXHRTransport.request",e.url);var t=d.defer(),n=new a(e.lazy),i=function(e,n){t.resolve(n)},r=function(e,n){t.reject(n)};return n.on("dataReceived",i),n.on("dataReceivedError",r),n.request(e.url,{type:e.method,data:e.data}),t.promise}},T={accepts:function(){return window.XMLHttpRequest&&f in new window.XMLHttpRequest||!s.isUndefined(window.XDomainRequest)},request:function(e){h.log("Request::CORSTransport.request",e.url);var t=new window.XMLHttpRequest,n=d.defer();if(e.method===p&&e.data&&(e.url=s.augmentQueryString(e.url,e.data),e.data=null),t.onreadystatechange=m(t,e,n.resolver),s.isBoolean(e.withCredentials)&&f in t&&(t.withCredentials=e.withCredentials),f in t)t.open(e.method,e.url,!0),e.method===g&&_(t,{"Content-Type":"application/x-www-form-urlencoded"});else{if(s.isUndefined(window.XDomainRequest))throw t=null,new Error("Did not find CORS-compatible interface.");t=new window.XDomainRequest,t.open(e.method,e.url)}var i=v(e.data);return t.send(e.method===g?i:null),n.promise}},w=[],A=function(e){if(h.log("Request::registerXDM"),s.isArray(e))h.debug("Request::registerXDM - merging provided array with xdmRegistry"),w.push.apply(w,e);else if(s.isSimpleObject(e)){h.debug("Request::registerXDM - adding each property to xdmRegistry");for(var t in e)s.hasOwn(e,t)&&w.push({match:t,path:e[t]})}else{if(2!==arguments.length)throw new Error("Invalid parameters to `registerXDM` -- use either registerXDM(list/map) or registerXDM(string/regex, path-to-iframe)");h.debug("Request::registerXDM - adding xdmRegistry for '"+arguments[0]+"' with path '"+arguments[1]+"'"),w.push({match:arguments[0],path:arguments[1]})}},P=function(e){h.log("Request::unregisterXDM");for(var t,n=e.toString(),i=w.length-1;i>=0;i--)if(t=w[i],n===t.match.toString())return w.splice(i,1)},E=function(e,t){h.log("Request::testPattern");var n="[object RegExp]"===Object.prototype.toString.call(t)?String.prototype.search:String.prototype.indexOf;return-1!==n.call(e,t)},S=function(e){h.log("Request::lookupIframe");for(var t,n=w.length-1;n>=0;n--){if(t=w[n],E(e,t.match))return h.debug("Request::lookupIframe - origin '"+e+"' matched '"+t.match+"'"),e+t.path;h.debug("Request::lookupIframe - origin '"+e+"' did not match '"+t.match+"'")}},k={getIframe:function(e){var t=s.parseUrl(e),n=t.origin,i=S(n);return i},hasIframe:function(e){return!!this.getIframe(e)},accepts:function(e){return s.isCrossDomain(e.url)&&this.hasIframe(e.url)},request:function(t){h.log("Request::XDMTransport.request",t.url);var n=this.getIframe(t.url);if(!n){var i=s.parseUrl(t.url),o=i.origin;throw new Error("Did not find a registered XDM iframe for origin '"+o+"'.")}h.log("Found a registered XDM iframe at '"+n+"'.");var a=d.defer();return e(["easyXDM"],function(e){var i=new e.Rpc({swf:r.EASYXDM_SWF_URL,remote:n},{serializer:l,remote:{request:{}}}),o={url:t.url,method:t.method,headers:t.header||void 0,timeout:t.timeout||void 0,data:t.data},c=function(e){h.log("XDMTransport request success: ",e);try{a.resolve(e.data)}catch(t){a.reject(s.extend(e,{responseText:e.data}))}},u=function(e){h.log("XDMTransport request failure: ",e),"data"in e&&(e=s.extend({responseText:e.data.data,statusText:e.message},e.data)),a.reject(e)};i.request(o,c,u)}),a.promise}},x=[{name:"jsonp",impl:C,exclusive:!0},{name:"ajax",impl:y,exclusive:!0},{name:"flxhr",impl:b},{name:"cors",impl:T},{name:"xdm",impl:k}],I=/\.(js(?:onp?)?|(?:ht|x)ml)$/i,M=function(e){if(e.type)return e.type.toLowerCase();var t=s.parseUrl(e.url),n=I.exec(t.pathname);return n?n[1].toLowerCase():""},R=function(e){for(var t,n=[],i=[].concat(e.transports||e.transport||[]),r=s.isEmpty(i),o=0,a=x.length;a>o&&(t=x[o],!r&&-1===s.indexOf(i,t.name)||!t.impl.accepts(e)||(n.push(t.impl),!t.exclusive));++o);return n},L=function(e){if(!s.isSimpleObject(e))throw new Error("Request.createRequest requires an object parameter.");var t=d.defer();e.method=(e.method||p).toUpperCase(),e.type=M(e),e.data=e.data||null,e.headers=e.headers||{},e.success=e.callback||e.success,e.failure=e.error||e.failure,t.promise.then(e.success,e.failure);var n=R(e),i=null,r=function(e){t.resolve(e)},o=function(e){i=e,a()},a=function(){if(0===n.length)t.reject(i);else{var s=n.shift();try{var a=s.request(e);a.then(r,o)}catch(l){o(l)}}};return a(),t.promise};i.registerXDM=A,i.unregisterXDM=P,i.get=function(e){return e.method=p,L(e)},i.getXML=function(e){return e.type="xml",L(e).then(u.xmlTextToXmlDoc)},i.getJSON=function(e){return e.type="json",L(e).then(u.jsonTextToJsObject)},i.getJSONP=function(e){return e.type="jsonp",L(e)},i.post=function(e){return e.method=g,L(e)},i.registerXDM(/^(http:\/\/[iz]|https:\/\/s)\.cdn\.turner\.com(:\d+)?$/,"/xslo/xslo/test/xdm_iframe"),i.registerXDM(/^https?:\/\/aspen\.turner\.com(:\d+)?$/,"/static/xdm_iframe.html"),i.registerXDM(/^https?:\/\/refwebapp\.aspen\.vgtf\.net(:\d+)?$/,"/static/xdm_iframe.html"),n.exports=i}),define("html5/parsers/generic",["require","exports","module","Class","cvp/customevent","cvp/utils","cvp/request","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("cvp/utils"),o=e("cvp/request"),a=e("cvp/log"),l=a.getLogger(),c=i.extend({init:function(){this.onLoaded=s.bind(this.onLoaded,this),this.onLoadError=s.bind(this.onLoadError,this),this.eParseCompleted=new r,this.eParseError=new r},parse:function(e){l.debug("Parser","Loading the file to parse",e),this.load(e)},load:function(e){this._createRequest(e).then(this.onLoaded,this.onLoadError)},_createRequest:function(e){return o.getXML({url:e})},onLoaded:function(e){l.debug("Parser","Data loaded"),this.parseData(e)},onLoadError:function(e){l.error("Parser","onLoadError:",e),this._fireLoadedFailure()},parseData:function(){},_fireLoadedSuccess:function(){l.debug("Parser","successfully Loaded asset"),this.eParseCompleted.dispatch.apply(this.eParseCompleted,arguments)},_fireLoadedFailure:function(){l.error("Parser","failed to Load asset"),this.eParseError.dispatch.apply(this.eParseError,arguments)}});n.exports=c}),define("html5/parsers/mapping",["require","exports","module","html5/parsers/generic","cvp/utils","cvp/request"],function(e,t,n){var i=e("html5/parsers/generic"),r=e("cvp/utils"),s=e("cvp/request"),o=i.extend({_createRequest:function(e){return s.getJSONP({url:e,jsonpCallback:"cvp_onMappingReceived"})},setMappingProfile:function(e){this.profile=e},parseData:function(e){var t,n,i;if(r.undef(e)||r.undef(e.mappings))return void this.eParseError.dispatch();if(n=e.mappings,r.empty(this.profile))return void this.onLoadError(null,"No mapping profile provided","Invalid mapping profile");for(i in n)n[i].profile===this.profile&&(t=n[i]);return r.empty(t)?void this.onLoadError(null,"No mapping profile '"+this.profile+"' found","Invalid mapping profile"):void this._fireLoadedSuccess(t)}});n.exports=o}),define("html5/parsers/appconfig",["require","exports","module","html5/parsers/generic","cvp/request"],function(e,t,n){var i=e("html5/parsers/generic"),r=e("cvp/request"),s=i.extend({_createRequest:function(e){return r.getJSONP({url:e,jsonpCallback:"cvp_onAppConfigReceived"})},parseData:function(e){var t=e.appConfig;this._fireLoadedSuccess(t)}});n.exports=s}),define("html5/shared/playerconfig",{params:{},mapping:{},appConfig:{},containerInfo:{},configInfo:{html5Order:"",html5Types:"",omniture:{},share:{},embed:{}},adPolicy:{ads:{attr:{type:"NONE"}}},trackingPolicy:{interval:"50%"}}),define("html5/parsers/container",["require","exports","module","html5/parsers/generic","cvp/utils/xml","cvp/utils","html5/shared/playerconfig"],function(e,t,n){function i(e,t){var n=s.getParamValue(e,"adPolicySrc"),i=s.getParamValue(e,"adPolicyContext"),r=s.getParamValue(e,"trackingPolicySrc"),a=s.getParamValue(e,"trackingPolicyContext");o.empty(n)||(t.adPolicySrc=n),o.empty(i)||(t.adPolicyContext=i),o.empty(r)||(t.trackingPolicySrc=r),o.empty(a)||(t.trackingPolicyContext=a)}var r=e("html5/parsers/generic"),s=e("cvp/utils/xml"),o=e("cvp/utils"),a=e("html5/shared/playerconfig"),l=r.extend({setParams:function(e){this._params=e},parseData:function(e){var t=0,n=0,r=e.documentElement,l=this._params.context||"",c=this._params.element||"",u=null,d=null,h=[],p=o.extend({},a.containerInfo),g=r.getElementsByTagName("default");if(g.length&&(h=g[0].getElementsByTagName("policies"),h.length&&i(h[0],p)),p.elementName=c,u=r.getElementsByTagName("context"),u.length){for(n=u.length;n>t;++t)if(s.getAttribute(u[t],"name")===l){d=u[t];break}if(d){var f=d.getElementsByTagName("element"),m=null,_=null;for(t=0,n=f.length;n>t;++t)if(m=f[t],s.getAttribute(m,"id")===c){_=m;break}_||(_=f[0]),c=s.getAttribute(_,"id"),h=_.getElementsByTagName("policies"),h.length&&i(h[0],p);var v=_.getElementsByTagName("player"),y=s.getAttribute(v[v.length-1],"playerInstance");o.empty(y)&&(y=l),p.playerInstance=y}o.empty(c)||(p.elementName=c)}o.print(p,"containerInfo"),this._fireLoadedSuccess(p)}});n.exports=l}),define("html5/parsers/config",["require","exports","module","html5/parsers/generic","cvp/utils/xml","cvp/utils","html5/shared/playerconfig"],function(e,t,n){var i=e("html5/parsers/generic"),r=e("cvp/utils/xml"),s=e("cvp/utils"),o=e("html5/shared/playerconfig"),a=function(e,t,n){switch(t){default:e[t]=n}},l=function(e,t){t.hasAttributes&&(e.attr||(e.attr={}),r.assignAttributes(e.attr,t.attributes))},c=function(e,t){var n=null;switch(t){case"akamai2":e.akamai2={},n=e.akamai2;break;case"akamaiSpe":e.akamaiSpe={},n=e.akamaiSpe;break;case"tokenAuth":e.token={},n=e.token}return n},u=function(e,t){if(!s.isNull(e))for(var n,i,o=e.childNodes,d=0,h=o.length;h>d;++d)i=o[d],n=c(t,i.nodeName),s.isNull(n)?"param"===i.nodeName&&a(t,r.getAttribute(i,"name"),r.getAttribute(i,"value")):(l(n,i),i.childNodes.length&&u(i,n))},d=i.extend({setPlayerInstance:function(e){this.playerInstanceName=e||""},parseData:function(e){var t=s.extend({},o.configInfo),n=e.documentElement,i=n.getElementsByTagName("default");i.length>0&&u(i[0],t);for(var a=null,l=n.getElementsByTagName("player"),c=null;l.length;)c=l[l.length-1],r.getAttribute(c,"name")===this.playerInstanceName&&(a=c.cloneNode(!0)),n.removeChild(c);s.isNull(a)||u(a,t),s.print(t,"configInfo"),this._fireLoadedSuccess(t)}});n.exports=d}),define("html5/dependencies/config",["require","exports","module","cvp/utils/dependency","html5/parsers/config","cvp/utils","cvp/log"],function(e,t,n){var i=e("cvp/utils/dependency"),r=e("html5/parsers/config"),s=e("cvp/utils"),o=e("cvp/log"),a=o.getLogger(),l=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setPlayerInstance(e)},load:function(){this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){this._manager&&(s.empty(e.omniture)||s.empty(e.omniture.omniture_account)||a.info("ContainerDependency","adding Omniture dependency")),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"ConfigDependency: "+this._assetUrl}});n.exports=l}),define("html5/parsers/adpolicy",["require","exports","module","html5/parsers/generic","cvp/utils/xml","cvp/utils","html5/shared/playerconfig"],function(e,t,n){var i=e("html5/parsers/generic"),r=e("cvp/utils/xml"),s=e("cvp/utils"),o=e("html5/shared/playerconfig"),a=function(e,t,n){switch(t){case"adApi":e.apiUrl=n;break;case"adManRootUrl":e.adManRootUrl=n;break;case"adServerRootUrl":e.adServerRootUrl=n;break;case"adVideoRootUrl":e.adVideoRootUrl=n;break;case"adVideoExtension":e.adVideoExtension=n;break;case"additionalVideoSegvars":e.additionalVideoSegVars=n;break;case"additionalSyncSegvars":e.additionalSyncSegVars=n;
break;case"adSection":e.adSection=n;break;case"adNetworkId":e.adNetworkId=n;break;case"adVideoNetworkId":e.adVideoNetworkId=n;break;case"adVideoAssetId":e.adVideoAssetId=n;break;case"adPlayerProfile":e.adPlayerProfile=n;break;case"renderersUrl":e.renderersUrl=n;break;case"externalSlots":e.externalSlots=s.isFlagActive(n,e.externalSlots);break;case"adLiveContentDuration":e.liveDuration=n;break;default:e[t]=n}},l=function(e,t){t.hasAttributes&&(e.attr||(e.attr={}),r.assignAttributes(e.attr,t.attributes))},c=function(e,t){var n=null;switch(t){case"adServer":n=e.ads}return n},u=function(e,t){if(!s.isNull(e))for(var n,i,o=e.childNodes,d=0,h=o.length;h>d;++d)i=o[d],n=c(t,i.nodeName),s.isNull(n)?"param"===i.nodeName&&a(t,r.getAttribute(i,"name"),r.getAttribute(i,"value")):(l(n,i),i.childNodes.length&&u(i,n))},d=i.extend({setAdPolicyContext:function(e){this.adPolicyContextName=e||""},parseData:function(e){var t=s.extend({},o.adPolicy),n=e.documentElement,i=n.getElementsByTagName("default");0!==i.length&&u(i[0],t);for(var a=null,l=n.getElementsByTagName("context"),c=0,d=l.length;d>c;++c)if(r.getAttribute(l[c],"name")===this.adPolicyContextName){a=l[c];break}s.isNull(a)||u(a,t),s.print(t,"adPolicy"),this._fireLoadedSuccess(t)}});n.exports=d}),define("html5/dependencies/adpolicy",["require","exports","module","cvp/utils/dependency","html5/parsers/adpolicy","cvp/log","core/app"],function(e,t,n){var i=e("cvp/utils/dependency"),r=e("html5/parsers/adpolicy"),s=e("cvp/log"),o=s.getLogger(),a=e("core/app"),l=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setAdPolicyContext(e)},load:function(){o.info("AdPolicyDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){var t=e.ads.attr.type.toLowerCase();"freewheel"===t?(o.info("AdPolicyDependency","adding FW dependency"),this._manager.addDependency(new i(a.AD_MANAGER_URL,!0))):"dfp"===t&&(o.info("AdPolicyDependency","adding DFP dependency"),this._manager.addDependency(new i(a.AD_DFP_URL,!0))),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"AdPolicyDependency: "+this._assetUrl}});n.exports=l}),define("html5/parsers/TrackingPolicy",["require","exports","module","html5/parsers/generic","cvp/utils/xml","cvp/utils","html5/shared/playerconfig"],function(e,t,n){var i=e("html5/parsers/generic"),r=e("cvp/utils/xml"),s=e("cvp/utils"),o=e("html5/shared/playerconfig"),a=function(e,t,n){switch(t){case"interval":e.interval=n}},l=function(e,t){if(!s.isNull(e))for(var n,i=r.getChildElements(e),o=0,l=i.length;l>o;++o)n=i[o],"param"===n.nodeName&&a(t,r.getAttribute(n,"name"),r.getAttribute(n,"value"))},c=i.extend({setTrackingPolicyContext:function(e){this.trackingPolicyContextName=e||""},parseData:function(e){var t=s.extend({},o.trackingPolicy),n=e.documentElement,i=n.getElementsByTagName("default");i.length&&l(i[0],t);for(var a,c=null,u=n.getElementsByTagName("context"),d=0,h=u.length;h>d;++d)if(a=u[d],r.getAttribute(a,"name")===this.trackingPolicyContextName){c=a;break}c&&l(c,t),s.print(t,"trackingPolicy"),this._fireLoadedSuccess(t)}});n.exports=c}),define("html5/dependencies/trackingpolicy",["require","exports","module","cvp/utils/dependency","html5/parsers/TrackingPolicy","cvp/log"],function(e,t,n){var i=e("cvp/utils/dependency"),r=e("html5/parsers/TrackingPolicy"),s=e("cvp/log"),o=s.getLogger(),a=i.extend({init:function(){this._super.apply(this,arguments),this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setTrackingPolicyContext(e)},load:function(){o.info("TrackingPolicyDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"TrackingPolicyDependency: "+this._assetUrl}});n.exports=a}),define("html5/dependencies/container",["require","exports","module","cvp/utils/dependency","html5/parsers/container","html5/dependencies/config","html5/dependencies/adpolicy","html5/dependencies/trackingpolicy","cvp/utils","cvp/log"],function(e,t,n){var i=e("cvp/utils/dependency"),r=e("html5/parsers/container"),s=e("html5/dependencies/config"),o=e("html5/dependencies/adpolicy"),a=e("html5/dependencies/trackingpolicy"),l=e("cvp/utils"),c=e("cvp/log"),u=c.getLogger(),d=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setConfigUrl:function(e){this.configUrl=e},passParams:function(e){this._parser.setParams(e)},load:function(){u.info("ContainerDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){var t=new s(this.configUrl,!0);if(t.setContext(e.playerInstance),this._manager.addDependency(t),!l.empty(e.adPolicySrc)){var n=new o(e.adPolicySrc,!0);n.setContext(e.adPolicyContext),this._manager.addDependency(n)}if(!l.empty(e.trackingPolicySrc)){var i=new a(e.trackingPolicySrc,!1);i.setContext(e.trackingPolicyContext),this._manager.addDependency(i)}this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"ContainerDependency: "+this._assetUrl}});n.exports=d}),define("html5/dependencies/appconfig",["require","exports","module","cvp/utils/dependency","html5/parsers/appconfig","html5/dependencies/container","cvp/utils","cvp/log"],function(e,t,n){var i=e("cvp/utils/dependency"),r=e("html5/parsers/appconfig"),s=e("html5/dependencies/container"),o=e("cvp/utils"),a=e("cvp/log"),l=a.getLogger(),c=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},load:function(){l.info("AppConfigDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){if(!e||o.empty(e.containerUrl)||o.empty(e.configUrl))return l.error("Unable to retrieve the appConfig file."),void this._failure();var t=new s(e.containerUrl,!0);t.setConfigUrl(e.configUrl),t.passParams(this._manager.getParams()),this._manager.addDependency(t),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"AppConfigDependency: "+this._assetUrl}});n.exports=c}),define("html5/dependencies/mapping",["require","exports","module","cvp/utils/dependency","html5/parsers/mapping","html5/dependencies/appconfig","cvp/utils","cvp/log"],function(e,t,n){var i=e("cvp/utils/dependency"),r=e("html5/parsers/mapping"),s=e("html5/dependencies/appconfig"),o=e("cvp/utils"),a=e("cvp/log"),l=a.getLogger(),c=i.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new r,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setMappingProfile(e)},load:function(){l.info("MappingDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){if(!e||o.empty(e.url))return l.error("Unable to retrieve the mapping file."),void this._failure();var t=o.replaceExtension(e.url,"xml","json");this._manager.addDependency(new s(t,!0)),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"MappingDependency: "+this._assetUrl}});n.exports=c}),define("html5/bootstrapper",["require","exports","module","Class","cvp/customevent","cvp/utils/dependencymanager","html5/dependencies/mapping","html5/dependencies/appconfig","html5/dependencies/container","html5/dependencies/config","html5/dependencies/adpolicy","html5/dependencies/trackingpolicy","cvp/utils","html5/shared/playerconfig"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("cvp/utils/dependencymanager"),o=e("html5/dependencies/mapping"),a=e("html5/dependencies/appconfig"),l=e("html5/dependencies/container"),c=e("html5/dependencies/config"),u=e("html5/dependencies/adpolicy"),d=e("html5/dependencies/trackingpolicy"),h=e("cvp/utils"),p=e("html5/shared/playerconfig"),g=s.extend({setBootstrapper:function(e){this._bootstrap=e},clearBootstrapper:function(){this._bootstrap=null},setParams:function(e){this._params=e},getParams:function(){return this._params}}),f=i.extend({init:function(e,t){this._mappingUrl=e,this._params=t||{},this.eSuccess=new r,this.eFailure=new r},load:function(){this._bootManager=new g,this._bootManager.setBootstrapper(this),this._bootManager.setParams(this._params);var e=new o(this._mappingUrl,!0);e.setContext(this._params.profile),this._bootManager.addDependency(e),this._bootManager.eDependencySuccess.addListener(this._onDependencySuccess,this),this._bootManager.eSuccess.addListener(this._success,this),this._bootManager.eFailure.addListener(this._failure,this),this._bootManager.load()},_onDependencySuccess:function(e,t){e instanceof o?this._mapping=t:e instanceof a?this._appConfig=t:e instanceof l?this._containerInfo=t:e instanceof c?this._configInfo=t:e instanceof u?this._adPolicy=t:e instanceof d&&(this._trackingPolicy=t)},_success:function(){var e={};e.data={},e.data.mapping=h.extend({},p.mapping,this._mapping),e.data.appConfig=h.extend({},p.appConfig,this._appConfig),e.data.containerInfo=h.extend({},p.containerInfo,this._containerInfo),e.data.configInfo=h.extend({},p.configInfo,this._configInfo),e.data.adPolicy=h.extend({},p.adPolicy,this._adPolicy),e.data.trackingPolicy=h.extend({},p.trackingPolicy,this._trackingPolicy),this.eSuccess.dispatch(e),this._complete()},_failure:function(){this.eFailure.dispatch(),this._complete()},_complete:function(){this._bootManager&&(this._bootManager.eDependencySuccess.removeListener(this._onDependencySuccess,this),this._bootManager.eSuccess.removeListener(this._success,this),this._bootManager.eFailure.removeListener(this._failure,this),this._bootManager.clearBootstrapper(),this._bootManager=null)}});n.exports=f}),define("aspen/log",["require","exports","module","cvp/log"],function(e,t,n){var i=e("cvp/log"),r=i.getLogger("Aspen");n.exports=r}),define("aspen/aspencomm",["require","exports","module","aspen/log","cvp/request","cvp/utils","cvp/convert"],function(e,t){var n=e("aspen/log"),i=e("cvp/request"),r=e("cvp/utils"),s=e("cvp/convert"),o=500,a=3,l=!1,c=[],u=function(){n.log("AspenComm::init"),l=!0,u=function(){throw new Error("already init'ed - ignored")},g()},d=function(e,t,n){l?f(e,t,n):h(e,t,n)},h=function(){c.push(arguments)},p=function(e){return c.length>o&&c.splice(0,o-c.length),r.isArray(e)&&e.length?c.unshift.apply(c,e):c.push(e)},g=function(){for(var e=c.splice(0,c.length),t=null;null!=(t=e.shift());)f.apply(null,t).otherwise(r.bind(p,null,t))},f=function(e,t,r){n.log("AspenComm::makeRequest",e);var o=function(e){n.log("AspenComm::makeRequest","request success",e);var i=s.jsonTextToJsObject(e);t(i)},l=function(t){n.debug("AspenComm::makeRequest","request failure",t),e._retries>a?r(e.url):(e._retries+=1,p(arguments))};e._retries="_retries"in e?e._retries+1:0;var c=new i(e);return c.then(o,l),c};t.init=u,t.request=d}),define("aspen/transportmanager",["require","exports","module","aspen/aspencomm","cvp/utils","cvp/request","JSON","aspen/log"],function(e,t,n){var i=e("aspen/aspencomm"),r=e("cvp/utils"),s=e("cvp/request"),o=e("JSON"),a=e("aspen/log"),l={Format:{JSON:"json",JSONP:"jsonp"},getDefaultFormats:function(){return[l.Format.JSONP]},init:function(e){this._config=e,this._transportFormat=this._config.transportFormats.shift(),this._bootstrapped=!1},bootstrapTM:function(){if(a.log("TransportManager::bootstrapTM","_bootstrapped:",this._bootstrapped),this._transportFormat===l.Format.JSON&&!this._bootstrapped){var e=this._config.servicesUrl;i.init(e),this._bootstrapped=!0,a.log("TransportManager::bootstrapTM","transportFormat:",this._transportFormat)}},createRequest:function(e,t,n,c,u){a.log("TransportManager::createRequest");var d=this._config.servicesUrl+e+"."+this._transportFormat,h=r.bind(n,u),p=r.bind(c,u);switch(this._transportFormat){case l.Format.JSON:i.request({url:d,method:-1!==e.indexOf("postEvent")?"POST":"GET",data:{aspenJson:o.stringify(t)}},h,p);break;case l.Format.JSONP:d=r.augmentQueryString(d,{aspenJson:t}),s.getJSONP({jsonpCallback:"parseCVPServicesInitialization",url:d,success:h,failure:p})}},fallback:function(){return a.debug("TransportManager::fallback","current transport format failed",this._transportFormat),this._transportFormat=this._config.transportFormats.shift(),this._transportFormat?(a.debug("TransportManager::fallback","trying next transport format",this._transportFormat),!0):!1}};n.exports=l}),define("aspen/batchservice",["require","exports","module","Class","cvp/utils","cvp/shared","JSON","aspen/log","aspen/transportmanager"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/shared"),o=e("JSON"),a=e("aspen/log"),l=e("aspen/transportmanager"),c="total",u="timer",d="none",h=i.extend({init:function(e){this._enabled=!1,this._queue=[],this._postThrottled=!0,this._aspen=e||window.Aspen,this._timer=null,this._postTimerEvent=r.bind(this._postTimerEvent,this),this._firstPostTimerEvent=r.bind(this._firstPostTimerEvent,this),this.dispose=r.bind(this.dispose,this),s.addBeforeUnLoadEvent(this.dispose)},dispose:function(){this.disableTimer(),this.post()},start:function(){var e=this._aspen.getConfig("batchApi");if(e&&(this._enabled=!0,this._aspen.getConfig("batchMode")===u)){var t=r.toInt(this._aspen.getConfig("batchModeAmount")),n=Math.ceil(Math.random()*t);n===t&&(n-=1,0>=n&&(n=.5)),a.log("BatchService::start","random time: "+n),setTimeout(this._firstPostTimerEvent,1e3*n)}},add:function(e){if(!this._aspen.getConfig("enabled"))return void a.debug("BatchService::add","Aspen is disabled via aspenanalytics config. Message not added.");if(a.debug("BatchService::add","Adding message to batch queue."),this._queue.push(e),!this._enabled)return void a.debug("BatchService::add","Batch service not enabled. Queuing message.");var t=this._aspen.getConfig("batchMode"),n=this._aspen.getConfig("batchModeAmount");t===u&&null===this._timer?(a.debug("BatchService::add","Starting timer on message-add."),this._timer=setTimeout(this._postTimerEvent,1e3*n)):t===c?this._queue.length>=n&&this.post():t===d?this.post():t!==u&&this.post(),r.empty(this._queue)||("error"===e.eventType?this.flushByError(e.eventData):"error"===e.eventType||r.undef(this._aspen.getConfig("highPriorityEvents"))||this.flushByEvent(e.eventType))},post:function(){if(this._postThrottled)return void a.debug("BatchService::post","Batch posting is throttled. Batch not posted.");if(!this._enabled)return void a.debug("BatchService::post","Batch posting is not enabled.");var e={sessionId:this._sessionId,events:this._queue};if(a.debug("BatchService::post","send batch string"),"gzip"===this._aspen.getConfig("batchContentEncoding")){var t="?aspenJson="+o.stringify(e),n=encodeURIComponent(t).replace(/%20/g,"+"),i=n;e=i}l.createRequest(this._aspen.getConfig("batchApi"),e,this._postSuccess,this._postFailure,this),this._queue.length=0},_postTimerEvent:function(){r.empty(this._queue)?(a.log("BatchService::_postTimerEvent","no messages to post"),this._timer=null):(a.log("BatchService::_postTimerEvent","queue.length: "+this._queue.length),this.post(),this._timer=setTimeout(this._postTimerEvent,1e3*this._aspen.getConfig("batchModeAmount")))},_firstPostTimerEvent:function(){r.empty(this._queue)?a.log("BatchService::_firstPostTimerEvent","no messages to post"):(a.log("BatchService::_firstPostTimerEvent","queue.length: "+this._queue.length),this.post())},_postSuccess:function(e){a.log("BatchService::_postSuccess",e)},_postFailure:function(e){a.log("BatchService::_postFailure",e)},flushByError:function(e){var t=this._aspen.getConfig("highPriorityErrors");if(r.isString(e.errorCode)&&r.isString(t)){for(var n=e.errorCode,i=n.substring(0,2),s=n.substring(2,4),o=n.substring(4,6),l=n.substring(6),c=t.split(/[, ]+/),u="",d="",h="",p="",g=[],f=[],m=[],_=[],v=0,y=c.length;y>v;++v)switch(v){case 0:u=c[v],g=u.split("+");break;case 1:d=c[v],f=d.split("+");break;case 2:h=c[v],m=h.split("+");break;case 3:p=c[v],_=p.split("+")}for(v=0,y=g.length;y>v;++v){var C=g[v];if(i===C||"*"===C)for(var b=0,T=f.length;T>b;++b){var w=f[b];if(s===w||"*"===w)for(var A=0,P=m.length;P>A;++A){var E=m[A];if(o===E||"*"===E)for(var S=0,k=_.length;k>S;++S){var x=_[S];(l===x||"*"===x)&&(a.debug("BatchService::flushByError","found match, flushing batch"),this.post())}}}}}},flushByEvent:function(e){var t=this._aspen.getConfig("highPriorityEvents");if(r.isString(t))for(var n=t.split(/[, ]+/),i=0,s=n.length;s>i;++i){var o=n[i];o===e&&(a.debug("BatchService::flushByEvent","found match, flushing batch"),this.post())}},setSessionId:function(e){this._sessionId=e},setPostThrottled:function(e){this._postThrottled=e},disableTimer:function(){this._aspen.getConfig("batchMode")===u&&clearTimeout(this._timer)}});n.exports=h}),define("aspen/configfile",["require","exports","module","cvp/utils/dependency","aspen/log","cvp/utils","cvp/request"],function(e,t,n){var i=e("cvp/utils/dependency"),r=e("aspen/log"),s=e("cvp/utils"),o=e("cvp/request"),a=i.extend({init:function(e){var t=e.basePath||".";r.log("Using config base path: "+t);var n=t+"/aspenanalytics.json?_="+s.now();r.log("config url: ",n),this._super(n,!1)},load:function(){o.getJSONP({jsonpCallback:"cvp_onAnalyticsConfigReceived",url:this._assetUrl,success:s.bind(this._loadConfigSuccess,this),error:s.bind(this._loadConfigFailure,this)})},_loadConfigSuccess:function(e){r.log("Config loaded successfully"),this._success(e,this._assetUrl)},_loadConfigFailure:function(e){r.log("Config failed to load",e),this._failure(e)},getDesc:function(){return"Aspen ConfigDependency: "+this._assetUrl}});n.exports=a}),define("aspen/sessionid",["require","exports","module","aspen/log"],function(e,t,n){var i,r=e("aspen/log");n.exports={set:function(e){return i?void r.debug("sessionId is already '"+i+"'; will NOT set to '"+e+"'"):(r.debug("setting sessionId to '"+e+"'"),void(i=e))},get:function(){return r.debug("retreiving ID '"+i+"'"),i}}}),define("aspen/sessiontoken",["require","exports","module","cvp/utils","aspen/log"],function(e,t,n){var i=e("cvp/utils"),r=e("aspen/log"),s=i.getQueryParam("sessionToken");n.exports={create:function(){return i.randomString(25)},read:function(){return s||(r.debug("sessionToken does not exist; creating anew"),s=this.create()),r.debug("retreiving sessionToken '"+s+"'"),s}}}),define("aspen/core",["require","exports","module","core/app","cvp/utils","cvp/customevent","cvp/events","cvp/browser","JSON","aspen/log","aspen/batchservice","aspen/configfile","aspen/transportmanager","aspen/sessionid","aspen/sessiontoken"],function(e,t,n){var i=e("core/app"),r=e("cvp/utils"),s=e("cvp/customevent"),o=e("cvp/events"),a=e("cvp/browser"),l=e("JSON"),c=e("aspen/log"),u=e("aspen/batchservice"),d=e("aspen/configfile"),h=e("aspen/transportmanager"),p=e("aspen/sessionid"),g=e("aspen/sessiontoken"),f=i.CDN_ORIGIN+"/xslo/cvp/config/",m={WAITING:"loadStateWaiting",LOADING:"loadStateLoading",READY:"loadStateReady",FAILED:"loadStateFailed"},_=function(e){var t=!0,n={applicationName:"cvp",applicationVersion:i.VERSION,context:"default",deviceModel:"desktop",deviceType:"desktop",deviceVersion:"desktop",platformName:"javascript",platformVersion:a.version?String(a.version):void 0};return"object"==typeof e&&("aspenAppSignature"in e&&(n=r.extend({},n,e.aspenAppSignature)),"useSharedSessionToken"in e&&(t=!!e.useSharedSessionToken)),{initialized:!1,ready:!1,config:{throttled:!0,timeDifference:0,progressReportInterval:37,adProgressReportInterval:17},batchService:null,sessionObject:{},serviceUrlRoot:"",_retryTimer:null,_retries:0,_retriesMade:0,_retryTime:0,_savedSession:{},_messageQueue:[],_loadState:m.WAITING,eInitSuccess:new s("AspenInitSuccess"),eInitFailure:new s("AspenInitFailure"),init:function(e){var t=this;return this.initialized?void c.warn("Aspen is already set up!"):(this._helloRetry=r.bind(this._helloRetry,this),this.initialized=!0,this._options=e||{},this._options.site=this._options.site||i._cvpsetup&&i._cvpsetup.site||"cvp",r.empty(this._options.site)?void c.error("Unable to start Aspen, no site provided"):(this.batchService=new u(this),this._loadState=m.LOADING,void o.onReady(function(){var e=t._options.configBaseUrl||f+t._options.site,n=t._dependency=new d({basePath:!t._options.dt&&e});n.eSuccess.addListener(t._onConfigLoaded,t),n.eFailure.addListener(t._onConfigLoadFailure,t),n.load()})))},_freeDependency:function(){this._dependency&&(this._dependency.eSuccess.removeListener(this._onConfigLoaded,this),this._dependency.eFailure.removeListener(this._onConfigLoadFailure,this),this._dependency=null)},dispose:function(){this._freeDependency(),clearTimeout(this._retryTimer),this.batchService.dispose(),this.batchService=null},_setupConfig:function(e,t){var n=r.extend({},e["default"],"context"in this._options?e[this._options.context]:null);n.enabled="true"===n.enabled&&!r.empty(n.servicesUrl),n.batchMode=n.batchMode||"total",n.batchModeAmount=n.batchModeAmount&&Number(n.batchModeAmount)||10,n.helloRetryCount=isNaN(n.helloRetryCount=Number(n.helloRetryCount))?5:n.helloRetryCount,n.helloRetryTime=n.helloRetryTime&&Number(n.helloRetryTime)||1e4,n.batchContentEncoding=n.batchContentEncoding||"json",n.transportFormats=n.transportFormats&&n.transportFormats.split(/[, ]+/)||h.getDefaultFormats(),n.propertyName=n.propertyName||this._options.site,r.print(n,"Aspen config"),this.config=n,this.configSourceUrl=t,this.send(this.config,"aspenConfigDetails")},getConfig:function(e){return e in this.config?this.config[e]:void 0},_onConfigLoaded:function(e,t){this._freeDependency(),this._setupConfig(e,t),this._loadState=m.READY,c.log("_onConfigLoaded - config successfully loaded"),this.config.enabled?(c.log("analytics enabled via config"),h.init({transportFormats:this.config.transportFormats,servicesUrl:this.config.servicesUrl}),this.serviceUrlRoot=this.config.servicesUrl,this._hello()):(c.log("analytics disabled via config"),this._initFailure())},_onConfigLoadFailure:function(e){this._freeDependency(),this._loadState=m.FAILED,c.log("_onConfigLoadFailure - failed to load "+e)},_hello:function(){c.log("hello");var e=p.get(),i=t?g.read():g.create(),s=r.extend({},n,{aspenConfigUrl:this.configSourceUrl,propertyName:this.config.propertyName,pageUrl:document.URL,context:this._options.context,debug:this._options.dt?"true":"false",sessionId:e,sessionToken:i,protocol:"1.0"});h.bootstrapTM(),h.createRequest(this.config.helloApi,s,this._helloSuccess,this._helloFailure,this),this._retryTimer=setTimeout(this._helloRetry,this.config.helloRetryTime),this._isRetrying=!0},_helloSuccess:function(e){c.log("_helloSuccess"),clearTimeout(this._retryTimer),this.config.throttled=r.isString(e.throttled)?"no"!==e.throttled:this.config.throttled,this.config.sessionId=e.sessionId,this.config.timeDifference=e.timestamp?e.timestamp-r.now():this.config.timeDifference,this.config.progressReportInterval=e.progressReportInterval||this.config.progressReportInterval,this.config.adProgressReportInterval=e.adProgressReportInterval||this.config.adProgressReportInterval,c.debug("throttled: "+e.throttled+" => "+this.config.throttled),c.debug("sessionId: "+e.sessionId),c.debug("timeDifference: "+this.config.timeDifference),c.debug("progressReportInterval: "+this.config.progressReportInterval),c.debug("adProgressReportInterval: "+this.config.adProgressReportInterval),e.sessionId&&p.set(e.sessionId),this.batchService.setSessionId(p.get()),this.batchService.setPostThrottled(this.config.throttled),this.batchService.start();var t=r.getQueryParam("sessionToken");t&&this.send({},"authSessionReload"),this._initSuccess()},_helloFailure:function(e){c.log("_helloFailure url: "+e),h.fallback()&&this._hello()},_helloRetry:function(){c.log("helloRetry"),this._retries===this.config.helloRetryCount?(c.log("retries exhasted"),clearTimeout(this._retryTimer),this._retries=0,h.fallback()?this._hello():(c.debug("retries exhasted, fallbacks exhausted, aspen is disabled"),this.config.throttled=!0,this.batchService.setBatchThrottled(!0),this.batchService.setPostThrottled(!0),this.batchService.disableTimer())):(this._retries+=1,this._retryTime=this._retries*this.config.helloRetryTime,this._savedSession.retries=this._retries,this._savedSession.retryTime=this._retryTime,this._hello())},isMessageExcluded:function(e){return r.isString(this.config.messageExcludes)&&-1!==this.config.messageExcludes.indexOf(e)},send:function(e,t){return this.disabled?void c.debug("send - Aspen is disabled, message was not sent"):(e.timestamp=(e.timestamp||r.now())+this.config.timeDifference,this.ready?this.config.throttled?void c.debug("Add message to batch is throttled! Message not added."):this.isMessageExcluded(t)?void c.debug("message excluded by config, not added to batch",t):void this._send(e,t):(c.debug("send - Aspen's not ready, queuing message"),void this._messageQueue.push({message:e,type:t})))},_send:function(e,t){switch(t){case"appConfig":e=r.extend({},n,e),e.aspenConfigUrl=this.configSourceUrl}"applicationName"in n&&!("applicationName"in e)&&(e.applicationName=n.applicationName);var i={};i.eventType=t,i.eventData=e,c.log("add to batch json message: "+l.stringify(i)),this.batchService.add(i)},_initSuccess:function(){c.log("Successful init"),this.ready=!0;for(var e=0,t=this._messageQueue.length;t>e;++e)this.send(this._messageQueue[e].message,this._messageQueue[e].type);this._messageQueue.length=0,this.send({screenWidth:screen.width,screenHeight:screen.height,browserName:navigator.appName,userAgent:navigator.userAgent,platform:navigator.platform},"systemInfo"),this._initSuccess=function(){},this.eInitSuccess.dispatch()},_initFailure:function(){c.log("Failed init"),this.disabled=!0,this.eInitFailure.dispatch()}}};n.exports=_}),define("aspen/aspen",["require","exports","module","aspen/core","aspen/sessiontoken"],function(e,t,n){var i=e("aspen/core"),r=e("aspen/sessiontoken"),s=i();s.createInstance=i,s.getSessionToken=function(){return r.read()},n.exports=s}),define("html5/aspencontroller",["require","exports","module","aspen/aspen","cvp/customevent","cvp/log"],function(e,t,n){function i(e,t){p("AspenController - send",arguments),l.send(t,e)}function r(){p("AspenController - setup"),l.eInitSuccess.removeListener(r,this),h=!0,p("AspenController - setup","dispatching init success event"),this.eInitSuccess.dispatch()}function s(e){p("AspenController - init",arguments),d||(d=!0,l.eInitSuccess.addListener(r,this),l.init(e))}function o(){return h}function a(e){if(!d)throw new Error("AspenController - getConfig cannot be called until after AspenController has successfully inited!");if(!h)throw new Error("AspenController - getConfig cannot be called until after Aspen has successfully inited!");return p("AspenController - getConfig",e),l.getConfig(e)}var l=e("aspen/aspen"),c=e("cvp/customevent"),u=e("cvp/log"),d=!1,h=!1,p=u.getLogger().log;n.exports={videoCount:0,eInitSuccess:new c,isReady:o,getConfig:a,send:i,init:s}}),define("html5/contententry",["require","exports","module","Class","cvp/utils","cvp/utils/xml","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/utils/xml"),o=e("cvp/log"),a=o.getLogger(),l=["flv"],c=i.extend({init:function(e){var t,n,i,o,c,u,d,h,p,g,f,m,_,v,y,C,b,T,w,A;if(this._xmlEntry=e.documentElement,this._requestId=null,this._mediaUrl="",this._name=s.getNodeValue(this._xmlEntry,"slug"),this._title=s.getNodeValue(this._xmlEntry,"headline"),this._category=s.getNodeValue(this._xmlEntry,"category"),this._trt=+s.getNodeValue(this._xmlEntry,"trt"),t=this._xmlEntry.getElementsByTagName("files"),t.length){for(t=s.getChildElements(t[0]),this._fileList={},u=0,d=t.length;d>u;++u)if(n=t[u],"file"===n.nodeName)if(i=s.getAttribute(n,"key")||s.getAttribute(n,"bitrate"),o=s.getAttribute(n,"fallback"),c=s.getNodeValue(n))if(h="",A=r.parseUrl(this.sanitizeUrl(c)),A&&(y=A.file.lastIndexOf("."),-1!==y&&(h=A.file.substring(y+1))),a.debug("ContentCatalogEntry",i,c,h),-1===r.indexOf(l,h)){if(i in this._fileList){var P=this._fileList[i].url;a.warn("The file key/bitrate '"+i+"' already exists with URL '"+P+"' and is now being overwritten with "+(P===c?"the same URL":"URL '"+c+"'")+".")}this._fileList[i]={url:c,fallback:o,ext:h}}else a.info("Ignoring "+c+" because extention '"+h+"' is unsupported.");else a.info("Ignoring file key/bitrate '"+i+"' because it has no text() -- no URL!")}else a.warn("ContentCatalogEntry","No file entries found!");if(p=this._xmlEntry.getElementsByTagName("images"),p.length)for(p=s.getChildElements(p[0]),this._imageList={},u=0,d=p.length;d>u;++u)g=p[u],f=s.getAttribute(g,"width"),m=s.getAttribute(g,"height"),v=s.getNodeValue(g),a.debug("ContentCatalogEntry","images",f,m,v),_=f+"|"+m,this._imageList[_]={url:v,width:f,height:m};if(C=this._xmlEntry.getElementsByTagName("ads"),C.length)for(C=s.getChildElements(C[0]),this._adList={},u=0,d=C.length;d>u;++u)b=C[u],T=s.getAttribute(b,"type"),w=s.getNodeValue(b),a.debug("ContentCatalogEntry","ad",T,w),this._adList[T]={url:w}},hasFiles:function(){return!r.empty(this._fileList)},setMediaUrl:function(e){this._mediaUrl=e},getMediaUrl:function(){return this._mediaUrl},getId:function(){var e=s.getAttribute(this._xmlEntry,"id");return r.empty(e)?this._requestId:e},getName:function(){return this._name},getTitle:function(){return this._title},getCategory:function(){return this._category},getTrt:function(){return this._trt},isExpired:function(){var e=s.getNodeValue(this._xmlEntry,"isExpired");return r.isFlagActive(e,!1)},isAdSensitive:function(){var e=s.getNodeValue(this._xmlEntry,"isAdSensitive");return r.isFlagActive(e,!1)},getSource:function(){var e=s.getAttribute(this._xmlEntry,"source");return e||void 0},getOriginId:function(){var e=s.getAttribute(this._xmlEntry,"originId");return e||void 0},getMode:function(){var e=s.getAttribute(this._xmlEntry,"isLive");return r.empty(e)?"vod":"live"},isLive:function(){return"live"===this.getMode()},sanitizeUrl:function(e){return e?(r.isRelative(e)&&(e=this._mediaUrl+e),this.token&&r.augmentQueryString(e,{hdnea:this.token}),e):e},getAllFiles:function(){var e={};return r.each(this._fileList,function(t,n){e[t]=r.extend({},n)}),e},getContentUrl:function(e){var t,n=null,i=!1;for(t in this._fileList)if(t===e){n=this.sanitizeUrl(this._fileList[t].url),i=!0;break}return i?r.empty(n)&&a.warn("text attribute is empty in the video XML for the <file> node whose quality is '"+e+"'."):a.warn("Config XML specifies a '"+e+"' bitrate entry, but there is no <file> node in video XML where bitrate attribute is '"+e+"'."),n},getContentUrlsForExtension:function(e){var t=[];
return r.each(this._fileList,function(n,i){i.ext===e&&t.push(this.sanitizeUrl(i.url))},this),t},getContentUrlsByExtensions:function(e){var t=[];return r.each(e,function(e){var n=this.getContentUrlsForExtension(e);t.push.apply(t,n)},this),t},getContentUrlsByFileKeys:function(e){return r.map(e,this.getContentUrl,this)},getContentUrlFromFallback:function(e){var t=null,n=null,i="";for(i in this._fileList)if(n=this._fileList[i],!r.empty(n.fallback)&&e===n.fallback){t=this.sanitizeUrl(n.url);break}return t},getContentUrlFromType:function(e){var t,n=null,i=null;for(t in this._fileList)if(i=this._fileList[t],e===i.ext){n=this.sanitizeUrl(i.url);break}return n},getThumbnailUrl:function(e,t){var n,i=null,r=e+"|"+t;for(n in this._imageList)if(n===r){i=this._imageList[n].url;break}return i},getImageForDimensions:function(e,t){function n(n){var r={};return r.url=n.url,r.width=Number(n.width)||1,r.height=Number(n.height)||1,r.ratio=r.width/r.height,r.absDeltaWidth=Math.abs(e-r.width),r.absDeltaHeight=Math.abs(t-r.height),r.absDeltaRatio=Math.abs(i-r.ratio),r}if(a.log("getImageForDimensions",e,t),r.isEmpty(this._imageList))return a.log("getImageForDimensions","No images!"),null;var i=e/t,s=Number(window.devicePixelRatio)||1;s>1&&(e=Math.round(s*e),t=Math.round(s*t),a.log("getImageForDimensions","Searching for higher-resolution ("+e+"x"+t+") image ..."));var o=this.getThumbnailUrl(e,t);if(o)return a.log("getImageForDimensions","Found exact match!"),o;var l=[];if(r.each(this._imageList,function(e,t){l.push(n(t))}),l.length<2)return l[0].url;var c=l.sort(this._compareAbsDeltaWidth),u=c[0];a.debug("getImageForDimensions","closest by width",u);var d=c.sort(this._compareAbsDeltaHeight),h=d[0];a.debug("getImageForDimensions","closest by height",h);var p;if(u===h)a.debug("getImageForDimensions","found an obvious winner (closest by width AND height)"),p=u;else{var g=[u,h].sort(this._compareAbsDeltaRatio);a.debug("getImageForDimensions","comparing closest-by-width and closest-by-height to find the closest in aspect ratio",u,h),p=g[0]}return a.debug("getImageForDimensions","winner",p),p.url},_compareAbsDeltaWidth:function(e,t){return e.absDeltaWidth-t.absDeltaWidth},_compareAbsDeltaHeight:function(e,t){return e.absDeltaHeight-t.absDeltaHeight},_compareAbsDeltaRatio:function(e,t){return e.absDeltaRatio-t.absDeltaRatio},getAdUrl:function(e){return this._adList&&this._adList[e]&&this._adList[e].url||null},getXML:function(){return this._xmlEntry}});n.exports=c}),define("html5/fakecontententry",["require","exports","module","html5/contententry","cvp/utils","cvp/utils/xml"],function(e,t,n){var i=e("html5/contententry"),r=e("cvp/utils"),s=e("cvp/utils/xml"),o=i.extend({init:function(e){var t=null,n="",i=e.id||e.url;if(r.isString(e.url)&&(t=e.url),r.isObject(e.metadata))for(var o in e.metadata)"files"===o&&t||(n+="<"+o+">"+e.metadata[o]+"</"+o+">");t&&(n+="<files><file>"+t+"</file></files>");var a="<video id='"+i+"'> "+n+"</video>",l=s.stringToDoc(a);this._super(l)}});n.exports=o}),define("html5/expiredcontententry",["require","exports","module","html5/contententry","core/app","cvp/utils/xml"],function(e,t,n){var i=e("html5/contententry"),r=e("core/app"),s=e("cvp/utils/xml"),o=i.extend({init:function(){var e='<video id="not_avail"><headline>The requested video is not available.</headline><description></description><isExpired>true</isExpired><isAdSensitive>true</isAdSensitive><trt>0</trt><files><file>'+r.EXPIRED_MP4_URL+'</file></files><images><image width="320" height="240">'+r.EXPIRED_IMG_URL+"</image></images></video>",t=s.stringToDoc(e);this._super(t)}});n.exports=o}),define("html5/cms",["require","exports","module","core/app","Class","cvp/customevent","html5/contententry","html5/fakecontententry","html5/expiredcontententry","cvp/request","cvp/utils"],function(e,t,n){var i=e("core/app"),r=e("Class"),s=e("cvp/customevent"),o=e("html5/contententry"),a=e("html5/fakecontententry"),l=e("html5/expiredcontententry"),c=e("cvp/request"),u=e("cvp/utils"),d=r.extend({init:function(){this._catalogDataURL="",this._mediaUrl="",this._requestPendingQueue=[],this._requestInProgress=!1,this._videoCatalog=[],this._requests={},this._objectMap={},this._onContentIdRequestComplete=u.bind(this._onContentIdRequestComplete,this),this._onContentIdRequestIOError=u.bind(this._onContentIdRequestIOError,this),this._requestCleanup=u.bind(this._requestCleanup,this),this.eRequestCompleted=new s("CmsRequestCompletedEvent")},addContentId:function(e){var t=this.getContentId(e);if(u.isNull(t))this._requestPendingQueue.push(e);else{var n=e.split("|")[1];e=e.split("|")[0],this._notifyListeners(e,e,n,"","")}this._processNextRequest()},addContentObject:function(e,t){var n=e.split("|"),r=n[0],s=new a(t),o=this._videoCatalog.length;s&&s.hasFiles()?(this._objectMap[e]=s,this._requestPendingQueue.push(e)):this._notifyListeners(r,r,o,"Invalid data",i.ERROR_CMS_PARSE),this._processNextRequest()},getContentId:function(e){e=e.split("|")[0];for(var t,n=0,i=this._videoCatalog.length;i>n;++n)if(t=this._videoCatalog[n],t.getId()===e)return t;return null},setDataUrl:function(e){this._catalogDataURL=e},setMediaUrl:function(e){this._mediaUrl=e},_getRequestUrl:function(e){var t,n=this._catalogDataURL.substr(0).search(/\$\{/);if(-1!==n){var i=this._catalogDataURL.substr(n).search(/\}/);if(-1!==i){var r=this._catalogDataURL.substr(n,i+1);t=this._catalogDataURL.replace(r,e)}}else t=this._catalogDataURL+"/"+e+".xml";return t},_createContentEntryFromRequestData:function(e,t){try{var n=new o(e);return n.setMediaUrl(this._mediaUrl),n}catch(i){alert(this._getRequestUrl(t)+": "+i.message)}return null},_processNextRequest:function(){if(!this._requestInProgress&&this._requestPendingQueue.length){var e=this._requestPendingQueue[0];if(e in this._objectMap)this._processVideoFromObject(e);else{var t=e.split("|")[0];this._requestVideoWithId(t)}}},_requestVideoWithId:function(e){var t=this._getRequestUrl(e),n=c.getXML({url:t});this._requestInProgress=!0,n.then(this._onContentIdRequestComplete,this._onContentIdRequestIOError).ensure(this._requestCleanup)},_requestCleanup:function(){this._requestInProgress=!1,this._requestPendingQueue.shift(),this._processNextRequest()},_onContentIdRequestComplete:function(e){var t=this._requestPendingQueue[0].split("|"),n=t[0],r=t[1];if(!e)return void this._notifyListeners(n,n,r,"No data",i.ERROR_CMS_PARSE);var s=this._createContentEntryFromRequestData(e,n);return s&&s.hasFiles()?(s.isExpired()&&(s=new l),s.requestId=n,this._videoCatalog.push(s),void this._notifyListeners(s.getId(),s.requestId,r,"","")):void this._notifyListeners(n,n,r,"Invalid data",i.ERROR_CMS_PARSE)},_onContentIdRequestIOError:function(e){var t=this._requestPendingQueue[0].split("|"),n=t[0],r=t[1];this._notifyListeners(n,n,r,"IOError : "+e,i.ERROR_CMS_IO)},_processVideoFromObject:function(e){var t=this._objectMap[e],n=e.split("|"),i=n[0],r=n[1];t.requestId=i,t.setMediaUrl(this._mediaUrl),this._videoCatalog.push(t),this._notifyListeners(i,t.requestId,r,"",""),this._requestCleanup()},_notifyListeners:function(e,t,n,i,r){this.eRequestCompleted.dispatch(e,t,n,i,r)}});n.exports=d}),define("cvp/utils/conditionaltask",["require","exports","module","cvp/utils","cvp/log"],function(e,t,n){var i=e("cvp/utils"),r=e("cvp/log"),s=r.getLogger(),o=function(e,t,n){this._interval=i.isNull(n)?10:n,this._maxTries=500,this._condition=e,this._success=t,this._tries=0,this.conditionWrapper=i.bind(function(){var e=this._condition();e?(window.clearInterval(this._timer),this._success()):this._tries>this._maxTries&&(s.warn("condition never met!"),window.clearInterval(this._timer)),++this._tries},this),this.start=function(){this._timer=window.setInterval(this.conditionWrapper,this._interval)}};n.exports=o}),define("html5/player/baseplayer",["require","exports","module","Class","cvp/customevent","cvp/utils","cvp/utils/conditionaltask","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("cvp/utils"),o=e("cvp/utils/conditionaltask"),a=e("cvp/log"),l=a.getLogger(),c=i.extend({init:function(e){if(this._config=e.config,this.options=s.extend({containerElement:"",elementId:"",controls:!0,width:0,height:0},e),this.elementId=this.options.elementId,s.empty(this.elementId))throw l.error("Invalid element id...exiting"),new Error("Invalid element id");this.playerOptions={},this.width=this.options.width,this.height=this.options.height,this.element=null,this._isRendered=!1,this.rendering=!1,this.position={top:null,right:null,bottom:null,left:null},this.eRendered=new r,this.eContentMetadata=new r,this.eContentPlay=new r,this.eContentPause=new r,this.eContentEnd=new r,this.eContentPlayhead=new r,this.eContentBuffering=new r,this.eContentVolume=new r,this.eContentError=new r,this.eContentResize=new r,this.eContentSeek=new r,this.eContentSeekEnd=new r,this.eFullscreenChange=new r,this.eFullscreenError=new r,this.ePlayerMuted=new r,this.ePlayerPaused=new r,this.ePlayerStopped=new r},embed:function(){},render:function(e){if(l.debug("Player","render"),this.containerElement=s.byId(e||this.options.containerElement),s.isNull(this.containerElement))throw l.error("Container element could not be found...cannot render...exiting"),new Error("Container could not be found");var t=this,n=function(){return!s.isNull(s.byId(t.elementId))},i=function(){t.rendering=!1,t._isRendered=!0,t.element=s.byId(t.elementId),t.fireRendered()};if(this.rendering=!0,this.containerElement.hasChildNodes()&&(this.containerElement.innerHTML=""),this.embed(this.containerElement),n())l.info("Player element was found; render immediately."),i();else{l.info("Player element was not found; render eventually.");var r=new o(n,i);r.start()}},rendered:function(){return this._isRendered},show:function(){this.element&&this.position.left&&(this.element.style.left=this.position.left)},hide:function(){this.element&&(this.position.left=this.element.style.left,this.element.style.left="-5000px")},remove:function(){l.debug("Player","remove");var e=this.containerElement;if(s.isNull(e))throw l.error("Container element could not be found .. cannot remove"),new Error("Container element could not be found");for(;e.firstChild;)e.removeChild(e.firstChild);e.parentNode&&e.parentNode.removeChild(e)},dispose:function(){this.removePlayerListeners(),this.remove()},addPlayerListeners:function(){},removePlayerListeners:function(){},fireRendered:function(){this.eRendered.dispatch()},getContentId:function(){return this._catalogEntry?this._catalogEntry.getId():""},firePlay:function(){this.eContentPlay.dispatch(this.getContentId(),"")},fireEnded:function(){this.eContentEnd.dispatch(this.getContentId())}});n.exports=c}),define("cvp/utils/timing",["require","exports","module"],function(e,t,n){n.exports={eventually:function(e,t){function n(){r&&(window.clearTimeout(r),r=null)}function i(){n(),r=window.setTimeout(e,t)}var r;if(!isFinite(t)||"function"!=typeof e)throw new Error("usage: eventually(cb, ms)");return{start:i,stop:n}},periodically:function(e,t){var n,i=0,r=function(){e(++i,t)},s=function(){n&&o(),n=window.setInterval(r,t||1e3)},o=function(){window.clearInterval(n)};return{start:s,stop:o}}}}),define("html5/player/pilotepisode",["require","exports","module","Class","cvp/customevent","cvp/utils","cvp/log","cvp/utils/timing"],function(e,t,n){function i(e){return e instanceof g&&"code"in e}function r(e){var t=e.code,n=t===g.MEDIA_ERR_SRC_NOT_SUPPORTED,i=t===g.MEDIA_ERR_ABORTED;if(i)try{e.code=g.MEDIA_ERR_SRC_NOT_SUPPORTED}catch(r){u.debug("Failed to set error.code.  That's fine, I didn't want to do it anyway.")}return n||i}var s=e("Class"),o=e("cvp/customevent"),a=e("cvp/utils"),l=e("cvp/log"),c=e("cvp/utils/timing"),u=l.getLogger("PilotEpisode"),d=2e4,h=5e3,p="loadstart progress suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange resize volumechange".split(" "),g=window.MediaError||function(){},f=s.extend({init:function(e){this._started=!1,this._addedListeners=!1,this._player=e,this._player.eRendered.addListener(this._onPlayerRendered,this),this.onBuffering=new o,this.onConcluded=new o,this._pilotEvents=[],this._onPilotEvent=a.bind(this._onPilotEvent,this),this._onPilotTimeout=a.bind(this._onPilotTimeout,this),this._pilotTimer=c.eventually(this._onPilotTimeout,h),this._addEventListener=a.bind(this.addEventListener,this),this._removeEventListener=a.bind(this.removeEventListener,this)},_onPlayerRendered:function(){this._element=this._player.getVideoElement()},addEventListener:function(e,t){this._element.addEventListener(e,t,!1)},removeEventListener:function(e,t){this._element.removeEventListener(e,t,!1)},_queuePilotEvent:function(e){this._pilotEvents.push(e),u.log("queued pilot events: ",this._pilotEvents.length)},_clearPilotEvents:function(){u.log("clearing queued Pilot events"),this._pilotEvents.length=0},_dispatchPilotEvent:function(e){u.log("dispatching Pilot event '"+e.type+"'"),this._element.dispatchEvent(e)},_dispatchPilotEvents:function(){var e=this._pilotEvents,t=e.length;if(u.log("_dispatchPilotEvents","queue length = "+t),t){for(var n=t-1,i=0;n>i;++i)this._dispatchPilotEvent(e[i]);window.setTimeout(a.bind(this._dispatchPilotEvent,this,e[n]),0),this._clearPilotEvents()}},_onPilotEvent:function(e){u.log("_onPilotEvent",e.type);var t=e.target;switch(e.type){case"loadedmetadata":case"playing":this._queuePilotEvent(e),this._concludePilot();break;case"error":t&&i(t.error)&&r(t.error)&&(this._queuePilotEvent(e),this._next());break;case"waiting":this._pilotBuffering||(this._pilotBuffering=!0,this.onBuffering.dispatch()),this._startPilotTimer();break;case"progress":case"suspend":case"stalled":this._startPilotTimer();break;default:this._queuePilotEvent(e)}},_addPilotListener:function(e){this._addEventListener(e,this._onPilotEvent)},_addPilotListeners:function(){return this._addedListeners?void u.log("_addPilotListeners","already listening to events!"):(u.log("_addPilotListeners",p),this._element?(a.each(p,this._addPilotListener,this),void(this._addedListeners=!0)):(u.error("_addPilotListeners","reference to video element was not fulfilled"),void this._concludePilot()))},_removePilotListener:function(e){this._removeEventListener(e,this._onPilotEvent)},_removePilotListeners:function(){return this._addedListeners?(u.log("_removePilotListeners",p),a.each(p,this._removePilotListener,this),void(this._addedListeners=!1)):void u.log("_removePilotListeners","already NOT listening to events!")},_stopPilotTimer:function(){u.log("_stopPilotTimer"),this._pilotTimer.stop()},_hasExceededAttemptMaxDuration:function(){var e=a.now()-this._pilotAttemptStart;return e>h},_startPilotTimer:function(){u.log("_startPilotTimer"),this._pilotTimer.start()},_onPilotTimeout:function(){u.log("_onPilotTimeout"),this._hasPilotCompleted||this._next()},_concludePilot:function(){return this._hasPilotCompleted?void u.log("_concludePilot","already concluded!"):(u.log("_concludePilot"),this._hasPilotCompleted=!0,void this._transitionBackToPlayer())},_teardownPilot:function(){this._stopPilotTimer(),this._removePilotListeners()},_transitionBackToPlayer:function(){this._teardownPilot(),this.onConcluded.dispatch(),this._dispatchPilotEvents(),this.stop()},_hasExceededSessionMaxDuration:function(){var e=a.now()-this._pilotSessionStart;return e>d},_next:function(){if(!this._playlist.length)return u.debug("_next","no more video URLs to try"),void this._concludePilot();if(this._hasExceededSessionMaxDuration())return u.debug("_next","the pilot session has exceeded the maximum allowed duration"),void this._concludePilot();var e=this._playlist.shift();u.debug("_next","attempting to play '"+e+"'"),this._clearPilotEvents(),this._pilotAttemptStart=a.now(),this._startPilotTimer(),this._playUrl(e)},_playUrl:function(e){u.log("playing URL '"+e+"'");var t=this._element;t.src=e,t.load(),t.play()},_setupPilot:function(){this._pilotBuffering=!1,this._hasPilotCompleted=!1,this._player.removePlayerListeners(),this._addPilotListeners()},start:function(e){this._started&&this.stop(),u.log("start"),this._started=!0,this._pilotSessionStart=a.now(),this._playlist=e,this._setupPilot(),this._next()},stop:function(){this._started&&(u.log("stop"),this._started=!1,this._teardownPilot(),this._clearPilotEvents())},dispose:function(){u.log("dispose"),this.stop(),this._element=null,this._player=null,this._pilotTimer=null}});n.exports=f}),define("cvp/utils/configutils",["require","exports","module","cvp/utils","cvp/utils/xml"],function(e,t){function n(e,t,n){var i,r=this.getReplacementPatterns(e),o=0,a=0,l="";if(!s.empty(r))for(a=r.length;a>o;++o)i=r[o],l="",l=this.getReplacementText(i,t),s.empty(l)?l="":n&&(l=encodeURI(l)),e=e.replace(i,l);return e}function i(e){return e&&e.match(/[$][{][^}]*[}]/g)}function r(e,t){var n="",i="",r=[],s="";switch(e){case"${page.domain}":n=document.domain;break;case"${page.url}":n=location.href;break;case"${videoId}":case"${video.id}":t&&(n=t.getId());break;default:if(i=e.substr(2,e.length-3),r=i.split("."),s=r[0],r.length>1)switch(i=i.substr(s.length+1),s){case"video":t&&(n=o.getNodeValue(t._xmlEntry,i));break;case"javascript":window.cvpSearchTheClient&&(n=window.cvpSearchTheClient(null,i));break;default:n=e}else n=e}return n}var s=e("cvp/utils"),o=e("cvp/utils/xml");t.stringReplace=n,t.getReplacementPatterns=i,t.getReplacementText=r}),define("html5/player/fileselection",["require","exports","module","Class","cvp/utils","cvp/utils/configutils","cvp/browser","cvp/utils/jsonconverter","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/utils/configutils"),o=e("cvp/browser"),a=e("cvp/utils/jsonconverter"),l=e("cvp/log"),c=l.getLogger("FileSelection"),u=function(e){return e=e||{},e.hasOwnProperty("key")?e.key:e.hasOwnProperty("bitrate")?e.bitrate:void 0},d=function(e){var t=u(e);return m.availableFiles.hasOwnProperty(t)?m.availableFiles[t].ext:""},h=function(e,t){return function(n){return n.hasOwnProperty(e)?n[e]===t:!1}},p=function(e,t){return function(n){return n&&n.hasOwnProperty(e)?n[e]:t}},g=p("url",""),f=p("text",""),m={config:{},supportedFileTypes:[],selectedFileKeys:[],fallbackFileTypes:["m3u8","mp4"],availableFiles:{},availableFileKeys:[],availableFileUrls:[],contentEntryObj:{},contentEntryFiles:[]},_=i.extend({canExecute:function(){var e=m.config.params;return e.hasOwnProperty("fileSelection")||e.hasOwnProperty("perVideoFallbacks")},execute:function(e){var t,n=m.config.params;return n.hasOwnProperty("fileSelection")?t=this._getPageFileSelection(e):n.hasOwnProperty("perVideoFallbacks")&&(t=this._getFileByParameterFallback(e)),r.isString(t)&&(t=[t]),r.isArray(t)&&(r.each(t,function(e){-1===r.indexOf(m.availableFileUrls,e)&&c.warn("Potentially invalid url: "+e)}),t=r.map(t,function(t){return e.sanitizeUrl(t)})),t},_getPageFileSelection:function(){c.debug("Using page selection via 'fileSelection'");var e=m.config.params.fileSelection||null;if(!e)return!1;var t={_makeList:function(e){return r.isString(e)&&(e=e.split(",")),r.isArray(e)?e.map(function(e){return r.trim(e)}):[]},filterBy:function(e,t,n){var i=r.isFunc(t)?t:h(t,n);return r.filter(e,i)},filterByDimension:function(e,t,n){return this.filterBy(e,function(e){return e.width===t&&e.height===n})},filterByKey:function(e,t){return t=this._makeList(t),this.filterBy(e,function(e){return r.indexOf(t,u(e))>-1})},filterByExtension:function(e,t){return t=this._makeList(t),this.filterBy(e,function(e){return r.indexOf(t,d(e))>-1})}},n=e.call(t,m.contentEntryFiles,m.contentEntryObj);return r.isArray(n)?n.map(f):n},_getFileByParameterFallback:function(e){c.debug("Using page selection via 'perVideoFallbacks'");var t=m.config.params.perVideoFallbacks||[];if(!t)return!1;for(var n,i,r=0,o=t.length;o>r;++r)if(n=t[r],i=s.stringReplace(n.criteria,e,!1),n.evaluate(i))return s.stringReplace(n.filter,e,!1);return null}}),v=i.extend({canExecute:function(){return!0},execute:function(e){var t=[];if(m.selectedFileKeys.length||m.supportedFileTypes.length){c.debug("Using config file key selection: "+m.selectedFileKeys),c.debug("Using config file type selection: "+m.supportedFileTypes);var n=e.getContentUrlsByFileKeys(m.selectedFileKeys),i=e.getContentUrlsByExtensions(m.supportedFileTypes);c.debug("fileKeyUrls:",n),c.debug("fileTypeUrls:",i),n&&n.length&&t.push.apply(t,n),i&&i.length&&t.push.apply(t,i)}else{c.debug("Using config legacy selection");var r=this._getFileByFallback(e),s=this._getFileByConfigFallbackParam(e),o=e.getContentUrlsByExtensions(m.fallbackFileTypes);c.debug("iOSFallbackUrl:",r),c.debug("configFallbackUrl:",s),c.debug("defaultUrls:",o),r&&t.push(r),s&&t.push(s),o&&o.length&&t.push.apply(t,o)}return t},_getFileByConfigFallbackParam:function(e){var t=m.config.configInfo.fallbackFilenameIOS;return r.empty(t)?t:t=s.stringReplace(t,e,!1)},_getFileByFallback:function(e){return o.isOS(o.IOS)?e.getContentUrlFromFallback("iOS"):void 0}}),y=i.extend({init:function(e){m.config=e;var t=/\W+/,n=m.config.configInfo;m.supportedFileTypes=r.uniq(r.filter(n.html5Types.split(t))),m.selectedFileKeys=r.uniq(r.filter(n.html5Order.split(t))),this._pageSelection=new _,this._configSelection=new v},getDefaultPlaylistForEntry:function(e){return e.getContentUrlsByExtensions(m.fallbackFileTypes)},getPlaylistForEntry:function(e){this._setState(e);var t=[],n=this._pageSelection.canExecute(),i=null,s=this._configSelection.canExecute(),o=null;return n&&(i=this._pageSelection.execute(e)),n&&r.isArray(i)?t=t.concat(i):n&&i!==!0&&null!==i&&void 0!==i||s&&(o=this._configSelection.execute(e),r.isArray(o)&&(t=t.concat(o))),t=r.uniq(r.filter(t))},_setState:function(e){m.availableFiles=e.getAllFiles(),m.availableFileKeys=r.keys(m.availableFiles),m.availableFileUrls=r.map(m.availableFileKeys,function(e,t,n){return g(m.availableFiles[e],t,n)});var t=a.xmlToObject(e.getXML());m.contentEntryObj=t;var n=[];r.filter(t.files,function(e){var t=e.file,i=u(t);m.availableFiles.hasOwnProperty(i)&&t.text===m.availableFiles[i].url&&n.push(t)}),m.contentEntryFiles=n}});n.exports=y}),define("html5/player/seekingmonitor",["require","exports","module","cvp/utils","cvp/log","cvp/customevent","cvp/utils/timing"],function(e,t,n){function i(){this._seekStartPlayhead=null,this._handleTimeupdate=r.bind(this._handleTimeupdate,this),this._handleSeeking=r.bind(this._handleSeeking,this),this._handleSeeked=r.bind(this._handleSeeked,this),this.emitSeeking=r.throttle(r.bind(this.emitSeeking,this),d,{leading:!0,trailing:!1}),this.emitSeeked=r.bind(this.emitSeeked,this),this._seekEndTimer=a.eventually(this.emitSeeked,p),this.onSeeking=new o("seeking"),this.onSeeked=new o("seeked")}var r=e("cvp/utils"),s=e("cvp/log"),o=e("cvp/customevent"),a=e("cvp/utils/timing"),l=s.getLogger("SeekingMonitor"),c=250,u=c/1e3,d=400,h=1,p=1e3,g=!1;i.prototype={setup:function(e){l.log("setup"),this.player=e,this._lastPlayhead=this.player.getCurrentTime(),this._lastNonSeekingPlayhead=0,this._isSeeking=!1,this._listen(!0)},teardown:function(){l.log("teardown"),this.player&&(this._seekEndTimer.stop(),this._listen(!1))},dispose:function(){this.teardown(),this._seekEndTimer=null,this.player=null},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addEventListener":"removeEventListener",n=this.player.getVideoElement();n[t]("timeupdate",this._handleTimeupdate),n[t]("seeking",this._handleSeeking),n[t]("seeked",this._handleSeeked)}},_deferSeekEnd:function(){this._seekEndTimer.start()},_handleTimeupdate:function(){var e=r.now(),t=this._lastPlayheadTime||(this._lastPlayheadTime=e),n=e-t,i=this.player.getCurrentTime();c>n||(g||this._inferSeekFromTimeupdate(i,n),this._isSeeking||(this._lastNonSeekingPlayhead=i,this._lastNonSeekingPlayheadTime=e)),this._lastPlayhead=i,this._lastPlayheadTime=e},_inferSeekFromTimeupdate:function(e,t){var n=this._lastPlayhead,i=Math.abs(e-n),r=Math.abs(this.player.getPlaybackRate())*t/1e3;i>r+u&&this._determineSeeking()},_determineSeeking:function(){var e=!1;r.isNull(this._seekStartPlayhead)&&(e=!0,this._seekStartPlayhead=this._lastNonSeekingPlayhead),(e||Math.abs(this.player.getCurrentTime()-this._seekStartPlayhead)>h)&&this.emitSeeking(),this._deferSeekEnd()},_handleSeeking:function(){g||(g=!0);var e=r.now(),t=this._lastSeekingPlayheadTime||(this._lastSeekingPlayheadTime=e),n=e-t;if(!(c>n)){var i=this.player.getCurrentTime();this._determineSeeking(),this._lastSeekingPlayhead=i,this._lastSeekingPlayheadTime=e}},_handleSeeked:function(){this._deferSeekEnd()},emitSeeking:function(){var e=this._seekStartPlayhead,t=this.player.getCurrentTime(),n=this.player.getDuration();l.log("emitSeeking",e,t,n),this._isSeeking=!0,this.onSeeking.dispatch(e,t,n)},emitSeeked:function(){var e=this._seekStartPlayhead,t=this.player.getCurrentTime(),n=this.player.getDuration();l.log("emitSeeked",e,t,n),this._seekStartPlayhead=null,this.onSeeked.dispatch(e,t,n),this._isSeeking=!1}},n.exports=i}),define("html5/player/fullscreenmonitor",["require","exports","module","cvp/utils","cvp/log","cvp/customevent"],function(e,t,n){function i(){this._isFullscreen=!1,this._onW3FullscreenChangeBind=r.bind(this._onW3FullscreenChange,this),this._onWebKitFullscreenChangeBind=r.bind(this._onWebKitFullscreenChange,this),this._onMozFullscreenChangeBind=r.bind(this._onMozFullscreenChange,this),this._onWebKitBeginFullscreenBind=r.bind(this._onWebKitBeginFullscreen,this),this._onWebKitEndFullscreenBind=r.bind(this._onWebKitEndFullscreen,this),this._onW3FullscreenErrorBind=r.bind(this._onW3FullscreenError,this),this._onWebKitFullscreenErrorBind=r.bind(this._onWebKitFullscreenError,this),this._onMozFullscreenErrorBind=r.bind(this._onMozFullscreenError,this),this.emitFullscreenChange=r.bind(this.emitFullscreenChange,this),this.emitFullscreenError=r.bind(this.emitFullscreenError,this),this.onFullscreenChange=new o("fullscreenChange"),this.onFullscreenError=new o("fullscreenError")}var r=e("cvp/utils"),s=e("cvp/log"),o=e("cvp/customevent"),a=s.getLogger("FullscreenMonitor");i.prototype={setup:function(e){a.log("setup"),e&&!this.player&&(this.player=e,this._listen(!0))},teardown:function(){a.log("teardown"),this.player&&this._listen(!1)},dispose:function(){this.teardown(),this.player=null},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addEventListener":"removeEventListener",n=this.player.getPlayerElement();n[t]("webkitbeginfullscreen",this._onWebKitBeginFullscreenBind,!1),n[t]("webkitendfullscreen",this._onWebKitEndFullscreenBind,!1),document[t]("fullscreenchange",this._onW3FullscreenChangeBind,!1),document[t]("webkitfullscreenchange",this._onWebKitFullscreenChangeBind,!1),document[t]("mozfullscreenchange",this._onMozFullscreenChangeBind,!1),document[t]("fullscreenerror",this._onW3FullscreenErrorBind,!1),document[t]("webkitfullscreenerror",this._onWebKitFullscreenErrorBind,!1),document[t]("mozfullscreenerror",this._onMozFullscreenErrorBind,!1)}},_handleFullscreenChange:function(e,t){(!e||e&&t===this.player.getPlayerElement())&&e!==this._isFullscreen&&(this._isFullscreen=e,this.emitFullscreenChange(this._isFullscreen,t))},_onW3FullscreenChange:function(){var e=document.fullscreenElement,t=!(!document.fullscreenEnabled&&!document.fullscreen&&!e);a.debug("_onW3FullscreenChange",t,e),this._handleFullscreenChange(t,e)},_onWebKitFullscreenChange:function(){var e=document.webkitFullscreenElement,t=!!document.webkitIsFullScreen||!!e;a.debug("_onWebKitFullscreenChange",t,e),this._handleFullscreenChange(t,e)},_onMozFullscreenChange:function(){var e=document.mozFullScreenElement,t=!(!document.mozFullScreen&&!document.fullScreen&&!e);a.debug("_onMozFullscreenChange",t,e),this._handleFullscreenChange(t,e)},_onWebKitBeginFullscreen:function(){var e=this.player.getPlayerElement(),t=!0;a.debug("_onWebKitBeginFullscreen",t,e),this._handleFullscreenChange(t,e)},_onWebKitEndFullscreen:function(){var e=null,t=!1;a.debug("_onWebKitEndFullscreen",t,e),this._handleFullscreenChange(t,e)},_handleFullscreenError:function(){a.log("_onFullscreenError"),this.emitFullscreenError()},_onW3FullscreenError:function(){a.log("_onW3FullscreenError"),this._handleFullscreenError()},_onWebKitFullscreenError:function(){a.log("_onWebKitFullscreenError"),this._handleFullscreenError()},_onMozFullscreenError:function(){a.log("_onMozFullscreenError"),this._handleFullscreenError()},emitFullscreenChange:function(e,t){a.log("emitFullscreenChange"),this.onFullscreenChange.dispatch(e,t)},emitFullscreenError:function(){a.log("emitFullscreenError"),this.onFullscreenError.dispatch()}},n.exports=i}),define("html5/player/domeventhandler",["require","exports","module","Class","cvp/utils"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=i.extend({init:function(e,t,n,i){if(!(e||t||n))throw new Error("Usage: new DOMEventHandler(element, events, listener, capture).once().while(fn).until(fn)");return this._enabled=!1,this._element=e,this._events=r.isArray(t)?t:t.split(/\W+/),this._listener=n,this._capture=i||!1,this._once=!1,this._precondition=null,this._postcondition=null,this.listener=r.bind(this.listener,this),this.addListener=r.bind(this.addListener,this),this.removeListener=r.bind(this.removeListener,this),this},dispose:function(){this.off(),this._element=null,this._events=null,this._listener=null,this._precondition=null,this._postcondition=null},listener:function(){return this._precondition&&!this._precondition()?void this.off():(this._once&&this.off(),this._listener.apply(this._element,arguments),void(this._postcondition&&!this._postcondition()&&this.off()))},addListener:function(e){this._element.addEventListener(e,this.listener,this._capture)},removeListener:function(e){this._element.removeEventListener(e,this.listener,this._capture)},once:function(){return this._once=!0,this},every:function(){return this._once=!1,this},"while":function(e){return r.isFunction(e)&&(this._precondition=e),this},until:function(e){return r.isFunction(e)&&(this._postcondition=e),this},off:function(){this._enabled&&(this._enabled=!1,r.each(this._events,this.removeListener))},on:function(){!this._enabled&&this._element&&(this._enabled=!0,r.each(this._events,this.addListener))}});n.exports=s}),define("html5/player/videoplayer",["require","exports","module","html5/player/baseplayer","html5/player/pilotepisode","html5/player/fileselection","html5/player/seekingmonitor","html5/player/fullscreenmonitor","html5/player/domeventhandler","core/app","cvp/browser","cvp/static","cvp/utils","cvp/log","cvp/utils/timing"],function(e,t,n){function i(e){var t=e instanceof v&&!g.isEmpty(e);return t||(_.debug("error instanceof MediaError: ",e instanceof v),_.debug("error.code:",e.code),_.debug("Utils.hasOwn(error, 'code'):",g.hasOwn(e,"code"))),t}function r(e){switch(e.code){case v.MEDIA_ERR_ABORTED:return p.MEDIA_ERR_ABORTED;case v.MEDIA_ERR_NETWORK:return p.MEDIA_ERR_NETWORK;case v.MEDIA_ERR_DECODE:return p.MEDIA_ERR_DECODE;case v.MEDIA_ERR_SRC_NOT_SUPPORTED:return p.MEDIA_ERR_SRC_NOT_SUPPORTED}return p.MEDIA_ERR_UNKNOWN}var s=e("html5/player/baseplayer"),o=e("html5/player/pilotepisode"),a=e("html5/player/fileselection"),l=e("html5/player/seekingmonitor"),c=e("html5/player/fullscreenmonitor"),u=e("html5/player/domeventhandler"),d=e("core/app"),h=e("cvp/browser"),p=e("cvp/static"),g=e("cvp/utils"),f=e("cvp/log"),m=e("cvp/utils/timing"),_=f.getLogger("VideoPlayer"),v=window.MediaError||function(){},y=s.extend({init:function(e,t){_.log("init"),this._videoElement=e,this._super(t);var n=this._config.configInfo.iosAirplay;h.isOS(h.IOS)&&!g.undef(n)&&(this.playerOptions["x-webkit-airplay"]=n),this.playerOptions.controls=this.options.controls,this._playlist=[],this._addedListeners=!1,this._muted=!1,this._fullscreen=!1,this.firePlayhead=g.throttle(this.firePlayhead,250,{leading:!0,trailing:!1}),this._pilotEpisode=new o(this),this._pilotEpisode.onBuffering.addListener(this._onContentBuffering,this),this._pilotEpisode.onConcluded.addListener(this._onPilotConcluded,this),this._fileSelectionHandler=new a(this._config),this._seekingMonitor=new l,this._fullscreenMonitor=new c,this.eRendered.addListener(this.onRender,this),this._eventListeners={loadeddata:g.bind(this._onLoadedData,this),play:g.bind(this._onContentPlay,this),ended:g.bind(this._onContentEnd,this),playing:g.bind(this._onContentPlaying,this),pause:g.bind(this._onContentPause,this),timeupdate:g.bind(this._onContentPlayhead,this),error:g.bind(this._onContentError,this),waiting:g.bind(this._onContentBuffering,this),canplay:g.bind(this._onContentBuffered,this),volumechange:g.bind(this._onContentVolume,this)},this._addEventListener=g.bind(this.addEventListener,this),this._removeEventListener=g.bind(this.removeEventListener,this),this._manuallyCallEnded=g.bind(this._manuallyCallEnded,this),this._playIfPlayerIsPaused=g.bind(this._playIfPlayerIsPaused,this),this._ensureLoadedMetaDataFiresOnce=g.bind(this._ensureLoadedMetaDataFiresOnce,this),this._endedWatch=m.eventually(this._manuallyCallEnded,1e3)
},_setupEnsurePlayWhenAbleHandler:function(){this._ensurePlayWhenAbleHandler||(this._ensurePlayWhenAbleHandler=new u(this.element,"canplay",this._playIfPlayerIsPaused,!0).once())},_disposeEnsurePlayWhenAbleHandler:function(){this._ensurePlayWhenAbleHandler&&(this._ensurePlayWhenAbleHandler.dispose(),this._ensurePlayWhenAbleHandler=null)},_setupEnsureLoadedMetaDataHandler:function(){this._ensureLoadedMetaDataHandler||(this._ensureLoadedMetaDataHandler=new u(this.element,"loadedmetadata loadeddata playing",this._ensureLoadedMetaDataFiresOnce,!0).once())},_disposeEnsureLoadedMetaDataHandler:function(){this._ensureLoadedMetaDataHandler&&(this._ensureLoadedMetaDataHandler.dispose(),this._ensureLoadedMetaDataHandler=null)},_disposeEndedWatch:function(){this._endedWatch.stop(),this._endedWatch=null},_setupSeekingMonitor:function(){this._seekingMonitor.setup(this),this._seekingMonitor.onSeeking.addListener(this._onContentSeeking,this),this._seekingMonitor.onSeeked.addListener(this._onContentSeeked,this)},_teardownSeekingMonitor:function(){this._seekingMonitor.onSeeking.removeListener(this._onContentSeeking,this),this._seekingMonitor.onSeeked.removeListener(this._onContentSeeked,this),this._seekingMonitor.teardown()},_disposeSeekingMonitor:function(){this._seekingMonitor&&(this._teardownSeekingMonitor(),this._seekingMonitor.dispose(),this._seekingMonitor=null)},_setupFullscreenMonitor:function(){this._fullscreenMonitor.setup(this),this._fullscreenMonitor.onFullscreenChange.addListener(this._onFullscreenChange,this),this._fullscreenMonitor.onFullscreenError.addListener(this._onFullscreenError,this)},_teardownFullscreenMonitor:function(){this._fullscreenMonitor&&(this._fullscreenMonitor.onFullscreenChange.removeListener(this._onFullscreenChange,this),this._fullscreenMonitor.onFullscreenError.removeListener(this._onFullscreenError,this),this._fullscreenMonitor.teardown())},_disposeFullscreenMonitor:function(){this._fullscreenMonitor&&(this._teardownFullscreenMonitor(),this._fullscreenMonitor.dispose(),this._fullscreenMonitor=null)},addEventListener:function(e,t){this.element.addEventListener(e,t,!1)},removeEventListener:function(e,t){this.element.removeEventListener(e,t,!1)},showControls:function(){return this.element?this.playerOptions.controls?(_.log("showControls","showing controls"),void(this.element.controls=!0)):void _.log("showControls","disallowed by configuration"):void _.warn("showControls","no video element")},hideControls:function(){return this.element?(_.log("hideControls","hiding controls"),void(this.element.controls=!1)):void _.warn("hideControls","no video element")},getPlayerElement:function(){return this.element},getVideoElement:function(){return this.element},getPlaybackRate:function(){return this.element&&this.element.playbackRate||1},getCurrentSrc:function(){return this.element&&this.element.currentSrc},getCurrentTime:function(){return this.element&&this.element.currentTime||0},getDuration:function(){return this.element&&this.element.duration||this._catalogEntry&&this._catalogEntry.getTrt()||0},dispose:function(){this.eRendered.removeListener(this.onRender,this),this._disposeSeekingMonitor(),this._disposeFullscreenMonitor(),this._disposeEnsurePlayWhenAbleHandler(),this._disposeEnsureLoadedMetaDataHandler(),this._disposeEndedWatch(),this._pilotEpisode.onBuffering.removeListener(this._onContentBuffering,this),this._pilotEpisode.onConcluded.removeListener(this._onPilotConcluded,this),this.reset(),this._pilotEpisode.dispose(),this._pilotEpisode=null,this.remove(),this._videoElement=null,this.element=null},onRender:function(){this._setupEnsurePlayWhenAbleHandler(),this._setupEnsureLoadedMetaDataHandler(),this._setupFullscreenMonitor();var e=this._config.configInfo;e.volume&&this.setVolume(e.volume),e.muted&&this.mute()},firePause:function(){this.ePlayerPaused.dispatch(this.getContentId(),this.getCurrentTime(),this._paused),this.eContentPause.dispatch(this.getContentId(),this._paused)},fireBuffering:function(){this.eContentBuffering.dispatch(this.getContentId(),this._buffering)},fireMetadata:function(){this.eContentMetadata.dispatch(this.getContentId(),this.getDuration(),this.element.videoWidth,this.element.videoHeight)},firePlayhead:function(){this.eContentPlayhead.dispatch(this.getContentId(),this.getCurrentTime(),this.getDuration(),-1)},fireSeek:function(){this.eContentSeek.dispatch(this.getContentId(),this._timeAtSeekBegin,this.getCurrentTime(),this.getDuration())},fireSeekEnd:function(){this.eContentSeekEnd.dispatch(this.getContentId(),this._timeAtSeekBegin,this.getCurrentTime(),this.getDuration())},_getCSSDimensionValue:function(e){var t=/^\d+$/;return t.test(e)?e+"px":e},_setCSSDimension:function(e,t,n){e.style[t]=this._getCSSDimensionValue(n)},_setWidth:function(e,t){this.width=t,this._setCSSDimension(e,"width",t)},_setHeight:function(e,t){this.height=t,this._setCSSDimension(e,"height",t)},embed:function(e){return this._videoElement.id=this.elementId,this._setWidth(this._videoElement,this.width),this._setHeight(this._videoElement,this.height),this._videoElement.preload="none",this._videoElement.controls=this.playerOptions.controls,this._setWidth(e,this.width),this._setHeight(e,this.height),e.appendChild(this._videoElement),this._videoElement.parentNode===e?(this._videoElement=null,!0):!1},_onPilotConcluded:function(){var e=this.element.currentSrc;_.log("_onPilotConcluded",e),this._currentSrc=e,this.setDefaultOptions(),this.addPlayerListeners()},_resetPlayerStatesForPlayStart:function(){_.log("_resetPlayerStatesForPlayStart"),this._playlist.length=0,this._lastPlayhead=0,this._metadataEmitted=!1,this._playEmitted=!1,this._stopped=!1,this._paused=!1,this._buffering=!1,this._seeking=!1,this._timeAtSeekBegin=null},play:function(e){_.log("play");var t=this._catalogEntry,n=this._currentSrc,i=this._catalogEntry=e||t;if(this._resetPlayerStatesForPlayStart(),i!==t||!n)switch(this._currentSrc=null,this._setPoster(),this._updatePlaylist(this._playlist,i),this._playlist.length){case 0:return void this.eContentError.dispatch(this.getContentId(),"No content URL selected.");case 1:_.log("skipping Pilot Mode as there is only one video in the playlist"),this._currentSrc=this._playlist[0];break;default:this._pilotEpisode.start(this._playlist)}if(this._currentSrc){this.setDefaultOptions(),this.addPlayerListeners();var r=this._currentSrc,s=this.element;_.log("playing URL '"+r+"'"),s.src=r,s.load(),s.play()}},_updatePlaylist:function(e,t){_.log("_updatePlaylist"),e.length=0,t.isExpired()?e.push(d.EXPIRED_MP4_URL):e.push.apply(e,this._fileSelectionHandler.getPlaylistForEntry(t)),_.debug("internal playlist ["+e.length+"]:",e)},pause:function(){this.element.pause()},resume:function(){this.element.play()},reset:function(){this._pilotEpisode.stop(),this.removePlayerListeners(),this.exitFullscreen(),this._clearPoster(),this.hideControls(),this.element.removeAttribute("src")},stop:function(){this._stopped||(this._stopped=!0,this.reset(),this.ePlayerStopped.dispatch(this.getContentId()))},seek:function(e){this.element.currentTime=e},setVolume:function(e){this.element.volume=e},getVolume:function(){return this.element.volume},mute:function(){this.element.muted=!0},unmute:function(){this.element.muted=!1},isMuted:function(){return this.element.muted},resize:function(e,t){this._setWidth(this.element,e),this._setHeight(this.element,t),this._onContentResize()},getFullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullscreenElement},_requestFullscreen:function(e){for(var t,n=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","webkitEnterFullscreen","webkitEnterFullScreen","mozRequestFullScreen","msRequestFullscreen"],i=0,r=n.length;r>i;++i)if(t=n[i],t in e&&g.isFunction(e[t]))return e[t]()},_exitFullscreen:function(){for(var e,t=["exitFullscreen","cancelFullscreen","cancelFullScreen","webkitExitFullscreen","webkitExitFullScreen","webkitCancelFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"],n=0,i=t.length;i>n;++n)if(e=t[n],e in document&&g.isFunction(document[e]))return document[e]();var r=this.getVideoElement();if(r===this.getPlayerElement()&&r.webkitDisplayingFullscreen)for(var s,o=["webkitExitFullscreen","webkitExitFullScreen"],a=0,l=o.length;l>a;++a)if(s=o[a],s in r&&g.isFunction(r[s]))return r[s]()},exitFullscreen:function(){try{this._exitFullscreen()}catch(e){_.debug("exitFullscreen failed",e)}},goFullscreen:function(){if(h.forcesFullscreen)return void _.warn("goFullscreen is not permitted on devices that automatically play video in fullscreen.");var e=this.element;if(this.getFullscreenElement()===e)try{this._exitFullscreen()}catch(t){_.error("goFullscreen failed to exit fullscreen",t.message)}else try{this._requestFullscreen(e)}catch(t){_.error("goFullscreen failed to enter fullscreen",t.message)}},getDimensions:function(){return{width:this.getWidth(),height:this.getHeight(),videoWidth:this.element.videoWidth,videoHeight:this.element.videoHeight}},setDefaultOptions:function(){this.setOptions(this.playerOptions)},setOptions:function(e){e=e||{},_.log("setOptions",e),g.each(e,function(e,t){this.element[e]=t},this)},_clearPoster:function(){this.element.poster=""},_setPoster:function(e){var t=arguments.length?e:this.getThumbnail();_.log("_setPoster",t),this.element.poster=d.BLANK_IMG_URL,t&&(this.element.poster=t)},getThumbnail:function(){return this._catalogEntry?this._catalogEntry.getImageForDimensions(this.getWidth(),this.getHeight()):""},getWidth:function(){var e=g.getStyle(this.getPlayerElement(),"width");return e?g.toInt(e):this.width},getHeight:function(){var e=g.getStyle(this.getPlayerElement(),"height");return e?g.toInt(e):this.height},_ensureLoadedMetaDataFiresOnce:function(){this._metadataEmitted||(this._metadataEmitted=!0,this.fireMetadata())},_playIfPlayerIsPaused:function(){this._paused&&(_.log("Attempting to force play since the video element was found paused."),this.element.play())},_onLoadedData:function(){_.log("_onLoadedData"),this._ensurePlayWhenAbleHandler.on()},_onContentPlay:function(){_.log("_onContentPlay"),this._ended=!1,this._paused&&(this._paused=!1,this.firePause()),this._playEmitted||(this._playEmitted=!0,this.firePlay(),this.firePlayhead())},_onContentPlaying:function(){_.log("_onContentPlaying"),this._clearPoster()},_onContentPause:function(){_.log("_onContentPause"),this._paused=!0,this.getCurrentTime()!==this.getDuration()&&this.firePause()},_onContentPlayhead:function(){if(!this._seeking&&!this._ended){var e=this.getCurrentTime(),t=this._lastPlayhead;this._isDoingNothing()?(_.debug("Suspect that the video element did not emit 'ended' event."),this._startEndWatcher()):(g.isNull(t)||e!==t)&&(this._stopEndWatcher(),this.firePlayhead()),this._lastPlayhead=e}},_isDoingNothing:function(){return 0===g.toInt(this.getCurrentTime())&&Math.abs(this._lastPlayhead-this.getDuration())<2&&!this._stopped&&!this._paused&&!this._seeking&&!this._buffering},_startEndWatcher:function(){this._stopEndWatcher(),this._ended||this._endedWatch.start()},_manuallyCallEnded:function(){this._stopEndWatcher(),this._ended||(_.debug("Manually calling ended because the video element did not."),this._onContentEnd())},_stopEndWatcher:function(){this._endedWatch&&this._endedWatch.stop()},_onContentSeeking:function(e){_.log("_onContentSeeking"),this._seeking=!0,g.isNull(this._timeAtSeekBegin)&&(this._timeAtSeekBegin=e),this.fireSeek()},_onContentSeeked:function(){_.log("_onContentSeeked"),this.fireSeekEnd(),this._seeking=!1,this._timeAtSeekBegin=null},_onContentEnd:function(){this._ended||(this._stopEndWatcher(),this._ended=!0,_.log("_onContentEnd"),this.firePlayhead(),this.fireEnded())},_onContentError:function(e){var t=e.target,n=t.error;if(t!==this.element)return void _.error("How can this be?  We've received an error from an element we're not listening to?");if(!n)return void _.error("How can this be?  We've received an 'error' event, but no 'error' property was set on the video element?");if(!i(n))return void _.warn("Received 'error' media event without accompanying error code; ignoring as false error, so content may continue.");var s=r(n);_.error("_onContentError",s),this.eContentError.dispatch(this.getContentId(),s)},_onContentBuffering:function(){return _.log("_onContentBuffering"),this._buffering?void _.log("_onContentBuffering: still buffering"):(this._buffering=!0,void this.fireBuffering())},_onContentBuffered:function(){return _.log("_onContentBuffered"),this._buffering?(this._buffering=!1,void this.fireBuffering()):void _.log("_onContentBuffered: not even buffering")},_onContentVolume:function(){_.log("_onContentVolume");var e=this.element.muted;this._muted!==e&&(this._muted=e,this.ePlayerMuted.dispatch(e)),this.eContentVolume.dispatch(e,this.element.volume)},_onContentResize:function(){_.log("_onContentResize"),this.eContentResize.dispatch(this.getWidth(),this.getHeight(),this._fullscreen)},_onFullscreenChange:function(e){_.log("_onFullscreenChange",e),this._fullscreen=e,this.eFullscreenChange.dispatch(this._fullscreen)},_onFullscreenError:function(){_.log("_onFullscreenError"),this.eFullscreenError.dispatch()},addPlayerListeners:function(){return _.log("addPlayerListeners"),this.element?this._addedListeners?void _.log("addPlayerListeners","already listening to events!"):(this._ensureLoadedMetaDataHandler.on(),g.each(this._eventListeners,this._addEventListener,this),this._setupSeekingMonitor(),void(this._addedListeners=!0)):void _.error("addPlayerListeners","cannot find element to listen to!")},removePlayerListeners:function(){return _.log("removePlayerListeners"),this.element?this._addedListeners?(this._ensureLoadedMetaDataHandler.off(),g.each(this._eventListeners,this._removeEventListener,this),this._teardownSeekingMonitor(),this._pilotEpisode.stop(),void(this._addedListeners=!1)):void _.log("removePlayerListeners","already stopped listening to events!"):void _.error("removePlayerListeners","cannot find element to not listen to!")}});n.exports=y}),define("html5/ads/adtypes",[],function(){return{PREROLL:"preroll",MIDROLL:"midroll",POSTROLL:"postroll"}}),define("html5/ads/videostates",[],function(){return{PLAYING:"PLAYING",PAUSED:"PAUSED",STOPPED:"STOPPED",COMPLETED:"COMPLETED"}}),define("html5/ads/baseimpl",["require","exports","module","Class","cvp/utils","cvp/customevent","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/customevent"),o=e("cvp/log"),a=o.getLogger(),l=i.extend({init:function(e){this._adPolicy=e,this._keyValues={},this._adServerInfo=this._adPolicy.ads,this._adSection=this.getConfigProperty("adSection"),this.currentAdType="",this.currentAdId="",this.currentAdDuration=0,this.eAdPlayhead=new s,this.eAdPlay=new s,this.eAdEnd=new s,this.eAdError=new s,this.eAdClick=new s,this.eAdReady=new s,this.eAdStopped=new s},stop:function(){},dispose:function(){},setAdSection:function(e){this._adSection=e},getAdSection:function(){return this._adSection},setAdKeyValue:function(e,t){e&&(null===t?delete this._keyValues[e]:this._keyValues[e]=t)},getAdKeyValue:function(e){return this._keyValues[e]||void 0},getAdKeyValues:function(){return this._keyValues},clearAdKeyValues:function(){this._keyValues={}},setVideoState:function(e){this._videoState=e},getVideoState:function(){return this._videoState},getAdAnalyticsData:function(){},getAdAnalyticsDataForCurrentSlot:function(){},getMidrolls:function(){return{}},getConfigProperty:function(e){var t=null,n=!1;switch(e){case"adApi":t=this._adServerInfo.apiUrl,n=!0;break;case"adServerRootUrl":t=this._adServerInfo.adServerRootUrl,n=!0;break;case"adNetworkId":t=this._adServerInfo.adNetworkId,n=!0;break;case"adVideoNetworkId":t=this._adServerInfo.adVideoNetworkId,n=!0;break;case"adVideoAssetId":t=this._adServerInfo.adVideoAssetId,n=!0;break;case"adSection":t=this._adServerInfo.adSection,n=!0;break;case"adPlayerProfile":t=this._adServerInfo.adPlayerProfile,n=!0;break;case"renderersUrl":t=this._adServerInfo.renderersUrl,n=!1;break;case"sensitiveFallbackId":t=this._adServerInfo.sensitiveFallbackId,n=!1;break;case"adLiveContentDuration":t=this._adServerInfo.liveDuration,n=!1}return r.empty(t)&&(n?a.error("the following required ad server config value is missing:",e):a.warn("the following optional ad server config value is missing:",e)),t},getCurrentAdType:function(){return this.currentAdType},getCurrentAdId:function(){return this.currentAdId},getCurrentAdDuration:function(){return this.currentAdDuration},_emitAdPlay:function(e){var t=r.extend({ads:[],token:null,mode:"standard",id:this.getCurrentAdId(),duration:this.getCurrentAdDuration(),adType:this.getCurrentAdType(),adAnalyticsData:this.getAdAnalyticsDataForCurrentSlot()},e);this.eAdPlay.dispatch(t)},_emitAdEnd:function(e){var t=r.extend({token:null,mode:"standard",id:this.getCurrentAdId(),adType:this.getCurrentAdType()},e);this.eAdEnd.dispatch(t)},_emitAdError:function(e){var t=r.extend({id:this.getCurrentAdId(),adType:this.getCurrentAdType(),errors:[]},e);this.eAdError.dispatch(t)},_emitAdClick:function(e){var t=r.extend({id:this.getCurrentAdId(),adType:this.getCurrentAdType(),url:""},e);this.eAdClick.dispatch(t)}});n.exports=l}),define("cvp/errors",["require","exports","module"],function(e,t,n){function i(e){var t=""+r.AD_ERROR+o.AD_RUNTIME_ERROR+a.LOW;switch(e){case l.AD_TYPE_NOT_TRAFFICKED:return""+r.AD_ERROR+o.AD_RUNTIME_ERROR+a.HIGH+"4000";case l.NO_AD_PLAYED_AT_AD_SPOT:return""+r.AD_ERROR+o.AD_RUNTIME_ERROR+a.HIGH+"4001";case l.AD_RULE_FAILED:return t+"4006";case l.AD_SKIPPED_DUE_TO_SENSITIVITY:return t+"4005";case l.AD_SKIPPED_BY_JAVASCRIPT:return t+"4004";case l.PLAY_CALL_2ND_PARAM_DISABLED_AD:return t+"4003";case l.AD_SERVER_NOT_CONFIGURED:return""+r.AD_ERROR+o.AD_RUNTIME_ERROR+a.HIGH+"4002";case l.AD_EXISTS_BUT_FAILED:return""+r.AD_ERROR+o.AD_RUNTIME_ERROR+a.HIGH+"4007";default:return""+r.AD_ERROR+o.AD_RUNTIME_ERROR+a.HIGH+"4009"}}var r={ASPEN_REPORTING:"AS",CONTENT_ERROR:"CT",AD_ERROR:"AD",PLAYER_ERROR:"PL",CONTAINER_ERROR:"CR",EXTERNAL_ERROR:"EX"},s={PLAYER_CONFIG_ERROR:"PC",PLAYER_INIT_ERROR:"PI",VIDEO_ASSET_ERROR:"VA",NOT_AVAILABLE_:"NA",CONTENT_TOKEN_SERVICE_ERROR:"CA",TOKEN_SERVICE_ERROR:"TS",CLOSED_CAPTION_ERROR:"CC"},o={AD_LOAD_ERROR:"LD",AD_INIT_ERROR:"IN",AD_RUNTIME_ERROR:"RT",FW_NOTIFICATION:"FN"},a={HIGH:"hi",MEDIUM:"md",LOW:"lo"},l={AD_TYPE_NOT_TRAFFICKED:"ad type not trafficked",NO_AD_PLAYED_AT_AD_SPOT:"slot finished but no ad to play in slot",AD_SKIPPED_DUE_TO_SENSITIVITY:"ad skipped due to ad sensitivity setting",AD_SERVER_NOT_CONFIGURED:"no ad server is configured",PLAY_CALL_2ND_PARAM_DISABLED_AD:"ad was disabled via optional second param on play call",AD_SKIPPED_BY_JAVASCRIPT:"skipped as directed by the javascript callback",AD_RULE_FAILED:"skipped because did not pass ad rules",AD_PLAYBACK_ERROR:"unknown ad playback error",AD_EXISTS_BUT_FAILED:"ad exists but failed to play in slot",AD_INTERRUPTED:"slot was interrupted"};n.exports={ErrorType:r,PlayerErrorSubType:s,AdErrorSubType:o,ErrorLevel:a,ErrorMessage:l,determineAdErrorCode:i}}),define("html5/ads/freewheelimpl",["require","exports","module","html5/ads/baseimpl","cvp/utils","cvp/utils/configutils","cvp/utils/timing","cvp/errors","cvp/log","html5/ads/adtypes","html5/ads/videostates"],function(e,t,n){var i=e("html5/ads/baseimpl"),r=e("cvp/utils"),s=e("cvp/utils/configutils"),o=e("cvp/utils/timing"),a=e("cvp/errors"),l=e("cvp/log"),c=e("html5/ads/adtypes"),u=e("html5/ads/videostates"),d=a.ErrorMessage,h=l.getLogger("FreeWheelImpl"),p={READY:0,CREATING_NEW_CONTEXT:1,STOPPING_ADS:2},g=i.extend({init:function(){if(h.log("Instantiating"),this._super.apply(this,arguments),this._state=p.READY,this._freewheel=null,this.enabled=!1,r.isObject(window.tv)&&r.isObject(window.tv.freewheel)&&r.isObject(window.tv.freewheel.SDK)){g.initialized||(g.SDK=window.tv.freewheel.SDK,g.PREROLL=g.SDK.TIME_POSITION_CLASS_PREROLL,g.MIDROLL=g.SDK.TIME_POSITION_CLASS_MIDROLL,g.POSTROLL=g.SDK.TIME_POSITION_CLASS_POSTROLL,g.VIDEO_PLAYING=g.SDK.VIDEO_STATE_PLAYING,g.VIDEO_PAUSED=g.SDK.VIDEO_STATE_PAUSED,g.VIDEO_STOPPED=g.SDK.VIDEO_STATE_STOPPED,g.VIDEO_COMPLETED=g.SDK.VIDEO_STATE_COMPLETED,g.initialized=!0);var e=this.getConfigProperty("adNetworkId"),t=this.getConfigProperty("adServerRootUrl")+"/ad/g/1";this._freewheel=new g.SDK.AdManager,this._freewheel.setNetwork(e),this._freewheel.setServer(t)}this._isListening=!1,this._adProgress=0,this._adTimer=null,this._adTimerDelay=1e3,this._ads={},this._ads[g.PREROLL]=[],this._ads[g.MIDROLL]=[],this._ads[g.POSTROLL]=[],this._onRequestComplete=r.bind(this._onRequestComplete,this),this._onSlotStarted=r.bind(this._onSlotStarted,this),this._onSlotEnded=r.bind(this._onSlotEnded,this),this._onPauseRequested=r.bind(this._onPauseRequested,this),this._onResumeRequested=r.bind(this._onResumeRequested,this),this._onAdStart=r.bind(this._onAdStart,this),this._onAdEnd=r.bind(this._onAdEnd,this),this._onAdClick=r.bind(this._onAdClick,this)},_createAdIncrementor:function(e){return r.bind(function(e){var t=e.getPlayheadTime();t!==this._adProgress&&(t>this.currentAdDuration||(this._adProgress=t,this.onAdPlayhead(this._adProgress,this.currentAdDuration)))},this,e)},_updateAdTimer:function(e){this._disposeAdTimer(),this._adTimer=new o.periodically(this._createAdIncrementor(e),this._adTimerDelay),this._adTimer.start()},_disposeAdTimer:function(){null!==this._adTimer&&(this._adTimer.stop(),this._adTimer=null)},setVideoDisplayBase:function(e){g.initialized&&(this.displayBase=e,this.enabled=!0)},_purgeLoadedAds:function(){this._ads[g.PREROLL].length=0,this._ads[g.MIDROLL].length=0,this._ads[g.POSTROLL].length=0},_fireAdStopped:function(){h.log("_fireAdStopped"),this.eAdStopped.dispatch()},_handleAdReset:function(){switch(this._state){case p.CREATING_NEW_CONTEXT:this._createNewContext();break;case p.STOPPING_ADS:this._fireAdStopped();break;default:h.debug("_handleAdReset","unknown or unexpected state '"+this._state+"'!")}this._state=p.READY},_disposeCurrentContext:function(){h.log("_disposeCurrentContext"),this._listen(!1),this._fwContext.dispose(),this._fwContext=null,this._handleAdReset()},_reset:function(){h.log("_reset"),this._disposeAdTimer(),this._purgeLoadedAds(),this.currentAdType=g.PREROLL,this._fwContext?this._currentSlot?this._currentSlot.stop():this._disposeCurrentContext():this._handleAdReset()},_createNewContext:function(){h.log("_createNewContext");var e=this._catalogEntry;if(e.isAdSensitive())return h.log("catalogEntry specified 'isAdSensitive'; skipping ad context creation."),void this._adError(d.AD_SKIPPED_DUE_TO_SENSITIVITY);var t=this.getConfigProperty("adNetworkId"),n=e.getTrt(),i=r.empty(this._adServerInfo.adVideoAssetId)?e.getId():s.stringReplace(this._adServerInfo.adVideoAssetId,e,!1);this._fwContext=this._freewheel.newContext(),this._fwContext.setProfile(t+":turner_html5"),this._fwContext.setVideoAsset(i,n),this._fwContext.setSiteSection(this._adSection),this._fwContext.registerVideoDisplayBase(this.displayBase);var o=this.getAdKeyValues();for(var a in o)r.hasOwn(o,a)&&this._fwContext.addKeyValue(a,o[a]);this._listen(!0),this._fwContext.submitRequest()},_listen:function(e){var t=this._fwContext;if(t&&this._isListening!==e){this._isListening=e;var n=e?t.addEventListener:t.removeEventListener;n.call(t,g.SDK.EVENT_REQUEST_COMPLETE,this._onRequestComplete),n.call(t,g.SDK.EVENT_SLOT_STARTED,this._onSlotStarted),n.call(t,g.SDK.EVENT_SLOT_ENDED,this._onSlotEnded),n.call(t,g.SDK.EVENT_CONTENT_VIDEO_PAUSE_REQUESTED,this._onContentPauseRequested),n.call(t,g.SDK.EVENT_CONTENT_VIDEO_RESUME_REQUESTED,this._onContentResumeRequested),n.call(t,g.SDK.EVENT_AD_IMPRESSION,this._onAdStart),n.call(t,g.SDK.EVENT_AD_IMPRESSION_END,this._onAdEnd),n.call(t,g.SDK.EVENT_AD_CLICK,this._onAdClick),n.call(t,g.SDK.EVENT_ERROR,this._onAdError)}},loadAds:function(e){h.log("loadAds"),this._catalogEntry=e,this._state=p.CREATING_NEW_CONTEXT,this._reset()},stop:function(){h.log("stop"),this._state=p.STOPPING_ADS,this._reset()},dispose:function(){h.log("dispose"),this.stop(),this._freewheel=null},_onRequestComplete:function(e){if(h.log("_onRequestComplete",e),e&&e.success)for(var t=e.target.getTemporalSlots(),n=0,i=t.length;i>n;++n){var r=t[n],s=r.getTimePositionClass();switch(s){case g.PREROLL:case g.MIDROLL:case g.POSTROLL:this._ads[s].push(r)}}else h.debug("_onRequestComplete","No ad event or ad request was unsuccessful.");this._createMidrollsData(),this.eAdReady.dispatch(),this.playPreroll()},_createMidrollsData:function(){var e={},t=this._ads[g.MIDROLL];r.each(t,function(t,n){var i=t.getTimePosition();i>=0&&(e[i]=n)}),this._midrolls=e},getMidrolls:function(){return r.extend({},this._midrolls)},_onSlotStarted:function(e){h.log("_onSlotStarted",e.type,e.target,e.slot)},_playSlot:function(e){this._currentSlot=e,this._currentSlot.play()},_continuePlayingSlots:function(e){var t=this._ads[e];return t&&t.length&&(t.shift(),t.length)?(this._playSlot(t[0]),!0):!1},_onSlotEnded:function(e){if(h.log("_onSlotEnded",e.type,e.target,e.slot),this._currentSlot=null,this._state!==p.READY)return h.log("_onSlotEnded","short-circuit because state is "+this._state),void this._disposeCurrentContext();var t=e.slot.getTimePositionClass();switch(t){case g.PREROLL:this._continuePlayingSlots(t)||this.onPrerollCompleted();break;case g.MIDROLL:this.onMidrollCompleted();break;case g.POSTROLL:this._continuePlayingSlots(t)||this.onPostrollCompleted()}},_onContentPauseRequested:function(e){h.log("_onContentPauseRequested",e.type,e.target,e.success)},_onContentResumeRequested:function(e){h.log("_onContentResumeRequested",e.type,e.target,e.slot)},_onAdStart:function(e){h.log("_onAdStart",e.type,e.target,e.adInstance)},_onAdEnd:function(e){h.log("_onAdEnd",e.type,e.target,e.adInstance)},_onAdClick:function(e){h.log("_onAdClick",e);var t=e.adInstance;if(t){var n=t.getEventCallbackUrls(g.SDK.EVENT_AD_CLICK,g.SDK.EVENT_TYPE_CLICK);h.log("_onAdClick","callbackUrls:",n),n&&n.length&&this._emitAdClick({url:n[0]})}},_onAdError:function(e){return h.debug("_onAdError",e),r.isObject(e)?void this._emitAdError({errorMessage:d.AD_EXISTS_BUT_FAILED,errors:e.errors}):void h.warn("_onAdError did not receive an object; cannot report an error")},playPreroll:function(){h.log("playPreroll"),this.currentAdType=g.PREROLL,this._adPlay(g.PREROLL)},onPrerollCompleted:function(){h.log("onPrerollCompleted"),this._adEnd()},playMidroll:function(e){h.log("playMidroll"),this.currentAdType=g.MIDROLL,this._adPlay(g.MIDROLL,e)},onMidrollCompleted:function(){h.log("onMidrollCompleted"),this._adEnd()},playPostroll:function(){h.log("playPostroll"),this.currentAdType=g.POSTROLL,this._adPlay(g.POSTROLL)},onPostrollCompleted:function(){h.log("onPostrollCompleted"),this._adEnd()},_adPlay:function(e,t){t=t||0,h.log("_adPlay",e);var n=this._catalogEntry;if(n.isAdSensitive())return h.debug("catalogEntry specified 'isAdSensitive'; skipping ad play."),void this._adError(d.AD_SKIPPED_DUE_TO_SENSITIVITY);var i=this._ads[e];if(!i.length)return h.debug("no slots provided for the ad type: "+e),void this._adError(d.AD_TYPE_NOT_TRAFFICKED);if(0>t||i.length<=t)return h.debug("no slot at index '"+t+"' provided for the ad type: "+e),void this._adError(d.NO_AD_PLAYED_AT_AD_SPOT);var r=i[t];return r&&0!==r.getAdCount()&&0!==r.getTotalDuration()?(this._currentSlot=r,this.currentAdId=r.getCustomId(),this.currentAdDuration=Number(r.getTotalDuration()),this._adProgress=0,this._updateAdTimer(r),this._emitAdPlay(),void this._playSlot(r)):(h.debug("no ad provided for the slot for ad type: "+e),void this._adError(d.NO_AD_PLAYED_AT_AD_SPOT))},_adEnd:function(){h.log("_adEnd"),this._emitAdEnd(),this._cleanup()},_adError:function(e){h.debug("_adError",e),this._emitAdError({errorMessage:e}),this._cleanup()},_cleanup:function(){this._disposeAdTimer(),this.currentAdId=""},onAdPlayhead:function(e,t){this.eAdPlayhead.dispatch(e,t)},_convertAdTypeFromImpl:function(e){switch(e){case g.PREROLL:return c.PREROLL;case g.MIDROLL:return c.MIDROLL;case g.POSTROLL:return c.POSTROLL}},getCurrentAdType:function(){return this._convertAdTypeFromImpl(this.currentAdType)},_convertVideoStateToImpl:function(e){switch(e){case u.PLAYING:return g.VIDEO_PLAYING;case u.PAUSED:return g.VIDEO_PAUSED;case u.STOPPED:return g.VIDEO_STOPPED;case u.COMPLETED:return g.VIDEO_COMPLETED}},setVideoState:function(e){if(this._super(e),this._fwContext){var t=this._convertVideoStateToImpl(e);t&&this._fwContext.setVideoState(t)}},getAdAnalyticsData:function(){var e={};if(!this._fwContext)return e;var t=this._fwContext.getTemporalSlots();return r.each(t,function(t,n){var i="temporal_"+n;e[i]=this._getDataForSlot(t)},this),e},_getDataForSlot:function(e){var t={slotId:e.getCustomId(),adType:this._convertAdTypeFromImpl(e.getTimePositionClass()),position:e.getTimePosition(),category:e.getType(),duration:e.getTotalDuration(),adCount:e.getAdCount(),adInstances:this._getAdAnalyticsForSlot(e)};return t},getAdAnalyticsDataForCurrentSlot:function(){return this._currentSlot?{adInstances:this._getAdAnalyticsForSlot(this._currentSlot)}:void 0},_getAdAnalyticsForSlot:function(e){var t=e.getAdInstances();return r.map(t,this._getDataForAdInstance,this)},_getDataForAdInstance:function(e){var t={adId:e.getAdId()},n=e.getEventCallbackUrls(g.SDK.EVENT_AD_CLICK,g.SDK.EVENT_TYPE_CLICK);t.clickUrl=n.length?n[0]:"";var i=e.getActiveCreativeRendition();if(i&&r.isFunc(i.getPrimaryCreativeRenditionAsset)){var s=i.getPrimaryCreativeRenditionAsset();s&&(t.assetUrl=s.getUrl(),t.contentType=s.getContentType())}return t}});g.PREROLL=null,g.MIDROLL=null,g.POSTROLL=null,n.exports=g}),define("html5/ads/dfpimpl",["require","exports","module","html5/ads/baseimpl","cvp/utils","cvp/utils/configutils","cvp/errors","cvp/log","html5/ads/adtypes"],function(e,t,n){var i=e("html5/ads/baseimpl"),r=e("cvp/utils"),s=e("cvp/utils/configutils"),o=e("cvp/errors"),a=e("cvp/log"),l=e("html5/ads/adtypes"),c=o.ErrorMessage,u=a.getLogger("DFPImpl"),d=i.extend({init:function(){u.debug("Instantiating"),this._super.apply(this,arguments),this.enabled=!1,this._loader=new window.google.ima.AdsLoader,this._loader.addEventListener(window.google.ima.AdsLoadedEvent.Type.ADS_LOADED,r.bind(this._onAdsLoaded,this)),this._loader.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,r.bind(this._onAdLoadError,this))},setVideoDisplayBase:function(e){u.debug("setVideoDisplayBase",e),r.undef(window.google)||r.undef(window.google.ima.AdsLoader)||(this.displayBase=e,this.enabled=!0,u.debug("setVideoDisplayBase","videoDisplayBase","enabling"))},loadAds:function(e){this._catalogEntry=e,this.playPreroll()},playPreroll:function(){var e=this._catalogEntry.getAdUrl("preroll"),t=this._constructAdUrl(e,this._catalogEntry);this.currentAdType=d.PREROLL,this.loadAds(t)},playPostroll:function(){var e=this._catalogEntry.getAdUrl("postroll"),t=this._constructAdUrl(e,this._catalogEntry);this.currentAdType=d.POSTROLL,this.loadAds(t)},_convertAdTypeFromImpl:function(e){switch(e){case d.PREROLL:return l.PREROLL;case d.POSTROLL:return l.POSTROLL}},getCurrentAdType:function(){return this._convertAdTypeFromImpl(this.currentAdType)},_loadAdUrl:function(e){u.debug("_loadAdUrl - adTag",e);var t={adTagUrl:e,adType:"video"};this._loader.requestAds(t)},_constructAdUrl:function(e,t){var n="",i=this.getConfigProperty("adServerRootUrl");n=r.empty(e)?i:r.isRelative(e)?this._addToTag(i,e):e;var o=this.getAdKeyValues();for(var a in o)if(r.hasOwn(o,a)){var l=a+"="+this._keyValues[a];n=this._addToTag(n,l)}return n=s.stringReplace(n,t)},_addToTag:function(e,t){if(!e)return t;var n=";";return";"===e.charAt(e.length-1)&&(n=""),e+n+t},_onAdsLoaded:function(e){u.debug("_onAdsLoaded");var t=e.getAdsManager();t.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,r.bind(this._onAdError,this)),t.addEventListener(window.google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,r.bind(this._onPauseRequested,this)),t.addEventListener(window.google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,r.bind(this._onResumeRequested,this));try{var n={restoreContentState:!1},i=document.getElementById(this.displayBase).getElementsByTagName("video")[0];
t.play(i,n),this._emitAdPlay()}catch(s){u.error("ad play error",s.toString()),this._emitAdError({errorMessage:c.AD_EXISTS_BUT_FAILED,errors:[s.toString()]})}},_onAdLoadError:function(){u.debug("_onAdLoadError"),this._emitAdError({errorMessage:c.AD_EXISTS_BUT_FAILED,errors:event.errors})},_onPauseRequested:function(){u.debug("_onPauseRequested")},_onResumeRequested:function(){u.debug("_onResumeRequested"),this._emitAdEnd()},_onAdError:function(e){u.debug("_onAdError",e.toString()),this._emitAdError({errorMessage:c.AD_EXISTS_BUT_FAILED,errors:[e.toString()]})}});d.PREROLL="dfpPreroll",d.POSTROLL="dfpPostroll",n.exports=d}),define("html5/ads/adserverproxy",["require","exports","module","Class","cvp/customevent","cvp/log","html5/ads/adtypes","html5/ads/videostates","html5/ads/freewheelimpl","html5/ads/dfpimpl","cvp/errors"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("cvp/log"),o=e("html5/ads/adtypes"),a=e("html5/ads/videostates"),l=e("html5/ads/freewheelimpl"),c=e("html5/ads/dfpimpl"),u=e("cvp/errors"),d=u.ErrorMessage,h=s.getLogger("AdServerProxy"),p=i.extend({init:function(e){return this._adPolicy=e,this.eAdPlay=new r,this.eAdPlayhead=new r,this.eAdEnd=new r,this.eAdError=new r,this.eAdClick=new r,this.eAdReady=new r,this.eAdStopped=new r,this._adServerType=this._adPolicy.ads.attr.type.toLowerCase(),this._adServer=this._createImpl(),this._adServer?void this._listen(!0):(h.warn("Unable to create ad server impl."),void this._onAdError(d.AD_SERVER_NOT_CONFIGURED))},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._adServer.eAdPlay[t](this._onAdPlay,this),this._adServer.eAdPlayhead[t](this._onAdPlayhead,this),this._adServer.eAdEnd[t](this._onAdEnd,this),this._adServer.eAdError[t](this._onAdError,this),this._adServer.eAdClick[t](this._onAdClick,this),this._adServer.eAdReady[t](this._onAdReady,this),this._adServer.eAdStopped[t](this._onAdStopped,this)}},_createImpl:function(){var e=this._adServerType;switch(e){case"freewheel":return new l(this._adPolicy);case"dfp":return new c(this._adPolicy);default:return null}},setAdSection:function(e){this._adServer&&this._adServer.setAdSection(e)},getAdSection:function(){return this._adServer?this._adServer.getAdSection():void 0},setAdKeyValue:function(e,t){this._adServer&&this._adServer.setAdKeyValue(e,t)},getAdKeyValue:function(e){return this._adServer?this._adServer.getAdKeyValue(e):void 0},getAdKeyValues:function(){return this._adServer?this._adServer.getAdKeyValues():void 0},clearAdKeyValues:function(){this._adServer&&this._adServer.clearAdKeyValues()},setVideoState:function(e){this._adServer&&this._adServer.setVideoState(e)},setVideoStatePlaying:function(){this.setVideoState(a.PLAYING)},setVideoStatePaused:function(){this.setVideoState(a.PAUSED)},setVideoStateStopped:function(){this.setVideoState(a.STOPPED)},setVideoStateCompleted:function(){this.setVideoState(a.COMPLETED)},getVideoState:function(){return this._adServer?this._adServer.getVideoState():void 0},setVideoDisplayBase:function(e){this._adServer&&this._adServer.setVideoDisplayBase(e)},isEnabled:function(){return this._adServer?this._adServer.enabled:!1},playPreroll:function(){this._adServer&&this._adServer.playPreroll()},getMidrolls:function(){return this._adServer?this._adServer.getMidrolls():void 0},playMidroll:function(e){this._adServer&&this._adServer.playMidroll(e)},playPostroll:function(){this._adServer&&this._adServer.playPostroll()},loadAds:function(e){this._adServer&&this._adServer.loadAds(e)},stop:function(){this._adServer&&this._adServer.stop()},dispose:function(){this._adServer&&(this._listen(!1),this._adServer.dispose(),this._adServer=null)},getCurrentAdId:function(){return this._adServer?this._adServer.getCurrentAdId():""},getCurrentAdDuration:function(){return this._adServer?this._adServer.getCurrentAdDuration():0},getCurrentAdType:function(){return this._adServer?this._adServer.getCurrentAdType():void 0},getAdAnalyticsData:function(){return this._adServer?this._adServer.getAdAnalyticsData():void 0},getAdAnalyticsDataForCurrentSlot:function(){return this._adServer?this._adServer.getAdAnalyticsDataForCurrentSlot():void 0},_onAdPlay:function(e){h.debug("_onAdPlay",e.adType),this.eAdPlay.dispatch(e)},_onAdPlayhead:function(e,t){this.eAdPlayhead.dispatch(e,t)},_onAdEnd:function(e){h.debug("_onAdEnd",e.adType),this.eAdEnd.dispatch(e)},_onAdError:function(e){h.debug("_onAdError",e.adType),this.eAdError.dispatch(e)},_onAdClick:function(e){h.debug("_onAdClick",e.adType,e.url),this.eAdClick.dispatch(e.url)},_onAdReady:function(){h.log("_onAdReady"),this.eAdReady.dispatch()},_onAdStopped:function(){h.log("_onAdStopped"),this.eAdStopped.dispatch()}});p.PREROLL=o.PREROLL,p.MIDROLL=o.MIDROLL,p.POSTROLL=o.POSTROLL,n.exports=p}),define("html5/player/controller",["require","exports","module","Class","cvp/static","cvp/utils","cvp/utils/commandqueue","cvp/customevent","cvp/log","html5/player/videoplayer","html5/ads/adserverproxy"],function(e,t,n){var i=e("Class"),r=e("cvp/static"),s=e("cvp/utils"),o=e("cvp/utils/commandqueue"),a=e("cvp/customevent"),l=e("cvp/log"),c=e("html5/player/videoplayer"),u=e("html5/ads/adserverproxy"),d=l.getLogger("PlayerController"),h="",p="AD",g="CONTENT",f=0,m=1,_=2,v="play",y="replay",C=0,b=i.extend({init:function(e,t){this._videoBegetter=e,this._autostart="autostart"in t.configInfo?!!t.configInfo.autostart:!1;var n="controls"in t.configInfo?!!t.configInfo.controls:!0;this._commandQ=new o,this._stoppingQ=new o;var i=t.params;this._elementId=i.id,this._videoElement=e.getElement(),e.setControls(n),this._videoPlayer=new c(this._videoElement,{config:t,containerElement:"player_container",elementId:this._elementId,width:i.width,height:i.height,controls:n,autostart:this._autostart}),this._adProxy=new u(t.adPolicy),this._listen(!0),this._state=f,this._listeningForVideoElementActivation=!1,this._listeningForStart=!1,this._listeningForStop=!1,this._currentContentId="",this._contentQueue=[],this._seekTo=0,this._triggeredAd=!1,this._contentStarted=!1,this._fullscreen=!1,this._queueAutoplay=!0,this._metadataFired=!1,this._playEventQueue=[],this.eRendered=new a,this.eFullscreenChange=new a,this.eFullscreenError=new a,this.ePlayerPaused=new a,this.ePlayerMuted=new a,this.ePlayerStopped=new a,this.eContentMetadata=new a,this.eContentBegin=new a,this.eContentPlay=new a,this.eContentPause=new a,this.eContentEnd=new a,this.eContentComplete=new a,this.eContentReplay=new a,this.eContentPlayhead=new a,this.eContentSeek=new a,this.eContentSeekEnd=new a,this.eContentBuffering=new a,this.eContentQueue=new a,this.eContentQueueAutoplay=new a,this.eContentVolume=new a,this.eContentError=new a,this.eContentResize=new a,this.eContentStart=new a,this.eAdPlayhead=new a,this.eAdPlay=new a,this.eAdEnd=new a,this.eAdError=new a,this.eAdSensitive=new a,this.eAdClick=new a},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._videoPlayer.eRendered[t](this._onRendered,this),this._videoPlayer.eFullscreenChange[t](this._onFullscreenChange,this),this._videoPlayer.eFullscreenError[t](this._onFullscreenError,this),this._videoPlayer.ePlayerPaused[t](this._onPlayerPaused,this),this._videoPlayer.ePlayerMuted[t](this._onPlayerMuted,this),this._videoPlayer.ePlayerStopped[t](this._onPlayerStopped,this),this._videoPlayer.eContentMetadata[t](this._onContentMetadata,this),this._videoPlayer.eContentPlay[t](this._onContentPlay,this),this._videoPlayer.eContentPause[t](this._onContentPause,this),this._videoPlayer.eContentEnd[t](this._onContentEnd,this),this._videoPlayer.eContentPlayhead[t](this._onContentPlayhead,this),this._videoPlayer.eContentSeek[t](this._onContentSeek,this),this._videoPlayer.eContentSeekEnd[t](this._onContentSeeked,this),this._videoPlayer.eContentBuffering[t](this._onContentBuffering,this),this._videoPlayer.eContentVolume[t](this._onContentVolume,this),this._videoPlayer.eContentError[t](this._onContentError,this),this._videoPlayer.eContentResize[t](this._onContentResize,this),this._adProxy.eAdPlayhead[t](this._onAdPlayhead,this),this._adProxy.eAdPlay[t](this._onAdPlay,this),this._adProxy.eAdEnd[t](this._onAdEnd,this),this._adProxy.eAdError[t](this._onAdError,this),this._adProxy.eAdClick[t](this._onAdClick,this),this._adProxy.eAdReady[t](this._onAdReady,this),this._adProxy.eAdStopped[t](this._onPlayerStopped,this)}},render:function(e){this._adProxy.setVideoDisplayBase(e),this._videoPlayer.render(e)},remove:function(){this._videoPlayer.remove()},dispose:function(){d.log("dispose"),this.stop(),this._commandQ.clear(),this._commandQ=null,this._stoppingQ.clear(),this._stoppingQ=null,this._listenForVideoElementActivation(!1),this._listenForStart(!1),this._listen(!1),this._adProxy.dispose(),this._adProxy=null,this._videoPlayer.dispose(),this._videoPlayer=null,this._videoBegetter.dispose(),this._videoBegetter=null},_onRendered:function(e){d.log("_onRendered",e),this._commandQ.execute(),this._commandQ.clear(),this.eRendered.dispatch()},_listenForVideoElementActivation:function(e){if(this._listeningForVideoElementActivation!==e){this._listeningForVideoElementActivation=e;var t=e?"addListener":"removeListener";this._videoBegetter.eActivate[t](this._onVideoElementActivation,this)}},_onVideoElementActivation:function(){switch(d.log("_onVideoElementActivation"),this._listenForVideoElementActivation(!1),this._shimPurpose){case v:this._playMedia();break;case y:this.replay()}},_listenForStart:function(e){if(this._listeningForStart!==e){this._listeningForStart=e;var t=e?"addListener":"removeListener";this._videoPlayer.eContentPlayhead[t](this._onContentStarted,this)}},play:function(e,t){return d.log("play",e.getId()),this._catalogEntry=e,this._playOptions=t,this._state!==f?(this._stoppingQ.clear(),this._stoppingQ.push(this._play,this),void this.stop()):void this._play()},_play:function(){var e=this._catalogEntry;return d.log("_play",e.getId()),this._triggeredAd=!1,this._contentStarted=!1,e.isAdSensitive()&&this._onAdSensitive(e.getId()),this._videoPlayer.rendered()?(this._videoBegetter.setPoster(this._getPosterImageForPlayer()),this._autostart&&this._videoBegetter.isPrimed()?(d.debug("_play","autostart enabled and video element is primed; immediate play"),this._listenForVideoElementActivation(!1),this._playMedia()):(d.debug("_play","video element is NOT primed; deferred play via shim"),this._videoPlayer.removePlayerListeners(),this._shimPurpose=v,this._listenForVideoElementActivation(!0),this._videoBegetter.shim({autostart:this._autostart})),void(this._autostart=!0)):(d.debug("videoPlayer is not rendered; deferring play()"),void this._commandQ.push(this._play,this))},_rewind:function(){var e=this._videoPlayer;e.removePlayerListeners(),e.pause(),this._videoBegetter.setPoster(this._getPosterImageForPlayer()),this._shimPurpose=y,this._listenForVideoElementActivation(!0),this._videoBegetter.shim({autostart:!1});var t=this._videoElement;t.addEventListener("loadedmetadata",function n(){t.removeEventListener("loadedmetadata",n,!1),e.exitFullscreen()},!1),this._state=f},replay:function(){d.log("replay");var e=this._elementId,t=this._catalogEntry;if(!t)return void d.warn("replay","No previous content entry to replay!");var n=this._playOptions,i=t.getId();d.log("request to replay contentId '"+i+"'");var o=r.onCallback(e,["onContentReplayRequest",e,i,n]);return o===!1?(d.debug("user CB canceled replay request"),void this._rewind()):(s.isObject(o)&&(n=o),this.eContentReplay.dispatch(i,n),void this._play())},playNextInQueue:function(){if(!this._contentQueue.length)return void d.warn("playNextInQueue","Content queue is empty!");var e=this._contentQueue.shift();this.eContentQueue.dispatch(this.getQueue()),this.play(e.entry,e.options)},_getPosterImageForPlayer:function(){return this._catalogEntry.getImageForDimensions(this._videoPlayer.getWidth(),this._videoPlayer.getHeight())},_playMedia:function(){d.log("_playMedia"),this._state=_,this._metadataFired=!1,this._onContentBegin(this._catalogEntry.getId()),this._adProxy.isEnabled()?(this._videoPlayer.hideControls(),this._adProxy.loadAds(this._catalogEntry)):this._playContent()},_playContent:function(){d.log("_playContent"),this._listenForStart(!0),this._adProxy.setVideoStatePlaying(),this._playContentTime=s.now(),this._videoPlayer.showControls(),this._videoPlayer.play(this._catalogEntry)},pause:function(){this._videoPlayer.pause()},resume:function(){this._videoPlayer.resume()},reset:function(){this.clearRestorePlayhead(),this._listenForVideoElementActivation(!1),this._listenForStart(!1)},stop:function(){this._state!==m&&(this._state=m,this.reset(),this._mediaClass===p?(d.log("stopping ad"),this._adProxy.stop()):this._mediaClass===g?(d.log("stopping content"),this._videoPlayer.stop()):this._onPlayerStopped())},queue:function(e,t){d.debug("queue",e.getId()),this._contentQueue.push({entry:e,options:t}),this.eContentQueue.dispatch(this.getQueue())},dequeue:function(e){for(var t,n=this._contentQueue.length,i=n-1;i>=0;--i)if(t=this._contentQueue[i].entry,t.getId()===e){this._contentQueue.splice(i,1);break}this._contentQueue.length!==n&&this.eContentQueue.dispatch(this.getQueue())},emptyQueue:function(){this._contentQueue.length&&(this._contentQueue.length=0,this.eContentQueue.dispatch(this.getQueue()))},setQueueAutoplay:function(e){this._queueAutoplay=e,this.eContentQueueAutoplay.dispatch(this._queueAutoplay)},getQueue:function(){return s.map(this._contentQueue,function(e){return e.entry.getId()})},seek:function(e){this._contentStarted?this._videoPlayer.seek(e):this.setRestorePlayhead(e)},setRestorePlayhead:function(e){d.info("set restore playhead to "+e),this._seekTo=e},clearRestorePlayhead:function(){this._seekTo=0},resize:function(e,t){this._videoPlayer.resize(e,t)},goFullscreen:function(){this._videoPlayer.goFullscreen()},setVolume:function(e){this._videoPlayer.setVolume(e)},getVolume:function(){return this._videoPlayer.getVolume()},mute:function(){this._videoPlayer.mute()},unmute:function(){this._videoPlayer.unmute()},isMuted:function(){this._videoPlayer.isMuted()},setAdSection:function(e){this._adProxy.setAdSection(e)},getAdSection:function(){return this._adProxy.getAdSection()},setAdKeyValue:function(e,t){this._adProxy.setAdKeyValue(e,t)},getAdKeyValue:function(e){return this._adProxy.getAdKeyValue(e)},getAdKeyValues:function(){return this._adProxy.getAdKeyValues()},clearAdKeyValues:function(){this._adProxy.clearAdKeyValues()},getCatalogEntry:function(){return this._catalogEntry},getPlayerDimensions:function(){var e=this._videoPlayer.getDimensions();return this._fullscreen&&s.extend(e,{width:window.screen.width,height:window.screen.height}),e},getAdId:function(){return this._adProxy.currentAdId},getAdType:function(){return this._adProxy.getCurrentAdType()},_onFullscreenChange:function(e){if(d.log("_onFullscreenChange"),this._fullscreen=e,this.eFullscreenChange.dispatch(this._currentContentId,e),this._mediaClass===g){var t=this.getPlayerDimensions();this._onContentResize(t.width,t.height,e)}},_onFullscreenError:function(){d.log("_onFullscreenError"),this.eFullscreenError.dispatch()},_onPlayerPaused:function(e,t,n){d.log("_onPlayerPaused",e,t,n),this.ePlayerPaused.dispatch(e,t,n)},_onPlayerMuted:function(e){d.log("_onPlayerMuted",e),this.ePlayerMuted.dispatch(e)},_onPlayerStopped:function(){d.log("_onPlayerStopped"),this._state=f,this._stoppingQ.execute(),this._stoppingQ.clear()},_onContentMetadata:function(e,t,n,i){d.log("_onContentMetadata",e,t,n,i),this._currentContentDuration=t,this._metadataFired||this.eContentMetadata.dispatch(e,t,n,i),this._dumpPlayEventQueue()},_onContentBegin:function(e){d.log("_onContentBegin",e),this._currentContentId=e,C=0,this.eContentBegin.dispatch(e,this._playOptions)},_dumpPlayEventQueue:function(){if(this._metadataFired=!0,0!==this._playEventQueue.length){for(var e=0,t=this._playEventQueue.length;t>e;++e)this._fireContentPlay.apply(this,this._playEventQueue[e]);this._playEventQueue.length=0}},_fireContentPlay:function(e,t){this.eContentPlay.dispatch(e,t)},_onContentPlay:function(e,t){d.log("_onContentPlay",e,t),this._mediaClass=g,this._contentStarted=!1,this._metadataFired?this._fireContentPlay(e,t):this._playEventQueue.push(arguments)},_onContentPause:function(e,t){d.log("_onContentPause",e,t),this.eContentPause.dispatch(e,t),t?this._adProxy.setVideoStatePaused():this._adProxy.setVideoStatePlaying()},_onContentEnd:function(e){d.log("_onContentEnd",e),this._mediaClass=h,this.eContentEnd.dispatch(e),this._adProxy.setVideoStateStopped(),this._adProxy.isEnabled()?(this._videoPlayer.hideControls(),this._adProxy.playPostroll(this._catalogEntry)):this._onContentComplete.apply(this,arguments)},_continueAutoplay:function(){this._queueAutoplay&&this._contentQueue.length?this.playNextInQueue():this._rewind()},_onContentComplete:function(){d.log("_onContentComplete"),this._isPlaying=!1,this.eContentComplete.dispatch(this._catalogEntry.getId()),this._videoPlayer.showControls(),this._adProxy.setVideoStateCompleted(),this._continueAutoplay()},_onContentStarted:function(e,t){if(d.log("_onContentStarted"),t>0){this._listenForStart(!1),this._contentStarted=!0;var n=Math.ceil((s.now()-this._playContentTime)/1e3);this.eContentStart.dispatch(this._catalogEntry.getId(),n),this._seekAhead()}},_seekAhead:function(){this._seekTo&&(d.info("restoring playhead to "+this._seekTo),this.seek(this._seekTo),this.clearRestorePlayhead())},_onContentPlayhead:function(e,t,n){this._dumpPlayEventQueue(),this._currentContentPlayhead=t,this.eContentPlayhead.dispatch(e,t,n)},_onAdReady:function(){d.log("_onAdReady"),this._midrollMap=this._adProxy.getMidrolls(),s.isSimpleObject(this._midrollMap)&&!s.isEmpty(this._midrollMap)&&(d.log("_onAdReady - midrolls: ",s.keys(this._midrollMap)),this._videoPlayer.eContentPlayhead.addListener(this._onPlayheadForMidrolls,this))},_onPlayheadForMidrolls:function(e,t){var n=Math.floor(t);n in this._midrollMap&&(d.log("_onPlayheadForMidrolls","playing midroll at "+n+" of midrolls: ",s.keys(this._midrollMap)),this.setRestorePlayhead(t),this._currentMidroll=this._midrollMap[n],delete this._midrollMap[n],this._playMidroll(this._currentMidroll))},_playMidroll:function(e){d.log("_playMidroll"),this._adProxy.setVideoStatePaused(),this._adProxy.playMidroll(e)},_resumeFromMidroll:function(){d.log("_resumeFromMidroll"),this._playContent()},_onContentSeek:function(e,t,n,i){d.log("_onContentSeek",e,t,n,i),this.eContentSeek.dispatch(e,t,n,i)},_onContentSeeked:function(e,t,n,i){d.log("_onContentSeeked",e,t,n,i),this.eContentSeekEnd.dispatch(e,t,n,i)},_onContentBuffering:function(e,t){d.log("_onContentBuffering"),this.eContentBuffering.dispatch(e,t)},_onContentVolume:function(e,t){d.log("_onContentVolume"),this.eContentVolume.dispatch(e,t)},_onContentError:function(e,t){d.log("_onContentError",e,t),this.eContentError.dispatch(e,t),this._continueAutoplay()},_onContentResize:function(e,t,n){d.log("_onContentResize",e,t,n),this.eContentResize.dispatch(e,t,n)},_onAdSensitive:function(e){d.debug("_onAdSensitive",e),this.eAdSensitive.dispatch(e)},_onAdPlayhead:function(e,t){this._currentAdPlayhead=e,this._currentAdDuration=t,this.eAdPlayhead.dispatch(e,t,C)},_onAdPlay:function(e){var t=e.token,n=e.mode,i=e.id,r=e.duration,s=e.adType,o=e.adAnalyticsData;d.debug("_onAdPlay","event",e),this._triggeredAd=!0,this._contentStarted=!1,this._mediaClass=p,this._videoPlayer.removePlayerListeners(),this.eAdPlay.dispatch(t,n,i,r,C,s,o)},_onAdEnd:function(e){var t=e.token,n=e.mode,i=e.id,r=e.adType;d.debug("_onAdEnd","event",e),this._triggeredAd&&this.eAdEnd.dispatch(t,n,i,C,r),this._onAdComplete(r)},_onAdError:function(e){var t=e.adType,n=e.errors,i=e.errorMessage;d.debug("_onAdError","event",e),this.eAdError.dispatch(i,C,t,n),this._onAdComplete(t)},_onAdComplete:function(e){if(C+=1,this._triggeredAd=!1,this._mediaClass=h,this._state===m)return d.debug("_onAdComplete","halting further activities because stop() was called, resetting video player"),void this._videoPlayer.reset();switch(e){case u.PREROLL:this._playContent();break;case u.MIDROLL:this._resumeFromMidroll();break;case u.POSTROLL:this._onContentComplete(this._currentContentId);break;default:this._onContentError("Failed to determine adType!")}},_onAdClick:function(e){this.eAdClick.dispatch(e.url),this._videoPlayer.showControls()}});n.exports=b}),define("html5/player/instance",["require","exports","module","html5/shared/playerconfig","cvp/utils","html5/player/controller"],function(e,t,n){var i=e("html5/shared/playerconfig"),r=e("cvp/utils"),s=e("html5/player/controller"),o=function(e,t){var n=r.extend({},i);return r.extend(n.params,t.params),r.extend(n,t.configData),new s(e,n)};n.exports=o}),define("html5/tracking/trackingmanager",["require","exports","module","Class","cvp/customevent","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("cvp/log"),o=s.getLogger("TrackingManager"),a=i.extend({setLogger:function(e){this._logger=e},init:function(e){this.setLogger(e.logger||o),this._playerController=e.playerController,this._trackingInterval=0,this.eTrackingAdStart=new r,this.eTrackingAdComplete=new r,this.eTrackingAdError=new r,this.eTrackingAdProgress=new r,this.eTrackingAdCountdown=new r,this.eTrackingAdClick=new r,this.eTrackingContentBegin=new r,this.eTrackingContentPlay=new r,this.eTrackingContentStart=new r,this.eTrackingContentProgress=new r,this.eTrackingContentEnd=new r,this.eTrackingContentComplete=new r,this.eTrackingContentReplay=new r,this.eTrackingContentSeek=new r,this.eTrackingContentSeekEnd=new r,this.eTrackingContentSegmentPlay=new r,this.eTrackingContentSegmentComplete=new r,this.eTrackingFullscreen=new r,this.eTrackingMuted=new r,this.eTrackingPaused=new r,this.reset(),this._isListening=!1,this.listen(!0)},reset:function(){this._lastPlayhead=0,this._lastPercent=0,this._previousAdPlayhead=0,this._currentAdDuration=0,this._currentAdPlayhead=0,this._totalAdPlayTime=0,this._previousContentPlayhead=0,this._currentContentDuration=0,this._currentContentPlayhead=0,this._totalContentPlayTime=0,this._totalGrossPlayTime=0},dispose:function(){this.listen(!1),this._playerController=null,this._logger=null},getCatalogEntry:function(){return this._playerController.getCatalogEntry()},getPlayerDimensions:function(){return this._playerController.getPlayerDimensions()},getAdId:function(){return this._playerController.getAdId()},getAdType:function(){return this._playerController.getAdType()},getAdSection:function(){return this._playerController.getAdSection()},listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._playerController.eAdPlay[t](this._onTrackingAdStart,this),this._playerController.eAdEnd[t](this._onTrackingAdComplete,this),this._playerController.eAdError[t](this._onTrackingAdError,this),this._playerController.eAdPlayhead[t](this._onTrackingAdProgress,this),this._playerController.eAdPlayhead[t](this._onTrackingAdCountdown,this),this._playerController.eAdClick[t](this._onTrackingAdClick,this),this._playerController.eContentBegin[t](this._onTrackingContentBegin,this),this._playerController.eContentPlay[t](this._onTrackingContentPlay,this),this._playerController.eContentStart[t](this._onTrackingContentStart,this),this._playerController.eContentPlayhead[t](this._onTrackingContentProgress,this),this._playerController.eContentEnd[t](this._onTrackingContentEnd,this),this._playerController.eContentComplete[t](this._onTrackingContentComplete,this),this._playerController.eContentReplay[t](this._onTrackingContentReplay,this),this._playerController.eContentSeek[t](this._onTrackingContentSeek,this),this._playerController.eContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._playerController.eFullscreenChange[t](this._onTrackingFullscreen,this),this._playerController.ePlayerPaused[t](this._onTrackingPaused,this),this._playerController.ePlayerMuted[t](this._onTrackingMuted,this)}},_canEmitProgress:function(e,t){var n=this._trackingInterval;if(!n)return!1;var i=Math.floor(e),r=Math.floor(e/t*100),s=!1,o=this._intervalRegex.exec(n),a=Number(o[1]),l=o[2];return isNaN(t)&&"%"===l&&(a=30,l="s"),"s"===l&&(a>t?(a=50,l="%"):i!==this._lastPlayhead&&i%a===0&&(s=!0)),"%"===l&&r!==this._lastPercent&&100>r&&r%a===0&&(s=!0),s&&(this._lastPlayhead=i,this._lastPercent=r),s},_onTrackingAdStart:function(e,t,n,i,r,s,o){this._logger.log("_onTrackingAdStart",arguments),this._lastPlayhead=0,this._lastPercent=0,this._previousAdPlayhead=0,this._currentAdPlayhead=0,this._currentAdDuration=0;var a=this.getPlayerDimensions(),l=this.getCatalogEntry();this.eTrackingAdStart.dispatch({adTitle:n,adWidth:a.videoWidth,adHeight:a.videoHeight,adSection:this.getAdSection(),contentId:l.getId(),originId:l.getOriginId(),mediaUrl:l.getMediaUrl(),adType:s,adDuration:i,adBlock:r,totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime,adAnalyticsData:o})},_onTrackingAdComplete:function(e,t,n,i,r){this._logger.log("_onTrackingAdComplete",arguments);var s=this.getCatalogEntry();this.eTrackingAdComplete.dispatch({contentId:s.getId(),adTitle:n,adType:r,adBlock:i,totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingAdError:function(e,t,n,i){this._logger.log("_onTrackingAdError",arguments);var r=this.getCatalogEntry();this.eTrackingAdError.dispatch({contentId:r.getId(),errorMessage:e,adType:n,adBlock:t,errors:i})},_onTrackingAdProgress:function(e,t,n){this._currentAdPlayhead=e,this._currentAdDuration=t;var i=e-this._previousAdPlayhead;this._previousAdPlayhead=e,0>=i||i>=1.25||(this._totalAdPlayTime+=i,this._totalGrossPlayTime+=i,this._canEmitProgress(e,t)&&this.eTrackingAdProgress.dispatch({totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentAdPlayhead,adDuration:this._currentAdDuration,grossProgressMarker:0,adType:this.getAdType(),adBlock:n,adTotalPlayTime:this._totalAdPlayTime}))},_onTrackingAdCountdown:function(e,t){var n=Math.ceil(t-e);n>0&&n!==this._previousAdCountdown&&(this._previousAdCountdown=n,this.eTrackingAdCountdown.dispatch({adMode:"standard",secs:n}))},_onTrackingAdClick:function(e){this._logger.log("_onTrackingAdClick",arguments);var t=this.getCatalogEntry();this.eTrackingAdClick.dispatch({contentId:t.getId(),url:e})},_onTrackingContentBegin:function(e,t){this._logger.log("_onTrackingContentBegin",arguments),this.reset();var n=this.getCatalogEntry();this.eTrackingContentBegin.dispatch({contentId:n.getId(),playOptions:t,originId:n.getOriginId(),contentMode:n.getMode(),contentSource:n.getSource(),totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentPlay:function(){this._logger.log("_onTrackingContentPlay",arguments),this._lastPlayhead=0,this._lastPercent=0;var e=this.getCatalogEntry();this.eTrackingContentPlay.dispatch({contentId:e.getId(),originId:e.getOriginId(),mediaUrl:e.getMediaUrl(),length:e.getTrt(),grossLength:e.getTrt(),totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentStart:function(e,t){this._logger.log("_onTrackingContentStart",arguments);var n=this.getCatalogEntry();this.eTrackingContentStart.dispatch({contentId:n.getId(),originId:n.getOriginId(),mediaUrl:n.getMediaUrl(),joinTime:t,length:n.getTrt(),grossLength:n.getTrt(),totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentProgress:function(e,t,n){this._currentContentPlayhead=t,this._currentContentDuration=n;var i=t-this._previousContentPlayhead;if(this._previousContentPlayhead=t,!(0>=i||i>=1.25)&&(this._totalContentPlayTime+=i,this._totalGrossPlayTime+=i,this._canEmitProgress(t,n))){var r=this.getCatalogEntry(),s=this.getPlayerDimensions();this.eTrackingContentProgress.dispatch({contentId:r.getId(),originId:r.getOriginId(),playerWidth:s.width,playerHeight:s.height,percent:t/n*100,totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentContentPlayhead,progressMarker:0,grossProgressMarker:0,adTotalPlayTime:this._totalAdPlayTime})}},_onTrackingContentEnd:function(){this._logger.log("_onTrackingContentEnd",arguments);var e=this.getCatalogEntry();this.eTrackingContentEnd.dispatch({contentId:e.getId(),totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentContentPlayhead,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentComplete:function(){this._logger.log("_onTrackingContentComplete",arguments);var e=this.getCatalogEntry();this.eTrackingContentComplete.dispatch({contentId:e.getId(),percent:100,totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentContentPlayhead,progressMarker:0,grossProgressMarker:0,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentReplay:function(e,t){this._logger.log("_onTrackingContentReplay",arguments),this.eTrackingContentReplay.dispatch({contentId:e,additionalParams:t})},_onTrackingContentSeek:function(e,t,n,i){this._logger.log("_onTrackingContentSeek",arguments),this.eTrackingContentSeek.dispatch({contentId:e,previousPlayhead:t,newPlayhead:n,duration:i})},_onTrackingContentSeekEnd:function(e,t,n,i){this._logger.log("_onTrackingContentSeekEnd",arguments),this.eTrackingContentSeekEnd.dispatch({contentId:e,previousPlayhead:t,newPlayhead:n,duration:i})},_onTrackingFullscreen:function(e,t){this._logger.log("_onTrackingFullscreen",arguments),this.eTrackingFullscreen.dispatch({contentId:e,fullscreen:t})},_onTrackingMuted:function(e,t){this._logger.log("_onTrackingMuted",arguments),this.eTrackingMuted.dispatch({contentId:e,muted:t})},_onTrackingPaused:function(e,t,n){this._logger.log("_onTrackingPaused",arguments),this.eTrackingPaused.dispatch({contentId:e,playhead:t,paused:n})},_intervalRegex:/(\d+)([s%])?/,setTrackingInterval:function(e){if(!e)return void(this._trackingInterval=0);var t=this._intervalRegex.exec(String(e));if(!t)return void this._logger.error('setTrackingInterval param "'+e+'" did not match accepted regex');var n=t[1],i=t[2]||"%";n>100&&(i="s"),this._trackingInterval=n+i}});n.exports=a}),define("html5/tracking/aspentracking",["require","exports","module","Class","cvp/utils","cvp/log","html5/tracking/trackingmanager","html5/aspencontroller","cvp/errors"],function(e,t,n){var i=e("Class"),r=e("cvp/utils"),s=e("cvp/log"),o=e("html5/tracking/trackingmanager"),a=e("html5/aspencontroller"),l=e("cvp/errors"),c=s.getLogger("AspenTracking"),u="content",d="ad",h=i.extend({init:function(e){c.log("init"),this._playerController=e.playerController,this._cvpElementId=e.cvpElementId,this._trackingManager=new o({logger:s.getLogger("AspenTrackingManager"),playerController:this._playerController}),this._isListening=!1,this.listen(!0),a.isReady()?this.updateTrackingInterval():(this.setTrackingInterval("23"),this._watchAspenInit())},setTrackingInterval:function(e){c.log("setTrackingInterval",e),e=r.toInt(e)+"s",this._trackingManager.setTrackingInterval(e)},switchTrackingIntervalFor:function(e){var t;switch(e){case u:t=a.getConfig("progressReportInterval");break;case d:t=a.getConfig("adProgressReportInterval")}t&&(c.log("setting tracking interval for "+e+" to:",t),this.setTrackingInterval(t))},updateTrackingInterval:function(){c.log("updateTrackingInterval"),this._unwatchAspenInit(),this.switchTrackingIntervalFor(u)},_watchAspenInit:function(){a.eInitSuccess.addListener(this.updateTrackingInterval,this)},_unwatchAspenInit:function(){a.eInitSuccess.removeListener(this.updateTrackingInterval,this)},dispose:function(){c.log("dispose"),this._unwatchAspenInit(),this.listen(!1),this._trackingManager.dispose(),this._trackingManager=null},listen:function(e){if(c.log("listen",e),this._isListening===e)return void c.log("already "+(e?"":"not")+" listening");this._isListening=e;var t=e?"addListener":"removeListener";this._trackingManager.eTrackingAdStart[t](this._onTrackingAdStart,this),this._trackingManager.eTrackingAdComplete[t](this._onTrackingAdComplete,this),this._trackingManager.eTrackingAdProgress[t](this._onTrackingAdProgress,this),this._trackingManager.eTrackingAdError[t](this._onTrackingAdError,this),this._trackingManager.eTrackingContentBegin[t](this._onTrackingContentBegin,this),this._trackingManager.eTrackingContentStart[t](this._onTrackingContentStart,this),this._trackingManager.eTrackingContentProgress[t](this._onTrackingContentProgress,this),this._trackingManager.eTrackingContentEnd[t](this._onTrackingContentEnd,this),this._trackingManager.eTrackingContentComplete[t](this._onTrackingContentComplete,this),this._trackingManager.eTrackingContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._trackingManager.eTrackingPaused[t](this._onTrackingPaused,this)
},getCurrentPlayer:function(){return this._playerManager.getCurrentPlayer()},_onTrackingAdInfo:function(e){c.log("_onTrackingAdInfo"),a.send("adInfo",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adSection:e.adSection,adAssetId:e.adTitle,adSlotInfo:void 0})},_onTrackingAdError:function(e){c.log("_onTrackingAdError");var t=e.errorMessage,n=l.determineAdErrorCode(t);a.send("error",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adType:e.adType,adBlockId:String(e.adBlock),errorMessage:t,errorCode:n})},_onTrackingAdStart:function(e){c.log("_onTrackingAdStart"),a.send("adStart",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adType:e.adType,adBlockId:String(e.adBlock),adSection:e.adSection,adAssetId:e.adTitle,width:String(e.adWidth),height:String(e.adHeight),adDuration:String(e.adDuration),slotId:void 0,adInstances:void 0})},_onTrackingAdProgress:function(e){c.log("_onTrackingAdProgress"),a.send("adProgress",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adType:e.adType,adBlockId:String(e.adBlock),adPlayHead:Number(e.playheadTime).toFixed(3),adDuration:Number(e.adDuration).toFixed(3),adTimeSpent:Number(e.adTotalPlayTime).toFixed(3),slotId:void 0,adInstances:void 0})},_onTrackingAdComplete:function(e){c.log("_onTrackingAdComplete"),a.send("adStop",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),adType:e.adType,adBlockId:String(e.adBlock),adAssetId:e.adTitle,slotId:void 0})},_onTrackingContentBegin:function(e){c.log("_onTrackingContentBegin"),a.videoCount+=1,a.send("contentStart",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),originId:e.originId,playOptions:e.playOptions,mode:e.contentMode,propertyName:e.contentSource})},_onTrackingContentStart:function(e){c.log("_onTrackingContentStart"),a.send("contentPlay",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),originId:e.originId,contentType:e.contentType,duration:String(e.length),joinTime:String(e.joinTime),mediaPath:e.mediaUrl,bandwidth:void 0,serverIp:void 0,ccAvailable:void 0,dvrAvailable:void 0})},_onTrackingContentProgress:function(e){c.log("_onTrackingContentProgress");var t="totalPlayTime"in e&&"adTotalPlayTime"in e?((e.totalPlayTime||0)-(e.adTotalPlayTime||0)).toFixed(3):void 0;a.send("contentProgress",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),originId:e.originId,timeSpentBuffering:void 0,timeSpentPlaying:t,playHead:Number(e.playheadTime).toFixed(3),playerWidth:String(e.playerWidth),playerHeight:String(e.playerHeight),ccAvailable:void 0,ccEnabled:void 0,ccTrackLang:void 0,dvrAvailable:void 0,dvrEnabled:void 0,dvrWindow:void 0,dvrStart:void 0})},_onTrackingPaused:function(e){c.log("_onTrackingPaused"),a.send("contentPause",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),contentPlayHead:Number(e.playhead).toFixed(3),isPaused:String(e.paused)})},_onTrackingContentSeekEnd:function(e){c.log("_onTrackingContentSeekEnd"),a.send("contentSeek",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),seekFrom:Number(e.previousPlayhead).toFixed(3),seekTo:Number(e.newPlayhead).toFixed(3),dvrAvailable:void 0,dvrEnabled:void 0})},_onTrackingContentEnd:function(e){c.log("_onTrackingContentEnd"),a.send("contentStop",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount),playHead:Number(e.playheadTime).toFixed(3),segmentId:void 0})},_onTrackingContentComplete:function(e){c.log("_onTrackingContentComplete"),a.send("contentFinish",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(a.videoCount)})}});n.exports=h}),define("html5/player/videobegetter",["require","exports","module","Class","cvp/customevent","cvp/log","core/app","cvp/utils"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("cvp/log"),o=e("core/app"),a=e("cvp/utils"),l=s.getLogger("VideoBegetter"),c=["click","play"],u=i.extend({init:function(){l.log("init"),this._listening=!1,this._primed=!1,this._showControls=!0,this._videoElement=document.createElement("video"),this._onActivation=a.bind(this._onActivation,this),this.eActivate=new r},dispose:function(){l.log("dispose"),this.teardown(),this._videoElement=null},getElement:function(){return this._videoElement},isPrimed:function(){return this._primed},listen:function(e){if(e!==this._listening){l.log("listen",e),this._listening=e;for(var t=e?"addEventListener":"removeEventListener",n=0,i=c.length;i>n;++n)this._videoElement[t](c[n],this._onActivation,!0)}},setPoster:function(e){l.log('setPoster(url="'+e+'")');var t=this._videoElement;t.poster=o.BLANK_IMG_URL,null!=e&&(t.poster=e)},setControls:function(e){l.log('setControls(preferred="'+e+'")'),this._showControls=e,e||this.hideControls()},showControls:function(){return this._videoElement?this._showControls?(l.log("showControls","showing controls"),void(this._videoElement.controls=!0)):void l.log("showControls","disallowed by configuration"):void l.warn("showControls","no video element")},hideControls:function(){return this._videoElement?(l.log("hideControls","hiding controls"),void(this._videoElement.controls=!1)):void l.warn("hideControls","no video element")},prime:function(){if(l.log("prime"),this.isPrimed())return void this.listen(!1);this.listen(!0);var e=this._videoElement;this.showControls(),e.removeAttribute("src"),e.load()},shim:function(e){var t=a.extend({},e);l.log("shim",t),this.listen(!0);var n=this._videoElement;this.showControls(),n.removeAttribute("src"),n.src=o.BLANK_MP4_URL,null!=t.poster&&this.setPoster(t.poster),t.autostart&&(n.load(),n.play())},teardown:function(){l.log("teardown"),this.listen(!1)},_onFirstActivation:function(){l.log("_onFirstActivation"),this._primed||(this._primed=!0,this._videoElement.preload="metadata")},_onActivation:function(){l.log("_onActivation"),this.listen(!1),this.isPrimed()||this._onFirstActivation(),this.eActivate.dispatch()}});n.exports=u}),define("html5/manager",["require","exports","module","Class","cvp/customevent","cvp/ajax","cvp/utils","cvp/utils/jsonconverter","cvp/log","core/app","html5/bootstrapper","html5/aspencontroller","html5/cms","html5/player/instance","html5/tracking/trackingmanager","html5/tracking/aspentracking","html5/player/videobegetter"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("cvp/ajax"),o=e("cvp/utils"),a=e("cvp/utils/jsonconverter"),l=e("cvp/log"),c=e("core/app"),u=e("html5/bootstrapper"),d=e("html5/aspencontroller"),h=e("html5/cms"),p=e("html5/player/instance"),g=e("html5/tracking/trackingmanager"),f=e("html5/tracking/aspentracking"),m=e("html5/player/videobegetter"),_=l.getLogger(),v=i.extend({init:function(){this._configData={},this.ePlayerLoaded=new r,this.ePlayerLoadError=new r,this.ePlayerRendered=new r,this.eContentMetadata=new r,this.eContentBegin=new r,this.eContentPlay=new r,this.eContentPause=new r,this.eContentEnd=new r,this.eContentComplete=new r,this.eContentPlayhead=new r,this.eContentBuffering=new r,this.eContentQueue=new r,this.eContentQueueAutoplay=new r,this.eContentVolume=new r,this.eContentError=new r,this.eContentResize=new r,this.eContentEntryLoad=new r,this.eContentEntryLoadError=new r,this.eAdPlayhead=new r,this.eAdPlay=new r,this.eAdEnd=new r,this.eAdError=new r,this.eAdSensitive=new r,this.eTrackingAdStart=new r,this.eTrackingAdComplete=new r,this.eTrackingAdProgress=new r,this.eTrackingAdCountdown=new r,this.eTrackingAdClick=new r,this.eTrackingContentPlay=new r,this.eTrackingContentBegin=new r,this.eTrackingContentProgress=new r,this.eTrackingContentEnd=new r,this.eTrackingContentComplete=new r,this.eTrackingContentReplay=new r,this.eTrackingContentSeek=new r,this.eTrackingContentSeekEnd=new r,this.eTrackingFullscreen=new r,this.eTrackingMuted=new r,this.eTrackingPaused=new r,this._loadingEntryQueue={},this._params={}},load:function(e){this._videoBegetter=new m,this._videoBegetter.prime(),this._params=e;var t=e.flashVars;o.isSimpleObject(t)&&(e.site=t.site,e.profile=t.profile,e.context=t.context,e.contentId=t.contentId,e.containerUrl=t.containerUrl,e.configUrl=t.configUrl,e.aspenContext=t.aspenContext,e.dt=!!t.superduperdevtime,e.requestTimeout=o.toInt(t.requestTimeout),e.requestRetries=o.toInt(t.requestRetries),"autostart"in t&&(e.autostart=o.isFlagActive(t.autostart,!1)),"controls"in t&&(e.controls=o.isFlagActive(t.controls,!0))),e.requestTimeout&&(s.JSONP.requestTimeout=e.requestTimeout),e.requestRetries&&(s.JSONP.maxRetries=e.requestRetries);var n=this._calculateMappingUrl(this._params.site);return o.empty(n)?(_.error("Unable to calculate mapping file url. Failing."),void this._bootStrapFailure()):(this._bootStrapper=new u(n,this._params),this._bootStrapper.eSuccess.addListener(this._bootStrapSuccess,this),this._bootStrapper.eFailure.addListener(this._bootStrapFailure,this),this._bootStrapper.load(),void d.init({dt:this._params.dt,context:this._params.aspenContext||this._params.context,site:this._params.site}))},_calculateMappingUrl:function(e){if(o.empty(e))return null;var t=o.replaceExtension(c.MAPPING_FILE,"xml","json");return this._params.dt||(t=o.template(c.MAPPING_PATH,e)+t),t},_bootStrapSuccess:function(e){if(!e||!e.data)return _.error("MainController","Unable to retrieve config data - failing."),void this._bootStrapFailure();this._configData=e.data,_.debug("MainController","_bootStrapSuccess");var t={autostart:!1,controls:!0,muted:!1},n=this._configData.configInfo;if(n&&(o.each(t,function(e,t){n[e]=o.isFlagActive(n[e],t)}),"volume"in n)){var i=o.toInt(n.volume)/100;isFinite(i)&&(n.volume=Math.min(Math.max(i,0),1))}var r=this._params;"autostart"in r&&(this._configData.configInfo.autostart=r.autostart),"controls"in r&&(this._configData.configInfo.controls=r.controls),"iosAirplay"in r&&(this._configData.configInfo.iosAirplay=r.iosAirplay),this._playerController=new p(this._videoBegetter,{params:this._params,configData:this._configData}),this._aspenTracking=new f({playerController:this._playerController,cvpElementId:this.getCurrentPlayer()}),this._trackingManager=new g({playerController:this._playerController}),this.setTrackingInterval(this._configData.trackingPolicy.interval),this._cms=new h,this._cms.setDataUrl(this._configData.configInfo.dataSrc),this._cms.setMediaUrl(this._configData.configInfo.mediaSrc),this._listen(!0),function(e){var t=e&&e.adPolicy&&e.adPolicy.ads||{},n=e.configInfo||{},i=e.containerInfo||{},r={cvpElementId:i.elementName,adApi:t.apiUrl,adServerRootUrl:t.adServerRootUrl,adNetworkId:t.adNetworkId,adVideoNetworkId:t.adVideoNetworkId,adVideoAssetId:t.adVideoAssetId,adSection:t.adSection,adPlayerProfile:t.adPlayerProfile,renderersUrl:t.renderersUrl,sensitiveFallbackId:t.sensitiveFallbackId,adLiveContentDuration:t.liveDuration,mediaSrc:n.mediaSrc,dataSrc:n.dataSrc,adPolicyUrl:i.adPolicySrc};d.send("appConfig",{playerConfigUrl:e.appConfig&&e.appConfig.configUrl,containerName:document.URL}),d.send("elementConfig",r)}.call(this,this._configData),this.ePlayerLoaded.dispatch(),this._bootStrapComplete()},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._playerController.eRendered[t](this._onRendered,this),this._playerController.eContentMetadata[t](this._onContentMetadata,this),this._playerController.eContentBegin[t](this._onContentBegin,this),this._playerController.eContentPlay[t](this._onContentPlay,this),this._playerController.eContentPause[t](this._onContentPause,this),this._playerController.eContentEnd[t](this._onContentEnd,this),this._playerController.eContentComplete[t](this._onContentComplete,this),this._playerController.eContentPlayhead[t](this._onContentPlayhead,this),this._playerController.eContentBuffering[t](this._onContentBuffering,this),this._playerController.eContentQueue[t](this._onContentQueue,this),this._playerController.eContentQueueAutoplay[t](this._onContentQueueAutoplay,this),this._playerController.eContentVolume[t](this._onContentVolume,this),this._playerController.eContentError[t](this._onContentError,this),this._playerController.eContentResize[t](this._onContentResize,this),this._playerController.eAdPlayhead[t](this._onAdPlayhead,this),this._playerController.eAdPlay[t](this._onAdPlay,this),this._playerController.eAdEnd[t](this._onAdEnd,this),this._playerController.eAdError[t](this._onAdError,this),this._playerController.eAdSensitive[t](this._onAdSensitive,this),this._trackingManager.eTrackingAdStart[t](this._onTrackingAdStart,this),this._trackingManager.eTrackingAdComplete[t](this._onTrackingAdComplete,this),this._trackingManager.eTrackingAdProgress[t](this._onTrackingAdProgress,this),this._trackingManager.eTrackingAdCountdown[t](this._onTrackingAdCountdown,this),this._trackingManager.eTrackingAdClick[t](this._onTrackingAdClick,this),this._trackingManager.eTrackingContentPlay[t](this._onTrackingContentPlay,this),this._trackingManager.eTrackingContentBegin[t](this._onTrackingContentBegin,this),this._trackingManager.eTrackingContentProgress[t](this._onTrackingContentProgress,this),this._trackingManager.eTrackingContentEnd[t](this._onTrackingContentEnd,this),this._trackingManager.eTrackingContentComplete[t](this._onTrackingContentComplete,this),this._trackingManager.eTrackingContentReplay[t](this._onTrackingContentReplay,this),this._trackingManager.eTrackingContentSeek[t](this._onTrackingContentSeek,this),this._trackingManager.eTrackingContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._trackingManager.eTrackingFullscreen[t](this._onTrackingFullscreen,this),this._trackingManager.eTrackingMuted[t](this._onTrackingMuted,this),this._trackingManager.eTrackingPaused[t](this._onTrackingPaused,this),this._cms.eRequestCompleted[t](this._onCmsRequestCompleted,this)}},_bootStrapFailure:function(){_.debug("MainController","_bootStrapFailure"),this.ePlayerLoadError.dispatch(),this._bootStrapComplete()},_bootStrapComplete:function(){_.debug("MainController","_bootStrapComplete"),this._bootStrapper.eSuccess.removeListener(this._bootStrapSuccess,this),this._bootStrapper.eFailure.removeListener(this._bootStrapFailure,this),this._bootStrapper=null},render:function(e){this._playerController.render(e)},remove:function(){this._playerController.remove()},dispose:function(){this._videoBegetter.dispose(),this._videoBegetter=null,this._listen(!1),this._trackingManager.dispose(),this._trackingManager=null,this._aspenTracking.dispose(),this._aspenTracking=null,this._playerController.dispose(),this._playerController=null,this._cms=null},_onRendered:function(){var e=this._params.contentId;o.isNull(e)||(_.debug("MainController","Config property 'contentId' was provided with value '"+e+"'. Initiating play."),this.playContentWithId(e)),this.ePlayerRendered.dispatch()},playContentWithId:function(e,t){_.debug("MainController","playContentWithId",e),this._videoBegetter.prime();var n=this._getNextIndexForId(e),i=e+"|"+n;_.debug("MainController","playContentWithId","key",i),this._loadingEntryQueue[i]={play:!0,additionalParams:t},this._cms.addContentId(i)},playFromObject:function(e,t){if(!o.isString(e.url))return _.warn("MainController","playFromObject","The property 'url' is required of the object parameter."),void this.eContentEntryLoadError.dispatch(e.id,"Invalid object configuration",c.ERROR_CMS_PARSE,!1);var n=e.id||e.url;_.debug("MainController","playFromObject",n),this._videoBegetter.prime();var i=this._getNextIndexForId(n),r=n+"|"+i;_.debug("MainController","playFromObject","key",r),this._loadingEntryQueue[r]={play:!0,additionalParams:t},this._cms.addContentObject(r,e)},queueFromObject:function(e,t){var n=e.id||e.url;_.debug("MainController","queueFromObject",n);var i=this._getNextIndexForId(n),r=n+"|"+i;_.debug("MainController","queueFromObject","key",r),this._loadingEntryQueue[r]={play:!1,additionalParams:t},this._cms.addContentObject(r,e)},playNextInQueue:function(){this._playerController.playNextInQueue()},replay:function(){this._playerController.replay()},pause:function(){this._playerController.pause()},resume:function(){this._playerController.resume()},stop:function(){this._playerController.stop()},queueContentWithId:function(e,t){_.debug("MainController","queueContentWithId",e);var n=this._getNextIndexForId(e),i=e+"|"+n;_.debug("MainController","queueContentWithId","key",i),this._loadingEntryQueue[i]={play:!1,additionalParams:t},this._cms.addContentId(i)},dequeueContentWithId:function(e){this._playerController.dequeue(e)},emptyQueue:function(){this._playerController.emptyQueue()},setQueueAutoplay:function(e){this._playerController.setQueueAutoplay(e)},getQueue:function(){return this._playerController.getQueue()},seek:function(e){this._playerController.seek(e)},resize:function(e,t){this._playerController.resize(e,t)},goFullscreen:function(){this._playerController.goFullscreen()},setVolume:function(e){this._playerController.setVolume(e)},getVolume:function(){return this._playerController.getVolume()},mute:function(){this._playerController.mute()},unmute:function(){this._playerController.unmute()},isMuted:function(){return this._playerController.isMuted()},getContentEntry:function(e){if(!e||!o.isString(e))throw new Error("getContentEntry() requires a content ID");var t=this._cms.getContentId(e);return t?a.xmlToJson(t.getXML()):""},getContentEntryObject:function(e){if(!e||!o.isString(e))throw new Error("getContentEntryObject() requires a content ID");var t=this._cms.getContentId(e);return t?a.xmlToObject(t.getXML()):""},setAdSection:function(e){this._playerController.setAdSection(e)},setAdKeyValue:function(e,t){this._playerController.setAdKeyValue(e,t)},getAdKeyValues:function(){return this._playerController.getAdKeyValues()},clearAdKeyValues:function(){this._playerController.clearAdKeyValues()},setTrackingInterval:function(e){this._trackingManager.setTrackingInterval(e)},setDataSrc:function(e){this._cms.setDataUrl(e)},getCurrentPlayer:function(){return this._configData.containerInfo.elementName},_onContentMetadata:function(e){d.send("videoConfig",{cvpElementId:this.getCurrentPlayer(),videoXmlJson:this.getContentEntryObject(e)}),this.eContentMetadata.dispatch.apply(this.eContentMetadata,arguments)},_onContentBegin:function(){this.eContentBegin.dispatch.apply(this.eContentBegin,arguments)},_onContentPlay:function(){this.eContentPlay.dispatch.apply(this.eContentPlay,arguments)},_onContentPause:function(){this.eContentPause.dispatch.apply(this.eContentPause,arguments)},_onContentEnd:function(){this.eContentEnd.dispatch.apply(this.eContentEnd,arguments)},_onContentComplete:function(){this.eContentComplete.dispatch.apply(this.eContentComplete,arguments)},_onContentPlayhead:function(){this.eContentPlayhead.dispatch.apply(this.eContentPlayhead,arguments)},_onContentBuffering:function(){this.eContentBuffering.dispatch.apply(this.eContentBuffering,arguments)},_onContentQueue:function(){this.eContentQueue.dispatch.apply(this.eContentQueue,arguments)},_onContentQueueAutoplay:function(){this.eContentQueueAutoplay.dispatch.apply(this.eContentQueueAutoplay,arguments)},_onContentVolume:function(){this.eContentVolume.dispatch.apply(this.eContentVolume,arguments)},_onContentError:function(e,t){d.send("error",{cvpElementId:this.getCurrentPlayer(),contentId:e,videoContentCount:void 0,errorCode:void 0,errorMessage:t}),this.eContentError.dispatch.apply(this.eContentError,arguments)},_onContentResize:function(){this.eContentResize.dispatch.apply(this.eContentResize,arguments)},_onAdPlayhead:function(){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,arguments)},_onAdPlay:function(){this.eAdPlay.dispatch.apply(this.eAdPlay,arguments)},_onAdEnd:function(){this.eAdEnd.dispatch.apply(this.eAdEnd,arguments)},_onAdError:function(){this.eAdError.dispatch.apply(this.eAdError,arguments)},_onAdSensitive:function(){this.eAdSensitive.dispatch.apply(this.eAdSensitive,arguments)},_onTrackingAdStart:function(){this.eTrackingAdStart.dispatch.apply(this.eTrackingAdStart,arguments)},_onTrackingAdComplete:function(){this.eTrackingAdComplete.dispatch.apply(this.eTrackingAdComplete,arguments)},_onTrackingAdProgress:function(){this.eTrackingAdProgress.dispatch.apply(this.eTrackingAdProgress,arguments)},_onTrackingAdCountdown:function(){this.eTrackingAdCountdown.dispatch.apply(this.eTrackingAdCountdown,arguments)},_onTrackingAdClick:function(){this.eTrackingAdClick.dispatch.apply(this.eTrackingAdClick,arguments)},_onTrackingContentPlay:function(){this.eTrackingContentPlay.dispatch.apply(this.eTrackingContentPlay,arguments)},_onTrackingContentBegin:function(){this.eTrackingContentBegin.dispatch.apply(this.eTrackingContentBegin,arguments)},_onTrackingContentProgress:function(){this.eTrackingContentProgress.dispatch.apply(this.eTrackingContentProgress,arguments)},_onTrackingContentEnd:function(){this.eTrackingContentEnd.dispatch.apply(this.eTrackingContentEnd,arguments)},_onTrackingContentComplete:function(){this.eTrackingContentComplete.dispatch.apply(this.eTrackingContentComplete,arguments)},_onTrackingContentReplay:function(){this.eTrackingContentReplay.dispatch.apply(this.eTrackingContentReplay,arguments)},_onTrackingContentSeek:function(){this.eTrackingContentSeek.dispatch.apply(this.eTrackingContentSeek,arguments)},_onTrackingContentSeekEnd:function(){this.eTrackingContentSeekEnd.dispatch.apply(this.eTrackingContentSeekEnd,arguments)},_onTrackingFullscreen:function(){this.eTrackingFullscreen.dispatch.apply(this.eTrackingFullscreen,arguments)},_onTrackingMuted:function(){this.eTrackingMuted.dispatch.apply(this.eTrackingMuted,arguments)},_onTrackingPaused:function(){this.eTrackingPaused.dispatch.apply(this.eTrackingPaused,arguments)},_removeLoadingQueueEntry:function(e){delete this._loadingEntryQueue[e]},_onCmsRequestCompleted:function(e,t,n,i,r){_.debug("_onCmsRequestCompleted",arguments);var s=t+"|"+n;if(r)return this.eContentEntryLoadError.dispatch(e,i,r,!1),void this._removeLoadingQueueEntry(s);var a=this._loadingEntryQueue[s],l=this._cms.getContentId(e+"|"+n),c=!1;return o.empty(a)?void _.warn("onCmsRequestCompleted","no entry for key '"+s+"' found in loading queue"):o.empty(l)?(_.error("onCmsRequestCompleted","no catalogEntry for contentId '"+e+"'"),void this._removeLoadingQueueEntry(s)):(_.debug("onCmsRequestCompleted",e,a.play),a.play?(this._playerController.emptyQueue(),this._playerController.play(l,a.additionalParams)):(this._playerController.queue(l,a.additionalParams),c=!0),this._removeLoadingQueueEntry(s),void(""===r&&this.eContentEntryLoad.dispatch(e,c)))},_getNextIndexForId:function(e){var t,n,i,r,s=0;for(t in this._loadingEntryQueue)n=t.split("|"),n&&n.length>1&&(i=n[0],r=+n[1],i===e&&!isNaN(r)&&r>=s&&(s=r+1));return s}});n.exports=v}),define("html5/api",["require","exports","module","Class","cvp/customevent","html5/manager","cvp/utils"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("html5/manager"),o=e("cvp/utils"),a=i.extend({init:function(e){this._manager=new s,this.ePlayerLoaded=new r,this.ePlayerLoadError=new r,this.ePlayerReady=new r,this.eContentMetadata=new r,this.eContentBegin=new r,this.eContentPlay=new r,this.eContentPause=new r,this.eContentEnd=new r,this.eContentComplete=new r,this.eContentPlayhead=new r,this.eContentBuffering=new r,this.eContentQueue=new r,this.eContentQueueAutoplay=new r,this.eContentVolume=new r,this.eContentError=new r,this.eContentResize=new r,this.eContentEntryLoad=new r,this.eContentEntryLoadError=new r,this.eAdPlayhead=new r,this.eAdPlay=new r,this.eAdEnd=new r,this.eAdError=new r,this.eAdSensitive=new r,this.eTrackingAdStart=new r,this.eTrackingAdComplete=new r,this.eTrackingAdProgress=new r,this.eTrackingAdCountdown=new r,this.eTrackingAdClick=new r,this.eTrackingContentPlay=new r,this.eTrackingContentBegin=new r,this.eTrackingContentProgress=new r,this.eTrackingContentComplete=new r,this.eTrackingContentReplay=new r,this.eTrackingContentSeek=new r,this.eTrackingContentSeekEnd=new r,this.eTrackingFullscreen=new r,this.eTrackingMuted=new r,this.eTrackingPaused=new r,this._isListening=!1,this.listen(!0),this._manager.load(e)},listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._manager.ePlayerLoaded[t](this._onPlayerLoaded,this),this._manager.ePlayerLoadError[t](this._onPlayerLoadError,this),this._manager.ePlayerRendered[t](this._onPlayerRendered,this),this._manager.eContentMetadata[t](this._onContentMetadata,this),this._manager.eContentBegin[t](this._onContentBegin,this),this._manager.eContentPlay[t](this._onContentPlay,this),this._manager.eContentPause[t](this._onContentPause,this),this._manager.eContentEnd[t](this._onContentEnd,this),this._manager.eContentComplete[t](this._onContentComplete,this),this._manager.eContentPlayhead[t](this._onContentPlayhead,this),this._manager.eContentBuffering[t](this._onContentBuffering,this),this._manager.eContentQueue[t](this._onContentQueue,this),this._manager.eContentQueueAutoplay[t](this._onContentQueueAutoplay,this),this._manager.eContentVolume[t](this._onContentVolume,this),this._manager.eContentError[t](this._onContentError,this),this._manager.eContentResize[t](this._onContentResize,this),this._manager.eContentEntryLoad[t](this._onContentEntryLoad,this),this._manager.eContentEntryLoadError[t](this._onContentEntryLoadError,this),this._manager.eAdPlayhead[t](this._onAdPlayhead,this),this._manager.eAdPlay[t](this._onAdPlay,this),this._manager.eAdEnd[t](this._onAdEnd,this),this._manager.eAdError[t](this._onAdError,this),this._manager.eAdSensitive[t](this._onAdSensitive,this),this._manager.eTrackingAdStart[t](this._onTrackingAdStart,this),this._manager.eTrackingAdComplete[t](this._onTrackingAdComplete,this),this._manager.eTrackingAdProgress[t](this._onTrackingAdProgress,this),this._manager.eTrackingAdCountdown[t](this._onTrackingAdCountdown,this),this._manager.eTrackingAdClick[t](this._onTrackingAdClick,this),this._manager.eTrackingContentPlay[t](this._onTrackingContentPlay,this),this._manager.eTrackingContentBegin[t](this._onTrackingContentBegin,this),this._manager.eTrackingContentProgress[t](this._onTrackingContentProgress,this),this._manager.eTrackingContentComplete[t](this._onTrackingContentComplete,this),this._manager.eTrackingContentReplay[t](this._onTrackingContentReplay,this),this._manager.eTrackingContentSeek[t](this._onTrackingContentSeek,this),this._manager.eTrackingContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._manager.eTrackingFullscreen[t](this._onTrackingFullscreen,this),this._manager.eTrackingMuted[t](this._onTrackingMuted,this),this._manager.eTrackingPaused[t](this._onTrackingPaused,this)}},render:function(e){this._manager.render(e)},remove:function(){this._manager.remove()},dispose:function(){this.listen(!1),this._manager.dispose(),this._manager=null},getDefaultPlayer:function(){return this._manager.getCurrentPlayer()},play:function(e,t){this._manager.playContentWithId(e,t)},playFromObject:function(e,t){this._manager.playFromObject(e,t)},replay:function(){this._manager.replay()},playNextInQueue:function(){this._manager.playNextInQueue()},pause:function(){this._manager.pause()},resume:function(){this._manager.resume()},stop:function(){this._manager.stop()},queue:function(e,t,n){this._manager.queueContentWithId(e,t,n)},queueFromObject:function(e,t,n){this._manager.queueFromObject(e,t,n)},dequeue:function(e){this._manager.dequeueContentWithId(e)},emptyQueue:function(){this._manager.emptyQueue()},setQueueAutoplay:function(e){this._manager.setQueueAutoplay(e)},getQueue:function(){return this._manager.getQueue()},seek:function(e){this._manager.seek(e)},resize:function(e,t){this._manager.resize(e,t)},goFullscreen:function(){this._manager.goFullscreen()},setVolume:function(e){this._manager.setVolume(e)},getVolume:function(){return this._manager.getVolume()},mute:function(){this._manager.mute()},unmute:function(){this._manager.unmute()},isMuted:function(){return this._manager.isMuted()},getContentEntry:function(e){return this._manager.getContentEntry(e)},setAdSection:function(e){this._manager.setAdSection(e)},setAdKeyValue:function(e,t){this._manager.setAdKeyValue(e,t)},getAdKeyValues:function(){return this._manager.getAdKeyValues()},clearAdKeyValues:function(){this._manager.clearAdKeyValues()},setTrackingInterval:function(e){this._manager.setTrackingInterval(e)},setDataSrc:function(e){this._manager.setDataSrc(e)},switchAdContext:function(e,t){this._manager.switchAdContext(e,t)},switchTrackingContext:function(e,t){this._manager.switchTrackingContext(e,t)},_mungeArgs:function(e){var t=o.slice(e);return t.unshift(this.getDefaultPlayer()),t},_onPlayerLoaded:function(){this.ePlayerLoaded.dispatch()},_onPlayerLoadError:function(){this.ePlayerLoadError.dispatch()},_onPlayerRendered:function(){this.ePlayerReady.dispatch.apply(this.ePlayerReady,this._mungeArgs(arguments))},_onContentMetadata:function(){this.eContentMetadata.dispatch.apply(this.eContentMetadata,this._mungeArgs(arguments))},_onContentBegin:function(){this.eContentBegin.dispatch.apply(this.eContentBegin,this._mungeArgs(arguments))},_onContentPlay:function(){this.eContentPlay.dispatch.apply(this.eContentPlay,this._mungeArgs(arguments))},_onContentPause:function(){this.eContentPause.dispatch.apply(this.eContentPause,this._mungeArgs(arguments))},_onContentEnd:function(){this.eContentEnd.dispatch.apply(this.eContentEnd,this._mungeArgs(arguments))},_onContentComplete:function(){this.eContentComplete.dispatch.apply(this.eContentComplete,this._mungeArgs(arguments))},_onContentPlayhead:function(){this.eContentPlayhead.dispatch.apply(this.eContentPlayhead,this._mungeArgs(arguments))},_onContentBuffering:function(){this.eContentBuffering.dispatch.apply(this.eContentBuffering,this._mungeArgs(arguments))},_onContentQueue:function(){this.eContentQueue.dispatch.apply(this.eContentQueue,this._mungeArgs(arguments))},_onContentQueueAutoplay:function(){this.eContentQueueAutoplay.dispatch.apply(this.eContentQueueAutoplay,this._mungeArgs(arguments))},_onContentVolume:function(){this.eContentVolume.dispatch.apply(this.eContentVolume,this._mungeArgs(arguments))},_onContentError:function(){this.eContentError.dispatch.apply(this.eContentError,this._mungeArgs(arguments))},_onContentResize:function(){this.eContentResize.dispatch.apply(this.eContentResize,this._mungeArgs(arguments))},_onContentEntryLoad:function(){this.eContentEntryLoad.dispatch.apply(this.eContentEntryLoad,this._mungeArgs(arguments))},_onContentEntryLoadError:function(){this.eContentEntryLoadError.dispatch.apply(this.eContentEntryLoadError,this._mungeArgs(arguments))},_onAdPlayhead:function(){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,this._mungeArgs(arguments))},_onAdPlay:function(){this.eAdPlay.dispatch.apply(this.eAdPlay,this._mungeArgs(arguments))},_onAdEnd:function(){this.eAdEnd.dispatch.apply(this.eAdEnd,this._mungeArgs(arguments))},_onAdError:function(){this.eAdError.dispatch.apply(this.eAdError,this._mungeArgs(arguments))},_onAdSensitive:function(){this.eAdSensitive.dispatch.apply(this.eAdSensitive,this._mungeArgs(arguments))},_onTrackingAdStart:function(){this.eTrackingAdStart.dispatch.apply(this.eTrackingAdStart,this._mungeArgs(arguments))},_onTrackingAdComplete:function(){this.eTrackingAdComplete.dispatch.apply(this.eTrackingAdComplete,this._mungeArgs(arguments))},_onTrackingAdProgress:function(){this.eTrackingAdProgress.dispatch.apply(this.eTrackingAdProgress,this._mungeArgs(arguments))},_onTrackingAdCountdown:function(){this.eTrackingAdCountdown.dispatch.apply(this.eTrackingAdCountdown,this._mungeArgs(arguments))},_onTrackingAdClick:function(){this.eTrackingAdClick.dispatch.apply(this.eTrackingAdClick,this._mungeArgs(arguments))},_onTrackingContentPlay:function(){this.eTrackingContentPlay.dispatch.apply(this.eTrackingContentPlay,this._mungeArgs(arguments))},_onTrackingContentBegin:function(){this.eTrackingContentBegin.dispatch.apply(this.eTrackingContentBegin,this._mungeArgs(arguments))
},_onTrackingContentProgress:function(){this.eTrackingContentProgress.dispatch.apply(this.eTrackingContentProgress,this._mungeArgs(arguments))},_onTrackingContentComplete:function(){this.eTrackingContentComplete.dispatch.apply(this.eTrackingContentComplete,this._mungeArgs(arguments))},_onTrackingContentReplay:function(){this.eTrackingContentReplay.dispatch.apply(this.eTrackingContentReplay,this._mungeArgs(arguments))},_onTrackingContentSeek:function(){this.eTrackingContentSeek.dispatch.apply(this.eTrackingContentSeek,this._mungeArgs(arguments))},_onTrackingContentSeekEnd:function(){this.eTrackingContentSeekEnd.dispatch.apply(this.eTrackingContentSeekEnd,this._mungeArgs(arguments))},_onTrackingFullscreen:function(){this.eTrackingFullscreen.dispatch.apply(this.eTrackingFullscreen,this._mungeArgs(arguments))},_onTrackingMuted:function(){this.eTrackingMuted.dispatch.apply(this.eTrackingMuted,this._mungeArgs(arguments))},_onTrackingPaused:function(){this.eTrackingPaused.dispatch.apply(this.eTrackingPaused,this._mungeArgs(arguments))}});n.exports=a}),define("cvp/players/html5",["require","exports","module","cvp/static","cvp/players/null","cvp/utils/commandqueue","cvp/utils","cvp/log","html5/api"],function(e,t,n){var i=e("cvp/static"),r=e("cvp/players/null"),s=e("cvp/utils/commandqueue"),o=e("cvp/utils"),a=e("cvp/log"),l=e("html5/api"),c=o.bind,u=a.getLogger(),d=function(e){this._instance=new e(this._options),this._instance.ePlayerLoaded.addListener(this._onPlayerLoaded,this),this._instance.ePlayerLoadError.addListener(this._onPlayerLoadError,this),this._instance.ePlayerReady.addListener(this._onPlayerReady,this),this._instance.ePlayerReady.addListener(this._onCVPReady,this),this._instance.ePlayerReady.addListener(c(this._onCallBack,this,"onPlayerReady")),this._instance.ePlayerReady.addListener(c(this._onCallBack,this,"onCVPReady")),this._instance.eContentBegin.addListener(c(this._onCallBack,this,"onContentBegin")),this._instance.eContentPlay.addListener(c(this._onCallBack,this,"onContentPlay")),this._instance.eContentPause.addListener(c(this._onCallBack,this,"onContentPause")),this._instance.eContentEnd.addListener(c(this._onCallBack,this,"onContentEnd")),this._instance.eContentComplete.addListener(c(this._onCallBack,this,"onContentComplete")),this._instance.eContentEntryLoad.addListener(c(this._onCallBack,this,"onContentEntryLoad")),this._instance.eContentEntryLoadError.addListener(c(this._onCallBack,this,"onContentEntryLoadError")),this._instance.eContentMetadata.addListener(c(this._onCallBack,this,"onContentMetadata")),this._instance.eContentPlayhead.addListener(c(this._onCallBack,this,"onContentPlayhead")),this._instance.eContentBuffering.addListener(c(this._onCallBack,this,"onContentBuffering")),this._instance.eContentResize.addListener(c(this._onCallBack,this,"onContentResize")),this._instance.eContentQueue.addListener(c(this._onCallBack,this,"onContentQueue")),this._instance.eContentQueueAutoplay.addListener(c(this._onCallBack,this,"onContentQueueAutoplay")),this._instance.eContentVolume.addListener(c(this._onCallBack,this,"onContentVolume")),this._instance.eContentError.addListener(c(this._onCallBack,this,"onContentError")),this._instance.eAdPlayhead.addListener(c(this._onCallBack,this,"onAdPlayhead")),this._instance.eAdPlay.addListener(c(this._onCallBack,this,"onAdPlay")),this._instance.eAdEnd.addListener(c(this._onCallBack,this,"onAdEnd")),this._instance.eAdError.addListener(c(this._onCallBack,this,"onAdError")),this._instance.eAdSensitive.addListener(c(this._onCallBack,this,"onAdSensitive")),this._instance.eTrackingAdStart.addListener(c(this._onCallBack,this,"onTrackingAdStart")),this._instance.eTrackingAdComplete.addListener(c(this._onCallBack,this,"onTrackingAdComplete")),this._instance.eTrackingAdProgress.addListener(c(this._onCallBack,this,"onTrackingAdProgress")),this._instance.eTrackingAdCountdown.addListener(c(this._onCallBack,this,"onTrackingAdCountdown")),this._instance.eTrackingAdClick.addListener(c(this._onCallBack,this,"onTrackingAdClick")),this._instance.eTrackingContentPlay.addListener(c(this._onCallBack,this,"onTrackingContentPlay")),this._instance.eTrackingContentBegin.addListener(c(this._onCallBack,this,"onTrackingContentBegin")),this._instance.eTrackingContentProgress.addListener(c(this._onCallBack,this,"onTrackingContentProgress")),this._instance.eTrackingContentComplete.addListener(c(this._onCallBack,this,"onTrackingContentComplete")),this._instance.eTrackingContentReplay.addListener(c(this._onCallBack,this,"onTrackingContentReplay")),this._instance.eTrackingContentSeek.addListener(c(this._onCallBack,this,"onTrackingContentSeek")),this._instance.eTrackingContentSeekEnd.addListener(c(this._onCallBack,this,"onTrackingContentSeekEnd")),this._instance.eTrackingFullscreen.addListener(c(this._onCallBack,this,"onTrackingFullscreen")),this._instance.eTrackingMuted.addListener(c(this._onCallBack,this,"onTrackingMuted")),this._instance.eTrackingPaused.addListener(c(this._onCallBack,this,"onTrackingPaused"))},h=r.extend({init:function(e){this._super(),this._options=e,this._loadQ=new s,this._loaded=!1,d.call(this,l)},_onPlayerLoaded:function(){u.debug("_onPlayerLoaded"),this._loaded=!0,this._loadQ.execute()},_onPlayerLoadError:function(){u.debug("_onPlayerLoadError"),this._onCallBack("onPlayerLoadError")},_onPlayerReady:function(){u.debug("_onPlayerReady")},_onCVPReady:function(){u.debug("_onCVPReady")},embed:function(e){return this._loaded?(u.info("executing embed"),void this._instance.render(e)):(u.info("queuing embed"),void this._loadQ.push(this.embed,this,arguments))},remove:function(){this._instance.remove()},dispose:function(){this._instance.dispose(),this._instance=null},playContent:function(e,t){this._instance.play(e,t)},playFromObject:function(e,t){this._instance.playFromObject(e,t)},replayContent:function(){this._instance.replay()},playNextInQueue:function(){this._instance.playNextInQueue()},pause:function(){this._instance.pause()},resume:function(){this._instance.resume()},stopContent:function(){this._instance.stop()},queue:function(e,t,n){this._instance.queue(e,t,n)},queueFromObject:function(e,t,n){this._instance.queueFromObject(e,t,n)},dequeue:function(e){this._instance.dequeue(e)},emptyQueue:function(){this._instance.emptyQueue()},setQueueAutoplay:function(e){this._instance.setQueueAutoplay(e)},getQueue:function(){return this._instance.getQueue()},seek:function(e){this._instance.seek(e)},resize:function(e,t){this._instance.resize(e,t)},goFullscreen:function(){this._instance.goFullscreen()},mute:function(){this._instance.mute()},unmute:function(){this._instance.unmute()},setVolume:function(e){this._instance.setVolume(e)},getVolume:function(){return this._instance.getVolume()},isMuted:function(){return this._instance.isMuted()},getContentEntry:function(e){return this._instance.getContentEntry(e)},setAdSection:function(e){this._instance.setAdSection(e)},setAdKeyValue:function(e,t){this._instance.setAdKeyValue(e,t)},getAdKeyValues:function(){return this._instance.getAdKeyValues()},clearAdKeyValues:function(){this._instance.clearAdKeyValues()},setTrackingInterval:function(e){this._instance.setTrackingInterval(e)},setDataSrc:function(e){this._instance.setDataSrc(e)},_onCallBack:function(){i.onCallback(this._options.id,arguments)},instance:function(){return this._instance}});n.exports=h}),define("cvp/utils/log4js",["require","exports","module","core/app","cvp/log"],function(e,t){function n(){!a||c||l||window.log4javascript||(o.info("installing log4javascript"),l=!0,function(e,t,n){var i=e.createElement(t),s=e.getElementsByTagName(t)[0],a=/^(complete|loaded)$/,l=!1;i.onload=i.onreadystatechange=function(){l||n in i&&a.test(i[n])||(i.onload=i.onreadystatechange=null,l=!0,o.info("installed log4javascript"),c=!0)},i.src=r.LOG4JAVASCRIPT_URL,s.parentNode.insertBefore(i,s)}(document,"script","readyState"))}function i(){return c}var r=e("core/app"),s=e("cvp/log"),o=s.getLogger(),a=r.DEBUG,l=!1,c=!1;t.install=n,t.isInstalled=i}),define("flash/global",["require","exports","module"],function(require,exports,module){function cvpSearchTheClient(theObj,thePath){var index=thePath.indexOf("."),objName="",subPath="",childObj;return null===theObj&&(theObj=window),-1===index?-1!==thePath.indexOf("(")&&-1!==thePath.indexOf(")")?eval("theObj."+thePath):theObj[thePath]:(objName=thePath.substring(0,index),subPath=thePath.substring(index+1),childObj=theObj[objName],-1!==objName.indexOf("(")&&-1!==objName.indexOf(")")&&(childObj=eval("theObj."+objName)),null===childObj?"":subPath.length<1?childObj.toString():cvpSearchTheClient(childObj,subPath))}exports.cvpSearchTheClient=cvpSearchTheClient}),define("cvp/core",["require","exports","module","cvp/static","cvp/api","cvp/shared","cvp/utils","core/app","cvp/browser","swfobject","cvp/players/html5","cvp/players/null","cvp/log","cvp/utils/log4js","flash/global"],function(e,t,n){var i=e("cvp/static"),r=e("cvp/api"),s=e("cvp/shared"),o=e("cvp/utils"),a=e("core/app"),l=e("cvp/browser"),c=e("swfobject"),u=e("cvp/players/html5"),d=e("cvp/players/null"),h=e("cvp/log"),p=e("cvp/utils/log4js"),g=e("flash/global"),f=function(e){var t=this;this.options=o.extend({id:"cvp_player",width:"320",height:"240",flashVars:{},initialize:function(){}},e);var n=h.getLogger(this.options.id);if(this.options.embed=o.extend({containerSwf:"",expressInstallSwf:a.EXPRESS_INSTALL_URL,flashVersion:a.FLASH_VERSION},this.options.embed),this.options.embed.options=o.extend({quality:"high",bgcolor:"#000000",allowFullScreen:"true",allowScriptAccess:"always"},this.options.embed.options),!this.options.embed.containerSwf)throw n.error("Invalid containerSwf...exiting"),new Error("Invalid containerSwf");this.options.initialize();var r=this.options.id,f=this.options.width,m=this.options.height,_=this.options.flashVars,v=this.options.embed;this._playerType=this.options.playerType;var y=[a.FLASH,a.HTML5];this._playerType&&-1!==o.indexOf(y,this._playerType)||(this._playerType=a.FLASH,l.supports.video&&!c.hasFlashPlayerVersion("1.0.0")&&(this._playerType=a.HTML5));var C=null;if(this._playerType===a.HTML5?(_.site&&_.profile?(n.info("instantiating the HTML5 player"),C=new u(this.options)):(n.error("invalid HTML5 params...instantiating null player"),this._playerType=!1,C=new d(this.options)),this.getDOMPlayer=function(){return C}):(n.info("instantiating the Flash player"),p.install(),o.extend(window,g)),i.findInstance(r)||o.byId(r))throw n.error(r+" is already in use...exiting"),new Error(r+" is already in use");if(this.getId=function(){return r},this.getWidth=function(){return f},this.getHeight=function(){return m},this.getFlashVars=function(){return _},this.getEmbed=function(){return v},this.getPlayerType=function(){return this._playerType},!s.createCallbackHandler(r))throw n.error('callback handler for id "'+r+'" could not be created...exiting'),new Error('callback handler for id "'+r+'" could not be created...exiting');this.callbacks={},delete this.options.initialize;var b,T;for(b in this.options)o.hasOwn(this.options,b)&&(T=this.options[b],o.isFunc(T)&&(this.callbacks[b]=T));var w=function(e){if(o.hasOwn(A,e))try{return A[e].apply(A,o.slice(arguments,1))}catch(t){n.warn("exception on message "+e,t.message)}},A={handleCallBack:function(e){var i,r;if(arguments.length){var s=o.slice(arguments,1);if(r=t[e],o.isFunc(r))try{i=r.apply(t,s)}catch(a){n.warn("exception on internal CB "+e,a.message)}if(r=t.callbacks[e],o.isFunc(r))try{i=r.apply(t,s)}catch(l){n.error("exception on user CB "+e,l.message)}}return i},onPageOrientationChange:function(e){t.isCVPReady()&&e!==t.getPageOrientation()&&(this._sendPageStateChange({orientation:e}),this.handleCallBack("onPageOrientationChange",r,e))},onPageVisibilityChange:function(e){t.isCVPReady()&&e!==t.isPageVisible()&&(this.handleCallBack("onPageVisibilityChange",r,e),this._fireCVPVisibilityChange())},onViewportVisibilityChange:function(e){t.isCVPReady()&&e!==t.isViewportVisible()&&(this.handleCallBack("onViewportVisibilityChange",r,e),this._fireCVPVisibilityChange())},_fireCVPVisibilityChange:function(){this.handleCallBack("onCVPVisibilityChange",r,t.isCVPVisible())},_sendPageStateChange:function(e){this._invokeAPI("sendMessage","pageStateChange",e)},_invokeAPI:function(e){var i=o.slice(arguments,1);if(e in t)try{t[e].apply(t,i)}catch(r){n.warn("[_invokeAPI] Error calling: "+e)}}},P=!1,E=_.contentId||"",S=_.context||"",k=S,x=0,I=0,M=0,R=0,L=-1,O=!1,D=!1,F=!1,N=window.orientation||"unknown",j=!0,B=!0;return this.isCVPReady=function(){return P},this.getDOMPlayerInstance=function(){return k},this.getContentId=function(){return E},this.getContext=function(){return S},this.getContentWidth=function(){return x},this.getContentHeight=function(){return I},this.getDuration=function(){return M},this.getPlayhead=function(){return R},this.getAbsolutePlayhead=function(){return L},this.isBuffering=function(){return O},this.isPaused=function(){return D},this.isFullscreen=function(){return F},this.getPageOrientation=function(){return N},this.isPageVisible=function(){return j},this.isViewportVisible=function(){return B},this.isCVPVisible=function(){return j&&B},this.onCVPReady=function(){P=!0},this.onPlayerReady=function(){k=this.getDOMPlayerInstance()},this.onPageVisibilityChange=function(e,t){j=t},this.onViewportVisibilityChange=function(e,t){B=t},this.onContentMetadata=function(e,t,n,i,r){E=t,R=0,M=n,x=i,I=r},this.onContentBegin=function(e,t){E=t},this.onContentBuffering=function(e,t,n){O=n},this.onContentPlayhead=function(e,t,n,i,r){R=n,L=r||-1},this.onContentPause=function(e,t,n){D=n},this.onContentResize=function(e,t,n,i){F=i},i.registerInstance(r,this,w),this};f.prototype=r,n.exports=f}),define("cvp/pluginmanager",["require","exports","module","cvp/static","cvp/utils","cvp/log"],function(e,t,n){var i=e("cvp/static"),r=e("cvp/utils"),s=e("cvp/log"),o=r.extend,a=r.slice,l=r.isFunc,c=r.now,u=s.getLogger("PluginManager"),d={LMDB:"lmdb"},h={},p=function(e,t){return e=(e||"").toUpperCase(),d[e]?void(h[e]=t):void u.warn("[registerPlugin] Invalid plugin type. Unable to register: "+e)},g={};g.create=function(e,t){return e=(e||"").toUpperCase(),h[e]?new h[e](t):(u.warn("[create] Invalid plugin type. Unable to create: "+e),null)},g.createLMDB=function(e){return g.create(d.LMDB,e)};var f={},m=function(e,t){f[e]=t},_=function(e,t,n){var i=this;if(this.id=e,!t||!n)return u.error("[PluginHostAdapter] Invalid host or plugin. Aborting"),null;var r=function(e){return function(){return n[e].apply(n,arguments)}};for(var s in n)l(n[s])&&(this[s]=r(s));var o=function(e){var n=t();return function(){n._sendToPluginHost(i.id,e,a(arguments))}};for(var c in n.getEvents())n.on(c,o(c))};_.create=function(e,t,n,r){var s=[e,t,n,c()].join("_"),o=function(){var t=i.findInstance(e);return t.instance.getDOMPlayer()},a=g.create(n,r);return new _(s,o,a)};var v=function(e,t){var n=t.shift(),i=t.shift(),r=null;if(u.debug("[onPluginHostAPIRequest] request received: "+n+", "+i),!n)return"create"!==i?(u.error("[onPluginHostAPIRequest] Invalid create method passed"),null):(r=_[i].apply(_,[e].concat(t)),m(r.id,r),r.id);r=f[n];try{return r[i].apply(r,t)}catch(s){u.warn("[onPluginHostAPIRequest] Unable to call method: "+i+" on plugin: "+n)}},y={register:p};y=o(y,d),y=o(y,g),y.onPluginHostRequest=v,n.exports=y}),define("cvp/plugins/lmdb",["require","exports","module","Class","cvp/customevent","cvp/utils","cvp/request","cvp/utils/timing","cvp/convert","cvp/log"],function(e,t,n){var i=e("Class"),r=e("cvp/customevent"),s=e("cvp/utils"),o=e("cvp/request"),a=e("cvp/utils/timing"),l=e("cvp/convert"),c=e("cvp/log"),u=c.getLogger("LMDB"),d=function(e,t){return new a.periodically(e,t)},h=function(e){return e&&0===e.indexOf("<")&&e.lastIndexOf(">")===e.length-1},p=i.extend({init:function(e){var t=this;this.setOptions(e),this.events={dataReceived:new r("dataReceived"),dataReceivedError:new r("dataReceivedError")},this._onDataReceived=function(e,n){u.debug("[LMDB.onDataReceived] url: "+e),h(n)&&t.options.convertXML&&(u.debug("[LMDB.onDataReceived] Detected XML - converting"),n=l.xmlTextToJsonText(n)),t.events.dataReceived.dispatch(e,l.jsonTextToJsObject(n))},this._onDataReceivedError=function(e,n){u.debug("[LMDB.onDataReceivedError] url: "+e),t.events.dataReceivedError.dispatch(e,n)}},setOptions:function(e){var t={convertXML:!0};if(this.options=s.extend(this.options||t,e||{}),u.debug("[LMDB.setOptions] url: "+this.options.url+", interval: "+this.options.interval),this.options.interval&&this.options.url){if(s.toInt(this.options.interval)<=0)return;u.debug("[LMDB.setOptions] creating timer with interval: "+this.options.interval),this.periodical&&this.periodical.stop(),this.periodical=d(s.bind(this.request,this,this.options.url),this.options.interval)}},getEvents:function(){return this.events},request:function(e){u.info("[LMDB.request] url: "+e),this._transport=o.get({url:e,lazy:this.options.lazy,success:s.bind(this._onDataReceived,this,e),failure:s.bind(this._onDataReceivedError,this,e)})},on:function(e,t){s.hasOwn(this.events,e)&&this.events[e].addListener(s.bind(t,this))},start:function(e){u.debug("[LMDB.start]"),s.undef(e)&&(e=!0),this.periodical&&(this.periodical.start(),e&&this.request(this.options.url))},stop:function(){this.periodical&&this.periodical.stop()},getScheduleItems:function(e){var t=[];return e&&e.hasOwnProperty("LiveFeed")&&e.LiveFeed.hasOwnProperty("tveLiveSched")&&e.LiveFeed.tveLiveSched.hasOwnProperty("SchedItem")?t.concat(e.LiveFeed.tveLiveSched.SchedItem):t},getScheduleItem:function(e,t){for(var n=this.getScheduleItems(e),i=s.undef(t),r=s.isFunc(t),o=0;o<n.length;o++){if(i)return n[o];if(r){if(t(n[o]))return n[o]}else if(n[o].AiringID==t)return n[o]}return null}});n.exports=p}),define("cvp/plugins",["require","exports","module","cvp/pluginmanager","cvp/plugins/lmdb"],function(e,t,n){var i=e("cvp/pluginmanager"),r=e("cvp/plugins/lmdb"),s={};i.register(i.LMDB,r),s.LMDB=i.createLMDB({lazy:!0}),n.exports=s}),define("cvp/main",["require","exports","module","core/app","cvp/static","cvp/core","cvp/shared","cvp/utils","Class","swfobject","cvp/utils/commandqueue","cvp/utils/asset","cvp/utils/dependency","cvp/utils/dependencymanager","cvp/utils/jsonconverter","cvp/utils/xml","cvp/utils/timing","cvp/detectors/viewportdetector","cvp/detectors/pagefocusdetector","cvp/ajax","cvp/events","JSON","cvp/log","cvp/version","cvp/browser","cvp/request","cvp/store","cvp/pluginmanager","cvp/plugins"],function(e,t,n){var i=e("core/app"),r=e("cvp/static"),s=e("cvp/core"),o=e("cvp/shared"),a=e("cvp/utils");r.Class=e("Class"),r.swfobject=e("swfobject"),r.Utils=a,r.Utils.CommandQueue=e("cvp/utils/commandqueue"),r.Utils.Asset=e("cvp/utils/asset"),r.Utils.Dependency=e("cvp/utils/dependency"),r.Utils.DependencyManager=e("cvp/utils/dependencymanager"),r.Utils.JsonConverter=e("cvp/utils/jsonconverter"),r.Utils.XML=e("cvp/utils/xml"),r.Utils.Timing=e("cvp/utils/timing"),r.Utils.ViewportDetector=e("cvp/detectors/viewportdetector"),r.Utils.PageFocusDetector=e("cvp/detectors/pagefocusdetector"),r.Ajax=e("cvp/ajax"),r.Events=e("cvp/events"),r.JSON=e("JSON"),r.Log=e("cvp/log"),r.Version=e("cvp/version"),r.Browser=e("cvp/browser"),r.Request=e("cvp/request"),r.Store=e("cvp/store"),r.PluginManager=e("cvp/pluginmanager"),r.Plugins=e("cvp/plugins"),r.init=function(e){var t,n;if(!a.isSimpleObject(e))throw new Error("CVP.init() requires one param: a simple object");for(t in e)a.hasOwn(e,t)&&(n=e[t],i._cvpsetup[t]=a.isSimpleObject(n)?a.extend(i._cvpsetup[t],n):n)},r.createPlayer=function(e){return new s(e)},r.getSessionToken=function(){return"Aspen"in window?window.Aspen.getSessionToken():void 0};var l=function(e){return r.createPlayer(e)};o.addBeforeUnLoadEvent(r.cleanup),n.exports=a.extend(l,r)}),define("oldcvp",["require","exports","module","cvp/main","aspen/aspen"],function(e,t,n){var i=e("cvp/main");window.Aspen=e("aspen/aspen"),n.exports=i}),require(["oldcvp"]),require("oldcvp")});var amzn_console=function(){"use strict";var e={};return e.log=function(){},e}();window.console&&(amzn_console=window.console);var amznads=function(e,t,n,i){"use strict";function r(i,s,o,a,l,c,u){this.element=i,this.impId=l,this.win=c,this.doc=u,this.start=null,this.end=null,this.area=null,this.cutoff=s,this.cutoffTime=1e3*o,this.focused=null,this.timer=!1,this.timerStarted=!1,this.getDuration=a,this.reported=!1,this.above=null,this.totalTime=0,this.leftPos=null,this.topPos=null,r.prototype.calcArea=function(){try{var i=t.getElementsByTagName("body")[0],r=n.top.innerWidth||t.documentElement.clientWidth||i.clientWidth,s=n.top.innerHeight||t.documentElement.clientHeight||i.clientHeight,o=e.$jQ(n).scrollTop(),a=e.$jQ(this.element).offset().top,l=e.$jQ(this.element).height(),c=e.$jQ(n).scrollLeft(),u=e.$jQ(this.element).offset().left,d=e.$jQ(this.element).width(),h=Math.max(a,o),p=Math.min(a+l,o+s),g=p-h;g=Math.max(0,g);var f=Math.max(u,c),m=Math.min(u+d,c+r),_=m-f;_=Math.max(0,_);var v=g*_,y=d*l;return this.leftPos=u/e.$jQ(t).width(),this.topPos=a/e.$jQ(t).height(),v/y}catch(C){e.log("calcArea failed for ad id="+this.element+"; error="+C)}return 0},r.prototype.displayTime=function(){if(this.getDuration){var t=this.end-this.start;e.log(this.element+" viewed for: "+t),this.totalTime+=t}},r.prototype.adInView=function(){e.log(this.element+" IN VIEW")},r.prototype.adNotInView=function(){e.log(this.element+" NOT IN VIEW")},r.prototype.seenForTime=function(){e.log(this.element+" displayed for "+this.cutoffTime/1e3+" seconds"),e.log(" "),this.reported=!0;try{encodeURIComponent(location.protocol+location.host+location.pathname)}catch(t){this.firePixel('/{"adViewability":[{"error": '+JSON.stringify(encodeURIComponent("Error encoding url - "+t))+"}]}")}try{this.firePixel('/{"adViewability":[{"viewable": true }]}')}catch(t){e.log(t),this.firePixel('/{"adViewability":[{"error": '+JSON.stringify(encodeURIComponent("Error sending pixel - "+t))+"}]}")}},r.prototype.firePixel=function(t){(new Image).src=e.protocol+e.host+e.px_svc+this.impId+t+"&cb="+Math.round(1e7*Math.random())},r.prototype.getAreaTime=function(){function n(){s.reported||(s.timer=setTimeout(function(){s.seenForTime()},s.cutoffTime))}function i(){s.adInView(),s.start=new Date,n(),s.timerStarted=!0}function r(){clearTimeout(s.timer),s.timerStarted=!1,s.end=new Date,s.adNotInView(),s.displayTime()}var s=this;if(null==this.area){this.area=this.calcArea(),this.above=this.area>this.cutoff?!0:!1;try{this.firePixel('/{"adViewability":[{"above_the_fold": '+this.above+', "topPos": '+this.topPos+', "leftPos": '+this.leftPos+"}]}")}catch(o){e.log(o),this.firePixel('/{"adViewability":[{"error": '+JSON.stringify(encodeURIComponent("Error sending pixel - "+o))+"}]}")}}var a=this.calcArea();t.hasFocus()&&(0==this.focused||null==this.focused)&&a>this.cutoff&&0==this.timerStarted&&i(),t.hasFocus()?this.focused=!0:this.area>this.cutoff&&1==this.focused&&(r(),this.focused=!1),(this.area>=this.cutoff&&a<this.cutoff||this.area<this.cutoff&&a>=this.cutoff)&&(a>=this.cutoff&&0==this.timerStarted?i():a<this.area&&r()),this.area=a},r.prototype.collectData=function(){var t=this;t.getAreaTime(),e.$jQ(n).on("scroll resize focus blur",function(){t.reported||t.getAreaTime()})}}var s="https:"===t.location.protocol;return e.protocol=s?"https://":"http://",e.DEFAULT_HOST="aax.amazon-adsystem.com",e.host=e.DEFAULT_HOST,e.dtb_svc="/e/dtb/bid",e.pb_svc="/x/getad",e.px_svc="/x/px/",e.debug_mode=e.debug_mode||!1,e.MIN_TIMEOUT=0,e.DEFAULT_TIMEOUT=1e3,e.targetingKey="amznslots",e.vidKey="amzn_vid",e.tasks=e.tasks||[],e.$jQ=e.$jQ||null,e.VIEWABILITY_CUTOFF_AREA=e.VIEWABILITY_CUTOFF_AREA||.5,e.VIEWABILITY_CUTOFF_DURATION_SEC=e.VIEWABILITY_CUTOFF_DURATION_SEC||1,e.CSM_JS="//c.amazon-adsystem.com/aax2/csm.js.gz",e.isjQueryPresent=function(){if("function"==typeof e.$jQ)return!0;try{if(n.top.jQuery&&n.top.jQuery.fn.on&&n.top.jQuery.fn.scrollTop)return e.$jQ=n.top.jQuery,!0}catch(t){}return!1},e.log=function(t){try{e.debug_mode&&i.log(t)}catch(n){}},e.log("Initiating amznads"),e.ads||(e.ads={}),e.updateAds=function(t){if(e.ads=t.ads,e.ev=t.ev,t.vads){e.ads||(e.ads={});var n;for(n in t.vads)t.vads.hasOwnProperty(n)&&(e.ads[n]=t.vads[n],e.amzn_vid=t.vads[n])}e.log("Updated ads. Executing rest of the task queue"),e.doAllTasks(),e.tasks.push=function(t){e.doTask(t)}},e.saveAds=function(t){e.saved_ads=t.ads,e.updateAds(t)},e.getAdForSlot=function(n,i,r){e.src_id=n;var s=s||{},o=s.u;o||(o=e.getReferrerURL()),o&&-1!==o.indexOf("amzn_debug_mode")&&(e.debug_mode=!0),e.log("amznads.getAdForSlot: Using url="+o);var a="src="+e.src_id+"&slot_uuid="+i+"&c=100&u="+o+"&cb="+Math.round(1e7*Math.random()),l=e.protocol+e.host+e.pb_svc+"?jsd=1&"+a;e.log("amznads.getAdAdForSlot: "+(r?"Async ":"")+"Call to: "+l),r?e.appendScriptTag(l):aax_write(t,"<script type='text/javascript' src='"+l+"'></script>")},e.getAdsCallback=function(t,n,i,r,s){var o=null,s=s||{};try{n&&"function"==typeof n&&(o=e.handleCallBack(n,i))}catch(a){e.log("amznads.getAdsAsyncWithCallback(): Error occured in setting up callback functionality."+a)}s.to||(s.to=i),e.doGetAdsAsync(t,r,s,o)},e.getVideoAdsCallback=function(t,n,i,r,s){var s=s||{};s.mt="V",e.getAdsCallback(t,n,i,r,s)},e.getDisplayAdsCallback=function(t,n,i,r,s){var s=s||{};s.mt="D",e.getAdsCallback(t,n,i,r,s)},e.getAdsAsync=function(t,n,i){e.doGetAdsAsync(t,n,i)},e.getVideoAdsAsync=function(t,n,i){var i=i||{};i.mt="V",e.getAdsAsync(t,n,i)},e.getDisplayAdsAsync=function(t,n,i){var i=i||{};i.mt="D",e.getAdsAsync(t,n,i)},e.handleCallBack=function(t,i){var r=!1,s=null,o=function(e){if(!r){try{t(e),s&&clearTimeout(s)}catch(n){}r=!0}},a=e.getValidMilliseconds(i);return s=a?n.setTimeout(o,a):n.setTimeout(o,e.DEFAULT_TIMEOUT),o},e.getValidMilliseconds=function(t){if(!t)return!1;try{var n=~~Number(t);if(n>e.MIN_TIMEOUT)return n}catch(i){return e.log("amznads.isValidMilliseconds(): Invalid timeout specified."+i),!1}return!1},e.getAds=function(n,i,r,s){if(s)return void e.doGetAdsAsync(n,i,r);var o=e.getScriptSource(n,i,r);e.log("amznads.getAds: Call to: "+o),aax_write(t,"<script type='text/javascript' src='"+o+"'></script>")},e.getVideoAds=function(t,n,i,r){var i=i||{};i.mt="V",e.getAds(t,n,i,r)},e.getDisplayAds=function(t,n,i,r){var i=i||{};i.mt="D",e.getAds(t,n,i,r)},e.doGetAdsAsync=function(t,n,i,r){var s=e.getScriptSource(t,n,i);e.log("amznads.getAds: Async Call to: "+s),e.appendScriptTag(s,r)},e.getScriptSource=function(n,i,r){e.src_id=n;var r=r||{},s=r.u,o=r.d,a=r.to,l=r.mt;if(s||(s=e.getReferrerURL()),s&&-1!==s.indexOf("amzn_debug_mode")&&(e.debug_mode=!0),e.ads&&(e.log("amznads.getAds(): clear out existing ads"),e.clearTargetingFromGPTAsync(),e.ads={}),e.saved_ads&&(e.ads=e.saved_ads),o)try{t.domain=o,e.log("amznads.getAds(): Using domain="+o)}catch(c){e.log("amznads.getAds(): Unable to override document domain with '"+o+"'; exception="+c)}e.log("amznads.getAds(): Using url="+s);var u="src="+n+"&u="+s+"&cb="+Math.round(1e7*Math.random());i&&(u+="&sz="+i),a&&(u+="&t="+a),l&&(u+="&mt="+l);var d=e.protocol+e.host+e.dtb_svc+"?"+u;return d},e.getReferrerURL=function(){var i=encodeURIComponent(t.documentURI);try{i=encodeURIComponent(n.top.location.href),i&&"undefined"!=i||(i=e.detectIframeAndGetURL())}catch(r){i=e.detectIframeAndGetURL()}return i},e.detectIframeAndGetURL=function(){try{if(n.top!==n.self)return e.log("Script is loaded within iFrame"),encodeURIComponent(t.referrer)}catch(i){return encodeURIComponent(t.documentURI)}},e.appendScriptTag=function(n,i){var r=t.getElementsByTagName("script")[0],s=t.createElement("script");s.type="text/javascript",s.async=!0,s.src=n;try{i&&"function"==typeof i&&(s.readyState?(s.onreadystatechange=function(){("loaded"==s.readyState||"complete"==s.readyState)&&(s.onreadystatechange=null,i(!0))},e.log("amznads.appendScriptTag: setting callBack function for < IE-8 ")):(s.onload=function(){i(!0)},e.log("amznads.appendScriptTag: setting callBack function for all other browsers exluding  < IE-8")))}catch(o){e.log("amznads.appendScriptTag: Could not associate callBack function; "+o)}r.parentNode.insertBefore(s,r)},e.renderAd=function(t,n){if(e.log("amznads.renderAd: key="+n+"; ad-tag="+e.ads[n]),e.ads[n]){var i=e.ads[n];if(e.ev){var r="amznad"+Math.round(1e6*Math.random());i=i.replace("window.top.amznads.detectViewability","window.amzncsm.rmD"),i=i.replace(/id=[^ ]*/,'id="'+r+'"');var s="<script type='text/javascript' src='"+e.CSM_JS+"'></script>\n";e.host!=e.DEFAULT_HOST&&(s+="<script type='text/javascript'>try{amzncsm.host=window.top.amznads.host;}catch(e){amzncsm.host=amznads.host;}</script>\n"),i=s+i}aax_write(t,i)}else{var o=new Object;o.c="dtb",o.src=e.src_id,o.kvmismatch=1,o.pubReturnedKey=n,o.aaxReturnedKeys=e.getTokens(),o.cb=Math.round(1e7*Math.random());try{o.u=encodeURIComponent(location.host+location.pathname),navigator&&(o.ua=encodeURIComponent(navigator.userAgent))}catch(a){}var l=encodeURIComponent(JSON.stringify(o)),c=e.protocol+e.host+"/x/px/p/0/"+l;e.log("amznads.renderAd: keyValueMismatch detected, pubReturnedKey="+n+", aaxReturnedKeys="+e.getTokens()),aax_write(t,"<img src='"+c+"'/>")}},e.detectViewability=function(t,i,s,o){e.isjQueryPresent()&&(s===n.top?new r(t,e.VIEWABILITY_CUTOFF_AREA,e.VIEWABILITY_CUTOFF_DURATION_SEC,!0,i,s,o).collectData():new r(s.frameElement,e.VIEWABILITY_CUTOFF_AREA,e.VIEWABILITY_CUTOFF_DURATION_SEC,!0,i,s,o).collectData())},e.hasAds=function(t){var n;if(!t)try{return Object.keys(e.ads).length>0}catch(i){e.log("amznads.hasAds: looks like IE 8 (and below): "+i);for(n in e.ads)if(e.ads.hasOwnProperty(n))return!0}for(n in e.ads)if(e.ads.hasOwnProperty(n)&&n.indexOf(t)>0)return!0;return!1},e.getTargeting=function(){var t={};return e.getTokens()&&e.getTokens().length>0&&(t[e.targetingKey]=e.getTokens(),e.amzn_vid&&(t[e.vidKey]=e.amzn_vid)),t},e.setTargeting=function(t,n){var i;for(i in e.ads)if(e.ads.hasOwnProperty(i)){if(n&&i.indexOf(n)<0)continue;t(i,"1")}},e.setTargetingForGPTAsync=function(t){try{if(t){e.targetingKey=t;var n=e.getTokens();"undefined"!=typeof n&&n.length>0&&googletag.cmd.push(function(){googletag.pubads().setTargeting(t,n),e.amzn_vid&&googletag.pubads().setTargeting(e.vidKey,e.amzn_vid)})}else{var i;for(i in e.ads)e.ads.hasOwnProperty(i)&&!function(){var t=i;e.log("amznads.setTargetingForGPTAsync: pushing localKey="+t),googletag.cmd.push(function(){amznads.debug_mode&&amznads.log("amznads.setTargetingForGPTAsync: localKey="+t),googletag.pubads().setTargeting(t,"1"),e.amzn_vid&&googletag.pubads().setTargeting(e.vidKey,e.amzn_vid)})}()}e.log("amznads.setTargetingForGPTAsync: Completed successfully. Number of ads returned by Amazon: "+Object.keys(e.ads).length)}catch(r){e.log("amznads.setTargetingForGPTAsync: ERROR - "+r)}},e.setTargetingForGPTSync=function(t){try{if(t){e.targetingKey=t;var n=e.getTokens();"undefined"!=typeof n&&n.length>0&&(googletag.pubads().setTargeting(t,n),e.amzn_vid&&googletag.pubads().setTargeting(e.vidKey,e.amzn_vid))}else{var i;for(i in e.ads)e.ads.hasOwnProperty(i)&&(googletag.pubads().setTargeting(i,"1"),e.amzn_vid&&googletag.pubads().setTargeting(e.vidKey,e.amzn_vid))}e.log("amznads.setTargetingForGPTSync: Completed successfully. Number of ads returned by Amazon: "+Object.keys(e.ads).length)}catch(r){e.log("amznads.setTargetingForGPTSync: ERROR - "+r)}},e.clearTargetingFromGPTAsync=function(){try{googletag&&googletag.pubads()&&googletag.pubads().clearTargeting(e.targetingKey),googletag.pubads().clearTargeting(e.vidKey)}catch(t){}},e.appendTargetingToAdServerUrl=function(t){var n=t;try{-1===t.indexOf("?")&&(t+="?");var i;for(i in e.ads)e.ads.hasOwnProperty(i)&&(t+="&"+i+"=1");e.log("amznads.appendTargetingToAdServerUrl: Completed successfully. Number of ads returned by Amazon: "+e.ads.length)}catch(r){e.log("amznads.appendTargetingToAdServerUrl: ERROR - "+r)}return e.log("amznads.appendTargetingToAdServerUrl: input url: "+n+"\nreturning url: "+t),t},e.appendTargetingToQueryString=function(t){var n=t;try{var i;for(i in e.ads)e.ads.hasOwnProperty(i)&&(t+="&"+i+"=1")}catch(r){e.log("amznads.appendTargetingToQueryString: ERROR - "+r)}return e.log("amznads.appendTargetingToQueryString: input query-string:"+n+"\nreturning query-string:"+t),t
},e.getTokens=function(t){var n,i=[];try{for(n in e.ads)if(e.ads.hasOwnProperty(n)){if(t&&n.indexOf(t)<0)continue;i.push(n)}}catch(r){e.log("amznads.getTokens: ERROR - "+r)}return e.log("amznads.getTokens: returning tokens = "+i),i},e.getKeys=e.getTokens,e.getVid=function(){return e.amzn_vid},e.doAllTasks=function(){for(;e.tasks.length>0;){var t=e.tasks.shift();e.doTask(t)}},e.doTask=function(t){try{t.call()}catch(n){e.log("Failed calling task: "+n)}},e.tryGetAdsAsync=function(){e.asyncParams&&e.getAdsCallback(e.asyncParams.id,e.asyncParams.callbackFn,e.asyncParams.timeout,e.asyncParams.size,e.asyncParams.data)},e}(amznads||{},document,window,amzn_console);amznads.tryGetAdsAsync(),window.amzn_ads=amzn_ads,window.amznads=amznads;var AmazonDirectMatchBuy=function(){function e(e,t){return null!=e&&y.call(e,t)}function t(e){return"[object Function]"===b.call(e)}function n(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function i(e,n){if(!t(e))throw new TypeError("Bind must be called on a function");if(v&&e.bind===v)return v.apply(e,C.call(arguments,1));var i=C.call(arguments,2);return function(){return e.apply(n,i.concat(C.call(arguments)))}}function r(e){return function(){e&&(e.apply(this,arguments),e=null)}}function s(){n(window.console)&&t(window.console.log)&&window.console.log.apply(window.console,arguments)}function o(){return"amznads"in window&&"getTargeting"in window.amznads&&t(window.amznads.getTargeting)}function a(e){var t=r(e||E);if(!o())return t.call();try{amznads.getAdsCallback(w,t,A)}catch(n){T("Exception thrown while requesting Amazon ads:",n),t.call()}}function l(){var e={};return o()&&(e=amznads.getTargeting(),n(e)||(e={})),e}function c(e){var t=e.getId();if(S.has(t)){var n=S.getKeys(t);if(n.length){T("clearing previous ad key-values: "+n.join(", "));for(var i=0,r=n.length;r>i;++i)e.setAdKeyValue(n[i],null);S.clearKeys(t)}}}function u(e,t,n){T("setting ad key-value: "+t+' = "'+n+'"'),S.addKey(e.getId(),t),e.setAdKeyValue(t,n)}function d(t){var n=l();c(t);for(var i in n)if(e(n,i)){var r=n[i];if(r instanceof Array)for(var s=0,o=r.length;o>s;++s)u(t,r[s],"1");else u(t,i,r)}}function h(e){e.getPlayerType()===CVP.FLASH&&(T("setAdKeyValuePairs(player)"),d(e))}function p(e){P||(T("init(config)",e),P=!0,n(e)&&("amznkey"in e&&(w=e.amznkey),"timeout"in e&&(A=e.timeout)),a(function(){T("init requestAdRefresh responded")}))}function g(e){return function(){return P?void e.apply(this,arguments):void T("ERROR: init() must be called first!")}}var f=Array.prototype,m=Function.prototype,_=Object.prototype,v=m.bind,y=_.hasOwnProperty,C=f.slice,b=_.toString,T=i(s,null,"[AmazonDirectMatchBuy]"),w="3159",A=2e3,P=!1,E=function(){},S=function(){function e(e){return e in r}function t(t,n){e(t)||(r[t]=[]),r[t].push(n)}function n(t){return e(t)?C.call(r[t]):[]}function i(t){return e(t)?(r[t].length=0,!0):!1}var r={};return{has:e,clearKeys:i,getKeys:n,addKey:t}}();return{requestAdRefresh:g(a),getTargetingData:g(l),setAdKeyValuePairs:g(h),isAmazonApiAvailable:o,init:p}}();CNN.AmazonVideoAds=CNN.AmazonVideoAds||{},CNN.AmazonVideoAds.Manager=function(){"use strict";this.initialize=function(){CNN.Features.enableAmazonVideoAds&&"object"==typeof AmazonDirectMatchBuy&&AmazonDirectMatchBuy.init()},this.cvpAdSetup=function(e){CNN.Features.enableAmazonVideoAds&&"object"==typeof AmazonDirectMatchBuy&&(AmazonDirectMatchBuy.setAdKeyValuePairs(window.cnnVideoManager.getPlayerByContainer(e).videoInstance.cvp),AmazonDirectMatchBuy.requestAdRefresh())},this.addAmazonCallback=function(e){"undefined"!=typeof e&&(e.onAdSetup=this.cvpAdSetup)},this.initialize()},CNN.AmazonVideoAds.Manager.getInstance=function(){"use strict";return"undefined"==typeof window.amazonAdManager&&(window.amazonAdManager=new CNN.AmazonVideoAds.Manager),window.amazonAdManager};var CNN=window.CNN||{};!function(e,t,n,i){"use strict";function r(e){return e!==i&&"function"==typeof e}function s(t){e(n).onZonesAndDomReady(function(){var e=n.createElement("script"),i=n.getElementsByTagName("script")[0];e.src=l.scriptTag.src,e.id=c,r(t)&&(e.onload=e.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(t(),e.onload=e.onreadystatechange=null)}),i.parentNode.insertBefore(e,i)})}function o(e,n){if(0===e.jPlayer.status.currentTime&&("object"!=typeof CNN.Features||CNN.Features.enableOmniture!==!1))try{t.trackMetrics({type:"cnnaudio-start",data:{adobe_hash_id:n.adobe_hash_id,auth_state:n.auth_state,id:n.id,title:n.title,mvpd:n.mvpd}})}catch(i){}}function a(t){var i=e(n.getElementById(t));i.jPlayer({ready:function(){i.jPlayer("setMedia",{mp3:i.data("file")}).bind(e.jPlayer.event.play,function(e){o(e,{adobe_hash_id:"",auth_state:"does not require authentication",id:"",title:i.data("title"),mvpd:""})})},supplied:"mp3",swfPath:"/assets/",volume:1,wmode:"window",solution:"html, flash",errorAlerts:!1,warningAlerts:!1})}if("function"!=typeof t.CNN.AudioPlayer){var l={scriptTag:{src:"http://edition.i.cdn.cnn.com/.a/1.152.3/js/vendor/jquery.jplayer.min.js"}},c="jquery-jplayer";CNN.AudioPlayer=function(e){null===n.getElementById(c)?s(e):r(e)&&e()},CNN.AudioPlayer.init=function(e){CNN.AudioPlayer(function(){a(e)})}}}(jQuery,window,document),!function(e,t){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(n){return e.Bloodhound=t(n)}):"object"==typeof exports?module.exports=t(require("jquery")):e.Bloodhound=t(jQuery)}(this,function(e){var t=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(e){return!e||/^\s*$/.test(e)},escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isArray:e.isArray,isFunction:e.isFunction,isObject:e.isPlainObject,isUndefined:function(e){return"undefined"==typeof e},isElement:function(e){return!(!e||1!==e.nodeType)},isJQuery:function(t){return t instanceof e},toStr:function(e){return t.isUndefined(e)||null===e?"":e+""},bind:e.proxy,each:function(t,n){function i(e,t){return n(t,e)}e.each(t,i)},map:e.map,filter:e.grep,every:function(t,n){var i=!0;return t?(e.each(t,function(e,r){return(i=n.call(null,r,e,t))?void 0:!1}),!!i):i},some:function(t,n){var i=!1;return t?(e.each(t,function(e,r){return(i=n.call(null,r,e,t))?!1:void 0}),!!i):i},mixin:e.extend,identity:function(e){return e},clone:function(t){return e.extend(!0,{},t)},getIdGenerator:function(){var e=0;return function(){return e++}},templatify:function(t){function n(){return String(t)}return e.isFunction(t)?t:n},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var i,r;return function(){var s,o,a=this,l=arguments;return s=function(){i=null,n||(r=e.apply(a,l))},o=n&&!i,clearTimeout(i),i=setTimeout(s,t),o&&(r=e.apply(a,l)),r}},throttle:function(e,t){var n,i,r,s,o,a;return o=0,a=function(){o=new Date,r=null,s=e.apply(n,i)},function(){var l=new Date,c=t-(l-o);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,o=l,s=e.apply(n,i)):r||(r=setTimeout(a,c)),s}},stringify:function(e){return t.isString(e)?e:JSON.stringify(e)},noop:function(){}}}(),n="0.11.1",i=function(){"use strict";function e(e){return e=t.toStr(e),e?e.split(/\s+/):[]}function n(e){return e=t.toStr(e),e?e.split(/\W+/):[]}function i(e){return function(n){return n=t.isArray(n)?n:[].slice.call(arguments,0),function(i){var r=[];return t.each(n,function(n){r=r.concat(e(t.toStr(i[n])))}),r}}}return{nonword:n,whitespace:e,obj:{nonword:i(n),whitespace:i(e)}}}(),r=function(){"use strict";function n(n){this.maxSize=t.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=e.noop)}function i(){this.head=this.tail=null}function r(e,t){this.key=e,this.val=t,this.prev=this.next=null}return t.mixin(n.prototype,{set:function(e,t){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[e])?(n.val=t,this.list.moveToFront(n)):(n=new r(e,t),this.list.add(n),this.hash[e]=n,this.size++)},get:function(e){var t=this.hash[e];return t?(this.list.moveToFront(t),t.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new i}}),t.mixin(i.prototype,{add:function(e){this.head&&(e.next=this.head,this.head.prev=e),this.head=e,this.tail=this.tail||e},remove:function(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev},moveToFront:function(e){this.remove(e),this.add(e)}}),n}(),s=function(){"use strict";function n(e,n){this.prefix=["__",e,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+t.escapeRegExChars(this.prefix)),this.ls=n||a,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function r(e){return JSON.stringify(t.isUndefined(e)?null:e)}function s(t){return e.parseJSON(t)}function o(e){var t,n,i=[],r=a.length;for(t=0;r>t;t++)(n=a.key(t)).match(e)&&i.push(n.replace(e,""));return i}var a;try{a=window.localStorage,a.setItem("~~~","!"),a.removeItem("~~~")}catch(l){a=null}return t.mixin(n.prototype,{_prefix:function(e){return this.prefix+e},_ttlKey:function(e){return this._prefix(e)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=t.noop},_safeSet:function(e,t){try{this.ls.setItem(e,t)}catch(n){"QuotaExceededError"===n.name&&(this.clear(),this._noop())}},get:function(e){return this.isExpired(e)&&this.remove(e),s(this.ls.getItem(this._prefix(e)))},set:function(e,n,s){return t.isNumber(s)?this._safeSet(this._ttlKey(e),r(i()+s)):this.ls.removeItem(this._ttlKey(e)),this._safeSet(this._prefix(e),r(n))},remove:function(e){return this.ls.removeItem(this._ttlKey(e)),this.ls.removeItem(this._prefix(e)),this},clear:function(){var e,t=o(this.keyMatcher);for(e=t.length;e--;)this.remove(t[e]);return this},isExpired:function(e){var n=s(this.ls.getItem(this._ttlKey(e)));return t.isNumber(n)&&i()>n?!0:!1}}),n}(),o=function(){"use strict";function n(e){e=e||{},this.cancelled=!1,this.lastReq=null,this._send=e.transport,this._get=e.limiter?e.limiter(this._get):this._get,this._cache=e.cache===!1?new r(0):a}var i=0,s={},o=6,a=new r(10);return n.setMaxPendingRequests=function(e){o=e},n.resetCache=function(){a.reset()},t.mixin(n.prototype,{_fingerprint:function(t){return t=t||{},t.url+t.type+e.param(t.data||{})},_get:function(e,t){function n(e){t(null,e),u._cache.set(l,e)}function r(){t(!0)}function a(){i--,delete s[l],u.onDeckRequestArgs&&(u._get.apply(u,u.onDeckRequestArgs),u.onDeckRequestArgs=null)}var l,c,u=this;l=this._fingerprint(e),this.cancelled||l!==this.lastReq||((c=s[l])?c.done(n).fail(r):o>i?(i++,s[l]=this._send(e).done(n).fail(r).always(a)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,i){var r,s;i=i||e.noop,n=t.isString(n)?{url:n}:n||{},s=this._fingerprint(n),this.cancelled=!1,this.lastReq=s,(r=this._cache.get(s))?i(null,r):this._get(n,i)},cancel:function(){this.cancelled=!0}}),n}(),a=window.SearchIndex=function(){"use strict";function n(n){n=n||{},n.datumTokenizer&&n.queryTokenizer||e.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||t.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}function i(e){return e=t.filter(e,function(e){return!!e}),e=t.map(e,function(e){return e.toLowerCase()})}function r(){var e={};return e[l]=[],e[a]={},e}function s(e){for(var t={},n=[],i=0,r=e.length;r>i;i++)t[e[i]]||(t[e[i]]=!0,n.push(e[i]));return n}function o(e,t){var n=0,i=0,r=[];e=e.sort(),t=t.sort();for(var s=e.length,o=t.length;s>n&&o>i;)e[n]<t[i]?n++:e[n]>t[i]?i++:(r.push(e[n]),n++,i++);return r}var a="c",l="i";return t.mixin(n.prototype,{bootstrap:function(e){this.datums=e.datums,this.trie=e.trie},add:function(e){var n=this;e=t.isArray(e)?e:[e],t.each(e,function(e){var s,o;n.datums[s=n.identify(e)]=e,o=i(n.datumTokenizer(e)),t.each(o,function(e){var t,i,o;for(t=n.trie,i=e.split("");o=i.shift();)t=t[a][o]||(t[a][o]=r()),t[l].push(s)})})},get:function(e){var n=this;return t.map(e,function(e){return n.datums[e]})},search:function(e){var n,r,c=this;return n=i(this.queryTokenizer(e)),t.each(n,function(e){var t,n,i,s;if(r&&0===r.length)return!1;for(t=c.trie,n=e.split("");t&&(i=n.shift());)t=t[a][i];return t&&0===n.length?(s=t[l].slice(0),void(r=r?o(r,s):s)):(r=[],!1)}),r?t.map(s(r),function(e){return c.datums[e]}):[]},all:function(){var e=[];for(var t in this.datums)e.push(this.datums[t]);return e},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),l=function(){"use strict";function e(e){this.url=e.url,this.ttl=e.ttl,this.cache=e.cache,this.prepare=e.prepare,this.transform=e.transform,this.transport=e.transport,this.thumbprint=e.thumbprint,this.storage=new s(e.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},t.mixin(e.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(e){this.cache&&(this.storage.set(n.data,e,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var e,t={};return this.cache?(t.data=this.storage.get(n.data),t.protocol=this.storage.get(n.protocol),t.thumbprint=this.storage.get(n.thumbprint),e=t.thumbprint!==this.thumbprint||t.protocol!==location.protocol,t.data&&!e?t.data:null):null},fromNetwork:function(e){function t(){e(!0)}function n(t){e(null,r.transform(t))}var i,r=this;e&&(i=this.prepare(this._settings()),this.transport(i).fail(t).done(n))},clear:function(){return this.storage.clear(),this}}),e}(),c=function(){"use strict";function e(e){this.url=e.url,this.prepare=e.prepare,this.transform=e.transform,this.transport=new o({cache:e.cache,limiter:e.limiter,transport:e.transport})}return t.mixin(e.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(e,t){function n(e,n){t(e?[]:r.transform(n))}var i,r=this;return t?(e=e||"",i=this.prepare(e,this._settings()),this.transport.get(i,n)):void 0},cancelLastRequest:function(){this.transport.cancel()}}),e}(),u=function(){"use strict";function i(i){var r;return i?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:t.identity,transform:t.identity,transport:null},i=t.isString(i)?{url:i}:i,i=t.mixin(r,i),!i.url&&e.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint=n+i.thumbprint,i.transport=i.transport?a(i.transport):e.ajax,i):null}function r(n){var i;return n?(i={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:t.identity,transport:null},n=t.isString(n)?{url:n}:n,n=t.mixin(i,n),!n.url&&e.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=s(n),n.limiter=o(n),n.transport=n.transport?a(n.transport):e.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n):void 0}function s(e){function t(e,t){return t.url=s(t.url,e),t}function n(e,t){return t.url=t.url.replace(o,encodeURIComponent(e)),t}function i(e,t){return t}var r,s,o;return r=e.prepare,s=e.replace,o=e.wildcard,r?r:r=s?t:e.wildcard?n:i}function o(e){function n(e){return function(n){return t.debounce(n,e)}}function i(e){return function(n){return t.throttle(n,e)}}var r,s,o;return r=e.limiter,s=e.rateLimitBy,o=e.rateLimitWait,r||(r=/^throttle$/i.test(s)?i(o):n(o)),r}function a(n){return function(i){function r(e){t.defer(function(){o.resolve(e)})}function s(e){t.defer(function(){o.reject(e)})}var o=e.Deferred();return n(i,r,s),o}}return function(n){var s,o;return s={initialize:!0,identify:t.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},n=t.mixin(s,n||{}),!n.datumTokenizer&&e.error("datumTokenizer is required"),!n.queryTokenizer&&e.error("queryTokenizer is required"),o=n.sorter,n.sorter=o?function(e){return e.sort(o)}:t.identity,n.local=t.isFunction(n.local)?n.local():n.local,n.prefetch=i(n.prefetch),n.remote=r(n.remote),n}}(),d=function(){"use strict";function n(e){e=u(e),this.sorter=e.sorter,this.identify=e.identify,this.sufficient=e.sufficient,this.local=e.local,this.remote=e.remote?new c(e.remote):null,this.prefetch=e.prefetch?new l(e.prefetch):null,this.index=new a({identify:this.identify,datumTokenizer:e.datumTokenizer,queryTokenizer:e.queryTokenizer}),e.initialize!==!1&&this.initialize()}var r;return r=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=r),n},n.tokenizers=i,t.mixin(n.prototype,{__ttAdapter:function(){function e(e,t,i){return n.search(e,t,i)}function t(e,t){return n.search(e,t)}var n=this;return this.remote?e:t},_loadPrefetch:function(){function t(e,t){return e?n.reject():(r.add(t),r.prefetch.store(r.index.serialize()),void n.resolve())}var n,i,r=this;return n=e.Deferred(),this.prefetch?(i=this.prefetch.fromCache())?(this.index.bootstrap(i),n.resolve()):this.prefetch.fromNetwork(t):n.resolve(),n.promise()},_initialize:function(){function e(){t.add(t.local)}var t=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(e),this.initPromise},initialize:function(e){return!this.initPromise||e?this._initialize():this.initPromise},add:function(e){return this.index.add(e),this},get:function(e){return e=t.isArray(e)?e:[].slice.call(arguments),this.index.get(e)},search:function(e,n,i){function r(e){var n=[];t.each(e,function(e){!t.some(s,function(t){return o.identify(e)===o.identify(t)})&&n.push(e)}),i&&i(n)}var s,o=this;return s=this.sorter(this.index.search(e)),n(this.remote?s.slice():s),this.remote&&s.length<this.sufficient?this.remote.get(e,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return o.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}();return d}),function(e,t){"function"==typeof define&&define.amd?define("typeahead.js",["jquery"],function(e){return t(e)}):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(this,function(e){var t=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(e){return!e||/^\s*$/.test(e)},escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isArray:e.isArray,isFunction:e.isFunction,isObject:e.isPlainObject,isUndefined:function(e){return"undefined"==typeof e},isElement:function(e){return!(!e||1!==e.nodeType)},isJQuery:function(t){return t instanceof e},toStr:function(e){return t.isUndefined(e)||null===e?"":e+""},bind:e.proxy,each:function(t,n){function i(e,t){return n(t,e)}e.each(t,i)},map:e.map,filter:e.grep,every:function(t,n){var i=!0;return t?(e.each(t,function(e,r){return(i=n.call(null,r,e,t))?void 0:!1}),!!i):i},some:function(t,n){var i=!1;return t?(e.each(t,function(e,r){return(i=n.call(null,r,e,t))?!1:void 0}),!!i):i},mixin:e.extend,identity:function(e){return e},clone:function(t){return e.extend(!0,{},t)},getIdGenerator:function(){var e=0;return function(){return e++}},templatify:function(t){function n(){return String(t)}return e.isFunction(t)?t:n},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var i,r;return function(){var s,o,a=this,l=arguments;return s=function(){i=null,n||(r=e.apply(a,l))},o=n&&!i,clearTimeout(i),i=setTimeout(s,t),o&&(r=e.apply(a,l)),r}},throttle:function(e,t){var n,i,r,s,o,a;return o=0,a=function(){o=new Date,r=null,s=e.apply(n,i)},function(){var l=new Date,c=t-(l-o);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,o=l,s=e.apply(n,i)):r||(r=setTimeout(a,c)),s}},stringify:function(e){return t.isString(e)?e:JSON.stringify(e)},noop:function(){}}}(),n=function(){"use strict";function e(e){var o,a;return a=t.mixin({},s,e),o={css:r(),classes:a,html:n(a),selectors:i(a)},{css:o.css,html:o.html,classes:o.classes,selectors:o.selectors,mixin:function(e){t.mixin(e,o)}}}function n(e){return{wrapper:'<span class="'+e.wrapper+'"></span>',menu:'<div class="'+e.menu+'"></div>'}}function i(e){var n={};return t.each(e,function(e,t){n[t]="."+e}),n}function r(){var e={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return t.isMsie()&&t.mixin(e.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),e}var s={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return e}(),i=function(){"use strict";function n(t){t&&t.el||e.error("EventBus initialized without el"),this.$el=e(t.el)}var i,r;return i="typeahead:",r={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},t.mixin(n.prototype,{_trigger:function(t,n){var r;return r=e.Event(i+t),(n=n||[]).unshift(r),this.$el.trigger.apply(this.$el,n),r},before:function(e){var t,n;return t=[].slice.call(arguments,1),n=this._trigger("before"+e,t),n.isDefaultPrevented()},trigger:function(e){var t;this._trigger(e,[].slice.call(arguments,1)),(t=r[e])&&this._trigger(t,[].slice.call(arguments,1))}}),n}(),r=function(){"use strict";function e(e,t,n,i){var r;if(!n)return this;for(t=t.split(l),n=i?a(n,i):n,this._callbacks=this._callbacks||{};r=t.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][e].push(n);return this}function t(t,n,i){return e.call(this,"async",t,n,i)}function n(t,n,i){return e.call(this,"sync",t,n,i)}function i(e){var t;if(!this._callbacks)return this;for(e=e.split(l);t=e.shift();)delete this._callbacks[t];return this}function r(e){var t,n,i,r,o;if(!this._callbacks)return this;for(e=e.split(l),i=[].slice.call(arguments,1);(t=e.shift())&&(n=this._callbacks[t]);)r=s(n.sync,this,[t].concat(i)),o=s(n.async,this,[t].concat(i)),r()&&c(o);return this}function s(e,t,n){function i(){for(var i,r=0,s=e.length;!i&&s>r;r+=1)i=e[r].apply(t,n)===!1;return!i}return i}function o(){var e;return e=window.setImmediate?function(e){setImmediate(function(){e()})}:function(e){setTimeout(function(){e()},0)}}function a(e,t){return e.bind?e.bind(t):function(){e.apply(t,[].slice.call(arguments,0))}}var l=/\s+/,c=o();return{onSync:n,onAsync:t,off:i,trigger:r}}(),s=function(e){"use strict";function n(e,n,i){for(var r,s=[],o=0,a=e.length;a>o;o++)s.push(t.escapeRegExChars(e[o]));return r=i?"\\b("+s.join("|")+")\\b":"("+s.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function s(t){var n,i,s;return(n=a.exec(t.data))&&(s=e.createElement(r.tagName),r.className&&(s.className=r.className),i=t.splitText(n.index),i.splitText(n[0].length),s.appendChild(i.cloneNode(!0)),t.parentNode.replaceChild(s,i)),!!n}function o(e,t){for(var n,i=3,r=0;r<e.childNodes.length;r++)n=e.childNodes[r],n.nodeType===i?r+=t(n)?1:0:o(n,t)}var a;r=t.mixin({},i,r),r.node&&r.pattern&&(r.pattern=t.isArray(r.pattern)?r.pattern:[r.pattern],a=n(r.pattern,r.caseSensitive,r.wordsOnly),o(r.node,s))}}(window.document),o=function(){"use strict";function n(n,r){n=n||{},n.input||e.error("input is missing"),r.mixin(this),this.$hint=e(n.hint),this.$input=e(n.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=i(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=t.noop)}function i(t){return e('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:t.css("font-family"),fontSize:t.css("font-size"),fontStyle:t.css("font-style"),fontVariant:t.css("font-variant"),fontWeight:t.css("font-weight"),wordSpacing:t.css("word-spacing"),letterSpacing:t.css("letter-spacing"),textIndent:t.css("text-indent"),textRendering:t.css("text-rendering"),textTransform:t.css("text-transform")}).insertAfter(t)}function s(e,t){return n.normalizeQuery(e)===n.normalizeQuery(t)}function o(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey}var a;return a={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(e){return t.toStr(e).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},t.mixin(n.prototype,r,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(e){var t=a[e.which||e.keyCode];this._managePreventDefault(t,e),t&&this._shouldTrigger(t,e)&&this.trigger(t+"Keyed",e)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(e,t){var n;switch(e){case"up":case"down":n=!o(t);break;default:n=!1}n&&t.preventDefault()},_shouldTrigger:function(e,t){var n;switch(e){case"tab":n=!o(t);break;default:n=!0}return n},_checkLanguageDirection:function(){var e=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==e&&(this.dir=e,this.$hint.attr("dir",e),this.trigger("langDirChanged",e))},_setQuery:function(e,t){var n,i;n=s(e,this.query),i=n?this.query.length!==e.length:!1,this.query=e,t||n?!t&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var e,n,i,r,s=this;return e=t.bind(this._onBlur,this),n=t.bind(this._onFocus,this),i=t.bind(this._onKeydown,this),r=t.bind(this._onInput,this),this.$input.on("blur.tt",e).on("focus.tt",n).on("keydown.tt",i),!t.isMsie()||t.isMsie()>9?this.$input.on("input.tt",r):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(e){a[e.which||e.keyCode]||t.defer(t.bind(s._onInput,s,e))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(e,t){this.setInputValue(e),this._setQuery(e,t)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(e){this.$input.val(e),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(e){this.$hint.val(e)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var e,t,n,i;e=this.getInputValue(),t=this.getHint(),n=e!==t&&0===t.indexOf(e),i=""!==e&&n&&!this.hasOverflow(),!i&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var e=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=e},isCursorAtEnd:function(){var e,n,i;return e=this.$input.val().length,n=this.$input[0].selectionStart,t.isNumber(n)?n===e:document.selection?(i=document.selection.createRange(),i.moveStart("character",-e),e===i.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=e("<div>")}}),n}(),a=function(){"use strict";function n(n,r){n=n||{},n.templates=n.templates||{},n.templates.notFound=n.templates.notFound||n.templates.empty,n.source||e.error("missing source"),n.node||e.error("missing node"),n.name&&!a(n.name)&&e.error("invalid dataset name: "+n.name),r.mixin(this),this.highlight=!!n.highlight,this.name=n.name||c(),this.limit=n.limit||5,this.displayFn=i(n.display||n.displayKey),this.templates=o(n.templates,this.displayFn),this.source=n.source.__ttAdapter?n.source.__ttAdapter():n.source,this.async=t.isUndefined(n.async)?this.source.length>2:!!n.async,this._resetLastSuggestion(),this.$el=e(n.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function i(e){function n(t){return t[e]}return e=e||t.stringify,t.isFunction(e)?e:n}function o(n,i){function r(t){return e("<div>").text(i(t))}return{notFound:n.notFound&&t.templatify(n.notFound),pending:n.pending&&t.templatify(n.pending),header:n.header&&t.templatify(n.header),footer:n.footer&&t.templatify(n.footer),suggestion:n.suggestion||r}}function a(e){return/^[_a-zA-Z0-9-]+$/.test(e)}var l,c;return l={val:"tt-selectable-display",obj:"tt-selectable-object"},c=t.getIdGenerator(),n.extractData=function(t){var n=e(t);return n.data(l.obj)?{val:n.data(l.val)||"",obj:n.data(l.obj)||null}:null},t.mixin(n.prototype,r,{_overwrite:function(e,t){t=t||[],t.length?this._renderSuggestions(e,t):this.async&&this.templates.pending?this._renderPending(e):!this.async&&this.templates.notFound?this._renderNotFound(e):this._empty(),this.trigger("rendered",this.name,t,!1)},_append:function(e,t){t=t||[],t.length&&this.$lastSuggestion.length?this._appendSuggestions(e,t):t.length?this._renderSuggestions(e,t):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(e),this.trigger("rendered",this.name,t,!0)},_renderSuggestions:function(e,t){var n;n=this._getSuggestionsFragment(e,t),this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(e,t)).append(this._getFooter(e,t))},_appendSuggestions:function(e,t){var n,i;n=this._getSuggestionsFragment(e,t),i=n.children().last(),this.$lastSuggestion.after(n),this.$lastSuggestion=i},_renderPending:function(e){var t=this.templates.pending;this._resetLastSuggestion(),t&&this.$el.html(t({query:e,dataset:this.name}))},_renderNotFound:function(e){var t=this.templates.notFound;this._resetLastSuggestion(),t&&this.$el.html(t({query:e,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(n,i){var r,o=this;return r=document.createDocumentFragment(),t.each(i,function(t){var i,s;s=o._injectQuery(n,t),i=e(o.templates.suggestion(s)).data(l.obj,t).data(l.val,o.displayFn(t)).addClass(o.classes.suggestion+" "+o.classes.selectable),r.appendChild(i[0])}),this.highlight&&s({className:this.classes.highlight,node:r,pattern:n}),e(r)},_getFooter:function(e,t){return this.templates.footer?this.templates.footer({query:e,suggestions:t,dataset:this.name}):null},_getHeader:function(e,t){return this.templates.header?this.templates.header({query:e,suggestions:t,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=e()},_injectQuery:function(e,n){return t.isObject(n)?t.mixin({_query:e},n):n},update:function(t){function n(e){o||(o=!0,e=(e||[]).slice(0,r.limit),a=e.length,r._overwrite(t,e),a<r.limit&&r.async&&r.trigger("asyncRequested",t))}function i(n){n=n||[],!s&&a<r.limit&&(r.cancel=e.noop,a+=n.length,r._append(t,n.slice(0,r.limit-a)),r.async&&r.trigger("asyncReceived",t))}var r=this,s=!1,o=!1,a=0;this.cancel(),this.cancel=function(){s=!0,r.cancel=e.noop,r.async&&r.trigger("asyncCanceled",t)},this.source(t,n,i),!o&&n([])},cancel:e.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=e("<div>")}}),n}(),l=function(){"use strict";function n(n,i){function r(t){var n=s.$node.find(t.node).first();return t.node=n.length?n:e("<div>").appendTo(s.$node),new a(t,i)}var s=this;n=n||{},n.node||e.error("node is required"),i.mixin(this),this.$node=e(n.node),this.query=null,this.datasets=t.map(n.datasets,r)}return t.mixin(n.prototype,r,{_onSelectableClick:function(t){this.trigger("selectableClicked",e(t.currentTarget))
},_onRendered:function(e,t,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",t,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function e(e){return e.isEmpty()}return t.every(this.datasets,e)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var e=this.getActiveSelectable();e&&e.removeClass(this.classes.cursor)},_ensureVisible:function(e){var t,n,i,r;t=e.position().top,n=t+e.outerHeight(!0),i=this.$node.scrollTop(),r=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),0>t?this.$node.scrollTop(i+t):n>r&&this.$node.scrollTop(i+(n-r))},bind:function(){var e,n=this;return e=t.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,e),t.each(this.datasets,function(e){e.onSync("asyncRequested",n._propagate,n).onSync("asyncCanceled",n._propagate,n).onSync("asyncReceived",n._propagate,n).onSync("rendered",n._onRendered,n).onSync("cleared",n._onCleared,n)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(e){this.$node.attr("dir",e)},selectableRelativeToCursor:function(e){var t,n,i,r;return n=this.getActiveSelectable(),t=this._getSelectables(),i=n?t.index(n):-1,r=i+e,r=(r+1)%(t.length+1)-1,r=-1>r?t.length-1:r,-1===r?null:t.eq(r)},setCursor:function(e){this._removeCursor(),(e=e&&e.first())&&(e.addClass(this.classes.cursor),this._ensureVisible(e))},getSelectableData:function(e){return e&&e.length?a.extractData(e):null},getActiveSelectable:function(){var e=this._getSelectables().filter(this.selectors.cursor).first();return e.length?e:null},getTopSelectable:function(){var e=this._getSelectables().first();return e.length?e:null},update:function(e){function n(t){t.update(e)}var i=e!==this.query;return i&&(this.query=e,t.each(this.datasets,n)),i},empty:function(){function e(e){e.clear()}t.each(this.datasets,e),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function n(e){e.destroy()}this.$node.off(".tt"),this.$node=e("<div>"),t.each(this.datasets,n)}}),n}(),c=function(){"use strict";function e(){l.apply(this,[].slice.call(arguments,0))}var n=l.prototype;return t.mixin(e.prototype,l.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),n.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),n.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(e){return this.$node.css("ltr"===e?this.css.ltr:this.css.rtl),n.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),e}(),u=function(){"use strict";function n(n,r){var s,o,a,l,c,u,d,h,p,g,f;n=n||{},n.input||e.error("missing input"),n.menu||e.error("missing menu"),n.eventBus||e.error("missing event bus"),r.mixin(this),this.eventBus=n.eventBus,this.minLength=t.isNumber(n.minLength)?n.minLength:1,this.input=n.input,this.menu=n.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),s=i(this,"activate","open","_onFocused"),o=i(this,"deactivate","_onBlurred"),a=i(this,"isActive","isOpen","_onEnterKeyed"),l=i(this,"isActive","isOpen","_onTabKeyed"),c=i(this,"isActive","_onEscKeyed"),u=i(this,"isActive","open","_onUpKeyed"),d=i(this,"isActive","open","_onDownKeyed"),h=i(this,"isActive","isOpen","_onLeftKeyed"),p=i(this,"isActive","isOpen","_onRightKeyed"),g=i(this,"_openIfActive","_onQueryChanged"),f=i(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",s,this).onSync("blurred",o,this).onSync("enterKeyed",a,this).onSync("tabKeyed",l,this).onSync("escKeyed",c,this).onSync("upKeyed",u,this).onSync("downKeyed",d,this).onSync("leftKeyed",h,this).onSync("rightKeyed",p,this).onSync("queryChanged",g,this).onSync("whitespaceChanged",f,this).onSync("langDirChanged",this._onLangDirChanged,this)}function i(e){var n=[].slice.call(arguments,1);return function(){var i=[].slice.call(arguments);t.each(n,function(t){return e[t].apply(e,i)})}}return t.mixin(n.prototype,{_hacks:function(){var n,i;n=this.input.$input||e("<div>"),i=this.menu.$node||e("<div>"),n.on("blur.tt",function(e){var r,s,o;r=document.activeElement,s=i.is(r),o=i.has(r).length>0,t.isMsie()&&(s||o)&&(e.preventDefault(),e.stopImmediatePropagation(),t.defer(function(){n.focus()}))}),i.on("mousedown.tt",function(e){e.preventDefault()})},_onSelectableClicked:function(e,t){this.select(t)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(e,t,n,i){this._updateHint(),this.eventBus.trigger("render",n,i,t)},_onAsyncRequested:function(e,t,n){this.eventBus.trigger("asyncrequest",n,t)},_onAsyncCanceled:function(e,t,n){this.eventBus.trigger("asynccancel",n,t)},_onAsyncReceived:function(e,t,n){this.eventBus.trigger("asyncreceive",n,t)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(e,t){var n;(n=this.menu.getActiveSelectable())&&this.select(n)&&t.preventDefault()},_onTabKeyed:function(e,t){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&t.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&t.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(e,t){this._minLengthMet(t)?this.menu.update(t):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(e,t){this.dir!==t&&(this.dir=t,this.menu.setLanguageDirection(t))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(e){return e=t.isString(e)?e:this.input.getQuery()||"",e.length>=this.minLength},_updateHint:function(){var e,n,i,r,s,a,l;e=this.menu.getTopSelectable(),n=this.menu.getSelectableData(e),i=this.input.getInputValue(),!n||t.isBlankString(i)||this.input.hasOverflow()?this.input.clearHint():(r=o.normalizeQuery(i),s=t.escapeRegExChars(r),a=new RegExp("^(?:"+s+")(.+$)","i"),l=a.exec(n.val),l&&this.input.setHint(i+l[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return this.isActive()?!0:!this.isEnabled()||this.eventBus.before("active")?!1:(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return this.isActive()?this.eventBus.before("idle")?!1:(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0):!0},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(e){this.input.setQuery(t.toStr(e))},getVal:function(){return this.input.getQuery()},select:function(e){var t=this.menu.getSelectableData(e);return t&&!this.eventBus.before("select",t.obj)?(this.input.setQuery(t.val,!0),this.eventBus.trigger("select",t.obj),this.close(),!0):!1},autocomplete:function(e){var t,n,i;return t=this.input.getQuery(),n=this.menu.getSelectableData(e),i=n&&t!==n.val,i&&!this.eventBus.before("autocomplete",n.obj)?(this.input.setQuery(n.val),this.eventBus.trigger("autocomplete",n.obj),!0):!1},moveCursor:function(e){var t,n,i,r,s;return t=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(e),i=this.menu.getSelectableData(n),r=i?i.obj:null,s=this._minLengthMet()&&this.menu.update(t),s||this.eventBus.before("cursorchange",r)?!1:(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),n}();!function(){"use strict";function r(t,n){t.each(function(){var t,i=e(this);(t=i.data(f.typeahead))&&n(t,i)})}function s(e,t){return e.clone().addClass(t.classes.hint).removeData().css(t.css.hint).css(d(e)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function a(e,t){e.data(f.attrs,{dir:e.attr("dir"),autocomplete:e.attr("autocomplete"),spellcheck:e.attr("spellcheck"),style:e.attr("style")}),e.addClass(t.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!e.attr("dir")&&e.attr("dir","auto")}catch(n){}return e}function d(e){return{backgroundAttachment:e.css("background-attachment"),backgroundClip:e.css("background-clip"),backgroundColor:e.css("background-color"),backgroundImage:e.css("background-image"),backgroundOrigin:e.css("background-origin"),backgroundPosition:e.css("background-position"),backgroundRepeat:e.css("background-repeat"),backgroundSize:e.css("background-size")}}function h(e){var n,i;n=e.data(f.www),i=e.parent().filter(n.selectors.wrapper),t.each(e.data(f.attrs),function(n,i){t.isUndefined(n)?e.removeAttr(i):e.attr(i,n)}),e.removeData(f.typeahead).removeData(f.www).removeData(f.attr).removeClass(n.classes.input),i.length&&(e.detach().insertAfter(i),i.remove())}function p(n){var i,r;return i=t.isJQuery(n)||t.isElement(n),r=i?e(n).first():[],r.length?r:null}var g,f,m;g=e.fn.typeahead,f={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},m={initialize:function(r,d){function h(){var n,h,m,_,v,y,C,b,T,w,A;t.each(d,function(e){e.highlight=!!r.highlight}),n=e(this),h=e(g.html.wrapper),m=p(r.hint),_=p(r.menu),v=r.hint!==!1&&!m,y=r.menu!==!1&&!_,v&&(m=s(n,g)),y&&(_=e(g.html.menu).css(g.css.menu)),m&&m.val(""),n=a(n,g),(v||y)&&(h.css(g.css.wrapper),n.css(v?g.css.input:g.css.inputWithNoHint),n.wrap(h).parent().prepend(v?m:null).append(y?_:null)),A=y?c:l,C=new i({el:n}),b=new o({hint:m,input:n},g),T=new A({node:_,datasets:d},g),w=new u({input:b,menu:T,eventBus:C,minLength:r.minLength},g),n.data(f.www,g),n.data(f.typeahead,w)}var g;return d=t.isArray(d)?d:[].slice.call(arguments,1),r=r||{},g=n(r.classNames),this.each(h)},isEnabled:function(){var e;return r(this.first(),function(t){e=t.isEnabled()}),e},enable:function(){return r(this,function(e){e.enable()}),this},disable:function(){return r(this,function(e){e.disable()}),this},isActive:function(){var e;return r(this.first(),function(t){e=t.isActive()}),e},activate:function(){return r(this,function(e){e.activate()}),this},deactivate:function(){return r(this,function(e){e.deactivate()}),this},isOpen:function(){var e;return r(this.first(),function(t){e=t.isOpen()}),e},open:function(){return r(this,function(e){e.open()}),this},close:function(){return r(this,function(e){e.close()}),this},select:function(t){var n=!1,i=e(t);return r(this.first(),function(e){n=e.select(i)}),n},autocomplete:function(t){var n=!1,i=e(t);return r(this.first(),function(e){n=e.autocomplete(i)}),n},moveCursor:function(e){var t=!1;return r(this.first(),function(n){t=n.moveCursor(e)}),t},val:function(e){var t;return arguments.length?(r(this,function(t){t.setVal(e)}),this):(r(this.first(),function(e){t=e.getVal()}),t)},destroy:function(){return r(this,function(e,t){h(t),e.destroy()}),this}},e.fn.typeahead=function(e){return m[e]?m[e].apply(this,[].slice.call(arguments,1)):m.initialize.apply(this,arguments)},e.fn.typeahead.noConflict=function(){return e.fn.typeahead=g,this}}()}),jQuery(document).onZonesAndDomReady(function(){"use strict";function e(e,t,n){jQuery(e).off(t).on(t,n)}function t(){f.CurrentWidth.getClientWidth()>f.minWidthForExpandElements?(fastdom.read(function(){e(".js__image--expandable","click",function(){var e=jQuery(this),t=e.find(".el__image__expand--expandable");fastdom.write(function(){e.stop().animate({width:"100%"},v,function(){f.ResponsiveImages.processChildrenImages(this)}).show().addClass("el__image--expandfull").removeClass("el__image--expandable"),t.slideUp(v),t.siblings().first().slideDown(v)})})}),fastdom.read(function(){e(".js__image__close--expandable","click",function(e){var t=jQuery(this);fastdom.write(function(){t.parent().stop().animate({width:m},v,function(){f.ResponsiveImages.processChildrenImages(this)}).show().addClass("el__image--expandable").removeClass("el__image--expandfull"),t.slideUp(v),t.siblings().last().slideDown(v)}),e.stopPropagation()})}),fastdom.write(function(){jQuery(".el__image--expandable .el__image__expand--expandable").show(),jQuery(".el__image--expandfull .el__image__close--expandable").show()})):fastdom.write(function(){jQuery(".el__image__close--expandable").hide(),jQuery(".el__image__expand--expandable").hide(),jQuery(".js__image--expandable").off()})}function n(e,t){fastdom.read(function(){var n=t.parent(),i=t.siblings();"undefined"==typeof g&&(g=n.width()),fastdom.write(function(){n.stop().animate({width:"100%"},v,function(){i.eq(2).find(".el__video__play-button").triggerHandler("click")}),n.show().addClass("el__video--expandfull").removeClass(e),i.eq(2).children().eq(1).show(),i.eq(2).children().eq(0).hide(),t.hide(),f.CurrentWidth.getClientWidth()>f.minWidthForExpandElements?(i.first().show(),i.first().css("display","block")):(i.first().hide(),i.first().css("display","none"))})})}function i(e,t,n){var i,r=".js-media__video .js-video__end-slate",s=t.parent(),o=t.siblings();fastdom.write(function(){o.last().show(),s.stop().animate({width:g},v,function(){s.removeAttr("style")}),s.show().addClass(e).removeClass("el__video--expandfull"),o.eq(1).children().eq(1).hide(),o.eq(1).children().eq(0).show(),o.eq(1).children().eq(0).css("position","relative"),t.hide()}),i=t.parent().find(r).eq(0),fastdom.write(function(){i.removeClass("video__end-slate--active").addClass("video__end-slate--inactive"),s.find(".js-video-demand").show()}),n.stopPropagation()}function r(){f.CurrentWidth.getClientWidth()>f.minWidthForExpandElements?(e(".js__video--standard","click",function(){n("el__video--standard",jQuery(this).find(".el__video__expand--standard"))}),e(".js__video--expandable","click",function(){n("el__video--expandable",jQuery(this).find(".el__video__expand--expandable"))}),e(".js__video__close--standard","click",function(e){i("el__video--standard",jQuery(this),e)}),e(".js__video__close--expandable","click",function(e){i("el__video--expandable",jQuery(this),e)}),fastdom.write(function(){jQuery(".el__video--expandfull .el__video__close--standard").show(),jQuery(".el__video--expandfull .el__video__close--expandable").show(),jQuery(".el__video--expandable .el__video__expand--expandable").show(),jQuery(".el__video--standard .el__video__expand--standard").show(),jQuery(".el__video--standard .el__video__play-button").hide(),jQuery(".el__video--standard .el__video__play-button-wrapper").hide()})):fastdom.write(function(){jQuery(".el__video__close--standard").hide(),jQuery(".el__video__expand--standard").hide(),jQuery(".el__video--standard .el__video__play-button").hide(),jQuery(".el__video__close--expandable").hide(),jQuery(".el__video__expand--expandable").hide(),jQuery(".el__video--expandable .el__video__play-button").hide(),jQuery(".el__video__play-button-wrapper").show(),jQuery(".js-video-demand").hide(),f.orientationLandscape===!0&&jQuery(".js-video-demand").show()}),T===!1&&f.orientationLandscape===!0&&(jQuery(".js__video--standard").each(function(){var e=jQuery(this);0===e.find(".js-el__video__play-button").size()?(e.find(".js-video-demand").hide(),f.orientationLandscape===!0&&n("el__video--standard",e.find(".el__video__expand--standard"))):fastdom.write(function(){e.find(".js-video-demand").show()})}),jQuery(".js__video--expandable").each(function(){var e=jQuery(this);0===e.find(".js-el__video__play-button").size()?(e.find(".js-video-demand").hide(),f.orientationLandscape===!0&&n("el__video--expandable",e.find(".el__video__expand--expandable"))):fastdom.write(function(){e.find(".js-video-demand").show()})})),T=!1}function s(e,t,n){fastdom.read(function(){if("undefined"==typeof p&&(p=t.parent().width()),f.CurrentWidth.getClientWidth()>f.minWidthForExpandElements){var i,r=t.siblings(),s=r.eq(1),o=r.eq(2),a=o.find(".js-owl-carousel");fastdom.write(function(){r.first().show(),r.find(".media__icon").hide("slow"),t.parent().stop().animate({width:"100%"},v,function(){s.attr("style","display: none;"),o.attr("style","display: block;"),o.find(".js-owl-carousel").trigger(f.Carousel.events.refresh),i=9*a.find(".owl-item").find(".el__resize, .media").width()/16/2-y,a.find(".owl-prev, .owl-next").css("top",i+"px"),a.siblings(".ad-slide").find(".ad-slide__prev, .ad-slide__next").css("top",i+"px")}),t.parent().show().addClass("el__gallery--expandfull").removeClass(e),t.hide()}),("undefined"==typeof o.attr("isExtended")||"false"===o.attr("isExtended"))&&(setTimeout(function(){u(jQuery(o.find(".owl-wrapper-outer")),!0,!0)},2e3),o.attr("isExtended","true"))}else n.stopPropagation()})}function o(e,t,n){var i=t.siblings(),r=i.eq(0),s=i.eq(1),o=s.find(".owl-wrapper-outer"),a=o.find(".el__gallery_image-title"),l=o.find(".el__gallery-caption");fastdom.write(function(){r.show(),t.parent().stop().animate({width:p},v,function(){t.parent().show().addClass(e).removeClass("el__gallery--expandfull"),t.parent().removeAttr("style")}),i.last().show(),i.find(".media__icon").show(),t.hide(),s.css("display","none"),s.attr("isExtended","false")}),l.hasClass("el__gallery-caption--closed")&&(l.toggleClass("el__gallery-caption--closed"),a.toggle("slow"),l.text(l.hasClass("el__gallery-caption--closed")?"Show Caption":"Hide Caption")),n.stopPropagation()}function a(){f.CurrentWidth.getClientWidth()>f.minWidthForExpandElements?(e(".js__gallery--standard","click",function(e){s("el__gallery--standard",jQuery(this).find(".el__gallery__expand--standard"),e)}),e(".js__gallery--expandable","click",function(e){s("el__gallery--expandable",jQuery(this).find(".el__gallery__expand--expandable"),e)}),e(".js__gallery__close--standard","click",function(e){o("el__gallery--standard",jQuery(this),e)}),e(".js__gallery__close--expandable","click",function(e){o("el__gallery--expandable",jQuery(this),e)}),jQuery(".el__gallery--expandfull .el__gallery__close--standard").show(),jQuery(".el__gallery--expandfull .el__gallery__close--expandable").show(),jQuery(".el__gallery--expandable .el__gallery__expand--expandable").show(),jQuery(".el__gallery--expandable .el-carousel__wrapper").hide(),jQuery(".el__gallery--expandable .el__gallery--teaseimage").show(),jQuery(".el__gallery--standard .el__gallery__expand--standard").show(),jQuery(".el__gallery--standard .el-carousel__wrapper").hide(),jQuery(".el__gallery--standard .el__gallery--teaseimage").show()):(jQuery(".el-carousel__wrapper").show(),jQuery(".el__gallery--teaseimage").hide(),jQuery(".el__gallery__close--standard").hide(),jQuery(".el__gallery__expand--standard").hide(),jQuery(".el__gallery__close--expandable").hide(),jQuery(".el__gallery__expand--expandable").hide()),_===!1&&f.CurrentWidth.getClientWidth()<=f.showGalleryCaptionWidth&&l()}function l(){jQuery(".js__leafmedia--gallery").each(function(e,t){fastdom.write(function(){jQuery(".el__gallery_image-title",t).hide(),jQuery(".el__gallery-caption",t).addClass("el__gallery-caption--closed").text("Show Caption")})})}function c(e){var t=jQuery(e),n=t.closest(".owl-stage"),i=n.find(".el__gallery_image-title"),r=n.find(".el__gallery-caption");f.CurrentWidth.getClientWidth()>f.minWidthForExpandElements?r.hasClass("el__gallery-caption--closed")?(r.removeClass("el__gallery-caption--closed"),i.show()):(r.addClass("el__gallery-caption--closed"),i.hide()):(r.toggleClass("el__gallery-caption--closed"),i.toggle()),f.Carousel.refreshCarousels(),r.text(r.hasClass("el__gallery-caption--closed")?"Show Caption":"Hide Caption")}function u(e,t,n){var i=0,r=0,s=jQuery(".owl-item",e).each(function(){r=jQuery(this).height(),t&&jQuery(this).attr("owlItemHeight",r),r>i&&(i=r)});t&&jQuery(e).attr("max",i),s.each(function(){var i=jQuery(this),r=jQuery(".el__gallery-showhide",i);t||n?r.css("bottom",i.attr("owlItemHeight")-jQuery(e).attr("max")+"px"):r.css("bottom","0px")})}function d(e){if(e){var t,n;for(t=0,n=e.length;n>t;t++)u(e[t],!0,!0)}}function h(){t(),r(),a()}var p,g,f=window.CNN||{},m=jQuery(".js__image--expandable").width(),_=!1,v=700,y=30,C=window.CNN.VideoPlayer.isMobileClient(),b=jQuery(window),T=!0;f.CurrentWidth=f.CurrentWidth||{},f.CurrentWidth.getClientWidth=f.CurrentWidth.getClientWidth||jQuery.noop,f.minWidthForExpandElements=480,f.showGalleryCaptionWidth=640,f.orientationLandscape=!1,h(),C||jQuery(window).resize(function(){_=!0,h(),setTimeout(function(){d(jQuery(".owl-wrapper-outer"))},2e3)}),C&&b.on("orientationchange",function(){f.orientationLandscape=b.innerHeight/b.innerWidth>1?!1:!0,h(),f.Carousel.resetOnResize()}),jQuery(".js__image--expandable").on("touchstart",function(){jQuery(this).children().last().addClass("el__image--touchhover")}).on("touchcancel touchend",function(){jQuery(this).children().last().removeClass("el__image--touchhover")}),jQuery(".js__video--standard, .js__video--expandable").on("touchstart",function(){jQuery(this).addClass("el__video--touchhover")}).on("touchcancel touchend",function(){jQuery(this).removeClass("el__video--touchhover")}),jQuery(".js__gallery--standard, .js__gallery--expandable").on("touchstart",function(){jQuery(this).addClass("el__gallery--touchhover")}).on("touchcancel touchend",function(){jQuery(this).removeClass("el__gallery--touchhover")}),jQuery(".js-el__gallery-caption").on("click",function(){c(this)})});var nativo={},$staggeredZone,$staggeredColumn,$nativeContainer,layoutSize,$staggeredNativo,$authorDetails,$twitterImage,$nativeEmbedVideo,$bigPicture,isGalleryRendered=!1,epicScript,$nativeHubCarousel,isEpicRendered=!1;!function(){"use strict";function e(e,t){var n=jQuery(e).closest(document.getElementById("bigPicture")),i=n.find(".media__caption"),r=n.find(".el__gallery-caption");CNN.CurrentWidth=CNN.CurrentWidth||{},CNN.CurrentWidth.getClientWidth=CNN.CurrentWidth.getClientWidth||jQuery.noop,CNN.CurrentWidth.getClientWidth()>CNN.minWidthForExpandElements?r.hasClass("el__gallery-caption--closed")?r.removeClass("el__gallery-caption--closed"):r.addClass("el__gallery-caption--closed"):r.toggleClass("el__gallery-caption--closed"),i.toggle(t),r.text(r.hasClass("el__gallery-caption--closed")?"Show Caption":"Hide Caption")}function t(e){var t=jQuery(".js-pg-sponsor .owl-stage-outer .owl-stage .owl-item.synced"),i=t.next(),r=t.prev();"prev"===e?"undefined"!=typeof r&&r.length>0&&n(r):"undefined"!=typeof i&&i.length>0&&n(i)}function n(e){var t=jQuery(".js-pg-sponsor"),n=t.find(".cnngo-bigPicture"),i=n.find("img"),r=e.find(".link").attr("data-img-full");i.attr("src",r),e.parent().find(".owl-item").removeClass("synced"),e.addClass("synced"),n.find(".js-active-count").html(e.closest(".owl-item").index()+1),n.find(".image__caption").html(e.find(".link").attr("data-value"))}nativo={fbFeed:"",twFeed:"",social_hub:{icons:{twitter:"",facebook:"",linkedin:"",google:"",pinterest:"",instagram:""},fb_like:"",tw_follow:""}},nativo.renderAuthor=function(){"string"==typeof nativo.authorName&&nativo.authorName.length>0&&($authorDetails=jQuery(".js-sponsor-article-author"),$authorDetails.find(".js-author_name").text(nativo.authorName+","),$authorDetails.show())},nativo.renderEpic=function(){var e="international"===CNN.contentModel.edition?"cnni":"cnn";"string"==typeof nativo.epicAdName&&nativo.epicAdName.length>0&&!isEpicRendered&&(window.AMPTManager.processNewRegistry(CNN.epicAdRegistry+"/"+e+"_native_"+nativo.epicAdName+".js"),jQuery(".js-epicAd_Render").show(),isEpicRendered=!0)},nativo.renderFacebook=function(){if("string"==typeof nativo.fbFeed&&nativo.fbFeed.length>0){var e=encodeURIComponent(nativo.fbFeed),t=document.getElementById("fb-likebox");t.innerHTML='<iframe src="//www.facebook.com/plugins/likebox.php?href='+e+'&amp;width=300&amp;height=590&amp;show_faces=true&amp;colorscheme=light&amp;stream=true&amp;show_border=true&amp;header=true&amp;appId=70673860847" scrolling="no" frameborder="0" class="sponsor-content-fb" allowTransparency="true"></iframe>'}},nativo.renderTwitter=function(){"string"==typeof nativo.twFeed&&nativo.twFeed.length>0&&(jQuery(document.getElementById("tw-feedbox")).html(nativo.twFeed),jQuery(".js-right-rail-tw").show());var e,t=document.getElementsByTagName("script")[0];document.getElementById("twitter-wjs")||(e=document.createElement("script"),e.id="twitter-wjs",e.src="//platform.twitter.com/widgets.js",t.parentNode.insertBefore(e,t)),"string"==typeof nativo.twitterImage&&nativo.twitterImage.length>0&&($twitterImage=jQuery(".js-twitterImage"),$twitterImage.find("img").attr("src",nativo.twitterImage),$twitterImage.show())},nativo.renderGallery=function(){setTimeout(function(){jQuery(".js-pg-sponsor .owl-carousel").owlCarousel({slideSpeed:300,pagination:!0,paginationSpeed:400,items:9,nav:!0,navText:["",""],dots:!1,lazyLoad:!0,loop:!1,autoWidth:!0,autoHeight:!1});var n=jQuery(".js-pg-sponsor"),i=n.find(".cnngo-bigPicture"),r=i.find("img"),s=n.find(".owl-carousel").find(".link"),o=s.first().attr("data-img-full"),a=s.first().attr("data-value"),l=i.attr("data-title"),c=n.find(".owl-stage-outer .owl-stage"),u=c.find(".owl-item").length,d=1;0===i.find("img").length&&i.append("<img/>"),r.attr("src",o),i.append(n.find(".js-galleryCaption")),i.append(n.find(".js-owl-nav")),u>=1&&(i.find(".js-active-count").html(d),i.find(".js-total-count").html(u),i.find(".js-gallery-title").html(l),i.find(".el__storyelement__gray").html(" "+u+" Photos"),c.find(".owl-item").first().addClass("synced"),i.find(".image__caption").html(a)),s.on("click",function(){var e=jQuery(this);r.attr("src",e.data("imgFull")),e.parent().parent().find(".owl-item").removeClass("synced"),e.parent().addClass("synced"),i.find(".js-active-count").html(e.closest(".owl-item").index()+1),i.find(".image__caption").html(e.attr("data-value"))}),i.find(".js-el__gallery-caption").click(function(){e(this,"slow")}),i.find(".js-owl-prev").click(function(){t("prev")}),i.find(".js-owl-next").click(function(){t("next")}),changeOwlCarousalWidth()},800)},jQuery(window).resize(function(){setTimeout(function(){changeOwlCarousalWidth()},300)})}();
//# sourceMappingURL=cnn-header-second.min.js.map