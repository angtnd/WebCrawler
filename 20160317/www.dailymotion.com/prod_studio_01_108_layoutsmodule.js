self.studioLoader.context.evalInContext("var Rj=new B,Sj=new B,Tj=0,Uj=/(?:(.*)\\.)?([^\\.\\[]+)(?:\\[(\\d+)\\])?/;m(\"studio.sdk.layouts.config.declare\",function(a,b){Rj.L(a)||Rj.set(a,new Vj(a,b))},void 0);m(\"studio.sdk.layouts.config.instantiate\",function(a,b){return Rj.L(a)?Rj.get(a).create(b):null},void 0);var Xj=function(a){var b=Wj(a);return b||(b=Rj.get(a),b)?b:null},Zj=function(a){return Yj(a)?Sj.get(a[\"@id\"]):null},bk=function(a){return u(a)?(a=Zj(a))?a.a:null:ak(a)},ck=function(a){return(a=Zj(a))?a.a.b:null};m(\"studio.sdk.layouts.config.getType\",ck,void 0);m(\"studio.sdk.layouts.config.getPath\",function(a){return(a=Zj(a))?dk(a):null},void 0);var fk=function(a,b){var c,d,e;if(!Yj(a))return null;(d=Uj.exec(b))?(e=parseInt(d[3],10),isNaN(e)&&(e=null),c=d[1]||\"\",d=d[2]||\"\"):(c=\"\",d=b,e=null);c=ek(a,c);return Yj(c)?{ka:c,propertyName:d,index:e}:null},hk=function(a,b,c){if(a=fk(a,\"\")){var d=Zj(a.ka),e=a.propertyName,g=a.index;a=d;e&&(d=d.C()[e],r(g)&&(d=d[g]),(d=Zj(d))&&(a=d));d=!1;r(a.c)&&a.g&&(d=gk(a.b,a.g).i.a.contains(b+\"_\"+c));b=d||a.a.c.a.contains(b+\"_\"+c)?Fa(dk(a),\"::\",c):\"\"}else b=\"\";return b},ik=function(a){this.b=a},Vj=function(a,b){this.b=a;this.a=new B;this.c=new jk;kk(this,b)};x(Vj,ik);var kk=function(a,b){b&&z(b,function(a,b){lk(this.c,b,a)||this.a.set(b,new mk(0,b,a))},a)};Vj.prototype.create=function(a){var b=nk(this);y(this.a.M(),function(c){var d=this.a.get(c),e=void 0;a&&(e=a[c]);d=ok(d,e);b[c]=d;pk(b,c,d)},this);return b};var pk=function(a,b,c){a=a?Zj(a):null;if(fa(c))for(var d=0;d<c.length;d++){var e=d,g=Zj(c[d]);g&&qk(g,a,b,e)}else(c=Zj(c))&&qk(c,a,b,void 0)},rk=function(a,b){this.b=a;this.g=b};x(rk,ik);rk.prototype.create=function(a){return l(a)?a:this.g};var sk=new rk(\"string\",\"\"),tk=new rk(\"number\",0),uk=new rk(\"boolean\",!0),vk=new rk(\"url\",null),wk=new rk(\"color\",\"#000000\"),xk=new rk(\"image\",null),yk=new rk(\"video\",null),zk=new rk(\"asset\",null),Wj=function(a){switch(a.toLowerCase()){case \"string\":case \"str\":return sk;case \"integer\":case \"int\":case \"float\":case \"number\":return tk;case \"boolean\":case \"bool\":return uk;case \"url\":return vk;case \"color\":return wk;case \"image\":return xk;case \"video\":return yk;case \"asset\":return zk}},ak=function(a){switch(ea(a)){case \"number\":return tk;case \"boolean\":return uk;case \"string\":return sk;default:return ih(a),sk}},mk=function(a,b,c){this.h=b;this.a=new Cb;this.g=this.c=!1;this.b=void 0;this.i=new jk;switch(ea(c)){case \"string\":case \"number\":case \"boolean\":this.c=!1;this.g=!0;this.b=c;this.a.add(ak(this.b));break;case \"array\":Ak(this,c);break;case \"object\":Bk(this,c)}},Ak=function(a,b){0!=b.length&&(a.c=!0,a.g=!0,a.b=b,y(b,function(a){(a=ak(a))&&this.a.add(a)},a))},Bk=function(a,b){a.c=!!b[\"@array\"];a.g=!!b[\"@required\"];var c=b[\"@type\"];if(l(c))switch(ea(c)){case \"string\":a.a.add(Xj(c));break;case \"array\":y(c,function(a){(a=Xj(a))&&this.a.add(a)},a);break;default:return}else a.a.add(sk);a.b=void 0;b.hasOwnProperty(\"@value\")?(c=b[\"@value\"],l(c)?a.b=ok(a,c):a.b=void 0):a.a.na()||a.c||(a.b=a.a.G()[0].create(void 0));Ck(a.i,b)};mk.prototype.f=function(a){var b=this.a;if(!u(a))return a;var c=null;Yj(a)?c=bk(a):a.hasOwnProperty(\"@type\")?c=Rj.get(a[\"@type\"]):1==b.P()&&(c=b.G()[0]);return c&&b.contains(c)?c.create(a):null};var ok=function(a,b){var c=l(b)?b:a.b,d=void 0;a.c?l(c)?(n(c)||(c=[c]),d=La(c,v(a.f,a))):d=[]:l(c)&&(d=a.f(c));return!l(d)&&a.g?null:d},nk=function(a){var b={};b[\"@id\"]=Tj++;a=new Dk(a,b);Sj.set(a.v(),a);return b},Yj=function(a){var b=u(a)&&\"@id\"in a;b&&(b=a[\"@id\"],b=Sj.L(b)&&Sj.get(b).C()==a);return b},ek=function(a,b){var c=Zj(a);return c?Ek(c,b):null},Dk=function(a,b){this.f=b[\"@id\"];this.a=a;this.i=b;this.c=this.g=this.b=null};Dk.prototype.v=function(){return this.f};var gk=function(a,b){return a.a instanceof Vj?a.a.a.get(b):null};Dk.prototype.C=function(){return this.i};var dk=function(a){if(!a.b)return\"\";var b=dk(a.b);b&&(b+=\".\");b+=a.g;r(a.c)&&(b+=\"[\"+a.c+\"]\");return b},qk=function(a,b,c,d){(a.b=b)?(a.g=c,a.c=r(d)?d:null):(a.g=null,a.c=null)},Ek=function(a,b){if(!b)return a.C();var c;if(b){var d=/^(\\w+)(?:\\[(\\d+)\\])?(?:\\.(.*))?$/.exec(b);c=d?{lb:d[1],index:d[2]?parseInt(d[2],10):-1,mb:d[3]?d[3]:null}:null}else c=null;var e=c.lb,d=c.index;c=c.mb;if(!a.a.a.get(e))return null;e=a.C()[e];if(0<=d){if(!fa(e))return null;e=e[d]}if(c){d=Zj(e);if(!d)return null;e=Ek(d,c)}return e},jk=function(){this.a=new Cb},Fk=function(a,b,c){n(c)?y(c,function(a){this.a.add(b+\"_\"+a)},a):q(c)&&a.a.add(b+\"_\"+c)},Ck=function(a,b){b&&z(b,function(a,b){lk(this,b,a)},a)},lk=function(a,b,c){if(0!=b.lastIndexOf(\"@\",0))return!1;b=Da(b);switch(b){case \"exit\":return Fk(a,\"exit\",c),!0;case \"counter\":return Fk(a,\"counter\",c),!0;case \"timer\":return Fk(a,\"timer\",c),!0}return!1},Gk=function(a,b){var c=a[b];return n(c)?c:(ck(a),null)};var Ik=function(a){this.a=Zj(a);this.h=new Hk;this.c=new B;this.b=new B;this.i=new B;this.g=new B;this.f=new B},Jk=new B,Kk=function(a){if(!Yj(a))return null;var b=a[\"@id\"];Jk.L(b)||Jk.set(b,new Ik(a));return Jk.get(b)},Lk=function(a,b,c){a=fk(a,b);return!a||c&&!Gk(a.ka,a.propertyName)?null:(c=Kk(a.ka))?{controller:c,propertyName:a.propertyName,index:a.index}:null},W=function(a,b){var c=a.get(b);l(c)||(c=new Hk,a.set(b,c));return c},Nk=function(a){y(a.c.M(),function(a){var c=this.a.C()[a];W(this.c,a).a(c)},a);y(a.b.M(),function(a){for(var c=this.a.C()[a],d=0;d<c.length;d++){var e=c[d],g=d,k=c;W(this.b,a).a(e,g,k)}},a);y(a.g.M(),function(a){var c=this.a.C()[a];W(this.g,a).a(c)},a);Mk(a)},Mk=function(a){a.h.a(a.a.C());(a=a.a.b)&&Mk(Kk(a.C()))},Hk=function(){this.b=[]};Hk.prototype.add=function(a,b){var c=this.b,d={D:a,scope:b};0<=Ka(c,d)||c.push(d)};var Ok=function(a,b,c){var d=Na(a.b,function(a){return a.D==b&&a.scope==c});-1!=d&&Oa(a.b,d)};Hk.prototype.a=function(a){var b=arguments;y(this.b,function(a){a.D.apply(a.scope,b)})};m(\"studio.sdk.layouts.binding.addValueChangeListener\",function(a,b,c){(a=Kk(a))&&a.h.add(b,c)},void 0);m(\"studio.sdk.layouts.binding.removeValueChangeListener\",function(a,b,c){(a=Kk(a))&&Ok(a.h,b,c)},void 0);var Pk=function(a,b,c,d){(a=Lk(a,b))&&W(a.controller.c,a.propertyName).add(c,d)};m(\"studio.sdk.layouts.binding.addPropertyChangeListener\",Pk,void 0);m(\"studio.sdk.layouts.binding.removePropertyChangeListener\",function(a,b,c,d){(a=Lk(a,b))&&Ok(W(a.controller.c,a.propertyName),c,d)},void 0);var Qk=function(a,b,c,d){(a=Lk(a,b,!0))&&W(a.controller.b,a.propertyName).add(c,d)};m(\"studio.sdk.layouts.binding.addArrayInsertListener\",Qk,void 0);m(\"studio.sdk.layouts.binding.removeArrayInsertListener\",function(a,b,c,d){(a=Lk(a,b,!0))&&Ok(W(a.controller.b,a.propertyName),c,d)},void 0);var Rk=function(a,b,c,d){(a=Lk(a,b,!0))&&W(a.controller.i,a.propertyName).add(c,d)};m(\"studio.sdk.layouts.binding.addArrayRemoveListener\",Rk,void 0);m(\"studio.sdk.layouts.binding.removeArrayRemoveListener\",function(a,b,c,d){(a=Lk(a,b,!0))&&Ok(W(a.controller.i,a.propertyName),c,d)},void 0);m(\"studio.sdk.layouts.binding.addValueAddedListener\",function(a,b,c,d){(a=Lk(a,b))&&W(a.controller.g,a.propertyName).add(c,d)},void 0);m(\"studio.sdk.layouts.binding.removeValueAddedListener\",function(a,b,c,d){(a=Lk(a,b))&&Ok(W(a.controller.g,a.propertyName),c,d)},void 0);m(\"studio.sdk.layouts.binding.addValueRemovedListener\",function(a,b,c,d){(a=Lk(a,b))&&W(a.controller.f,a.propertyName).add(c,d)},void 0);m(\"studio.sdk.layouts.binding.removeValueRemovedListener\",function(a,b,c,d){(a=Lk(a,b))&&Ok(W(a.controller.f,a.propertyName),c,d)},void 0);var Sk=function(a){var b=Kk(a);if(b){Nk(b);for(var c in a)if(b=a[c],n(b))for(var d=0;d<b.length;d++)u(b[d])&&Sk(b[d]);else u(b)&&Sk(b)}};m(\"studio.sdk.layouts.binding.fireAllListeners\",Sk,void 0);var Tk=function(a,b,c){var d=Lk(a,b);if(d){a=d.controller;b=d.propertyName;var d=d.index,e=a.a.C(),g=e[b];gk(a.a,b);if(bk(c)){if(null!=d){var k=g,g=k[d];k[d]=c;c=k}else e[b]=c;pk(null,b,g);pk(e,b,c);d=c;W(a.c,b).a(d);Mk(a)}}};m(\"studio.sdk.layouts.binding.update\",Tk,void 0);var Yk=function(a,b){if(Yj(a)){var c=Zj(a);y(c.a instanceof Vj?c.a.a.M():null,function(d){var e=gk(c,d),g=a[d],k=b[d],p=null!=g?bk(g):e.a.G()[0];if(e.c){if(n(g))for(;0<g.length;)Uk(a,d,0);n(k)?y(k,function(b,c){Vk(a,d,b,c)}):null!=k&&Vk(a,d,k,0)}else p instanceof rk?Tk(a,d,k):p instanceof Vj&&(null!=k?Wk(a,d,k):null!=g&&Xk(a,d),null!=g&&null!=k&&Yk(g,k))})}};m(\"studio.sdk.layouts.binding.updateAll\",Yk,void 0);var Vk=function(a,b,c,d){if(b=Lk(a,b,!0)){a=b.controller;b=b.propertyName;var e=d,g=a.a.C();if(d=Gk(g,b)){c=gk(a.a,b).f(c);if(0>e||e>d.length)e=d.length;Ta(d,e,0,c);pk(g,b,d);W(a.b,b).a(c,e,d);Mk(a)}}};m(\"studio.sdk.layouts.binding.arrayInsert\",Vk,void 0);var Uk=function(a,b,c){if(b=Lk(a,b,!0)){a=b.controller;b=b.propertyName;var d=a.a.C(),e=Gk(d,b);if(e)if(0>c||c>=e.length)ck(d);else{var g=e[c];Oa(e,c);pk(null,b,g);pk(d,b,e);W(a.i,b).a(g,c,e);Mk(a)}}};m(\"studio.sdk.layouts.binding.arrayRemove\",Uk,void 0);var Wk=function(a,b,c){if(b=Lk(a,b)){a=b.controller;b=b.propertyName;var d=a.a.C(),e=d[b],g=gk(a.a,b);g&&(c=g.f(c),d[b]=c,pk(null,b,e),pk(d,b,c),e&&W(a.f,b).a(e),W(a.g,b).a(c),Mk(a))}};m(\"studio.sdk.layouts.binding.addValue\",Wk,void 0);var Xk=function(a,b){var c=Lk(a,b);if(c){var d=c.controller,c=c.propertyName,e=d.a.C();if(e[c]){var g=e[c];delete e[c];pk(null,c,g);pk(e,c,void 0);W(d.f,c).a(g);Mk(d)}}};m(\"studio.sdk.layouts.binding.removeValue\",Xk,void 0);var Zk=function(a,b){F.call(this);this.a=a;this.b=b;P().$a(\"livePreviewChannel\",v(this.c,this))};x(Zk,F);m(\"studio.sdk.layouts.PreviewHandler.CallbackMethods\",{Lc:\"showNode\",Ic:\"hideNode\",Hc:\"changeValue\",Kc:\"showMessage\"},void 0);Zk.prototype.c=function(a){q(a)&&(a=L(a));if(u(a)&&\"functionName\"in a){var b=a.args;switch(a.functionName){case \"updateValue\":if(3>b.length)break;a=b[0];var c=L(b[1]);this.pa(a,c,b[2]);break;case \"addArrayItem\":if(4>b.length)break;a=b[0];var c=b[1],d=L(b[2]),e=b[3];Vk(this.a,a?a+\".\"+c:c,$k(d,e),-1);break;case \"removeArrayItem\":if(3>b.length)break;a=b[0];var c=b[1],g=parseInt(b[2],10);Uk(this.a,a?a+\".\"+c:c,g);break;case \"updateArrayValue\":if(5>b.length)break;a=b[0];c=b[1];d=L(b[2]);e=b[3];g=parseInt(b[4],10);b=d;a=a?a+\".\"+c:c;Uk(this.a,a,g);Vk(this.a,a,$k(b,e),g);break;case \"addValue\":if(4>b.length)break;c=b[0];g=L(b[1]);a=b[2];e=b[3];Wk(this.a,a?a+\".\"+c:c,$k(g,e));break;case \"changeInputVariable\":if(2>b.length)break;c=b[0];switch(c){case \"assets\":this.b&&this.b(b[1])}break;case \"removeValue\":2>b.length||(c=b[0],a=b[1],Xk(this.a,a?a+\".\"+c:c))}}};Zk.prototype.pa=function(a,b){z(b,function(b,d){Tk(this.a,a?a+\".\"+d:d,b)},this)};Zk.prototype.updateValue=Zk.prototype.pa;var al=function(a,b){fg(P(),\"livePreviewMessage\",[{functionName:a,args:b}])},$k=function(a,b){return Xj(b).create(a)};m(\"studio.sdk.layouts.RUNTIME_MODE\",{FILLER:\"FILLER\",PLAY:\"PLAY\",TRAFFICK:\"TRAFFICK\",DEVELOPMENT:\"DEVELOPMENT\"},void 0);m(\"studio.sdk.layouts.FILLER_CONTEXT\",{CREATIVE:\"CREATIVE\",MANAGEMENT:\"MANAGEMENT\",NONE:\"NONE\"},void 0);new B;var bl=null;m(\"studio.sdk.layouts.register\",function(a,b){P();nh(w(cl,a,b))},void 0);var cl=function(a,b){var c=P();J(16)&&(bl=new Zk(a,dl));(c=c.ea())||(c=window.GdnLayout?L(GdnLayout.getConfig()):null);c&&Yk(a,c);b&&b(a)};m(\"studio.sdk.layouts.exit\",function(a,b,c){(a=hk(a,\"exit\",b))&&P().exit(a,c)},void 0);m(\"studio.sdk.layouts.exitQueryString\",function(a,b,c){(a=hk(a,\"exit\",b))&&P().gb(a,c)},void 0);m(\"studio.sdk.layouts.counter\",function(a,b,c){(a=hk(a,\"counter\",b))&&P().Ka(a,c)},void 0);m(\"studio.sdk.layouts.startTimer\",function(a,b){var c=hk(a,\"timer\",b);c&&P().startTimer(c)},void 0);m(\"studio.sdk.layouts.stopTimer\",function(a,b){var c=hk(a,\"timer\",b);c&&P().stopTimer(c)},void 0);var dl=function(a){Hg(P(),a)};m(\"studio.sdk.layouts.showFiller\",function(a){bl&&al(\"showNode\",[a])},void 0);m(\"studio.sdk.layouts.hideFiller\",function(a){bl&&al(\"hideNode\",[a])},void 0);m(\"studio.sdk.layouts.changeFillerValue\",function(a,b){bl&&(al(\"changeValue\",[a,b]),bl.pa(a,b,!1))},void 0);m(\"studio.sdk.layouts.showMessage\",function(a){bl&&al(\"showMessage\",[a])},void 0);m(\"studio.sdk.layouts.getRuntimeMode\",function(){switch(P().getParameter(\"layoutsRuntime\")){case \"AUTHORING\":return\"FILLER\";case \"TESTING\":return\"PLAY\";default:return P().ea()||window.GdnLayout&&null!=GdnLayout.getConfig()?\"TRAFFICK\":\"DEVELOPMENT\"}},void 0);m(\"studio.sdk.layouts.getFillerContext\",function(){switch(P().getParameter(\"fillerContext\")){case \"CREATIVE_FILLER\":return\"CREATIVE\";case \"MANAGEMENT_FILLER_PREVIEW\":return\"MANAGEMENT\";default:return\"NONE\"}},void 0);");
