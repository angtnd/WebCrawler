if(typeof(FKART)=="undefined"){FKART={}}FKART.AppOffer=new function(){var a=[],b=[];this.clearList=function(){a=[];b=[];fk_appoffer.updateTopBanner()};this.addAppOnly=function(c){if(a.indexOf(c)==-1){a.push(c);fk_appoffer.updateTopBanner()}};this.addOpenFsn=function(c){if(b.indexOf(c)==-1){b.push(c);fk_appoffer.updateTopBanner()}};this.updateTopBanner=function(){var e=$("#fk-header"),f=$(".fk-header-banner"),d=$(".apponly-text-some",f),g=$(".apponly-text-all",f),c=$(".apponly-text-default",f);if(a.length===0&&c.length===0){e.removeClass("banner-open");f.slideUp("slow")}else{if(!e.hasClass("banner-open")){e.addClass("banner-open");f.slideDown("slow")}if(a.length===0){d.hide();g.hide();c.show()}else{if(b.length===0){d.hide();g.show();c.hide()}else{d.show();g.hide();c.hide()}}}};this.updateUrl=function(){$(".fk-header-banner .app-link, .product-openx-ad .app-link, .facetList .app-link").data("url",window.location.pathname+window.location.search);$(".fk-header-banner .app-link, .product-openx-ad .app-link, .facetList .app-link").data("title",document.title);var c=$(".fk-header-banner .app-link");if(c.data("query").length==0&&FKART.urlParser().get("sid")=="undefined"){c.hide()}else{c.show()}}};fk_appoffer=FKART.AppOffer;FKART.appOfferPopup=function(ak){var K=$(ak),q=$(".app-link",K),D=$(".app-offers-button",K),W=$(".app-offers-container",K),Z=$(".appOnlyDialog-popup-content",K),M=$(".fk-question-mark",K),t,ai,ag,aC,P,aF,ah,y,V,A,at,ar,L,a,o,aB,c,v=false,T,k,aw=false,aq,al,f,r,au,e,N,h,R,av,J=false,H,ay=false,az,d,ap,Q,u,w,x,z,U,E,S,O,G,l,aj,C=false;if(Z.length==0){Z=$(".fk-mainfooter .appOnlyDialog-popup-content")}if(Z.length==0){Z=$(".appOnlyDialog-popup-content.forcedView")}function b(){D.on("click",function(){if(!C){aA("Opened");$(this).addClass("open");M.text("X");setTimeout(function(){W.slideDown(200);C=true},150)}else{aA("Closed");W.slideUp(200,function(){D.removeClass("open");M.text("?");C=false})}});q.on("click",function(aG){if(!q.hasClass("disabled")){n($(this));aA("Clicked");aE();aG.preventDefault()}})}function aE(){o=null;j();B();m();I();if(!FKART.login.isUserLoggedIn()){A.hide();am()}else{if(aw==true){A.show();t.hide();G=setTimeout(function(){v=true;$.ajax({url:"/lc/sendPushNotificationForAccount",data:{pid:az,lid:d,sid:ap,query:Q,offerid:H,title:u,subtitle:w,vertical:x,url:z,useDataUrl:ay},type:"POST",dataType:"json",success:function(aG){if(aG.deviceFound&&aG.notificationSent){an()}else{ad()}},error:function(){ad()}})},7000)}else{am();X()}}}function X(){$.ajax({url:"/lc/sendPushNotificationForAccount",data:{pid:az,lid:d,sid:ap,query:Q,offerid:H,title:u,subtitle:w,vertical:x,url:z,useDataUrl:ay},type:"POST",dataType:"json"})}function aA(aH){var aG={};if(aH=="Clicked"){aG.products=s.products}var aI=new Array("eVar1","eVar2","eVar3","eVar4","eVar5","eVar50","eVar55","prop1","prop2","prop3","prop4","prop35");for(i in aI){if(typeof s[aI[i]]!="undefined"){aG[aI[i]]=s[aI[i]]}if(aI[i]=="eVar55"&&U){aG[aI[i]]=U}}aG.prop21="OpenInApp_"+aH;FKART.omni.customEvent("App only offers",aG)}function an(){m();A.hide();if(E&&E.length>0){var aG=$("<img>");aG.attr("src",E);aF.append(aG)}else{aF.remove()}ai.show();ac();aA("PNSent")}function ad(){m();A.hide();ah.show();aA("PNFailed")}function I(){o=new FKART.ui.Dialog({showFooter:false,cssClass:"appOnlyDialog",body:Z.html(),destroyOnHide:true,width:"620px"});c=o.getContainer();A=c.find(".loadingDiv");t=c.find(".smsDiv");ai=c.find(".successDiv");ag=t.find(".stitle");P=t.find(".footerLoggedIn");aC=t.find(".footerNotLoggedIn");aF=ai.find(".phone-image span");aq=c.find(".smsForm");aB=c.find(".successPrefixDiv");ah=c.find(".errorDiv");at=c.find(".send-sms-fake-link");ar=c.find(".send-sms-link");L=c.find(".resend-sms-fake-link");a=c.find(".resend-sms-link");l=c.find(".timer");aj=c.find(".timerResendSMS");T=c.find(".retry-notification");o.show();if(!FKART.login.isUserLoggedIn()){aC.show();P.hide()}else{aC.hide();P.show()}af()}function af(){c.on("beforeHide",function(aG){j();B();m();J=false});ar.on("click",function(){ai.hide();aB.show();ah.hide();ag.remove();am();aA("PNExpired")});T.on("click",function(){o.hide();aw=true;aE();$status="PNTried";if(v){$status="PNReTried"}aA($status)})}function aa(){R=h.val();if(!(/^[789]\d{9}$/.test(R))){h.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}else{$.ajax({url:"/lc/sendSMSForNumber",type:"POST",data:{pid:az,lid:d,sid:ap,query:Q,offerid:H,title:u,subtitle:w,vertical:x,url:z,phoneNumber:R,captchaText:au.val(),captchaId:e.attr("id"),useDataUrl:ay},dataType:"json",success:function(aG){if(aG.captchaStatus){if(aG.smsStatus){ao()}else{ae()}}else{aD()}},error:function(){ae()}})}}function aD(){Y();au.addClass("error").val("").attr("placeholder","Invalid code").focus()}function ao(){B();ag.hide();f.hide();aq.hide();N.html(R);y.show();L.show();a.hide();g();aA("SMSSent")}function ae(){B();ag.hide();f.hide();aq.hide();ah.hide();N.html(R);V.show();aA("SMSFailed")}function am(){h=aq.find(".phoneNumber");R=FKART.login.userPhoneNumber;h.val(R);al=aq.find("input[type=button]");f=t.find(".infoDiv");ag=t.find(".stitle");y=t.find(".smsSuccessDiv");V=t.find(".smsErrorDiv");k=t.find(".retry-sms");r=aq.find(".captchaDiv");au=aq.find(".captchaText");av=aq.find(".refreshCaptcha");N=t.find(".phone_number");if(/^\d{10}$/.test(R)){J=true;Y()}t.show();o.reposition();F()}function F(){av.on("click",function(){Y();au.val("").focus()});al.on("click",function(aG){aa();aA("SMSTried");aG.preventDefault()});k.on("click",function(){B();aj.html("45");ag.show();y.hide();f.show();aq.show();V.hide();au.removeClass("error").val("").attr("placeholder","Enter code").focus();Y();aA("SMSReTried")});h.focus(function(){aA("PhoneNumberFocused");if(!J){J=true;Y()}})}function Y(){$.ajax({url:"/lc/generateCaptcha",type:"POST",dataType:"json",success:function(aG){if(aG.success){e=r.find("img");e.attr("src","data:image/png;base64,"+aG.captchaBytes);e.attr("id",aG.id);r.show();au.show();e.load(function(){if(this.complete){o.reposition()}})}else{r.find("img").attr("alt","Captcha failed to load")}},error:function(){r.find("img").attr("alt","Captcha failed to load")}})}function j(){clearInterval(S);S=null}function B(){clearInterval(O);O=null}function m(){clearInterval(G);G=null}function ac(){S=setInterval(function(){var aG=parseInt(l.html());if(aG==0){j();at.hide();ar.show()}l.html(aG-1)},1000)}function g(){O=setInterval(function(){var aG=parseInt(aj.html());if(aG==0){B();L.hide();a.show()}aj.html(aG-1)},1000)}function p(aH,aG){if(aH.indexOf("?")!==-1){var aK=aH.split("?")[1];var aJ=aK.split("&");for(var aI=0;aI<aJ.length;aI++){var aL=aJ[aI].split("=");if(aL[0]==aG){return aL[1]}}}}function ax(){var aG=FKART.urlParser().get("sid");if(aG!="undefined"){return aG}}function n(aG){E=aG.data("image");if(aG.data("pid")){az=aG.data("pid").toString();x=aG.data("vertical");if(aG.data("lid")){d=aG.data("lid").toString()}H=aG.data("offerid")}else{Q=aG.data("query");ap=ax();if(ap){x=("BROWSE_"+ap).toUpperCase()}else{if(aG.data("vertical")){x=aG.data("vertical")}else{x="BROWSE_SEARCH"}}if(aG.data("url")){az=p(aG.data("url"),"pid");ap=p(aG.data("url"),"sid");H=p(aG.data("url"),"offer");if(p(aG.data("url"),"p[]")||aG.data("url").indexOf("/~")){ay=true}}u=aG.data("title");w=aG.data("subtitle");z=aG.data("url");if(aG.attr("href")){U=p(aG.attr("href"),"icmpid")}}aw=false;v=false}function ab(){b()}ab()};register_controller("AppOffersCtrl",function(a){FKART.appOfferPopup(a)});FKART.showShutDownPopup=function(c){var b=(new Date()).getTime(),e=FKART.utils.localStorage.getObject("sdPopDetails")||{};function d(g){var f=new FKART.ui.Dialog({header:"Flipkart System Message",showFooter:false,body:c,cssClass:"desk-shut"});FKART.utils.localStorage.setObject("sdPopDetails",{timeStamp:g});f.show()}if(!jQuery.isEmptyObject(e)){var a=e.timeStamp+(24*60*60*1000);if(a<b){d(b)}}else{d(b)}};register_controller("ShutDownPopCtrl",function(a){FKART.showShutDownPopup(a)});FKART.appDownloadPopup=function(P){var u=$(P),r=$(".app-download",u),G,V,A,W,w,L,ac,ae,b,B,j,F,I,k,U,z,K,y,J,l,M,E=false,n="title",Y="subtitle",ad,X,v,a,N,D,m,d=false;function q(){r.click(function(af){if(!r.hasClass("disabled")){g("Clicked");R($(this));t();af.preventDefault()}})}function t(){ae=null;Z();f()}function g(ag){var af={};if(ag=="Clicked"){af.products=s.products}af.prop21="OpenInApp_"+ag;FKART.omni.customEvent("App only offers",af)}function H(){h();if(ad&&ad.length>0){var af=$("<img>");af.attr("src",ad);V.append(af)}else{V.remove()}C();g("PNSent")}function Q(){h();f();g("PNFailed")}function Z(){ae=new FKART.ui.Dialog({showFooter:false,cssClass:"appDownloadDialog",body:$(".appDownloadDialog-popup-content").html(),destroyOnHide:true,width:"620px"});b=ae.getContainer();w=b.find(".headerDiv");G=b.find(".smsDiv");F=b.find(".smsForm");L=b.find(".send-sms-fake-link");ac=b.find(".send-sms-link");m=b.find(".timer");B=b.find(".retry-notification");ae.show();e()}function e(){b.on("beforeHide",function(af){ab();h();E=false});ac.click(function(){f();g("PNExpired")});B.click(function(){ae.hide();t();g("PNReTried")})}function T(){l=J.val();if(!(/^[789]\d{9}$/.test(l))){J.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}else{$.ajax({url:"/lc/sendAppDownloadSMS",type:"POST",data:{title:n,subtitle:Y,phoneNumber:l,captchaText:z.val(),captchaId:K.attr("id")},dataType:"json",success:function(af){if(af.captchaStatus){if(af.smsStatus){S()}else{x()}}else{p()}},error:function(){x()}})}}function p(){o();z.addClass("error").val("").attr("placeholder","Invalid Captcha").focus()}function S(){k.hide();F.hide();y.html(l);A.show();g("SMSSent")}function x(){k.hide();F.hide();y.html(l);W.show();g("SMSFailed")}function f(){J=F.find(".phoneNumber");l=FKART.login.userPhoneNumber;J.val(l);I=F.find("input[type=submit]");k=G.find(".infoDiv");A=G.find(".smsSuccessDiv");W=G.find(".smsErrorDiv");j=G.find(".retry-sms");U=F.find(".captchaDiv");z=F.find(".captchaText");M=F.find(".refreshCaptcha");y=G.find(".phone_number");if(/^\d{10}$/.test(l)){E=true;o()}G.show();ae.reposition();O()}function O(){M.click(function(){o();z.val("").focus()});F.submit(function(af){T();g("SMSTried");af.preventDefault()});j.click(function(){k.show();F.show();A.hide();W.hide();z.removeClass("error").val("").attr("placeholder","Captcha text").focus();o();g("SMSReTried")});J.focus(function(){g("PhoneNumberFocused");if(!E){E=true;o()}})}function o(){$.ajax({url:"/lc/generateCaptcha",type:"POST",dataType:"json",success:function(af){if(af.success){K=U.find("img");K.attr("src","data:image/png;base64,"+af.captchaBytes);K.attr("id",af.id);U.show();z.show();K.load(function(){if(this.complete){ae.reposition()}})}else{U.find("img").attr("alt","Captcha failed to load")}},error:function(){U.find("img").attr("alt","Captcha failed to load")}})}function ab(){clearInterval(N);N=null}function h(){clearInterval(D);D=null}function C(){N=setInterval(function(){var af=parseInt(m.html());if(af==0){ab();L.hide();ac.show()}m.html(af-1)},1000)}function c(ag,af){var aj=ag.split("?")[1];var ai=aj.split("&");for(var ah=0;ah<ai.length;ah++){var ak=ai[ah].split("=");if(ak[0]==af){return ak[1]}}}function R(){$ele=window.location.href}function aa(){q()}aa()};register_controller("AppDownloadCtrl",function(a){FKART.appDownloadPopup(a)});register_controller("AppDownloadInterstitialCtrl",function(ai){var J=$(ai),r=$(".app-link-interstitial",J),C=$(".app-offers-button",J),U=$(".app-offers-container",J),X=$(".appDownloadInterstitial-popup-content",J),L=$(".fk-question-mark",J),u,ag,ae,aB,O,aE,af,x,T,z,ar,aq,K,a,o,aA,c,v=false,S,k,av=false,ap,aj,f,t,at,e,M,h,Q,au,I=false,G,ax=false,ay,d,an,P,ao="title",q="subtitle",w,y,D,R,N,F,l,ah,B=false;if(X.length==0){X=$(".fk-mainfooter .appOnlyDialog-popup-content")}if(X.length==0){X=$(".appOnlyDialog-popup-content.forcedView")}function b(){C.on("click",function(){if(!B){az("Opened");$(this).addClass("open");L.text("X");setTimeout(function(){U.slideDown(200);B=true},150)}else{az("Closed");U.slideUp(200,function(){C.removeClass("open");L.text("?");B=false})}});r.on("click",function(aF){if(!r.hasClass("disabled")){az("Clicked");n($(this));aD();aF.preventDefault()}});EventBus.subscribe("appDownloadInterstitialpopup",function(){n($(this));aD();FKART.utils.localStorage.setObject("sAppDownloadInterstitial",{sPopup:false})})}function aD(){o=null;H();ak()}function V(){$.ajax({url:"/lc/sendPushNotificationForAccount",data:{pid:ay,lid:d,sid:an,query:P,offerid:G,title:title,subtitle:subtitle,vertical:w,url:y,useDataUrl:ax},type:"POST",dataType:"json"})}function az(aG){var aF={};if(aG=="Clicked"){aF.products=s.products}var aH=new Array("eVar1","eVar2","eVar3","eVar4","eVar5","eVar50","prop1","prop2","prop3","prop4","prop35");for(i in aH){if(typeof s[aH[i]]!="undefined"){aF[aH[i]]=s[aH[i]]}}aF.prop21="OpenInApp_"+aG;FKART.omni.customEvent("App only offers",aF)}function al(){m();z.hide();if(D&&D.length>0){var aF=$("<img>");aF.attr("src",D);aE.append(aF)}else{aE.remove()}ag.show();aa();az("PNSent")}function ab(){m();z.hide();af.show();az("PNFailed")}function H(){o=new FKART.ui.Dialog({showFooter:false,cssClass:"appDownloadInterstitialDialog",body:X.html(),destroyOnHide:true,width:"730px"});c=o.getContainer();z=c.find(".loadingDiv");u=c.find(".smsDiv");ag=c.find(".successDiv");ae=u.find(".stitle");O=u.find(".footerLoggedIn");aB=u.find(".footerNotLoggedIn");aE=ag.find(".phone-image span");ap=c.find(".smsForm");aA=c.find(".successPrefixDiv");af=c.find(".errorDiv");ar=c.find(".send-sms-fake-link");aq=c.find(".send-sms-link");K=c.find(".resend-sms-fake-link");a=c.find(".resend-sms-link");l=c.find(".timer");ah=c.find(".timerResendSMS");S=c.find(".retry-notification");o.show();if(!FKART.login.isUserLoggedIn()){aB.show();O.hide()}else{aB.hide();O.show()}ad()}function ad(){c.on("beforeHide",function(aF){j();A();m();I=false});aq.on("click",function(){ag.hide();aA.show();af.hide();ae.remove();ak();az("PNExpired")});S.on("click",function(){o.hide();aD();$status="PNTried";if(v){$status="PNReTried"}az($status)})}function Y(){Q=h.val();if(!(/^[789]\d{9}$/.test(Q))){h.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}else{$.ajax({url:"/lc/sendAppDownloadSMS",type:"POST",data:{title:ao,subtitle:q,phoneNumber:Q,captchaText:at.val(),captchaId:e.attr("id")},dataType:"json",success:function(aF){if(aF.captchaStatus){if(aF.smsStatus){am()}else{ac()}}else{aC()}},error:function(){ac()}})}}function aC(){W();at.addClass("error").val("").attr("placeholder","Invalid code").focus()}function am(){A();f.hide();ap.hide();M.html(Q);x.show();g();az("SMSSent")}function ac(){A();ae.hide();f.hide();ap.hide();af.hide();M.html(Q);T.show();az("SMSFailed")}function ak(){h=ap.find(".phoneNumber");Q=FKART.login.userPhoneNumber;h.val(Q);aj=ap.find("input[type=button]");f=u.find(".infoDiv");ae=u.find(".stitle");x=u.find(".smsSuccessDiv");T=u.find(".smsErrorDiv");k=u.find(".retry-sms");t=ap.find(".captchaDiv");at=ap.find(".captchaText");au=ap.find(".refreshCaptcha");M=u.find(".phone_number");if(/^\d{10}$/.test(Q)){I=true;W()}u.show();o.reposition();E()}function E(){au.on("click",function(){W();at.val("").focus()});aj.on("click",function(aF){Y();az("SMSTried");aF.preventDefault()});k.on("click",function(){A();ah.html("45");ae.show();x.hide();f.show();ap.show();T.hide();at.removeClass("error").val("").attr("placeholder","Enter code").focus();W();az("SMSReTried")});h.focus(function(){az("PhoneNumberFocused");if(!I){I=true;W()}})}function W(){$.ajax({url:"/lc/generateCaptcha",type:"POST",dataType:"json",success:function(aF){if(aF.success){e=t.find("img");e.attr("src","data:image/png;base64,"+aF.captchaBytes);e.attr("id",aF.id);t.show();at.show();e.load(function(){if(this.complete){o.reposition()}})}else{t.find("img").attr("alt","Captcha failed to load")}},error:function(){t.find("img").attr("alt","Captcha failed to load")}})}function j(){clearInterval(R);R=null}function A(){clearInterval(N);N=null}function m(){clearInterval(F);F=null}function aa(){R=setInterval(function(){var aF=parseInt(l.html());if(aF==0){j();ar.hide();aq.show()}l.html(aF-1)},1000)}function g(){N=setInterval(function(){var aF=parseInt(ah.html());if(aF==0){A();K.hide();a.show()}ah.html(aF-1)},1000)}function p(aG,aF){var aJ=aG.split("?")[1];var aI=aJ.split("&");for(var aH=0;aH<aI.length;aH++){var aK=aI[aH].split("=");if(aK[0]==aF){return aK[1]}}}function aw(){var aF=FKART.urlParser().get("sid");if(aF!="undefined"){return aF}}function n(){$ele=window.location.href}function Z(){b()}Z()});