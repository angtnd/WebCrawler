/**
 * @modified $Author: asins $
 * @version $Rev: 0bb23c338d29a4d7c56b1caafec7f0695175b8a2 $
 */
!function($){require.config({enable_ozma:true});if("object"!==typeof JSON)JSON={};!function(){"use strict";function f(e){return e<10?"0"+e:e}if("function"!==typeof Date.prototype.toJSON){Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"===typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,a,r,o=gap,s,l=t[e];if(l&&"object"===typeof l&&"function"===typeof l.toJSON)l=l.toJSON(e);if("function"===typeof rep)l=rep.call(t,e,l);switch(typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";gap+=indent;s=[];if("[object Array]"===Object.prototype.toString.apply(l)){r=l.length;for(i=0;i<r;i+=1)s[i]=str(i,l)||"null";a=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+o+"]":"["+s.join(",")+"]";gap=o;return a}if(rep&&"object"===typeof rep){r=rep.length;for(i=0;i<r;i+=1)if("string"===typeof rep[i]){n=rep[i];a=str(n,l);if(a)s.push(quote(n)+(gap?": ":":")+a)}}else for(n in l)if(Object.prototype.hasOwnProperty.call(l,n)){a=str(n,l);if(a)s.push(quote(n)+(gap?": ":":")+a)}a=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+o+"}":"{"+s.join(",")+"}";gap=o;return a}}if("function"!==typeof JSON.stringify)JSON.stringify=function(e,t,i){var n;gap="";indent="";if("number"===typeof i)for(n=0;n<i;n+=1)indent+=" ";else if("string"===typeof i)indent=i;rep=t;if(t&&"function"!==typeof t&&("object"!==typeof t||"number"!==typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})};if("function"!==typeof JSON.parse)JSON.parse=function(text,reviver){var j;function walk(e,t){var i,n,a=e[t];if(a&&"object"===typeof a)for(i in a)if(Object.prototype.hasOwnProperty.call(a,i)){n=walk(a,i);if(void 0!==n)a[i]=n;else delete a[i]}return reviver.call(e,t,a)}text=String(text);cx.lastIndex=0;if(cx.test(text))text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return"function"===typeof reviver?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}();define("lib/json2",JSON);define("tui/random",[],function(e,t){function i(){var e=4022871197;var t=function(t){t=t.toString();for(var i=0;i<t.length;i++){e+=t.charCodeAt(i);var n=.02519603282416938*e;e=n>>>0;n-=e;n*=e;e=n>>>0;n-=e;e+=4294967296*n}return 2.3283064365386963e-10*(e>>>0)};t.version="Mash 0.9";return t}function n(){return function(e){var t=4294967087;var n=4294944443;var a=12345,r=12345,o=123,s=12345,l=12345,c=123;if(0===e.length)e=[+new Date];var u=i();for(var d=0;d<e.length;d++){a+=4294967296*u(e[d]);r+=4294967296*u(e[d]);o+=4294967296*u(e[d]);s+=4294967296*u(e[d]);l+=4294967296*u(e[d]);c+=4294967296*u(e[d])}a%=t;r%=t;o%=t;s%=n;l%=n;c%=n;u=null;var f=function(){var e=4294967087;var t=4294944443;var i=1403580;var n=810728;var u=527612;var d=1370589;var f,h,p;h=i*r-n*a;f=0|h/e;h-=f*e;if(h<0)h+=e;a=r;r=o;o=h;p=u*c-d*s;f=0|p/t;p-=f*t;if(p<0)p+=t;s=l;l=c;c=p;if(h<=p)return h-p+e;else return h-p};var h=function(){return 2.3283064365386963e-10*f()};h.uint32=f;h.fract53=function(){return h()+1.1102230246251565e-16*(2097151&f())};h.version="MRG32k3a 0.9";h.args=e;return h}(Array.prototype.slice.call(arguments))}function a(e,t){t="undefined"==typeof t?"":t;var i=new n(e||0,location.href,Date.now());return t+(+new Date).toString(32)+parseInt(1e5*i()).toString(32)}t.rand=a});define("tui/class",[],function(){function e(){return function(){if(this.initialize)this.initialize.apply(this,arguments)}}function t(t,i){var n=this;var a=e();$.extend(a,n,i);var r=Object.create(n.prototype);r.constructor=a;a.prototype=r;$.extend(a.prototype,t);a.superClass=n.prototype;return a}var i=function(i){var n=e();$.extend(n.prototype,i);n.extend=t;return n};i.extend=t;return i});define("tui/event",["tui/class"],function(e){var t=e({initialize:function(){this.__event=window.Zepto?new window.Zepto.Events:$({})}});var i=t.prototype;["bind","one"].forEach(function(e){i[e]=function(t,i,n){if($.isPlainObject(t))for(var a in t)this[e](a,t[a]);else{var r=this.__event;var o=function(){return i.apply(n||r,arguments.length>0?window.Zepto?arguments:Array.prototype.slice.call(arguments,1):[])};r[e].call(r,t,o);i.guid=o.guid}return this}});["unbind","trigger","triggerHandler"].forEach(function(e){i[e]=function(){var t=this.__event;if(require.debug)console.log("[event] "+this.constructor.__mid+" : "+arguments[0],arguments[1]);var i=t[e].apply(t,arguments);if(require.debug&&i!=t&&void 0!=i)console.log(i);return i}});i.fire=i.trigger;i.firing=i.triggerHandler;t.mix=function(e){return $.extend(e,new t)};return t});define("tui/cookie",[],function(){return function(e,t,i,n){if("string"==typeof e){n=i;i=t;t=e;e=window}if(void 0!==i){n=n||{};var a,r="";if(n.expires){if(n.expires.constructor==Date)a=n.expires;else{a=new Date;a.setTime(a.getTime()+1e3*60*60*24*n.expires)}r="; expires="+a.toGMTString()}var o=n.path?"; path="+n.path:"";var s=n.domain?"; domain="+n.domain:"";var l=n.secure?"; secure":"";e.document.cookie=[t,"=",encodeURIComponent(i),r,o,s,l].join("")}else{i=e.document.cookie.match(new RegExp("(?:\\s|^)"+t+"\\=([^;]*)"));return i?decodeURIComponent(i[1]):null}}});define("module/stat/common",["tui/cookie","tui/event","tui/random"],function(e,t,i,n,a){var r={UL:1,OL:2,LI:3,INPUT:4,DIV:5,BODY:6,STRONG:7,SPAN:8,FORM:9,BUTTON:10,CAPTION:11,FIELDSET:12,COLGROUP:13,TFOOT:14,LABEL:15,LEGEND:16,THEAD:17,OPTGROUP:18,OPTION:19,SELECT:20,TABLE:21,TBODY:22,IFRAME:0,SCRIPT:0,OBJECT:0,EMBED:0,IMG:0};function o(){return i.rand(e("u_id"))}function s(){var t=e("juid");if(!t){t=i.rand(e("u_id"),"0");e("juid",t,{expires:365*100,domain:"tudou.com",path:"/"});t=e("juid")||1}window.juidStr=t;return t}function l(){var t=e("seid");if(!t||+new Date>(parseInt(e("seidtimeout"))||0)){t=i.rand(e("u_id"),"0");e("seid",t,{domain:"tudou.com",path:"/"});t=e("seid")||1}var n=e("referhost");if(!n||+new Date>(parseInt(e("seidtimeout"))||0)){var a=/^https?:\/\/[^\/]+/.exec(document.referrer||"");n=a?a[0]:"";e("referhost",n,{domain:"tudou.com",path:"/"})}e("seidtimeout",Date.now()+30*6e4,{domain:"tudou.com",path:"/"});return t}function c(e){e=$(e)[0];var t=[];if(e.id)return"#"+e.id;for(;e;e=e.parentNode){var i=e.nodeName.toUpperCase();if("BODY"==i)break;if(e.id&&"i"!=e.getAttribute("cs")){t.splice(0,0,"#"+e.id);return t.join("~")}var n=0;for(var a=e.previousSibling;a;a=a.previousSibling){var o=a.nodeName.toUpperCase();if(0===r[o])continue;if(o==i)++n}i=r[i]||i;var s=n?"!"+(n+1):"";t.splice(0,0,i+s)}return t.length?t.join("~"):null}function u(e){var t=$(e).attr("href")||$(e).attr("data-stat-href");if(!t)return"";if(/^(javascript:|#)/i.test(t))return"";t=$.trim(t);var i=location.href;var n=i.replace(/(https?:\/\/[^\/]+).*/,"$1");var a=n===i?n+"/":i.replace(/[#?].*/,"").replace(/[^\/]*$/,"");return t.replace(/^\.[\.\/]+/g,function(e){var t=(e.match(/\.\.\//g)||[]).length;for(var i=0;i<t;i++)a=a.replace(/[^\/]+\/$/,"");return a}).replace(/&amp;/g,"&").replace(/^\//,n+"/").replace(/^[^\h\/]/,a+"$&")}function d(e){var t={A:1,INPUT:1,BUTTON:1};if("LABEL"==e.nodeName){var i;var n=$(e);var a=n.attr("for");if(a)i=$("input#"+a).get(0);if(!i){var r=n.find("input:first");if(r.length>0)i=r.get(0)}if(i)e=i}if(e.getAttribute&&"ck"==e.getAttribute("data-stat-role"))return e;else{var o=e.parentNode;try{if(o&&o.getAttribute&&"ck"==o.getAttribute("data-stat-role"))return o}catch(s){}}if(!t[e.nodeName]){e=e.parentNode||{};if(!t[e.nodeName])return false}return e}function f(e){if(!e)return e;if(0==e.indexOf("#"))e=e.replace(/\#([^~\s]+)~/,function(e,t){return'//*[@id="'+t+'"]~'});else e="~html~body~"+e;e=e.replace(/\!(\d+)/g,function(e,t){return"["+t+"]"});e=e.replace(/(~?)(\d+)(~|\[)/g,function(e,t,i,n){for(var a in r)if(r[a]==parseInt(i))return t+a+n;return e});e=e.replace(/~/g,"/");return e}function h(e){var t=document.evaluate(e,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(t.snapshotLength>0)return t.snapshotItem(0);return null}function p(e){var t=[];$.each(e,function(e,i){if(""!==i)t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))});return t.join("&")}function m(e,i){if(!i)t.mix(e);return $.extend(e,{__callbacks:[],addData:function(e){this.__callbacks.push(e)},getData:function(){var e=this;var t={};var i=arguments;e.__callbacks.forEach(function(n){var a=n.apply(e,i)||{};$.extend(t,a)});return t}})}a.referrer=document.referrer||"";a.updateRefer=function(e){a.referrer=e||location.href};a.getPositionCode=c;a.getTrueLink=u;a.getStatTarget=d;a.getXpathFromPositionCode=f;a.getElementByXPath=h;a.param=p;a.mix=m;a.juid=s;a.seid=l;a.pvid=o});define("module/domain",[],function(e,t){var i={main:"www.tudou.com",passport:"passport.tudou.com",ui:"ui.tudou.com",css:"css.tudouui.com",js:"js.tudouui.com",v:"v.tudou.com",login:"login.tudou.com",xn:"login.tudou.com",search:"www.soku.com/t",imake:"imake.tudou.com",ent:"ent.tudou.com",music:"music.tudou.com",movie:"movie.tudou.com",fun:"fun.tudou.com",cartoon:"cartoon.tudou.com",game:"game.tudou.com",lady:"lady.tudou.com",shop:"shop.tudou.com",sports:"sports.tudou.com",life:"life.tudou.com",edu:"edu.tudou.com",etc:"etc.tudou.com",fashion:"fashion.tudou.com",fortune:"fortune.tudou.com",tv:"tv.tudou.com",zy:"zy.tudou.com",news:"news.tudou.com",jilupian:"jilupian.tudou.com",health:"health.tudou.com",beauty:"beauty.tudou.com",it:"it.tudou.com",auto:"auto.tudou.com",message:"message.tudou.com",hint:"tip.tudou.soku.com/search_keys",minichannel:"www.tudou.com/my/channel",tui:"www.tudou.com/my/tui",playlist:"www.tudou.com/playlist",comment:"www.tudou.com/comments",adextensioncpt:"v2.tudou.com/tdct/commonadv.html",programstat:"istat.tudou.com",commentcode:"rd.tudou.com",tmversion:"tmversion.tudou.com",adextensionurl:"tdct.tudou.com/adcontrol/specialadv.html",dig:"dig.tudou.com",live:"istat.tudou.com",douwan:"douwan.tudou.com",mini:"mini.tudou.com",feedback:"feedback.tudou.com",tjpt:"tdrec.youku.com",cms:"cms.tudou.com",wa:"wa.tudou.com",cps:"cps.tudou.com",pay:"pay.tudou.com",vip:"vip.tudou.com",yun:"yun.tudou.com",hinty:"tip.soku.com/search_yun",hd:"hd.tudou.com",crp:"crp.tudou.com",danmu:"danmu.tudou.com",danmus:"service.danmu.tudou.com",gc:"gc.tudou.com",korea:"korea.tudou.com",activity:"activity.tudou.com",index:"index.tudou.com",zhibo:"live.tudou.com",wanhuo:"wanhuo.tudou.com",sgp:"sgp.vsg.tudou.com",paihuo:"api.paihuo.tudou.com",img:"u"+~~(4*Math.random()+1)+".tdimg.com"};var n={account:"https://account.youku.com"};function a(e){$.each(e,function(e,t){n[e]=n[e]||"http://"+t})}a(i);t.join=a;t.url=t.domain=n});define("tui/drag",["tui/event"],function(e){var t=$(window);function i(){if(window.getSelection)window.getSelection().removeAllRanges();else if(document.selection)document.selection.empty();return this}function n(e){e.preventDefault()}var a=e.extend({initialize:function(e,r){var o=this;r=r||{};var s=r.handler||e;a.superClass.initialize.call(o);o.limit=r.limit;o.bubble=r.bubble;o.isCustom=r.isCustom;o.enable2=true;o.state2=false;o.hasMove2=false;o.fx=o.fy=-1;o.x2=o.y2=o.mx2=o.my2=o.px2=o.py2=o.cx2=o.cy2=0;o.node2="string"==$.type(e)?$(e):e;o.container2=r.container||o.node2.parent();o.fixed2="fixed"==o.node2.css("position").toLowerCase();o.handler2="string"==$.type(s)?$(s):s;var l=o.handler2||o.node2;function c(e){e.preventDefault();if(!o.bubble||e.target==l[0]){o.start(e);if(l[0].setCapture)l[0].setCapture()}}l.bind("mousedown",c);function u(e){if(o.state2){o.state2=false;var i=e.pageX-o.mx2+o.x2-o.px2,a=e.pageY-o.my2+o.y2-o.py2;if(o.fixed2){i-=t.scrollLeft();a-=t.scrollTop()}if(o.limit){i=Math.max(i,o.cx2-o.px2);a=Math.max(a,o.cy2-o.py2);i=Math.min(i,o.cWidth-(o.px2-o.cx2)-o.dWidth);a=Math.min(a,o.cHeight-(o.py2-o.cy2)-o.dHeight)}o.x2=o.node2.offset().left;o.y2=o.node2.offset().top;o.trigger("drag:end",[i,a,e.pageX,e.pageY,o.node2,o.container2])}$(document).unbind("selectstart",n);if(l[0].releaseCapture)l[0].releaseCapture()}$(document).bind("mouseup",u);function d(e){if(o.state2&&o.enable2){if(!o.hasMove()&&e.pageX==o.fx&&e.pageY==o.fy);else o.hasMove2=true;var n=e.pageX-o.mx2+o.x2-o.px2,a=e.pageY-o.my2+o.y2-o.py2;if(o.fixed2){n-=t.scrollLeft();a-=t.scrollTop()}if(o.limit){n=Math.max(n,o.cx2-o.px2);a=Math.max(a,o.cy2-o.py2);n=Math.min(n,o.cWidth-(o.px2-o.cx2)-o.dWidth);a=Math.min(a,o.cHeight-(o.py2-o.cy2)-o.dHeight)}if(!o.isCustom)o.node2.css({left:n,top:a});i();o.trigger("drag:move",[n,a,e.pageX,e.pageY,o.node2,o.container2])}}$(document).bind("mousemove",d);o.cancel=function(){l.unbind("mousedown",c);$(document).unbind("mouseup",u);$(document).unbind("mousemove",d)}},start:function(e){var t=this;$(document).bind("selectstart",n);t.offsetParent2=t.node2.offsetParent();if(t.limit){t.cWidth=t.container2.outerWidth();t.cHeight=t.container2.outerHeight();t.pWidth=t.offsetParent2.outerWidth();t.pHeight=t.offsetParent2.outerHeight();t.dWidth=t.node2.outerWidth();t.dHeight=t.node2.outerHeight()}t.fx=e.pageX;t.fy=e.pageY;t.cx2=t.container2.offset().left;t.cy2=t.container2.offset().top;t.px2=t.offsetParent2.offset().left;t.py2=t.offsetParent2.offset().top;t.x2=t.node2.offset().left;t.y2=t.node2.offset().top;t.mx2=e.pageX;t.my2=e.pageY;t.state2=true;t.trigger("drag:start",[t.x2,t.y2,e.pageX,e.pageY,t.node2,t.container2]);return this},enable:function(){this.enable2=true;return this},disable:function(){this.enable2=false;return this},state:function(){return this.state2},hasMove:function(){return this.hasMove2}});return a});define("tui/template",[],function(e,t){t.ns=function(e,t,i){var n,a=i||window,r=e.split(".").reverse();while((n=r.pop())&&r.length>0){if("undefined"===typeof a[n])a[n]={};else if("object"!==typeof a[n])return false;a=a[n]}if("undefined"!==typeof t)a[n]=t;return a[n]};t.format=function(e,t){return e.replace(/<%\=(\w+)%>/g,function(e,i){return null!=t[i]?t[i]:""})};t.escapeHTML=function(e){e=e||"";var t={"<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;","{":"&#123;","}":"&#125;","@":"&#64;"};return e.replace(/[<>'"\{\}@]/g,function(e){return t[e]})};t.substr=function(e,t,i){if(!e||"string"!==typeof e)return"";var n=e.substr(0,t).replace(/([^\x00-\xff])/g,"$1 ").substr(0,t).replace(/([^\x00-\xff])\s/g,"$1");return i?i.call(n,n):e.length>n.length?n+"...":n};t.strsize=function(e){return e.replace(/([^\x00-\xff]|[A-Z])/g,"$1 ").length};var i=this.document;t.tplSettings={_cache:{},evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};t.tplHelpers={mix:$.extend,escapeHTML:t.escapeHTML,substr:t.substr,include:n,_has:function(e){return function(i){return t.ns(i,void 0,e)}}};function n(e,a,r){var o,s=t.tplSettings,l=r?"#"+r:"";if(!/[\t\r\n% ]/.test(e)){o=s._cache[e+l];if(!o){var c=i.getElementById(e);if(c)o=s._cache[e+l]=n(c.innerHTML,false,r)}}else{var u="var __p=[];"+(r?"":"with(obj){")+"var mix=api.mix,escapeHTML=api.escapeHTML,substr=api.substr,include=api.include,has=api._has("+(r||"obj")+");"+"__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(s.interpolate,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(s.evaluate||null,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');"+(r?"":"}")+"return __p.join('');";try{o=new Function(r||"obj","api",u)}catch(d){console.log("Could not create a template function: \n"+u)}}return!o?"":a?o(a,t.tplHelpers):o}t.convertTpl=n;t.reloadTpl=function(e){delete t.tplSettings._cache[e]}});define("tui/widget",["tui/event","tui/template"],function(e,t){function i(e,t){var i;var n;var a=e.split(" ");if(1==a.length){i=t;n=e}else{i=a.shift();n=a.join(" ")}return[i,n]}var n=e.extend({element:null,template:"<div></div>",eventType:"click",model:{},events:{},targetNode:$(document.body),renderMethod:"append",initialize:function(e){var t=this;e=e||{};n.superClass.initialize.call(t);t.model=$.extend(true,{},t.model);t.events=$.extend(true,{},t.events);$.each(["element","targetNode"],function(){"undefined"!==typeof e[this]&&(t[this]=$(e[this]))});$.each(["template","eventType","renderMethod"],function(){"undefined"!==typeof e[this]&&(t[this]=e[this])});$.each(["model","events"],function(){"undefined"!==typeof e[this]&&$.extend(t[this],e[this])})},find:function(e){return this.element.find(e)},delegate:function(e,t){var n=this;if("string"==$.type(e)&&$.isFunction(t)){var a={};a[e]=t;e=a}$.each(e,function(e,t){var a=function(e){if($.isFunction(t))return t.call(n,e);else return n[t](e)};var r=i(e,n.eventType);n.element.on(r[0],r[1],a)});return n},undelegate:function(e){var t=this;var n=i(e,t.eventType);t.element.off(n[0],n[1]);return t},render:function(e){var i=this;if(!i.element||!i.element[0])i.element=$(t.convertTpl(i.template,$.extend({getUrl:this.getUrl||a},e||i.model)));i.delegate(i.events);if(i.renderMethod)i.targetNode[i.renderMethod](i.element);return i},update:function(e){if(this.renderMethod)this.targetNode[this.renderMethod](t.convertTpl(this.template,$.extend({getUrl:this.getUrl||a},e)))}});function a(e){return e}return n});define("tui/mask",[],function(){var e=$('<div class="tui_mask">');var t;var i=$(window);var n=$(document);var a=$(document.body);var r=$.browser.msie&&$.browser.version<7;var o=4096;function s(){var t=Math.max(i.width(),n.width());var a=Math.max(i.height(),n.height());var s="absolute";var l=0;if($.browser.msie&&a>o){if(!r)s="fixed";else{l=i.scrollTop();if(l+o>a)l=a-o}a=o}e.css({position:s,top:l,width:t,height:a})}return{node:function(){return e},resize:function(){s()},show:function(n){i.bind("resize",s);if(r)i.bind("scroll",s);e.css("z-index",n||9e4);this.resize();if(!t){a.append(e);t=true}else e.show();return this},hide:function(n){i.unbind("resize",s);if(r)i.unbind("scroll",s);if(n){e.remove();t=false}else e.hide();return this},update:function(){s()},state:function(){return e.is(":visible")}}});define("tui/art",[],function(){var e=window;var t=function(e,i){return t["string"===typeof i?"compile":"render"].apply(t,arguments)};t.version="2.0.2";t.openTag="<%";t.closeTag="%>";t.isEscape=true;t.isCompress=false;t.parser=null;t.render=function(e,i){var n=t.get(e)||a({id:e,name:"Render Error",message:"No Template"});return n(i)};t.compile=function(e,n){var o=arguments;var s=o[2];var l="anonymous";if("string"!==typeof n){s=o[1];n=o[0];e=l}try{var c=r(e,n,s)}catch(u){u.id=e||n;u.name="Syntax Error";return a(u)}function d(i){try{return new c(i,e)+""}catch(r){if(!s)return t.compile(e,n,true)(i);return a(r)()}}d.prototype=c.prototype;d.toString=function(){return c.toString()};if(e!==l)i[e]=d;return d};var i=t.cache={};var n=t.helpers=function(){var e=function(t,i){if("string"!==typeof t){i=typeof t;if("number"===i)t+="";else if("function"===i)t=e(t.call(t));else t=""}return t};var i={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"};var n=function(t){return e(t).replace(/&(?![\w#]+;|#\d+)|[<>"']/g,function(e){return i[e]})};var a=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)};var r=function(e,t){if(a(e))for(var i=0,n=e.length;i<n;i++)t.call(e,e[i],i,e);else for(i in e)t.call(e,e[i],i)};return{$include:t.render,$string:e,$escape:n,$each:r}}();t.helper=function(e,t){n[e]=t};t.onerror=function(t){var i="Template Error\n\n";for(var n in t)i+="<"+n+">\n"+t[n]+"\n\n";if(e.console)console.error(i)};t.get=function(n){var a;if(i.hasOwnProperty(n))a=i[n];else if("document"in e){var r=document.getElementById(n);if(r){var o=r.value||r.innerHTML;a=t.compile(n,o.replace(/^\s*|\s*$/g,""))}}return a};var a=function(e){t.onerror(e);return function(){return"{Template Error}"}};var r=function(){var e=n.$each;var i="break,case,catch,continue,debugger,default,delete,do,else,false"+",finally,for,function,if,in,instanceof,new,null,return,switch,this"+",throw,true,try,typeof,var,void,while,with"+",abstract,boolean,byte,char,class,const,double,enum,export,extends"+",final,float,goto,implements,import,int,interface,long,native"+",package,private,protected,public,short,static,super,synchronized"+",throws,transient,volatile"+",arguments,let,yield"+",undefined";var a=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g;var r=/[^\w$]+/g;var o=new RegExp(["\\b"+i.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g");var s=/^\d[^,]*|,\d[^,]*/g;var l=/^,+|,+$/g;var c=function(e){return e.replace(a,"").replace(r,",").replace(o,"").replace(s,"").replace(l,"").split(/^$|,+/)};return function(i,a,r){var o=t.openTag;var s=t.closeTag;var l=t.parser;var u=a;var d="";var f=1;var h={$data:1,$id:1,$helpers:1,$out:1,$line:1};var p={};var m="var $helpers=this,"+(r?"$line=0,":"");var v="".trim;var g=v?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"];var w=v?"if(content!==undefined){$out+=content;return content;}":"$out.push(content);";var b="function(content){"+w+"}";var _="function(id,data){"+"data=data||$data;"+"var content=$helpers.$include(id,data,$id);"+w+"}";e(u.split(o),function(e,t){e=e.split(s);var i=e[0];var n=e[1];if(1===e.length)d+=x(i);else{d+=C(i);if(n)d+=x(n)}});u=d;if(r)u="try{"+u+"}catch(e){"+"throw {"+"id:$id,"+"name:'Render Error',"+"message:e.message,"+"line:$line,"+"source:"+I(a)+".split(/\\n/)[$line-1].replace(/^[\\s\\t]+/,'')"+"};"+"}";u=m+g[0]+u+"return new String("+g[3]+");";try{var y=new Function("$data","$id",u);y.prototype=p;return y}catch(k){k.temp="function anonymous($data,$id) {"+u+"}";throw k}function x(e){f+=e.split(/\n/).length-1;if(t.isCompress)e=e.replace(/[\n\r\t\s]+/g," ").replace(/<!--.*?-->/g,"");if(e)e=g[1]+I(e)+g[2]+"\n";return e}function C(e){var i=f;if(l)e=l(e);else if(r)e=e.replace(/\n/g,function(){f++;return"$line="+f+";"});if(0===e.indexOf("=")){var a=0!==e.indexOf("==");e=e.replace(/^=*|[\s;]*$/g,"");if(a&&t.isEscape){var o=e.replace(/\s*\([^\)]+\)/,"");if(!n.hasOwnProperty(o)&&!/^(include|print)$/.test(o))e="$escape("+e+")"}else e="$string("+e+")";e=g[1]+e+g[2]}if(r)e="$line="+i+";"+e;T(e);return e+"\n"}function T(t){t=c(t);e(t,function(e){if(!h.hasOwnProperty(e)){S(e);h[e]=true}})}function S(e){var t;if("print"===e)t=b;else if("include"===e){p["$include"]=n["$include"];t=_}else{t="$data."+e;if(n.hasOwnProperty(e)){p[e]=n[e];if(0===e.indexOf("$"))t="$helpers."+e;else t=t+"===undefined?$helpers."+e+":"+t}}m+=e+"="+t+","}function I(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}}}();return t});define("tui/browser",[],function(){var e=navigator.userAgent.toLowerCase();var t={ie6:$.browser.msie&&6==$.browser.version,html5:function(){var e=document.createElement("input");var t=document.createElement("video");return{h264:!!(t.canPlayType&&t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,"")),history:!!(window.history&&window.history.pushState&&window.history.popState),placeholder:"placeholder"in e}},lang:(navigator.language||navigator.systemLanguage).toLowerCase(),iOS:(e.match(/(ipad|iphone|ipod)/)||[])[0],iOSVersion:(e.match(/os\s+([\d_]+)\s+like\s+mac\s+os/)||[0,"0_0_0"])[1].split("_"),wphone:parseFloat((e.match(/windows\sphone\s(?:os\s)?([\d.]+)/)||["","0"])[1]),android:parseFloat((e.match(/android[\s|\/]([\d.]+)/)||["","0"])[1])};t.isMobile=!!t.iOS||!!t.wphone||!!t.android||void 0!==window.orientation||false;t.isPad=t.isMobile&&("ipad"==t.iOS||e.indexOf("mobile")==-1||e.indexOf("windows nt")!=-1&&e.indexOf("touch")!=-1)||false;return t});define("tui/dialog",["tui/browser","tui/art","tui/mask","tui/widget","tui/drag"],function(e,t,i,n,a){var r=$(window);var o=$.browser.msie&&$.browser.version<=7||!$.support.boxModel;var s=10002;var l='<div class="tui_dialog_button"><% for (var i = 0; i < buttons.length; i++) { %>'+'<a data-role="button_<%=i%>" href="#" <%if(buttons[i].className){%>class="<%=buttons[i].className%>"<%}%>><%=buttons[i].name%></a>'+"<% } %></div>";var c='<div class="tui_dialog <%=className%>"><div<% if (hasWrap) { %> class="tui_dialog_wrap"<% } %>><div class="tui_dialog_holder" data-role="holder">'+'<div class="tui_dialog_resize"></div>'+'<div class="tui_dialog_w_tp"></div><div class="tui_dialog_w_bm"></div>'+'<div class="tui_dialog_w_lf"></div><div class="tui_dialog_w_rt"></div>'+'<div class="tui_dialog_w_tl"></div><div class="tui_dialog_w_tr"></div>'+'<div class="tui_dialog_w_bl"></div><div class="tui_dialog_w_br"></div>'+'<div class="tui_dialog_header" data-role="header"><span class="tui_dialog_close" data-role="close" title="å³é­">å³é­</span>'+'<div class="tui_dialog_title" data-role="title"><%=title%></div><div class="tui_dialog_bar"><%=bar%></div></div>'+'<div class="tui_dialog_content" data-role="content"></div>'+'<% if (buttons.length > 0) { %><div class="tui_dialog_footer" data-role="footer">'+l+"</div><% } %>"+'<% if (info) { %><div class="tui_dialog_info"><%=info%></div><% } %>'+"</div></div></div>";var u=n.extend({events:{"click [data-role=close]":function(e){e.preventDefault();this.close()}},initialize:function(e){var i=this;var n={template:c,buttons:[],zIndex:s,hasDrag:true,hasMask:true,isFixed:true};e=$.extend(n,e||{});s=e.zIndex;var a=$.browser.msie&&parseFloat($.browser.version)<9;if("undefined"!=typeof e.hasWrap)a=e.hasWrap;var r={hasWrap:a,className:e.className||"tudou_dialog",title:e.title||"",bar:e.bar||"",info:e.info||"",buttons:e.buttons};e.element=$(t.compile(e.template)(r));u.superClass.initialize.call(this,e);i.dom={holder:i.element.find("[data-role=holder]"),header:i.element.find("[data-role=header]"),title:i.element.find("[data-role=title]"),content:i.element.find("[data-role=content]"),footer:i.element.find("[data-role=footer]"),close:i.element.find("[data-role=close]")};i.config=e;i.open();var o=function(e){if(27==e.keyCode){i.close();$(document).unbind("keydown",o)}};$(document).keydown(o)},title:function(e){this.dom.title.html(e);return this},content:function(e){this.dom.content.html(e);return this},open:function(){var e=this;var t=e.config;var n=e.element;var l=e.dom;n.css("z-index",s);s+=2;if(t.hasMask)i.show(n.css("z-index")-1);n.css("position",o||!t.isFixed?"absolute":"fixed");e.iframeMask=$("<iframe>",{src:"about:blank",frameborder:0,css:{border:"none","z-index":-1,position:"absolute",top:0,left:0,width:"100%",height:"100%"}}).prependTo(l.holder);e.content(t.content||"");$.each(t.buttons,function(t){e.events["[data-role=button_"+t+"]"]=this.callback});if(!e.element.parent()[0])e.render();e.element.show();e.locate();e.resizeLocate=function(t){e.locate()};r.bind("resize",e.resizeLocate);if(o&&t.isFixed){e.iefixScroll=function(t){e.locate()};r.bind("scroll",e.iefixScroll);e.iframeMask.css({height:l.holder.height()})}if(e.config.hasDrag)new a(n,{handler:l.header,limit:true});return e},close:function(e){var t=this;if(t.config.hasMask)i.hide(true);t.trigger("close",[t]);if(!e)t.element.find("iframe").remove();t.element[e?"hide":"remove"]();if(t.resizeLocate)r.unbind("resize",t.resizeLocate);if(t.iefixScroll){r.unbind("scroll",t.iefixScroll);t.iefixScroll=null}return t},locate:function(){var e=this;var t=Math.max(0,r.width()-e.element.width()>>1);if(!e.config.isFixed)var i=r.scrollTop()+(r.height()-e.element.height())/2;else var i=Math.max(0,r.height()-e.element.height()>>1)+(o?r.scrollTop():0);e.element.css({left:t,top:i});return e}});u.confirm=function(e,t){var i={};if($.isPlainObject(e)){i=e;e=i.msg;t=i.callback}return new u($.extend({className:"tudou_dialog alert",title:"åè±æç¤º",content:'<div class="tui_dialog_logo"></div><div class="tui_dialog_text">'+e+"</div>",hasMask:true,buttons:[{name:"ç¡®å®",callback:function(e){e.preventDefault();t&&t.call(this);this.close()}},{name:"åæ¶",callback:function(e){e.preventDefault();this.close()}}]},i))};u.alert=function(e,t){var i={};if($.isPlainObject(e)){i=e;e=i.msg;t=i.callback}return new u($.extend({className:"tudou_dialog alert",title:"åè±æç¤º",content:'<div class="tui_dialog_logo"></div><div class="tui_dialog_text">'+e+"</div>",hasMask:true,buttons:[{name:"ç¡®å®",callback:function(e){e.preventDefault();t&&t.call(this);this.close()}}]},i))};return u});define("tui/net",[],function(e,t){t.getScript=function(e,t){var i=document.createElement("script");i.type="text/javascript";i.async=true;if(!t)t={};else if($.isFunction(t))t={callback:t};if(t.charset)i.charset=t.charset;i.src=e;var n=document.getElementsByTagName("head")[0];var a=false;i.onload=i.onreadystatechange=function(){if(!a&&(!this.readyState||"loaded"==this.readyState||"complete"==this.readyState)){a=true;i.onload=i.onreadystatechange=null;n.removeChild(i);if(t.callback)t.callback()}};n.appendChild(i)};var i=0;t.getJSON=function(e,n,a,r){var o=e.match(/https?\:\/\/(.+?)\//);if(a)if((!r||!r.isScript)&&(!o||o[1]===window.location.host)){$.ajax({url:e,data:n,success:a,dataType:"json"});return true}r=$.extend({charset:"gbk",callback:"tuijsonp"+ ++i},r||{});if(r.random)n[r.random]=+new Date;var s=r.callbackName||"jsoncallback";n[s]=r.callback;e=[e,/\?/.test(e)?"&":"?",$.param(n)].join("");if(a)window[r.callback]=a;delete r.callback;t.getScript(e,r)};t.getRequest=function(e,t){var i=new Image;i.onload=function(){};i.src=!t?e:[e,e.match(/\?/)?"&":"?","string"==typeof t?t:$.param(t)].join("")}});define("module/login/login",["tui/cookie","tui/event","tui/net","tui/dialog","module/domain"],function(e,t,i,n,a,r,o){var s=new t;var l=a.url;window.hasAutoLogin=window.hasAutoLogin;window.loginCallback=window.loginCallback||[];window.loginData=window.loginData;s.juid="";s.DWriteCookie=function(t,i){var n=e("yktk");if($.isFunction(t))i=t;else if("string"===$.type(t))n=t;else if($.isPlainObject(t)){if(t.yktk)n=t.yktk;if(n)n=n+"|"+(t.isRemember?1:0)}if(n&&""!=n){var a="http://passport.tudou.com/user/crossdomain?yktk="+encodeURIComponent(n);var r=l.login+"/login.do?act=loginOver";if(i){var o="login"+(""+Math.random()).replace(/\D/g,"")+(new Date).getTime();window[o]=function(){i&&i();s.remove();window[o]=null};r+="&callback="+o}a+="&return_url="+encodeURIComponent(r);var s=$('<iframe src="'+a+'" style="position:absolute;left:-9999px;bottom:0;width:0;height:0;visibility:hidden;">');$(document.body).append(s)}};s.autoLogin=function(e,t){var i=this;e=e||{};t=t||function(){};var n=l.login;var a="www";var r=location.hostname.split(".");if(["wwwtest","logintest"].indexOf(r[0])>-1)a="wwwtest";n={www:"http://login.tudou.com",wwwtest:"http://logintest.tudou.com"}[a];$.ajax({url:n+"/login.do?act=ytAutoLogin&useYktk=true",type:"GET",jsonp:"jsoncallback",dataType:"jsonp",success:function(n){var a=1==n.status?true:false;t(a,n);if(a&&n.data)s.DWriteCookie({isRemember:e.isRemember,yktk:n.data.yktk},function(){if(a){i.trigger("after:login");i.trigger("after:autoLogin")}})},error:function(){t(false)}})};s.isLogin=function(t){var i=this;t=t||function(){};if(e("u_user")&&e("u_id")){if(e("u_login"))t(true);else if(e("u_passport_info"))window.loginCallback&&loginCallback.push(t);else return false;return true}return false};s.isLogin2=function(t){var i=this;var n=0;var a=0;var r=e("yktk");t=t||function(){};if(e("u_user")&&e("u_id")){if(e("u_login")){t(true);return}else if(e("u_passport_info"))n=1;else if(r)n=2}else if(r)n=2;if(r)a="|1"==r.slice(-2,r.length)?1:0;if(n){window.loginCallback&&loginCallback.push(t);if(!hasAutoLogin){hasAutoLogin=true;i.autoLogin({isRemember:a},function(e,t){t=t||{};
loginData=e?t:e;if(window.loginCallback&&loginCallback.length){loginCallback.forEach(function(t){t(e,loginData)});window.loginCallback=[]}})}else if(void 0!==loginData)"boolean"==$.type(loginData)?t(loginData):t(1==loginData.status?true:false,loginData)}else t(false)};s.uid=function(){return this.isLogin()?e("u_id")||0:0};s.ucode=function(){return this.isLogin()?e("u_code")||"":""};s.userInfo=function(){var t=this.uid();var i={};i._vip=+s.isVip();i._usr=e("u_user");i._nic=e("u_nick")||i._usr;i._ico=e("u_pic")||"";i._mmid=e("u_mmid")||0;i.isGuest=!!t;i.isXN=t.toString()===(e("xn")||"").split("_")[0];i.isSINA=!!e("sinawb");i.isQZONE=!!e("qzone");i.isMSN=!!e("msn");i.isTWEIBO=!!e("tweibo");i.isKAIXIN=!!e("kaixin");i.isFEIXIN=!!e("feixin");i.isYOUKU=!!e("youku");i.ulvl=(t?e("u_l"):0)||0;i.prefix=i.isXN&&"xn"||i.isSINA&&"sina"||i.isQZONE&&"qzone"||i.isMSN&&"msn"||i.isTWEIBO&&"tweibo"||i.isYOUKU&&"youku"||i.isKAIXIN&&"kaixin"||i.isFEIXIN&&"feixin"||"";return i};var c="miniLoginCallback";s.needLogin=function(e,t){var i=this;e=e||{};if("function"==$.type(e)){t=e;e={}}i.isLogin2(function(a){if(a)t&&t();else{window[c]=function(e){e=$.extend({keepDialog:false},e);if(!e.keepDialog){o.close();window["setupLoginDialog"]=null;window["closeLoginDialog"]=null}t&&t();i.trigger("after:login");i.trigger("after:miniLogin");window[c]=null};window["setupLoginDialog"]=function(e){var t={};var i=o.element.find(".tui_dialog_holder, iframe");if(e.height)t.height=e.height;if(e.width)t.width=e.width;i.css(t);o.locate()};window["closeLoginDialog"]=function(){o.close()};var r={mini:"ok",callback:c};if(e.isReg)r.isReg=true;if(e.title)r.title=encodeURIComponent(e.title);if(e.email)r.email=e.email;var o=new n({className:"tudou_dialog login_dialog "+(r.isReg?"reg_dialog":"log_dialog"),title:"ç»å½",content:'<iframe scrolling="no" frameborder="0" width="100%" height="100%" src="'+l.login+"/login.do?"+$.param(r)+'"></iframe>',hasDrag:false});i.fire("login:open",[r]);o.bind("close",function(e){i.trigger("login:close",[r])})}});return i};s.isVip=function(t){return"100002"==(t||e("u_mmid"))};s.vipLevel2Class={0:"overdue",100002:"gold",100004:"silver"};s.vipLevel2Name={0:"ä¼åå·²è¿æ",100002:"ä¼é·åè±é»éä¼å",100004:"ä¼é·åè±ç½é¶ä¼å"};return s});define("tui/storage",["tui/class"],function(e){var t=e({initialize:function(e){var t=this;if(e){t.iframe1=$('<iframe src="'+e+'" style="position:absolute;left:-9999px;bottom:0;width:0;height:0;visibility:hidden;">');var n=/https?:\/\/[^\/]+/.exec(e);t.origin=n?n[0]:""}else{t.storage=i(window);t.loaded1=true;return}t.gcbs1=[];t.scbs1=[];t.rcbs1=[];t.loaded1=!!t.storage;if(t.iframe1.on)t.iframe1.on("load",a);else t.iframe1.bind("load",a);function a(){t.storage=i(this.contentWindow,t.origin);t.loaded1=true;t.gcbs1.forEach(function(e){t.getItem(e.k,e.cb)});t.scbs1.forEach(function(e){t.setItem(e.k,e.v,e.cb)});t.rcbs1.forEach(function(e){t.removeItem(e.k,e.cb)});t.gcbs1=[];t.scbs1=[];t.rcbs1=[]}$(document.body).append(this.iframe1)},getItem:function(e,t){if(this.loaded1)this.storage.getItem(e,t);else this.gcbs1.push({k:e,cb:t});return this},setItem:function(e,t,i){if($.isPlainObject(t)||$.isArray(t))t=JSON.stringify(t);if(this.loaded1)this.storage.setItem(e,t,i);else this.scbs1.push({k:e,v:t,cb:i});return this},removeItem:function(e,t){if(this.loaded1)this.storage.removeItem(e,t);else this.rcbs1.push({k:e,cb:t});return this}});function i(e,t){var i=parseInt($.browser.version);if(e!==window&&$.browser.mozilla&&(i>=13&&i<=14||i>=30))return n(e,t);else if(e.localStorage)return a(e);else if(e.ActiveXObject)return r(e);else throw new Error("Local storage not exist.")}function n(e,t){window.addEventListener("message",function(e){var t=JSON.parse(e.data);i[t.id](t.val);delete i[t.id]},false);var i={},n=0,a={};a.setItem=function(a,r,o){i[n]=o||function(){};e.postMessage(JSON.stringify({id:n++,key:a,val:r}),t)};a.getItem=function(a,r){i[n]=r||function(){};e.postMessage(JSON.stringify({id:n++,key:a}),t)};a.removeItem=function(a,r){i[n]=r||function(){};e.postMessage(JSON.stringify({id:n++,key:a,val:null}),t)};return a}function a(e){var t={};t.setItem=function(t,i,n){e.localStorage.setItem(t,i);if(n)n()};t.getItem=function(t,i){if(i)i(e.localStorage.getItem(t))};t.removeItem=function(t,i){e.localStorage.removeItem(t);if(i)i()};return t}function r(e){var t={},i=e.document.documentElement;i.addBehavior("#default#userdata");t.setItem=function(e,t,n){try{i.setAttribute("tui",t);i.save(e)}catch(a){throw new Error("[V3] userData behavior error")}if(n)n()};t.getItem=function(e,t){try{i.load(e);if(t)t(i.getAttribute("tui"))}catch(n){return null}};t.removeItem=function(e,t){try{i.load(e);i.expires=new Date(315532799e3).toUTCString();i.save(e);if(t)t()}catch(n){}};return t}return t});define("module/global",["tui/event","tui/cookie","tui/storage","module/stat/common","module/login/login"],function(e,t,i,n,a,r,o){try{document.domain="tudou.com"}catch(s){}var l={};l.juid=n.juid();l.seid=n.seid();l.pvid=n.pvid();l.uid=a.uid();a.bind("after:login",function(){l.uid=a.uid()});a.juid=l.juid;l.storage=new i("http://ui.tudou.com/js/embed/xstorage/storage.html");return l});define("module/stat/stat-info",["tui/cookie","tui/browser","module/global","module/stat/common"],function(e,t,i,n){var a=window;var r=encodeURIComponent;var o=a.config||{};var s=o.item||a.itemData||{};var l=o.pageId||a.pageId||1;var c=navigator.userAgent.toLowerCase();var u=t.iOS;var d=t.iOSVersion;var f=t.android;var h=t.wphone;var p=c.indexOf("micromessenger")>-1;var m={1:96001,2:96002,3:96003,4:96003,5:96003,6:96004,81:96081}[l];var v={1:96311,2:96310,3:96312,4:96312,5:96312,6:96313,81:96381}[l];var g={1:11e3,2:1e4,3:10200,4:10200,5:10200,6:10300}[l];var w={1:31100,2:31e3,3:31200,4:31200,5:31200,6:31300}[l];if(f){m+=1e3;v+=1e3}if(p){m+=2e3;v+=2e3}var b={device:u||f&&(t.isPad?"androidpad":"androidphone")||h&&"wphone"||"others",version:u&&d.join(".")||f||h||0,iOSVersion:d,isMobile:!!u||!!f||false,isRetina:(a.devicePixelRatio||1)<2?false:true,areacode:e("tudouad_citycode")||0,uid:i.uid||0,lid:o.lid||a.lid||0,aid:a.aid||0,sid:o.lid||a.lid||a.aid||0};if(o.lid&&o.pageId>=3&&o.pageId<=5)b.aid=o.lid;var _={icode:function(){return s.icode||a.icode||0},iid:function(){return s.iid||a.iid||0},cid:function(){return s.cid||a.cid||0},oid:function(){return s.oid||a.oid||0},time:function(){return s.time||a.time||""},url:function(){return r(s.url||a.location.href)},refer:function(){return r(s.referrer||n.referrer)},get:function(e){if(void 0!=b[e])return b[e];else if(this[e])return this[e]();else return""},update:function(){s=o.item||a.itemData||{};this.checkYoukuSrc()},getSourceId:function(){if(b.isMobile)return i.isYoukuSrc?v:m;else return i.isYoukuSrc?w:g},checkYoukuSrc:function(){if(s&&s.vcode)return i.isYoukuSrc=true;else return i.isYoukuSrc=false}};_.checkYoukuSrc();return _});define("module/stat/rec",["tui/net","module/global","module/stat/stat-info"],function(e,t,i){var n={};var a={};var r=i.get("iid");var o=i.get("cid");var s=i.get("sid");var l=i.get("uid");function c(c,u,d){u=u||n.req_id;var f=a[u];var p=f&&f.recommendItems;if(!(p&&p[c]))return;var m=p[c];if(u!=n.req_id)n=h(f.reqInfo);r=i.get("iid");o=i.get("cid");var v=$.extend({},d);v.uCookieId=t.juid;v.cookie_id=t.juid;l&&(v.uid=l);r&&(v.vid=r);s&&(v.sid=s);o&&(v.sct=o);v.apt=n.apt;v.pg=n.pg;v.md=n.md;v.pos=c||0;var g=m.iid||m.itemId;g&&(v.dvid=g);m.sid&&(v.dsid=m.sid);var w=m.cid||m.channelId;w&&(v.dct=w);v.abver=n.abver;v.dma=m.dma||0;v.ord=n.ord;v.req_id=u;v.algInfo=m.algInfo||"";v.rand=+new Date;e.getRequest("http://r.l.youku.com/trecommendclick",v)}function u(t){e.getRequest(t)}function d(c,u){c=c||{};var d=c.reqInfo||{};if(d.req_id)a[d.req_id]=c;r=i.get("iid");o=i.get("cid");n=h(d);var p={};p.cookie_id=t.juid;l&&(p.uid=l);r&&(p.vid=r);s&&(p.sid=s);o&&(p.sct=o);p.apt=n.apt;p.pg=n.pg;p.md=n.md;p.abver=n.abver;p.ord=n.ord;p.req_id=n.req_id;u&&(p.reqtype=u);p.showlist=f(c);p.rand=+new Date;e.getRequest("http://r.l.youku.com/trecommendshow",p);return d.req_id}function f(e){var t=[];if(e.recommendItems)e.recommendItems.forEach(function(e,i){t.push([e.iid||e.itemId||e.ownerId,e.type,e.dma,e.algInfo].join("_"))});return t.join(",")}function h(e){return{apt:e.apt||1,pg:e.pg||1,md:e.md||1,abver:e.abver||"A",ord:e.ord||1,req_id:e.req_id||""}}return{send:c,onShow:d,sendMM:u}});define("tui/util/str",[],function(e,t){function i(e){return e.replace(/([^\x00-\xff])/g,"$1 ").length}function n(e,t,i){e=e||"";if(void 0==i)i="..";if(this.byteLen(e)<=t)return e;var n=e.substr(0,t).replace(/([^\x00-\xff])/g,"$1 ").substr(0,t).replace(/([^\x00-\xff])\s/g,"$1");return n+i}function a(e,t){t=t||400;e=e.replace(/(\r\n|\n)+/g,"<br>");e=e.replace(/\s{2,}/g," ");e=e.replace(/(<(?:img|embed).*?>)([\s\S]*)$/gi,function(e,t,i){return t+i.replace(/<(?:img|embed).*?>/gi,"")});e=e.replace(/<\/(p|div|ol|ul|li)>/gi,"<br>");e=e.replace(/<(?!img|embed|br).*?>/gi,"");e=e.replace(/(<br[^>]*>\s*){2,}/gi,"$1");var i=e.length;e=e.substr(0,t);e=e.replace(/<[^>]*$/,"");if(e.length<i)e+=" ...";return e}var r=[];for(var o=0;o<256;o++)r[o]=(o<16?"0":"")+o.toString(16);function s(){var e=0|4294967295*Math.random();var t=0|4294967295*Math.random();var i=0|4294967295*Math.random();var n=0|4294967295*Math.random();return r[255&e]+r[255&e>>8]+r[255&e>>16]+r[255&e>>24]+"-"+r[255&t]+r[255&t>>8]+"-"+r[64|15&t>>16]+r[255&t>>24]+"-"+r[128|63&i]+r[255&i>>8]+"-"+r[255&i>>16]+r[255&i>>24]+r[255&n]+r[255&n>>8]+r[255&n>>16]+r[255&n>>24]}function l(e){var t={"&#60;":"<","&#62;":">","&#34;":'"',"&#39;":"'","&#38;":"&"};return e.replace(/(&#\d{2};)/g,function(e){return t[e]})}t.unescapeHTML=l;t.byteLen=i;t.substr=n;t.subHtml=a;t.uuid=s});define("tui/util/num",[],function(e,t){function i(e,t){var i="",n=e<0,a=String(Math.abs(e));if(a.length<t)i=new Array(t-a.length+1).join("0");return(n?"-":"")+i+a}function n(e,t){t=t.length;e=e||0;return 1==t?e:(e=String(Math.pow(10,t)+e)).substr(e.length-t)}function a(e,t){t=t||",";return String(e).replace(/(\d)(?=(\d{3})+($|\.))/g,"$1"+t)}function r(e){e=parseInt(e);var t;if(e>=1e8)t=(e/1e8).toFixed(2)+"äº¿";else if(e>=1e4){var i=e/1e4;var n=parseInt(i).toString();var r=n.length;if(r<4&&i!=n)n=i.toFixed(1==r?2:4-r);t=a(n)+"ä¸"}else t=a(e);return t}function o(e){e=parseInt(e);var t=-1;do{e/=1024;t++}while(e>1024);return Math.max(e,.1).toFixed(1)+["KB","MB","GB","TB"][t]}t.pad=i;t.format=n;t.split=a;t.field=r;t.bytes=o});define("tui/util/date",["tui/util/num"],function(e,t,i){var n=e.format;function a(e,t){if(void 0===t)t=new Date;else if($.isNumeric(t))t=new Date(parseInt(t,10));return e.replace(/([YMDhsm])\1*/g,function(e){switch(e.charAt()){case"Y":return n(t.getFullYear(),e);case"M":return n(t.getMonth()+1,e);case"D":return n(t.getDate(),e);case"w":return t.getDay()+1;case"h":return n(t.getHours(),e);case"m":return n(t.getMinutes(),e);case"s":return n(t.getSeconds(),e)}})}var r=60*24*60;function o(e,t,i){if($.isNumeric(e))e=new Date(parseInt(e,10));if($.isNumeric(t))t=new Date(parseInt(t,10));if(void 0===e)e=new Date;if(void 0===t)t=new Date;if(!i)i="YYYYå¹´MMæDDæ¥";var n=new Date(t.toDateString());var o=(+t-+e)/1e3;var s=(+t-+n)/1e3;if(o<=60)return"åå";else if(o<=60*60)return Math.floor(o/60)+"åéå";else if(o<=s)return Math.floor(o/3600)+"å°æ¶å";else if(o<=s+r)return"æ¨å¤©";else if(o<=s+2*r)return"åå¤©";else if(o<=s+25*r)return Math.floor(o/r)+"å¤©å";else return a(i,e)}function s(e,t){var i=0;e=String(e).split(":");for(var n=0,a=e.length;n<a;n++)i+=parseInt(e[n],10)*Math.pow(60,a-n-1);return t?1e3*i:i}function l(e,t){var i=[],n,a,e;if(void 0==t||t){n=parseInt(e/3600);a=parseInt(e%3600/60)}else a=parseInt(e/60);e%=60;if(a<10)a="0"+a;if(e<10)e="0"+e;i=[a,e];if(n>0)i.unshift(n);return i.join(":")}function c(e,t,i){if("date"==$.type(t))t=t.getTime();else t=parseInt(t);var a=new Date(t),r=a.getHours();if(a>432e5)r+=Math.floor(a/432e5);if(i)e=e.replace(/(\w)\1+/g,"$1");return e.replace(/([hms])\1*/g,function(t){switch(t.charAt()){case"h":return n(r-8,t);case"m":var i=60*(/h+/.test(e)?0:r-8)+a.getMinutes();return n(i,t);case"s":return n(a.getSeconds(),t)}})}function u(e,t){if(e<36e5)return this.formatTime("mm:ss",e,t);else return this.formatTime("hh:mm:ss",e,t)}i.release=o;i.formatDate=a;i.formatTime=c;i.formatTimeE=u;i.beautyTime=l;i.parseTime=s});define("module/uitcid",["tui/browser"],function(e,t,i){var n={1700:"2",2000:"11",2001:"9",1:"3",2:"4",3:"5",4:"5",5:"5",6:"6",7:"19",11:"13",200:"1"};var a=window.config;var r=window.pageId||a&&a.pageId||0;i.get=function(t,i,a){return[a||(e.isMobile?3:1),n[i||r]||0,t].join("_")};i.from=function(t,i,a,o){return[o||(e.isMobile?3:1),n[a||r]||0,t||0,i||0].join("_")};i.getFromId=function(e){return n[e||r]||0}});define("module/stat/sub",["tui/browser","tui/net","module/stat/common","module/global","module/uitcid"],function(e,t,i,n,a,r,o){var s=i.mix({getExt:function(){var e=this;var t={};$.extend(t,e.getData());return i.param(t)},send:function(r){var o={};o.uid=n.uid||0;o.tuid=6==r.favType?r.subId:"";o.shid=3==r.favType?r.subId:"";o.stype=r.subType;o.ftype=r.favType;o.did=e.isMobile?3:1;o.sid=r.sourceID||a.getFromId();o.url=location.href;o.vid=r.videoID||"";o.ext=this.getExt();t.getRequest("http://p.l.youku.com/tsubscribe?"+i.param(o));this.trigger("send")}});return s});define("module/subscribe",["tui/event","module/login/login","tui/art","module/domain","tui/util/num","tui/browser","module/stat/sub","tui/util/date"],function(e,t,i,n,a,r,o,s){var l=$(document.body);var c=l.width();var u=n.url.main;var d='<iframe src="about:blank" class="mask" frameborder="0"></iframe><i class="succ iconfont">&#xe647;</i><a class="cls iconfont" href="#">&#xe63f;</a><p class="p"><b>è®¢éæå!</b>ä½ å¯ä»¥å» <a href="<%=domain%>/watch/" target="<%=target%>">æçè®¢é</a> æ¥çæ´æ°</p>';var f='<iframe src="about:blank" class="mask" frameborder="0"></iframe><div class="wp <%if(isMe){%>fail_me<%}%>"><i class="fail iconfont">&#xe640;</i><a class="cls iconfont" href="#">&#xe63f;</a><p class="p"><%=txt%>~<br />ä½ å¯ä»¥åå» <%if(isMe){%><br><%}%><a href="<%=domain%>/watch/" target="<%=target%>">æçè®¢é</a>æ´çä¸</p></div>';var h='<%\nvar cs1 = \'\', cs2 = \'\', str = \'\';\nvar detail = cfg.locate;\nvar app = cfg.app;\nvar link = cfg.linkTxt;\nvar target = cfg.target;\nvar total = data.total;\nvar skin = cfg.skin;\nvar id = data.id;\nvar videoID = data.videoID;\nvar isSubed = data.subed;\nswitch(skin){\ncase 1:\ncs1 = \'gbtn_sub_w\';\ncs2 = \'gbtn_sub_w\';\nbreak;\ncase 2:\ncs1 = \'gbtn_sub_b\';\ncs2 = \'gbtn_sub_b\';\nbreak;\ncase 3:\ncs1 = \'gbtn_sub_txt\';\ncs2 = \'gbtn_sub_txt\';\nbreak;\ncase 4:\ncs1 = \'gbtn_sub_txt gbtn_sub_w\';\ncs2 = \'gbtn_subed_txt\';\nbreak;\ncase 5:\ncs1 = \'gbtn_sub_txt gbtn_sub_b\';\ncs2 = \'gbtn_subed_txt gbtn_subed\';\nbreak;\ncase 6:\ncs1 = \'gbtn_sub_s\';\ncs2 = \'gbtn_subed_s\';\nbreak;\n};\nif(detail == \'left\'){\nstr = \'<em class="num_l">\' + splitNum(total) +\'<i class="ac"><i></i></i></em>\';\n}else if(detail == \'right\'){\nstr = \'<em class="num_r">\' + splitNum(total) +\'<i class="ac"><i></i></i></em>\';\n}\nvar attr = \' data-id=\'+ id + \' data-skin=\' + skin + \' data-disrecom =\' + cfg.disRecom;\n%>\n<%if(!data.click){%>\n<%if(skin == 6){%>\n<%if(!isSubed){%>\n<span class="gbtn_sub gbtn_sub_s" data-id="<%=id%>">\n<%==str%><a href="#" title="ç¹å»è®¢é" id="sub_<%=app%>_<%=id%>" <%=attr%>><i class="iconfont">&#xe637;</i></a>\n</span>\n<%}else{%>\n<span class="gbtn_sub gbtn_subed_s"  data-id="<%=id%>">\n<%==str%><a href="#" title="ç¹å»åæ¶è®¢é" <%=attr%> id="unsub_<%=app%>_<%=id%>"><i class="iconfont">&#xe637;</i></a>\n</span>\n<%if(link){%>			\n<a class="gbtn_link" href="<%=domain%>/watch/subscribe/" target="<%=target%>" id="sublink_<%=app%>_<%=id%>"><%=link%></a>\n<%}%>\n<%}%>\n<%}else{%>\n<%if(!isSubed){%>\n<span class="gbtn_sub <%=cs1%>"  data-id="<%=id%>">\n<%==str%><a href="#" title="ç¹å»è®¢é" <%=attr%> id="sub_<%=app%>_<%=id%>"><i class="iconfont">&#xe637;</i>è®¢é</a>\n</span>\n<%}else{%>\n<span class="gbtn_sub <%=cs2%> gbtn_subed"  data-id="<%=id%>">\n<%==str%><a href="#" title="ç¹å»åæ¶è®¢é" <%=attr%> id="unsub_<%=app%>_<%=id%>"><span class="f1"><i class="iconfont">&#xe647;</i>å·²è®¢é</span><span class="f2">åæ¶è®¢é</span></a>\n</span>\n<%if(link){%>			\n<a class="gbtn_link" id="sublink_<%=app%>_<%=id%>" href="<%=domain%>/watch/subscribe/" target="<%=target%>"><%=link%></a>\n<%}%>\n<%}%>\n<%}%>\n<%}else{%>\n<%if(skin == 6){%>\n<%if(!isSubed){%>\n<%==str%><a href="#" title="ç¹å»è®¢é" id="sub_<%=app%>_<%=id%>" <%=attr%>><i class="iconfont">&#xe637;</i></a>\n<%}else{%>\n<%==str%><a href="#" title="ç¹å»åæ¶è®¢é" <%=attr%> id="unsub_<%=app%>_<%=id%>"><i class="iconfont">&#xe637;</i></a>\n<%}%>\n<%}else{%>\n<%if(!isSubed){%>\n<%==str%><a href="#" title="ç¹å»è®¢é" <%=attr%> id="sub_<%=app%>_<%=id%>"><i class="iconfont">&#xe637;</i>è®¢é</a>		\n<%}else{%>\n<%==str%><a href="#" title="ç¹å»åæ¶è®¢é" <%=attr%> id="unsub_<%=app%>_<%=id%>"><span class="f1"><i class="iconfont">&#xe647;</i>å·²è®¢é</span><span class="f2">åæ¶è®¢é</span></a>\n<%}%>\n<%}%>\n<%}%>\n';var p=false;var m=location.href;var v=a.field;var g=1;if(r.isMobile||r.isPad)g=3;l.on("click",".gbtn_subbox .cls",function(e){e.preventDefault();$(".gbtn_subbox").remove()});$(window).on("resize",function(){$(".gbtn_subbox").remove()});var w=e.extend({initialize:function(e){var i=this;w.superClass.initialize.apply(i,arguments);var n=window.config&&window.config.pageId||window.pageId||0;p=n>=1&&n<=8;if(!e.box||!e.type)return;i.op=$.extend({app:"unknow",skin:0,isBelow:false,target:"_blank",disRecom:0},e);if(i.op.below)i.op.isBelow=i.op.below;if(i.op.link)i.op.linkTxt=i.op.link;if(i.op.detail)i.op.locate=i.op.detail;i.CACHE={};i.checkSub(e.box);t.bind("after:login",function(){i.checkSub(e.box)});$(e.box).on("click",".gbtn_sub a",function(e){e.preventDefault();var n=$(this);var a=n.closest(".gbtn_sub");var r=n.attr("data-id");var o=n.offset();var s=i.CACHE[r];if(!s)return false;var l={subId:r,type:i.op.type,app:i.op.app,deviceID:g,url:m};if(s.videoID)l.videoID=s.videoID;if(s.from)l.from=s.from;t.needLogin(function(){l.uid=t.uid();if(a.hasClass("gbtn_subed"))i.unsub(l,function(e){i.toggle(r,false,n);$(".gbtn_subbox").remove()},null,a);else i.sub(l,function(e){i.toggle(r,true,n)},function(e){var t=e.msg||"åçäºæªç¥éè¯¯ã";if(2e3==e.code&&"ä¸å¯ä»¥éå¤è®¢é"===t)i.toggle(r,true,n);else i.dialog(false,o,t)},a)})})},dialog:function(e,t,n){var a=this;var r=t.left;r=r>c/2?r-242:r-12;var o=a.op.isBelow?t.top+(e?25:70):t.top-100;var s;if("ä¸å¯ä»¥è®¢éèªå·±"==n)s=true;$(".gbtn_subbox").remove();l.append('<div class="gbtn_subbox">'+i.compile(e?d:f)({txt:n,isMe:s,target:a.target,domain:u})+"</div>");$(".gbtn_subbox").css({left:r,top:o})},update:function(){var e=this;e.checkSub(e.op.box)},checkSub:function(e){var i=this;var n=[];var a=t.uid();var r,o,s,l;$(e).find(".gbtn_sub[data-id]").forEach(function(e,t){r=$(e);o=r.attr("data-id");l={};if(o){n.push(o);l.total=r.attr("data-total")||0;l.id=o;l.videoID=r.attr("data-videoid")||i.op.videoID||0;l.from=r.attr("data-from")||i.op.from||0;i.CACHE[o]=l}});var c={subId:n.join(","),type:i.op.type,app:i.op.app,uid:a};if(a)i.check(c,function(e){if($.isPlainObject(e.data))n.forEach(function(t){i.render(t,e.data[t])});else i.render(n[0],e.data)});else n.forEach(function(e,t){i.render(e,false)})},render:function(e,t){var n=this;var a=n.CACHE[e];if(!a)return;a.subed=t;a.click=false;var r=i.compile(h)({data:a,cfg:n.op,domain:u,splitNum:v});$(n.op.box).find('.gbtn_sub[data-id="'+e+'"]').replaceWith(r);if(n.op.callback)n.op.callback.call(n,$(r))},toggle:function(e,t,n){var a=this;var r=a.CACHE[e];var o=$('.gbtn_sub a[data-id="'+e+'"]').parent();var s=a.op;r.click=true;r.subed=t;if(n){s.skin=n.attr("data-skin")||s.skin;s.disRecom=n.attr("data-disRecom")||s.disRecom}t?r.total++:r.total--;var l=i.compile(h)({data:r,cfg:s,domain:u,splitNum:v});o[t?"addClass":"removeClass"]("gbtn_subed").html(l);if(!s.linkTxt)return;if(t)o.after('<a class="gbtn_link" id="sublink_'+s.app+"_"+r.id+'" href="'+u+'/watch/subscribe/" target="'+s.target+'">'+s.linkTxt+"</a>");else o.next(".gbtn_link").remove()},check:function(e,t){var i=this;return $.getJSON(u+"/uis/sub/checkSub.action?jsoncallback=?",e,function(n){if(n.code){i.trigger("check:fail",[n]);w.globalEvent.trigger("check:fail",[e,n])}else{t&&t(n);i.trigger("check:success",[n]);w.globalEvent.trigger("check:success",[e,n])}},"jsonp")},sub:function(e,t,i,n){var a=this;var r;var s=e.subId.split(",");if(p){var l=a._getPlayTime();o.addData(function(){return{playtime:l}})}s.forEach(function(t){o.send({subId:t,subType:1,favType:1==e.type?3:6,sourceID:e.from,videoID:e.videoID})});if(e.codes&&""!=e.codes)delete e.subId;return $.getJSON(u+"/uis/sub/sub.action?jsoncallback=?",e,function(r){if(r.code){i&&i(r);a.trigger("sub:fail",[r]);w.globalEvent.trigger("sub:fail",[e,r,n])}else{t&&t(r);a.trigger("sub:success",[r,n]);w.globalEvent.trigger("sub:success",[e,r,n]);if(e.subId)a._loadInfo(e)}},"jsonp")},unsub:function(e,t,i,n){var a=this;o.send({subId:e.subId,subType:2,favType:1==e.type?3:6,deviceID:e.deviceID,sourceID:e.from,videoID:e.videoID});return $.getJSON(u+"/uis/sub/unsub.action?jsoncallback=?",e,function(r){if(r.code){i&&i(r);a.trigger("unsub:fail",[r]);w.globalEvent.trigger("unsub:fail",[e,r,n])}else{t&&t(r);a.trigger("unsub:success",[r,n]);w.globalEvent.trigger("unsub:success",[e,r,n])}},"jsonp")},_loadInfo:function(e){var t=this;if(1==e.type)$.getJSON(u+"/crp/getAlbumPosters.action?jsoncallback=?",{aids:e.subId},function(t){if(t&&t.data&&t.data[0])w.globalEvent.trigger("picAdded",[e,t.data[0]])},"jsonp");if(2==e.type)$.getJSON(u+"/uis/userInfo.action?jsoncallback=?",{app:e.app,uid:e.subId},function(t){if(t&&t.data)w.globalEvent.trigger("picAdded",[e,t.data])},"jsonp")},_getPlayTime:function(){var e=this;var t=window.mgr;var i=window.config;var n="";var a="";if(i&&i.item&&i.item.time)n=i.item.time;if(t&&t.widgets&&t.widgets.playCtrl){a=t.widgets.playCtrl.notifyPlayer("getPlaytime");a*=1e3;a=s.formatTimeE(a)}return[a,n]}});w.globalEvent=new e;return w});define("module/subsrecom",["module/subscribe","module/login/login","tui/art","tui/util/str","tui/cookie","module/domain","module/stat/rec"],function(e,t,i,n,a,r,o,s,l){var c;var u='\n<%data.forEach(function(o, i){%>\n<li ord="<%=i+1%>">\n<a href="<%=o.playLink%>" target="_blank" title="<%=o.ownerName%>" class="img"><img src="<%=o.picUrl%>" /></a>\n<a href="<%=o.playLink%>" target="_blank" title="<%=o.ownerName%>" class="li"><%=o.ownerName%></a>\n<span class="li"><%=o.cate%></span>\n<i class="gbtn_sub" data-id="<%=o.ownerId%>"></i>\n</li>\n<%})%>\n';var d=i.compile(u);var f=$("body");var h=$(window);var p=$("#gSideBar").length;var m=p?"æå¼å·¦ä¾§å¯¼èªå¯æ¥çTAçææ°æ´æ°":"";var v='<div class="g_dialog_recom"><iframe src="about:blank" class="mask" frameborder="0"></iframe>'+'<div class="top">'+'<i class="succ iconfont">&#xe647;</i>'+'<span class="t">è®¢éæå</span>'+m+'<a class="iconfont cls" href="#" data-role="close">&#xe63f;</a>'+"</div>"+'<div class="recom"><h4>è®¢éäºTAçäººï¼è¿è®¢éäº</h4><ul class="fix"><li class="loading">æ°æ®æ­£å¨è½½å¥ä¸­...</li></ul></div></div>';var g=[113077064,113077233,102599789,113077370,113077877,113077745,113077988,116673329,120663473,120663556,120663623,120663663,120663699,366570608,366571453,366573231,366572712];function w(e,t){e=4-e;var i=[];$.ajax({url:"http://cmssrv.jj.tudou.com/oclient/portal/service/getIndexRecommendUserList.do?app=tudou&jsoncallback=?",dataType:"jsonp",success:function(n){if(n.items&&n.items.length){var a=n.items[0].userInfos;if(a.length)a.splice(0,e).forEach(function(e){i.push({picUrl:e.userPic,ownerName:e.nickName,ownerId:e.userId,playLink:e.url,cate:n.items[0].title})});t(i)}}})}function b(e,t,i,n){i&&$.ajax({url:r.url.tjpt+"/tjpt/tdrecuploader?callback=?",data:{encode:"utf-8",userid:i,juid:a("juid"),count:e,pcode:t,req_type:4,filterHot:1},dataType:"jsonp",success:function(e){if("1"==e.status)n&&n(e);else{cb2&&cb2(e);console.log(e)}}})}function _(e){e&&e.preventDefault();if(c){c.remove();c=null}}function y(t,i,n){if("1"===n.find("a").attr("data-disrecom")||1==t.type||2e3==i.code&&"ä¸å¯ä»¥éå¤è®¢é"!=i.msg)return false;_();var a=n.offset();var r=f.width();var s=f.height();var l=n.outerHeight();var u=t.nickname;var m=a.left?a.left>r/2?a.left-330:a.left:(r-420)/2;var y=a.top?a.top-h.scrollTop()>h.height()/2?a.top-300:a.top+l:h.scrollTop()+(h.height()-300)/2;c=$(v);c.css({left:m,top:y});f.append(c);c.on("click",".cls",_);b(4,10000203,t.subId,function(t){var i=t.recommendItems;i.forEach(function(e,t){if(e.cate.length<=2&&e.tag)e.cate+="/"+e.tag.split(",").shift();if($.inArray(e.ownerId,g)>-1){i.splice(t,1);return}});var n=i.splice(0,4);if(n.length<4)w(n.length,function(t){n=n.concat(t);c.find(".recom ul").html(d({data:n,hasSideBar:p}));new e({box:".g_dialog_recom",type:2,app:"gDialogRecom",skin:1,from:23,disRecom:1})});else{c.find(".recom ul").html(d({data:n,hasSideBar:p}));new e({box:".g_dialog_recom",type:2,app:"gDialogRecom",skin:1,from:23,disRecom:1})}var a=t.reqInfo.req_id;o.onShow(t,"p");c.on("click","li a",function(e){var t=$(this).closest("li").attr("ord");o.send(t,a)})})}l.init=function(){e.globalEvent.bind("sub:success",y);e.globalEvent.bind("sub:fail",y)}});define("module/sidebar/curve-motion",[],function(){var e=.0017;var t=function(t,i,n){if(!$.isArray(t))return;if($.isFunction(i)){n=i;i={}}this.options=i||(i={});if(i.easing)this._easing=i.easing;if(i.gravity)e=i.gravity;this.originX=t[0];this.originY=t[1];this.targetX=t[2];this.targetY=t[3];this.absX=Math.abs(this.targetX-this.originX);this.absY=Math.abs(this.targetY-this.originY);this.upward=this.targetY-this.originY<0;this.angle=180*Math.atan(this.absY/this.absX)/Math.PI;this.angle+=Math.cos(this.angle*Math.PI/180)*(i.elevationAngle||0);this.rad=this.angle*Math.PI/180;this.speed=Math.sqrt(e*this.absX*this.absX/(2*(this.absX*Math.tan(this.rad)-this.absY)),2)/Math.cos(this.rad);this.duration=this.absX/(this.speed*Math.cos(this.rad));this.draw=this.draw.bind(this);this._completeCallback=$.isFunction(n)&&n||function(){}};t.prototype={draw:function(){var e=+new Date-this.startTime;e=Math.min(e/this.duration,1);e=this._easing(e);if(e<1&&!this._paused)n(this.draw);var t=this._calcX(this.originX,this.targetX,e);var i=this._calcY(Math.abs(this.upward?t-this.originX:this.targetX-t));if(this._frameTimer)clearTimeout(this._frameTimer);var a=this;a._frameTimer=setTimeout(function(){if(a._useTransform)a._updateCallback(t-a.originX,a.upward?-i:a.absY-i);else a._updateCallback(t,a.upward?a.originY-i:a.targetY-i);if(1==e)a._completeCallback(t,i)},0)},start:function(){this._paused=false;this.startTime=+new Date;this.draw()},pause:function(){this._paused=true},updateFrame:function(e,t){this._updateCallback=e;this._useTransform=!!t},_calcX:function(e,t,i){return e+(t-e)*i},_calcY:function(t){return t*Math.tan(this.rad)-e*t*t/(2*Math.pow(this.speed*Math.cos(this.rad),2))},_easing:function(e){return e*e*(3-2*e)}};var i=!!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame);var n=window.requestAnimationFrame||function(){var e=0;return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){var i=(new Date).getTime(),n;n=Math.max(0,16-(i-e));e=i+n;return setTimeout(function(){t(i+n)},n)}}();t.supportCSSTransform=i;return t});define("tui/view",["tui/event"],function(e){var t="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;var i=0;var n;var a=".delegateEvents";var r=function(t){this.clsid=i++;this._configure(t||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents();$.extend(this,new e)};var o={};var s=["el","id","attrs","className","tagName","model"];var l=/^(\S+)\s*(.*)$/;$.extend(r.prototype,{tagName:"div",initialize:function(){},render:function(){return this},get:function(e){return o[e]||null},find:function(e){return this.$el.find(e)},remove:function(){this.$el.remove();this.undelegateEvents();this.unbind();return this},create:function(e,t,i){var n=document.createElement(e);if(t)$(n).attr(t);if(i)$(n).html(i);return n},setElement:function(e,t){if(this.$el)this.undelegateEvents();this.$el=e instanceof $?e:$(e);this.el=this.$el[0];if(false!==t)this.delegateEvents();return this},delegateEvents:function(e){if(!(e||(e=this.events)))return;this.undelegateEvents();for(var t in e){var i=e[t];if(!$.isFunction(i))i=this[e[t]];if(!i)continue;var n=t.match(l);var r=n[1],o=n[2];i=i.bind(this);r=this._ensureTouch(r,o);r+=a+this.clsid;if(""===o)this.$el.on(r,i);else this.$el.on(r,o,i)}return this},undelegateEvents:function(e,t){var e=e?this._ensureTouch(e):"";this.$el.off(e+a+this.clsid,t);return this},modelEvents:function(e,t){t="{"+($.trim(t)||"mod")+"} ";for(var i in this)if(0===i.indexOf(t))e.bind(i.slice(t.length),this[i],this)},_configure:function(e){if(this.options)e=$.extend({},this.options,e);for(var t=0,i=s.length;t<i;t++){var n=s[t];if(e[n])this[n]=e[n]}this.options=e},_ensureElement:function(){if(this.el)this.setElement(this.el,false);else{var e=this.attrs||{};if(this.id)e.id=this.id;if(this.className)e["class"]=this.className;this.setElement(this.create(this.tagName,e),false)}},_ensureTouch:function(e,i){if(t&&window.tudouClickStat){if(("click"==e||"tap"==e||"singleTap"==e)&&""!==i){var r=e+a+this.clsid;this.$el.on(r,i,function(e){e.preventDefault();if(!tudouClickStat.getStatTarget(e.target)){if(void 0===e.pageX)e.pageX=e.pageY=0;if(n)clearTimeout(n);n=setTimeout(function(){tudouClickStat.send(e,{},function(){},true)},10)}})}return e}switch(e){case"tap":case"singleTap":return"click";case"doubleTap":return"dblclick"}return e},_clearTimer:function(){var e=arguments;for(var t=0,i=e.length;t<i;t++){var n=e[t];if(n){clearTimeout(n);clearInterval(n)}}return null}});r.create=function(e,t){if(e&&!o[e])return o[e]=new this(t);return new this(t)};r.instance=function(e,t){if(e&&!o[e])return o[e]=t;return o[e]||null};r.destroy=function(e){if(e){if(o[e]){o[e].remove();delete o[e]}}else for(var t in o)arguments.callee(t)};r.extend=function(e,t){var i=this;var n=function(){i.apply(this,arguments)};$.extend(n,i,t);var a=function(){this.constructor=n};a.prototype=i.prototype;n.prototype=new a;$.extend(n.prototype,e);n.superClass=i.prototype;return n};return r});define("module/sidebar/curvefly",["tui/view","module/sidebar/curve-motion"],function(e,t){var i;var n=e.extend({initialize:function(){this._coords=this.options.coords;this._picurl=this.options.picurl||null;this._motion=new t(this._coords,{elevationAngle:this.options.elevationAngle||33},this._complete.bind(this));this._motion.updateFrame(this._update.bind(this),t.supportCSSTransform);this.render()},remove:function(){n.superClass.remove.call(this)},render:function(){var e=this._picurl;if(!(e&&e.indexOf("&#x")!==-1)){e=this._picurl?'<img src="'+this._picurl+'" />':'<i class="iconfont">&#xe637;</i>';var t=$('<div class="g-subs-ani">'+e+"</div>")}else var t=$('<div class="g-subs-ani g-curvefly-wrap">'+e+"</div>");t.css({left:this._coords[0],top:this._coords[1]});$(document.body).append(t);this.setElement(t)},start:function(){this.$el.show();this._motion.start()},pause:function(){this._motion.pause()},_update:function(e,i){if(t.supportCSSTransform)this.$el.get(0).style[a+"Transform"]="translate3d("+e+"px, "+i+"px, 0)";else this.$el.css({left:e,top:i})},_complete:function(){var e=this.$el;if(t.supportCSSTransform)e.get(0).style[a+"Transform"]="none";e.css({left:this._coords[2],top:this._coords[3]}).fadeOut(300)}});n.create=function(e,t,a,r,o,s){n.destory();i=new n({coords:[e,t,a,r],picurl:o,elevationAngle:s});return i};n.destory=function(){if(i){i.remove();i=null}};var a="";var r=document.createElement("div");$.each({Webkit:"webkit",Moz:"moz",O:"o",ms:"ms"},function(e,t){if(void 0!==r.style[e+"TransitionProperty"]){a=e;return false}});return n});define("module/sidebar/recent-rec-panel",["tui/net","tui/art","tui/cookie","tui/dialog","module/domain"],function(e,t,i,n,a){var r=t.compile('<% if (channel.length) { %>\n<% channel.forEach(function(item, index){ %>\n<div class="rec-item">\n<div class="pic">\n<a href="<%=$getUserHomeUrl(item.userId)%>" target="_blank"><img src="<%=item.userpic%>" /></a>\n</div>\n<div class="txt">\n<a href="<%=$getUserHomeUrl(item.userId)%>" target="_blank"><%=item.nickname || item.username%></a>\n</div>\n</div>\n<% }); %>\n<% } %>\n<% if (album.length) { %>\n<% album.forEach(function(item, index){ %>\n<div class="rec-item">\n<div class="pic">\n<a href="<%=$getAlbumCoverUrl(item.acode)%>" target="_blank"><img src="<%=item.albumPicUrl%>" /></a>\n</div>\n<div class="txt">\n<a href="<%=$getAlbumCoverUrl(item.acode)%>" target="_blank"><%=item.albumName%></a>\n</div>\n</div>\n<% }); %>\n<% } %>\n');
var o='<div class="g-recent-rec" data-role="holder">'+'<h2 data-role="title">è¿æ¯ä½ ç»å¸¸ççèªé¢é</h2>'+"<h3>æå®ä»¬å å¥ä½ çè®¢éåè¡¨</h3>"+'<a href="#" class="rec-close" data-role="close"><i class="iconfont">&#xe63f;</i></a>'+'<div class="rec-content" data-role="content"></div>'+'<a href="#" class="rec-sub">ç¡®å®</a>'+"</div>";var s=n.extend({events:{"click .rec-sub":"subAll"},initialize:function(){var e={template:o,hasDrag:false};$.extend(this.events,s.superClass.events);s.superClass.initialize.call(this,e)},destory:function(){s.superClass.close.call(this)},open:function(){var e=this;var t=i("g_recent_rec")||0;if(!t)setTimeout(function(){e.fetch()},100);else e.destory()},close:function(){this.report(2);this.destory();this.setCookie(true)},setCookie:function(e){i("g_recent_rec",1,{path:"/",domain:"tudou.com",expires:e?30:1})},report:function(t){e.getRequest(a.url.main+"/watch/seriesAndSub/doOpearation.do?uid="+window.uid+"&status="+t)},fetch:function(){var e=this;$.getJSON(a.url.main+"/watch/seriesAndSub/show.do?jsoncallback=?",{uid:window.uid},function(t){if(t&&0===t.code&&t.data){var i=t.data;if((i.channel||i.album)&&i.album_size+i.channel_size>0){s.superClass.open.call(e);if(i.channel_size>0&&i.channel_size<6){if(i.album_size>0){i.album=i.album.slice(0,6-i.channel_size);e.title("è¿æ¯ä½ ç»å¸¸ççèªé¢éåå§é")}}else if(0==i.channel_size)e.title("è¿æ¯ä½ ç»å¸¸ççå§é");e._data=i;e.content(r(i));e.locate()}else{e.destory();e.setCookie()}}else{e.destory();e.setCookie()}})},subAll:function(e){e&&e.preventDefault();var t=this;var i=t._data;var r=[];var o=[];var s=[];if(i.channel_size>0){i.channel.forEach(function(e){o.push(e.ucode)});r.push($.getJSON(a.url.main+"/uis/sub/sub.action?jsoncallback=?",{app:"watchcenter",uid:window.uid,type:2,codes:o.join(",")}))}if(i.album_size>0&&i.channel_size<6){i.album.forEach(function(e){s.push(e.acode)});r.push($.getJSON(a.url.main+"/uis/sub/sub.action?jsoncallback=?",{app:"watchcenter",uid:window.uid,type:1,codes:s.join(",")}))}$.when.apply(t,r).done(function(e,i){var n=false,a={};if(3===arguments.length){if(0==e.code){$.extend(a,e.data||{});n=true}}else{if(0==e[0].code){$.extend(a,e[0].data||{});n=true}if(0==i[0].code){$.extend(a,i[0].data||{});n=true}}if(n){t.report(1);t.destory();t.trigger("suball:success",[t._matchSubedData(a)])}}).fail(function(){t.destory();n.alert("æ¹éè®¢éå¤±è´¥")})},_getDataMap:function(){var e={};var t=this._data;t.channel&&t.channel.forEach(function(t){e[t.ucode]=t});t.album&&t.album.forEach(function(t){e[t.acode]=t});return e},_matchSubedData:function(e){var t=[];var i=this._getDataMap();for(var n in e){var a=i[n];if("1"==e[n])if(a.acode)t.push({type:1,id:a.aid,title:a.albumName,smallPic:a.albumPicUrl});else t.push({type:2,id:a.userId,title:a.nickname||a.username,smallPic:a.userpic})}return t}});t.helper("$getAlbumCoverUrl",function(e){return a.url.main+"/albumcover/"+e+".html"});t.helper("$getUserHomeUrl",function(e){return a.url.main+"/home/_"+e+"/"});return s});define("module/stat/jserror",["tui/net","module/global"],function(e,t,i,n){var a=encodeURIComponent;var r=a(location.href);var o=a(navigator.userAgent);var s=window.ERROR_RAND||.01;var l={};var c=function(i,n,c){if(!c)i="custom: "+i;n=n||s;if(Math.random()<n){if(l[i])return;e.getRequest("http://stats.tudou.com/e/page/js/fail/?v=1&s="+[a(i),r,t.juid+"_"+t.uid,o].join("|"));l[i]=true}};c.addVersion=function(e){r=a(e+":"+location.href)};if(Math.random()<s)window.onerror=function(e){setTimeout(function(){c(e,1,true)},0)};return c});define("module/data/request",["tui/event","module/domain","module/stat/jserror"],function(e,t,i){var n=window.location.hostname;var a=0;var r=e.extend({initialize:function(e){r.superClass.initialize.call(this);this.config=$.extend({},e)},_paramAlias:function(e,t){var i={},n=this.config[e].alias||{};for(var a in t){var r=t[a];i[n[a]||a]=$.isArray(r)?r.join(","):r}return i},_createRequest:function(e,a){var r=this;var o=r.config[e];o.name=e;o.param=$.extend({},o.defparam,a);r.jsonpCallback=o.jsonpCallback||r.constructor.__mid.replace(/[^\w]+/g,"_")+"_"+e;var s={url:o.url,cache:"undefined"===typeof o.cache||o.cache,scriptCharset:o.charset||"utf-8",dataType:o.dataType||"json",data:r._paramAlias(e,o.param),timeout:o.timeout||2e4,success:o.callback||function(t){if(t)r.fire(o.name+":success",[t,r.config[e],r]);else r.fire(o.name+":fail",[{status:"error",msg:modelName+" error"},r.config[e],r])},error:function(t,n,a){if(!o._isFirstReTry){o._isFirstReTry=true;i("FirstAutoRetry::"+r.jsonpCallback+"::"+(n||a)+"::"+$.param(o.param));r.retry(o.name)}else{i("retryError::"+r.jsonpCallback+"::"+(n||a)+"::"+$.param(o.param));r.fire(o.name+":fail",[{status:n,msg:n||a},r.config[e],r])}}};if("post"==o.method)s.type="post";else if(!o.dataType||"jsonp"==o.dataType)$.extend(s,{dataType:"jsonp",jsonp:o.jsonp||"jsoncallback",jsonpCallback:r.jsonpCallback});if("json"==s.dataType&&s.url.indexOf(n)==-1)if(!r._crossdomain){var l=r._crossdomain=$('<iframe id="crossdomain" width="0" height="0" frameborder="0" src="'+t.url.comment+'/crossdomain/index.html" style="position:absolute;visibility:hidden;"></iframe>')[0];l.onload=function(){r._crossdomain.contentWindow.TUI.ajax(s)};$("body").append(l)}else r._crossdomain.contentWindow.TUI.ajax(s);else $.ajax(s)},retry:function(e){var t=this;t._createRequest(e,t.config[e].param)}});return r});define("module/data/usersublist",["tui/template","module/global","module/login/login","module/data/request","module/domain"],function(e,t,i,n,a){var r=n.extend({items:[],byId:{},byType:{},initialize:function(){r.superClass.initialize.call(this)},getItemById:function(e){return this.byId[e]||null},getItemsByType:function(e){return this.byType[e]||[]},getItemCount:function(e){if(e)return this.getItemsByType(e).length;else return this.items.length},index:function(e,t,i){var n=this;var a=t?n.items.length:0;e||(e=n.items);e=e.slice(0);if(!t){n.byId={};n.byType={};n.items=e}e.forEach(function(e,r){if(!e)return;if("undefined"===typeof e.type&&"undefined"!==typeof i)e.type=i;n.byId[e.uid]={index:r+a,data:e};n.byType[e.type]||(n.byType[e.type]=[]);n.byType[e.type].push(e);if(t)n.items.push(e)});n.trigger("sublist:change",[n.items])},removeSub:function(e,t){var i=this.getItemById(e);if(i){var n=this.items.splice(i.index,1);this.index();this.trigger("subremoved",[n[0],i.index])}},search:function(t){this._searchKW=t=t.toLowerCase();var i=this;var n=[];var a=t.length;var r=this.items;var o=r.length-1;if(""==t){this.trigger("sublist:data",[0,r]);return}r.forEach(function(s,l){if(i._searchKW!=t)return false;var c=e.escapeHTML(s.name);var u=title.toLowerCase().indexOf(t);if(u>-1){s=r.slice(l,l+1)[0];s._name=c.substring(0,u)+"<em>"+c.substring(u,u+a)+"</em>"+c.substring(u+a);s._highlight=true;n.push(s)}if(o==l)i.trigger("sublist:data",[1,n])})},fetch:function(e,t){var n=this;var r="fetchUerSub";var o=0;t=t||999;n.config[r]={url:a.url.main+"/watch/sub/subListUser.action",callback:function(e){if(e.code){console&&console.error(e.msg);return}var t=e&&e.data;if(t){n.hasAlbum=!!t.hasAlbum;n.index(t.users,null,2);n.trigger("sublist:data",[0,t.users]);n.isDataLoaded=true}}};n._createRequest(r,{uid:i.uid(),offset:o,order:e||0,count:t-o})},fetchUpdateCount:function(e){var t=this;var n="fetchUpdateCount";t.config[n]={url:a.url.main+"/watch/sub/getUpdateCount.do",callback:function(i){if(i.code){console&&console.error(i.msg);return}var n=i&&i.data;if(n){t.updateCount=n.updateCount;e&&e(n)}}};t._createRequest(n,{uid:i.uid(),subTypes:"1,2"})},unSub:function(e,t,n){var r=this;var o=this.items;var s="userUnSub";r.config[s]={url:a.url.main+"/uis/sub/unsub.action?jsoncallback=?",callback:function(i){if(i.code){console&&console.error(i.msg);return}var a=r.getItemById(e);if(a){r.prevItemsData=o.slice(0);o.splice(a.index,1);r.index()}r.trigger("unsubed",[e,t,n])}};r._createRequest(s,{uid:i.uid(),subId:e,type:t,app:"watch"})},reSub:function(e,t,n){var r=this;var o="userReSub";r.config[o]={url:a.url.main+"/uis/sub/sub.action?jsoncallback=?",callback:function(i){if(i.code){console&&console.error(i.msg);return}var a=i&&i.data;if(a){if(r.prevItemsData){r.items=r.prevItemsData;r.index();r.prevItemsData=null}r.trigger("resubed",[e,t,n])}}};r._createRequest(o,{uid:i.uid(),subId:e,type:t,app:"watch"})},addSub:function(e,t){var n=this;var r=this.items;var o=1==t?"/watch/album/detail.do?jsoncallback=?":"/watch/user/detail.do?jsoncallback=?";var s="userAddSub";n.config[s]={url:a.url.main+o,callback:function(i){if(i.code){console&&console.error(i.msg);return}var a=i&&i.data;if(a){r.unshift({added:true,top:false,id:e,type:t,title:a.albumName||a.nickname||a.username,smallPic:a.albumPicUrl||a.userpic,updateCount:a.updateCount||0});n.index(r);n.trigger("subadded",[r[0],t])}}};n._createRequest(s,{id:e,uid:i.uid()})},expose:function(e,t){var n=this;var r=i.uid();var o={};var s="userExpose";if(e&&t){n.config[s]={url:a.url.main+"/watch/exposure/exposure.do?jsoncallback=?",callback:function(i){n.trigger("expose",[e,t])}};o={sourceId:t,sourceType:e,uid:r}}else if(e){n.config[s]={url:a.url.main+"/watch/exposure/exposureByType.do?jsoncallback=?",callback:function(t){n.trigger("expose",[e])}};o={type:e,uid:r}}n._createRequest(s,o)},fetchRec:function(e,t){var i=this;var n=Math.ceil(3*Math.random());e=e||8;var r="fetchRec";var o={pageNo:n,pageSize:e};if(t)o.userId=t;i.config[r]={url:a.url.gc+"/newsData.html?jsoncallback=?",callback:function(e){if(e.length)i.trigger("getrec:success",[e])}};i._createRequest(r,o)}});return r});define("page/watch/model/setting",["tui/cookie","tui/browser"],function(e,t){var i={expires:365,domain:"tudou.com",path:"/"};var n=JSON.parse(e("watch_center_setting")||"{}");var a={getItem:function(e){return e?n[e]:n},setItem:function(t,a){n[t]=a;e("watch_center_setting",JSON.stringify(n),i)}};window._watch_setting=a;return a});define("page/watch/model/local-record",["module/global"],function(e){var t="mysub-action-data";var i=e.storage;var n;i.getItem(t,function(e){e||(e="{}");n=JSON.parse(e)});var a={add:function(e,a,r){r||(r=1);if(n[e])n[e]["C"]+=r;else{a["C"]=r;n[e]=a}try{i.setItem(t,JSON.stringify(n))}catch(o){this.remove()}},remove:function(e){if(!e){n=null;i.removeItem(t)}else{n[e]=null;delete n[e];i.setItem(t,JSON.stringify(n))}},size:function(e){var t=0;for(var i in n)if(!e||e&&n[i]["type"]==e)t++;return t},get:function(e){return e?n&&n[e]:n},getCountById:function(e){var t=this.get(e);return t&&t["C"]||0},getAllCountByType:function(e){var t=0;for(var i in n)if(n[i]["type"]==e)t+=n[i]["C"];return t},getAllCount:function(){var e=0;for(var t in n)e+=n[t]["C"];return e}};return a});define("tui/countdown",[],function(){return function(e,t,i){var t=t||3;var n;var e=$(e).html(t);n=setInterval(function(){t--;if(t<=0){clearInterval(n);if(i)i()}e.html(t)},1e3);return{close:function(){clearInterval(n)}}}});define("module/stat/expose",["tui/class","tui/net","module/stat/common","module/global"],function(e,t,i,n,a,r){var o=window.rqtime||new Date;return e(i.mix({initialize:function(e,t){this.element=e;this.eventType=t?2:1;this.startTime=new Date;this.endTime=0;this.isSent=false;this.__callbacks=[]},start:function(){this.startTime=new Date;this.isSent=false},end:function(){this.endTime=new Date;this.send()},send:function(){var e=i.getPositionCode(this.element);var a=this.endTime||new Date;var r=encodeURIComponent;var s=this.getData(e);var l={pvid:n.pvid||"",chid:window.cid||0,uid:n.uid||0,juid:n.juid||"",seid:n.seid||"",url:location.href,rurl:i.referrer||"",mcode:e,etype:this.eventType,etime:a-o,ltime:a-this.startTime,ext:i.param(s)};t.getRequest("http://p.l.youku.com/texpose?"+i.param(l)+"&r="+ +new Date);var c=[];$.each(s,function(e,t){c.push(r(e)+"="+r(t))});var u=c.join("|");var d=[n.pvid||"",window.cid||0,n.uid||0,n.juid||"",n.seid||"",r(i.referrer||""),r(e),this.eventType,a-o,a-this.startTime,u].join("|");t.getRequest("http://stats.tudou.com/ep1/?v=1&s="+d+"&r="+(new Date).getTime());this.isSent=true}},true))});define("module/stat/ck",["tui/cookie","tui/net","module/login/login","module/stat/common","module/global"],function(e,t,i,n,a,r,o){var s=screen.width;var l=screen.height;function c(e,t){return e.replace(/\/?#.*|\/$/,"")===t.replace(/\/?#.*|\/$/,"")}window.tudouClickStat=n.mix({pvid:a.pvid,getRequest:function(r){var o=$(window).width();var s=$(window).height();var l=$(document).width();var c=r.eventId;var u=r.pvid;var d=r.channelId;var f=a.uid;var h=r.screenW;var p=r.screenH;var m=o;var v=s;var g=r.pageX-r.scrollLeft-Math.round(o/2);var w=r.pageY-r.scrollTop;var b=r.pageX-Math.round(l/2);var _=r.pageY;var y=a.juid;var k=a.seid;var x=encodeURIComponent(r.positionCode||"");var C=encodeURIComponent(n.referrer||"");var T=encodeURIComponent(r.targetUrl||"");var S="";var I=r.appData;I.referhost=e("referhost")||"";if(i.uid()){var L=$.trim(e("u_data")).split("_");if(L.length)L.forEach(function(e){e=e.split("|");I[e[0]]=e[1]})}$.extend(I,this.getData(c,x,r.event));var E={eid:c,pvid:u,chid:d,uid:f,juid:y,seid:k,sw:h,sh:p,bw:m,bh:v,bpx:g,bpy:w,ppx:b,ppy:_,pcode:r.positionCode||"",url:location.href,rurl:n.referrer||"",turl:r.targetUrl||"",ext:n.param(I)};t.getRequest("http://p.l.youku.com/tclick?"+n.param(E)+"&r="+ +new Date);var D=[];$.each(I,function(e,t){D.push(encodeURIComponent(e)+"="+encodeURIComponent(t))});S=D.join("|");var M=[c,u,d,f,h,p,m,v,g,w,b,_,y,k,x,C,T,S].join("|");t.getRequest("http://stats.tudou.com/ck2/?s="+M+"&r="+ +new Date)},send:function(e,t,i,a){var r=this;if(!e.target)e.target=e.srcElement||document;if(null==e.pageX&&null!=e.clientX){var o=document.documentElement;var u=document.body;e.pageX=r.clientX+(o&&o.scrollLeft||u&&u.scrollLeft||0)-(o&&o.clientLeft||u&&u.clientLeft||0);e.pageY=r.clientY+(o&&o.scrollTop||u&&u.scrollTop||0)-(o&&o.clientTop||u&&u.clientTop||0)}if("undefined"==typeof e.pageX)return;var d=e.target;if(!a){d=n.getStatTarget(e.target);if(!d)return}if("A"==d.nodeName&&$(d).attr("data-openurl"))return;var f=false;var h=n.getTrueLink(d);if("A"!==d.nodeName||""===h||c(h,location.href))f=true;if("ck"==$(d).attr("data-stat-role")&&""!==h)f=false;var p=$(d).attr("data-ck");if(p)$.each(p.split("&"),function(e,i){var n=i.split("=");if(2!==n.length)return;t[n[0]]=n[1]});r.getRequest({event:e,eventId:f?2:1,pvid:r.pvid,channelId:window.cid||0,positionCode:n.getPositionCode(d),targetUrl:f?"":h,pageX:e.pageX,pageY:e.pageY,scrollLeft:$(window).scrollLeft(),scrollTop:$(window).scrollTop(),screenW:s,screenH:l,appData:t||{}});if(i)i.call(r,{isButton:f,targetUrl:h})},init:function(){var e=this;$(document.body).mousedown(function(t){e.send(t,{})})},getXpathFromPositionCode:n.getXpathFromPositionCode,getElementByXPath:n.getElementByXPath,getTrueLink:n.getTrueLink,getStatTarget:n.getStatTarget});o.tudouClickStat=tudouClickStat;o.init=function(){tudouClickStat.init()}});define("module/responsive",["tui/event"],function(e){var t=null;var i=$(window);var n="responsed";var a="resize";var r=null;var o=e.extend({initialize:function(e){var t=this;o.superClass.initialize.call(t)},init:function(e){var t=this;t.divide=e;var n;i.resize(function(){n&&clearTimeout(n);n=setTimeout(function(){t.check()},100)});return t},check:function(){var e=this;var t=e.viewPort();var i=t.width;if(r&&i>=r.s[0]&&i<r.s[1]){e.fire(a,[i,t.height,r.v]);return}r=e._getCurRes();var o=$("body")[0];o.className=o.className.replace(/\s*\bw\d+\b/g,"")+" w"+r.v;e.fire(a,[i,t.height,r.v]);e.fire(n,[r.v])},_getCurRes:function(){var e=this;var t=e.viewPort().width;var i;$.each(e.divide,function(e,n){var a=n.s[0];var r=n.s[1];if(t>=a&&t<r){i=n;return false}});return i},getCurWidth:function(){var e=this._getCurRes();return e.v},viewPort:function(){var e=window,t="inner";var i=this.padding||0;if(!("innerWidth"in window)){t="client";e=document.documentElement||document.body}return{width:e[t+"Width"]-i,height:e[t+"Height"]}}});o.getInstance=function(){if(t)return t;else return t=new o};return o.getInstance()});define("tui/scrollbar",["tui/event","tui/drag"],function(e,t){var i=e.extend({initialize:function(e,n){n=n||{};var a=this;i.superClass.initialize.apply(a,arguments);a.isShow=false;a.barMinSize=n.barMinSize||60;a.wheelDelta=n.wheelDelta||60;a.prevNextDelta=n.prevNextDelta||a.wheelDelta;a.horizontalScroll=n.horizontalScroll||false;var r=a.horizontalScroll;var o=$(e);var s=n.container||o.parent();var l=n.scrollbar||$('<div class="scrollbar_container"><a href="#" class="scrollbar_prev"></a><div class="scrollbar_track"><span class="scrollbar_bar"></span></div><a href="#" class="scrollbar_next"></a></div>');var c=l.find(".scrollbar_track");var u=l.find(".scrollbar_bar");var d=l.find(".scrollbar_prev");var f=l.find(".scrollbar_next");if(!n.scrollbar)s.after(l);var h=new t(u,{limit:true});h.bind("drag:move",function(e,t){a.scrollTo(a.horizontalScroll?e:t)});s.bind("scroll",function(e){a.updateBarPosition()});if($.browser.mozilla)s[0].addEventListener("DOMMouseScroll",function(e){var t=e.detail>0?a.wheelDelta:-a.wheelDelta;s[0][r?"scrollLeft":"scrollTop"]+=t*a._wheelRate;if(a.isShow)e.preventDefault()},false);else s[0].onmousewheel=function(e){e=e||window.event;var t=e.wheelDelta>0?-a.wheelDelta:a.wheelDelta;s[0][r?"scrollLeft":"scrollTop"]+=t*a._wheelRate;if(a.isShow){e.returnValue=false;return false}};u.click(function(e){e.stopPropagation()});c.click(function(e){e.preventDefault();a.scrollTo(e[r?"pageX":"pageY"]-c.offset()[r?"left":"top"]-a._barSize/2)});d.click(function(e){e.preventDefault();s[0][r?"scrollLeft":"scrollTop"]-=a.prevNextDelta});f.click(function(e){e.preventDefault();s[0][r?"scrollLeft":"scrollTop"]+=a.prevNextDelta});a.content=o;a.container=s;a.scrollbar=l;a.track=c;a.prev=d;a.next=f;a.bar=u;a._contentSize=0;a._containerSize=0;a._trackSize=0;a._barSize=0;a.update()},updateBarPosition:function(){var e=this.horizontalScroll;var t=this.container[e?"scrollLeft":"scrollTop"]();var i=(t*this._trackSize-t*this._barSize)/(this._contentSize-this._containerSize);i=i?i:0;this.bar.css(e?"left":"top",i);if(i>=this._trackSize-this._barSize)this.trigger("scroll:end")},scrollTo:function(e,t){var i=this.horizontalScroll;var n=t?e:(e*this._contentSize-e*this._containerSize)/(this._trackSize-this._barSize);this.container[i?"scrollLeft":"scrollTop"](n?n:0)},update:function(){this.show();var e=this.horizontalScroll;var t=e?"width":"height";this._contentSize=this.content[e?"innerWidth":"innerHeight"]();this._containerSize=this.container[t]();this._trackSize=this.track[t]();this._wheelRate=Math.min(Math.atan(this._contentSize/3e3),1);if(this._contentSize>this._containerSize){this._barSize=Math.floor(this._containerSize*this._trackSize/this._contentSize);this._barSize=Math.max(this._barSize,this.barMinSize);this.bar.css(t,this._barSize);this.updateBarPosition()}else this.hide()},show:function(){this.isShow=true;this.scrollbar.show();this.trigger("show")},hide:function(){this.isShow=false;this.scrollbar.hide();this.trigger("hide")}});return i});define("tui/util/url",[],function(e,t){function i(e,t){if(!$.browser.msie)if(t)window.open(e,t);else location.href=e;else{var i=$('<a href="'+e+'" target="'+(t||"_self")+'" data-openurl="true"> </a>')[0];document.body.appendChild(i);i.click()}}function n(e){e=e||location.search||location.href;var t={},i=e.match(/[^\s&?#=\/]+=[^\s&?#=]+/g);if(i)for(var n=0,a=i.length;n<a;n++){var r=i[n].split("=");t[r[0]]=decodeURIComponent(r[1])}return t}t.openURL=i;t.params=n});define("module/sidebar/view",["tui/view","tui/browser","tui/art","tui/dialog","tui/util/url","tui/cookie","tui/scrollbar","module/domain","module/subscribe","module/responsive","module/login/login","module/stat/ck","module/stat/expose","module/global","tui/countdown","page/watch/model/local-record","page/watch/model/setting","module/data/usersublist","module/sidebar/recent-rec-panel","module/sidebar/curvefly"],function(e,t,i,n,a,r,o,s,l,c,u,d,f,h,p,m,v,g,w,b){var _=$(window);var y=$(document.body);var k=$("#gSilderNav");var x=_.height();var C=$.browser.msie&&parseInt($.browser.version)||0;var T=6==C;var S=false;var I=false;var L=false;var E="";var D=30;var M=34;i.helper("$domain",s);var j=i.compile('<li data-sub="<%=item.userId%>" class="subtn">\n<a href="<%=$domain.url.main%>/home/_<%=item.userId%>/?from=gsidebar_rec" class="sub-item" data-pos="<%=index%>" title="<%=item.nickname%>"<% if (isPlayPage) { %> target="_blank"<% } %>>\n<span class="img"><img src="<%=item.userpic%>" /></span>\n<span class="sub-item-title"><%=item.nickname%></span>\n<b>æ¨è</b>\n</a>\n<div class="gbtn_sub gBtnSub" data-id="<%=item.userId%>"></div>\n</li>\n');var P=i.compile('<li data-act="album" data-group="1">\n<a href="<%=$domain.url.main%>/watch/subscribe/?type=album" class="sub-item sub-group sub-group-mv" data-role="pagex"<% if (isPlayPage) { %> target="_blank"<% } %>><span class="img"><i class="iconfont">&#xe645;</i></span>å§é\n<% if (count && count > 99) { %>\n<b class="p99" title="<%=count%>ä¸ªæ´æ°">99+</b>\n<% } else { %>\n<b><%=count || \'\'%></b>\n<% } %>\n<i class="iconfont">&#xe646;</i></a>\n</li>\n');var N=e.extend({tpl:i.compile('<li data-act="<%=item.uid || item.id%>" data-type="<%=item.type%>" data-title="<%=item.name || item.title%>">\n<a href="<%=$domain.url.main%><% if (item.type == 1) { %>/watch/home/?id=<%=item.uid || item.id%>&type=album<% } else { %>/home/_<%=item.uid || item.id%>/?from=gsidebar&count=<%=item.updateCount%><% } %>" class="sub-item" title="<%=item.name || item.title%>"<% if (item.type == 1) { %> data-role="pagex"<% } %><% if (isPlayPage) { %> target="_blank"<% } %>><span class="img"><img<% if (type < 1 && index > 19) { %> src="http://css.tudouui.com/skin/__g/img/sprite.gif" data-src="<%=item.pic || item.smallPic%>" <% } else { %> src="<%=item.pic || item.smallPic%>"<% } %> /></span><% if (type == 1 && item._highlight) { %><%==item._name%><% } else { %><%=item.name || item.title%><% } %>\n<% if (item.updateCount && item.updateCount > 99) { %>\n<b class="p99" title="<%=item.updateCount%>ä¸ªæ´æ°">99+</b>\n<% } else { %>\n<b><%=item.updateCount || \'\'%></b>\n<% } %>\n<i class="iconfont">&#xe646;</i></a>\n</li>\n'),events:{"click #gSideEdit":"edit","click .cancel":"cancel","click .del":"unSub","click .img":"fixClick","click .icon-cancel":"empty","click li[data-order]":"sort","click #gSideSubSort":"toggleSort","click #gRecentTipsClose":"_closeRecentTips","mousedown li[data-act=sub]":"clearUpdateCount","mousedown #gSideSubItems .sub-item":"_updateLocal","mouseleave #gSideSubSort":"leaveSort","click .g-side-login .btn":"toLogin","mouseenter .view_all":"openMore","mouseleave .view_all":"closeMore","mouseenter #gSideMore":"closeClear","mouseleave #gSideMore":"closeMore","click #gSideMenu [data-role=pagex]":"toLogin"},openMore:function(){this.closeClear();this.$sidemo.addClass("g-sidemo-expand");this.find(".view_all").addClass("hover");var e=this.$sidemo.find("[data-act]").length;if(e<4)this.$sidemo.css({bottom:100});this.updateScrollbar();this.loadImg()},closeClear:function(){if(this.moretimer)clearTimeout(this.moretimer)},closeMore:function(){this.closeClear();this.moretimer=setTimeout(function(){this.$sidemo.removeClass("g-sidemo-expand");this.find(".view_all").removeClass("hover")}.bind(this),550)},showTips:function(){var e=+new Date;var t=1e3*60*24*60;var i=this;h.storage.getItem("gsidetip",function(n){if(!n){h.storage.setItem("gsidetip",e);i.initTip()}else if(e-n>t){h.storage.setItem("gsidetip",e);i.initTip()}})},initTip:function(){var e='<div class="g-side-tip" id="gSideTip"><a href="#" class="close">x</a><a href="http://gc.tudou.com/index.html" '+E+' class="c">å» å¹¿åº ééå§ï¼<br>è®¢éæä½ åæ¬¢çèªé¢éï¼</a><i class="ankle ak1"><i class="ankle ak2"></i></i></div>';var t=this;this.$manage.append(e);p("",5,function(){t.removeTips()});this.$manage.on("click",".close",function(e){e.preventDefault();t.removeTips()})},removeTips:function(){var e=this.find("#gSideTip");if(e.length)e.remove()},initialize:function(){var e=this;e.setElement($("#gSideBar"));e.$subs=e.find("#gSideSubs");e.$list=e.find(".g-subs-list");e.$items=e.find("#gSideSubItems");e.$group=e.find("#gSideSubGroup");e.$recom=e.find("#gSideRecom");e.$ritems=e.find("#gSideRecomItems");e.$scroll=e.find("#gSideSubScroll");e.$scrollList=e.find(".g-sidesub-scroll");e.$count=e.find("#gSideSubCount");e.$msg=e.find("#gSideSubMessage");e.$sort=e.find("#gSideSubSort");e.$sidemo=e.find("#gSideMore");e.$manage=e.find(".g-side-manage");e.$loading=e.find(".gSideloading");var i=window.config&&window.config.pageId||window.pageId||0;S=i>=1&&i<=8||701==i;L=300==i;I=S||t.isPad;E=S?'target="_blank"':"";if(!u.uid())y.addClass("g-sidebar-guest");else{e.$el.removeClass("g-sidebar-init");e.showTips()}e._initStat();u.bind("after:login",e.afterLogin.bind(e));_.bind("resize",e.resize.bind(e));e.resize();e.$scrollList.bind("scroll",e.loadImg.bind(e));e.model=new g;e.model.bind("sublist:change",e.change.bind(e));e.model.bind("sublist:data",e.render.bind(e));e.model.bind("subremoved",e.removeItem.bind(e));e.model.bind("subadded",e.addItem.bind(e));e.model.bind("unsubed",e.unSubed.bind(e));e.model.bind("resubed",e.reSubed.bind(e));e.model.bind("getrec:success",e.renderRec.bind(e));var n=v.getItem("subListOrder");e.order=$.isNumeric(n)?n:1;e.$sort.find("[data-order="+e.order+"]").addClass("current");var a='<div class="g-top-cartoon"><i class="i2"></i><i class="i1"></i></div>';if(!y.hasClass("g-sidebar-hide")){e.isExpanded=true;c.padding=200;e.initLoad();k.addClass("active");a='<div class="g-top-cartoon"><i class="i3"></i><i class="i1"></i></div>'}e.isFitTop=y.hasClass("g-sidebar-top");e.updateNum();e._recentRecommend();l.globalEvent.bind("sub:success",e.gAddSub.bind(e));l.globalEvent.bind("unsub:success",e.gUnSub.bind(e));if(!I)_.bind("resize",e.fitTop.bind(e));if(!t.isMobile&&!e.scrollbar)e.scrollbar=new o(e.$scroll,{barMinSize:30});k.on("click",e.toggleShow.bind(e));y.on("mousedown",e.bodyClick.bind(e));if(y.width()>1250)e.cartoon(a)},cartoon:function(e){var t=k.offset();var i=$(e);y.append(i);setTimeout(function(){i.css({left:t.left+70,top:13})},250);setTimeout(function(){i.css({opacity:0})},1e4)},toggleShow:function(e){e.preventDefault();if(!this.isExpanded){this.show();this.expand();$(".g-top-cartoon").html('<i class="i3"></i><i class="i1"></i>')}else{this.fold();$(".g-top-cartoon").html('<i class="i2"></i><i class="i1"></i>')}},bodyClick:function(e){var t=$(e.target||e.srcElement);if(!t.hasClass("g_slidernav")&&!t.closest("#gSideBar").length&&y.hasClass("g-sidebar-top")&&this.isExpanded)this.fold()},initLoad:function(){this.isLoaded=true;if(u.uid())this.model.one("sublist:data",this._subCountReady.bind(this));else this._sendExpose();this.loadSub()},nav:function(e){var t=this.$list.eq(1);if(!e)return;var i=this.find('[data-act="'+e+'"]');if(i.length){this.find(".current[data-act]").removeClass("current");i.addClass("current")}var n=t.find('[data-act="'+e+'"]');if(n.length&&$.isNumeric(e)){var a=t.height();var r=t[0].scrollTop;var o=n.offset().top-t.offset().top;if(o>r+a)t[0].scrollTop=o}},afterLogin:function(){y.removeClass("g-sidebar-guest");this.isRecLoaded=false;this.$items.empty();this.$ritems.empty();this.updateNum();this.loadSub();this._recentRecommend();this.showTips()},render:function(e,t){e=0;t=t||this.renderData||[];this.renderData=t;this.renderType=e;var i=this;var n=this.model;var a=[],r=t.length;var o=n.hasAlbum;var l=n.getItemCount(2);var c=Math.floor((_.height()-420)/M);c=o?c-1:c;c=c<1?1:c;i.mainCount=c;t=n.getItemsByType(2);r=t.length||0;if(r){var d=0;for(var f=0,h=r>c?c:r;f<h;f++)a.push(i.tpl({type:e||0,