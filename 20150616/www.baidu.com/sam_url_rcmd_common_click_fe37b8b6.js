bds.comm.recommends={};bds.comm.recommends.recommWidth=0;bds.se.recommend=function(b){var a=this;a.op=$.extend({},a._default,b);a.id=a.op.target.attr("id");a.init()};bds.se.recommend.prototype={constructor:bds.se.recommend,__init__:false,currInstance:null,recommDom:null,arrowDom:null,cssDom:null,loadDom:null,global:{},_default:{target:"",arrowOffset_s:-54,arrowOffset_l:-151,container_s:276,container_l:368,startOpacity:0.3,endOpacity:1},init:function(){var a=this;if(a.currInstance&&a.currInstance.id==a.id){return}if(a.disable){a.setCacheData("[NO DATA]")}a.delay={overIcon:null,loader:null,overArrow:null};a.doWhat(function(){if(!a.__init__){bds.se.recommend.prototype.__init__=true;a.createRecommDom()}a.createArrowDom();a.delay.overArrow=setTimeout(function(){var b=a.op.arrowDom.find(".rrecom-btn");if(b.css("display")=="none"){b.show()}a.moveArrow(function(){b.addClass("rrecom-btn-hover");a.showRecommDom()})},100)})},dispose:function(){bds.se.recommend.prototype.currInstance=null;bds.se.recommend.prototype.recommDom&&bds.se.recommend.prototype.recommDom.remove();
bds.se.recommend.prototype.cssDom&&bds.se.recommend.prototype.cssDom.remove();bds.comm.recommends={};bds.se.recommend.prototype.__init__=false;$(window).off("resize.recommend container_resize.recommend scroll.recommend")},createArrowDom:function(){var d=this;var a=d.op.target.find(".rrecom-btn-parent");if(a.length){d.op.arrowDom=a}else{var b=['<span class="rrecom-btn-parent rrecom-btn-s">','<span class="rrecom-btn">',"<span></span>","</span>","</span>"].join("");d.op.arrowDom=$(b);d.op.arrowDom.on("click",".rrecom-btn",function(){d.hideRecommDom();return});d.op.target.css({position:"relative"}).append(d.op.arrowDom)}},resetArrow:function(){var a=this;a.op.arrowDom.css({right:a.op.arrowOffset_s}).removeClass("rrecom-btn-click rrecom-btn-moving").find(".rrecom-btn").stop().hide().removeClass("rrecom-btn-hover")},setArrowPos:function(){var a=this;if(a.currInstance){if(bds.comm.containerSize==="l"){a.currInstance.op.arrowDom.css("right",a.op.arrowOffset_l)}else{a.currInstance.op.arrowDom.css("right",a.op.arrowOffset_s)
}}},moveArrow:function(a){var d=this;var b={opacity:d.op.endOpacity};if(bds.comm.containerSize==="l"){b.right=d.op.arrowOffset_l}else{b.right=d.op.arrowOffset_s}d.op.arrowDom.stop().addClass("rrecom-btn-moving rrecom-btn-click").animate(b,0,function(){if(d.currInstance&&d.currInstance!==d){d.currInstance.resetArrow()}a()})},log:function(a){var f={};var j=this.op.target.attr("data-click");var m=this.op.target.attr("srcid");var h=this.op.target.attr("tpl");var n=this.op.target.attr("mu");if(m){f.rsv_srcid=m}if(h){f.rsv_tpl=h}if(n){f.mu=n}if(j){$.extend(f,$.parseJSON(j))}if(f.p1&&!f.p5){f.p5=f.p1}if(f.p5&&!f.p1){f.p1=f.p5}if(!f.p1&&!f.p5){var l=$("#content_left").get(0);var d=l.children;var k=1;for(var e=0,g=d.length;e<g;e++){if(d[e].nodeType==1&&d[e].className&&/\bresult(\-op)?\b/.test(d[e].className)){if(d[e]===this.op.target.get(0)){f.p1=k;f.p5=k;break}k++}}}f.fm="beha";var b=this.op.target.find(".t>a").eq(0);f.rsv_re_fcurl=b.length?b.attr("href"):n;f.rsv_re_fcurl=f.rsv_re_fcurl||"";f.rsv_re_fcurl=encodeURIComponent(f.rsv_re_fcurl);
return c($.extend(f,a))},getLeftP:function(){var a=this.op.target.attr("data-click");a=$.parseJSON(a)||{};if(a.p1&&!a.p5){a.p5=a.p1}if(a.p5&&!a.p1){a.p1=a.p5}if(!a.p5&&!a.p1){a.p1=1;a.p5=1}return{p1:a.p1,p5:a.p5}},s_log:function(){this.log({rsv_re_fc:2})},setCacheData:function(a){bds.comm.recommends[this.id]=a},getCacheData:function(){return bds.comm.recommends[this.id]},doWhat:function(a){var b=this.getCacheData();if(b!=="[NO DATA]"){if(b){a()}else{this.getRemoteData(a)}}else{}},getJsonp:function(a){var g=this.op.target.find(".t>a").eq(0);var e=(g.length?g.attr("href"):this.op.target.attr("mu"))||"";var d=e&&e.match(/.*url=([^&]*).*/);var b;if(d&&d.length&&d.length>0&&d[1]){e=d[1];b="http://lcr.open.baidu.com/link?url="+encodeURIComponent(e)}else{b="http://api.open.baidu.com/pae/common/api/leftclickgetright?url="+encodeURIComponent(e)}var f=window.bds&&bds.util&&bds.util.domain&&bds.util.domain.get(b);return($.ajax({url:f,dataType:"jsonp",jsonp:"cb",data:{data_name:a,ie:"utf-8",oe:"utf-8",format:"json",t:Date.parse(new Date())}}))
},getRemoteData:function(a){var b=this;$.when(this.getJsonp("recommend_common_merger")).then(function(d){if(d&&d.data&&d.data.length&&d.data[0]){b.setCacheData(d.data);a()}else{b.setCacheData("[NO DATA]")}},function(d){})},buildURL:function(e){var g="/s?";var d={tn:bds.comm.tn};var b=$("#form");var a=b.find("input[name=rsv_idx]");var f="";d.rsv_idx=a.length?a.val():"";for(var h in d){if(d.hasOwnProperty(h)&&d[h]){f+=h+"="+encodeURIComponent(d[h])+"&"}}return(g+f+e)},renderTpl:function(e,d){var b=this;if(!e||!d){return}var a={};a.url_right_recommends_merge=function(h){var h=h||d;var n="";var g=12;var k=0;for(var l=0,f=h.Right_Resources.card.length;l<f;l++){var j=h.Right_Resources.card[l];k+=parseInt(j.shownums||0);if(k>g){break}n+=m(j,(l+1))}return n;function m(r,t){var C='<div class="cr-content" data-click=\'#{2}\'><div class="cr-title c-clearfix"><span title="#{0}">#{1}</span></div>';var v='<div class="c-row c-gap-top">';var x='<div class="c-span4#{5} rrecom-item" data-click=\'#{6}\'><div class="rrecom-p"><a target="_blank" href="#{0}"><img class="c-img c-img4 rrecom-img" src="#{1}"></a></div><div class="c-gap-top-small"><a target="_blank" title="#{2}" href="#{3}">#{4}</a></div><div><img src="#{7}" class="opr-recommends-merge-imgtext" data-nolog="1"></div>';
var o='<div class="c-span4#{5} rrecom-item" data-click=\'#{6}\'><div class="rrecom-p"><a target="_blank" href="#{0}"><img class="c-img c-img4 rrecom-img" src="#{1}"></a></div><div class="c-gap-top-small"><a target="_blank" title="#{2}" href="#{3}">#{4}</a></div>';var F="</div>";var w="";var u=r.showrow;var i=r.shownums;var E;var s={rsv_srcid:null};for(var z=0,B=r.list.length;z<B;z++){if(!s.rsv_srcid){var y=r.list[z].params.match(/rsv_dl=0_right_recom_(\d+)$/);s.rsv_srcid=y&&y[1];s.rsv_srcid=s.rsv_srcid||"20927"}else{break}}w+=$.format(C,r.subtitle,r.subtitle,$.stringify(s));w+='<div class="rrecom-panel">';var p=b.op.target.find(".t>a").eq(0);var q=p.length?p.attr("href"):b.op.target.attr("mu");for(var z=0,B=r.list.length;z<B;z++){E=r.list[z];var D={rsv_re_ename:E.name,rsv_re_uri:E.uri,rsv_re_fcpoi:t+"-"+(z+1),rsv_clk_url:q};var A=b.buildURL(E.params);if(z==i){break}if(z%4===0){w+=v}if(bds.util&&bds.util.domain&&bds.util.domain.get){E.img=bds.util.domain.get(E.img)}w+=$.format(o,A,E.img,E.name,A,E.name,((z+1)%4===0)?" c-span-last rrecom-item-rowLast":(((z+1)%4===3)?" rrecom-item-s":""),$.stringify(D),E.attrpic);
w+=F;if((z+1)%4===0||z==B-1){w+=F}}w+=F;w+=F;return w}};if(a[e]){return a[e]()}},render:function(e){var b="";for(var a=0;a<e.length;a++){b+=this.renderTpl(e[a].extData.tplt,e[a].tplData)}var d=this.getLeftP();d.fm="alxr";this.recommDom.attr("data-click",$.stringify(d)).find(".rrecom-content").eq(0).empty().append(b);this.setRecommPosition()},createRecommDom:function(){var d=['<div style="position:fixed;left:-1px;background:#fff;border:1px solid #eee;z-index:101" class="result-op xpath-log" data-click=\'{"fm":"alxr","p1":1,"p5":1}\'>','<div class="rrecom-ajax-loading c-loading"></div>','<div class="rrecom-container">','<a href="javascript:;" class="rrecom-btn-close" data-click=\'{"rsv_re_fc":4,"fm":"beha"}\'></a>','<div class="rrecom-content"></div>',"</div>","</div>"].join("");var b=["<style>",".rrecom-btn-close,.rrecom-btn span{background:url(http://s1.bdstatic.com/r/www/cache/static/global/img/rrecom_icon_034abe03.png) no-repeat;}",".rrecom-btn-close{display:inline-block;width:13px;height:13px;position:absolute;top:26px;right:10px;background-position:0 -20px;}",".rrecom-btn-parent{z-index:102;position:absolute;right:-37px;top:50%;margin-top:-50px;height:59px;width:40px;cursor:default;padding:20px 0px;}",".rrecom-btn{display:none;background-color:#fff;padding:20px 5px;position:absolute;right:10px;width:20px;height:19px;border:1px solid transparent;}",".rrecom-btn-hover{right:-1px;border:1px solid #eee;border-right:1px solid #fff;z-index:102;box-shadow:0px 2px 0px rgba(0,0,0,0.072);-webkit-box-shadow:0px 2px 0px rgba(0,0,0,0.072);-moz-box-shadow:0px 2px 0px rgba(0,0,0,0.072);-o-box-shadow:0px 2px 0px rgba(0,0,0,0.072);}",".rrecom-btn span{cursor:pointer;background-position:0 0;width:20px;height:19px;position:absolute;top:50%;left:50%;margin:-10px 0 0 -10px;}",".rrecom-container{width:368px;padding-top:43px;overflow:hidden;background-color:#fff;}",".rrecom-ajax-loading{position:absolute;left:50%;margin-left:-25px;top:50px;display:none;}",".rrecom-content{margin-left:17px;}",".rrecom-content .cr-content{width:100%;margin-bottom:28px;}",".rrecom_content_s{padding-left:0px;width:276px;}",".rrecom_content_s .rrecom-item-rowLast{display:none}",".rrecom_content_s .rrecom-item-s{margin-right:0;}",".rrecom-panel{text-align:center;}","</style>"].join("");
bds.se.recommend.prototype.recommDom=$(d);bds.se.recommend.prototype.cssDom=$(b);bds.se.recommend.prototype.loadDom=this.recommDom.find(".rrecom-ajax-loading");this.setRecommSize();$("body").append(this.cssDom).append(this.recommDom.hide());this.bindRecommEvent();$(window).trigger("container_resize.recommend",bds.comm.containerSize);var a=$("#foot");if(a.css("position")==="static"){a.css({position:"relative","z-index":103})}},setRecommSize:function(){var f=$("#content_right");var d=$("#wrapper_wrapper");var e=$("body");var b=$(window);var h=f.offset();var a={w:e.width()};var g={h:b.height()};var k=b.scrollTop();d.prevAll().each(function(){var l;if(this.nodeName.toLowerCase()==="div"){l=parseInt($(this).css("margin-bottom"));bds.se.recommend.prototype.global.topGap=isNaN(l)?0:l;return false}});bds.se.recommend.prototype.global.topDom=d;bds.se.recommend.prototype.global.headDom=$("#head");var i={top:this.global.topDom.offset().top-this.global.topGap};var j=this.global.headDom.offset().top-k+56;
this.recommDom.height(g.h);bds.comm.recommends.recommWidth=a.w-h.left-2,this.recommDom.css({width:a.w-h.left-2,top:(k<=(i.top-j))?(i.top):j,position:(k<=(i.top-j))?"absolute":"fixed",left:h.left})},setRecommPosition:function(){this.setRecommTop();this.setRecommLeft()},setRecommTop:function(){var b=$(window).scrollTop();var a={top:this.global.topDom.offset().top-this.global.topGap};var d=this.global.headDom.offset().top-b+56;this.recommDom.css({top:(b<=(a.top-d))?(a.top):d,position:(b<=(a.top-d))?"absolute":"fixed"}).find(".rrecom-container").css({"margin-top":"0px"});bds.se.recommend.prototype.global.originalTop=(b<d)?d:b},setRecommLeft:function(){var b,a;if(this.recommDom.css("position")==="fixed"){b=$("#content_right").offset().left;a=$(window).scrollLeft();this.recommDom.css("left",parseInt(b)-a)}},bindRecommEvent:function(){var a=this;this.recommDom.find(".rrecom-btn-close").eq(0).on("click",function(){a.hideRecommDom()});$(window).on("scroll.recommend",function(h){var b={top:a.global.topDom.offset().top-a.global.topGap};
var k=a.global.headDom.offset().top+a.global.headDom.outerHeight();var g=$(this);var j;var d;var f;if(a.recommDom&&a.recommDom.css("display")!=="none"){j=g.scrollTop();d=g.scrollLeft();k-=j;if(j<=(b.top-k)){if(a.recommDom.css("position")==="fixed"){a.recommDom.css("position","absolute");a.recommDom.css("top",b.top)}}else{if(a.recommDom.css("position")==="absolute"){a.recommDom.css("position","fixed");a.recommDom.css("top",k)}}var i=a.recommDom.find(".rrecom-container");if(a.global.originalTop<j){maxMargin=Math.min(a.recommDom.height()-i.height()-82-75,0);i.css({"margin-top":Math.max(a.global.originalTop-j,maxMargin)})}else{i.css({"margin-top":"0px"})}if(d){f=$("#content_right").offset().left;if(a.recommDom.css("position")==="fixed"){a.recommDom.css("left",parseInt(f)-d)}else{a.recommDom.css("left",parseInt(f))}}}}).on("resize.recommend",function(){a.setRecommSize();a.setArrowPos()}).on("container_resize.recommend",function(d,b){var f=a.recommDom.find(".rrecom-container");if(b==="s"&&!f.hasClass("rrecom_content_s")){f.addClass("rrecom_content_s");
f.find(".rrecom-content").css("width",(a.op.container_s-17)+"px")}else{if(b==="l"){f.removeClass("rrecom_content_s");f.find(".rrecom-content").css("width",(a.op.container_l-17)+"px")}}})},hideRecommDom:function(){var a=this;a.recommDom.find(".rrecom-container").animate({width:"0px"},200,function(){a.recommDom.hide()});a.currInstance&&window.clearTimeout(a.currInstance.delay.overArrow);a.currInstance&&a.currInstance.resetArrow();bds.se.recommend.prototype.currInstance=null},showRecommDom:function(){var d=this;if(d.currInstance!==d){}if(d.recommDom.css("display")==="none"){d.recommDom.css({opacity:0.3}).show().animate({opacity:1},100);var b=d.recommDom.find(".rrecom-container");var a=bds.comm.recommends.recommWidth;b.css({width:0}).animate({width:a+"px"},200)}if(d.recommDom.find(".rrecom_content_s").length>0){d.recommDom.find(".rrecom-content").css("width",(d.op.container_s-17)+"px")}else{d.recommDom.find(".rrecom-content").css("width",(d.op.container_l-17)+"px")}bds.se.recommend.prototype.currInstance=d;
d.render(d.getCacheData())},showLoading:function(){this.loadDom.show()},hideLoading:function(){this.loadDom.hide()}};$(window).one("swap_end",function(){if(!(bds.comm.upn.ie&&bds.comm.upn.ie==6)){$(document).on("click","#content_left .result .t>a, #content_left .result-op .t>a",function(b){if(!b.ctrlKey){var a=$(this).closest(".result, .result-op");new bds.se.recommend({target:a})}})}});$(window).on("swap_begin",function(){bds.se.recommend.prototype.currInstance&&bds.se.recommend.prototype.hideRecommDom();bds.se.recommend.prototype.currInstance=null;bds.comm.recommends={};bds.se.recommend.prototype.__init__=false});