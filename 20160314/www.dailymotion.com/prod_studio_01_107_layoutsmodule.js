self.studioLoader.context.evalInContext("var Pj=new B,Qj=new B,Rj=0,Sj=/(?:(.*)\\.)?([^\\.\\[]+)(?:\\[(\\d+)\\])?/;m(\"studio.sdk.layouts.config.declare\",function(a,b){Pj.L(a)||Pj.set(a,new Tj(a,b))},void 0);m(\"studio.sdk.layouts.config.instantiate\",function(a,b){return Pj.L(a)?Pj.get(a).create(b):null},void 0);var Vj=function(a){var b=Uj(a);return b||(b=Pj.get(a),b)?b:null},Xj=function(a){return Wj(a)?Qj.get(a[\"@id\"]):null},Zj=function(a){return u(a)?(a=Xj(a))?a.a:null:Yj(a)},ak=function(a){return(a=Xj(a))?a.a.b:null};m(\"studio.sdk.layouts.config.getType\",ak,void 0);m(\"studio.sdk.layouts.config.getPath\",function(a){return(a=Xj(a))?bk(a):null},void 0);var dk=function(a,b){var c,d,e;if(!Wj(a))return null;(d=Sj.exec(b))?(e=parseInt(d[3],10),isNaN(e)&&(e=null),c=d[1]||\"\",d=d[2]||\"\"):(c=\"\",d=b,e=null);c=ck(a,c);return Wj(c)?{ka:c,propertyName:d,index:e}:null},fk=function(a,b,c){if(a=dk(a,\"\")){var d=Xj(a.ka),e=a.propertyName,g=a.index;a=d;e&&(d=d.C()[e],r(g)&&(d=d[g]),(d=Xj(d))&&(a=d));d=!1;r(a.c)&&a.g&&(d=ek(a.b,a.g).i.a.contains(b+\"_\"+c));b=d||a.a.c.a.contains(b+\"_\"+c)?Fa(bk(a),\"::\",c):\"\"}else b=\"\";return b},gk=function(a){this.b=a},Tj=function(a,b){this.b=a;this.a=new B;this.c=new hk;ik(this,b)};x(Tj,gk);var ik=function(a,b){b&&z(b,function(a,b){jk(this.c,b,a)||this.a.set(b,new kk(0,b,a))},a)};Tj.prototype.create=function(a){var b=lk(this);y(this.a.M(),function(c){var d=this.a.get(c),e=void 0;a&&(e=a[c]);d=mk(d,e);b[c]=d;nk(b,c,d)},this);return b};var nk=function(a,b,c){a=a?Xj(a):null;if(fa(c))for(var d=0;d<c.length;d++){var e=d,g=Xj(c[d]);g&&ok(g,a,b,e)}else(c=Xj(c))&&ok(c,a,b,void 0)},pk=function(a,b){this.b=a;this.g=b};x(pk,gk);pk.prototype.create=function(a){return l(a)?a:this.g};var qk=new pk(\"string\",\"\"),rk=new pk(\"number\",0),sk=new pk(\"boolean\",!0),tk=new pk(\"url\",null),uk=new pk(\"color\",\"#000000\"),vk=new pk(\"image\",null),wk=new pk(\"video\",null),xk=new pk(\"asset\",null),Uj=function(a){switch(a.toLowerCase()){case \"string\":case \"str\":return qk;case \"integer\":case \"int\":case \"float\":case \"number\":return rk;case \"boolean\":case \"bool\":return sk;case \"url\":return tk;case \"color\":return uk;case \"image\":return vk;case \"video\":return wk;case \"asset\":return xk}},Yj=function(a){switch(ea(a)){case \"number\":return rk;case \"boolean\":return sk;case \"string\":return qk;default:return gh(a),qk}},kk=function(a,b,c){this.h=b;this.a=new Cb;this.g=this.c=!1;this.b=void 0;this.i=new hk;switch(ea(c)){case \"string\":case \"number\":case \"boolean\":this.c=!1;this.g=!0;this.b=c;this.a.add(Yj(this.b));break;case \"array\":yk(this,c);break;case \"object\":zk(this,c)}},yk=function(a,b){0!=b.length&&(a.c=!0,a.g=!0,a.b=b,y(b,function(a){(a=Yj(a))&&this.a.add(a)},a))},zk=function(a,b){a.c=!!b[\"@array\"];a.g=!!b[\"@required\"];var c=b[\"@type\"];if(l(c))switch(ea(c)){case \"string\":a.a.add(Vj(c));break;case \"array\":y(c,function(a){(a=Vj(a))&&this.a.add(a)},a);break;default:return}else a.a.add(qk);a.b=void 0;b.hasOwnProperty(\"@value\")?(c=b[\"@value\"],l(c)?a.b=mk(a,c):a.b=void 0):a.a.na()||a.c||(a.b=a.a.G()[0].create(void 0));Ak(a.i,b)};kk.prototype.f=function(a){var b=this.a;if(!u(a))return a;var c=null;Wj(a)?c=Zj(a):a.hasOwnProperty(\"@type\")?c=Pj.get(a[\"@type\"]):1==b.P()&&(c=b.G()[0]);return c&&b.contains(c)?c.create(a):null};var mk=function(a,b){var c=l(b)?b:a.b,d=void 0;a.c?l(c)?(n(c)||(c=[c]),d=La(c,v(a.f,a))):d=[]:l(c)&&(d=a.f(c));return!l(d)&&a.g?null:d},lk=function(a){var b={};b[\"@id\"]=Rj++;a=new Bk(a,b);Qj.set(a.v(),a);return b},Wj=function(a){var b=u(a)&&\"@id\"in a;b&&(b=a[\"@id\"],b=Qj.L(b)&&Qj.get(b).C()==a);return b},ck=function(a,b){var c=Xj(a);return c?Ck(c,b):null},Bk=function(a,b){this.f=b[\"@id\"];this.a=a;this.i=b;this.c=this.g=this.b=null};Bk.prototype.v=function(){return this.f};var ek=function(a,b){return a.a instanceof Tj?a.a.a.get(b):null};Bk.prototype.C=function(){return this.i};var bk=function(a){if(!a.b)return\"\";var b=bk(a.b);b&&(b+=\".\");b+=a.g;r(a.c)&&(b+=\"[\"+a.c+\"]\");return b},ok=function(a,b,c,d){(a.b=b)?(a.g=c,a.c=r(d)?d:null):(a.g=null,a.c=null)},Ck=function(a,b){if(!b)return a.C();var c;if(b){var d=/^(\\w+)(?:\\[(\\d+)\\])?(?:\\.(.*))?$/.exec(b);c=d?{lb:d[1],index:d[2]?parseInt(d[2],10):-1,mb:d[3]?d[3]:null}:null}else c=null;var e=c.lb,d=c.index;c=c.mb;if(!a.a.a.get(e))return null;e=a.C()[e];if(0<=d){if(!fa(e))return null;e=e[d]}if(c){d=Xj(e);if(!d)return null;e=Ck(d,c)}return e},hk=function(){this.a=new Cb},Dk=function(a,b,c){n(c)?y(c,function(a){this.a.add(b+\"_\"+a)},a):q(c)&&a.a.add(b+\"_\"+c)},Ak=function(a,b){b&&z(b,function(a,b){jk(this,b,a)},a)},jk=function(a,b,c){if(0!=b.lastIndexOf(\"@\",0))return!1;b=Da(b);switch(b){case \"exit\":return Dk(a,\"exit\",c),!0;case \"counter\":return Dk(a,\"counter\",c),!0;case \"timer\":return Dk(a,\"timer\",c),!0}return!1},Ek=function(a,b){var c=a[b];return n(c)?c:(ak(a),null)};var Gk=function(a){this.a=Xj(a);this.h=new Fk;this.c=new B;this.b=new B;this.i=new B;this.g=new B;this.f=new B},Hk=new B,Ik=function(a){if(!Wj(a))return null;var b=a[\"@id\"];Hk.L(b)||Hk.set(b,new Gk(a));return Hk.get(b)},Jk=function(a,b,c){a=dk(a,b);return!a||c&&!Ek(a.ka,a.propertyName)?null:(c=Ik(a.ka))?{controller:c,propertyName:a.propertyName,index:a.index}:null},W=function(a,b){var c=a.get(b);l(c)||(c=new Fk,a.set(b,c));return c},Lk=function(a){y(a.c.M(),function(a){var c=this.a.C()[a];W(this.c,a).a(c)},a);y(a.b.M(),function(a){for(var c=this.a.C()[a],d=0;d<c.length;d++){var e=c[d],g=d,k=c;W(this.b,a).a(e,g,k)}},a);y(a.g.M(),function(a){var c=this.a.C()[a];W(this.g,a).a(c)},a);Kk(a)},Kk=function(a){a.h.a(a.a.C());(a=a.a.b)&&Kk(Ik(a.C()))},Fk=function(){this.b=[]};Fk.prototype.add=function(a,b){var c=this.b,d={D:a,scope:b};0<=Ka(c,d)||c.push(d)};var Mk=function(a,b,c){var d=Na(a.b,function(a){return a.D==b&&a.scope==c});-1!=d&&Oa(a.b,d)};Fk.prototype.a=function(a){var b=arguments;y(this.b,function(a){a.D.apply(a.scope,b)})};m(\"studio.sdk.layouts.binding.addValueChangeListener\",function(a,b,c){(a=Ik(a))&&a.h.add(b,c)},void 0);m(\"studio.sdk.layouts.binding.removeValueChangeListener\",function(a,b,c){(a=Ik(a))&&Mk(a.h,b,c)},void 0);var Nk=function(a,b,c,d){(a=Jk(a,b))&&W(a.controller.c,a.propertyName).add(c,d)};m(\"studio.sdk.layouts.binding.addPropertyChangeListener\",Nk,void 0);m(\"studio.sdk.layouts.binding.removePropertyChangeListener\",function(a,b,c,d){(a=Jk(a,b))&&Mk(W(a.controller.c,a.propertyName),c,d)},void 0);var Ok=function(a,b,c,d){(a=Jk(a,b,!0))&&W(a.controller.b,a.propertyName).add(c,d)};m(\"studio.sdk.layouts.binding.addArrayInsertListener\",Ok,void 0);m(\"studio.sdk.layouts.binding.removeArrayInsertListener\",function(a,b,c,d){(a=Jk(a,b,!0))&&Mk(W(a.controller.b,a.propertyName),c,d)},void 0);var Pk=function(a,b,c,d){(a=Jk(a,b,!0))&&W(a.controller.i,a.propertyName).add(c,d)};m(\"studio.sdk.layouts.binding.addArrayRemoveListener\",Pk,void 0);m(\"studio.sdk.layouts.binding.removeArrayRemoveListener\",function(a,b,c,d){(a=Jk(a,b,!0))&&Mk(W(a.controller.i,a.propertyName),c,d)},void 0);m(\"studio.sdk.layouts.binding.addValueAddedListener\",function(a,b,c,d){(a=Jk(a,b))&&W(a.controller.g,a.propertyName).add(c,d)},void 0);m(\"studio.sdk.layouts.binding.removeValueAddedListener\",function(a,b,c,d){(a=Jk(a,b))&&Mk(W(a.controller.g,a.propertyName),c,d)},void 0);m(\"studio.sdk.layouts.binding.addValueRemovedListener\",function(a,b,c,d){(a=Jk(a,b))&&W(a.controller.f,a.propertyName).add(c,d)},void 0);m(\"studio.sdk.layouts.binding.removeValueRemovedListener\",function(a,b,c,d){(a=Jk(a,b))&&Mk(W(a.controller.f,a.propertyName),c,d)},void 0);var Qk=function(a){var b=Ik(a);if(b){Lk(b);for(var c in a)if(b=a[c],n(b))for(var d=0;d<b.length;d++)u(b[d])&&Qk(b[d]);else u(b)&&Qk(b)}};m(\"studio.sdk.layouts.binding.fireAllListeners\",Qk,void 0);var Rk=function(a,b,c){var d=Jk(a,b);if(d){a=d.controller;b=d.propertyName;var d=d.index,e=a.a.C(),g=e[b];ek(a.a,b);if(Zj(c)){if(null!=d){var k=g,g=k[d];k[d]=c;c=k}else e[b]=c;nk(null,b,g);nk(e,b,c);d=c;W(a.c,b).a(d);Kk(a)}}};m(\"studio.sdk.layouts.binding.update\",Rk,void 0);var Wk=function(a,b){if(Wj(a)){var c=Xj(a);y(c.a instanceof Tj?c.a.a.M():null,function(d){var e=ek(c,d),g=a[d],k=b[d],p=null!=g?Zj(g):e.a.G()[0];if(e.c){if(n(g))for(;0<g.length;)Sk(a,d,0);n(k)?y(k,function(b,c){Tk(a,d,b,c)}):null!=k&&Tk(a,d,k,0)}else p instanceof pk?Rk(a,d,k):p instanceof Tj&&(null!=k?Uk(a,d,k):null!=g&&Vk(a,d),null!=g&&null!=k&&Wk(g,k))})}};m(\"studio.sdk.layouts.binding.updateAll\",Wk,void 0);var Tk=function(a,b,c,d){if(b=Jk(a,b,!0)){a=b.controller;b=b.propertyName;var e=d,g=a.a.C();if(d=Ek(g,b)){c=ek(a.a,b).f(c);if(0>e||e>d.length)e=d.length;Ta(d,e,0,c);nk(g,b,d);W(a.b,b).a(c,e,d);Kk(a)}}};m(\"studio.sdk.layouts.binding.arrayInsert\",Tk,void 0);var Sk=function(a,b,c){if(b=Jk(a,b,!0)){a=b.controller;b=b.propertyName;var d=a.a.C(),e=Ek(d,b);if(e)if(0>c||c>=e.length)ak(d);else{var g=e[c];Oa(e,c);nk(null,b,g);nk(d,b,e);W(a.i,b).a(g,c,e);Kk(a)}}};m(\"studio.sdk.layouts.binding.arrayRemove\",Sk,void 0);var Uk=function(a,b,c){if(b=Jk(a,b)){a=b.controller;b=b.propertyName;var d=a.a.C(),e=d[b],g=ek(a.a,b);g&&(c=g.f(c),d[b]=c,nk(null,b,e),nk(d,b,c),e&&W(a.f,b).a(e),W(a.g,b).a(c),Kk(a))}};m(\"studio.sdk.layouts.binding.addValue\",Uk,void 0);var Vk=function(a,b){var c=Jk(a,b);if(c){var d=c.controller,c=c.propertyName,e=d.a.C();if(e[c]){var g=e[c];delete e[c];nk(null,c,g);nk(e,c,void 0);W(d.f,c).a(g);Kk(d)}}};m(\"studio.sdk.layouts.binding.removeValue\",Vk,void 0);var Xk=function(a,b){F.call(this);this.a=a;this.b=b;P().$a(\"livePreviewChannel\",v(this.c,this))};x(Xk,F);m(\"studio.sdk.layouts.PreviewHandler.CallbackMethods\",{Lc:\"showNode\",Ic:\"hideNode\",Hc:\"changeValue\",Kc:\"showMessage\"},void 0);Xk.prototype.c=function(a){q(a)&&(a=L(a));if(u(a)&&\"functionName\"in a){var b=a.args;switch(a.functionName){case \"updateValue\":if(3>b.length)break;a=b[0];var c=L(b[1]);this.pa(a,c,b[2]);break;case \"addArrayItem\":if(4>b.length)break;a=b[0];var c=b[1],d=L(b[2]),e=b[3];Tk(this.a,a?a+\".\"+c:c,Yk(d,e),-1);break;case \"removeArrayItem\":if(3>b.length)break;a=b[0];var c=b[1],g=parseInt(b[2],10);Sk(this.a,a?a+\".\"+c:c,g);break;case \"updateArrayValue\":if(5>b.length)break;a=b[0];c=b[1];d=L(b[2]);e=b[3];g=parseInt(b[4],10);b=d;a=a?a+\".\"+c:c;Sk(this.a,a,g);Tk(this.a,a,Yk(b,e),g);break;case \"addValue\":if(4>b.length)break;c=b[0];g=L(b[1]);a=b[2];e=b[3];Uk(this.a,a?a+\".\"+c:c,Yk(g,e));break;case \"changeInputVariable\":if(2>b.length)break;c=b[0];switch(c){case \"assets\":this.b&&this.b(b[1])}break;case \"removeValue\":2>b.length||(c=b[0],a=b[1],Vk(this.a,a?a+\".\"+c:c))}}};Xk.prototype.pa=function(a,b){z(b,function(b,d){Rk(this.a,a?a+\".\"+d:d,b)},this)};Xk.prototype.updateValue=Xk.prototype.pa;var Zk=function(a,b){dg(P(),\"livePreviewMessage\",[{functionName:a,args:b}])},Yk=function(a,b){return Vj(b).create(a)};m(\"studio.sdk.layouts.RUNTIME_MODE\",{FILLER:\"FILLER\",PLAY:\"PLAY\",TRAFFICK:\"TRAFFICK\",DEVELOPMENT:\"DEVELOPMENT\"},void 0);m(\"studio.sdk.layouts.FILLER_CONTEXT\",{CREATIVE:\"CREATIVE\",MANAGEMENT:\"MANAGEMENT\",NONE:\"NONE\"},void 0);new B;var $k=null;m(\"studio.sdk.layouts.register\",function(a,b){P();lh(w(al,a,b))},void 0);var al=function(a,b){var c=P();J(16)&&($k=new Xk(a,bl));(c=c.ea())||(c=window.GdnLayout?L(GdnLayout.getConfig()):null);c&&Wk(a,c);b&&b(a)};m(\"studio.sdk.layouts.exit\",function(a,b,c){(a=fk(a,\"exit\",b))&&P().exit(a,c)},void 0);m(\"studio.sdk.layouts.exitQueryString\",function(a,b,c){(a=fk(a,\"exit\",b))&&P().gb(a,c)},void 0);m(\"studio.sdk.layouts.counter\",function(a,b,c){(a=fk(a,\"counter\",b))&&P().Ka(a,c)},void 0);m(\"studio.sdk.layouts.startTimer\",function(a,b){var c=fk(a,\"timer\",b);c&&P().startTimer(c)},void 0);m(\"studio.sdk.layouts.stopTimer\",function(a,b){var c=fk(a,\"timer\",b);c&&P().stopTimer(c)},void 0);var bl=function(a){Fg(P(),a)};m(\"studio.sdk.layouts.showFiller\",function(a){$k&&Zk(\"showNode\",[a])},void 0);m(\"studio.sdk.layouts.hideFiller\",function(a){$k&&Zk(\"hideNode\",[a])},void 0);m(\"studio.sdk.layouts.changeFillerValue\",function(a,b){$k&&(Zk(\"changeValue\",[a,b]),$k.pa(a,b,!1))},void 0);m(\"studio.sdk.layouts.showMessage\",function(a){$k&&Zk(\"showMessage\",[a])},void 0);m(\"studio.sdk.layouts.getRuntimeMode\",function(){switch(P().getParameter(\"layoutsRuntime\")){case \"AUTHORING\":return\"FILLER\";case \"TESTING\":return\"PLAY\";default:return P().ea()||window.GdnLayout&&null!=GdnLayout.getConfig()?\"TRAFFICK\":\"DEVELOPMENT\"}},void 0);m(\"studio.sdk.layouts.getFillerContext\",function(){switch(P().getParameter(\"fillerContext\")){case \"CREATIVE_FILLER\":return\"CREATIVE\";case \"MANAGEMENT_FILLER_PREVIEW\":return\"MANAGEMENT\";default:return\"NONE\"}},void 0);");
