function stopAutoPlayVideo(){stopAnim=true;vidObj.dispatchEvent(eventCompleted)}function vpximg2canvas(e){var t=vidObj,n=t.getContext("2d");yuvheight=e.h;yuvwidth=e.w;height=e.d_h;width=e.d_w;t.height=height;t.width=width;var r=n.createImageData(t.width,t.height);var i=r.data;var s,o,u;var a;for(var f=0;f<height;f++){for(var l=0;l<width;l++){Y=e.planes[0][e.planes_off[0]+0+l+yuvwidth*f];U=e.planes[1][e.planes_off[1]+0+(l>>1)+(yuvwidth>>1)*(f>>1)];V=e.planes[2][e.planes_off[2]+0+(l>>1)+(yuvwidth>>1)*(f>>1)];s=Math.round(Y+1.371*(V-128));o=Math.round(Y-.698*(V-128)-.336*(U-128));u=Math.round(Y+1.732*(U-128));i[0+l*4+width*4*f]=s;i[1+l*4+width*4*f]=o;i[2+l*4+width*4*f]=u;i[3+l*4+width*4*f]=255}}n.putImageData(r,0,0)}function createCORSRequest(e,t){var n=new XMLHttpRequest;if("withCredentials"in n){n.open(e,t,true)}else if(typeof XDomainRequest!="undefined"){n=new XDomainRequest;n.open(e,t)}else{n=null}return n}function makeCorsRequest(e,t){var n=t;var r=createCORSRequest("GET",n);if(!r){alert("CORS not supported");return}if(r.overrideMimeType)r.overrideMimeType("text/plain; charset=x-user-defined");else r.setRequestHeader("Accept-Charset","x-user-defined");r.onload=function(){var t=r.responseText;if(typeof r.responseBody=="undefined"){var n=r.responseText.split("").map(function(e){return e.charCodeAt(0)&255});if(e)e(n)}else{var n=convertResponseBodyToText(r.responseBody).split("").map(function(e){return e.charCodeAt(0)&255});if(e)e(n);r.onreadystatechange=null}};r.onerror=function(){Enabler.counter("There was an error with your video request.");stopAutoPlayVideo()};r.send()}function strcmp(e,t){return e==t?0:e>t?1:-1}function fread(e,t,n,r){e.val=new buffer8k;if(r.data.length<n+r.data_off){r.data_off+=n;return 0}for(var i=0;i<n;++i)e.val[i]=r.data[r.data_off++];e.val.length=n;return i}function ftell(e){return e.data_off}function feof(e){if(e.data.length<e.data_off)return 1;return 0}function newObjectIt(e){return typeof e==="undefined"?"error":JSON.parse(JSON.stringify(e))}function memcpy(e,t,n,r,i){var s;for(s=0;s<i;++s)e[t+s]=n[r+s];return e}function memset(e,t,n,r){var i=0;for(i=0;i<r;++i)e[t+i]=n}function malloc(e,t){var n;var r=new Array;for(n=0;n<e;++n)r.push(t);return r}function assert(e){if(!e){throw new Error("assert :P")}}function setjmp(e){return 0}function offsetof(e,t){return t}function Arr(e,t){var n;var r=new Array;for(n=0;n<e;++n)r.push(t);return r}function Arr_new(e,t){var n;var r=new Array;for(n=0;n<e;++n)r.push(new t);return r}function Arr_nOI(e,t){var n;var r=new Array;for(n=0;n<e;++n)r.push(newObjectIt(t));return r}function ArrM(e,t){var n;var r,i=new Array;for(n=e.length-1;n>=0;--n)t=newObjectIt(Arr(e[n],t));return t}function create_obj_vals_from_arrayChilds(e,t){var n;for(n=0;n<t.length;++n)t[n]=create_obj_vals_from_array(new e,t[n]);return t}function create_obj_vals_from_array(e,t){var n=e;var r=0;for(var i in n){if(typeof n[i]=="object"&&Object.keys(n[i]).length==t[r].length){n[i]=create_obj_vals_from_array(n[i],t[r])}else{n[i]=t[r]}r++}return n}function CODEC_INTERFACE(e,t){window[e+"_algo"]=create_obj_vals_from_array(vpx_codec_iface_t,t)}function E_FIELD(e,t,n,r,i){return new Array(e,t,n,i,DESC_FLAG_NONE,null,0,0)}function E_MASTER(e,t,n,r,i,s){return new Array(e,t,n,i,DESC_FLAG_MULTI,s,1,0)}function E_SINGLE_MASTER_O(e,t,n,r,i,s){return new Array(e,t,n,i,DESC_FLAG_OFFSET,s,0,i+"_offset")}function E_SINGLE_MASTER(e,t,n,r,i,s){return new Array(e,t,n,i,DESC_FLAG_NONE,s,0,0)}function E_SUSPEND(e,t,n){return new Array(e,t,n,0,DESC_FLAG_SUSPEND,null,0,0)}function create_ebml_element_desc(e){var t=new Array;for(var n=0;n<e.length;++n){var r=0;var i=new ebml_element_desc;for(var s in i)if(e[n][r]!=="undefined")i[s]=e[n][r++];t.push(i)}return t}function ne_pool_init(e){var t=new pool_ctx;return t}function ne_io_read_skip(e,t){var n=size_t;var r={val:buffer_8192};var i=1;while(t>0){n=t<r.val.length?t:r.val.length;i=ne_io_read(e,r,n);if(i!=1)break;t-=n}return i}function ne_io_tell(e){return e.tell(e.userdata)}function ne_bare_read_vint(e,t,n,r){var i=int_;var s={val:char_};var o=8;var u=1,a=1<<7;i=ne_io_read(e,s,1);if(i!=1)return i;while(u<o){if((s.val[0]&a)!=0)break;a>>=1;u+=1}if(n)n.val=u;t.val=s.val[0];if(r==MASK_FIRST_BIT)t.val=s.val[0]&~a;while(--u){i=ne_io_read(e,s,1);if(i!=1)return i;t.val<<=8;t.val|=s.val[0]}return 1}function ne_io_read(e,t,n){var r=e.read(t,n,e.userdata);return r}function ne_read_id(e,t,n){return ne_bare_read_vint(e,t,n,MASK_NONE)}function ne_read_vint(e,t,n){return ne_bare_read_vint(e,t,n,MASK_FIRST_BIT)}function ne_read_svint(e,t,n){var r=int_;var i=[uint64_t];var s=[uint64_t];var o=new Array(63,8191,1048575,134217727,17179869183,2199023255551,0xffffffffffff,0x80000000000000);var r=ne_bare_read_vint(e,i,s,MASK_FIRST_BIT);if(r!=1)return r;t[0]=i-o[s-1];if(n)n[0]=s;return r}function ne_read_uint(e,t,n){var r={val:char_};var i=int_;if(n==0||n>8)return-1;i=ne_io_read(e,r,1);if(i!=1)return i;t[0]=r.val[0];while(--n){i=ne_io_read(e,r,1);if(i!=1)return i;t[0]<<=8;t[0]|=r.val[0]}return 1}function ne_read_int(e,t,n){var r=int_;var i=[uint64_t],s=uint64_t;r=ne_read_uint(e,i,n);if(r!=1)return r;if(n<8){s=1;s<<=n*8-1;if(i>=s){s=1;s<<=n*8}else{s=0}t[0]=i-s}else{t[0]=i}return 1}function ne_read_float(e,t,n){var r={u:[uint64_t],f:[float_],d:[double_]};var i=int_;if(n!=4&&n!=8)return-1;i=ne_read_uint(e,r.u,n);if(i!=1)return i;if(n==4)t[0]=r.f=r.u;else t[0]=r.d=r.u;return 1}function ne_read_string(e,t,n){var r={val:char_};var i=int_;if(n==0||n>LIMIT_STRING)return-1;i=ne_io_read(e.io,r,n);if(i!=1)return i;var s="";for(var o=0;o<n;++o)s+=String.fromCharCode(r.val[o]);r.val=s;t[0]=r.val;return 1}function ne_read_binary(e,t,n){if(n==0||n>LIMIT_BINARY)return-1;t.data={val:0};t.length=n;return ne_io_read(e.io,t.data,n)}function ne_get_uint(e,t){if(!e.read)return-1;assert(e.type==TYPE_UINT);t[0]=e.v.u;return 0}function ne_get_string(e,t){if(!e.read)return-1;assert(e.type==TYPE_STRING);t[0]=e.v.s;return 0}function ne_is_ancestor_element(e,t){for(;t;t=t.previous)for(var n=t.node,r=0;n[r].id;++r)if(n[r].id==e)return 1;return 0}function ne_find_element(e,t){for(var n=t,r=0;n[r].id;++r)if(n[r].id==e)return n[r];return null}function ne_ctx_push(e,t,n){var r=new list_node;r.previous=e.ancestor;r.node=t;r.data=n;e.ancestor=r}function ne_ctx_pop(e){var t;t=e.ancestor;e.ancestor=t.previous;t=""}function ne_peek_element(e,t,n){var r=int_;if(e.last_id&&e.last_size){if(t)t[0]=e.last_id;if(n)n[0]=e.last_size;return 1}e.last_id={val:e.last_id};r=ne_read_id(e.io,e.last_id,null);e.last_id=e.last_id.val;if(r!=1)return r;e.last_size={val:e.last_size};r=ne_read_vint(e.io,e.last_size,null);e.last_size=e.last_size.val;if(r!=1)return r;if(t)t[0]=e.last_id;if(n)n[0]=e.last_size;return 1}function ne_read_element(e,t,n){var r=int_;r=ne_peek_element(e,t,n);if(r!=1)return r;e.last_id=0;e.last_size=0;return 1}function ne_read_master(e,t){var n;var r=new ebml_list_node,i;assert(t.type==TYPE_MASTER&&t.flags&DESC_FLAG_MULTI);if(!!e.ancestor.data[t.offset])n=e.ancestor.data[t.offset];r.id=t.id;r.data=new window[t.offset];i=n.tail;if(i)i.next=r;n.tail=r;if(!n.head)n.head=r;ne_ctx_push(e,t.children,r.data)}function ne_read_single_master(e,t){assert(t.type==TYPE_MASTER&&!(t.flags&DESC_FLAG_MULTI));ne_ctx_push(e,t.children,e.ancestor.data[t.offset])}function ne_read_simple(e,t,n){var r;var i=int_;if(!!e.ancestor.data[t.offset])r=e.ancestor.data[t.offset];if(r.read){return 0}r.type=t.type;i=-1;switch(t.type){case TYPE_UINT:r.v.u=[r.v.u];i=ne_read_uint(e.io,r.v.u,n);r.v.u=r.v.u[0];break;case TYPE_FLOAT:r.v.f=[r.v.f];i=ne_read_float(e.io,r.v.f,n);r.v.f=r.v.f[0];break;case TYPE_INT:r.v.i=[r.v.i];i=ne_read_int(e.io,r.v.i,n);r.v.i=r.v.i[0];break;case TYPE_STRING:r.v.s=[r.v.s];i=ne_read_string(e,r.v.s,n);r.v.s=r.v.s[0];break;case TYPE_BINARY:i=ne_read_binary(e,r.v.b,n);break;case TYPE_MASTER:case TYPE_UNKNOWN:assert(0);break}if(i==1)r.read=1;return i}function ne_parse(e,t){var n=int_;var r=int64_t;var i=[uint64_t],s=[uint64_t];var o;if(!e.ancestor)return-1;while(1){n=ne_peek_element(e,i,s);if(n!=1)break;o=ne_find_element(i[0],e.ancestor.node);if(o){if(o.flags&DESC_FLAG_SUSPEND){assert(o.type==TYPE_BINARY);n=1;break}n=ne_read_element(e,i,s);if(n!=1)break;if(o.flags&DESC_FLAG_OFFSET){r=e.ancestor.data[o.data_offset]={v:null};r.v=ne_io_tell(e.io);if(r<0){n=-1;break}}if(o.type==TYPE_MASTER){if(o.flags&DESC_FLAG_MULTI)ne_read_master(e,o);else ne_read_single_master(e,o);continue}else{n=ne_read_simple(e,o,s[0]);if(n<0)break}}else if(ne_is_ancestor_element(i,e.ancestor.previous)){if(t&&e.ancestor.node==t){n=1;break}ne_ctx_pop(e)}else{n=ne_read_element(e,i,s);if(n!=1)break;n=ne_io_read_skip(e.io,s[0]);if(n!=1)break}}if(n!=1)while(e.ancestor)ne_ctx_pop(e);return n}function ne_read_xiph_lace_value(e,t,n,r){var i=int_;var s=[uint64_t];i=ne_read_uint(e,s,1);if(i!=1)return i;r[0]+=1;t[n+0]=s[0];while(s[0]==255){i=ne_read_uint(e,s,1);if(i!=1)return i;r[0]+=1;t[n+0]+=s[0]}return 1}function ne_read_xiph_lacing(e,t,n,r,i){var s=int_;var o=0;var u=0;while(--r){s=ne_read_xiph_lace_value(e,i,o,n);if(s!=1)return s;u+=i[o];o+=1}if(n[0]+u>t)return-1;i[o]=t-n[0]-u;return 1}function ne_read_ebml_lacing(e,t,n,r,i){var s=int_;var o=[uint64_t],u=uint64_t,a=[uint64_t];var f=[int64_t];var l=0;s=ne_read_vint(e,o,a);if(s!=1)return s;n[0]+=a[0];i[l]=o[0];u=i[l];l+=1;r-=1;while(--r){s=ne_read_svint(e,f,a);if(s!=1)return s;n[0]+=a[0];i[l]=i[l-1]+f[0];u+=i[l];l+=1}if(n[0]+u>t)return-1;i[l]=t-n[0]-u;return 1}function ne_get_timecode_scale(e){var t=[uint64_t];if(ne_get_uint(e.segment.info.timecode_scale,t)!=0)t[0]=1e6;return t[0]}function ne_find_track_entry(e,t){var n=0;var r=e.segment.tracks.track_entry.head;while(r){assert(r.id==ID_TRACK_ENTRY);if(t==n)return r.data;n+=1;r=r.next}return null}function ne_read_block(e,t,n,r){var i=int_;var s=[int64_t],o=int64_t;var u;var a;var f,l;var c;var h=double_;var p={val:uint64_t},d={val:uint64_t},v=frame_sizes_256,m=[uint64_t],g=[uint64_t],y=[uint64_t],b=uint64_t,w=uint64_t;var E=int_,S=int_;var x=[0];r[0]=null;if(n>LIMIT_BLOCK)return-1;i=ne_read_vint(e.io,p,d);if(i!=1)return i;if(p.val==0||p.val>e.track_count)return-1;x[0]+=d.val;i=ne_read_int(e.io,s,2);if(i!=1)return i;x[0]+=2;i=ne_read_uint(e.io,g,1);if(i!=1)return i;x[0]+=1;y[0]=0;S=(g[0]&BLOCK_FLAGS_LACING)>>1;switch(S){case LACING_NONE:y[0]=1;break;case LACING_XIPH:case LACING_FIXED:case LACING_EBML:i=ne_read_uint(e.io,y,1);if(i!=1)return i;x[0]+=1;y[0]+=1}if(y[0]>256)return-1;switch(S){case LACING_NONE:v[0]=n-x[0];break;case LACING_XIPH:if(y==1)return-1;i=ne_read_xiph_lacing(e.io,n,x,y,v);if(i!=1)return i;break;case LACING_FIXED:if((n-x[0])%y[0])return-1;for(E=0;E<y[0];++E)v[E]=(n-x[0])/y>>0;break;case LACING_EBML:if(y[0]==1)return-1;i=ne_read_ebml_lacing(e.io,n,x,y,v);if(i!=1)return i;break}w=x[0];for(E=0;E<y[0];++E)w+=v[E];if(w>n)return-1;c=ne_find_track_entry(e,p.val-1);if(!c)return-1;h=1;b=ne_get_timecode_scale(e);assert(e.segment.cluster.tail.id==ID_CLUSTER);a=e.segment.cluster.tail.data;if(ne_get_uint(a.timecode,m)!=0)return-1;o=s[0]+m[0];if(o<0)return-1;u=new nestegg_packet;u.track=p.val-1;u.timecode=o*b*h;l=null;for(E=0;E<y[0];++E){if(v[E]>LIMIT_FRAME){nestegg_free_packet(u);return-1}f=new frame;f.data=[];f.length=v[E];f.data={val:f.data};i=ne_io_read(e.io,f.data,v[E]);f.data=f.data.val;if(i!=1){f.data=null;f=null;nestegg_free_packet(u);return-1}if(!l)u.frame=f;else l.next=f;l=f}r[0]=u;return 1}function ne_null_log_callback(e,t,n,r){if(e&&t&&n)return}function ne_is_suspend_element(e){if(e==ID_SIMPLE_BLOCK||e==ID_BLOCK)return 1;return 0}function nestegg_init(e,t,n){var r=int_;var i=[0],s=[0],o=[uint64_t];var u;var a=[char_];var f=ctx_;if(!(t.read&&t.seek&&t.tell))return-1;f.io=t;f.alloc_pool=ne_pool_init();r=ne_peek_element(f,i,null);if(r!=1){nestegg_destroy(f);return-1}if(i[0]!=ID_EBML){nestegg_destroy(f);return-1}ne_ctx_push(f,ne_top_level_elements,f);r=ne_parse(f,null);if(r!=1){nestegg_destroy(f);return-1}if(ne_get_uint(f.ebml.ebml_read_version,s)!=0)s=1;if(s[0]!=1){nestegg_destroy(f);return-1}if(ne_get_string(f.ebml.doctype,a)!=0)a[0]="matroska";if(strcmp(a[0],"webm")!=0){nestegg_destroy(f);return-1}if(ne_get_uint(f.ebml.doctype_read_version,o)!=0)o[0]=1;if(o[0]<1||o[0]>2){nestegg_destroy(f);return-1}if(!f.segment.tracks.track_entry.head){nestegg_destroy(f);return-1}u=f.segment.tracks.track_entry.head;f.track_count=0;while(u){f.track_count+=1;u=u.next}e[0]=f;return 0}function nestegg_destroy(e){}function nestegg_track_count(e,t){t[0]=e.track_count;return 0}function nestegg_track_type(e,t){var n=[uint64_t];var r=ne_find_track_entry(e,t);if(!r)return-1;if(ne_get_uint(r.type,n)!=0)return-1;if(n[0]&TRACK_TYPE_VIDEO)return NESTEGG_TRACK_VIDEO;if(n[0]&TRACK_TYPE_AUDIO)return NESTEGG_TRACK_AUDIO;return-1}function nestegg_track_codec_id(e,t){var n=[char_];var r=ne_find_track_entry(e,t);if(!r)return-1;if(ne_get_string(r.codec_id,n)!=0)return-1;if(strcmp(n[0],TRACK_ID_VP8)==0)return NESTEGG_CODEC_VP8;if(strcmp(n[0],TRACK_ID_VORBIS)==0)return NESTEGG_CODEC_VORBIS;return-1}function nestegg_track_video_params(e,t,n){var r=[uint64_t];var i=ne_find_track_entry(e,t);if(!i)return-1;if(nestegg_track_type(e,t)!=NESTEGG_TRACK_VIDEO)return-1;if(ne_get_uint(i.video.pixel_width,r)!=0)return-1;n.width=r[0];if(ne_get_uint(i.video.pixel_height,r)!=0)return-1;n.height=r[0];r[0]=0;ne_get_uint(i.video.pixel_crop_bottom,r);n.crop_bottom=r[0];r[0]=0;ne_get_uint(i.video.pixel_crop_top,r);n.crop_top=r[0];r[0]=0;ne_get_uint(i.video.pixel_crop_left,r);n.crop_left=r[0];r[0]=0;ne_get_uint(i.video.pixel_crop_right,r);n.crop_right=r[0];r[0]=n.width;ne_get_uint(i.video.display_width,r);n.display_width=r[0];r[0]=n.height;ne_get_uint(i.video.display_height,r);n.display_height=r[0];return 0}function nestegg_read_packet(e,t){var n=int_;var r=[uint64_t],i=[uint64_t];t[0]=null;while(1){n=ne_peek_element(e,r,i);if(n!=1)return n;if(ne_is_suspend_element(r)){n=ne_read_element(e,r,i);if(n!=1)return n;n=ne_read_block(e,r,i[0],t);return n}n=ne_parse(e,null);if(n!=1)return n}return 1}function nestegg_free_packet(e){var t;while(e.frame){t=e.frame;e.frame=t.next;t.data="";t=""}e=""}function nestegg_packet_track(e,t){t[0]=e[0].track;return 0}function nestegg_packet_count(e,t){var n=e[0].frame;t[0]=0;while(n){t[0]+=1;n=n.next}return 0}function nestegg_packet_data(e,t,n,r){var i=e[0].frame;var s=0;n[0]=null;r[0]=0;while(i){if(s==t){n[0]=i.data;r[0]=i.length;return 0}s+=1;i=i.next}return-1}function img_alloc_helper(e,t,n,r,i,s){var o=int_,u=int_,a=int_,f=int_,l=int_,c=int_;var h=int_;if(!i)i=1;if(i&i-1)alert("goto fail");switch(t){case VPX_IMG_FMT_RGB32:case VPX_IMG_FMT_RGB32_LE:case VPX_IMG_FMT_ARGB:case VPX_IMG_FMT_ARGB_LE:c=32;break;case VPX_IMG_FMT_RGB24:case VPX_IMG_FMT_BGR24:c=24;break;case VPX_IMG_FMT_RGB565:case VPX_IMG_FMT_RGB565_LE:case VPX_IMG_FMT_RGB555:case VPX_IMG_FMT_RGB555_LE:case VPX_IMG_FMT_UYVY:case VPX_IMG_FMT_YUY2:case VPX_IMG_FMT_YVYU:c=16;break;case VPX_IMG_FMT_I420:case VPX_IMG_FMT_YV12:case VPX_IMG_FMT_VPXI420:case VPX_IMG_FMT_VPXYV12:c=12;break;default:c=16;break}switch(t){case VPX_IMG_FMT_I420:case VPX_IMG_FMT_YV12:case VPX_IMG_FMT_VPXI420:case VPX_IMG_FMT_VPXYV12:f=1;break;default:f=0;break}switch(t){case VPX_IMG_FMT_I420:case VPX_IMG_FMT_YV12:case VPX_IMG_FMT_VPXI420:case VPX_IMG_FMT_VPXYV12:l=1;break;default:l=0;break}h=(1<<f)-1;u=n+h&~h;h=(1<<l)-1;o=r+h&~h;a=t&VPX_IMG_FMT_PLANAR?u:c*u/8;a=a+i-1&~(i-1);if(!e){e=new vpx_image_t;if(!e)alert("goto fail");e.self_allocd=1}else{}e.img_data=s;if(!s){e.img_data=malloc(t&VPX_IMG_FMT_PLANAR?o*u*c/8:o*a,0);e.img_data_owner=1}if(!e.img_data)alert("goto fail");e.fmt=e["fmt"]=t;e.w=e["w"]=u;e.h=e["h"]=o;e.x_chroma_shift=e["x_chroma_shift"]=f;e.y_chroma_shift=e["y_chroma_shift"]=l;e.bps=e["bps"]=c;e.stride[VPX_PLANE_Y]=e.stride[VPX_PLANE_ALPHA]=a;e.stride[VPX_PLANE_U]=e.stride[VPX_PLANE_V]=a>>f;if(!vpx_img_set_rect(e,0,0,n,r))return e;vpx_img_free(e);return null}function vpx_img_alloc(e,t,n,r,i){return img_alloc_helper(e,t,n,r,i,null)}function vpx_img_set_rect(e,t,n,r,i){var s=char_;var o=0;if(t+r<=e.w&&n+i<=e.h){e.d_w=e["d_w"]=r;e.d_h=e["d_h"]=i;if(!(e.fmt&VPX_IMG_FMT_PLANAR)){e.planes[VPX_PLANE_PACKED]=e.img_data;e.img_data_of+parseInt(t*e.bps/8+n*e.stride[VPX_PLANE_PACKED],10)}else{s=e.img_data;o=e.img_data_off;if(e.fmt&VPX_IMG_FMT_HAS_ALPHA){e.planes[VPX_PLANE_ALPHA]=s;e.planes_off[VPX_PLANE_ALPHA]=o+t+n*e.stride[VPX_PLANE_ALPHA];o+=e.h*e.stride[VPX_PLANE_ALPHA]}e.planes[VPX_PLANE_Y]=s;e.planes_off[VPX_PLANE_Y]=o+t+n*e.stride[VPX_PLANE_Y];o+=e.h*e.stride[VPX_PLANE_Y];if(!(e.fmt&VPX_IMG_FMT_UV_FLIP)){e.planes[VPX_PLANE_U]=s;e.planes_off[VPX_PLANE_U]=o+(t>>e.x_chroma_shift)+(n>>e.y_chroma_shift)*e.stride[VPX_PLANE_U];o+=(e.h>>e.y_chroma_shift)*e.stride[VPX_PLANE_U];e.planes[VPX_PLANE_V]=s;e.planes_off[VPX_PLANE_V]=o+(t>>e.x_chroma_shift)+(n>>e.y_chroma_shift)*e.stride[VPX_PLANE_V]}else{e.planes[VPX_PLANE_V]=s;e.planes_off[VPX_PLANE_V]=o+(t>>e.x_chroma_shift)+(n>>e.y_chroma_shift)*e.stride[VPX_PLANE_V];o+=(e.h>>e.y_chroma_shift)*e.stride[VPX_PLANE_V];e.planes[VPX_PLANE_U]=s;e.planes_off[VPX_PLANE_U]=o+(t>>e.x_chroma_shift)+(n>>e.y_chroma_shift)*e.stride[VPX_PLANE_U]}}return 0}return-1}function vpx_img_free(e){if(e){if(e.img_data&&e.img_data_owner)e.img_data="";if(e.self_allocd)e=""}}function init_bool_decoder(e,t,n,r){if(r>=2){e.value=t[n+0]<<8|t[n+1];e.input=t;e.input_off=n+2;e.input_len=r-2}else{e.value=0;e.input=null;e.input_len=0}e.range=255;e.bit_count=0}function bool_get(e,t){var n=1+((e.range-1)*t>>8);var r=n<<8;var i=int_;if(e.value>=r){i=1;e.range-=n;e.value-=r}else{i=0;e.range=n}while(e.range<128){e.value<<=1;e.range<<=1;if(++e.bit_count==8){e.bit_count=0;if(e.input_len){e.value|=e.input[e.input_off++];e.input_len--}}}return i}function bool_get_bit(e){return bool_get(e,128)}function bool_get_uint(e,t){var n=0;var r=int_;for(r=t-1;r>=0;r--){n|=bool_get_bit(e)<<r}return n}function bool_get_int(e,t){var n=0;var r=int_;for(r=t-1;r>=0;r--){n|=bool_get_bit(e)<<r}return bool_get_bit(e)?-n:n}function bool_maybe_get_int(e,t){return bool_get_bit(e)?bool_get_int(e,t):0}function bool_read_tree(e,t,n,r){var i=0;if(typeof r!=="undefined")while((i=t[i+bool_get(e,n[r+(i>>1)])])>0);else while((i=t[i+bool_get(e,n[i>>1])])>0);return-i}function BITS_MASK(e){return(1<<e)-1}function BITS_GET(e,t,n){return e>>t&BITS_MASK(n)}function CLAMP_255(e){return e<0?0:e>255?255:e}function vp8_dixie_walsh(e,t,n,r){var i=int_;var s=int_,o=int_,u=int_,a=int_;var f=int_,l=int_,c=int_,h=int_;var p=e;var d=t;var v=n;var m=r;for(i=0;i<4;i++){s=p[d+0]+p[d+12];o=p[d+4]+p[d+8];u=p[d+4]-p[d+8];a=p[d+0]-p[d+12];v[m+0]=s+o;v[m+4]=u+a;v[m+8]=s-o;v[m+12]=a-u;d++;m++}p=n;d=r;v=n;m=r;for(i=0;i<4;i++){s=p[d+0]+p[d+3];o=p[d+1]+p[d+2];u=p[d+1]-p[d+2];a=p[d+0]-p[d+3];f=s+o;l=u+a;c=s-o;h=a-u;v[m+0]=f+3>>3;v[m+1]=l+3>>3;v[m+2]=c+3>>3;v[m+3]=h+3>>3;d+=4;m+=4}}function idct_columns(e,t,n,r){var i=int_;var s=int_,o=int_,u=int_,a=int_;var f=e;var l=t;var c=n;var h=r;var p=int_,d=int_;var v=4;for(i=0;i<4;i++){s=f[l+0]+f[l+8];o=f[l+0]-f[l+8];p=f[l+4]*sinpi8sqrt2>>16;d=f[l+12]+(f[l+12]*cospi8sqrt2minus1>>16);u=p-d;p=f[l+4]+(f[l+4]*cospi8sqrt2minus1>>16);d=f[l+12]*sinpi8sqrt2>>16;a=p+d;c[h+v*0]=s+a;c[h+v*3]=s-a;c[h+v*1]=o+u;c[h+v*2]=o-u;l++;h++}}function vp8_dixie_idct_add(e,t,n,r,i,s,o){var u=int_;var a=int_,f=int_,l=int_,c=int_,h=int_,p=int_;var d=0;idct_columns(s,o,tmp_2,d);s=tmp_2;o=d;for(u=0;u<4;u++){a=s[o+0]+s[o+2];f=s[o+0]-s[o+2];h=s[o+1]*sinpi8sqrt2>>16;p=s[o+3]+(s[o+3]*cospi8sqrt2minus1>>16);l=h-p;h=s[o+1]+(s[o+1]*cospi8sqrt2minus1>>16);p=s[o+3]*sinpi8sqrt2>>16;c=h+p;e[t+0]=n[r+0]+(a+c+4>>3);e[t+3]=n[r+3]+(a-c+4>>3);e[t+1]=n[r+1]+(f+l+4>>3);e[t+2]=n[r+2]+(f-l+4>>3);o+=4;t+=i;r+=i}}function clamp_mv(e,t){var n=new mv;n.d.x=e.d.x<t.to_left?t.to_left:e.d.x;n.d.x=e.d.x>t.to_right?t.to_right:n.d.x;n.d.y=e.d.y<t.to_top?t.to_top:e.d.y;n.d.y=e.d.y>t.to_bottom?t.to_bottom:n.d.y;return n}function read_segment_id(e,t){return bool_get(e,t.tree_probs[0])?2+bool_get(e,t.tree_probs[2]):bool_get(e,t.tree_probs[1])}function above_block_mode(e,t,n){if(n<4){switch(t.base.y_mode){case DC_PRED:return B_DC_PRED;case V_PRED:return B_VE_PRED;case H_PRED:return B_HE_PRED;case TM_PRED:return B_TM_PRED;case B_PRED:return t.splitt.mvs[n+12].d.x;default:assert(0)}}return e.splitt.mvs[n-4].d.x}function left_block_mode(e,t,n){if(!(n&3)){switch(t.base.y_mode){case DC_PRED:return B_DC_PRED;case V_PRED:return B_VE_PRED;case H_PRED:return B_HE_PRED;case TM_PRED:return B_TM_PRED;case B_PRED:return t.splitt.mvs[n+3].d.x;default:assert(0)}}return e.splitt.mvs[n-1].d.x}function decode_kf_mb_mode(e,t,n,r,i,s,o){var u=int_,a=int_;u=bool_read_tree(o,kf_y_mode_tree,kf_y_mode_probs);if(u==B_PRED){var f=int_;for(f=0;f<16;f++){var l=above_block_mode(e[t],i[s],f);var c=left_block_mode(e[t],n[r],f);var h=0;h=bool_read_tree(o,b_mode_tree,kf_b_mode_probs[l][c]);e[t].splitt.modes[f]=e[t].splitt.mvs[f].d.x=h;e[t].splitt.mvs[f].d.y=0}}a=bool_read_tree(o,uv_mode_tree,kf_uv_mode_probs);e[t].base.y_mode=u;e[t].base.uv_mode=a;e[t].base.mv.d.x=e[t].base.mv.d.y=0;e[t].base.ref_frame=0}function decode_intra_mb_mode(e,t,n){var r=int_,i=int_;r=bool_read_tree(n,y_mode_tree,t.y_mode_probs);if(r==B_PRED){var s=int_;for(s=0;s<16;s++){var o;o=bool_read_tree(n,b_mode_tree,default_b_mode_probs);e.splitt.modes[s]=e.splitt.mvs[s].d.x=o;e.splitt.mvs[s].d.y=0}}i=bool_read_tree(n,uv_mode_tree,t.uv_mode_probs);e.base.y_mode=r;e.base.uv_mode=i;e.base.mv.d.x=e.base.mv.d.y=0;e.base.ref_frame=CURRENT_FRAME}function read_mv_component(e,t){var n=0,r=1,i=2,s=i+8-1,o=10;var u=0;if(bool_get(e,t[n])){var a=0;for(a=0;a<3;a++)u+=bool_get(e,t[s+a])<<a;for(a=o-1;a>3;a--)u+=bool_get(e,t[s+a])<<a;if(!(u&65520)||bool_get(e,t[s+3]))u+=8}else u=bool_read_tree(e,small_mv_tree,t,+i);if(u&&bool_get(e,t[r]))u=-u;return u<<1}function above_block_mv(e,t,n){if(n<4){if(t.base.y_mode==SPLITMV)return t.splitt.mvs[n+12];return t.base.mv}return e.splitt.mvs[n-4]}function left_block_mv(e,t,n){if(!(n&3)){if(t.base.y_mode==SPLITMV)return t.splitt.mvs[n+3];return t.base.mv}return e.splitt.mvs[n-1]}function submv_ref(e,t,n){var r=0,i=1,s=2,o=3,u=4;var a=!(t.d.x||t.d.y)+0;var f=!(n.d.x||n.d.y)+0;var l=(t.d.x==n.d.x&&t.d.y==n.d.y)+0;var c=r;if(l&&a)c=u;else if(l)c=o;else if(f)c=s;else if(a)c=i;return bool_read_tree(e,submv_ref_tree,submv_ref_probs2[c])}function read_mv(e,t,n){t.d.y=read_mv_component(e,n[0]);t.d.x=read_mv_component(e,n[1])}function mv_bias(e,t,n,r){if(t[e.base.ref_frame]^t[n]){r.d.x*=-1;r.d.y*=-1}}function find_near_mvs(e,t,n,r,i,s,o,u){var a=r;var f=i-1;var l=o;var c=0;var h=u;var p=0;l[0].d.x=l[1].d.x=l[2].d.x=0;l[0].d.y=l[1].d.y=l[2].d.y=0;u[0]=u[1]=u[2]=u[3]=0;var d=r[i];var v=t[n];var m=a[f];if(d.base.ref_frame!=CURRENT_FRAME){if(d.base.mv.d.x||d.base.mv.d.y){l[++c].d.x=d.base.mv.d.x;l[c].d.y=d.base.mv.d.y;mv_bias(d,s,e.base.ref_frame,l[c]);++p}h[p]+=2}if(v.base.ref_frame!=CURRENT_FRAME){if(v.base.mv.d.x||v.base.mv.d.y){var g=this_mv_1;g.d.x=v.base.mv.d.x;g.d.y=v.base.mv.d.y;mv_bias(v,s,e.base.ref_frame,g);if(g.d.x!=l[c].d.x||g.d.y!=l[c].d.y){l[++c].d.x=g.d.x;l[c].d.y=g.d.y;++p}h[p]+=2}else u[CNT_ZEROZERO]+=2}if(m.base.ref_frame!=CURRENT_FRAME){if(m.base.mv.d.x||m.base.mv.d.y){var g=this_mv_2;g.d.x=m.base.mv.d.x;g.d.y=m.base.mv.d.y;mv_bias(m,s,e.base.ref_frame,g);if(g.d.x!=l[c].d.x||g.d.y!=l[c].d.y){l[++c].d.x=g.d.x;l[c].d.y=g.d.y;++p}h[p]+=1}else u[CNT_ZEROZERO]+=1}if(u[CNT_SPLITMV]){if(l[c].d.x==o[CNT_NEAREST].d.x&&l[c].d.y==o[CNT_NEAREST].d.y)u[CNT_NEAREST]+=1}u[CNT_SPLITMV]=((d.base.y_mode==SPLITMV)+(v.base.y_mode==SPLITMV))*2+(m.base.y_mode==SPLITMV);if(u[CNT_NEAR]>u[CNT_NEAREST]){var y=int_;var b=int_;y=u[CNT_NEAREST];u[CNT_NEAREST]=u[CNT_NEAR];u[CNT_NEAR]=y;y=o[CNT_NEAREST].d.x;b=o[CNT_NEAREST].d.y;o[CNT_NEAREST].d.x=o[CNT_NEAR].d.x;o[CNT_NEAREST].d.y=o[CNT_NEAR].d.y;o[CNT_NEAR].d.x=y;o[CNT_NEAR].d.y=b}if(u[CNT_NEAREST]>=u[CNT_BEST]){o[CNT_BEST].d.x=o[CNT_NEAREST].d.x;o[CNT_BEST].d.y=o[CNT_NEAREST].d.y}}function decode_split_mv(e,t,n,r,i,s){var o=int_;var u=int_,a=int_,f=int_,l=int_;l=bool_read_tree(s,split_mv_tree,split_mv_probs);o=mv_partitions[l];e.base.partitioning=l;for(u=0,f=0;f<65535;u++){var c=new mv,h,p;var d;for(a=0;u!=o[a];a++);h=left_block_mv(e,t,a);p=above_block_mv(e,n,a);d=submv_ref(s,h,p);switch(d){case LEFT4X4:c=h;break;case ABOVE4X4:c=p;break;case ZERO4X4:c.d.x=c.d.y=0;break;case NEW4X4:read_mv(s,c,r.mv_probs);c.d.x+=i.d.x;c.d.y+=i.d.y;break;default:assert(0)}for(;a<16;a++)if(u==o[a]){e.splitt.mvs[a].d.x=c.d.x;e.splitt.mvs[a].d.y=c.d.y;f|=1<<a}}}function need_mc_border(e,t,n,r,i,s){var o=int_,u=int_;t+=e.d.x>>3;n+=e.d.y>>3;u=i-(t+r);o=s-(n+r);return t>>1<2||u>>1<3||n>>1<2||o>>1<3}function decode_mvs(e,t,n,r,i,s,o,u,a){var f=e.entropy_hdr;var l=near_mvs_4;var c=clamped_best_mv_1;var h=mv_cnts_4;var p=probs_4;var d=0,v=1,m=2;var g=int_,y=int_,b=int_,w=int_,E=int_;t[n].base.ref_frame=bool_get(a,f.prob_last)?2+bool_get(a,f.prob_gf):1;find_near_mvs(t[n],t,n-1,s,o,e.reference_hdr.sign_bias,l,h);p[0]=mv_counts_to_probs[h[0]][0];p[1]=mv_counts_to_probs[h[1]][1];p[2]=mv_counts_to_probs[h[2]][2];p[3]=mv_counts_to_probs[h[3]][3];t=t[n];t.base.y_mode=bool_read_tree(a,mv_ref_tree,p);t.base.uv_mode=t.base.y_mode;t.base.need_mc_border=0;g=-u.to_left-128>>3;y=-u.to_top-128>>3;b=e.mb_cols*16;w=e.mb_rows*16;switch(t.base.y_mode){case NEARESTMV:t.base.mv=clamp_mv(l[v],u);break;case NEARMV:t.base.mv=clamp_mv(l[m],u);break;case ZEROMV:t.base.mv.d.x=t.base.mv.d.y=0;return;case NEWMV:c=clamp_mv(l[d],u);read_mv(a,t.base.mv,f.mv_probs);t.base.mv.d.x+=c.d.x;t.base.mv.d.y+=c.d.y;break;case SPLITMV:{var S=chroma_mv_4;c=clamp_mv(l[d],u);decode_split_mv(t,r[i],s[o],f,c,a);t.base.mv.d.x=t.splitt.mvs[15].d.x;t.base.mv.d.y=t.splitt.mvs[15].d.y;for(E=0;E<16;E++){S[(E>>1&1)+(E>>2&2)].d.x+=t.splitt.mvs[E].d.x;S[(E>>1&1)+(E>>2&2)].d.y+=t.splitt.mvs[E].d.y;if(need_mc_border(t.splitt.mvs[E],g+(E&3)*4,y+(E&~3),4,b,w)){t.base.need_mc_border=1;break}}for(E=0;E<4;E++){S[E].d.x+=4;S[E].d.y+=4;S[E].d.x>>=2;S[E].d.y>>=2;if(need_mc_border(S[E],g+(E&1)*8,y+(E>>1)*8,16,b,w)){t.base.need_mc_border=1;break}}return};default:assert(0)}if(need_mc_border(t.base.mv,g,y,16,b,w))t.base.need_mc_border=1}function vp8_dixie_modemv_process_row(e,t,n,r,i){var s,o=0,u,a=0;var f=int_;var l=bounds_;u=e.mb_info_rows[1+n];a=e.mb_info_rows_off[1+n]+r;s=e.mb_info_rows[1+n-1];o=e.mb_info_rows_off[1+n-1]+r;l.to_left=-(r+1<<7);l.to_right=e.mb_cols-r<<7;l.to_top=-(n+1<<7);l.to_bottom=e.mb_rows-n<<7;for(f=r;f<r+i;f++){if(e.segment_hdr.update_map)u[a].base.segment_id=read_segment_id(t,e.segment_hdr);if(e.entropy_hdr.coeff_skip_enabled)u[a].base.skip_coeff=bool_get(t,e.entropy_hdr.coeff_skip_prob);if(e.frame_hdr.is_keyframe){if(!e.segment_hdr.update_map)u[a].base.segment_id=0;decode_kf_mb_mode(u,a,u,a-1,s,o,t)}else{if(bool_get(t,e.entropy_hdr.prob_inter))decode_mvs(e,u,a,u,a-1,s,o,l,t);else decode_intra_mb_mode(u[a],e.entropy_hdr,t);l.to_left-=16<<3;l.to_right-=16<<3}a++;o++}}function vp8_dixie_modemv_init(e){var t=int_,n=int_,r=int_;var i=new mb_info;var s=0;t=e.mb_cols+1;n=e.mb_rows+1;if(e.frame_hdr.frame_size_updated){e.mb_info_storage=null;e.mb_info_rows_storage=null}if(!e.mb_info_storage){e.mb_info_storage=Arr_new(t*n,e.mb_info_storage_object);e.mb_info_storage_off=0}if(!e.mb_info_rows_storage){e.mb_info_rows_storage=Arr_new(n,e.mb_info_rows_storage_object);e.mb_info_rows_storage_off=new Array(n)}i=e.mb_info_storage;s=e.mb_info_storage_off+1;for(r=0;r<n;r++){e.mb_info_rows_storage[r]=i;e.mb_info_rows_storage_off[r]=s;s+=t}e.mb_info_rows=e.mb_info_rows_storage;e.mb_info_rows_off=e.mb_info_rows_storage_off}function X(e){return e*PREV_COEF_CONTEXTS*ENTROPY_NODES}function decode_mb_tokens(e,t,n,r,i,s,o,u){function a(t){y=(bool_get_bit(e)?-t:t)*L[!!m+0]}function f(t,n){if(!bool_get(e,t)){A=n;return 1}}function l(t,n){if(!bool_get(e,t)){k=N;if(m<15){++m;k+=bands_x[m];A=n;return 1}else{A=BLOCK_FINISHED;return 1}}}function c(e){a(e);k=N+ENTROPY_NODES*2;if(m<15){S[x+zigzag[m]]=y;++m;A=DO_WHILE;return 1}S[x+zigzag[15]]=y;A=BLOCK_FINISHED;return 1}function h(t,n){b+=bool_get(e,extrabits[t].probs[n])<<n}var p=int_,d=int_,v=int_;var m=int_,g=int_,y=int_;var b=int_,w=int_;var E=int_;var S=short_;var x=0;var T=char_;var N=0;var C=char_;var k=0;var L=short_;E=0;if(s!=B_PRED&&s!=SPLITMV){p=24;d=24;v=1;S=r;x=i+24*16;L=u[TOKEN_BLOCK_Y2]}else{p=0;d=16;v=3;S=r;x=i;L=u[TOKEN_BLOCK_Y1]}T=o;N=v*COEF_BANDS*PREV_COEF_CONTEXTS*ENTROPY_NODES;var A=BLOCK_LOOP;do{if(A==BLOCK_LOOP){g=t[left_context_index[p]]+n[above_context_index[p]];m=!v+0;C=T;k=N;k+=g*ENTROPY_NODES;A=DO_WHILE}if(A==DO_WHILE){k+=bands_x[m];if(f(C[k+EOB_CONTEXT_NODE],BLOCK_FINISHED))continue;A=CHECK_0_}if(A==CHECK_0_){if(l(C[k+ZERO_CONTEXT_NODE],CHECK_0_))continue;if(f(C[k+ONE_CONTEXT_NODE],ONE_CONTEXT_NODE_0_))continue;if(f(C[k+LOW_VAL_CONTEXT_NODE],LOW_VAL_CONTEXT_NODE_0_))continue;if(f(C[k+HIGH_LOW_CONTEXT_NODE],HIGH_LOW_CONTEXT_NODE_0_))continue;if(f(C[k+CAT_THREEFOUR_CONTEXT_NODE],CAT_THREEFOUR_CONTEXT_NODE_0_))continue;if(f(C[k+CAT_FIVE_CONTEXT_NODE],CAT_FIVE_CONTEXT_NODE_0_))continue;b=extrabits[DCT_VAL_CATEGORY6].min_val;w=extrabits[DCT_VAL_CATEGORY6].length;do{h(DCT_VAL_CATEGORY6,w);w--}while(w>=0);if(c(b))continue}if(A==CAT_FIVE_CONTEXT_NODE_0_){b=extrabits[DCT_VAL_CATEGORY5].min_val;h(DCT_VAL_CATEGORY5,4);h(DCT_VAL_CATEGORY5,3);h(DCT_VAL_CATEGORY5,2);h(DCT_VAL_CATEGORY5,1);h(DCT_VAL_CATEGORY5,0);if(c(b))continue}if(A==CAT_THREEFOUR_CONTEXT_NODE_0_){if(f(C[k+CAT_THREE_CONTEXT_NODE],CAT_THREE_CONTEXT_NODE_0_))continue;b=extrabits[DCT_VAL_CATEGORY4].min_val;h(DCT_VAL_CATEGORY4,3);h(DCT_VAL_CATEGORY4,2);h(DCT_VAL_CATEGORY4,1);h(DCT_VAL_CATEGORY4,0);if(c(b))continue}if(A==CAT_THREE_CONTEXT_NODE_0_){b=extrabits[DCT_VAL_CATEGORY3].min_val;h(DCT_VAL_CATEGORY3,2);h(DCT_VAL_CATEGORY3,1);h(DCT_VAL_CATEGORY3,0);if(c(b))continue}if(A==HIGH_LOW_CONTEXT_NODE_0_){if(f(C[k+CAT_ONE_CONTEXT_NODE],CAT_ONE_CONTEXT_NODE_0_))continue;b=extrabits[DCT_VAL_CATEGORY2].min_val;h(DCT_VAL_CATEGORY2,1);h(DCT_VAL_CATEGORY2,0);if(c(b))continue}if(A==CAT_ONE_CONTEXT_NODE_0_){b=extrabits[DCT_VAL_CATEGORY1].min_val;h(DCT_VAL_CATEGORY1,0);if(c(b))continue}if(A==LOW_VAL_CONTEXT_NODE_0_){if(f(C[k+TWO_CONTEXT_NODE],TWO_CONTEXT_NODE_0_))continue;if(f(C[k+THREE_CONTEXT_NODE],THREE_CONTEXT_NODE_0_))continue;if(c(4))continue}if(A==THREE_CONTEXT_NODE_0_){if(c(3))continue}if(A==TWO_CONTEXT_NODE_0_){if(c(2))continue}if(A==ONE_CONTEXT_NODE_0_){a(1);k=N+ENTROPY_NODES;if(m<15){S[x+zigzag[m]]=y;++m;A=DO_WHILE;continue}S[x+zigzag[15]]=y;A=BLOCK_FINISHED}if(A==BLOCK_FINISHED){E=(E|(m>1)+0<<p)>>>0;g=(m!=!v)+0;E=(E|g<<31)>>>0;t[left_context_index[p]]=n[above_context_index[p]]=g;x+=16;p++;if(p<d){A=BLOCK_LOOP;continue}if(p==25){v=0;p=0;d=16;N=v*COEF_BANDS*PREV_COEF_CONTEXTS*ENTROPY_NODES;x=i;L=u[TOKEN_BLOCK_Y1];A=BLOCK_LOOP;continue}if(p==16){v=2;N=v*COEF_BANDS*PREV_COEF_CONTEXTS*ENTROPY_NODES;d=24;L=u[TOKEN_BLOCK_UV];A=BLOCK_LOOP;continue}}A=END}while(A!=END);return E}function reset_row_context(e){memset(e,0,0,e.length)}function reset_above_context(e,t){var n=0;for(n=0;n<t;++n)memset(e[n],0,0,e[n].length)}function reset_mb_context(e,t,n){memset(e,0,0,8);memset(t,0,0,8);if(n!=B_PRED&&n!=SPLITMV){e[8]=0;t[8]=0}}function vp8_dixie_tokens_process_row(e,t,n,r,i){var s=e.tokens[t];var o=s.coeffs;var u=+25*16*r;var a=int_;var f=e.above_token_entropy_ctx;var l=+r;var c=s.left_token_entropy_ctx;var h=0;var p=e.mb_info_rows[1+n];var d=e.mb_info_rows_off[1+n]+r;if(n==0)reset_above_context(f,i);if(r==0)reset_row_context(c);for(a=r;a<r+i;a++){memset(o,u,0,25*16);if(p[d].base.skip_coeff){reset_mb_context(c,f[l],p[d].base.y_mode);p[d].base.eob_mask=0}else{var v;var m=0;v=e.dequant_factors;m=+p[d].base.segment_id;p[d].base.eob_mask=decode_mb_tokens(s.bool,c,f[l],o,u,p[d].base.y_mode,e.entropy_hdr.coeff_probs_,v[m].factor)}l++;d++;u+=25*16}}function vp8_dixie_tokens_init(e){var t=e.token_hdr.partitions;if(e.frame_hdr.frame_size_updated){var n=int_;var r=e.mb_cols*25*16;for(n=0;n<t;n++){e.tokens[n].coeffs=new Array(r);if(!e.tokens[n].coeffs)vpx_internal_error(e.error,VPX_CODEC_MEM_ERROR,null)}e.above_token_entropy_ctx=Arr_new(e.mb_cols,e.above_token_entropy_ctx_object);if(!e.above_token_entropy_ctx)vpx_internal_error(e.error,VPX_CODEC_MEM_ERROR,null)}}function ABS(e){return e>=0?e:-e}function saturate_int8(e){if(e<-128)return-128;if(e>127)return 127;return e}function saturate_uint8(e){if(e<0)return 0;if(e>255)return 255;return e}function high_edge_variance(e,t,n,r){var i=e[t-2*n];var s=e[t-1*n];var o=e[t+0*n];var u=e[t+1*n];return ABS(i-s)>r||ABS(u-o)>r}function simple_threshold(e,t,n,r){var i=e[t-2*n];var s=e[t-1*n];var o=e[t+0*n];var u=e[t+1*n];return ABS(s-o)*2+(ABS(i-u)>>1)<=r}function normal_threshold(e,t,n,r,i){var s=e[t-4*n];var o=e[t-3*n];var u=e[t-2*n];var a=e[t-1*n];var f=e[t+0*n];var l=e[t+1*n];var c=e[t+2*n];var h=e[t+3*n];var p=r;var d=i;return simple_threshold(e,t,n,2*p+d)&&ABS(s-o)<=d&&ABS(o-u)<=d&&ABS(u-a)<=d&&ABS(h-c)<=d&&ABS(c-l)<=d&&ABS(l-f)<=d}function filter_common(e,t,n,r){var i=e[t-2*n];var s=e[t-1*n];var o=e[t+0*n];var u=e[t+1*n];var a=int_,f=int_,l=int_;a=3*(o-s);if(r)a+=saturate_int8(i-u);a=saturate_int8(a);f=(a+4>127?127:a+4)>>3;l=(a+3>127?127:a+3)>>3;s=saturate_uint8(s+l);o=saturate_uint8(o-f);if(!r){a=f+1>>1;i=saturate_uint8(i+a);u=saturate_uint8(u-a)}e[t-2*n]=i;e[t-1*n]=s;e[t+0*n]=o;e[t+1*n]=u}function filter_mb_edge(e,t,n){var r=e[t-3*n];var i=e[t-2*n];var s=e[t-1*n];var o=e[t+0*n];var u=e[t+1*n];var a=e[t+2*n];var f=int_,l=int_;f=saturate_int8(saturate_int8(i-u)+3*(o-s));l=27*f+63>>7;s=saturate_uint8(s+l);o=saturate_uint8(o-l);l=18*f+63>>7;i=saturate_uint8(i+l);u=saturate_uint8(u-l);l=9*f+63>>7;r=saturate_uint8(r+l);a=saturate_uint8(a-l);e[t-3*n]=r;e[t-2*n]=i;e[t-1*n]=s;e[t+0*n]=o;e[t+1*n]=u;e[t+2*n]=a}function filter_mb_v_edge(e,t,n,r,i,s,o){var u=int_;for(u=0;u<8*o;u++){if(normal_threshold(e,t,1,r,i)){if(high_edge_variance(e,t,1,s))filter_common(e,t,1,1);else filter_mb_edge(e,t,1)}t+=n}}function filter_subblock_v_edge(e,t,n,r,i,s,o){var u=int_;for(u=0;u<8*o;u++){if(normal_threshold(e,t,1,r,i))filter_common(e,t,1,high_edge_variance(e,t,1,s));t+=n}}function filter_mb_h_edge(e,t,n,r,i,s,o){var u=int_;for(u=0;u<8*o;u++){if(normal_threshold(e,t,n,r,i)){if(high_edge_variance(e,t,n,s))filter_common(e,t,n,1);else filter_mb_edge(e,t,n)}t+=1}}function filter_subblock_h_edge(e,t,n,r,i,s,o){var u=int_;for(u=0;u<8*o;u++){if(normal_threshold(e,t,n,r,i))filter_common(e,t,n,high_edge_variance(e,t,n,s));t+=1}}function filter_v_edge_simple(e,t,n,r){var i=int_;for(i=0;i<16;i++){if(simple_threshold(e,t,1,r))filter_common(e,t,1,1);t+=n}}function filter_h_edge_simple(e,t,n,r){var i=int_;for(i=0;i<16;i++){if(simple_threshold(e,t,n,r))filter_common(e,t,n,1);t+=1}}function calculate_filter_parameters(e,t,n,r,i){var s=int_,o=int_,u=int_;s=e.loopfilter_hdr.level;if(e.segment_hdr.enabled){if(!e.segment_hdr.abs_)s+=e.segment_hdr.lf_level[t.base.segment_id];else s=e.segment_hdr.lf_level[t.base.segment_id]}if(e.loopfilter_hdr.delta_enabled){s+=e.loopfilter_hdr.ref_delta[t.base.ref_frame];if(t.base.ref_frame==CURRENT_FRAME){if(t.base.y_mode==B_PRED)s+=e.loopfilter_hdr.mode_delta[0]}else if(t.base.y_mode==ZEROMV)s+=e.loopfilter_hdr.mode_delta[1];else if(t.base.y_mode==SPLITMV)s+=e.loopfilter_hdr.mode_delta[3];else s+=e.loopfilter_hdr.mode_delta[2]}if(s>63)s=63;else if(s<0)s=0;o=s;if(e.loopfilter_hdr.sharpness){o>>=e.loopfilter_hdr.sharpness>4?2:1;if(o>9-e.loopfilter_hdr.sharpness)o=9-e.loopfilter_hdr.sharpness}if(o<1)o=1;u=s>=15;if(s>=40)u++;if(s>=20&&!e.frame_hdr.is_keyframe)u++;n[0]=s;r[0]=o;i[0]=u}function filter_row_normal(e,t,n,r){var i=char_,s=char_,o=char_;var u=0,a=0,f=0;var l=int_,c=int_;var h;var p=0;var d=int_;l=e.ref_frames[CURRENT_FRAME].img.stride[PLANE_Y];c=e.ref_frames[CURRENT_FRAME].img.stride[PLANE_U];i=e.ref_frames[CURRENT_FRAME].img.planes[PLANE_Y];u=e.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_Y];s=e.ref_frames[CURRENT_FRAME].img.planes[PLANE_U];a=e.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_U];o=e.ref_frames[CURRENT_FRAME].img.planes[PLANE_V];f=e.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_V];u+=(l*t+n)*16;a+=(c*t+n)*8;f+=(c*t+n)*8;h=e.mb_info_rows[1+t];p=e.mb_info_rows_off[1+t]+n;for(d=n;d<n+r;d++){var v=[int_],m=[int_],g=[int_];calculate_filter_parameters(e,h[p],v,m,g);v=v[0],m=m[0],g=g[0];if(v){if(d){filter_mb_v_edge(i,u,l,v+2,m,g,2);filter_mb_v_edge(s,a,c,v+2,m,g,1);filter_mb_v_edge(o,f,c,v+2,m,g,1)}if(h[p].base.eob_mask||h[p].base.y_mode==SPLITMV||h[p].base.y_mode==B_PRED){filter_subblock_v_edge(i,u+4,l,v,m,g,2);filter_subblock_v_edge(i,u+8,l,v,m,g,2);filter_subblock_v_edge(i,u+12,l,v,m,g,2);filter_subblock_v_edge(s,u+4,c,v,m,g,1);filter_subblock_v_edge(o,u+4,c,v,m,g,1)}if(t){filter_mb_h_edge(i,u,l,v+2,m,g,2);filter_mb_h_edge(s,a,c,v+2,m,g,1);filter_mb_h_edge(o,f,c,v+2,m,g,1)}if(h[p].base.eob_mask||h[p].base.y_mode==SPLITMV||h[p].base.y_mode==B_PRED){filter_subblock_h_edge(i,u+4*l,l,v,m,g,2);filter_subblock_h_edge(i,u+8*l,l,v,m,g,2);filter_subblock_h_edge(i,u+12*l,l,v,m,g,2);filter_subblock_h_edge(s,a+4*c,c,v,m,g,1);filter_subblock_h_edge(o,f+4*c,c,v,m,g,1)}}u+=16;a+=8;f+=8;p++}}function filter_row_simple(e,t,n,r){var i=char_;var s=0;var o=int_;var u;var a=0;var f=int_;o=e.ref_frames[CURRENT_FRAME].img.stride[PLANE_Y];i=e.ref_frames[CURRENT_FRAME].img.planes[PLANE_Y];s=e.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_Y];s+=(o*t+n)*16;u=e.mb_info_rows[1+t];a=e.mb_info_rows_off[1+t]+n;for(f=n;f<n+r;f++){var l=[int_],c=[int_],h=[int_];calculate_filter_parameters(e,u[a],l,c,h);if(l[0]){var p=(u[a].base.eob_mask||u[a].base.y_mode==SPLITMV||u[a].base.y_mode==B_PRED)+0;var d=(l[0]+2)*2+c[0];var v=l[0]*2+c[0];if(f)filter_v_edge_simple(i,s,o,d);if(p){filter_v_edge_simple(i,s+4,o,v);filter_v_edge_simple(i,s+8,o,v);filter_v_edge_simple(i,s+12,o,v)}if(t)filter_h_edge_simple(i,s,o,d);if(p){filter_h_edge_simple(i,s+4*o,o,v);filter_h_edge_simple(i,s+8*o,o,v);filter_h_edge_simple(i,s+12*o,o,v)}}s+=16;a++}}function vp8_dixie_loopfilter_process_row(e,t,n,r){if(e.loopfilter_hdr.use_simple)filter_row_simple(e,t,n,r);else filter_row_normal(e,t,n,r)}function predict_h_nxn(e,t,n,r){var i=e;var s=t-1;var o=int_,u=int_;for(o=0;o<r;o++)for(u=0;u<r;u++)e[t+o*n+u]=i[s+o*n]}function predict_v_nxn(e,t,n,r){var i=e;var s=t-n;var o=int_,u=int_;for(o=0;o<r;o++)for(u=0;u<r;u++)e[t+o*n+u]=i[s+u]}function predict_tm_nxn(e,t,n,r){var i=e;var s=t-1;var o=e;var u=t-n;var a=o[u-1];var f=int_,l=int_;for(l=0;l<r;l++){for(f=0;f<r;f++)e[t+f]=CLAMP_255(i[s]+o[u+f]-a);t+=n;s+=n}}function predict_dc_nxn(e,t,n,r){var i=e;var s=t-1;var o=e;var u=t-n;var a=int_,f=int_;var l=0;for(a=0;a<r;a++){l+=i[s]+o[u+a];s+=n}switch(r){case 16:l=l+16>>5;break;case 8:l=l+8>>4;break;case 4:l=l+4>>3;break}for(a=0;a<r;a++)for(f=0;f<r;f++)e[t+a*n+f]=l}function predict_ve_4x4(e,t,n){var r=e;var i=t-n;var s=int_,o=int_;e[t+0]=r[i-1]+2*r[i+0]+r[i+1]+2>>2;e[t+1]=r[i+0]+2*r[i+1]+r[i+2]+2>>2;e[t+2]=r[i+1]+2*r[i+2]+r[i+3]+2>>2;e[t+3]=r[i+2]+2*r[i+3]+r[i+4]+2>>2;for(s=1;s<4;s++)for(o=0;o<4;o++)e[t+s*n+o]=e[t+o]}function predict_he_4x4(e,t,n){var r=e;var i=t-1;e[t+0]=e[t+1]=e[t+2]=e[t+3]=r[i-n]+2*r[i+0]+r[i+n]+2>>2;t+=n;i+=n;e[t+0]=e[t+1]=e[t+2]=e[t+3]=r[i-n]+2*r[i+0]+r[i+n]+2>>2;t+=n;i+=n;e[t+0]=e[t+1]=e[t+2]=e[t+3]=r[i-n]+2*r[i+0]+r[i+n]+2>>2;t+=n;i+=n;e[t+0]=e[t+1]=e[t+2]=e[t+3]=r[i-n]+2*r[i+0]+r[i+0]+2>>2}function predict_ld_4x4(e,t,n){var r=e;var i=t-n;var s=int_,o=int_,u=int_,a=int_,f=int_,l=int_,c=int_;e[t+0]=s=r[i+0]+2*r[i+1]+r[i+2]+2>>2;e[t+1]=o=r[i+1]+2*r[i+2]+r[i+3]+2>>2;e[t+2]=u=r[i+2]+2*r[i+3]+r[i+4]+2>>2;e[t+3]=a=r[i+3]+2*r[i+4]+r[i+5]+2>>2;t+=n;e[t+0]=o;e[t+1]=u;e[t+2]=a;e[t+3]=f=r[i+4]+2*r[i+5]+r[i+6]+2>>2;t+=n;e[t+0]=u;e[t+1]=a;e[t+2]=f;e[t+3]=l=r[i+5]+2*r[i+6]+r[i+7]+2>>2;t+=n;e[t+0]=a;e[t+1]=f;e[t+2]=l;e[t+3]=c=r[i+6]+2*r[i+7]+r[i+7]+2>>2}function predict_rd_4x4(e,t,n){var r=e;var i=t-1;var s=e;var o=t-n;var u=int_,a=int_,f=int_,l=int_,c=int_,h=int_,p=int_;e[t+0]=u=r[i+0]+2*s[o-1]+s[o+0]+2>>2;e[t+1]=a=s[o-1]+2*s[o+0]+s[o+1]+2>>2;e[t+2]=f=s[o+0]+2*s[o+1]+s[o+2]+2>>2;e[t+3]=l=s[o+1]+2*s[o+2]+s[o+3]+2>>2;t+=n;e[t+0]=c=r[i+n]+2*r[i+0]+s[o-1]+2>>2;e[t+1]=u;e[t+2]=a;e[t+3]=f;t+=n;e[t+0]=h=r[i+n*2]+2*r[i+n]+r[i+0]+2>>2;e[t+1]=c;e[t+2]=u;e[t+3]=a;t+=n;e[t+0]=p=r[i+n*3]+2*r[i+n*2]+r[i+n]+2>>2;e[t+1]=h;e[t+2]=c;e[t+3]=u}function predict_vr_4x4(e,t,n){var r=e;var i=t-1;var s=e;var o=t-n;var u=int_,a=int_,f=int_,l=int_,c=int_,h=int_,p=int_,d=int_,v=int_,m=int_;e[t+0]=u=s[o-1]+s[o+0]+1>>1;e[t+1]=a=s[o+0]+s[o+1]+1>>1;e[t+2]=f=s[o+1]+s[o+2]+1>>1;e[t+3]=l=s[o+2]+s[o+3]+1>>1;t+=n;e[t+0]=c=r[i+0]+2*s[o-1]+s[o+0]+2>>2;e[t+1]=h=s[o-1]+2*s[o+0]+s[o+1]+2>>2;e[t+2]=p=s[o+0]+2*s[o+1]+s[o+2]+2>>2;e[t+3]=d=s[o+1]+2*s[o+2]+s[o+3]+2>>2;t+=n;e[t+0]=v=r[i+n]+2*r[i+0]+s[o-1]+2>>2;e[t+1]=u;e[t+2]=a;e[t+3]=f;t+=n;e[t+0]=m=r[i+n*2]+2*r[i+n]+r[i+0]+2>>2;e[t+1]=c;e[t+2]=h;e[t+3]=p}function predict_vl_4x4(e,t,n){var r=e;var i=t-n;var s=int_,o=int_,u=int_,a=int_,f=int_,l=int_,c=int_,h=int_,p=int_,d=int_;e[t+0]=s=r[i+0]+r[i+1]+1>>1;e[t+1]=o=r[i+1]+r[i+2]+1>>1;e[t+2]=u=r[i+2]+r[i+3]+1>>1;e[t+3]=a=r[i+3]+r[i+4]+1>>1;t+=n;e[t+0]=f=r[i+0]+2*r[i+1]+r[i+2]+2>>2;e[t+1]=l=r[i+1]+2*r[i+2]+r[i+3]+2>>2;e[t+2]=c=r[i+2]+2*r[i+3]+r[i+4]+2>>2;e[t+3]=h=r[i+3]+2*r[i+4]+r[i+5]+2>>2;t+=n;e[t+0]=o;e[t+1]=u;e[t+2]=a;e[t+3]=p=r[i+4]+2*r[i+5]+r[i+6]+2>>2;t+=n;e[t+0]=l;e[t+1]=c;e[t+2]=h;e[t+3]=d=r[i+5]+2*r[i+6]+r[i+7]+2>>2}function predict_hd_4x4(e,t,n){var r=e;var i=t-1;var s=e;var o=t-n;var u=int_,a=int_,f=int_,l=int_,c=int_,h=int_,p=int_,d=int_,v=int_,m=int_;e[t+0]=u=r[i+0]+s[o-1]+1>>1;e[t+1]=a=r[i+0]+2*s[o-1]+s[o+0]+2>>2;e[t+2]=f=s[o-1]+2*s[o+0]+s[o+1]+2>>2;e[t+3]=l=s[o+0]+2*s[o+1]+s[o+2]+2>>2;t+=n;e[t+0]=c=r[i+n]+r[i+0]+1>>1;e[t+1]=h=r[i+n]+2*r[i+0]+s[o-1]+2>>2;e[t+2]=u;e[t+3]=a;t+=n;e[t+0]=p=r[i+n*2]+r[i+n]+1>>1;e[t+1]=d=r[i+n*2]+2*r[i+n]+r[i+0]+2>>2;e[t+2]=c;e[t+3]=h;t+=n;e[t+0]=v=r[i+n*3]+r[i+n*2]+1>>1;e[t+1]=m=r[i+n*3]+2*r[i+n*2]+r[i+n]+2>>2;e[t+2]=p;e[t+3]=d}function predict_hu_4x4(e,t,n){var r=e;var i=t-1;var s=int_,o=int_,u=int_,a=int_,f=int_,l=int_,c=int_;e[t+0]=s=r[i+n*0]+r[i+n*1]+1>>1;e[t+1]=o=r[i+n*0]+2*r[i+n*1]+r[i+n*2]+2>>2;e[t+2]=u=r[i+n*1]+r[i+n*2]+1>>1;e[t+3]=a=r[i+n*1]+2*r[i+n*2]+r[i+n*3]+2>>2;t+=n;e[t+0]=u;e[t+1]=a;e[t+2]=f=r[i+n*2]+r[i+n*3]+1>>1;e[t+3]=l=r[i+n*2]+2*r[i+n*3]+r[i+n*3]+2>>2;t+=n;e[t+0]=f;e[t+1]=l;e[t+2]=c=r[i+n*3];e[t+3]=c;t+=n;e[t+0]=c;e[t+1]=c;e[t+2]=c;e[t+3]=c}function predict_h_16x16(e,t,n){predict_h_nxn(e,t,n,16)}function predict_v_16x16(e,t,n){predict_v_nxn(e,t,n,16)}function predict_tm_16x16(e,t,n){predict_tm_nxn(e,t,n,16)}function predict_h_8x8(e,t,n){predict_h_nxn(e,t,n,8)}function predict_v_8x8(e,t,n){predict_v_nxn(e,t,n,8)}function predict_tm_8x8(e,t,n){predict_tm_nxn(e,t,n,8)}function predict_tm_4x4(e,t,n){predict_tm_nxn(e,t,n,4)}function copy_down(e,t,n){var r=0,i=e;var s=t+16-n;var o;for(o=0;o<4;++o)tmp_4[r+o]=i[s+o];s+=n*4;for(o=0;o<4;++o)i[s+o]=tmp_4[r+o];s+=n*4;for(o=0;o<4;++o)i[s+o]=tmp_4[r+o];s+=n*4;for(o=0;o<4;++o)i[s+o]=tmp_4[r+o]}function b_pred(e,t,n,r,i,s){var o=int_;copy_down(e,t,n);for(o=0;o<16;o++){var u=e;var a=t+(o&3)*4;switch(r.splitt.mvs[o].d.x){case B_DC_PRED:predict_dc_nxn(u,a,n,4);break;case B_TM_PRED:predict_tm_4x4(u,a,n);break;case B_VE_PRED:predict_ve_4x4(u,a,n);break;case B_HE_PRED:predict_he_4x4(u,a,n);break;case B_LD_PRED:predict_ld_4x4(u,a,n);break;case B_RD_PRED:predict_rd_4x4(u,a,n);break;case B_VR_PRED:predict_vr_4x4(u,a,n);break;case B_VL_PRED:predict_vl_4x4(u,a,n);break;case B_HD_PRED:predict_hd_4x4(u,a,n);break;case B_HU_PRED:predict_hu_4x4(u,a,n);break;default:assert(0)}vp8_dixie_idct_add(u,a,u,a,n,i,s);s+=16;if((o&3)==3){t+=n*4}}}function fixup_dc_coeffs(e,t,n){var r=0;var i=int_;vp8_dixie_walsh(t,n+24*16,y2_16,r);for(i=0;i<16;i++)t[n+i*16]=y2_16[i]}function predict_intra_luma(e,t,n,r,i,s){if(r.base.y_mode==B_PRED)b_pred(e,t,n,r,i,s);else{var o=int_;switch(r.base.y_mode){case DC_PRED:predict_dc_nxn(e,t,n,16);break;case V_PRED:predict_v_16x16(e,t,n);break;case H_PRED:predict_h_16x16(e,t,n);break;case TM_PRED:predict_tm_16x16(e,t,n);break;default:assert(0)}fixup_dc_coeffs(r,i,s);for(o=0;o<16;o++){vp8_dixie_idct_add(e,t,e,t,n,i,s);s+=16;t+=4;if((o&3)==3)t+=n*4-16}}}function predict_intra_chroma(e,t,n,r,i,s,o,u){var a=int_;switch(s.base.uv_mode){case DC_PRED:predict_dc_nxn(e,t,i,8);predict_dc_nxn(n,r,i,8);break;case V_PRED:predict_v_8x8(e,t,i);predict_v_8x8(n,r,i);break;case H_PRED:predict_h_8x8(e,t,i);predict_h_8x8(n,r,i);break;case TM_PRED:predict_tm_8x8(e,t,i);predict_tm_8x8(n,r,i);break;default:assert(0)}u+=16*16;for(a=16;a<20;a++){vp8_dixie_idct_add(e,t,e,t,i,o,u);u+=16;t+=4;if(a&1)t+=i*4-8}for(a=20;a<24;a++){vp8_dixie_idct_add(n,r,n,r,i,o,u);u+=16;r+=4;if(a&1)r+=i*4-8}}function sixtap_horiz(e,t,n,r,i,s,o,u,a){var f=int_,l=int_,c=int_;for(f=0;f<u;f++){for(l=0;l<o;l++){c=r[i-2]*a[0]+r[i-1]*a[1]+r[i+0]*a[2]+r[i+1]*a[3]+r[i+2]*a[4]+r[i+3]*a[5]+64;c>>=7;e[t+l]=c;i++}i+=s-o;t+=n}}function sixtap_vert(e,t,n,r,i,s,o,u,a){var f=int_,l=int_,c=int_;for(f=0;f<u;f++){for(l=0;l<o;l++){c=r[i-2*s]*a[0]+r[i-1*s]*a[1]+r[i+0*s]*a[2]+r[i+1*s]*a[3]+r[i+2*s]*a[4]+r[i+3*s]*a[5]+64;c>>=7;e[t+l]=c;i++}i+=s-o;t+=n}}function sixtap_2d(e,t,n,r,i,s,o,u,a,f,l){sixtap_horiz(temp_,0,16,r,i-2*s,s,o,u+5,l[a]);sixtap_vert(e,t,n,temp_,+2*16,16,o,u,l[f])}function filter_block(e,t,n,r,i,s,o,u){var a=int_,f=int_;if(!o.d.x&&!o.d.y){e[0]=i;return r}a=o.d.x&7;f=o.d.y&7;i+=(o.d.y>>3)*s+(o.d.x>>3);if(a|f){sixtap_2d(t,n,s,r,i,s,4,4,a,f,u);r=t;i=n}e[0]=i;return r}function recon_1_block(e,t,n,r,i,s,o,u,a,f,l){var c=char_;var h=0;var p=[0];c=filter_block(p,e,t,n,r,i,s,o);h=p[0];vp8_dixie_idct_add(e,t,c,h,i,u,a+16*l)}function calculate_chroma_splitmv(e,t,n){var r=int_;var i=new mv;r=e.splitt.mvs[t].d.x+e.splitt.mvs[t+1].d.x+e.splitt.mvs[t+4].d.x+e.splitt.mvs[t+5].d.x;if(r<0)r-=4;else r+=4;i.d.x=parseInt(r/8,10);r=e.splitt.mvs[t].d.y+e.splitt.mvs[t+1].d.y+e.splitt.mvs[t+4].d.y+e.splitt.mvs[t+5].d.y;if(r<0)r-=4;else r+=4;i.d.y=parseInt(r/8,10);if(n){i.d.x&=~7;i.d.y&=~7}return i}function build_mc_border(e,t,n,r,i,s,o,u,a,f,l){var c=char_;var h=char_;c=n;h=r-s-o*i;if(o>=l)h+=(l-1)*i;else if(o>0)h+=o*i;do{var p=int_,d=0,v=int_;p=s<0?-s:0;if(p>u)p=u;if(s+u>f)d=s+u-f;if(d>u)d=u;v=u-p-d;if(p)memset(e,t,c[h+0],p);if(v)memcpy(e,t+p,c,h+s+p,v);if(d)memset(e,t+p+v,c[h+f-1],d);t+=i;o++;if(o<l&&o>0)h+=i}while(--a)}function recon_1_edge_block(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g=char_;var y=0;var b=m;var w=4;var E=4;h+=u.d.x>>3;p+=u.d.y>>3;if(h<2||h+w-1+3>=d||p<2||p+E-1+3>=v){s+=(u.d.x>>3)+(u.d.y>>3)*o;build_mc_border(n,r,i,s-2-2*o,o,h-2,p-2,w+5,E+5,d,v);i=n;s=r+2*o+2;s-=(u.d.x>>3)+(u.d.y>>3)*o}var S=[0];g=filter_block(S,e,t,i,s,o,u,a);y=S[0];vp8_dixie_idct_add(e,t,g,y,o,f,l+16*b)}function predict_inter_emulated_edge(e,t,n,r,i,s,o){var u=e.frame_strg[0].img.img_data;var a=e.frame_strg[0].img.img_data_off;var f=char_;var l=0;var c=char_;var h=0;var p=ptrdiff_t;var d=int_,v=int_,m=int_,g=int_,y=int_;var b=Arr_new(4,mv);var w=t.u,E=t.v;var S=t.u_off,x=t.v_off;var T=(e.frame_hdr.version==3)+0;m=s*16;g=o*16;d=e.mb_cols*16;v=e.mb_rows*16;c=t.y;h=t.y_off;p=e.ref_frame_offsets[i.base.ref_frame];f=e.ref_frame_offsets_[i.base.ref_frame];l=h+p;if(i.base.y_mode!=SPLITMV){var N=uvmv_1;N.d.x=i.base.mv.d.x;N.d.y=i.base.mv.d.y;N.d.x=N.d.x+1>>1;N.d.y=N.d.y+1>>1;if(T){N.d.x&=~7;N.d.y&=~7}b[0].d.x=N.d.x;b[0].d.y=N.d.y;b[1].d.x=N.d.x;b[1].d.y=N.d.y;b[2].d.x=N.d.x;b[2].d.y=N.d.y;b[3].d.x=N.d.x;b[3].d.y=N.d.y}else{b[0]=calculate_chroma_splitmv(i,0,T);b[1]=calculate_chroma_splitmv(i,2,T);b[2]=calculate_chroma_splitmv(i,8,T);b[3]=calculate_chroma_splitmv(i,10,T)}for(y=0;y<16;y++){var C;if(i.base.y_mode!=SPLITMV)C=i.base.mv;else C=i.splitt.mvs[+y];recon_1_edge_block(c,h,u,a,f,l,t.stride,C,e.subpixel_filters,n,r,i,m,g,d,v,y);m+=4;h+=4;l+=4;if((y&3)==3){m-=16;g+=4;h+=4*t.stride-16;l+=4*t.stride-16}}m=s*16;g=o*16;m>>=1;g>>=1;d>>=1;v>>=1;for(y=0;y<4;y++){recon_1_edge_block(w,S,u,a,f,S+p,t.uv_stride,b[y],e.subpixel_filters,n,r,i,m,g,d,v,y+16);recon_1_edge_block(E,x,u,a,f,x+p,t.uv_stride,b[y],e.subpixel_filters,n,r,i,m,g,d,v,y+20);S+=4;x+=4;m+=4;if(y&1){m-=8;g+=4;S+=4*t.uv_stride-8;x+=4*t.uv_stride-8}}}function predict_inter(e,t,n,r,i){var s=t.y;var o=t.y_off;var u=t.u;var a=t.u_off;var f=t.v;var l=t.v_off;var c;var h=ptrdiff_t;var p=Arr_new(4,mv);var d=(e.frame_hdr.version==3)+0;var v=int_;if(i.base.y_mode!=SPLITMV){var m=uvmv_2;m.d.x=i.base.mv.d.x;m.d.y=i.base.mv.d.y;m.d.x=m.d.x+1>>1;m.d.y=m.d.y+1>>1;if(d){m.d.x&=~7;m.d.y&=~7}p[0].d.x=p[1].d.x=p[2].d.x=p[3].d.x=m.d.x;p[0].d.y=p[1].d.y=p[2].d.y=p[3].d.y=m.d.y}else{p[0]=calculate_chroma_splitmv(i,0,d);p[1]=calculate_chroma_splitmv(i,2,d);p[2]=calculate_chroma_splitmv(i,8,d);p[3]=calculate_chroma_splitmv(i,10,d)}h=e.ref_frame_offsets[i.base.ref_frame];c=e.ref_frame_offsets_[i.base.ref_frame];for(v=0;v<16;v++){var g;if(i.base.y_mode!=SPLITMV)g=i.base.mv;else g=i.splitt.mvs[+v];recon_1_block(s,o,c,o+h,t.stride,g,e.subpixel_filters,n,r,i,v);o+=4;if((v&3)==3)o+=4*t.stride-16}for(v=0;v<4;v++){recon_1_block(u,a,c,a+h,t.uv_stride,p[v],e.subpixel_filters,n,r,i,v+16);recon_1_block(f,l,c,l+h,t.uv_stride,p[v],e.subpixel_filters,n,r,i,v+20);a+=4;l+=4;if(v&1){a+=4*t.uv_stride-8;l+=4*t.uv_stride-8}}}function vp8_dixie_release_ref_frame(e){if(e){assert(e.ref_cnt);e.ref_cnt--}}function vp8_dixie_ref_frame(e){e.ref_cnt++;return e}function vp8_dixie_find_free_ref_frame(e){var t=int_;for(t=0;t<NUM_REF_FRAMES;t++)if(e[t].ref_cnt==0){e[t].ref_cnt=1;return e[t]}assert(0);return null}function fixup_left(e,t,n,r,i,s){var o=e;var u=t-1;var a=int_;if(s==DC_PRED&&i){var f=e;var l=t-r;for(a=0;a<n;a++){o[u]=f[l+a];u+=r}}else{u-=r;for(a=-1;a<n;a++){o[u]=129;u+=r}}}function fixup_above(e,t,n,r,i,s){var o=e;var u=t-r;var a=int_;if(s==DC_PRED&&i){var f=e;var l=t-1;for(a=0;a<n;a++){o[u+a]=f[l];l+=r}}else memset(o,u-1,127,n+1);memset(o,u+n,127,4)}function vp8_dixie_predict_init(e){var t=int_;var n=char_;var r=0;if(e.frame_hdr.frame_size_updated){for(t=0;t<NUM_REF_FRAMES;t++){var i=e.mb_cols*16+BORDER_PIXELS*2;var s=e.mb_rows*16+BORDER_PIXELS*2;vpx_img_free(e.frame_strg[t].img);e.frame_strg[t].ref_cnt=0;e.ref_frames[t]=null;if(!vpx_img_alloc(e.frame_strg[t].img,IMG_FMT_I420,i,s,16))vpx_internal_error(e.error,VPX_CODEC_MEM_ERROR,"Failed to allocate %dx%d"+" framebuffer",i,s);vpx_img_set_rect(e.frame_strg[t].img,BORDER_PIXELS,BORDER_PIXELS,e.frame_hdr.kf.w,e.frame_hdr.kf.h)}if(e.frame_hdr.version)e.subpixel_filters=bilinear_filters;else e.subpixel_filters=sixtap_filters}if(e.ref_frames[CURRENT_FRAME])vp8_dixie_release_ref_frame(e.ref_frames[CURRENT_FRAME]);e.ref_frames[CURRENT_FRAME]=vp8_dixie_find_free_ref_frame(e.frame_strg);n=e.ref_frames[CURRENT_FRAME].img.img_data;for(t=0;t<NUM_REF_FRAMES;t++){var o=e.ref_frames[t];e.ref_frame_offsets[t]=o?o.img.img_data_off-r:0;e.ref_frame_offsets_[t]=o?o.img.img_data:n}}function vp8_dixie_predict_process_row(e,t,n,r){var i=img_1;var s;var o=0;var u=int_;var a=short_;var f=0;i.stride=e.ref_frames[CURRENT_FRAME].img.stride[PLANE_Y];i.uv_stride=e.ref_frames[CURRENT_FRAME].img.stride[PLANE_U];i.y=e.ref_frames[CURRENT_FRAME].img.planes[PLANE_Y];i.y_off=e.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_Y];i.u=e.ref_frames[CURRENT_FRAME].img.planes[PLANE_U];i.u_off=e.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_U];i.v=e.ref_frames[CURRENT_FRAME].img.planes[PLANE_V];i.v_off=e.ref_frames[CURRENT_FRAME].img.planes_off[PLANE_V];i.y_off+=(i.stride*t+n)*16;i.u_off+=(i.uv_stride*t+n)*8;i.v_off+=(i.uv_stride*t+n)*8;s=e.mb_info_rows[1+t];o=e.mb_info_rows_off[1+t]+n;a=e.tokens[t&e.token_hdr.partitions-1].coeffs;f=+25*16*n;if(n==0){fixup_left(i.y,i.y_off,16,i.stride,t,s[o].base.y_mode);fixup_left(i.u,i.u_off,8,i.uv_stride,t,s[o].base.uv_mode);fixup_left(i.v,i.v_off,8,i.uv_stride,t,s[o].base.uv_mode);if(t==0)i.y[i.y_off-i.stride-1]=127}for(u=n;u<n+r;u++){if(t==0){fixup_above(i.y,i.y_off,16,i.stride,u,s[o].base.y_mode);fixup_above(i.u,i.u_off,8,i.uv_stride,u,s[o].base.uv_mode);fixup_above(i.v,i.v_off,8,i.uv_stride,u,s[o].base.uv_mode)}if(s[o].base.y_mode<=B_PRED){predict_intra_luma(i.y,i.y_off,i.stride,s[o],a,f);predict_intra_chroma(i.u,i.u_off,i.v,i.v_off,i.uv_stride,s[o],a,f)}else{if(s[o].base.y_mode!=SPLITMV)fixup_dc_coeffs(s[o],a,f);if(s[o].base.need_mc_border)predict_inter_emulated_edge(e,i,a,f,s[o],u,t);else predict_inter(e,i,a,f,s[o])}o++;i.y_off+=16;i.u_off+=8;i.v_off+=8;f+=25*16}if(u==e.mb_cols){var l=i.y;var c=i.y_off+15*i.stride;var h=i.y[i.y_off-1+15*i.stride];l[c]=l[c+1]=l[c+2]=l[c+3]=h}}function ARRAY_COPY(e,t){assert(e.length==t.length);memcpy(e,0,t,0,e.length)}function decode_entropy_header(e,t,n){var r=int_,i=int_,s=int_,o=int_;var u=0;for(r=0;r<BLOCK_TYPES;r++)for(i=0;i<COEF_BANDS;i++)for(s=0;s<PREV_COEF_CONTEXTS;s++)for(o=0;o<ENTROPY_NODES;o++){if(bool_get(t,k_coeff_entropy_update_probs[r][i][s][o]))n.coeff_probs_[u]=n.coeff_probs[r][i][s][o]=bool_get_uint(t,8);u++}n.coeff_skip_enabled=bool_get_bit(t);if(n.coeff_skip_enabled)n.coeff_skip_prob=bool_get_uint(t,8);if(!e.frame_hdr.is_keyframe){n.prob_inter=bool_get_uint(t,8);n.prob_last=bool_get_uint(t,8);n.prob_gf=bool_get_uint(t,8);if(bool_get_bit(t))for(r=0;r<4;r++)n.y_mode_probs[r]=bool_get_uint(t,8);if(bool_get_bit(t))for(r=0;r<3;r++)n.uv_mode_probs[r]=bool_get_uint(t,8);for(r=0;r<2;r++)for(i=0;i<MV_PROB_CNT;i++)if(bool_get(t,k_mv_entropy_update_probs[r][i])){var a=bool_get_uint(t,7);n.mv_probs[r][i]=a?a<<1:1}}}function decode_reference_header(e,t,n){var r=e.frame_hdr.is_keyframe;n.refresh_gf=r?1:bool_get_bit(t);n.refresh_arf=r?1:bool_get_bit(t);n.copy_gf=r?0:!n.refresh_gf?bool_get_uint(t,2):0;n.copy_arf=r?0:!n.refresh_arf?bool_get_uint(t,2):0;n.sign_bias[GOLDEN_FRAME]=r?0:bool_get_bit(t);n.sign_bias[ALTREF_FRAME]=r?0:bool_get_bit(t);n.refresh_entropy=bool_get_bit(t);n.refresh_last=r?1:bool_get_bit(t)}function decode_quantizer_header(e,t,n){var r=int_;var i=n.q_index;n.q_index=bool_get_uint(t,7);r=(i!=n.q_index)+0;r|=n.y1_dc_delta_q=bool_maybe_get_int(t,4);r|=n.y2_dc_delta_q=bool_maybe_get_int(t,4);r|=n.y2_ac_delta_q=bool_maybe_get_int(t,4);r|=n.uv_dc_delta_q=bool_maybe_get_int(t,4);r|=n.uv_ac_delta_q=bool_maybe_get_int(t,4);n.delta_update=r}function decode_and_init_token_partitions(e,t,n,r,i,s){var o=int_;s.partitions=1<<bool_get_uint(t,2);if(i<3*(s.partitions-1))vpx_internal_error(e.error,VPX_CODEC_CORRUPT_FRAME,"Truncated packet found parsing partition"+" lengths.");i-=3*(s.partitions-1);for(o=0;o<s.partitions;o++){if(o<s.partitions-1){s.partition_sz[o]=n[r+2]<<16|n[r+1]<<8|n[r+0];r+=3}else s.partition_sz[o]=i;if(i<s.partition_sz[o])vpx_internal_error(e.error,VPX_CODEC_CORRUPT_FRAME,"Truncated partition %d",o);i-=s.partition_sz[o]}for(o=0;o<e.token_hdr.partitions;o++){init_bool_decoder(e.tokens[o].bool,n,r,e.token_hdr.partition_sz[o]);r+=e.token_hdr.partition_sz[o]}}function decode_loopfilter_header(e,t,n){if(e.frame_hdr.is_keyframe)memset(n,0,1);n.use_simple=bool_get_bit(t);n.level=bool_get_uint(t,6);n.sharpness=bool_get_uint(t,3);n.delta_enabled=bool_get_bit(t);if(n.delta_enabled&&bool_get_bit(t)){var r=int_;for(r=0;r<BLOCK_CONTEXTS;r++)n.ref_delta[r]=bool_maybe_get_int(t,6);for(r=0;r<BLOCK_CONTEXTS;r++)n.mode_delta[r]=bool_maybe_get_int(t,6)}}function decode_segmentation_header(e,t,n){if(e.frame_hdr.is_keyframe)memset(n,0,1);n.enabled=bool_get_bit(t);if(n.enabled){var r=int_;n.update_map=bool_get_bit(t);n.update_data=bool_get_bit(t);if(n.update_data){n.abs_=bool_get_bit(t);for(r=0;r<MAX_MB_SEGMENTS;r++)n.quant_idx[r]=bool_maybe_get_int(t,7);for(r=0;r<MAX_MB_SEGMENTS;r++)n.lf_level[r]=bool_maybe_get_int(t,6)}if(n.update_map){for(r=0;r<MB_FEATURE_TREE_PROBS;r++)n.tree_probs[r]=bool_get_bit(t)?bool_get_uint(t,8):255}}else{n.update_map=0;n.update_data=0}}function clamp_q(e){if(e<0)return 0;else if(e>127)return 127;return e}function dc_q(e){return dc_q_lookup[clamp_q(e)]}function ac_q(e){return ac_q_lookup[clamp_q(e)]}function dequant_init(e,t,n){var r=int_,i=int_;var s=e;var o=0;for(r=0;r<(t.enabled?MAX_MB_SEGMENTS:1);r++){i=n.q_index;if(t.enabled)i=!t.abs_?i+t.quant_idx[r]:t.quant_idx[r];if(s[o].quant_idx!=i||n.delta_update){s[o].factor[TOKEN_BLOCK_Y1][0]=dc_q(i+n.y1_dc_delta_q);s[o].factor[TOKEN_BLOCK_Y1][1]=ac_q(i);s[o].factor[TOKEN_BLOCK_UV][0]=dc_q(i+n.uv_dc_delta_q);s[o].factor[TOKEN_BLOCK_UV][1]=ac_q(i+n.uv_ac_delta_q);s[o].factor[TOKEN_BLOCK_Y2][0]=dc_q(i+n.y2_dc_delta_q)*2;s[o].factor[TOKEN_BLOCK_Y2][1]=parseInt(ac_q(i+n.y2_ac_delta_q)*155/100);if(s[o].factor[TOKEN_BLOCK_Y2][1]<8)s[o].factor[TOKEN_BLOCK_Y2][1]=8;if(s[o].factor[TOKEN_BLOCK_UV][0]>132)s[o].factor[TOKEN_BLOCK_UV][0]=132;s[o].quant_idx=i}o++}}function decode_frame(e,t,n,r){var i;var s=bool_1;var o=int_,u=int_,a=int_;e.saved_entropy_valid=0;if(i=vp8_parse_frame_header(t,r,e.frame_hdr))vpx_internal_error(e.error,i,"Failed to parse frame header");if(e.frame_hdr.is_experimental)vpx_internal_error(e.error,VPX_CODEC_UNSUP_BITSTREAM,"Experimental bitstreams not supported.");n+=FRAME_HEADER_SZ;r-=FRAME_HEADER_SZ;if(e.frame_hdr.is_keyframe){n+=KEYFRAME_HEADER_SZ;r-=KEYFRAME_HEADER_SZ;e.mb_cols=parseInt((e.frame_hdr.kf.w+15)/16,10);e.mb_rows=parseInt((e.frame_hdr.kf.h+15)/16,10)}init_bool_decoder(s,t,n,e.frame_hdr.part0_sz);if(e.frame_hdr.is_keyframe)if(bool_get_uint(s,2))vpx_internal_error(e.error,VPX_CODEC_UNSUP_BITSTREAM,"Reserved bits not supported.");decode_segmentation_header(e,s,e.segment_hdr);decode_loopfilter_header(e,s,e.loopfilter_hdr);decode_and_init_token_partitions(e,s,t,n+e.frame_hdr.part0_sz,r-e.frame_hdr.part0_sz,e.token_hdr);decode_quantizer_header(e,s,e.quant_hdr);decode_reference_header(e,s,e.reference_hdr);if(e.frame_hdr.is_keyframe){var o=int_,f=int_,l=int_,c=int_;var h=0;for(o=0;o<BLOCK_TYPES;o++)for(f=0;f<COEF_BANDS;f++)for(l=0;l<PREV_COEF_CONTEXTS;l++)for(c=0;c<ENTROPY_NODES;c++){e.entropy_hdr.coeff_probs_[h]=e.entropy_hdr.coeff_probs[o][f][l][c]=k_default_coeff_probs[o][f][l][c];h++}e.entropy_hdr.mv_probs=new k_default_mv_probs;ARRAY_COPY(e.entropy_hdr.y_mode_probs,k_default_y_mode_probs);ARRAY_COPY(e.entropy_hdr.uv_mode_probs,k_default_uv_mode_probs)}if(!e.reference_hdr.refresh_entropy){var p=e.saved_entropy,d=e.entropy_hdr;var h=0;for(o=0;o<BLOCK_TYPES;o++)for(f=0;f<COEF_BANDS;f++)for(l=0;l<PREV_COEF_CONTEXTS;l++)for(c=0;c<ENTROPY_NODES;c++){p.coeff_probs_[h]=p.coeff_probs[o][f][l][c]=d.coeff_probs[o][f][l][c];h++}p.coeff_skip_enabled=d.coeff_skip_enabled;p.coeff_skip_prob=d.coeff_skip_prob;for(o=0;o<2;++o)for(f=0;f<19;++f)p.mv_probs[o][f]=d.mv_probs[o][f];p.prob_gf=d.prob_gf;p.prob_inter=d.prob_inter;p.prob_last=d.prob_last;for(o=0;o<3;++o)p.uv_mode_probs[o]=d.uv_mode_probs[o];for(o=0;o<4;++o)p.y_mode_probs[o]=d.y_mode_probs[o];e.saved_entropy_valid=1}decode_entropy_header(e,s,e.entropy_hdr);vp8_dixie_modemv_init(e);vp8_dixie_tokens_init(e);vp8_dixie_predict_init(e);dequant_init(e.dequant_factors,e.segment_hdr,e.quant_hdr);for(u=0,a=0;u<e.mb_rows;u++){vp8_dixie_modemv_process_row(e,s,u,0,e.mb_cols);vp8_dixie_tokens_process_row(e,a,u,0,e.mb_cols);vp8_dixie_predict_process_row(e,u,0,e.mb_cols);if(++a==e.token_hdr.partitions)a=0}e.frame_cnt++;if(!e.reference_hdr.refresh_entropy){var p=e.entropy_hdr,d=e.saved_entropy;var h=0;for(o=0;o<BLOCK_TYPES;o++)for(f=0;f<COEF_BANDS;f++)for(l=0;l<PREV_COEF_CONTEXTS;l++)for(c=0;c<ENTROPY_NODES;c++){p.coeff_probs_[h]=p.coeff_probs[o][f][l][c]=d.coeff_probs[o][f][l][c]=d.coeff_probs_[h];h++}p.coeff_skip_enabled=d.coeff_skip_enabled;p.coeff_skip_prob=d.coeff_skip_prob;for(o=0;o<2;++o)for(f=0;f<19;++f)p.mv_probs[o][f]=d.mv_probs[o][f];p.prob_gf=d.prob_gf;p.prob_inter=d.prob_inter;p.prob_last=d.prob_last;for(o=0;o<3;++o)p.uv_mode_probs[o]=d.uv_mode_probs[o];for(o=0;o<4;++o)p.y_mode_probs[o]=d.y_mode_probs[o];e.saved_entropy_valid=0}if(e.reference_hdr.copy_arf==1){vp8_dixie_release_ref_frame(e.ref_frames[ALTREF_FRAME]);e.ref_frames[ALTREF_FRAME]=vp8_dixie_ref_frame(e.ref_frames[LAST_FRAME])}else if(e.reference_hdr.copy_arf==2){vp8_dixie_release_ref_frame(e.ref_frames[ALTREF_FRAME]);e.ref_frames[ALTREF_FRAME]=vp8_dixie_ref_frame(e.ref_frames[GOLDEN_FRAME])}if(e.reference_hdr.copy_gf==1){vp8_dixie_release_ref_frame(e.ref_frames[GOLDEN_FRAME]);e.ref_frames[GOLDEN_FRAME]=vp8_dixie_ref_frame(e.ref_frames[LAST_FRAME])}else if(e.reference_hdr.copy_gf==2){vp8_dixie_release_ref_frame(e.ref_frames[GOLDEN_FRAME]);e.ref_frames[GOLDEN_FRAME]=vp8_dixie_ref_frame(e.ref_frames[ALTREF_FRAME])}if(e.reference_hdr.refresh_gf){vp8_dixie_release_ref_frame(e.ref_frames[GOLDEN_FRAME]);e.ref_frames[GOLDEN_FRAME]=vp8_dixie_ref_frame(e.ref_frames[CURRENT_FRAME])}if(e.reference_hdr.refresh_arf){vp8_dixie_release_ref_frame(e.ref_frames[ALTREF_FRAME]);e.ref_frames[ALTREF_FRAME]=vp8_dixie_ref_frame(e.ref_frames[CURRENT_FRAME])}if(e.reference_hdr.refresh_last){vp8_dixie_release_ref_frame(e.ref_frames[LAST_FRAME]);e.ref_frames[LAST_FRAME]=vp8_dixie_ref_frame(e.ref_frames[CURRENT_FRAME])}}function CHECK_FOR_UPDATE(e,t,n){do{var r=e;n[0]|=r!=(e=t)}while(0);return e}function vp8_parse_frame_header(e,t,n){var r=long_;if(t<10)return VPX_CODEC_CORRUPT_FRAME;r=e[0]|e[1]<<8|e[2]<<16;n.is_keyframe=!BITS_GET(r,0,1);n.version=BITS_GET(r,1,2);n.is_experimental=BITS_GET(r,3,1);n.is_shown=BITS_GET(r,4,1);n.part0_sz=BITS_GET(r,5,19);if(t<=n.part0_sz+(n.is_keyframe?10:3))return VPX_CODEC_CORRUPT_FRAME;n.frame_size_updated=0;if(n.is_keyframe){var i=[0];if(e[3]!=157||e[4]!=1||e[5]!=42)return VPX_CODEC_UNSUP_BITSTREAM;r=e[6]|e[7]<<8|e[8]<<16|e[9]<<24;n.kf.w=CHECK_FOR_UPDATE(n.kf.w,BITS_GET(r,0,14),i);n.kf.scale_w=CHECK_FOR_UPDATE(n.kf.scale_w,BITS_GET(r,14,2),i);n.kf.h=CHECK_FOR_UPDATE(n.kf.h,BITS_GET(r,16,14),i);n.kf.scale_h=CHECK_FOR_UPDATE(n.kf.scale_h,BITS_GET(r,30,2),i);n.frame_size_updated=i[0];if(!n.kf.w||!n.kf.h)return VPX_CODEC_UNSUP_BITSTREAM}return VPX_CODEC_OK}function vp8_dixie_decode_frame(e,t,n){var r=e;e.error.error_code=VPX_CODEC_OK;e.error.has_detail=0;if(!setjmp(e.error.jmp))decode_frame(e,t,0,n);return r.error.error_code}function vp8_dixie_decode_destroy(e){vp8_dixie_predict_destroy(e);vp8_dixie_tokens_destroy(e);vp8_dixie_modemv_destroy(e)}function update_error_state(e,t){var n;if(n=t.error_code)e.base.err_detail=t.has_detail?t.detail:null;return n}function vp8_init(e){var t=VPX_CODEC_OK;if(!e.priv){var n=new vpx_codec_alg_priv_t;e.priv=n;if(!e.priv)return VPX_CODEC_MEM_ERROR;e.priv.sz=1;e.priv.iface=e.iface;e.priv.alg_priv=n;e.priv.init_flags=e.init_flags;if(e.config.dec){e.priv.alg_priv.cfg=e.config.dec;e.config.dec=e.priv.alg_priv.cfg}}return t}function vp8_destroy(e){vp8_dixie_decode_destroy(e.decoder_ctx);e.base.alg_priv="";return VPX_CODEC_OK}function vp8_peek_si(e,t,n){var r=new vp8_frame_hdr;var i=VPX_CODEC_OK;if(!(i=vp8_parse_frame_header(e,t,r))){n.is_kf=r.is_keyframe;if(n.is_kf){n.w=r.kf.w;n.h=r.kf.h}else{n.w=0;n.h=0}}return i}function vp8_get_si(e,t){var n=int_;if(t.sz>=1)n=1;else n=1;memcpy(t,e.si,n);alert("todo");t.sz=n;return VPX_CODEC_OK}function vp8_decode(e,t,n,r,i){var s=VPX_CODEC_OK;s=vp8_dixie_decode_frame(e.decoder_ctx,t,n);if(s)update_error_state(e,e.decoder_ctx.error);e.img_avail=e.decoder_ctx.frame_hdr.is_shown;e.img=e.decoder_ctx.ref_frames[CURRENT_FRAME].img;return s}function vp8_get_frame(e,t){var n=null;if(e.img_avail){if(!t[0]){n=e.img;t[0]=n}}return n}function webmdata(e){main(e)}function read_frame(e,t,n,r,i){var s=new Array(IVF_FRAME_HDR_SZ);var o=size_t;var u=e.infile;var a=e.kind;if(a==WEBM_FILE){if(e.chunk>=e.chunks){var f=[int_];do{if(e.pkt)nestegg_free_packet(e.pkt);if(nestegg_read_packet(e.nestegg_ctx,e.pkt)<=0||nestegg_packet_track(e.pkt,f))return 1}while(f!=e.video_track);if(nestegg_packet_count(e.pkt,e.chunks))return 1;e.chunk=0}if(nestegg_packet_data(e.pkt,e.chunk,t,r))return 1;e.chunk++;return 0}r[0]=o;if(r){if(fread(t,1,r[0],u)!=r[0]){fprintf(stderr,"Failed to read full frame\n");return 1}return 0}return 1}function nestegg_read_cb(e,t,n){var r=n;if(fread(e,1,t,r)<t){if(feof(r))return 0}return 1}function nestegg_seek_cb(e,t,n){switch(t){case NESTEGG_SEEK_SET:t=SEEK_SET;break;case NESTEGG_SEEK_CUR:t=SEEK_CUR;break;case NESTEGG_SEEK_END:t=SEEK_END;break}return fseek(n,e,t)?-1:0}function nestegg_tell_cb(e){return ftell(e)}function file_is_webm(e,t,n,r,i,s){var o=int_,u=[int_];var a=-1;var f={read:nestegg_read_cb,seek:nestegg_seek_cb,tell:nestegg_tell_cb,userdata:e.infile};var l=new nestegg_video_params;e.nestegg_ctx=[e.nestegg_ctx];if(nestegg_init(e.nestegg_ctx,f,null))alert("goto fail");e.nestegg_ctx=e.nestegg_ctx[0];if(nestegg_track_count(e.nestegg_ctx,u))alert("goto fail");for(o=0;o<u;o++){a=nestegg_track_type(e.nestegg_ctx,o);if(a==NESTEGG_TRACK_VIDEO)break;else if(a<0)alert("goto fail")}if(nestegg_track_codec_id(e.nestegg_ctx,o)!=NESTEGG_CODEC_VP8){fprintf(stderr,"Not VP8 video, quitting.\n");exit(1)}e.video_track=o;if(nestegg_track_video_params(e.nestegg_ctx,o,l))alert("goto fail");i[0]=0;s[0]=0;t[0]=VP8_FOURCC;n[0]=l.width;r[0]=l.height;return 1}function main(e,t,n){function S(){w=!read_frame(v,s,o,u,a);if(w){s=s[0];y=new Date;vp8_dixie_decode_frame(E,s,u);s=[s];var e=E.frame_hdr.is_shown;var t=E.ref_frames[0].img;T=new Date;if(e){if(t)vpximg2canvas(t);b++}}else{stopAutoPlayVideo();document.getElementById("yt_video").style.opacity="1";document.getElementById("vpximage").style.display="none";document.getElementById("yt_btn_fake").style.display="none"}}function x(){var e=(new Date).getTime();var t=frameRate;var n=1e3/t;return function r(t){if(!stopAnim){var i=requestAnimationFrame(r);var s=(new Date).getTime();var o=s-e;if(o>n){e=s-o%n;S()}}else{cancelAnimationFrame(i)}}(0)}var r=null;var i=int_;var s=[null];var o=[null];var u=[0],a=[0];var f={data:e,data_off:0};var l=[int_];var c=[int_];var h=[int_];var p=[int_];var d=[int_];var v=new input_ctx;var m=0;var g=0;v.infile=f;if(file_is_webm(v,l,c,h,p,d))v.kind=WEBM_FILE;else{alert("Unrecognized input file type.\n");return EXIT_FAILURE}var y=new Date;var b=0;var w;var E=new vp8_decoder_ctx;x();vidObj.dispatchEvent(eventStart);var T=new Date}var stopAnim=false;var frameRate=10;var eventCompleted=new Event("completed");var eventStart=new Event("start");var vidObj;var autoPlayVideo=function(e,t){if(Enabler.isInitialized()){vidObj=t;makeCorsRequest(webmdata,e)}else{window.alert("You need to use this solution together with DoubleClick Studio Enabler library")}};var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(Date.now())},1e3/frameRate)};var cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame;"use strict";var ptr=0;var EXIT_SUCCESS=0;var EXIT_FAILURE=1;var SEEK_CUR=1;var SEEK_END=2;var SEEK_SET=0;var buffer8k=function(){return Arr(8800,0)};var char_=0,short_=0,int_=0,long_=0,void_=0;var int8_t=char_;var uint8_t=char_;var int16_t=short_;var uint16_t=short_;var int32_t=int_;var uint32_t=int_;var uint64_t=long_;var int64_t=long_;var float_=0;var size_t=0;var double_=0;var score_t=int64_t;var CHAR_BIT=8;var ptrdiff_t=int_;var UINT8=char_;var INT16=short_;var DC_PRED=0,V_PRED=1,H_PRED=2,TM_PRED=3,B_PRED=4,NEARESTMV=5,NEARMV=6,ZEROMV=7,NEWMV=8,SPLITMV=9,MB_MODE_COUNT=10;var B_DC_PRED=0,B_TM_PRED=1,B_VE_PRED=2,B_HE_PRED=3,B_LD_PRED=4,B_RD_PRED=5,B_VR_PRED=6,B_VL_PRED=7,B_HD_PRED=8,B_HU_PRED=9,LEFT4X4=10,ABOVE4X4=11,ZERO4X4=12,NEW4X4=13,B_MODE_COUNT=14;var VPX_CODEC_INTERNAL_ABI_VERSION=3;var VPX_CODEC_CAP_DECODER=1;var vpx_codec_ctrl_fn_map_t=function(){this.ctrl_id=int_,this.fn=0};var vpx_codec_iface=function(){this.name=char_,this.abi_version=int_,this.caps=long_,this.init="vpx_codec_init_fn_t",this.destroy="vpx_codec_destroy_fn_t",this.ctrl_maps=new vpx_codec_ctrl_fn_map_t,this.get_mmap="vpx_codec_get_mmap_fn_t",this.set_mmap="vpx_codec_set_mmap_fn_t",this.dec=new Object({peek_si:"vpx_codec_peek_si_fn_t",get_si:"vpx_codec_get_si_fn_t",decode:"vpx_codec_decode_fn_t",get_frame:"vpx_codec_get_frame_fn_t"})};var vpx_codec_iface_t=vpx_codec_iface;var VERSION_STRING=" v0.9.7";var VPX_CODEC_OK=0,VPX_CODEC_MEM_ERROR=2;var VPX_IMAGE_ABI_VERSION=1;VPX_IMG_FMT_I420=258;VPX_IMG_FMT_VPXI420=260;var VPX_PLANE_PACKED=0;var VPX_PLANE_Y=0;var VPX_PLANE_U=1;var VPX_PLANE_V=2;var VPX_PLANE_ALPHA=3;var PLANE_PACKED=VPX_PLANE_PACKED;var PLANE_Y=VPX_PLANE_Y;var PLANE_U=VPX_PLANE_U;var PLANE_V=VPX_PLANE_V;var PLANE_ALPHA=VPX_PLANE_ALPHA;var vpx_image_t=function(){this.fmt=0,this.w=this["w"]=int_,this.h=this["h"]=int_,this.d_w=this["d_w"]=int_,this.d_h=this["d_h"]=int_,this.x_chroma_shift=this["x_chroma_shift"]=int_,this.y_chroma_shift=this["y_chroma_shift"]=int_,this.planes=this["planes"]=new Array(4),this.planes_off=this["planes_off"]=new Array(4),this.stride=this["stride"]=new Array(4),this.bps=this["bps"]=int_,this.user_priv=this["user_priv"]=void_,this.img_data=this["img_data"]=char_,this.img_data_off=this["img_data_off"]=0,this.img_data_owner=this["img_data_owner"]=int_,this.self_allocd=this["self_allocd"]=int_};var NESTEGG_TRACK_VIDEO=0;var NESTEGG_TRACK_AUDIO=1;var NESTEGG_CODEC_VP8=0;var NESTEGG_CODEC_VORBIS=1;var NESTEGG_SEEK_SET=0;var NESTEGG_SEEK_CUR=1;var NESTEGG_SEEK_END=2;var NESTEGG_LOG_DEBUG=1;var NESTEGG_LOG_INFO=10;var NESTEGG_LOG_WARNING=100;var NESTEGG_LOG_ERROR=1e3;var NESTEGG_LOG_CRITICAL=1e4;var nestegg_io=function(){this.read=int_,this.seek=int_,this.tell=int64_t,this.userdata=void_};var nestegg_video_params=function(){this.width=int_,this.height=int_,this.display_width=int_,this.display_height=int_,this.crop_bottom=int_,this.crop_top=int_,this.crop_left=int_,this.crop_right=int_};var ID_EBML=440786851;var ID_EBML_VERSION=17030;var ID_EBML_READ_VERSION=17143;var ID_EBML_MAX_ID_LENGTH=17138;var ID_EBML_MAX_SIZE_LENGTH=17139;var ID_DOCTYPE=17026;var ID_DOCTYPE_VERSION=17031;var ID_DOCTYPE_READ_VERSION=17029;var ID_VOID=236;var ID_CRC32=191;var ID_SEGMENT=408125543;var ID_SEEK_HEAD=290298740;var ID_SEEK=19899;var ID_SEEK_ID=21419;var ID_SEEK_POSITION=21420;var ID_INFO=357149030;var ID_TIMECODE_SCALE=2807729;var ID_DURATION=17545;var ID_CLUSTER=524531317;var ID_TIMECODE=231;var ID_BLOCK_GROUP=160;var ID_SIMPLE_BLOCK=163;var ID_BLOCK=161;var ID_BLOCK_DURATION=155;var ID_REFERENCE_BLOCK=251;var ID_TRACKS=374648427;var ID_TRACK_ENTRY=174;var ID_TRACK_NUMBER=215;var ID_TRACK_UID=29637;var ID_TRACK_TYPE=131;var ID_FLAG_ENABLED=185;var ID_FLAG_DEFAULT=136;var ID_FLAG_LACING=156;var ID_TRACK_TIMECODE_SCALE=2306383;var ID_LANGUAGE=2274716;var ID_CODEC_ID=134;var ID_CODEC_PRIVATE=25506;var ID_VIDEO=224;var ID_PIXEL_WIDTH=176;var ID_PIXEL_HEIGHT=186;var ID_PIXEL_CROP_BOTTOM=21674;var ID_PIXEL_CROP_TOP=21691;var ID_PIXEL_CROP_LEFT=21708;var ID_PIXEL_CROP_RIGHT=21725;var ID_DISPLAY_WIDTH=21680;var ID_DISPLAY_HEIGHT=21690;var ID_AUDIO=225;var ID_SAMPLING_FREQUENCY=181;var ID_CHANNELS=159;var ID_BIT_DEPTH=25188;var ID_CUES=475249515;var ID_CUE_POINT=187;var ID_CUE_TIME=179;var ID_CUE_TRACK_POSITIONS=183;var ID_CUE_TRACK=247;var ID_CUE_CLUSTER_POSITION=241;var ID_CUE_BLOCK_NUMBER=21368;var TYPE_UNKNOWN=0,TYPE_MASTER=1,TYPE_UINT=2,TYPE_FLOAT=3,TYPE_INT=4,TYPE_STRING=5,TYPE_BINARY=6;var LIMIT_STRING=1<<20;var LIMIT_BINARY=1<<24;var LIMIT_BLOCK=1<<30;var LIMIT_FRAME=1<<28;var DESC_FLAG_NONE=0;var DESC_FLAG_MULTI=1<<0;var DESC_FLAG_SUSPEND=1<<1;var DESC_FLAG_OFFSET=1<<2;var BLOCK_FLAGS_LACING=6;var LACING_NONE=0;var LACING_XIPH=1;var LACING_FIXED=2;var LACING_EBML=3;var TRACK_TYPE_VIDEO=1;var TRACK_TYPE_AUDIO=2;var TRACK_ID_VP8="V_VP8";var TRACK_ID_VORBIS="A_VORBIS";var MASK_NONE=0,MASK_FIRST_BIT=1;var ebml_binary=function(){this.data=char_,this.length=size_t};var ebml_list_node=function(){this.next=null,this.id=uint64_t,this.data=void_};var ebml_list=function(){this.head=null,this.tail=null};var ebml_type=function(){this.v=new Object({u:uint64_t,f:double_,i:int64_t,s:char_,b:new ebml_binary}),this.type=0,this.read=int_};var ebml=window["ebml"]=function(){this.ebml_version=this["ebml_version"]=new ebml_type,this.ebml_read_version=this["ebml_read_version"]=new ebml_type,this.ebml_max_id_length=this["ebml_max_id_length"]=new ebml_type,this.ebml_max_size_length=this["ebml_max_size_length"]=new ebml_type,this.doctype=this["doctype"]=new ebml_type,this.doctype_version=this["doctype_version"]=new ebml_type,this.doctype_read_version=this["doctype_read_version"]=new ebml_type};var seek=window["seek"]=function(){this.id=this["id"]=new ebml_type,this.position=this["position"]=new ebml_type};var seek_head=window["seek_head"]=function(){this.seek=this["seek"]=new ebml_list};var info=window["info"]=function(){this.timecode_scale=this["timecode_scale"]=new ebml_type,this.duration=this["duration"]=new ebml_type};var block_group=window["block_group"]=function(){this.duration=this["duration"]=new ebml_type,this.reference_block=this["reference_block"]=new ebml_type};var cluster=window["cluster"]=function(){this.timecode=this["timecode"]=new ebml_type,this.block_group=this["block_group"]=new ebml_list};var video=window["video"]=function(){this.pixel_width=this["pixel_width"]=new ebml_type,this.pixel_height=this["pixel_height"]=new ebml_type,this.pixel_crop_bottom=this["pixel_crop_bottom"]=new ebml_type,this.pixel_crop_top=this["pixel_crop_top"]=new ebml_type,this.pixel_crop_left=this["pixel_crop_left"]=new ebml_type,this.pixel_crop_right=this["pixel_crop_right"]=new ebml_type,this.display_width=this["display_width"]=new ebml_type,this.display_height=this["display_height"]=new ebml_type};var audio=window["audio"]=function(){this.sampling_frequency=this["sampling_frequency"]=new ebml_type,this.channels=this["channels"]=new ebml_type,this.bit_depth=this["bit_depth"]=new ebml_type};var track_entry=window["track_entry"]=function(){this.number=this["number"]=new ebml_type,this.uid=this["uid"]=new ebml_type,this.type=this["type"]=new ebml_type,this.flag_enabled=this["flag_enabled"]=new ebml_type,this.flag_default=this["flag_default"]=new ebml_type,this.flag_lacing=this["flag_lacing"]=new ebml_type,this.track_timecode_scale=this["track_timecode_scale"]=new ebml_type,this.language=this["language"]=new ebml_type,this.codec_id=this["codec_id"]=new ebml_type,this.codec_private=this["codec_private"]=new ebml_type,this.video=this["video"]=new video,this.audio=this["audio"]=new audio};var tracks=window["tracks"]=function(){this.track_entry=this["track_entry"]=new ebml_list};var cue_track_positions=window["cue_track_positions"]=function(){this.track=this["track"]=new ebml_type,this.cluster_position=this["cluster_position"]=new ebml_type,this.block_number=this["block_number"]=new ebml_type};var cue_point=window["cue_point"]=function(){this.time=this["time"]=new ebml_type,this.cue_track_positions=this["cue_track_positions"]=new ebml_list};var cues=window["cues"]=function(){this.cue_point=this["cue_point"]=new ebml_list};var segment=window["segment"]=function(){this.seek_head=this["seek_head"]=new ebml_list,this.info=this["info"]=new info,this.cluster=this["cluster"]=new ebml_list,this.tracks=this["tracks"]=new tracks,this.cues=this["cues"]=new cues};var pool_ctx=function(){this.dummy=char_};var list_node=function(){this.previous=0,this.node=new ebml_element_desc,this.data=char_};var frame=function(){this.data=char_,this.length=size_t,this.next=null};var nestegg=function(){this.io=new nestegg_io,this.log_=0,this.alloc_pool=new pool_ctx,this.last_id=uint64_t,this.last_size=uint64_t,this.ancestor=null,this.ebml=this["ebml"]=new ebml,this.segment=this["segment"]=new segment,this.segment_offset=int64_t,this.track_count=int_};var nestegg_packet=function(){this.track=uint64_t,this.timecode=uint64_t,this.frame=new frame};var ebml_element_desc=function(){this.name=char_,this.id=uint64_t,this.type=0,this.offset=size_t,this.flags=int_,this.children=null,this.size=size_t,this.data_offset=size_t};var E_LAST=new Array(null,0,0,0,DESC_FLAG_NONE,null,0,0);var ne_ebml_elements=create_ebml_element_desc(new Array(E_FIELD("ID_EBML_VERSION",ID_EBML_VERSION,TYPE_UINT,"ebml","ebml_version"),E_FIELD("ID_EBML_READ_VERSION",ID_EBML_READ_VERSION,TYPE_UINT,"ebml","ebml_read_version"),E_FIELD("ID_EBML_MAX_ID_LENGTH",ID_EBML_MAX_ID_LENGTH,TYPE_UINT,"ebml","ebml_max_id_length"),E_FIELD("ID_EBML_MAX_SIZE_LENGTH",ID_EBML_MAX_SIZE_LENGTH,TYPE_UINT,"ebml","ebml_max_size_length"),E_FIELD("ID_DOCTYPE",ID_DOCTYPE,TYPE_STRING,"ebml","doctype"),E_FIELD("ID_DOCTYPE_VERSION",ID_DOCTYPE_VERSION,TYPE_UINT,"ebml","doctype_version"),E_FIELD("ID_DOCTYPE_READ_VERSION",ID_DOCTYPE_READ_VERSION,TYPE_UINT,"ebml","doctype_read_version"),E_LAST));var ne_seek_elements=create_ebml_element_desc(new Array(E_FIELD("ID_SEEK_ID",ID_SEEK_ID,TYPE_BINARY,"seek","id"),E_FIELD("ID_SEEK_POSITION",ID_SEEK_POSITION,TYPE_UINT,"seek","position"),E_LAST));var ne_seek_head_elements=create_ebml_element_desc(new Array(E_MASTER("ID_SEEK",ID_SEEK,TYPE_MASTER,"seek_head","seek",ne_seek_elements),E_LAST));var ne_info_elements=create_ebml_element_desc(new Array(E_FIELD("ID_TIMECODE_SCALE",ID_TIMECODE_SCALE,TYPE_UINT,"info","timecode_scale"),E_FIELD("ID_DURATION",ID_DURATION,TYPE_FLOAT,"info","duration"),E_LAST));var ne_block_group_elements=create_ebml_element_desc(new Array(E_SUSPEND("ID_BLOCK",ID_BLOCK,TYPE_BINARY),E_FIELD("ID_BLOCK_DURATION",ID_BLOCK_DURATION,TYPE_UINT,"block_group","duration"),E_FIELD("ID_REFERENCE_BLOCK",ID_REFERENCE_BLOCK,TYPE_INT,"block_group","reference_block"),E_LAST));var ne_cluster_elements=create_ebml_element_desc(new Array(E_FIELD("ID_TIMECODE",ID_TIMECODE,TYPE_UINT,"cluster","timecode"),E_MASTER("ID_BLOCK_GROUP",ID_BLOCK_GROUP,TYPE_MASTER,"cluster","block_group",ne_block_group_elements),E_SUSPEND("ID_SIMPLE_BLOCK",ID_SIMPLE_BLOCK,TYPE_BINARY),E_LAST));var ne_video_elements=create_ebml_element_desc(new Array(E_FIELD("ID_PIXEL_WIDTH",ID_PIXEL_WIDTH,TYPE_UINT,"video","pixel_width"),E_FIELD("ID_PIXEL_HEIGHT",ID_PIXEL_HEIGHT,TYPE_UINT,"video","pixel_height"),E_FIELD("ID_PIXEL_CROP_BOTTOM",ID_PIXEL_CROP_BOTTOM,TYPE_UINT,"video","pixel_crop_bottom"),E_FIELD("ID_PIXEL_CROP_TOP",ID_PIXEL_CROP_TOP,TYPE_UINT,"video","pixel_crop_top"),E_FIELD("ID_PIXEL_CROP_LEFT",ID_PIXEL_CROP_LEFT,TYPE_UINT,"video","pixel_crop_left"),E_FIELD("ID_PIXEL_CROP_RIGHT",ID_PIXEL_CROP_RIGHT,TYPE_UINT,"video","pixel_crop_right"),E_FIELD("ID_DISPLAY_WIDTH",ID_DISPLAY_WIDTH,TYPE_UINT,"video","display_width"),E_FIELD("ID_DISPLAY_HEIGHT",ID_DISPLAY_HEIGHT,TYPE_UINT,"video","display_height"),E_LAST));var ne_audio_elements=create_ebml_element_desc(new Array(E_FIELD("ID_SAMPLING_FREQUENCY",ID_SAMPLING_FREQUENCY,TYPE_FLOAT,"audio","sampling_frequency"),E_FIELD("ID_CHANNELS",ID_CHANNELS,TYPE_UINT,"audio","channels"),E_FIELD("ID_BIT_DEPTH",ID_BIT_DEPTH,TYPE_UINT,"audio","bit_depth"),E_LAST));var ne_track_entry_elements=create_ebml_element_desc(new Array(E_FIELD("ID_TRACK_NUMBER",ID_TRACK_NUMBER,TYPE_UINT,"track_entry","number"),E_FIELD("ID_TRACK_UID",ID_TRACK_UID,TYPE_UINT,"track_entry","uid"),E_FIELD("ID_TRACK_TYPE",ID_TRACK_TYPE,TYPE_UINT,"track_entry","type"),E_FIELD("ID_FLAG_ENABLED",ID_FLAG_ENABLED,TYPE_UINT,"track_entry","flag_enabled"),E_FIELD("ID_FLAG_DEFAULT",ID_FLAG_DEFAULT,TYPE_UINT,"track_entry","flag_default"),E_FIELD("ID_FLAG_LACING",ID_FLAG_LACING,TYPE_UINT,"track_entry","flag_lacing"),E_FIELD("ID_TRACK_TIMECODE_SCALE",ID_TRACK_TIMECODE_SCALE,TYPE_FLOAT,"track_entry","track_timecode_scale"),E_FIELD("ID_LANGUAGE",ID_LANGUAGE,TYPE_STRING,"track_entry","language"),E_FIELD("ID_CODEC_ID",ID_CODEC_ID,TYPE_STRING,"track_entry","codec_id"),E_FIELD("ID_CODEC_PRIVATE",ID_CODEC_PRIVATE,TYPE_BINARY,"track_entry","codec_private"),E_SINGLE_MASTER("ID_VIDEO",ID_VIDEO,TYPE_MASTER,"track_entry","video",ne_video_elements),E_SINGLE_MASTER("ID_AUDIO",ID_AUDIO,TYPE_MASTER,"track_entry","audio",ne_audio_elements),E_LAST));var ne_tracks_elements=create_ebml_element_desc(new Array(E_MASTER("ID_TRACK_ENTRY",ID_TRACK_ENTRY,TYPE_MASTER,"tracks","track_entry",ne_track_entry_elements),E_LAST));var ne_cue_track_positions_elements=create_ebml_element_desc(new Array(E_FIELD("ID_CUE_TRACK",ID_CUE_TRACK,TYPE_UINT,"cue_track_positions","track"),E_FIELD("ID_CUE_CLUSTER_POSITION",ID_CUE_CLUSTER_POSITION,TYPE_UINT,"cue_track_positions","cluster_position"),E_FIELD("ID_CUE_BLOCK_NUMBER",ID_CUE_BLOCK_NUMBER,TYPE_UINT,"cue_track_positions","block_number"),E_LAST));var ne_cue_point_elements=create_ebml_element_desc(new Array(E_FIELD("ID_CUE_TIME",ID_CUE_TIME,TYPE_UINT,"cue_point","time"),E_MASTER("ID_CUE_TRACK_POSITIONS",ID_CUE_TRACK_POSITIONS,TYPE_MASTER,"cue_point","cue_track_positions",ne_cue_track_positions_elements),E_LAST));var ne_cues_elements=create_ebml_element_desc(new Array(E_MASTER("ID_CUE_POINT",ID_CUE_POINT,TYPE_MASTER,"cues","cue_point",ne_cue_point_elements),E_LAST));var ne_segment_elements=create_ebml_element_desc(new Array(E_MASTER("ID_SEEK_HEAD",ID_SEEK_HEAD,TYPE_MASTER,"segment","seek_head",ne_seek_head_elements),E_SINGLE_MASTER("ID_INFO",ID_INFO,TYPE_MASTER,"segment","info",ne_info_elements),E_MASTER("ID_CLUSTER",ID_CLUSTER,TYPE_MASTER,"segment","cluster",ne_cluster_elements),E_SINGLE_MASTER("ID_TRACKS",ID_TRACKS,TYPE_MASTER,"segment","tracks",ne_tracks_elements),E_SINGLE_MASTER("ID_CUES",ID_CUES,TYPE_MASTER,"segment","cues",ne_cues_elements),E_LAST));var ne_top_level_elements=create_ebml_element_desc(new Array(E_SINGLE_MASTER("ID_EBML",ID_EBML,TYPE_MASTER,"nestegg","ebml",ne_ebml_elements),E_SINGLE_MASTER_O("ID_SEGMENT",ID_SEGMENT,TYPE_MASTER,"nestegg","segment",ne_segment_elements),E_LAST));var buffer_8192=Arr(8192,0);var frame_sizes_256=Arr(256,0);var ctx_=new nestegg;var VPX_IMAGE_ABI_VERSION=1;var VPX_IMG_FMT_PLANAR=256;var VPX_IMG_FMT_UV_FLIP=512;var VPX_IMG_FMT_HAS_ALPHA=1024;var VPX_IMG_FMT_NONE=0,VPX_IMG_FMT_RGB24=1,VPX_IMG_FMT_RGB32=2,VPX_IMG_FMT_RGB565=3,VPX_IMG_FMT_RGB555=4,VPX_IMG_FMT_UYVY=5,VPX_IMG_FMT_YUY2=6,VPX_IMG_FMT_YVYU=7,VPX_IMG_FMT_BGR24=8,VPX_IMG_FMT_RGB32_LE=9,VPX_IMG_FMT_ARGB=10,VPX_IMG_FMT_ARGB_LE=11,VPX_IMG_FMT_RGB565_LE=12,VPX_IMG_FMT_RGB555_LE=13,VPX_IMG_FMT_YV12=VPX_IMG_FMT_PLANAR|VPX_IMG_FMT_UV_FLIP|1,VPX_IMG_FMT_I420=VPX_IMG_FMT_PLANAR|2,VPX_IMG_FMT_VPXYV12=VPX_IMG_FMT_PLANAR|VPX_IMG_FMT_UV_FLIP|3,VPX_IMG_FMT_VPXI420=VPX_IMG_FMT_PLANAR|4;var IMG_FMT_PLANAR=VPX_IMG_FMT_PLANAR;var IMG_FMT_UV_FLIP=VPX_IMG_FMT_UV_FLIP;var IMG_FMT_HAS_ALPHA=VPX_IMG_FMT_HAS_ALPHA;var IMG_FMT_NONE=VPX_IMG_FMT_NONE;var IMG_FMT_RGB24=VPX_IMG_FMT_RGB24;var IMG_FMT_RGB32=VPX_IMG_FMT_RGB32;var IMG_FMT_RGB565=VPX_IMG_FMT_RGB565;var IMG_FMT_RGB555=VPX_IMG_FMT_RGB555;var IMG_FMT_UYVY=VPX_IMG_FMT_UYVY;var IMG_FMT_YUY2=VPX_IMG_FMT_YUY2;var IMG_FMT_YVYU=VPX_IMG_FMT_YVYU;var IMG_FMT_BGR24=VPX_IMG_FMT_BGR24;var IMG_FMT_RGB32_LE=VPX_IMG_FMT_RGB32_LE;var IMG_FMT_ARGB=VPX_IMG_FMT_ARGB;var IMG_FMT_ARGB_LE=VPX_IMG_FMT_ARGB_LE;var IMG_FMT_RGB565_LE=VPX_IMG_FMT_RGB565_LE;var IMG_FMT_RGB555_LE=VPX_IMG_FMT_RGB555_LE;var IMG_FMT_YV12=VPX_IMG_FMT_YV12;var IMG_FMT_I420=VPX_IMG_FMT_I420;var IMG_FMT_VPXYV12=VPX_IMG_FMT_VPXYV12;var IMG_FMT_VPXI420=VPX_IMG_FMT_VPXI420;var bool_decoder=function(){this.input=char_,this.input_off=0,this.input_len=size_t,this.range=int_,this.value=int_,this.bit_count=int_};var vp8_frame_hdr=function(){this.is_keyframe=int_,this.is_experimental=int_,this.version=int_,this.is_shown=int_,this.part0_sz=int_,this.kf=new Object({w:int_,h:int_,scale_w:int_,scale_h:int_}),this.frame_size_updated=int_};var MB_FEATURE_TREE_PROBS=3,MAX_MB_SEGMENTS=4;var vp8_segment_hdr=function(){this.enabled=int_,this.update_data=int_,this.update_map=int_,this.abs_=int_,this.tree_probs=new Array(MB_FEATURE_TREE_PROBS),this.lf_level=new Array(MAX_MB_SEGMENTS),this.quant_idx=new Array(MAX_MB_SEGMENTS)};var BLOCK_CONTEXTS=4;var vp8_loopfilter_hdr=function(){this.use_simple=int_,this.level=int_,this.sharpness=int_,this.delta_enabled=int_,this.ref_delta=new Array(BLOCK_CONTEXTS),this.mode_delta=new Array(BLOCK_CONTEXTS)};var MAX_PARTITIONS=8;var vp8_token_hdr=function(){this.partitions=int_,this.partition_sz=new Array(MAX_PARTITIONS)};var vp8_quant_hdr=function(){this.q_index=int_,this.delta_update=int_,this.y1_dc_delta_q=int_,this.y2_dc_delta_q=int_,this.y2_ac_delta_q=int_,this.uv_dc_delta_q=int_,this.uv_ac_delta_q=int_};var vp8_reference_hdr=function(){this.refresh_last=int_,this.refresh_gf=int_,this.refresh_arf=int_,this.copy_gf=int_,this.copy_arf=int_,this.sign_bias=new Array(4),this.refresh_entropy=int_};var BLOCK_TYPES=4,PREV_COEF_CONTEXTS=3,COEF_BANDS=8,ENTROPY_NODES=11;var coeff_probs_table_t=function(){return ArrM(new Array(BLOCK_TYPES,COEF_BANDS,PREV_COEF_CONTEXTS,ENTROPY_NODES),char_)};var MV_PROB_CNT=2+8-1+10;var mv_component_probs_t=function(){return new Array(MV_PROB_CNT)};var Arr_1056=Arr(1056,0);var vp8_entropy_hdr=function(){this.coeff_probs=new coeff_probs_table_t,this.coeff_probs_=Arr(1056,0),this.mv_probs=Arr_new(2,mv_component_probs_t),this.coeff_skip_enabled=int_,this.coeff_skip_prob=char_,this.y_mode_probs=new Array(0,0,0,0),this.uv_mode_probs=new Array(0,0,0),this.prob_inter=char_,this.prob_last=char_,this.prob_gf=char_};var CURRENT_FRAME=0,LAST_FRAME=1,GOLDEN_FRAME=2,ALTREF_FRAME=3,NUM_REF_FRAMES=4;var filter_t=function(){return new Array(6)};var mv=function(){this.d={x:int16_t,y:int16_t}};var mb_base_info=function(){this.y_mode=char_,this.uv_mode=char_,this.segment_id=char_,this.ref_frame=char_,this.skip_coeff=char_,this.need_mc_border=char_,this.partitioning=null,this.mv=new mv,this.eob_mask=int_};var mb_info=function(){this.base=new mb_base_info,this.splitt=new Object({mvs:Arr_new(16,mv),modes:new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)})};var token_entropy_ctx_t=function(){return new Array(4+2+2+1)};var token_decoder=function(){this.bool=new bool_decoder,this.left_token_entropy_ctx=new token_entropy_ctx_t,this.coeffs=short_};var TOKEN_BLOCK_Y1=0,TOKEN_BLOCK_UV=1,TOKEN_BLOCK_Y2=2,TOKEN_BLOCK_TYPES=3;var dequant_factors=function(){this.quant_idx=int_,this.factor=ArrM(new Array(TOKEN_BLOCK_TYPES,2),short_)};var ref_cnt_img=function(){this.img=new vpx_image_t,this.ref_cnt=int_};var vp8_decoder_ctx=function(){this.error=[],this.frame_cnt=int_,this.frame_hdr=new vp8_frame_hdr,this.segment_hdr=new vp8_segment_hdr,this.loopfilter_hdr=new vp8_loopfilter_hdr,this.token_hdr=new vp8_token_hdr,this.quant_hdr=new vp8_quant_hdr,this.reference_hdr=new vp8_reference_hdr,this.entropy_hdr=new vp8_entropy_hdr,this.saved_entropy=new vp8_entropy_hdr,this.saved_entropy_valid=int_,this.mb_rows=int_,this.mb_cols=int_,this.mb_info_storage=null,this.mb_info_storage_off=0,this.mb_info_storage_object=mb_info,this.mb_info_rows_storage=null,this.mb_info_rows_storage_off=0,this.mb_info_rows_storage_object=mb_info,this.mb_info_rows=null,this.mb_info_rows_off=0,this.above_token_entropy_ctx=null,this.above_token_entropy_ctx_object=token_entropy_ctx_t,this.tokens=Arr_new(MAX_PARTITIONS,token_decoder),this.dequant_factors=Arr_new(MAX_MB_SEGMENTS,dequant_factors),this.frame_strg=Arr_new(NUM_REF_FRAMES,ref_cnt_img),this.ref_frames=Arr_new(NUM_REF_FRAMES,ref_cnt_img),this.ref_frame_offsets=new Array(0,0,0,0),this.ref_frame_offsets_=new Array(0,0,0,0),this.subpixel_filters=new filter_t};var cospi8sqrt2minus1=20091;var sinpi8sqrt2=35468;var tmp_2=Arr(16,0);var k_coeff_entropy_update_probs=new Array(new Array(new Array(new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(176,246,255,255,255,255,255,255,255,255,255),new Array(223,241,252,255,255,255,255,255,255,255,255),new Array(249,253,253,255,255,255,255,255,255,255,255)),new Array(new Array(255,244,252,255,255,255,255,255,255,255,255),new Array(234,254,254,255,255,255,255,255,255,255,255),new Array(253,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,246,254,255,255,255,255,255,255,255,255),new Array(239,253,254,255,255,255,255,255,255,255,255),new Array(254,255,254,255,255,255,255,255,255,255,255)),new Array(new Array(255,248,254,255,255,255,255,255,255,255,255),new Array(251,255,254,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,253,254,255,255,255,255,255,255,255,255),new Array(251,254,254,255,255,255,255,255,255,255,255),new Array(254,255,254,255,255,255,255,255,255,255,255)),new Array(new Array(255,254,253,255,254,255,255,255,255,255,255),new Array(250,255,254,255,254,255,255,255,255,255,255),new Array(254,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255))),new Array(new Array(new Array(217,255,255,255,255,255,255,255,255,255,255),new Array(225,252,241,253,255,255,254,255,255,255,255),new Array(234,250,241,250,253,255,253,254,255,255,255)),new Array(new Array(255,254,255,255,255,255,255,255,255,255,255),new Array(223,254,254,255,255,255,255,255,255,255,255),new Array(238,253,254,254,255,255,255,255,255,255,255)),new Array(new Array(255,248,254,255,255,255,255,255,255,255,255),new Array(249,254,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,253,255,255,255,255,255,255,255,255,255),new Array(247,254,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,253,254,255,255,255,255,255,255,255,255),new Array(252,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,254,254,255,255,255,255,255,255,255,255),new Array(253,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,254,253,255,255,255,255,255,255,255,255),new Array(250,255,255,255,255,255,255,255,255,255,255),new Array(254,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255))),new Array(new Array(new Array(186,251,250,255,255,255,255,255,255,255,255),new Array(234,251,244,254,255,255,255,255,255,255,255),new Array(251,251,243,253,254,255,254,255,255,255,255)),new Array(new Array(255,253,254,255,255,255,255,255,255,255,255),new Array(236,253,254,255,255,255,255,255,255,255,255),new Array(251,253,253,254,254,255,255,255,255,255,255)),new Array(new Array(255,254,254,255,255,255,255,255,255,255,255),new Array(254,254,254,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,254,255,255,255,255,255,255,255,255,255),new Array(254,254,255,255,255,255,255,255,255,255,255),new Array(254,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(254,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255))),new Array(new Array(new Array(248,255,255,255,255,255,255,255,255,255,255),new Array(250,254,252,254,255,255,255,255,255,255,255),new Array(248,254,249,253,255,255,255,255,255,255,255)),new Array(new Array(255,253,253,255,255,255,255,255,255,255,255),new Array(246,253,253,255,255,255,255,255,255,255,255),new Array(252,254,251,254,254,255,255,255,255,255,255)),new Array(new Array(255,254,252,255,255,255,255,255,255,255,255),new Array(248,254,253,255,255,255,255,255,255,255,255),new Array(253,255,254,254,255,255,255,255,255,255,255)),new Array(new Array(255,251,254,255,255,255,255,255,255,255,255),new Array(245,251,254,255,255,255,255,255,255,255,255),new Array(253,253,254,255,255,255,255,255,255,255,255)),new Array(new Array(255,251,253,255,255,255,255,255,255,255,255),new Array(252,253,254,255,255,255,255,255,255,255,255),new Array(255,254,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,252,255,255,255,255,255,255,255,255,255),new Array(249,255,254,255,255,255,255,255,255,255,255),new Array(255,255,254,255,255,255,255,255,255,255,255)),new Array(new Array(255,255,253,255,255,255,255,255,255,255,255),new Array(250,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255)),new Array(new Array(255,255,255,255,255,255,255,255,255,255,255),new Array(254,255,255,255,255,255,255,255,255,255,255),new Array(255,255,255,255,255,255,255,255,255,255,255))));var k_default_y_mode_probs=new Array(112,86,140,37);var k_default_uv_mode_probs=new Array(162,101,204);var k_default_coeff_probs=new Array(new Array(new Array(new Array(128,128,128,128,128,128,128,128,128,128,128),new Array(128,128,128,128,128,128,128,128,128,128,128),new Array(128,128,128,128,128,128,128,128,128,128,128)),new Array(new Array(253,136,254,255,228,219,128,128,128,128,128),new Array(189,129,242,255,227,213,255,219,128,128,128),new Array(106,126,227,252,214,209,255,255,128,128,128)),new Array(new Array(1,98,248,255,236,226,255,255,128,128,128),new Array(181,133,238,254,221,234,255,154,128,128,128),new Array(78,134,202,247,198,180,255,219,128,128,128)),new Array(new Array(1,185,249,255,243,255,128,128,128,128,128),new Array(184,150,247,255,236,224,128,128,128,128,128),new Array(77,110,216,255,236,230,128,128,128,128,128)),new Array(new Array(1,101,251,255,241,255,128,128,128,128,128),new Array(170,139,241,252,236,209,255,255,128,128,128),new Array(37,116,196,243,228,255,255,255,128,128,128)),new Array(new Array(1,204,254,255,245,255,128,128,128,128,128),new Array(207,160,250,255,238,128,128,128,128,128,128),new Array(102,103,231,255,211,171,128,128,128,128,128)),new Array(new Array(1,152,252,255,240,255,128,128,128,128,128),new Array(177,135,243,255,234,225,128,128,128,128,128),new Array(80,129,211,255,194,224,128,128,128,128,128)),new Array(new Array(1,1,255,128,128,128,128,128,128,128,128),new Array(246,1,255,128,128,128,128,128,128,128,128),new Array(255,128,128,128,128,128,128,128,128,128,128))),new Array(new Array(new Array(198,35,237,223,193,187,162,160,145,155,62),new Array(131,45,198,221,172,176,220,157,252,221,1),new Array(68,47,146,208,149,167,221,162,255,223,128)),new Array(new Array(1,149,241,255,221,224,255,255,128,128,128),new Array(184,141,234,253,222,220,255,199,128,128,128),new Array(81,99,181,242,176,190,249,202,255,255,128)),new Array(new Array(1,129,232,253,214,197,242,196,255,255,128),new Array(99,121,210,250,201,198,255,202,128,128,128),new Array(23,91,163,242,170,187,247,210,255,255,128)),new Array(new Array(1,200,246,255,234,255,128,128,128,128,128),new Array(109,178,241,255,231,245,255,255,128,128,128),new Array(44,130,201,253,205,192,255,255,128,128,128)),new Array(new Array(1,132,239,251,219,209,255,165,128,128,128),new Array(94,136,225,251,218,190,255,255,128,128,128),new Array(22,100,174,245,186,161,255,199,128,128,128)),new Array(new Array(1,182,249,255,232,235,128,128,128,128,128),new Array(124,143,241,255,227,234,128,128,128,128,128),new Array(35,77,181,251,193,211,255,205,128,128,128)),new Array(new Array(1,157,247,255,236,231,255,255,128,128,128),new Array(121,141,235,255,225,227,255,255,128,128,128),new Array(45,99,188,251,195,217,255,224,128,128,128)),new Array(new Array(1,1,251,255,213,255,128,128,128,128,128),new Array(203,1,248,255,255,128,128,128,128,128,128),new Array(137,1,177,255,224,255,128,128,128,128,128))),new Array(new Array(new Array(253,9,248,251,207,208,255,192,128,128,128),new Array(175,13,224,243,193,185,249,198,255,255,128),new Array(73,17,171,221,161,179,236,167,255,234,128)),new Array(new Array(1,95,247,253,212,183,255,255,128,128,128),new Array(239,90,244,250,211,209,255,255,128,128,128),new Array(155,77,195,248,188,195,255,255,128,128,128)),new Array(new Array(1,24,239,251,218,219,255,205,128,128,128),new Array(201,51,219,255,196,186,128,128,128,128,128),new Array(69,46,190,239,201,218,255,228,128,128,128)),new Array(new Array(1,191,251,255,255,128,128,128,128,128,128),new Array(223,165,249,255,213,255,128,128,128,128,128),new Array(141,124,248,255,255,128,128,128,128,128,128)),new Array(new Array(1,16,248,255,255,128,128,128,128,128,128),new Array(190,36,230,255,236,255,128,128,128,128,128),new Array(149,1,255,128,128,128,128,128,128,128,128)),new Array(new Array(1,226,255,128,128,128,128,128,128,128,128),new Array(247,192,255,128,128,128,128,128,128,128,128),new Array(240,128,255,128,128,128,128,128,128,128,128)),new Array(new Array(1,134,252,255,255,128,128,128,128,128,128),new Array(213,62,250,255,255,128,128,128,128,128,128),new Array(55,93,255,128,128,128,128,128,128,128,128)),new Array(new Array(128,128,128,128,128,128,128,128,128,128,128),new Array(128,128,128,128,128,128,128,128,128,128,128),new Array(128,128,128,128,128,128,128,128,128,128,128))),new Array(new Array(new Array(202,24,213,235,186,191,220,160,240,175,255),new Array(126,38,182,232,169,184,228,174,255,187,128),new Array(61,46,138,219,151,178,240,170,255,216,128)),new Array(new Array(1,112,230,250,199,191,247,159,255,255,128),new Array(166,109,228,252,211,215,255,174,128,128,128),new Array(39,77,162,232,172,180,245,178,255,255,128)),new Array(new Array(1,52,220,246,198,199,249,220,255,255,128),new Array(124,74,191,243,183,193,250,221,255,255,128),new Array(24,71,130,219,154,170,243,182,255,255,128)),new Array(new Array(1,182,225,249,219,240,255,224,128,128,128),new Array(149,150,226,252,216,205,255,171,128,128,128),new Array(28,108,170,242,183,194,254,223,255,255,128)),new Array(new Array(1,81,230,252,204,203,255,192,128,128,128),new Array(123,102,209,247,188,196,255,233,128,128,128),new Array(20,95,153,243,164,173,255,203,128,128,128)),new Array(new Array(1,222,248,255,216,213,128,128,128,128,128),new Array(168,175,246,252,235,205,255,255,128,128,128),new Array(47,116,215,255,211,212,255,255,128,128,128)),new Array(new Array(1,121,236,253,212,214,255,255,128,128,128),new Array(141,84,213,252,201,202,255,219,128,128,128),new Array(42,80,160,240,162,185,255,205,128,128,128)),new Array(new Array(1,1,255,128,128,128,128,128,128,128,128),new Array(244,1,255,128,128,128,128,128,128,128,128),new Array(238,1,255,128,128,128,128,128,128,128,128))));var k_mv_entropy_update_probs=new Array(new Array(237,246,253,253,254,254,254,254,254,254,254,254,254,254,250,250,252,254,254),new Array(231,243,245,253,254,254,254,254,254,254,254,254,254,254,251,251,254,254,254));var k_default_mv_probs=function(){return new Array(new Array(162,128,225,146,172,147,214,39,156,128,129,132,75,145,178,206,239,254,254),new Array(164,128,204,170,119,235,140,230,228,128,130,130,74,148,180,203,236,254,254))};var dc_q_lookup=new Array(4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157);var ac_q_lookup=new Array(4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284);var kf_y_mode_probs=new Array(145,156,163,128);var kf_uv_mode_probs=new Array(142,114,183);var kf_b_mode_probs=new Array(new Array(new Array(231,120,48,89,115,113,120,152,112),new Array(152,179,64,126,170,118,46,70,95),new Array(175,69,143,80,85,82,72,155,103),new Array(56,58,10,171,218,189,17,13,152),new Array(144,71,10,38,171,213,144,34,26),new Array(114,26,17,163,44,195,21,10,173),new Array(121,24,80,195,26,62,44,64,85),new Array(170,46,55,19,136,160,33,206,71),new Array(63,20,8,114,114,208,12,9,226),new Array(81,40,11,96,182,84,29,16,36)),new Array(new Array(134,183,89,137,98,101,106,165,148),new Array(72,187,100,130,157,111,32,75,80),new Array(66,102,167,99,74,62,40,234,128),new Array(41,53,9,178,241,141,26,8,107),new Array(104,79,12,27,217,255,87,17,7),new Array(74,43,26,146,73,166,49,23,157),new Array(65,38,105,160,51,52,31,115,128),new Array(87,68,71,44,114,51,15,186,23),new Array(47,41,14,110,182,183,21,17,194),new Array(66,45,25,102,197,189,23,18,22)),new Array(new Array(88,88,147,150,42,46,45,196,205),new Array(43,97,183,117,85,38,35,179,61),new Array(39,53,200,87,26,21,43,232,171),new Array(56,34,51,104,114,102,29,93,77),new Array(107,54,32,26,51,1,81,43,31),new Array(39,28,85,171,58,165,90,98,64),new Array(34,22,116,206,23,34,43,166,73),new Array(68,25,106,22,64,171,36,225,114),new Array(34,19,21,102,132,188,16,76,124),new Array(62,18,78,95,85,57,50,48,51)),new Array(new Array(193,101,35,159,215,111,89,46,111),new Array(60,148,31,172,219,228,21,18,111),new Array(112,113,77,85,179,255,38,120,114),new Array(40,42,1,196,245,209,10,25,109),new Array(100,80,8,43,154,1,51,26,71),new Array(88,43,29,140,166,213,37,43,154),new Array(61,63,30,155,67,45,68,1,209),new Array(142,78,78,16,255,128,34,197,171),new Array(41,40,5,102,211,183,4,1,221),new Array(51,50,17,168,209,192,23,25,82)),new Array(new Array(125,98,42,88,104,85,117,175,82),new Array(95,84,53,89,128,100,113,101,45),new Array(75,79,123,47,51,128,81,171,1),new Array(57,17,5,71,102,57,53,41,49),new Array(115,21,2,10,102,255,166,23,6),new Array(38,33,13,121,57,73,26,1,85),new Array(41,10,67,138,77,110,90,47,114),new Array(101,29,16,10,85,128,101,196,26),new Array(57,18,10,102,102,213,34,20,43),new Array(117,20,15,36,163,128,68,1,26)),new Array(new Array(138,31,36,171,27,166,38,44,229),new Array(67,87,58,169,82,115,26,59,179),new Array(63,59,90,180,59,166,93,73,154),new Array(40,40,21,116,143,209,34,39,175),new Array(57,46,22,24,128,1,54,17,37),new Array(47,15,16,183,34,223,49,45,183),new Array(46,17,33,183,6,98,15,32,183),new Array(65,32,73,115,28,128,23,128,205),new Array(40,3,9,115,51,192,18,6,223),new Array(87,37,9,115,59,77,64,21,47)),new Array(new Array(104,55,44,218,9,54,53,130,226),new Array(64,90,70,205,40,41,23,26,57),new Array(54,57,112,184,5,41,38,166,213),new Array(30,34,26,133,152,116,10,32,134),new Array(75,32,12,51,192,255,160,43,51),new Array(39,19,53,221,26,114,32,73,255),new Array(31,9,65,234,2,15,1,118,73),new Array(88,31,35,67,102,85,55,186,85),new Array(56,21,23,111,59,205,45,37,192),new Array(55,38,70,124,73,102,1,34,98)),new Array(new Array(102,61,71,37,34,53,31,243,192),new Array(69,60,71,38,73,119,28,222,37),new Array(68,45,128,34,1,47,11,245,171),new Array(62,17,19,70,146,85,55,62,70),new Array(75,15,9,9,64,255,184,119,16),new Array(37,43,37,154,100,163,85,160,1),new Array(63,9,92,136,28,64,32,201,85),new Array(86,6,28,5,64,255,25,248,1),new Array(56,8,17,132,137,255,55,116,128),new Array(58,15,20,82,135,57,26,121,40)),new Array(new Array(164,50,31,137,154,133,25,35,218),new Array(51,103,44,131,131,123,31,6,158),new Array(86,40,64,135,148,224,45,183,128),new Array(22,26,17,131,240,154,14,1,209),new Array(83,12,13,54,192,255,68,47,28),new Array(45,16,21,91,64,222,7,1,197),new Array(56,21,39,155,60,138,23,102,213),new Array(85,26,85,85,128,128,32,146,171),new Array(18,11,7,63,144,171,4,4,246),new Array(35,27,10,146,174,171,12,26,128)),new Array(new Array(190,80,35,99,180,80,126,54,45),new Array(85,126,47,87,176,51,41,20,32),new Array(101,75,128,139,118,146,116,128,85),new Array(56,41,15,176,236,85,37,9,62),new Array(146,36,19,30,171,255,97,27,20),new Array(71,30,17,119,118,255,17,18,138),new Array(101,38,60,138,55,70,43,26,142),new Array(138,45,61,62,219,1,81,188,64),new Array(32,41,20,117,151,142,20,21,163),new Array(112,19,12,61,195,128,48,4,24)));var kf_y_mode_tree=new Array(-B_PRED,2,4,6,-DC_PRED,-V_PRED,-H_PRED,-TM_PRED);var y_mode_tree=new Array(-DC_PRED,2,4,6,-V_PRED,-H_PRED,-TM_PRED,-B_PRED);var uv_mode_tree=new Array(-DC_PRED,2,-V_PRED,4,-H_PRED,-TM_PRED);var b_mode_tree=new Array(-B_DC_PRED,2,-B_TM_PRED,4,-B_VE_PRED,6,8,12,-B_HE_PRED,10,-B_RD_PRED,-B_VR_PRED,-B_LD_PRED,14,-B_VL_PRED,16,-B_HD_PRED,-B_HU_PRED);var small_mv_tree=new Array(2,8,4,6,-0,-1,-2,-3,10,12,-4,-5,-6,-7);var mv_ref_tree=new Array(-ZEROMV,2,-NEARESTMV,4,-NEARMV,6,-NEWMV,-SPLITMV);var submv_ref_tree=new Array(-LEFT4X4,2,-ABOVE4X4,4,-ZERO4X4,-NEW4X4);var split_mv_tree=new Array(-3,2,-2,4,-0,-1);var default_b_mode_probs=new Array(120,90,79,133,87,85,80,111,151);var mv_counts_to_probs=new Array(new Array(7,1,1,143),new Array(14,18,14,107),new Array(135,64,57,68),new Array(60,56,128,65),new Array(159,134,128,34),new Array(234,188,128,28));var split_mv_probs=new Array(110,111,150);var submv_ref_probs2=new Array(new Array(147,136,18),new Array(106,145,1),new Array(179,121,1),new Array(223,1,34),new Array(208,1,1));var mv_partitions=new Array(new Array(0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1),new Array(0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1),new Array(0,0,1,1,0,0,1,1,2,2,3,3,2,2,3,3),new Array(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15));var mv_clamp_rect=function(){this.to_left=int_,this.to_right=int_,this.to_top=int_,this.to_bottom=int_};var CNT_BEST=0,CNT_ZEROZERO=0,CNT_NEAREST=1,CNT_NEAR=2,CNT_SPLITMV=3;var this_mv_1=new mv;var this_mv_2=new mv;var near_mvs_4=Arr_new(4,mv),mv_cnts_4=new Array(0,0,0,0);var probs_4=new Array(0,0,0,0);var chroma_mv_4=Arr_new(4,mv);var clamped_best_mv_1=new mv;var bounds_=new mv_clamp_rect;var EOB_CONTEXT_NODE=0,ZERO_CONTEXT_NODE=1,ONE_CONTEXT_NODE=2,LOW_VAL_CONTEXT_NODE=3,TWO_CONTEXT_NODE=4,THREE_CONTEXT_NODE=5,HIGH_LOW_CONTEXT_NODE=6,CAT_ONE_CONTEXT_NODE=7,CAT_THREEFOUR_CONTEXT_NODE=8,CAT_THREE_CONTEXT_NODE=9,CAT_FIVE_CONTEXT_NODE=10;var ZERO_TOKEN=0,ONE_TOKEN=1,TWO_TOKEN=2,THREE_TOKEN=3,FOUR_TOKEN=4,DCT_VAL_CATEGORY1=5,DCT_VAL_CATEGORY2=6,DCT_VAL_CATEGORY3=7,DCT_VAL_CATEGORY4=8,DCT_VAL_CATEGORY5=9,DCT_VAL_CATEGORY6=10,DCT_EOB_TOKEN=11,MAX_ENTROPY_TOKENS=12;var left_context_index=new Array(0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,5,5,6,6,7,7,8);var above_context_index=new Array(0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,4,5,6,7,6,7,8);var bands_x=new Array(X(0),X(1),X(2),X(3),X(6),X(4),X(5),X(6),X(6),X(6),X(6),X(6),X(6),X(6),X(6),X(7));var extrabits=new Array({min_val:0,length:-1,probs:new Array(0,0,0,0,0,0,0,0,0,0,0,0)},{min_val:1,length:0,probs:new Array(0,0,0,0,0,0,0,0,0,0,0,0)},{min_val:2,length:0,probs:new Array(0,0,0,0,0,0,0,0,0,0,0,0)},{min_val:3,length:0,probs:new Array(0,0,0,0,0,0,0,0,0,0,0,0)},{min_val:4,length:0,probs:new Array(0,0,0,0,0,0,0,0,0,0,0,0)},{min_val:5,length:0,probs:new Array(159,0,0,0,0,0,0,0,0,0,0,0)},{min_val:7,length:1,probs:new Array(145,165,0,0,0,0,0,0,0,0,0,0)},{min_val:11,length:2,probs:new Array(140,148,173,0,0,0,0,0,0,0,0,0)},{min_val:19,length:3,probs:new Array(135,140,155,176,0,0,0,0,0,0,0,0)},{min_val:35,length:4,probs:new Array(130,134,141,157,180,0,0,0,0,0,0,0)},{min_val:67,length:10,probs:new Array(129,130,133,140,153,177,196,230,243,254,254,0)},{min_val:0,length:-1,probs:new Array(0,0,0,0,0,0,0,0,0,0,0,0)});var zigzag=new Array(0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15);var BLOCK_LOOP=0,DO_WHILE=1,CHECK_0_=2,CAT_FIVE_CONTEXT_NODE_0_=3,CAT_THREEFOUR_CONTEXT_NODE_0_=4,CAT_THREE_CONTEXT_NODE_0_=5,HIGH_LOW_CONTEXT_NODE_0_=6,CAT_ONE_CONTEXT_NODE_0_=7,LOW_VAL_CONTEXT_NODE_0_=8,THREE_CONTEXT_NODE_0_=9,TWO_CONTEXT_NODE_0_=10,ONE_CONTEXT_NODE_0_=11,BLOCK_FINISHED=12,END=13;var BORDER_PIXELS=16;var sixtap_filters=new Array(new Array(0,0,128,0,0,0),new Array(0,-6,123,12,-1,0),new Array(2,-11,108,36,-8,1),new Array(0,-9,93,50,-6,0),new Array(3,-16,77,77,-16,3),new Array(0,-6,50,93,-9,0),new Array(1,-8,36,108,-11,2),new Array(0,-1,12,123,-6,0));var bilinear_filters=new Array(new Array(0,0,128,0,0,0),new Array(0,0,112,16,0,0),new Array(0,0,96,32,0,0),new Array(0,0,80,48,0,0),new Array(0,0,64,64,0,0),new Array(0,0,48,80,0,0),new Array(0,0,32,96,0,0),new Array(0,0,16,112,0,0));var tmp_4=new Array(0,0,0,0);var y2_16=Arr(16,0);var temp_=new Array(16*(16+5));var img_index=function(){this.y=char_,this.u=char_,this.v=char_,this.y_off=0,this.u_off=0,this.v_off=0,this.stride=int_,this.uv_stride=int_};var uvmv_1=new mv;var uvmv_2=new mv;var img_1=new img_index;var FRAME_HEADER_SZ=3,KEYFRAME_HEADER_SZ=7;var bool_1=new bool_decoder;var vpx_codec_alg_priv=function(){decoder_ctx=new vp8_decoder_ctx,img=new vpx_image_t,img_avail=int_};var ctf_maps=create_obj_vals_from_arrayChilds(vpx_codec_ctrl_fn_map_t,[[-1,null]]);CODEC_INTERFACE("vpx_codec_vp8_dx",new Array('VP8 "Dixie" Decoder'+VERSION_STRING,VPX_CODEC_INTERNAL_ABI_VERSION,VPX_CODEC_CAP_DECODER,"vp8_init","vp8_destroy","ctf_maps",null,null,new Array("vp8_peek_si","vp8_get_si","vp8_decode","vp8_get_frame")));window["webmdata"]=webmdata;var VP8_FOURCC=3690582;var ifaces=new Array({name:char_,iface:0,fourcc:int_,fourcc_mask:int_});ifaces[0]={name:"vp8",iface:new vpx_codec_vp8_dx_algo,fourcc:VP8_FOURCC,fourcc_mask:16777215};var RAW_FILE=0,IVF_FILE=1,WEBM_FILE=2;var IVF_FRAME_HDR_SZ=4+8;var RAW_FRAME_HDR_SZ=4;var input_ctx=function(){this.kind=0,this.infile=0,this.nestegg_ctx=new nestegg,this.pkt=[null],this.chunk=int_,this.chunks=[int_],this.video_track=int_};var myInterval