KISSY.add("tbc/search-suggest/1.4.8/mods/storage",function(e,a,t,r){function s(e){return i||(s.superclass.constructor.call(this,e||{}),i=this,i.initialize()),i}var i;return s.ATTRS={src:{value:location.protocol+"//g.alicdn.com/tbc/search-suggest/1.3.7/storage.swf"},bridge:{value:null},hasInit:{value:!1}},KISSY.extend(s,a,{initialize:function(e){e=e||{};var a=this;try{a._addFlash(e.appendTo),a.hasInit=!0}catch(t){KISSY.log(t.message)}},_saveToArr:function(e,a){var t=this.lazyArr||[];t.push({func:e,args:a}),this.lazyArr=t},_addFlash:function(e){var a,t=this,r=document,s=r.createElement("div"),i=t.get("src"),o="";window.__StorageIsReady=function(e){t.isLoaded=!0;var a=t.lazyArr;KISSY.each(a,function(e){e.func.apply(t,e.args)})},s.id="storagetool",s.style.height=0,s.style.overflow="hidden",o+='<object id="J_StorageObj" name="J_StorageObj" ',o+='classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1" ',o+='codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">',o+='<param name="movie" value="'+i+'" />',o+='<param name="allowScriptAccess" value="always" />',o+='<embed name="J_StorageEmbed" src="'+i+'" width="1" height="1" ',o+='allowScriptAccess="always" type="application/x-shockwave-flash" ',o+='pluginspage="http://www.adobe.com/go/getflashplayer">',o+="</embed></object>",e=e||r.body,e.appendChild(s),s.innerHTML=o,-1!==navigator.appVersion.indexOf("MSIE")?(s.style.zoom=1,s.style.filter="alpha(opacity=10)",a=window.J_StorageObj):(s.style.opacity=.1,a=r.J_StorageEmbed),t.set("bridge",a)},save:function(e,a,r,s){var i=this,o=i.get("bridge");if(!i.isLoaded)return void i._saveToArr(arguments.callee,arguments);try{return o.save(e,a),o.read(e)?t.parse(o.read(e)).length:(r&&r.onSuccess(val),0)}catch(n){r&&r.onFailure&&r.onFailure(n)}},read:function(e,a,t){var r,s=this,i=s.get("bridge");if(t=t||0,!s.isLoaded)return void s._saveToArr(arguments.callee,arguments);try{if(i.read)r=i.read(e),a&&a.onSuccess(r);else{if(200===t)return void(a&&a.onFailure&&a.onFailure(o));setTimeout(function(){s.read(e,a,t+1)},500)}return r}catch(o){a&&a.onFailure&&a.onFailure(o)}}}),s},{requires:["base","json"]});