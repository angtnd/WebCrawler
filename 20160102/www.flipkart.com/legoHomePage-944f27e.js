if(typeof(FKART)=="undefined"){FKART={}}FKART.AppOffer=new function(){var a=[],b=[];this.clearList=function(){a=[];b=[];fk_appoffer.updateTopBanner()};this.addAppOnly=function(c){if(a.indexOf(c)==-1){a.push(c);fk_appoffer.updateTopBanner()}};this.addOpenFsn=function(c){if(b.indexOf(c)==-1){b.push(c);fk_appoffer.updateTopBanner()}};this.updateTopBanner=function(){var e=$("#fk-header"),f=$(".fk-header-banner"),d=$(".apponly-text-some",f),g=$(".apponly-text-all",f),c=$(".apponly-text-default",f);if(a.length===0&&c.length===0){e.removeClass("banner-open");f.slideUp("slow")}else{if(!e.hasClass("banner-open")){e.addClass("banner-open");f.slideDown("slow")}if(a.length===0){d.hide();g.hide();c.show()}else{if(b.length===0){d.hide();g.show();c.hide()}else{d.show();g.hide();c.hide()}}}};this.updateUrl=function(){$(".fk-header-banner .app-link, .product-openx-ad .app-link, .facetList .app-link").data("url",window.location.pathname+window.location.search);$(".fk-header-banner .app-link, .product-openx-ad .app-link, .facetList .app-link").data("title","Get extra offers only on app");$(".fk-header-banner .app-link, .product-openx-ad .app-link, .facetList .app-link").data("subtitle","Tap to view special offer only on the app");var c=$(".fk-header-banner .app-link");if((c.length===0||!c.data("query")||c.data("query").length===0)&&FKART.urlParser().get("sid")=="undefined"){c.hide()}else{c.show()}}};fk_appoffer=FKART.AppOffer;FKART.appOfferPopup=function(aO){var ac=$(aO),y=$(".app-link",ac),U=$(".app-offers-button",ac),av=$(".app-offers-container",ac),aB=$(".appOnlyDialog-popup-content",ac),ae=$(".fk-question-mark",ac),A,aM,aK,bb,ai,P,I,bd,aL,J,e,r,u,D,au,R,a1,aA,a0,Q,O,L,ad,q,b,al,w,a9,d,F=false,ap,o,aw,a3=false,aZ,aQ,aF,a8,j,aC,af,l,an,Z,aT,m,a,f,aa,a5=false,a7,g,aW,am,B,G,H,K,aq,a2,W,ao,ah,aV,Y,p,aN,ba,N="",at="",T=false,ay=false,M,aE,aS,aX,h;if(aB.length==0){aB=$("#fk-header .appOnlyDialog-popup-content")}if(aB.length==0){aB=$(".fk-mainfooter .appOnlyDialog-popup-content")}if(aB.length==0){aB=$(".appOnlyDialog-popup-content.forcedView")}function c(){U.on("click",function(){if(!T){a6("Opened");$(this).addClass("open");ae.text("X");setTimeout(function(){av.slideDown(200);T=true},150)}else{a6("Closed");av.slideUp(200,function(){U.removeClass("open");ae.text("?");T=false})}});y.on("click",function(be){if(!y.hasClass("disabled")){v($(this));a6("Clicked");bc();be.preventDefault()}})}function bc(){w=null;n();S();aY();t();ab();if(!FKART.login.isUserLoggedIn()){R.hide();aP()}else{if(a3==true){R.show();A.hide();Y=setTimeout(function(){F=true;$.ajax({url:"/lc/sendPushNotificationForAccount",data:{pid:a7,lid:g,sid:aW,query:am,offerid:aa,title:B,subtitle:G,vertical:H,url:K,useDataUrl:a5},type:"POST",dataType:"json",success:function(be){if(be.deviceFound&&be.notificationSent){aR()}else{aI()}},error:function(){aI()}})},7000)}else{aP();ax()}}}function ax(){$.ajax({url:"/lc/sendPushNotificationForAccount",data:{pid:a7,lid:g,sid:aW,query:am,offerid:aa,title:B,subtitle:G,vertical:H,url:K,useDataUrl:a5},type:"POST",dataType:"json",success:function(be){if(be.deviceFound&&be.notificationSent){P.show()}else{I.show()}},error:function(){I.show()}})}function a6(bf){var be={};if(bf=="Clicked"){be.products=s.products}var bg=new Array("eVar1","eVar2","eVar3","eVar4","eVar5","eVar11","eVar50","eVar55","eVar68","prop1","prop2","prop3","prop4","prop20","prop35");for(i in bg){if(typeof s[bg[i]]!="undefined"){be[bg[i]]=s[bg[i]]}if((bg[i]=="eVar55"||bg[i]=="eVar11")&&aq){be[bg[i]]=aq}if((bg[i]=="eVar68"||bg[i]=="prop20")&&a2){be[bg[i]]=a2}}be.prop21="OpenInApp_"+bf;FKART.omni.customEvent("App only offers",be)}function aR(){t();R.hide();if(W&&W.length>0){var be=$("<img>");be.attr("src",W);bd.append(be)}else{bd.remove()}aM.show();aG();a6("PNSent")}function aI(){t();R.hide();aL.show();a6("PNFailed")}function ab(){w=new FKART.ui.Dialog({showFooter:false,cssClass:"appOnlyDialog",body:aB.html(),destroyOnHide:true,width:"620px"});d=w.getContainer();R=d.find(".loadingDiv");A=d.find(".smsDiv");aM=d.find(".successDiv");aK=A.find(".stitle");ai=A.find(".footerLoggedIn");P=ai.find(".footerLoggedIn_autonotification_success");I=ai.find(".footerLoggedIn_autonotification_failure");bb=A.find(".footerNotLoggedIn");bd=aM.find(".phone-image span");aZ=d.find(".smsForm");a9=d.find(".successPrefixDiv");aL=d.find(".errorDiv");a1=d.find(".send-sms-fake-link");aA=d.find(".send-otp-fake-link");a0=d.find(".send-sms-link");Q=d.find(".send-otp-link");ad=d.find(".resend-sms-fake-link");q=d.find(".resend-otp-fake-link");b=d.find(".resend-sms-link");al=d.find(".resend-otp-link");p=d.find(".timer");aN=d.find(".timerResendSMS");ba=d.find(".timerResendOTPSMS");ap=d.find(".retry-notification");M=d.find(".otpForm");h=d.find(".js-doLogin");aS=d.find(".phoneNumber");aX=d.find(".otp-field");w.show();if(!FKART.login.isUserLoggedIn()){bb.show();ai.hide()}else{bb.hide();ai.show()}aJ()}function aJ(){d.on("beforeHide",function(be){n();S();aY();t()});h.on("click",function(){w.hide()});a0.on("click",function(){aM.hide();a9.show();aL.hide();aK.remove();if(!FKART.login.isUserLoggedIn()){bb.show();ai.hide()}else{bb.hide();ai.show();P.show()}aP();a6("PNExpired")});Q.on("click",function(){ak();aM.hide();a9.show();aL.hide();aK.remove();aP();a6("PNExpired")});ap.on("click",function(){w.hide();a3=true;bc();$status="PNTried";if(F){$status="PNReTried"}a6($status)});aS.on("keypress",function(bf){bf=bf||window.event;var be=bf.keyCode||bf.which;if(be==13){aF.trigger("click");bf.preventDefault()}});aX.on("keypress",function(bf){bf=bf||window.event;var be=bf.keyCode||bf.which;if(be==13){aQ.trigger("click");bf.preventDefault()}})}function z(be){return be}function ar(){m=f.val();an=l.val();a=a8.val();L=O.val();$.ajax({url:"/lc/verifyOtp",type:"POST",data:{user_id:an,otp_key:N,otp:m,pid:a7,lid:g,sid:aW,query:am,offerid:aa,title:B,subtitle:G,vertical:H,url:K,phoneNumber:an,useDataUrl:a5,marketingSMS:a,AppOffers:L},dataType:"html",success:function(be){be=JSON.parse(be);if(be.verifyOTPstatus=="false"){ag()}else{if(be.verifyOTPstatus=="true"&&be.isOtpVerified=="1"){if(be.smsStatus){aU()}else{aH()}}else{ag()}}},error:function(){ag()}})}function ak(){an=l.val();$.ajax({url:"/lc/generateOtp",type:"POST",data:{userId:an},dataType:"html",success:function(be){be=JSON.parse(be);if(be.generateOTPstatus=="false"){ag()}else{if(be.error_code=="1004"){C()}else{if(be.generateOTPstatus=="true"){N=be.otp_key;az()}else{ag()}}}},error:function(){ag()}})}function X(){an=l.val();$.ajax({url:"/lc/getVerifiedPhoneNumber",type:"POST",data:{phoneNumber:an,pid:a7,lid:g,sid:aW,query:am,offerid:aa,title:B,subtitle:G,vertical:H,url:K,phoneNumber:an,useDataUrl:a5,marketingSMS:a,AppOffers:L},dataType:"html",success:function(be){be=JSON.parse(be);if(be.errorMsg){E()}else{if(be.verifiedPhoneNumber){if(be.smsStatus){aU()}else{aH()}}else{ak()}}},error:function(){E()}})}function aU(){S();aY();aK.hide();j.hide();aC.hide();aZ.hide();M.hide();af.html(an);J.show();e.hide();ad.show();b.hide();k();a6("SMSSent")}function aH(){S();aY();e.hide();aK.hide();j.hide();aC.hide();aZ.hide();aL.hide();af.html(an);au.show();a6("SMSFailed")}function ag(){aY();S();aK.hide();j.hide();aC.hide();aZ.hide();aL.hide();af.html(an);e.hide();r.show();a6("OTPFailed")}function E(){S();aY();aK.hide();j.hide();aC.hide();aZ.hide();aL.hide();e.hide();r.hide();D.show();a6("SMSFailed")}function az(){aY();S();aK.hide();j.hide();aC.show();M.show();aZ.hide();af.html(an);e.show();q.show();al.hide();aj();a6("OTPSent")}function C(){u.show();aK.hide();j.hide();aC.hide();M.hide();aZ.hide();af.html(an);e.hide();q.hide();al.hide();a6("OTPFailed")}function aP(){l=aZ.find(".phoneNumber");f=M.find(".otp-field");an=FKART.login.userPhoneNumber;l.val(an);aF=aZ.find("input[type=button]");aQ=M.find("input[type=button]");a8=A.find("#marketingSMS");O=A.find("#AppDownload");j=A.find(".infoDiv");aC=A.find(".otpTitle");aK=A.find(".stitle");J=A.find(".smsSuccessDiv");e=A.find(".otpSuccessDiv");r=A.find(".otpErrorDiv");u=A.find(".otpErrorMsgDiv");D=A.find(".otpSendErrorDiv");au=A.find(".smsErrorDiv");o=A.find(".retry-sms");aw=A.find(".retry-otp");af=A.find(".phone_number");A.show();M.hide();aC.hide();w.reposition();V()}function V(){aF.on("click",function(be){an=l.val();if(!(/^[789]\d{9}$/.test(an))){l.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}X();be.preventDefault()});aQ.on("click",function(be){m=f.val();if(!(/^[0-9]{4,6}$/.test(m))){f.addClass("error").val("").attr("placeholder","Invalid OTP").focus();return}else{ar();aK.hide();J.hide();j.hide();au.hide();e.hide();aC.hide();M.hide();a6("SMSTried");be.preventDefault()}});o.on("click",function(){S();aY();aN.html("45");ba.html("60");aK.hide();J.hide();j.hide();aZ.hide();au.hide();X();a6("SMSReTried")});aw.on("click",function(){aY();S();ak();aN.html("45");ba.html("60");aC.show();J.hide();M.show();au.hide();a6("SMSReTried")})}function n(){clearInterval(ao);ao=null}function S(){clearInterval(ah);ah=null}function aY(){clearInterval(aV);aV=null}function t(){clearInterval(Y);Y=null}function aG(){ao=setInterval(function(){var be=parseInt(p.html());if(be==0){n();a1.hide();a0.show()}p.html(be-1)},1000)}function k(){ah=setInterval(function(){var be=parseInt(aN.html());if(be==0){S();aY();ad.hide();b.show()}aN.html(be-1)},1000)}function aj(){aV=setInterval(function(){var be=parseInt(ba.html());if(be==0){aY();S();q.hide();al.show()}ba.html(be-1)},1000)}function x(bf,be){if(bf.indexOf("?")!==-1){var bi=bf.split("?")[1];var bh=bi.split("&");for(var bg=0;bg<bh.length;bg++){var bj=bh[bg].split("=");if(bj[0]==be){return bj[1]}}}}function a4(){var be=FKART.urlParser().get("sid");if(be!="undefined"){return be}}function v(be){W=be.data("image");if(be.data("pid")){a7=be.data("pid").toString();H=be.data("vertical");if(be.data("lid")){g=be.data("lid").toString()}aa=be.data("offerid")}else{am=be.data("query");aW=a4();if(aW){H=("BROWSE_"+aW).toUpperCase()}else{if(be.data("vertical")){H=be.data("vertical")}else{H="BROWSE_SEARCH"}}if(be.data("url")){a7=x(be.data("url"),"pid");aW=x(be.data("url"),"sid");aa=x(be.data("url"),"offer");if(x(be.data("url"),"p[]")||be.data("url").indexOf("/~")){a5=true}}B=be.data("title");G=be.data("subtitle");K=be.data("url");if(be.attr("href")){aq=x(be.attr("href"),"icmpid");a2=x(be.attr("href"),"otracker")}}a3=false;F=false}function aD(){c()}aD()};register_controller("AppOffersCtrl",function(a){FKART.appOfferPopup(a)});FKART.showShutDownPopup=function(c){var b=(new Date()).getTime(),e=FKART.utils.localStorage.getObject("sdPopDetails")||{};function d(g){var f=new FKART.ui.Dialog({header:"Flipkart System Message",showFooter:false,body:c,cssClass:"desk-shut"});FKART.utils.localStorage.setObject("sdPopDetails",{timeStamp:g});f.show()}if(!jQuery.isEmptyObject(e)){var a=e.timeStamp+(24*60*60*1000);if(a<b){d(b)}}else{d(b)}};register_controller("ShutDownPopCtrl",function(a){FKART.showShutDownPopup(a)});FKART.appDownloadPopup=function(P){var u=$(P),r=$(".app-download",u),G,V,A,W,w,L,ac,ae,b,B,j,F,I,k,U,z,K,y,J,l,M,E=false,n="title",Y="subtitle",ad,X,v,a,N,D,m,d=false;function q(){r.click(function(af){if(!r.hasClass("disabled")){g("Clicked");R($(this));t();af.preventDefault()}})}function t(){ae=null;Z();f()}function g(ag){var af={};if(ag=="Clicked"){af.products=s.products}af.prop21="OpenInApp_"+ag;FKART.omni.customEvent("App only offers",af)}function H(){h();if(ad&&ad.length>0){var af=$("<img>");af.attr("src",ad);V.append(af)}else{V.remove()}C();g("PNSent")}function Q(){h();f();g("PNFailed")}function Z(){ae=new FKART.ui.Dialog({showFooter:false,cssClass:"appDownloadDialog",body:$(".appDownloadDialog-popup-content").html(),destroyOnHide:true,width:"620px"});b=ae.getContainer();w=b.find(".headerDiv");G=b.find(".smsDiv");F=b.find(".smsForm");L=b.find(".send-sms-fake-link");ac=b.find(".send-sms-link");m=b.find(".timer");B=b.find(".retry-notification");ae.show();e()}function e(){b.on("beforeHide",function(af){ab();h();E=false});ac.click(function(){f();g("PNExpired")});B.click(function(){ae.hide();t();g("PNReTried")})}function T(){l=J.val();if(!(/^[789]\d{9}$/.test(l))){J.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}else{$.ajax({url:"/lc/sendAppDownloadSMS",type:"POST",data:{title:n,subtitle:Y,phoneNumber:l,captchaText:z.val(),captchaId:K.attr("id")},dataType:"json",success:function(af){if(af.captchaStatus){if(af.smsStatus){S()}else{x()}}else{p()}},error:function(){x()}})}}function p(){o();z.addClass("error").val("").attr("placeholder","Invalid Captcha").focus()}function S(){k.hide();F.hide();y.html(l);A.show();g("SMSSent")}function x(){k.hide();F.hide();y.html(l);W.show();g("SMSFailed")}function f(){J=F.find(".phoneNumber");l=FKART.login.userPhoneNumber;J.val(l);I=F.find("input[type=submit]");k=G.find(".infoDiv");A=G.find(".smsSuccessDiv");W=G.find(".smsErrorDiv");j=G.find(".retry-sms");U=F.find(".captchaDiv");z=F.find(".captchaText");M=F.find(".refreshCaptcha");y=G.find(".phone_number");if(/^\d{10}$/.test(l)){E=true;o()}G.show();ae.reposition();O()}function O(){M.click(function(){o();z.val("").focus()});F.submit(function(af){T();g("SMSTried");af.preventDefault()});j.click(function(){k.show();F.show();A.hide();W.hide();z.removeClass("error").val("").attr("placeholder","Captcha text").focus();o();g("SMSReTried")});J.focus(function(){g("PhoneNumberFocused");if(!E){E=true;o()}})}function o(){$.ajax({url:"/lc/generateCaptcha",type:"POST",dataType:"json",success:function(af){if(af.success){K=U.find("img");K.attr("src","data:image/png;base64,"+af.captchaBytes);K.attr("id",af.id);U.show();z.show();K.load(function(){if(this.complete){ae.reposition()}})}else{U.find("img").attr("alt","Captcha failed to load")}},error:function(){U.find("img").attr("alt","Captcha failed to load")}})}function ab(){clearInterval(N);N=null}function h(){clearInterval(D);D=null}function C(){N=setInterval(function(){var af=parseInt(m.html());if(af==0){ab();L.hide();ac.show()}m.html(af-1)},1000)}function c(ag,af){var aj=ag.split("?")[1];var ai=aj.split("&");for(var ah=0;ah<ai.length;ah++){var ak=ai[ah].split("=");if(ak[0]==af){return ak[1]}}}function R(){$ele=window.location.href}function aa(){q()}aa()};register_controller("AppDownloadCtrl",function(a){FKART.appDownloadPopup(a)});register_controller("AppDownloadInterstitialCtrl",function(aI){var X=$(aI),y=$(".app-link-interstitial",X),Q=$(".app-offers-button",X),ao=$(".app-offers-container",X),av=$(".appDownloadInterstitial-popup-content",X),Z=$(".fk-question-mark",X),A,aG,aE,a2,ad,a4,aF,G,e,q,t,C,an,N,aU,au,aT,M,L,I,Y,o,b,ag,v,a0,d,E=false,ak,n,ap,aV=false,aS,aK,az,aO,h,aw,aa,k,ai,T,l,f,a,V,aX=false,aZ,g,aP,ah,aQ="title",x="subtitle",F,H,aj,ac,aN,U,p,aH,a1,P=false,K="",am="",P=false,ar=false,J,ay;if(av.length==0){av=$(".fk-mainfooter .appOnlyDialog-popup-content")}if(av.length==0){av=$(".appOnlyDialog-popup-content.forcedView")}function c(){Q.on("click",function(){if(!P){aY("Opened");$(this).addClass("open");Z.text("X");setTimeout(function(){ao.slideDown(200);P=true},150)}else{aY("Closed");ao.slideUp(200,function(){Q.removeClass("open");Z.text("?");P=false})}});y.on("click",function(a5){if(!y.hasClass("disabled")){aY("Clicked");u($(this));a3();a5.preventDefault()}});EventBus.subscribe("appDownloadInterstitialpopup",function(){u($(this));a3();FKART.utils.localStorage.setObject("sAppDownloadInterstitial",{sPopup:false})})}function a3(){v=null;W();aJ()}function aq(){$.ajax({url:"/lc/sendPushNotificationForAccount",data:{pid:aZ,lid:g,sid:aP,query:ah,offerid:V,title:title,subtitle:subtitle,vertical:F,url:H,useDataUrl:aX},type:"POST",dataType:"json"})}function aY(a6){var a5={};if(a6=="Clicked"){a5.products=s.products}var a7=new Array("eVar1","eVar2","eVar3","eVar4","eVar5","eVar50","prop1","prop2","prop3","prop4","prop35");for(i in a7){if(typeof s[a7[i]]!="undefined"){a5[a7[i]]=s[a7[i]]}}a5.prop21="OpenInApp_"+a6;FKART.omni.customEvent("App only offers",a5)}function aL(){r();N.hide();if(imageSrc&&imageSrc.length>0){var a5=$("<img>");a5.attr("src",imageSrc);a4.append(a5)}else{a4.remove()}aG.show();aA();aY("PNSent")}function aC(){r();N.hide();aF.show();aY("PNFailed")}function W(){v=new FKART.ui.Dialog({showFooter:false,cssClass:"appDownloadInterstitialDialog",body:av.html(),destroyOnHide:true,width:"730px"});d=v.getContainer();N=d.find(".loadingDiv");A=d.find(".smsDiv");aG=d.find(".successDiv");aE=A.find(".stitle");ad=A.find(".footerLoggedIn");a2=A.find(".footerNotLoggedIn");a4=aG.find(".phone-image span");aS=d.find(".smsForm");a0=d.find(".successPrefixDiv");aF=d.find(".errorDiv");aU=d.find(".send-sms-fake-link");aT=d.find(".send-sms-link");M=d.find(".send-otp-link");Y=d.find(".resend-sms-fake-link");o=d.find(".resend-otp-fake-link");b=d.find(".resend-sms-link");ag=d.find(".resend-otp-link");p=d.find(".timer");aH=d.find(".timerResendSMS");a1=d.find(".timerResendOTPSMS");ak=d.find(".retry-notification");J=d.find(".otpForm");v.show();if(!FKART.login.isUserLoggedIn()){a2.show();ad.hide()}else{a2.hide();ad.show()}aD()}function aD(){d.on("beforeHide",function(a5){m();O();r()});aT.on("click",function(){aG.hide();a0.show();aF.hide();aE.remove();aJ();aY("PNExpired")});M.on("click",function(){af();aG.hide();a0.show();aF.hide();aE.remove();aJ();aY("PNExpired")});ak.on("click",function(){v.hide();a3();$status="PNTried";if(E){$status="PNReTried"}aY($status)})}function z(a5){return a5}function al(){l=f.val();I=L.val();$.ajax({url:"/lc/verifyOtp",type:"POST",data:{user_id:ai,otp_key:K,otp:l,title:aQ,subtitle:x,phoneNumber:ai,marketingSMS:a,AppOffers:I},dataType:"html",success:function(a5){a5=JSON.parse(a5);if(a5.isOtpVerified=="1"){if(a5.smsStatus){aM()}else{aB()}}else{ab()}},error:function(){ab()}})}function af(){ai=k.val();$.ajax({url:"/lc/generateOtp",type:"POST",data:{userId:ai},dataType:"html",success:function(a5){a5=JSON.parse(a5);if(a5.error_code=="1004"){B()}else{K=a5.otp_key;at()}},error:function(){ab()}})}function S(){ai=k.val();$.ajax({url:"/lc/getVerifiedPhoneNumber",type:"POST",data:{phoneNumber:ai,title:aQ,subtitle:x,phoneNumber:ai,marketingSMS:a,AppOffers:I},dataType:"html",success:function(a5){a5=JSON.parse(a5);if(a5.verifiedPhoneNumber){if(a5.smsStatus){aM();aY("SMSTried");event.preventDefault()}else{aB();aY("SMSFailed");event.preventDefault()}}else{af();aY("OTPTried");event.preventDefault()}},error:function(){D()}})}function aM(){O();aR();aE.hide();h.hide();aw.hide();aS.hide();J.hide();aa.html(ai);G.show();e.hide();Y.show();b.hide();j();aY("SMSSent")}function aB(){O();aR();e.hide();aE.hide();h.hide();aw.hide();aS.hide();aF.hide();aa.html(ai);an.show();aY("SMSFailed")}function ab(){aR();O();aE.hide();h.hide();aw.hide();aS.hide();aF.hide();aa.html(ai);e.hide();q.show();aY("OTPFailed")}function D(){O();aR();aE.hide();h.hide();aw.hide();aS.hide();aF.hide();e.hide();q.hide();C.show();aY("SMSFailed")}function at(){aR();O();aE.hide();h.hide();aw.show();J.show();aS.hide();aa.html(ai);e.show();o.show();ag.hide();ae();aY("OTPSent")}function B(){t.show();aE.hide();h.hide();aw.hide();J.hide();aS.hide();aa.html(ai);e.hide();o.hide();ag.hide();aY("OTPFailed")}function aJ(){k=aS.find(".phoneNumber");f=J.find(".otp-field");ai=FKART.login.userPhoneNumber;k.val(ai);az=aS.find("input[type=button]");aK=J.find("input[type=button]");aO=A.find("#marketingSMSAppDownload");L=A.find("#AppDownloadInterstitial");h=A.find(".infoDiv");aw=A.find(".otpTitle");aE=A.find(".stitle");G=A.find(".smsSuccessDiv");e=A.find(".otpSuccessDiv");q=A.find(".otpErrorDiv");t=A.find(".otpErrorMsgDiv");C=A.find(".otpSendErrorDiv");an=A.find(".smsErrorDiv");n=A.find(".retry-sms");ap=A.find(".retry-otp");aa=A.find(".phone_number");A.show();J.hide();aw.hide();v.reposition();R()}function R(){az.on("click",function(a5){ai=k.val();if(!(/^[789]\d{9}$/.test(ai))){k.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}S();a5.preventDefault()});aK.on("click",function(a5){l=f.val();if(!(/^[0-9]{4,6}$/.test(l))){f.addClass("error").val("").attr("placeholder","Invalid OTP").focus();return}else{al();aE.hide();G.hide();h.hide();an.hide();e.hide();aw.hide();J.hide();aY("SMSTried");a5.preventDefault()}});n.on("click",function(){O();aR();aH.html("45");a1.html("60");aE.hide();G.hide();h.hide();aS.hide();an.hide();S();aY("SMSReTried")});ap.on("click",function(){aR();O();af();aH.html("45");a1.html("60");aw.show();G.hide();J.show();an.hide();aY("SMSReTried")})}function m(){clearInterval(aj);aj=null}function O(){clearInterval(ac);ac=null}function aR(){clearInterval(aN);aN=null}function r(){clearInterval(U);U=null}function aA(){aj=setInterval(function(){var a5=parseInt(p.html());if(a5==0){m();aU.hide();aT.show()}p.html(a5-1)},1000)}function j(){ac=setInterval(function(){var a5=parseInt(aH.html());if(a5==0){O();Y.hide();b.show()}aH.html(a5-1)},1000)}function ae(){aN=setInterval(function(){var a5=parseInt(a1.html());if(a5==0){aR();O();o.hide();ag.show()}a1.html(a5-1)},1000)}function w(a6,a5){var a9=a6.split("?")[1];var a8=a9.split("&");for(var a7=0;a7<a8.length;a7++){var ba=a8[a7].split("=");if(ba[0]==a5){return ba[1]}}}function aW(){var a5=FKART.urlParser().get("sid");if(a5!="undefined"){return a5}}function u(){$ele=window.location.href;aV=false;E=false}function ax(){c()}ax()});register_controller("SocialCollabCtrl",function(S){var u=$(S),p=$(".app-ping",u),I=$(".app-offers-button",u),J=$(".app-offers-container",u),Q=$(".socialCollabDialog-popup-content",u),ac=$(".fk-question-mark",u),G,Y,A,Z,w,N,ag,ai,b,B,j,F,K,k,X,z,M,y,L,l,P,E=false,n="title",ab="subtitle",ah,aa,v,a,O,D,m,d=false;function r(){I.click(function(){if(!d){g("Opened");$(this).addClass("open");ac.text("X");setTimeout(function(){J.slideDown(200);d=true},150)}else{g("Closed");J.slideUp(200,function(){I.removeClass("open");ac.text("?");d=false})}});EventBus.subscribe("showSocialCollabPopup",function(){$ele=window.location.href;U($ele);t()});p.on("click",function(aj){if(!p.hasClass("disabled")){g("Clicked");$ele=$(this).data("url");U($ele);t();aj.preventDefault()}})}function t(){ai=null;ad();f()}function g(ak){var aj={};if(ak=="Clicked"){aj.products=s.products}aj.prop21="OpenInApp_"+ak;FKART.omni.customEvent("App only offers",aj)}function H(){h();if(ah&&ah.length>0){var aj=$("<img>");aj.attr("src",ah);Y.append(aj)}else{Y.remove()}C();g("PNSent")}function T(){h();f();g("PNFailed")}function ad(){ai=new FKART.ui.Dialog({showFooter:false,cssClass:"socialCollabDialog",body:Q.html(),destroyOnHide:true,width:"650px"});b=ai.getContainer();w=b.find(".headerDiv");G=b.find(".smsDiv");F=b.find(".smsForm");N=b.find(".send-sms-fake-link");ag=b.find(".send-sms-link");m=b.find(".timer");B=b.find(".retry-notification");ai.show();e()}function e(){b.on("beforeHide",function(aj){af();h();E=false});ag.click(function(){f();g("PNExpired")});B.click(function(){ai.hide();t();g("PNReTried")})}function W(){l=L.val();if(!(/^[789]\d{9}$/.test(l))){L.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}else{$.ajax({url:"/lc/sendSocialCollabSMS",type:"POST",data:{title:n,subtitle:ab,phoneNumber:l,cmpId:aa,token:v,vid:a,captchaText:z.val(),captchaId:M.attr("id")},dataType:"json",success:function(aj){if(aj.captchaStatus){if(aj.smsStatus){V()}else{x()}}else{q()}},error:function(){x()}})}}function q(){o();z.addClass("error").val("").attr("placeholder","Invalid Captcha").focus()}function V(){k.hide();F.hide();y.html(l);A.show();g("SMSSent")}function x(){k.hide();F.hide();y.html(l);Z.show();g("SMSFailed")}function f(){L=F.find(".phoneNumber");l=FKART.login.userPhoneNumber;L.val(l);K=F.find("input[type=submit]");k=G.find(".infoDiv");A=G.find(".smsSuccessDiv");Z=G.find(".smsErrorDiv");j=G.find(".retry-sms");X=F.find(".captchaDiv");z=F.find(".captchaText");P=F.find(".refreshCaptcha");y=G.find(".phone_number");if(/^\d{10}$/.test(l)){E=true;o()}G.show();ai.reposition();R()}function R(){P.click(function(){o();z.val("").focus()});F.submit(function(aj){W();g("SMSTried");aj.preventDefault()});j.click(function(){k.show();F.show();Z.hide();z.removeClass("error").val("").attr("placeholder","Captcha text").focus();o();g("SMSReTried")});L.focus(function(){g("PhoneNumberFocused");if(!E){E=true;o()}})}function o(){$.ajax({url:"/lc/generateCaptcha",type:"POST",dataType:"json",success:function(aj){if(aj.success){M=X.find("img");M.attr("src","data:image/png;base64,"+aj.captchaBytes);M.attr("id",aj.id);X.show();z.show();M.load(function(){if(this.complete){ai.reposition()}})}else{X.find("img").attr("alt","Captcha failed to load")}},error:function(){X.find("img").attr("alt","Captcha failed to load")}})}function af(){clearInterval(O);O=null}function h(){clearInterval(D);D=null}function C(){O=setInterval(function(){var aj=parseInt(m.html());if(aj==0){af();N.hide();ag.show()}m.html(aj-1)},1000)}function c(ak,aj){var an=ak.split("?")[1];var am=an.split("&");for(var al=0;al<am.length;al++){var ao=am[al].split("=");if(ao[0]==aj){return ao[1]}}}function U(aj){aa=c(aj,"cmpId");v=c(aj,"token");a=c(aj,"vid")}function ae(){r()}ae()});