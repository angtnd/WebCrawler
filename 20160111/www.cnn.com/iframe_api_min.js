var version="asset_0.0.1",adData={uniqueId:null,originAddress:null,postAddress:null,adVersion:null,winplayCall:null,clickthroughUrl:null,videos:[],contextualData:{}};function tm_sendHandshake(){tm_getLinkParams();window.addEventListener("message",receiveMessage,false);window.parent.postMessage({type:"handshake",version:version,uniqueId:adData.uniqueId},adData.postAddress)}function tm_handleStart(){return}function tm_openClickThrough(){var a={type:"reportToWinplay",clickthroughUrl:!!arguments[0]?arguments[0]:adData.clickthroughUrl,winplayType:!!arguments[1]?arguments[1]:"ct",uniqueId:adData.uniqueId};window.parent.postMessage(a,adData.postAddress)}function tm_sendWinplayEvent(a){console.log("sending winplay event "+a);var b={type:"reportToWinplay",winplayType:a,uniqueId:adData.uniqueId};window.parent.postMessage(b,adData.postAddress)}function tm_sendPlayheadUpdate(a,d,c){var b={type:"playheadUpdate",video_id:a,time:d,duration:c,uniqueId:adData.uniqueId};window.parent.postMessage(b,adData.postAddress)}function tm_sendPause(){window.parent.postMessage({type:"pause",uniqueId:adData.uniqueId},adData.postAddress)}function tm_sendResume(){window.parent.postMessage({type:"resume",uniqueId:adData.uniqueId},adData.postAddress)}function tm_handlePlayheadUpdate(c,b,a){console.log("Video "+c+" is at "+a+" of "+b)}function tm_handlePause(){console.log("Ad paused.")}function tm_handleResume(){console.log("Ad resumed.")}function tm_getLinkParams(){var c=document.location.search.split("?").join("");var b=c.split("&");var a;for(i=0;i<b.length;i++){a=b[i].split("=");if(a[0]=="tm_asset_id"){adData.uniqueId=a[1]}else{if(a[0]=="tm_origin"){adData.originAddress=decodeURI(a[1]);adData.postAddress=(adData.originAddress=="about:blank")?"*":adData.originAddress}}}}function receiveMessage(a){if(a.data.uniqueId==adData.uniqueId&&adData.originAddress==adData.originAddress){switch(a.data.type){case"handshake":tm_handleHandshake(a.data);break;case"start":tm_handleStart();break;case"playheadUpdate":tm_handlePlayheadUpdate(a.data.video_id,a.data.duration,a.data.time);break;case"pause":tm_handlePause();break;case"resume":tm_handleResume();break;default:console.log("Child: Unrecognized event type: "+a.data.type);break}}}function tm_handleHandshake(a){adData.adVersion=event.data.version;adData.winplayCall=event.data.winplayCall,adData.clickthroughUrl=event.data.clickthroughUrl,adData.contextualData=copyObject(event.data.contextualData);adData.videos=copyObject(event.data.videos)}function copyObject(a){return JSON.parse(JSON.stringify(a))};