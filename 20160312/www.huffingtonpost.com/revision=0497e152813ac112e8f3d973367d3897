!function(){"use strict";function e(e,i){this.pmData=e,this.options=i||{},this.debug("Allpapr() created"),a.piximedia.PAM.EventEmitter.forObject(this);var t=e.saleMode;e.minEngagementTime=e.minEngagementTime?parseInt(e.minEngagementTime,10):0,e.minExposureTime=e.minExposureTime?parseInt(e.minExposureTime,10):0,"cpc"===t&&e.minEngagementTime>0?t="cpc":"cpm"===t&&e.minExposureTime>0&&(t="cpmview"),this.salemode=t}var a=window;e.prototype.doWait=function(e){return e()},e.prototype.start=function(){var e=this.pmData,i=e.framedAd,t=i.pam,r=this;this.framedPam=t,this.debug("Allpapr.start()"),i&&i.args&&i.args.doNotScaleAllpapr&&(e.doNotScaleAllpapr=i.args.doNotScaleAllpapr),t.loadLibrary("sweetlib.js",function(){r.first=!0;var t=a.piximedia.SweetLib;r.debug("Allpapr ready to inject"),i.inject(e.position||"1x1",{},function o(p,n,l,d){if(r.debug("Allpapr injected"),n.piximedia=a.piximedia,t.fixTracking(e,l),r.first&&0===l.injectionIndex)for(var s=e.pixelUrl||[],m=0;m<s.length;m++)t.PixelPrinter(s[m]);var c=!0,h=t.startViewTracking(e);d.emit("register-visibility-callback",{callback:"visibility-changed",threshold:70}),d.on("visibility-changed",function(e){h.isVisible=e,c&&(c=!1,l.loadEvent("AP_ALLPAPRHASBEENSEEN"),i.loadEventOnce("AP_SOMETHINGHASBEENSEEN"))}),r.injectedDocument=p,r.injectedWindow=n,e.iframe=d,e.position=l;var g=e.allpapr,u=l.pageContainerWidth,b=t.getPageContainerHints()||{};e.allpapr_header&&(g.arch_height=Math.max(g.arch_height,(e.allpapr_header.height||0)+(e.allpapr_header.top||0)));var f=g.inset||b.inset||{},v=f.thickness?parseFloat(f.thickness,10):0,x=u+2*v,A=e.doNotScaleAllpapr?1:x/g.pc_width,y=Math.round(A*g.arch_height)+v,E=Math.round(A*g.width),w=Math.round(A*g.height),T=function(){r.debug("Allpapr proceed()"),e.wrapper=p.createElement("div"),e.wrapper.id="allpapr-wrapper",p.body.appendChild(e.wrapper),e.decorate_extra_immediately=!0;var i=new a.piximedia.Decoratr({data:e,meta:{adaptive:!!e.doNotScaleAllpapr}});e.asset=i,i.decorate(),i.resize(E),d.emit("resize",{wallpaper:!0,moveTop:y,width:E,height:w,stickToTop:!!r.pmData.stickToTop,moveTopOptions:{duration:0},bodyBackgroundColor:r.pmData.enableBodyBackgroundColor?r.pmData.enableBodyBackgroundColor.bodyBackgroundColor:void 0}),setTimeout(function(){r.registeredResponsiveCallback||(r.registeredResponsiveCallback=!0,d.registerResponsiveCallback(function(){return p.close(),p.open(),r.first=!1,null===p.body&&p.write("<html></html>"),o(p,n,l,d)}))},0)};r.debug("Allpapr ready to proceed"),r.first?r.doWait(T):T()})})},e.prototype.debug=function(e){this.pmData&&this.pmData.framedAd&&this.pmData.framedAd.pam&&this.pmData.framedAd.pam.debug("["+this.pmData.position+"] "+e)},a.piximedia.Allpapr20150917=e,a.piximedia.libraryLoader&&a.piximedia.libraryLoader["allpapr.20150917.js"]&&(a.piximedia.libraryLoader["allpapr.20150917.js"].complete=!0)}(),function(){var e=window,a="allpapr.20150917.js";e.piximedia.libraryLoader=e.piximedia.libraryLoader||{};var i=e.piximedia.libraryLoader[a];if(i&&(i.complete=!0,i.onloads))for(var t=0;t<i.onloads.length;t++)i.onloads[t]()}();