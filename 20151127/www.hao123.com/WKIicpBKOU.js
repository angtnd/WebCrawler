__d("widget.treasure.config",["common.js.jquery"],function(e,k,f,a){var b=a("common.js.jquery"),d={gameState:{unInit:0,init:1,start:2,end:3,dolottary:4},diamond:{width:20,height:20},images:{duozai:"http://s0.hao123img.com/res/treasure/duozai-kp.png",rule:"http://s0.hao123img.com/res/treasure/treasure-rule.png",pop:"http://s0.hao123img.com/res/treasure/treasure-pop.png",state1:"http://s0.hao123img.com/res/treasure/diamond-state1.png",state2:"http://s0.hao123img.com/res/treasure/diamond-state2.png"},
lottery:{pid:"116",token:"296cd89197bcc8373c2bc8f73a88ad85",lotteryUrl:"http://zhuanla.hao123.com/lucky/draw?callback=?",submitUrl:"http://zhuanla.hao123.com/lucky/update?callback=?",goldUrl:"http://zhuanla.hao123.com/task/addvipcoin?callback=?"},duozai:{width:80,height:172,normal:{interval:100,frames:"-16 30,-16 -172,-16 -344,-16 -516,-16 -688,-16 -860,-96 0".split(",")},onceHover:{interval:200,frames:"-16 0,-16 -172,-16 -344,-16 -516,-16 -688,-16 -860,-96 0".split(",")},working:{interval:100,frames:"-96 0,-96 -172,-95 -344,-95 -516,-95 -687,-95 -859,-95 -1032".split(",")},
jumping:{interval:200,frames:["-45 -5","-45 -139","-45 -273","-45 -407","-45 -5"]}},hot:{width:44,height:47,bottom:-50,finalBottom:123},progressbar:{width:56,height:166,marginLeft:13,top:-175,bottom:{small:450,other:550},score:{zero:166,one:154,two:134,three:114,four:94,five:74,six:54,seven:0}},pointer:{minLeft:135,maxLeft:515}};k.exports={init:function(){this.data=d;return this},get:function(a,c){var g=this.data||{},d=(a||"").split(".");b.each(d,function(c,a){a&&"undefined"!==typeof g&&(g=g[a])});
return"undefined"!==typeof g?g:c},set:function(a,c){var g,d,i;if("undefined"===typeof c)this.data=a;else if(a=b.trim(""+(a||"")))g=a.split("."),d=g.pop(),i=this.data||{},b.each(g,function(c,a){var b=i[a];if("object"===typeof b)i=i[a];else if("undefiend"===typeof b)i=i[a]={};else throw Error("forbidden to set property["+a+"] of ["+b+"] data");}),i[d]=c;return this}}.init();return f});
__d("widget.treasure.diamondSprite",["common.js.jquery","common.js.format","common.js.animation","widget.treasure.config"],function(e,k,f,a){function b(c,a,b){this.ctx=c;this.url=a;this.diamondStore=b||{};this.create()}var d=a("common.js.jquery"),j=a("common.js.format");a("common.js.animation");var e=a("widget.treasure.config"),c=e.get("diamond"),g=e.get("images");b.prototype.create=function(){var a=this.diamondStore,b=this.url,g=this.ctx.text();this.$tpl=d(j('<a class="g-ib treasure-item" target="_blank" alog-text="#{title}" href="#{url}" style="padding: 0;width:#{width}px;height:#{height}px;"></a>',
{width:c.width,height:c.height,url:b,title:g}));a&&a[b]?this.render(a[b]):this.render(1);return this.$tpl};b.prototype.render=function(a){a||(a=1);var c=this.ctx.text(),c=c+"-diamond";switch(a){case 1:this.$tpl.attr({"data-state":1,"data-bg":g.state1.src,"alog-text":c}).css({"background-image":"url("+g.state1.src+")"});break;default:this.$tpl.attr({"data-state":2,"data-bg":g.state2.src,"alog-text":c}).addClass("treasure-diamond").css({"background-image":"url("+g.state2.src+")"})}};k.exports=b;return f});
__d("widget.treasure.duozaiSprite",["common.js.jquery","common.js.format","common.js.animation","widget.treasure.config"],function(e,k,f,a){function b(a){this.game=a;this.onceHoverAnimationDone=this.normalAnimationDone=!1;this.create()}var d=a("common.js.jquery"),j=a("common.js.format"),c=a("common.js.animation"),e=a("widget.treasure.config"),g=e.get("duozai"),o=e.get("hot"),i=e.get("images");b.prototype.create=function(){this.$tpl=d(j('<div class="duozai" style="width:#{width}px;height:#{height}px;background-image:url(#{bgurl});"></div>',
{width:g.width,height:g.height,bgurl:i.duozai.src}));this.$hotTpl=d(j('<div class="duozi-hot" style="width:#{width}px;height:#{height}px;bottom:#{bottom}px;background-image:url(#{bgurl});"></div>',{width:o.width,height:o.height,bottom:o.bottom,bgurl:i.duozai.src}))};b.prototype.show=function(a){this.$tpl.animate({bottom:"41px"},1E3,function(){a&&a()})};b.prototype.playOnceHoverAnimation=function(a){var b=this,d=this.$tpl[0],i=g.onceHover;this.onceHoverAnimation=c().changePosition(d,i.frames).then(function(){b.onceHoverAnimationDone=
!0;a&&a()});this.onceHoverAnimation.start(i.interval)};b.prototype.playNormalAnimation=function(a){var b=this,d=this.$tpl[0],i=g.normal;this.normalAnimation=c().changePosition(d,i.frames).then(function(){b.normalAnimationDone=!0;a&&a()});this.normalAnimation.start(i.interval)};b.prototype.stopNormalAnimation=function(){this.normalAnimation&&this.normalAnimation.dispose();this.normalAnimationDone=!0;this.$tpl.css("background-position","-16px 0")};b.prototype.playWorkingAnimation=function(){var a=this.$tpl[0],
b=g.working;this.normalAnimationDone||this.stopNormalAnimation();this.workingAnimation=c().changePosition(a,b.frames).repeatForever();this.workingAnimation.start(b.interval)};b.prototype.stopWorkingAnimation=function(){this.workingAnimation&&this.workingAnimation.dispose();this.$tpl.css("background-position","-96px 0")};b.prototype.playJumpingAnimation=function(){var a=this,b=this.$tpl[0],d=g.jumping;this.jumpingAnimation=c().changePosition(b,d.frames).then(function(){7==a.game.score&&a.$tpl.css("background-position",
"-45px -407px")});this.jumpingAnimation.start(d.interval)};b.prototype.stopJumpingAnimation=function(){this.jumpingAnimation&&this.jumpingAnimation.dispose();7==this.game.score?this.$tpl.css("background-position","-45px -407px"):this.$tpl.css("background-position","-45px -5px")};k.exports=b;return f});
__d("widget.treasure.progressbarSprite",["common.js.jquery","common.js.format","common.js.animation","common.js.pageEvents","widget.treasure.config"],function(e,k,f,a){function b(a){this.width=c.width;this.height=c.height;this.marginLeft=c.marginLeft;this.score=a||0;this.create()}var d=a("common.js.jquery"),j=a("common.js.format");a("common.js.animation");a("common.js.pageEvents");e=a("widget.treasure.config");e.get("game");var c=e.get("progressbar"),g=e.get("pointer"),o=e.get("images");b.prototype.create=
function(){var a=this.renderScore(this.score);this.$tpl=d(j('<div class="progressbar-box"><div class="pointer js-pointer" style="background: url(#{bgurl})  -344px -11px  no-repeat;"></div><div class="progressbar js-progressbar" style="width:#{width}px;height:#{height}px;background: url(#{bgurl}) -268px -7px no-repeat"></div><a href="#" alog-text="\u9886\u53d6\u5956\u52b1" class="prize-btn js-prize" style="width: 56px;height: 50px;display: none;position: absolute;top: 0;left: 0;cursor:pointer"></a></div>',
{bgurl:o.duozai.src,width:this.width,height:a,marginLeft:this.marginLeft,bottom:this.bottom,top:c.top,left:g.minLeft}));this.$progressbar=d(".js-progressbar",this.$tpl);this.$pointer=d(".js-pointer",this.$tpl);this.$prizeBtn=d(".js-prize",this.$tpl);7==this.score&&this.$prizeBtn.show()};b.prototype.playflyanimation=function(){this.$tpl.fadeIn(1E3)};b.prototype.renderScore=function(a){var b;switch(a){case 0:b=c.score.zero;break;case 1:b=c.score.one;break;case 2:b=c.score.two;break;case 3:b=c.score.three;
break;case 4:b=c.score.four;break;case 5:b=c.score.five;break;case 6:b=c.score.six;break;case 7:b=c.score.seven;break;default:b=c.score.seven}this.$progressbar&&this.$progressbar.animate({height:b},1E3);7==a&&this.$prizeBtn&&this.$prizeBtn.css("display","block");return b};b.prototype.forward=function(a){this.renderScore(a)};b.prototype.back=function(){var a=this.forwardTime;this.$pointer.stop().animate({left:g.minLeft},a,"linear")};b.prototype.reset=function(){this.renderScore(0)};k.exports=b;return f});
__d("widget.treasure.treasure_ajax",["common.js.jquery"],function(e,k,f,a){function b(a){a=document.cookie.match("(?:^|; )"+window.encodeURIComponent(a)+"=([^;]+)");return null===a?void 0:window.decodeURIComponent(a[1])}function d(){var a=b("FLASHID")||b("BAIDUID");if(a)return a.split(":")[0]}var j=a("common.js.jquery");return f={doPost:function(a,b,o){b=b||{};b.c=d();j.getJSON(HAO.httpsTrans(a),b,function(a){o&&o(a)})}}});
__d("widget.treasure.treasure_goodSubmit",["common.js.widget","widget.popup.base","widget.treasure.config"],function(e,k,f,a){a("common.js.widget");a("widget.popup.base");var b=a("widget.treasure.config");$.widget("hao123.treasure_goodSubmit",$.lottery.popup,{options:{className:"good-confirm-box",isModel:!0},_create:function(){var a=this.element,j=b.get("images");this._baseCreate();this.element.appendTo($("body"));this.element.css("background-image","url("+HAO.httpsTrans(j.pop.src)+")");this.$close=
$('[data-hook="good-confirm-close"]',a);this._bindEvent();this._baseShow()},_init:function(){},_bindEvent:function(){var a=this;a.$close.click(function(){a._baseHide();a.remove();return!1})}});k.exports={pop:function(){$('<div id="treasure-good-confirm" class="treasure-good-confirm" monkey="treasure_good_confirm"><a href="#" title="\u5173\u95ed\u5f39\u7a97" class="good-confirm-close" data-hook="good-confirm-close"></a></div>').treasure_goodSubmit()}};return f});
__d("widget.treasure.treasure_good","common.js.widget,widget.popup.base,widget.canlash.imageloader,widget.treasure.treasure_ajax,widget.treasure.config,widget.treasure.treasure_goodSubmit".split(","),function(e,k,f,a){a("common.js.widget");a("widget.popup.base");a("widget.canlash.imageloader");var b=a("widget.treasure.treasure_ajax"),d=a("widget.treasure.config"),j=a("widget.treasure.treasure_goodSubmit"),c=d.get("lottery").submitUrl;$.widget("hao123.treasure_good",$.lottery.popup,{options:{className:"pop-treasure-good",
isModel:!0},_create:function(){var a=this.element,b=d.get("images");this._baseCreate();this.element.appendTo($("body"));this.element.css("background-image","url("+HAO.httpsTrans(b.pop.src)+")");this.valid=!1;this.$close=$('[data-hook="treasure-good-close"]',a);this.$submit=$('[data-hook="treasure-good-submit"]',a);this.$prize=$('[data-hook="treasure-good-prize"]',a);this.$name=$('[data-hook="prizer-name"]',a);this.$phone=$('[data-hook="prizer-phone"]',a);this.$address=$('[data-hook="prizer-address"]',
a);this._bindEvent();this._baseShow()},_init:function(){this._paintPrize()},_paintPrize:function(){this.$prize.text(this.options.prize)},show:function(){this._baseShow()},_commit:function(){function a(){d._baseHide();j.pop()}var d=this,i=d.options;d._valid();d.valid&&b.doPost(c,i.args,a)},_valid:function(){function a(b,c){b=$.trim(b);switch(c){case "phone":return/^0?1[3|4|5|8][0-9]\d{8}$/.test(b);default:return!!b}}var b=this.$name.val(),c=this.$phone.val(),d=this.$address.val();a(b,"notnull")?a(c,
"notnull")?a(c,"phone")?a(d,"notnull")?(this.valid=!0,this.options.args.winfo.address=d,this.options.args.winfo.phone=c,this.options.args.winfo.uname=b):(this.valid=!1,this.$address.focus()):(this.valid=!1,this.$phone.val("").focus()):(this.valid=!1,this.$phone.focus()):(this.valid=!1,this.$name.focus())},_bindEvent:function(){var a=this;this.$close.click(function(){a._baseHide();a.remove();return!1});this.$submit.click(function(){a._commit();return!1})}});k.exports={pop:function(a,b,c){var d={};
d.prize=a;d.args=b;d.gameinstance=c;$('<div id="pop-treasure-good" class="pop-treasure-good" monkey="pop_treasure_good"><div class="treasure-good-prize" data-hook="treasure-good-prize"></div><input class="prizer-name" data-hook="prizer-name"><input class="prizer-phone" data-hook="prizer-phone"><textarea rows="2" cols="20" class="prizer-address" data-hook="prizer-address"></textarea><a href="#" class="treasure-good-submit" data-hook="treasure-good-submit" title="\u63d0\u4ea4"></a><a href="#" title="\u5173\u95ed\u4e2d\u5956\u5f39\u5c42" class="treasure-good-close" data-hook="treasure-good-close"></a></div>').treasure_good(d)}};
return f});
__d("widget.treasure.treasure_virtual",["common.js.widget","widget.popup.base","widget.treasure.config"],function(e,k,f,a){a("common.js.widget");a("widget.popup.base");var b=a("widget.treasure.config");$.widget("hao123.treasure_virtual",$.lottery.popup,{options:{className:"pop-treasure-virtual",isModel:!0},_create:function(){var a=this.element,j=b.get("images");this._baseCreate();this.element.appendTo($("body"));this.element.css("background-image","url("+HAO.httpsTrans(j.pop.src)+")");this.$close=
$('[data-hook="treasure-virtual-close"]',a);this.$submit=$('[data-hook="treasure-virtual-submit"]',a);this.$img=$('[data-hook="treasure-virtual-img"]',a);this._bindEvent();this._baseShow()},_init:function(){this._paintPrize()},_paintPrize:function(){var a=this.options;this.$img.css("background-image","url("+HAO.httpsTrans(a.img)+")");this.$submit.attr("href",a.url)},_bindEvent:function(){var a=this;this.$close.click(function(){a._baseHide();a.remove();return!1})}});k.exports={pop:function(a){var b=
{};b.img=a.img_url;b.url=a.url;$('<div id="pop-treasure-virtual" class="pop-treasure-virtual" monkey="pop_treasure_virtual"><div class="treasure-virtual-img" data-hook="treasure-virtual-img"></div><a href="#" class="treasure-virtual-submit" data-hook="treasure-virtual-submit" title="go"></a><a href="#" title="\u5173\u95ed\u5f39\u7a97" class="treasure-virtual-close" data-hook="treasure-virtual-close"></a></div>').treasure_virtual(b)}};return f});
__d("widget.treasure.treasure_getGold",["common.js.widget","widget.popup.base","widget.treasure.config","widget.treasure.treasure_ajax"],function(e,k,f,a){a("common.js.widget");a("widget.popup.base");var b=a("widget.treasure.config"),d=a("widget.treasure.treasure_ajax"),j=b.get("lottery").goldUrl;$.widget("hao123.treasure_getGold",$.lottery.popup,{options:{className:"gold-confirm-box",isModel:!0},_create:function(){var a=this.element,d=b.get("images");this._baseCreate();this.element.appendTo($("body"));
this.element.css("background-image","url("+HAO.httpsTrans(d.pop.src)+")");this.$close=$('[data-hook="gold-confirm-close"]',a);this.$goVip=$('[data-hook="gold-confirm-vip"]',a);this._bindEvent();this._baseShow()},_init:function(){},_getGold:function(){var a=this;d.doPost(j,{},function(b){0===b.errno?a.remove():(a.$goVip.remove(),a.element.addClass("treasure-gold-empty"))})},_bindEvent:function(){var a=this;a.$close.click(function(){a.remove();return!1});a.$goVip.click(function(){a._getGold()})}});
k.exports={pop:function(){$('<div id="treasure-gold-confirm" class="treasure-gold-confirm" monkey="treasure_gold_confirm"><a href="http://vip.hao123.com//?from=weekend" title="\u9886\u53d6\u4f7f\u7528" class="gold-confirm-vip" data-hook="gold-confirm-vip"></a><a href="#" title="\u5173\u95ed\u5f39\u7a97" class="gold-confirm-close" data-hook="gold-confirm-close"></a></div>').treasure_getGold()}};return f});
__d("widget.treasure.game","common.js.jquery,common.js.format,common.js.events,common.js.log,common.js.JSON,widget.canlash.imageloader,widget.treasure.config,common.js.config,common.js.store,widget.treasure.duozaiSprite,widget.treasure.progressbarSprite,widget.treasure.diamondSprite,widget.treasure.treasure_good,widget.treasure.treasure_virtual,widget.treasure.treasure_ajax,widget.treasure.treasure_getGold,common.js.profile,common.js.pageEvents".split(","),function(e,k,f,a){function b(){this.state=
n.unInit;this.resourceLoaded=!1;this.login=t.get("userinfo").islanding}var d=a("common.js.jquery"),j=a("common.js.format"),c=a("common.js.events"),g=a("common.js.log"),o=a("common.js.JSON"),i=a("widget.canlash.imageloader"),l=a("widget.treasure.config"),t=a("common.js.config"),h=a("common.js.store"),u=a("widget.treasure.duozaiSprite"),v=a("widget.treasure.progressbarSprite"),r=a("widget.treasure.diamondSprite"),w=a("widget.treasure.treasure_good"),x=a("widget.treasure.treasure_virtual"),y=a("widget.treasure.treasure_ajax"),
s=a("widget.treasure.treasure_getGold"),z=a("common.js.profile"),p=a("common.js.pageEvents"),g=a("common.js.log");l.get("game");var n=l.get("gameState"),q=l.get("images");b.prototype.init=function(a,b,c){this.diamondData="hao123-index-tnwbdz"==b?a[1].data:a[2].data;this.pageid=b;this.type=a[2].type||"0";this.updateStore();this.$parent=c||d("body");var b=l.get("lottery.lotteryUrl"),c=l.get("lottery.submitUrl"),g=l.get("lottery.goldUrl");l.set("images.duozai",HAO.httpsTrans(a[0].duozai));l.set("images.rule",
HAO.httpsTrans(a[0].rule));l.set("images.state1",HAO.httpsTrans(a[0].state1));l.set("images.state2",HAO.httpsTrans(a[0].state2));l.set("images.pop",HAO.httpsTrans(a[0].pop));l.set("lottery.pid",a[0].pid);l.set("lottery.token",a[0].token);l.set("lottery.lotteryUrl",HAO.httpsTrans(b));l.set("lottery.submitUrl",HAO.httpsTrans(c));l.set("lottery.goldUrl",HAO.httpsTrans(g));this.slideState=z.get("slide");this.diamonds=[];this.show=!0;var h=this;this.loadResource(function(a){a&&h.initGameScene()});return!0};
b.prototype.updateStore=function(){h.getAll();var a=h.get("treasure-state"),b=h.get("treasure-score"),c=h.get("treasure-createtime"),d=h.get("treasure-diamonds");this.state=a?a:n.init;this.score=b?b:0;this.diamondStore=d?d:"{}";this.diamondStore=o.parse(this.diamondStore);a=Date.parse(new Date)/1E3;!c||172800<=a-c?this.resetStore():this.createtime=c};b.prototype.resetStore=function(){var a=h.get("treasure-state"),b=h.get("treasure-score"),c=h.get("treasure-createtime"),d=h.get("treasure-diamonds");
a&&h.remove("treasure-state");b&&h.remove("treasure-score");c&&h.remove("treasure-createtime");d&&h.remove("treasure-diamonds")};b.prototype.resetData=function(){this.score=0;this.state=n.unInit;this.createtime=0;this.diamondStore="{}";this.diamondStore=o.parse(this.diamondStore);this.diamonds=[];this.index=!0};b.prototype.loadResource=function(a){if(this.resourceLoaded)a(!0);else{var b=this;i(q,function(c){b.resouceLoaded=c;a(c)})}};b.prototype.initGameScene=function(){var a=this;a.createStage();
a.createDuozai(function(){a.$container.css("overflow","visible");0==a.score&&a.state!=n.start&&a.state!=n.end?a.duozai.playNormalAnimation(function(){a.createStartBtn();a.createCloseBtn()}):("1"==a.slideState&&1450>parseInt(p.getViewport().width)&&c.done("slidetoolbar.fold"),a.duozai.playNormalAnimation(function(){a.createCloseBtn()}));a.createProgressBar(a.score);a.createTip();a.state!=n.start&&a.state!=n.end||(a.$container.addClass("treasure-gameing"),a.duozai.$tpl.css("bottom",0),a.progressbar.playflyanimation(),
a.createDiamonds());a.bindEvent()})};b.prototype.createStage=function(){this.$container=d('<div class="treasure-game" monkey="treasure-game"></div>').appendTo(this.$parent)};b.prototype.createDuozai=function(a){var b=this;this.duozai=new u(b);this.$container.append(this.duozai.$tpl);b.sendCurrent=function(a){"index"!=a?(b.index=!1,b.$container.hide()):(b.index=!0,b.$container.show())};c.on("goTop.sendCurrent",b.sendCurrent);this.duozai.show(a)};b.prototype.createStartBtn=function(){var a=d(j('<div></div><a class="treasure-start" href="#" title="\u5f00\u59c