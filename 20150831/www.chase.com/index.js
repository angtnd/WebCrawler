/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

//     (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

//! moment.js
//! version : 2.4.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

window.MRT=window.MRT||{},function(){var e,t,n;(function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("almond",["almond/almond"],function(e){return e}),n("almond/almond",function(){}),n("js/lodash",[],function(){return window._}),n("js/jquery",[],function(){return window.$}),function(e){if(typeof bootstrap=="function")bootstrap("promise",e);else if(typeof exports=="object")module.exports=e();else if(typeof n=="function"&&n.amd)n("q/q",e);else if(typeof ses!="undefined"){if(!ses.ok())return;ses.makeQ=e}else Q=e()}(function(){function u(e){return function(){return o.apply(e,arguments)}}function m(e){return e===Object(e)}function g(e){return v(e)==="[object StopIteration]"||e instanceof y}function E(t,n){if(e&&n.stack&&typeof t=="object"&&t!==null&&t.stack&&t.stack.indexOf(w)===-1){var r=[];for(var i=n;!!i;i=i.source)i.stack&&r.unshift(i.stack);r.unshift(t.stack);var s=r.join("\n"+w+"\n");t.stack=S(s)}}function S(e){var t=e.split("\n"),n=[];for(var r=0;r<t.length;++r){var i=t[r];!N(i)&&!x(i)&&i&&n.push(i)}return n.join("\n")}function x(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function T(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);if(r)return[r[1],Number(r[2])]}function N(e){var t=T(e);if(!t)return!1;var i=t[0],s=t[1];return i===r&&s>=n&&s<=lt}function C(){if(!e)return;try{throw new Error}catch(t){var n=t.stack.split("\n"),i=n[0].indexOf("@")>0?n[1]:n[2],s=T(i);if(!s)return;return r=s[0],s[1]}}function k(e,t,n){return function(){return typeof console!="undefined"&&typeof console.warn=="function"&&console.warn(t+" is deprecated, use "+n+" instead.",(new Error("")).stack),e.apply(e,arguments)}}function L(e){return H(e)?e:B(e)?G(e):Q(e)}function A(){function l(e){r=e,o.source=e,f(t,function(t,n){s(function(){e.promiseDispatch.apply(e,n)})},void 0),t=void 0,n=void 0}var t=[],n=[],r,i=h(A.prototype),o=h(_.prototype);o.promiseDispatch=function(e,i,o){var u=a(arguments);t?(t.push(u),i==="when"&&o[1]&&n.push(o[1])):s(function(){r.promiseDispatch.apply(r,u)})},o.valueOf=k(function(){if(t)return o;var e=P(r);return H(e)&&(r=e),e},"valueOf","inspect"),o.inspect=function(){return r?r.inspect():{state:"pending"}};if(L.longStackSupport&&e)try{throw new Error}catch(u){o.stack=u.stack.substring(u.stack.indexOf("\n")+1)}return i.promise=o,i.resolve=function(e){if(r)return;l(L(e))},i.fulfill=function(e){if(r)return;l(Q(e))},i.reject=function(e){if(r)return;l(K(e))},i.notify=function(e){if(r)return;f(n,function(t,n){s(function(){n(e)})},void 0)},i}function O(e){if(typeof e!="function")throw new TypeError("resolver must be a function.");var t=A();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function M(e){return O(function(t,n){for(var r=0,i=e.length;r<i;r++)L(e[r]).then(t,n)})}function _(e,t,n){t===void 0&&(t=function(e){return K(new Error("Promise does not support operation: "+e))}),n===void 0&&(n=function(){return{state:"unknown"}});var r=h(_.prototype);r.promiseDispatch=function(n,i,s){var o;try{e[i]?o=e[i].apply(r,s):o=t.call(r,i,s)}catch(u){o=K(u)}n&&n(o)},r.inspect=n;if(n){var i=n();i.state==="rejected"&&(r.exception=i.reason),r.valueOf=k(function(){var e=n();return e.state==="pending"||e.state==="rejected"?r:e.value})}return r}function D(e,t,n,r){return L(e).then(t,n,r)}function P(e){if(H(e)){var t=e.inspect();if(t.state==="fulfilled")return t.value}return e}function H(e){return m(e)&&typeof e.promiseDispatch=="function"&&typeof e.inspect=="function"}function B(e){return m(e)&&typeof e.then=="function"}function j(e){return H(e)&&e.inspect().state==="pending"}function F(e){return!H(e)||e.inspect().state==="fulfilled"}function I(e){return H(e)&&e.inspect().state==="rejected"}function W(){!U&&typeof window!="undefined"&&!window.Touch&&window.console&&console.warn("[Q] Unhandled rejection reasons (should be empty):",q),U=!0}function X(){for(var e=0;e<q.length;e++){var t=q[e];console.warn("Unhandled rejection reason:",t)}}function V(){q.length=0,R.length=0,U=!1,z||(z=!0,typeof process!="undefined"&&process.on&&process.on("exit",X))}function $(e,t){if(!z)return;R.push(e),t&&typeof t.stack!="undefined"?q.push(t.stack):q.push("(no stack) "+t),W()}function J(e){if(!z)return;var t=l(R,e);t!==-1&&(R.splice(t,1),q.splice(t,1))}function K(e){var t=_({when:function(t){return t&&J(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return $(t,e),t}function Q(e){return _({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return t===null||t===void 0?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return d(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function G(e){var t=A();return s(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function Y(e){return _({isDef:function(){}},function(n,r){return it(e,n,r)},function(){return L(e).inspect()})}function Z(e,t,n){return L(e).spread(t,n)}function et(e){return function(){function t(e,t){var s;if(b){try{s=n[e](t)}catch(o){return K(o)}return s.done?s.value:D(s.value,r,i)}try{s=n[e](t)}catch(o){return g(o)?o.value:K(o)}return D(s,r,i)}var n=e.apply(this,arguments),r=t.bind(t,"next"),i=t.bind(t,"throw");return r()}}function tt(e){L.done(L.async(e)())}function nt(e){throw new y(e)}function rt(e){return function(){return Z([this,st(arguments)],function(t,n){return e.apply(t,n)})}}function it(e,t,n){return L(e).dispatch(t,n)}function st(e){return D(e,function(e){var t=0,n=A();return f(e,function(r,i,s){var o;H(i)&&(o=i.inspect()).state==="fulfilled"?e[s]=o.value:(++t,D(i,function(r){e[s]=r,--t===0&&n.resolve(e)},n.reject,function(e){n.notify({index:s,value:e})}))},void 0),t===0&&n.resolve(e),n.promise})}function ot(e){return D(e,function(e){return e=c(e,L),D(st(c(e,function(e){return D(e,i,i)})),function(){return e})})}function ut(e){return L(e).allSettled()}function at(e,t){return L(e).then(void 0,void 0,t)}function ft(e,t){return L(e).nodeify(t)}var e=!1;try{throw new Error}catch(t){e=!!t.stack}var n=C(),r,i=function(){},s=function(){function o(){while(e.next){e=e.next;var t=e.task;e.task=void 0;var r=e.domain;r&&(e.domain=void 0,r.enter());try{t()}catch(s){if(i)throw r&&r.exit(),setTimeout(o,0),r&&r.enter(),s;setTimeout(function(){throw s},0)}r&&r.exit()}n=!1}var e={task:void 0,next:null},t=e,n=!1,r=void 0,i=!1;s=function(e){t=t.next={task:e,domain:i&&process.domain,next:null},n||(n=!0,r())};if(typeof process!="undefined"&&process.nextTick)i=!0,r=function(){process.nextTick(o)};else if(typeof setImmediate=="function")typeof window!="undefined"?r=setImmediate.bind(window,o):r=function(){setImmediate(o)};else if(typeof MessageChannel!="undefined"){var u=new MessageChannel;u.port1.onmessage=function(){r=a,u.port1.onmessage=o,o()};var a=function(){u.port2.postMessage(0)};r=function(){setTimeout(o,0),a()}}else r=function(){setTimeout(o,0)};return s}(),o=Function.call,a=u(Array.prototype.slice),f=u(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(arguments.length===1)do{if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}while(1);for(;n<r;n++)n in this&&(t=e(t,this[n],n));return t}),l=u(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),c=u(Array.prototype.map||function(e,t){var n=this,r=[];return f(n,function(i,s,o){r.push(e.call(t,s,o,n))},void 0),r}),h=Object.create||function(e){function t(){}return t.prototype=e,new t},p=u(Object.prototype.hasOwnProperty),d=Object.keys||function(e){var t=[];for(var n in e)p(e,n)&&t.push(n);return t},v=u(Object.prototype.toString),y;typeof ReturnValue!="undefined"?y=ReturnValue:y=function(e){this.value=e};var b;try{new Function("(function* (){ yield 1; })"),b=!0}catch(t){b=!1}var w="From previous event:";L.resolve=L,L.nextTick=s,L.longStackSupport=!1,L.defer=A,A.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(a(arguments,1)):e.resolve(n)}},L.promise=O,L.passByCopy=function(e){return e},_.prototype.passByCopy=function(){return this},L.join=function(e,t){return L(e).join(t)},_.prototype.join=function(e){return L([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},L.race=M,_.prototype.race=function(){return this.then(L.race)},L.makePromise=_,_.prototype.toString=function(){return"[object Promise]"},_.prototype.then=function(e,t,n){function u(t){try{return typeof e=="function"?e(t):t}catch(n){return K(n)}}function a(e){if(typeof t=="function"){E(e,r);try{return t(e)}catch(n){return K(n)}}return K(e)}function f(e){return typeof n=="function"?n(e):e}var r=this,i=A(),o=!1;return s(function(){r.promiseDispatch(function(e){if(o)return;o=!0,i.resolve(u(e))},"when",[function(e){if(o)return;o=!0,i.resolve(a(e))}])}),r.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=f(e)}catch(r){n=!0;if(!L.onerror)throw r;L.onerror(r)}n||i.notify(t)}]),i.promise},L.when=D,_.prototype.thenResolve=function(e){return this.then(function(){return e})},L.thenResolve=function(e,t){return L(e).thenResolve(t)},_.prototype.thenReject=function(e){return this.then(function(){throw e})},L.thenReject=function(e,t){return L(e).thenReject(t)},L.nearer=P,L.isPromise=H,L.isPromiseAlike=B,L.isPending=j,_.prototype.isPending=function(){return this.inspect().state==="pending"},L.isFulfilled=F,_.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"},L.isRejected=I,_.prototype.isRejected=function(){return this.inspect().state==="rejected"};var q=[],R=[],U=!1,z=!0;L.resetUnhandledRejections=V,L.getUnhandledReasons=function(){return q.slice()},L.stopUnhandledRejectionTracking=function(){V(),typeof process!="undefined"&&process.on&&process.removeListener("exit",X),z=!1},V(),L.reject=K,L.fulfill=Q,L.master=Y,L.spread=Z,_.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},L.async=et,L.spawn=tt,L["return"]=nt,L.promised=rt,L.dispatch=it,_.prototype.dispatch=function(e,t){var n=this,r=A();return s(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},L.get=function(e,t){return L(e).dispatch("get",[t])},_.prototype.get=function(e){return this.dispatch("get",[e])},L.set=function(e,t,n){return L(e).dispatch("set",[t,n])},_.prototype.set=function(e,t){return this.dispatch("set",[e,t])},L.del=L["delete"]=function(e,t){return L(e).dispatch("delete",[t])},_.prototype.del=_.prototype["delete"]=function(e){return this.dispatch("delete",[e])},L.mapply=L.post=function(e,t,n){return L(e).dispatch("post",[t,n])},_.prototype.mapply=_.prototype.post=function(e,t){return this.dispatch("post",[e,t])},L.send=L.mcall=L.invoke=function(e,t){return L(e).dispatch("post",[t,a(arguments,2)])},_.prototype.send=_.prototype.mcall=_.prototype.invoke=function(e){return this.dispatch("post",[e,a(arguments,1)])},L.fapply=function(e,t){return L(e).dispatch("apply",[void 0,t])},_.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},L["try"]=L.fcall=function(e){return L(e).dispatch("apply",[void 0,a(arguments,1)])},_.prototype.fcall=function(){return this.dispatch("apply",[void 0,a(arguments)])},L.fbind=function(e){var t=L(e),n=a(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(a(arguments))])}},_.prototype.fbind=function(){var e=this,t=a(arguments);return function(){return e.dispatch("apply",[this,t.concat(a(arguments))])}},L.keys=function(e){return L(e).dispatch("keys",[])},_.prototype.keys=function(){return this.dispatch("keys",[])},L.all=st,_.prototype.all=function(){return st(this)},L.allResolved=k(ot,"allResolved","allSettled"),_.prototype.allResolved=function(){return ot(this)},L.allSettled=ut,_.prototype.allSettled=function(){return this.then(function(e){return st(c(e,function(e){function t(){return e.inspect()}return e=L(e),e.then(t,t)}))})},L.fail=L["catch"]=function(e,t){return L(e).then(void 0,t)},_.prototype.fail=_.prototype["catch"]=function(e){return this.then(void 0,e)},L.progress=at,_.prototype.progress=function(e){return this.then(void 0,void 0,e)},L.fin=L["finally"]=function(e,t){return L(e)["finally"](t)},_.prototype.fin=_.prototype["finally"]=function(e){return e=L(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},L.done=function(e,t,n,r){return L(e).done(t,n,r)},_.prototype.done=function(e,t,n){var r=function(e){s(function(){E(e,i);if(!L.onerror)throw e;L.onerror(e)})},i=e||t||n?this.then(e,t,n):this;typeof process=="object"&&process&&process.domain&&(r=process.domain.bind(r)),i.then(void 0,r)},L.timeout=function(e,t,n){return L(e).timeout(t,n)},_.prototype.timeout=function(e,t){var n=A(),r=setTimeout(function(){n.reject(new Error(t||"Timed out after "+e+" ms"))},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},L.delay=function(e,t){return t===void 0&&(t=e,e=void 0),L(e).delay(t)},_.prototype.delay=function(e){return this.then(function(t){var n=A();return setTimeout(function(){n.resolve(t)},e),n.promise})},L.nfapply=function(e,t){return L(e).nfapply(t)},_.prototype.nfapply=function(e){var t=A(),n=a(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},L.nfcall=function(e){var t=a(arguments,1);return L(e).nfapply(t)},_.prototype.nfcall=function(){var e=a(arguments),t=A();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},L.nfbind=L.denodeify=function(e){var t=a(arguments,1);return function(){var n=t.concat(a(arguments)),r=A();return n.push(r.makeNodeResolver()),L(e).fapply(n).fail(r.reject),r.promise}},_.prototype.nfbind=_.prototype.denodeify=function(){var e=a(arguments);return e.unshift(this),L.denodeify.apply(void 0,e)},L.nbind=function(e,t){var n=a(arguments,2);return function(){function s(){return e.apply(t,arguments)}var r=n.concat(a(arguments)),i=A();return r.push(i.makeNodeResolver()),L(s).fapply(r).fail(i.reject),i.promise}},_.prototype.nbind=function(){var e=a(arguments,0);return e.unshift(this),L.nbind.apply(void 0,e)},L.nmapply=L.npost=function(e,t,n){return L(e).npost(t,n)},_.prototype.nmapply=_.prototype.npost=function(e,t){var n=a(t||[]),r=A();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},L.nsend=L.nmcall=L.ninvoke=function(e,t){var n=a(arguments,2),r=A();return n.push(r.makeNodeResolver()),L(e).dispatch("post",[t,n]).fail(r.reject),r.promise},_.prototype.nsend=_.prototype.nmcall=_.prototype.ninvoke=function(e){var t=a(arguments,1),n=A();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},L.nodeify=ft,_.prototype.nodeify=function(e){if(!e)return this;this.then(function(t){s(function(){e(null,t)})},function(t){s(function(){e(t)})})};var lt=C();return L}),n("q",["q/q"],function(e){return e}),function(e,r){if(typeof n=="function"&&n.amd)n("backbone-amd/backbone",["underscore","jquery","exports"],function(t,n,i){r(e,i,t,n)});else if(typeof exports!="undefined"){var i=t("underscore");r(e,exports,i)}else e.Backbone=r(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.slice;t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var u=t.Events={on:function(e,t,n){if(!f(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!f(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){if(!this._events||!f(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;var i=e?[e]:n.keys(this._events);for(var s=0,o=i.length;s<o;s++){e=i[s];var u=this._events[e];if(!u)continue;if(!t&&!r){delete this._events[e];continue}var a=[];for(var l=0,c=u.length;l<c;l++){var h=u[l];(t&&t!==h.callback&&t!==h.callback._callback||r&&r!==h.context)&&a.push(h)}a.length?this._events[e]=a:delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!f(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&l(n,t),r&&l(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;!r&&typeof t=="object"&&(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},a=/\s+/,f=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(a.test(n)){var s=n.split(a);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},l=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}},c={listenTo:"on",listenToOnce:"once"};n.each(c,function(e,t){u[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,!i&&typeof r=="object"&&(i=this),t[e](r,i,this),this}}),u.bind=u.on,u.unbind=u.off,n.extend(t,u);var h=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,u,{changed:null,validationError:null,idAttribute:"id",generateId:function(e){return e[this.idAttribute]},initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes;for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;var h=this.id;this.id=this.generateId(c),h!==this.id&&this.trigger("change-id",this,h,r);if(!a){u.length&&(this._pending=r);for(var p=0,d=u.length;p<d;p++)this.trigger("change:"+u[p],this,c[u[p]],r)}if(f)return this;if(!a)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e){if(n.isEqual(i[s],t=e[s]))continue;(r||(r={}))[s]=t}return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){if(!t.set(t.parse(n,e),e))return!1;r&&r(t,n,e),t.trigger("sync",t,n,e)},H(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r);if(i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),r.parse===void 0&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);r.wait&&(t=n.extend(i||{},t));if(n.isObject(t)&&!a.set(t,r))return!1;f&&f(a,e,r),a.trigger("sync",a,e,r)},H(this,r),s=this.isNew()?"create":r.patch?"patch":"update",s==="patch"&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)};if(this.isNew())return e.success(),!1;H(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||P();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];n.each(p,function(e){if(!n[e])return;h.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var d=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(d.prototype,u,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,m))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});for(var i=0,s=e.length;i<s;i++){var o=e[i]=this.get(e[i]);if(!o)continue;delete this._byId[o.id],delete this._byId[o.cid];var u=this.indexOf(o);this.models.splice(u,1),this.length--,t.silent||(t.index=u,o.trigger("remove",o,this,t)),this._removeReference(o,t)}return r?e[0]:e},set:function(e,t){t=n.defaults({},t,v),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:e.slice();var i,s,o,u,a,f=t.at,l=this.comparator&&f==null&&t.sort!==!1,c=n.isString(this.comparator)?this.comparator:null,p=[],d=[],m={},g=t.add,y=t.merge,b=t.remove,w=!l&&g&&b?[]:!1,E=this.model.prototype;for(var S=0,x=e.length;S<x;S++){o=e[S]||{},this._isModel(o)?i=s=o:E.generateId?i=E.generateId(o):i=o[E.idAttribute||h.prototype.idAttribute];if(u=this.get(i))b&&(m[u.cid]=!0),y&&(o=o===s?s.attributes:o,t.parse&&(o=u.parse(o,t)),u.set(o,t),l&&!a&&u.hasChanged(c)&&(a=!0)),e[S]=u;else if(g){s=e[S]=this._prepareModel(o,t);if(!s)continue;p.push(s),this._addReference(s,t)}s=u||s;if(!s)continue;w&&(s.isNew()||!m[s.id])&&w.push(s),m[s.id]=!0}if(b){for(var S=0,x=this.length;S<x;S++)m[(s=this.models[S]).cid]||d.push(s);d.length&&this.remove(d,t)}if(p.length||w&&w.length){l&&(a=!0),this.length+=p.length;if(f!=null)for(var S=0,x=p.length;S<x;S++)this.models.splice(f+S,0,p[S]);else{w&&(this.models.length=0);var T=w||p;for(var S=0,x=T.length;S<x;S++)this.models.push(T[S])}}a&&this.sort({silent:!0});if(!t.silent){for(var S=0,x=p.length;S<x;S++)(s=p[S]).trigger("add",s,this,t);(a||w&&w.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return o.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},H(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_isModel:function(e){return e instanceof h},_addReference:function(e,t){this._byId[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),e==="change-id"&&(n!=null&&delete this._byId[n],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"];n.each(g,function(e){if(!n[e])return;d.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(e){if(!n[e])return;d.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var b=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,E)),this._ensureElement(),this.initialize.apply(this,arguments)},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,u,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[e[t]]);if(!r)continue;var i=t.match(w);this.delegate(i[1],i[2],n.bind(r,this))}return this},delegate:function(e,t,n){this.$el.on(e+".delegateEvents"+this.cid,t,n)},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){this.$el.off(e+".delegateEvents"+this.cid,t,n)},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}else this.setElement(n.result(this,"el"))},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,r,i){var s=x[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||P()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1),o.type==="PATCH"&&S&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,a&&a.apply(this,arguments)};var f=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,f,i),f};var S=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var T=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},N=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,k=/\*\w+/g,L=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(T.prototype,u,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o,r)!==!1&&(s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(L,"\\$&").replace(N,"(?:$1)?").replace(C,function(e,t){return t?e:"([^/?]+)"}).replace(k,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var A=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},O=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,_=/#.*$/;A.started=!1,n.extend(A.prototype,u,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.location.search},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=decodeURI(this.location.pathname+this.location.search),t=this.root.slice(0,-1);return e.indexOf(t)||(e=e.slice(t.length)),e.slice(1)},getFragment:function(e){return e==null&&(this._hasPushState||!this._wantsHashChange?e=this.getPath():e=this.getHash()),e.replace(O,"")},start:function(e){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState),this.fragment=this.getFragment();var t=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};this.root=("/"+this.root+"/").replace(M,"/");if(!this._hasHashChange&&this._wantsHashChange&&(!this._wantsPushState||!this._hasPushState)){var r=document.createElement("iframe");r.src="javascript:0",r.style.display="none",r.tabIndex=-1;var i=document.body;this.iframe=i.insertBefore(r,i.firstChild).contentWindow,this.navigate(this.fragment)}this._hasPushState?t("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe?t("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.location.replace(this.root+"#"+this.getPath()),!0;this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._hasPushState?e("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe.frameElement),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),A.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!A.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(_,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe)&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new A;var D=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};h.extend=d.extend=T.extend=b.extend=A.extend=D;var P=function(){throw new Error('A "url" property or function must be specified')},H=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t}),n("backbone-amd",["backbone-amd/backbone"],function(e){return e}),n("massrel-js-backbone/backbone",["require","backbone-amd"],function(e){var t=e("backbone-amd");return(window["massrel-js-backbone"]||window).Backbone||t}),n("massrel-js-backbone/MediaModel",["require","./backbone","lodash"],function(e){var t=e("./backbone"),n=e("lodash");return t.Model.extend({defaults:function(){return{type:{},size:"large",provider:{},providerName:"",photo_urls:{},embed_url:"",embed_html:"",caption:"",description:"",link:"",duration:0,videos:{}}},toJSON:function(){var e=t.Model.prototype.toJSON.apply(this,arguments);if(e.size&&e.photo_urls[e.size])e.photo_url=e.photo_urls[e.size].url;else{var r=n.first(n.values(e.photo_urls));e.photo_url=r?r.url:""}return e}})}),n("massrel-js/globals",{host:"api.massrelevance.com",timeout:1e4,protocol:document.location.protocol==="https:"?"https":"http",min_poll_interval:5e3,max_backoff_interval:6e4,backoff_rate:1.8,jsonp_param:"jsonp"}),n("massrel-js/helpers",["./globals"],function(e){var t={},n=encodeURIComponent;t.step_through=function(e,n,r){e=t.is_array(e)?e:[e];var i=e.length-1;if(i>=0)for(;i>=0;i--){var s=e[i];for(var o=0,u=n.length;o<u;o++)n[o].call(r,s)}},t.extend=function(e,t){var n;for(n in t)typeof e[n]=="undefined"&&(e[n]=t[n]);return e},t.api_url=function(t,n){n=n||e.host;var r=e.port,i=e.protocol+"://"+n+(r?":"+r:"");return i+t},t.req={},t.req.supportsXhr2=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,t.req.supportsCors=t.req.supportsXhr2||"XDomainRequest"in window,t.req.supportsJSON="JSON"in window,t.req.xdr=function(n,r,i,s,o,u,a,f){var l,c=!1,h;a||(a="GET");var p=function(e){c=!0;var n,r=!1;try{n=JSON.parse(e)}catch(i){r=!0,d(new Error("JSON parse error"))}r||(typeof o=="function"?o(n):t.is_array(o)&&o.length>0&&t.step_through(n,o,s))},d=function(e){c=!0,typeof u=="function"&&u(e)};window.XMLHttpRequest&&t.req.supportsXhr2?l=new XMLHttpRequest:window.XDomainRequest&&(l=new XDomainRequest),l?(l.open(a,n+"?"+t.to_qs(r)),l.timeout=e.timeout,l.onerror=d,l.onprogress=function(){},l.ontimeout=d,l.onload=function(){p(l.responseText)},l.send(f),h=setTimeout(function(){c||(l.onerror=function(){},l.onprogress=function(){},l.ontimeout=function(){},l.onload=function(){},l.abort&&l.abort(),d())},e.timeout)):d(new Error("CORS not supported"))},t.req.jsonp=function(n,i,s,o,u,a){var f=s+ ++r,l=!1,c;e._json_callbacks[f]=function(n){typeof u=="function"?u(n):t.is_array(u)&&u.length>0&&t.step_through(n,u,o),delete e._json_callbacks[f],l=!0,clearTimeout(c)},i.push([e.jsonp_param,"massrel._json_callbacks."+f]);var h=t.load(n+"?"+t.to_qs(i));c=setTimeout(function(){l||(e._json_callbacks[f]=function(){delete e._json_callbacks[f]},typeof a=="function"&&a(),h.stop())},e.timeout)},t.jsonp_factory=t.req.jsonp;var r=0;e._json_callbacks={},t.request_factory=function(e,n,r,i,s,o){t.req.supportsCors&&t.req.supportsJSON?t.req.xdr(e,n,r,i,s,o):t.req.jsonp(e,n,r,i,s,o)},t.post_factory=function(e,n,r,i,s,o,u){if(!t.req.supportsCors||!t.req.supportsJSON)throw"POST not supported";t.req.xdr(e,n,i,s,o,u,"POST",r)},t.is_array=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},t.is_number=function(e){return Object.prototype.toString.call(e)==="[object Number]"};var i=document.getElementsByTagName("head")[0]||document.body;t.load=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=e;var r=!1;return n.onload=n.onreadystatechange=function(){!r&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")&&(r=!0,n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),typeof t=="function"&&t())},i.insertBefore(n,i.firstChild),{stop:function(){n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),n.src="#"}}},t.to_qs=function(e){var r=[],i;if(e&&e.length){for(var s=0,o=e.length;s<o;s++){i=e[s][1];if(t.is_array(i)){var u=[];for(var a=0,f=i.length;a<f;a++)u[a]=n(i[a]||"");i=u.join(",")}else i!==undefined&&i!==null?i=n(i):i="";r.push(n(e[s][0])+"="+i)}return r.join("&")}return""};var s=/\+\d{4} \d{4}$/,o=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\+\d{4})$/,u=/^(\d{4})-(\d\d)-(\d\d)T(\d\d)\:(\d\d)\:(\d\d)\.(\d{3})Z$/;return t.fix_date=t.fix_twitter_date=function(e){e=e.toString();if(s.test(e)){e=e.split(" ");var t=e.pop();e.splice(3,0,t),e=e.join(" ")}else o.test(e)?e=e.replace(o,"$1/$2/$3 $4:$5:$6 $7"):u.test(e)&&(e=e.replace(u,"$1/$2/$3 $4:$5:$6 +0000"));return e},t.parse_params=function(e){e=e||window.location.search.substring(1);var t={};e.charAt(0)==="?"&&(e=e.substring(1));if(e.length>0){e=e.replace(/\+/g," ");var n=e.split(/[&;]/g);for(var r=0;r<n.length;r++){var i=n[r].split("="),s=decodeURIComponent(i[0]),o=i.length>1?decodeURIComponent(i[1]):"";if(s in t){var u=t[s];typeof u!="string"?t[s].push(o):(t[s]=[],t[s].push(u),t[s].push(o))}else t[s]=o}}return t},t.poll_interval=function(t){var n=e.min_poll_interval;return Math.max(t||n,n)},t.poll_backoff=function(t,n){var r=e.max_backoff_interval;return t<r&&(n=Math.max(n-1,0),t*=Math.pow(e.backoff_rate,n),t=Math.min(t||r,r)),t},t.callback_group=function(e){e=e||1;var t=0,n=!0,r=function(r,i){return function(){if(n){if(t<=e)return r.apply(i||this,arguments);throw new Error("Callback group max call count exceeded")}}};return r.deactivate=function(){n=!1},r},t.timeParam=function(e,t,n,r){typeof e!="undefined"&&(e.getTime&&(e=e.getTime()/1e3),e=+e,!isNaN(e)&&e>0?(e=Math.floor(e/60)*60,n.push([t,e])):!isNaN(e)&&r&&e<=0&&n.push([t,e]))},t.always=function(e){var t=new $.Deferred;if(e===undefined)return t.resolve(),t.promise();e.length===undefined&&(e=[e]);var n=e.length,r=function(){n--,n===0&&t.resolve()};return $.each(e,function(){this.always(r)}),t.promise()},t}),n("massrel-js/generic_poller_cycle",["./helpers"],function(e){function t(t,n,r){this.cg=e.callback_group(),this.skip=this.cg(t),this.callback=this.cg(n),this.errback=this.cg(r),this._enabled=!0}return t.prototype.enabled=function(){return this._enabled},t.prototype.disable=function(){this.cg.deactivate(),this._enabled=!1},t}),n("massrel-js/generic_poller",["./helpers","./generic_poller_cycle"],function(e,t){function n(r,i){var s=this,o=function(){if(f){var i=e.callback_group(),o=i(u),l=function(t){s.consecutive_errors=0,n.failure_mode=s.failure_mode=!1;if(f){for(var r=0,i=s._filters.length;r<i;r++)t=s._filters[r].call(s,t);e.step_through([t],s._listeners,s),f&&o()}},c=function(){s.consecutive_errors+=1,n.failure_mode=s.failure_mode=!0,o(!0)};a=new t(o,l,c),s.fetch(r,s.opts,a)}},u=function(t){var n=e.poll_interval(s.frequency*1e3);t&&(n=e.poll_backoff(n,s.consecutive_errors)),l=setTimeout(o,n)},a=null,f=!1,l;this._listeners=[],this._filters=[],this.object=r,this.opts=i||{},this.frequency=this.opts.frequency||30,this.alive_count=0,this.consecutive_errors=0,this.failure_mode=!1,this.start=function(){return f||(f=!0,o()),this},this.stop=function(){return a&&(a.disable(),a=null),clearTimeout(l),f=!1,this}}return n.prototype.fetch=function(e,t,n){return e.load(t,n.callback,n.errback),this},n.prototype.data=function(e){return this._listeners.push(e),this},n.prototype.filter=function(e){return this._filters.push(e),this},n.failure_mode=!1,n}),n("massrel-js/poller_queue",["./helpers"],function(e){function t(t,n){function a(){if(!s&&r.length>0&&typeof i=="function"){var e=++o;u.enqueued-=1,u.count+=1;var t=r.shift();s=!0,i.call(u,t,function(){e===o&&(s=!1,setTimeout(a,0))})}}this.poller=t,n=e.extend(n||{},{});var r=[],i=null,s=!1,o=0;this.total=0,this.enqueued=0,this.count=0;var u=this;t.batch(function(e){var t=e.length,n=t-1;for(;n>=0;n--)r.push(e[n]);u.total+=t,u.enqueued+=t,a()}),this.next=function(e){!s&&typeof e=="function"&&(i=e,a())}}return t}),n("massrel-js/poller",["./helpers","./generic_poller","./poller_queue"],function(e,t,n){function r(e,n){t.call(this,e,n),this.stream=this.object,this.filter(this.filter_newer),n=this.opts,this.newest_timestamp=n.newest_timestamp||null,this.stay_realtime="stay_realtime"in n?!!n.stay_realtime:!0,this.hail_mary_mode=!!n.hail_mary_mode,this.first=!0}return e.extend(r.prototype,t.prototype),r.prototype.fetch=function(t,n,r){var i=this,s={start_id:null},o=this.stay_realtime?"since_id":"from_id";return s[o]=i.since_id,n=e.extend({},n),this.first&&(n=e.extend(n.initial||{},n),delete n.initial),s=e.extend(s,n),this.cursorable()||delete s.since_id,t.load(s,function(e){r.enabled()&&(e&&e.length>0&&(i.since_id=e[0].entity_id,i.start_id||(i.start_id=e[e.length-1].entity_id)),r.callback(e),s.timeframe&&i.first&&i.stop(),i.first=!1)},r.errback),this},r.prototype.batch=function(e){return this.data(r.createEnumerator(e,!1))},r.prototype.each=function(e){return this.data(r.createEnumerator(e,!0))},r.prototype.queue=function(e){var t=new n(this);return t.next(e),this},r.prototype.more=function(t,n){var r=this,i=function(){r.object.load(e.extend({start_id:r.start_id,since_id:null},r.opts),function(e){e.length>0&&(r.start_id=e[e.length-1].entity_id,r.since_id||(r.since_id=e[0].entity_id)),t.call(r,e)},function(){typeof n=="function"&&n()})};return i(),this},r.prototype.cursorable=function(){return!(t.failure_mode||this.failure_mode||this.hail_mary_mode)},r.prototype.filter_newer=function(e){return e=r.filter_newer(e,this.newest_timestamp),e&&e.length>0&&(this.newest_timestamp=e[0].queued_at),e},r.prototype.poke=function(){return this},r.createEnumerator=function(t,n){return n?function(n){n&&n.length>0&&e.step_through(n,[t],this)}:function(e){e&&e.length>0&&t.call(this,e)}},r.filter_newer=function(e,t){var n="queued_at";if(e&&e.length>0){var r=this.limit||Infinity;if(t)if(e[0][n]<=t)e=[];else if(e[e.length-1][n]>t)e.length>r&&e.splice(this.limit,e.length-r);else{var i=[];for(var s=0,o=e.length;s<o&&i.length<r;s++){var u=e[s];if(!(u[n]>t))break;i.push(u)}e=i}else e.length>r&&e.splice(this.limit,e.length-r)}return e},r}),n("massrel-js/meta_poller",["./helpers","./generic_poller"],function(e,t){function n(){t.apply(this,arguments)}return e.extend(n.prototype,t.prototype),n.prototype.fetch=function(e,t,n){return e.meta(t,n.callback,n.errback),this},n.prototype.each=n.prototype.data,n}),n("massrel-js/top_things_poller",["./helpers","./generic_poller"],function(e,t){function n(e,n){n.thing=n.thing||"hashtags",typeof n.resolution=="number"&&(n.resolution=n.resolution+"s"),t.apply(this,arguments)}return e.extend(n.prototype,t.prototype),n.prototype.fetch=function(e,t,n){return typeof t.resolution=="number"&&(t.resolution=t.resolution+"s"),e.topThings(t,n.callback,n.errback),this},n.mostRecentBucket=function(e){if(e.data&&e.data.length>0){for(var t=e.data.length-1;t>=0;t--)if(e.data[t].things&&e.data[t].things.length>0)return e.data[t];if(t===-1)return e.data[e.data.length-1]}return null},n.prototype.each=n.prototype.data,n}),n("massrel-js/stream_keyword_insights",["./helpers","./generic_poller"],function(e,t){function r(e,t){this.stream=e,this.defaults=t||{}}var n=encodeURIComponent;return r.prototype.url=function(){return this.stream.keyword_insights_url()},r.prototype.fetch=function(t,n,r){t=e.extend({},t||{}),t=e.extend(t,this.defaults);var i=this.params(t);return e.request_factory(this.url(),i,"_",this,function(e){typeof n=="function"&&n.apply(this,arguments)},r),this},r.prototype.poller=function(e){var n=new t(this,e);return n.fetch=function(e,t,n){return e.fetch(t,n.callback,n.errback)},n},r.prototype.params=function(e){e=e||{};var t=[];return e.topics&&t.push(["topics","1"]),"start"in e&&t.push(["start",e.start]),"finish"in e&&t.push(["finish",e.finish]),e.resolution&&t.push(["resolution",e.resolution]),e.countries&&t.push(["countries",e.countries]),t},r}),n("massrel-js/stream_activity",["./helpers","./generic_poller"],function(e,t){function r(e,t){this.stream=e,this.defaults=t||{}}var n=encodeURIComponent;r.prototype.url=function(){return e.api_url("/"+n(this.stream.account)+"/"+n(this.stream.stream_name)+"/activity.json")},r.prototype.fetch=function(t,n,r){t=e.extend({},t||{}),t=e.extend(t,this.defaults);var i=this.params(t);return e.request_factory(this.url(),i,"_",this,function(r){if(r&&(!t.verbose||t.verbose==="0")&&e.is_array(r.activity)){var i=r.activity;for(var s=0,o=i.length;s<o;s++){var u=r.start+r.period_size*s;i[s]=e.extend(i[s],{start:u,finish:Math.min(u+r.period_size,r.finish)})}}typeof n=="function"&&n.apply(this,arguments)},r),this},r.prototype.poller=function(e){var n=new t(this,e);return n.fetch=function(e,t,n){return e.fetch(t,n.callback,n.errback)},n},r.prototype.params=function(t){t=t||{};var n=[];return t.view?n.push(["view",t.view]):t.topic&&n.push(["topic",t.topic]),e.timeParam(t.start,"start",n,!0),e.timeParam(t.finish,"finish",n,!0),"periods"in t&&n.push(["periods",t.periods]),t.resolution&&n.push(["resolution",t.resolution]),"tz_offset"in t&&n.push(["tz_offset",t.tz_offset]),t.encode&&n.push(["encode",t.encode]),n.push(["verbose",0]),n};var i=function(e,t,n){r.prototype[e]=function(){return this.defaults[t]=n,this}};return i("approved","view","approved"),i("pending","view","pending"),i("rejected","view","rejected"),i("minutes","resolution","1m"),i("ten_minutes","resolution","10m"),i("hours","resolution","1h"),i("days","resolution","1d"),r}),n("massrel-js/stream",["./helpers","./poller","./meta_poller","./top_things_poller","./stream_keyword_insights","./stream_activity"],function(e,t,n,r,i,s){function u(){var e=arguments.length===1?arguments[0].split("/"):arguments;this.account=e[0],this.stream_name=e[1],this._enumerators=[]}var o=encodeURIComponent;return u.prototype.stream_url=function(){return e.api_url("/"+o(this.account)+"/"+o(this.stream_name)+".json")},u.prototype.meta_url=function(){return e.api_url("/"+o(this.account)+"/"+o(this.stream_name)+"/meta.json")},u.prototype.top_things_url=function(t){return e.api_url("/"+o(this.account)+"/"+o(this.stream_name)+"/top_"+t+".json")},u.prototype.keyword_insights_url=function(t){return e.api_url("/"+o(this.account)+"/"+o(this.stream_name)+"/keyword_insights.json")},u.prototype.load=function(t,n,r){t=e.extend(t||{},{});var i=this.buildParams(t);return e.request_factory(this.stream_url(),i,"_",this,n||this._enumerators,r),this},u.prototype.buildParams=function(t){t=t||{};var n=[];return t.limit&&n.push(["limit",t.limit]),t.since_id?n.push(["since_id",t.since_id]):t.from_id?n.push(["from_id",t.from_id]):(t.start_id||t.start)&&n.push(["start",t.start_id||t.start]),t.replies&&n.push(["replies","1"]),t.geo_hint&&n.push(["geo_hint","1"]),t.from&&n.push(["from",t.from]),t.keywords&&n.push(["keywords",t.keywords]),t.lang&&n.push(["lang",t.lang]),t.network&&n.push(["network",t.network]),t.timeline_search&&n.push(["timeline_search","1"]),t.page_links&&n.push(["page_links","1"]),t.klout&&n.push(["klout","1"]),t.timeframe&&(e.timeParam(t.timeframe.start,"timeframe[start]",n),e.timeParam(t.timeframe.finish,"timeframe[finish]",n)),n},u.prototype.each=function(e){return this._enumerators.push(e),this},u.prototype.poller=function(e){return new t(this,e)},u.prototype.meta=function(){var t,n,r;if(typeof arguments[0]=="function")n=arguments[0],r=arguments[1],t={};else{if(typeof arguments[0]!="object")throw new Error("incorrect arguments");t=arguments[0],n=arguments[1],r=arguments[2]}var i=this.buildMetaParams(t);return e.request_factory(this.meta_url(),i,"meta_",this,n,r),this},u.prototype.buildMetaParams=function(e){e=e||{};var t=[];return e.disregard&&t.push(["disregard",e.disregard]),e.num_minutes&&t.push(["num_minutes",e.num_minutes]),e.num_hours&&t.push(["num_hours",e.num_hours]),e.num_days&&t.push(["num_days",e.num_days]),e.num_trends&&t.push(["num_trends",e.num_trends]),e.num_links&&t.push(["num_links",e.num_links]),e.num_hashtags&&t.push(["num_hashtags",e.num_hashtags]),e.num_contributors&&t.push(["num_contributors",e.num_contributors]),e.top_periods&&t.push(["top_periods",e.top_periods]),e.top_periods_relative&&t.push(["top_periods_relative",e.top_periods_relative]),e.top_count&&t.push(["top_count",e.top_count]),e.finish&&t.push(["finish",e.finish]),e.networks&&t.push(["networks","1"]),(e.activity||e.activity===0)&&t.push(["activity",e.activity]),t},u.prototype.metaPoller=function(e){return new n(this,e)},u.prototype.keywordInsights=function(e){return new i(this,e)},u.prototype.topThings=function(){var t,n,r;if(typeof arguments[0]=="function")n=arguments[0],r=arguments[1],t={};else{if(typeof arguments[0]!="object")throw new Error("incorrect arguments");t=arguments[0],n=arguments[1],r=arguments[2]}var i=this.buildTopThingsParams(t);return e.request_factory(this.top_things_url(t.thing),i,"top_things_",this,n,r),this},u.prototype.buildTopThingsParams=function(t){t=t||{};var n=[];if(t.resolution){var r;e.is_number(t.resolution)?r=t.resolution+"s":r=t.resolution,n.push(["resolution",r])}return t.start&&n.push(["start",t.start]),t.finish&&n.push(["finish",t.finish]),t.limit&&n.push(["limit",t.limit]),t.percent&&n.push(["percent","1"]),n},u.prototype.topThingsPoller=function(e){return new r(this,e)},u.prototype.activity=function(e){return new s(this,e)},u}),n("massrel-js/account",["./helpers","./meta_poller"],function(e,t){function r(e){this.user=e}var n=encodeURIComponent;return r.prototype.meta_url=function(){return e.api_url("/"+n(this.user)+".json")},r.prototype.meta=function(){var t,n,r;if(typeof arguments[0]=="function")n=arguments[0],r=arguments[1],t={};else{if(typeof arguments[0]!="object")throw new Error("incorrect arguments");t=arguments[0],n=arguments[1],r=arguments[2]}var i=this.buildMetaParams(t);return e.request_factory(this.meta_url(),i,"meta_",this,n,r),this},r.prototype.buildMetaParams=function(t){t=t||{};var n=[];t.quick_stats&&n.push(["quick_stats","1"]);if(t.streams){var r=e.is_array(t.streams)?t.streams:[t.streams];n.push(["streams",r.join(",")])}return t.num_minutes&&n.push(["num_minutes",t.num_minutes]),t.num_trends&&n.push(["num_trends",t.num_trends]),t.start&&n.push(["start",t.start]),t.finish&&n.push(["finish",t.finish]),n},r.prototype.metaPoller=function(e){return new t(this,e)},r.prototype.toString=function(){return this.user},r}),n("massrel-js/context",["./helpers"],function(e){function t(e){this.status=e,this.source={facebook:!1,twitter:!1,getglue:!1,google:!1,instagram:!1,rss:!1,message:!1},this.known=!1,this.intents=!0}return t.create=function(n,r){n=n||{};var i=new t(n);return r=e.extend(r||{},{intents:!0,retweeted_by:!0}),i.intents=r.intents,typeof i.source[n.network]!="undefined"&&(i.source[n.network]=i.known=!0,i.sourceName=n.network),n.network==="google_plus"&&(i.source.google=i.known=!0,i.sourceName="google"),n.network==="massrelevance"&&(i.source.message=i.known=!0,i.sourceName="message"),i.source.twitter&&n.retweeted_status&&r.retweeted_by&&(i.retweet=!0,i.retweeted_by_user=n.user,i.status=n.retweeted_status),i},t.prototype.getPhotoUrl=function(){if(this.photo_url!==undefined)return this.photo_url;var e=!1;if(this.status&&this.known)if(this.source.twitter)if(this.status.entities.media&&this.status.entities.media.length){var t=this.status.entities.media[0];e={url:t.media_url,width:t.sizes.medium.w,height:t.sizes.medium.h,link_url:t.url||t.expanded_url}}else this.status.entities.urls&&this.status.entities.urls.length&&(e={url:this.status.entities.urls[0].expanded_url||this.status.entities.urls[0].url});else this.source.facebook&&(this.status.type&&this.status.type==="photo"||this.status.kind&&this.status.kind==="photo")?e={url:this.status.picture.replace(/_[st]./,"_n.")}:this.source.google&&this.status.object.attachments.length&&this.status.object.attachments[0].objectType==="photo"?e={url:this.status.object.attachments[0].fullImage.url}:this.source.instagram&&this.status.type==="image"&&(e={url:this.status.images.standard_resolution.url});return this.photo_url=e,e},t}),n("massrel-js/compare_poller",["./helpers","./generic_poller"],function(e,t){function n(){t.apply(this,arguments)}return e.extend(n.prototype,t.prototype),n.prototype.fetch=function(e,t,n){return e.load(t,n.callback,n.errback),this},n.prototype.each=n.prototype.data,n}),n("massrel-js/compare",["./helpers","./compare_poller"],function(e,t){function n(t){e.is_array(t)?this.streams=t.slice(0):typeof t=="string"?this.streams=[t]:this.streams=[]}return n.prototype.compare_url=function(){return e.api_url("/compare.json")},n.prototype.buildParams=function(e){var t=[];return e=e||{},e.streams&&t.push(["streams",e.streams]),(e.target||e.target>=0)&&t.push("target",e.target.toString()),t},n.prototype.load=function(t,n,r){typeof t=="function"&&(r=n,n=t,t=null);var i=this.buildParams(e.extend({streams:this.streams},t||{}));return e.request_factory(this.compare_url(),i,"meta_",this,n,r),this},n.prototype.poller=function(e){return new t(this,e)},n}),n("massrel-js/intents",["./helpers"],function(e){var t={base_url:"https://twitter.com/intent/",params:{text:"(string): default text, for tweet/reply",url:"(string): prefill url, for tweet/reply",hashtags:"(string): hashtag (or list with ,) without #, for tweet/reply",related:"(string): screen name (or list with ,) without @, available for all",in_reply_to:"(number): tweet id, only for reply",via:"(string): screen name without @, tweet/reply",tweet_id:"(number): tweet id, for retweet and favorite",screen_name:"(string): only for user/profile",user_id:"(number): only for user/profile",original_referer:'(string): url to display with related ("www.yahoo.com suggests you follow:")'},original_referer:window.top!==window.self&&document.referrer||null};return t.url=function(n,r){r=e.extend({},r||{}),r.original_referer===undefined&&t.original_referer&&(r.original_referer=t.original_referer),r.original_referer&&!/^https?:\/\//.test(r.original_referer)&&(r.original_referer="http://"+r.original_referer);if(r.hashtags&&navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/)){var i=r.text?[r.text]:[];r.url&&(i.push(r.url),delete r.url),i.push("#"+r.hashtags.split(/\s*,\s*/).join(" #").replace(/^\s+|\s+$/gm,"")),delete r.hashtags,r.text=i.join(" ")}var s=[];for(var o in r)s.push([o,r[o]]);return t.base_url+encodeURIComponent(n)+"?"+e.to_qs(s)},t.tweet=function(e){return t.url("tweet",e)},t.reply=function(e,n){return n=n||{},n.in_reply_to=e,t.tweet(n)},t.retweet=function(e,n){return n=n||{},n.tweet_id=e,t.url("retweet",n)},t.favorite=function(e,n){return n=n||{},n.tweet_id=e,t.url("favorite",n)},t.user=function(e,n){return n=n||{},/^\d+$/.test(e+"")?n.user_id=e:n.screen_name=e,t.url("user",n)},t.profile=t.user,t}),n("massrel-js/search",["require","./helpers"],function(e){var t=e("./helpers"),n=function(e){this.apiToken=e};return n.prototype.url=function(){return t.api_url("/search/search.json")},n.prototype.fetch=function(e,n,r){return e=this.buildQueryString(e),t.request_factory(this.url(),e,"_",this,n,r),this},n.prototype.buildQueryString=function(e){var t=[];typeof e.q=="string"&&t.push(["q",e.q]),e.filters&&(t=t.concat(this.buildParams(e.filters,"filter.")));if(e.views){var n,r;for(n in e.views)r=e.views[n],typeof r=="boolean"?t.push(["view."+n,r?"1":"0"]):t=t.concat(this.buildParams(r,"view."+n+"."))}return t},n.prototype.buildParams=function(e,n){n=n||"";var r,i,s,o=[];for(r in e){i=e[r],t.is_array(i)||(i=[i]);for(s=0,len=i.length;s<len;s++){var u=i[s];typeof u=="boolean"&&(u=u?"1":"0"),o.push([n+r,u])}}return o},n}),n("massrel-js/massrel",["./globals","./helpers","./stream","./account","./stream_keyword_insights","./stream_activity","./generic_poller","./generic_poller_cycle","./poller","./meta_poller","./top_things_poller","./poller_queue","./context","./compare","./compare_poller","./intents","./search"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){e.Stream=n,e.Account=r,e.StreamKeywordInsights=i,e.StreamActivity=s,e.GenericPoller=o,e.GenericPollerCycle=u,e.Poller=a,e.MetaPoller=f,e.TopThingsPoller=l,e.PollerQueue=c,e.Context=h,e.Compare=p,e.ComparePoller=d,e.helpers=t,e.intents=v,e.Search=m;var g=t.parse_params();return g["massrel[host]"]&&(e.host=g["massrel[host]"]),e}),n("massrel-js",["massrel-js/massrel"],function(e){return e}),n("embedly/js/main",["jquery","massrel-js"],function(e,t){function o(e){this.data={key:"fd577f7497bf11e0b95d4040d3dc5c07",secure:n,url:e,maxwidth:"500"}}var n=location.protocol==="https:",r="embedly.massrelevance.com",i="d1gbi9ec0ujnws.cloudfront.net",s="//"+(n?i:r)+"/1/";return o.prototype.task=function(n,r){var i=this,o=new e.Deferred;return t.helpers.request_factory(s+n,[["key",this.data.key],["secure",this.data.secure?"true":"false"],["url",this.data.url],["maxwidth",this.data.maxwidth]],"_",this,function(e){o.resolve(e),e&&typeof r=="function"&&r(e)},function(){o.reject()}),o.promise()},o.prototype.oembed=function(e){return this.task("oembed",e)},o.prototype.preview=function(e){return this.task("preview",e)},function(e){return new o(e)}}),n("embedly/index",["./js/main"],function(e){return e}),n("embedly",["embedly/index"],function(e){return e}),n("media-meta/js/embedly-widget",["require","lodash"],function(e){var t=e("lodash"),n="//cdn.embedly.com/widgets/media.html?",r={url:"",image:"",video:"",video_secure:"true",type:"video/mp4",schema:"instagram"},i=function(e){var n=[];return t.each(e,function(e,t){n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}),n.join("&")},s=t.template('<iframe src="<%= src %>" scrolling="no" frameborder="0"></iframe>');return function(e,o){e=t.extend({},r,e),o=o||{},o.autoplay_video&&(e.autoplay="true"),o.loop_video&&(e.loop="1");var u=n+i(e);return s({src:u})}}),n("placeholder-image-generator/templates/base",["require","lodash"],function(e){var t=e("lodash");return t.template('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="<%= width %>" height="<%= height %>"><rect width="100%" height="100%" fill="<%= color %>"></rect><%= template %></svg>')}),n("placeholder-image-generator/templates/youtube",["require","lodash"],function(e){var t=e("lodash");return t.template('<svg version="1.1" x="<%= (19 / 32) * width %>" y="<%= (5 / 8) * height %>" width="<%= width / 2 %>" height="<%= height / 2%>"      viewBox="0 0 792 1224" enable-background="new 0 0 792 1224"><path fill="#FFFFFF" d="M599.3,594.6c-4.6,0-9.9,2.4-14.6,7.1l0,93.8c4.7,4.7,10,7.1,14.6,7.1c8.1,0,11.7-5.9,11.7-21.4v-66.5    C611,599.2,607.4,594.6,599.3,594.6z"/><path fill="#FFFFFF" d="M297,726h-29.4v-17c-11.1,12.8-20.6,19.2-30.9,19.2c-9,0-15.3-4.3-18.4-12c-1.9-4.7-3.3-12-3.3-22.7V569.8    h29.4v116c0,6.6,0,9.3,0,10.8c0.7,4.3,2.5,5.9,6.3,5.9c5.6,0,10.7-4.9,16.9-13.7V569.8H297L297,726L297,726z"/><path fill="#FFFFFF" d="M164,679.6c1.5,15.5-3.3,23.1-12.4,23.1s-13.9-7.7-12.4-23.1v-61.9c-1.5-15.5,3.2-22.7,12.4-22.7    c9.1,0,13.9,7.3,12.4,22.7L164,679.6L164,679.6z M193.3,620.8c0-16.7-3.4-29.2-9.3-37.1c-7.8-10.7-20.1-15.1-32.5-15.1    c-14,0-24.7,4.4-32.5,15.1c-6,7.9-9.3,20.6-9.3,37.3l0,55.6c0,16.6,2.9,28.1,8.9,35.9c7.8,10.7,20.5,16.3,32.9,16.3    s25.3-5.6,33.1-16.3c5.9-7.8,8.7-19.3,8.7-35.9V620.8L193.3,620.8z"/><path fill="#FFFFFF" d="M77.3,640.9V726H46.4v-85.1c0,0-32.1-104.3-38.7-123.8h32.5l21.7,81.5l21.6-81.5H116L77.3,640.9L77.3,640.9z    "/><g>    <path fill="#FFFFFF" d="M778.1,534c0,0-4.5-31.7-18.4-45.6c-17.6-18.3-37.3-18.4-46.3-19.5c-64.6-4.7-161.6-4.7-161.6-4.7h-0.2        c0,0-97,0-161.6,4.7c-9,1.1-28.7,1.2-46.3,19.5c-13.9,14-18.4,45.6-18.4,45.6s-4.6,37.2-4.6,74.4v34.9c0,37.2,4.6,74.4,4.6,74.4        s4.5,31.7,18.4,45.6c17.6,18.3,40.7,17.7,50.9,19.7c37,3.5,157,4.6,157,4.6s97.1-0.1,161.7-4.8c9-1.1,28.7-1.2,46.3-19.5        c13.8-14,18.4-45.6,18.4-45.6s4.6-37.2,4.6-74.4v-34.9C782.7,571.3,778.1,534,778.1,534z M422.3,726h-30.9V548.1h-32.5v-29.4        l97.5,0v29.4h-34V726z M533.7,726h-29.4v-17c-11.1,12.8-20.6,19.2-30.9,19.2c-9,0-15.3-4.3-18.4-12c-1.9-4.7-3.3-12-3.3-22.7V571.3        h29.4v114.5c0,6.6,0,9.3,0,10.8c0.7,4.3,2.5,5.9,6.3,5.9c5.6,0,10.7-4.9,16.9-13.7V571.3h29.4V726z M640.4,679.6        c0,14.3-1.2,24.4-3.1,30.9c-3.7,11.5-11.9,17.5-23,17.5c-10,0-20.2-6-29.5-17.6l0,15.6h-27.8V518.7h27.8l0,67.6        c9-11.1,19.3-17.5,29.6-17.5c11.2,0,18.6,6.4,22.4,18c1.9,6.2,3.7,16.2,3.7,30.9V679.6z M701.9,702.5c6.9,0,10.9-3.7,12.5-11.2        c0.3-1.5,0.2-8.2,0.2-19.4H744v4.4c0,9-0.7,15.4-1,18.2c-0.9,6.2-3.1,11.8-6.5,16.8c-7.7,11.2-19.2,16.8-33.9,16.8        c-14.7,0-25.8-5.3-33.9-15.8c-5.9-7.7-9.8-19.2-9.8-35.7v-54.1c0-16.5,3.5-29.3,9.4-37.1c8.1-10.6,19.3-16.2,33.5-16.2        c14,0,25.2,5.6,33.1,16.2c5.9,7.8,9.1,19.9,9.1,36.4l0,31.6h-55.7v27.8C688.2,695.4,692.3,702.5,701.9,702.5z"/>    <path fill="#FFFFFF" d="M714.6,613.2c0-14.3-3.7-18.6-13-18.6c-9.4,0-13.3,3.9-13.3,18.4v17.1l26.3,0V613.2z"/></g></svg>')}),n("placeholder-image-generator/js/main",["require","lodash","../templates/base","../templates/youtube"],function(e){var t=e("lodash"),n="data:image/svg+xml;charset=utf-8,",r={width:480,height:360,color:"#333333",template:""},i=e("../templates/base"),s={youtube:e("../templates/youtube")};return function(e){e=t.extend({},r,e);if(e.template!==""){var o=s[e.template];e.template=o?o(e):""}return n+encodeURIComponent(i(e))}}),n("placeholder-image-generator/index",["./js/main"],function(e){return e}),n("placeholder-image-generator",["placeholder-image-generator/index"],function(e){return e}),n("media-meta/js/main",["require","lodash","embedly","q","massrel-js","./embedly-widget","placeholder-image-generator"],function(e){var t=e("lodash"),n=e("embedly"),r=e("q"),i=e("massrel-js"),s=e("./embedly-widget"),o=e("placeholder-image-generator");r.stopUnhandledRejectionTracking();var u={promise:function(e,n){var i,s;return n=t.extend({},a,n),!e||!t.isFunction(N[e.sourceName])?(i=r.defer(),i.reject(),s=i.promise):s=N[e.sourceName](e,n),s},embedlyPromise:function(e,i){var s=r.defer();if(i&&!i.use_embedly)s.reject();else{var u=[];n(e).preview().then(function(e){if(!e.error_code&&e.object){var n=S(e.object.type),r=x(e.provider_name);if(n.photo||n.video){var a={};r.youtube&&(!e.images||!e.images.length)&&(e.images=[{caption:null,height:360,size:16076,url:o({width:480,height:360,template:"youtube"}),width:480}]),e.images&&e.images.length&&t.each(p,function(t){a[t]=e.images[0]});var f={type:n,provider:r,providerName:h[e.provider_name]||e.provider_name,photo_urls:a,author:e.author_name};if(n.video&&e.object.html){var l=e.object.html.match(/src=\"(.*?)\"/);if(i.autoplay_video&&l&&l.length>1&&l[1]){var c=l[1]+"&autoplay=true";f.embed_html=e.object.html.replace(l[1],c)}else f.embed_html=e.object.html}u.push(f)}}u.length===0?s.reject():s.resolve(u)}).fail(function(){s.reject()})}return s.promise}},a={autoplay_video:!1,prefetch:!1,loop_video:!1,muted:!1,secure:!1,use_embedly:!0},f={link:!1,video:!1,photo:!1},l={image:"photo",animated_gif:"video",youtube_video_media:"video"},c={vine:!1,twitter:!1,facebook:!1,google:!1,getglue:!1,youtube:!1,instagram:!1,vimeo:!1},h={YouTube:"youtube",Vine:"vine",Twitter:"twitter",Facebook:"facebook",GetGlue:"getglue","Google+":"google",Instagram:"instagram",Vimeo:"vimeo"},p=["huge","large","medium","small","thumb"],d={huge:"_n.",large:"_n.",medium:"_a.",small:"_s.",thumb:"_t."},v={huge:"w1500-h1500",large:"w800-h800",medium:"w400-h400",small:"w200-h200",thumb:"w75-h75"},m={huge:"large",large:"large",medium:"medium",small:"small",thumb:"thumb"},g={huge:"standard_resolution",large:"standard_resolution",medium:"low_resolution",small:"thumbnail",thumb:"thumbnail"},y={huge:"maxres",large:"standard",medium:"high",small:"medium",thumb:"default"},b=/https?:\/\/[^/]*googleusercontent.com\/.*\/w[0-9]+-h[0-9]+\/.*/,w=/https?:\/\/[^/]*fbcdn.*\/[^/]*_[nast]\.[a-zA-Z]+$/,E=/https?:\/\/video.twimg.com\/ext_tw_video\/.*?\/pu\/vid\/(.*?)x(.*?)\/.*?.mp4/,S=function(e,n){var r=e;e=l[e]||e;var i=t.extend({},f);return t.has(i,e)&&(i[e]=!0),n&&n.sourceNetwork&&n.sourceNetwork.facebook&&n.picture&&(i.photo=!0),i._originalType=r,i},x=function(e){e=h[e]||e;var n=t.extend({},c);return t.has(n,e)&&(n[e]=!0),n},T=function(e){return e&&e.user?"https://twitter.com/"+e.user.screen_name+"/status/"+e.id_str:""},N={twitter:function(e,n){var i=!1,o=!1,a=[],f=r.defer();if(e.entities){e.entities.media&&e.entities.media.length&&(i=!0,t.each(e.entities.media,function(r){var i={},o,u=S(r.type);t.each(m,function(e,t){o=r.sizes[e],i[t]={url:(n.secure?r.media_url_https:r.media_url)+":"+e,short_url:r.url,width:o.w,height:o.h}});if(u.photo)a.push({provider:x("twitter"),providerName:"twitter",type:u,link:T(e),photo_urls:i,author:e.user.screen_name});else if(u.video){var f=t(r.video_info.variants).filter(function(e){return e.content_type==="video/mp4"}).map(function(e){var t=i.huge.width,n=i.huge.height,r=E.exec(e.url);return r&&(t=parseInt(r[1],10),n=parseInt(r[2],10)),{url:e.url,content_type:e.content_type,bitrate:e.bitrate,width:t,height:n}}).sortBy(function(e){return e.height*e.width}).reverse().value();u._originalType==="animated_gif"&&(n=t.extend({},n,{loop_video:!0}));var l=s({video:f[0].url,image:i.huge.url,url:T(e)},n);a.push({provider:x("twitter"),providerName:"twitter",type:u,link:T(e),photo_urls:i,embed_html:l,author:e.user.screen_name,duration:r.video_info.duration_millis,video:f})}}));if(e.entities.urls&&e.entities.urls.length){i=!0,o=!0;var l=[];t.each(e.entities.urls,function(e){var t=u.embedlyPromise(e.expanded_url,n);l.push(t),t.then(function(e){a=a.concat(e)})}),r.allSettled(l).then(function(){a.length===0?f.reject():(t.each(a,function(t){t.link=T(e)}),f.resolve(a))})}}return o||(!i||a.length===0?f.reject():f.resolve(a)),f.promise},facebook:function(e){var n=r.defer(),i=S(e.type||e.kind,e);e.kind==="comment"&&e.attachment&&e.attachment.type==="photo"&&(e.picture=e.attachment.media.image.src,i.photo=!0);if(i.photo||i.link){var s={};if(e.images){var o=t.sortBy(e.images,"height"),u=p.slice().reverse();if(o.length===7){var a=[0,1,3,5,6];for(var f=0;f<a.length;f++){var l=u[f],c=o[a[f]];s[l]={url:c.source,height:c.height,width:c.width}}}else for(var f=0;f<u.length;f++){var l=u[f],c;f<o.length?c=o[f]:c=o[o.length-1],s[l]={url:c.source,height:c.height,width:c.width}}}else if(e.picture){var h=e.picture.replace(/v\/(.\/)?t1.0-\d*\/[p|s]\d*x\d*\//,"");h=h.replace(/v?\/t1.0-\d*(\/q\d*)?\/[p|s]\d*x\d*/,""),h=h.replace(/t1.0-\d*\/[p|s]\d*x\d*\//,"");var v=w.test(h);t.each(d,function(e,t){s[t]={url:v?h.replace(/_[nast]\./,e):h}})}var m;t.has(e,"from")?m=e.from.name:m=e.user.screen_name,n.resolve([{provider:x("facebook"),providerName:"facebook",type:i,photo_urls:s,link:e.link,name:e.name,caption:e.caption,description:e.description,author:m}]),t.has(e,"from")?n.author=e.from.name:n.author=e.user.screen_name}else n.reject();return n.promise},instagram:function(e,n){var i=r.defer();if(e.images){var s=S(e.type);if(s.photo||s.video){var o={};t.each(p,function(t){o[t]=e.images[g[t]],o[t].url=o[t].url.replace(/^https?:/,"")});var a=x("instagram"),f="instagram";if(s.photo)i.resolve([{provider:a,providerName:f,type:s,link:e.link,photo_urls:o,author:e.user.username}]);else if(s.video){var l=u.embedlyPromise(e.link,n);l.then(function(e){i.resolve(e)},function(){i.reject()})}}}else i.reject();return i.promise},google:function(e){var n=r.defer(),i=[];if(e.object&&e.object.attachments&&e.object.attachments.length){var s,o,u;t.each(e.object.attachments,function(n){s=S(n.objectType);if(!s.photo)return;u=b.test(n.image.url),o={},t.each(p,function(e){u?o[e]=t.extend({},n.image,{url:n.image.url.replace(/w[0-9]+-h[0-9]+/,v[e])}):o[e]=t.extend({},n.fullImage,{url:n.fullImage.url})}),i.push({provider:x("google"),providerName:"google",type:s,link:e.url,photo_urls:o,author:e.actor.displayName})})}return i.length===0?n.reject():n.resolve(i),n.promise},youtube:function(e,n){var i=r.defer();if(e.snippet){var s=S(e.kind),u={},a;t.each(p,function(t){var n=e.snippet.thumbnails[y[t]];n&&(u[t]=n,u[t].url=u[t].url.replace(/^https?:/,""),a||(a=u[t]))}),t.each(p,function(t){var n=e.snippet.thumbnails[y[t]];n||(u[t]=a,u[t].url=u[t].url.replace(/^https?:/,""))});var f=x("youtube"),l="youtube",c="//www.youtube.com/embed/"+e.youtube_video_id+"?rel=0";n.autoplay_video&&(c+="&autoplay=1");var h=t.map(u,function(e,t){var n=r.defer(),i=new Image;return i.onload=function(){this.width!==e.width&&this.height!==e.height?n.resolve([t,{width:e.width,height:e.height,url:o({width:e.width,height:e.height,template:"youtube"})}]):n.resolve([t,e])},i.src=e.url,n.promise});r.all(h).then(function(n){var r=t.zipObject(n);i.resolve([{provider:f,providerName:l,type:s,link:e.link,photo_urls:r,author:e.channelTitle,embed_url:c}])})}else i.reject();return i.promise},getglue:function(e){var n=r.defer(),i=[];if(e.object){var s=S(e.object.objectType),o={},u=x("getglue"),a="getglue";s.photo?(t.each(p,function(t){o[t]={url:e.object.link}}),i.push({provider:u,providerName:a,type:s,photo_urls:o,link:e.object.link})):s.video&&(t.each(p,function(t){o[t]={url:e.object.image}}),i.push({provider:u,providerName:a,type:s,photo_urls:o,link:e.object.link,author:e.user.username}))}return i.length>0?n.resolve(i):n.reject(),n.promise}};return u}),n("media-meta/index",["./js/main"],function(e){return e}),n("media-meta",["media-meta/index"],function(e){return e}),n("massrel-js-backbone/MediaCollection",["./backbone","./MediaModel","media-meta"],function(e,t,n){return e.Collection.extend({model:t})}),function(e){function X(e,t){return function(n){return Y(e.call(this,n),t)}}function V(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}function $(){}function J(e){lt(e),Q(this,e)}function K(e){var t=it(e),n=t.year||0,r=t.month||0,i=t.week||0,s=t.day||0,o=t.hour||0,u=t.minute||0,a=t.second||0,f=t.millisecond||0;this._input=e,this._milliseconds=+f+a*1e3+u*6e4+o*36e5,this._days=+s+i*7,this._months=+r+n*12,this._data={},this._bubble()}function Q(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function G(e){return e<0?Math.ceil(e):Math.floor(e)}function Y(e,t){var n=e+"";while(n.length<t)n="0"+n;return n}function Z(e,t,n,i){var s=t._milliseconds,o=t._days,u=t._months,a,f;s&&e._d.setTime(+e._d+s*n);if(o||u)a=e.minute(),f=e.hour();o&&e.date(e.date()+o*n),u&&e.month(e.month()+u*n),s&&!i&&r.updateOffset(e);if(o||u)e.minute(a),e.hour(f)}function et(e){return Object.prototype.toString.call(e)==="[object Array]"}function tt(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function nt(e,t,n){var r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0,o;for(o=0;o<r;o++)(n&&e[o]!==t[o]||!n&&ot(e[o])!==ot(t[o]))&&s++;return s+i}function rt(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=F[e]||I[t]||t}return e}function it(e){var t={},n,r,i;for(r in e)e.hasOwnProperty(r)&&(n=rt(r),n&&(t[n]=e[r]));return t}function st(t){var n,i;if(t.indexOf("week")===0)n=7,i="day";else{if(t.indexOf("month")!==0)return;n=12,i="month"}r[t]=function(s,o){var u,a,f=r.fn._lang[t],l=[];typeof s=="number"&&(o=s,s=e),a=function(e){var t=r().utc().set(i,e);return f.call(r.fn._lang,t,s||"")};if(o!=null)return a(o);for(u=0;u<n;u++)l.push(a(u));return l}}function ot(e){var t=+e,n=0;return t!==0&&isFinite(t)&&(t>=0?n=Math.floor(t):n=Math.ceil(t)),n}function ut(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function at(e){return ft(e)?366:365}function ft(e){return e%4===0&&e%100!==0||e%400===0}function lt(e){var t;e._a&&e._pf.overflow===-2&&(t=e._a[a]<0||e._a[a]>11?a:e._a[f]<1||e._a[f]>ut(e._a[u],e._a[a])?f:e._a[l]<0||e._a[l]>23?l:e._a[c]<0||e._a[c]>59?c:e._a[h]<0||e._a[h]>59?h:e._a[p]<0||e._a[p]>999?p:-1,e._pf._overflowDayOfYear&&(t<u||t>f)&&(t=f),e._pf.overflow=t)}function ct(e){e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function ht(e){return e._isValid==null&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&e._pf.charsLeftOver===0&&e._pf.unusedTokens.length===0)),e._isValid}function pt(e){return e?e.toLowerCase().replace("_","-"):e}function dt(e,t){return t.abbr=e,d[e]||(d[e]=new $),d[e].set(t),d[e]}function vt(e){delete d[e]}function mt(e){var n=0,i,s,o,u,a=function(e){if(!d[e]&&v)try{t("./lang/"+e)}catch(n){}return d[e]};if(!e)return r.fn._lang;if(!et(e)){s=a(e);if(s)return s;e=[e]}while(n<e.length){u=pt(e[n]).split("-"),i=u.length,o=pt(e[n+1]),o=o?o.split("-"):null;while(i>0){s=a(u.slice(0,i).join("-"));if(s)return s;if(o&&o.length>=i&&nt(u,o,!0)>=i-1)break;i--}n++}return r.fn._lang}function gt(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function yt(e){var t=e.match(b),n,r;for(n=0,r=t.length;n<r;n++)z[t[n]]?t[n]=z[t[n]]:t[n]=gt(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=t[n]instanceof Function?t[n].call(i,e):t[n];return s}}function bt(e,t){return e.isValid()?(t=wt(t,e.lang()),q[t]||(q[t]=yt(t)),q[t](e)):e.lang().invalidDate()}function wt(e,t){function r(e){return t.longDateFormat(e)||e}var n=5;w.lastIndex=0;while(n>=0&&w.test(e))e=e.replace(w,r),w.lastIndex=0,n-=1;return e}function Et(e,t){var n;switch(e){case"DDDD":return x;case"YYYY":case"GGGG":case"gggg":return T;case"YYYYY":case"GGGGG":case"ggggg":return N;case"S":case"SS":case"SSS":case"DDD":return S;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return k;case"a":case"A":return mt(t._l)._meridiemParse;case"X":return O;case"Z":case"ZZ":return L;case"T":return A;case"SSSS":return C;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return E;default:return n=new RegExp(At(Lt(e.replace("\\","")),"i")),n}}function St(e){var t=(L.exec(e)||[])[0],n=(t+"").match(H)||["-",0,0],r=+(n[1]*60)+ot(n[2]);return n[0]==="+"?-r:r}function xt(e,t,n){var r,i=n._a;switch(e){case"M":case"MM":t!=null&&(i[a]=ot(t)-1);break;case"MMM":case"MMMM":r=mt(n._l).monthsParse(t),r!=null?i[a]=r:n._pf.invalidMonth=t;break;case"D":case"DD":t!=null&&(i[f]=ot(t));break;case"DDD":case"DDDD":t!=null&&(n._dayOfYear=ot(t));break;case"YY":i[u]=ot(t)+(ot(t)>68?1900:2e3);break;case"YYYY":case"YYYYY":i[u]=ot(t);break;case"a":case"A":n._isPm=mt(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":i[l]=ot(t);break;case"m":case"mm":i[c]=ot(t);break;case"s":case"ss":i[h]=ot(t);break;case"S":case"SS":case"SSS":case"SSSS":i[p]=ot(("0."+t)*1e3);break;case"X":n._d=new Date(parseFloat(t)*1e3);break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=St(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":e=e.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=t)}}function Tt(e){var t,n,i=[],s,o,h,p,d,v,m,g;if(e._d)return;s=Ct(e),e._w&&e._a[f]==null&&e._a[a]==null&&(h=function(t){return t?t.length<3?parseInt(t,10)>68?"19"+t:"20"+t:t:e._a[u]==null?r().weekYear():e._a[u]},p=e._w,p.GG!=null||p.W!=null||p.E!=null?d=It(h(p.GG),p.W||1,p.E,4,1):(v=mt(e._l),m=p.d!=null?Ht(p.d,v):p.e!=null?parseInt(p.e,10)+v._week.dow:0,g=parseInt(p.w,10)||1,p.d!=null&&m<v._week.dow&&g++,d=It(h(p.gg),g,m,v._week.doy,v._week.dow)),e._a[u]=d.year,e._dayOfYear=d.dayOfYear),e._dayOfYear&&(o=e._a[u]==null?s[u]:e._a[u],e._dayOfYear>at(o)&&(e._pf._overflowDayOfYear=!0),n=Pt(o,0,e._dayOfYear),e._a[a]=n.getUTCMonth(),e._a[f]=n.getUTCDate());for(t=0;t<3&&e._a[t]==null;++t)e._a[t]=i[t]=s[t];for(;t<7;t++)e._a[t]=i[t]=e._a[t]==null?t===2?1:0:e._a[t];i[l]+=ot((e._tzm||0)/60),i[c]+=ot((e._tzm||0)%60),e._d=(e._useUTC?Pt:Dt).apply(null,i)}function Nt(e){var t;if(e._d)return;t=it(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],Tt(e)}function Ct(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function kt(e){e._a=[],e._pf.empty=!0;var t=mt(e._l),n=""+e._i,r,i,s,o,u,a=n.length,f=0;s=wt(e._f,t).match(b)||[];for(r=0;r<s.length;r++)o=s[r],i=(Et(o,e).exec(n)||[])[0],i&&(u=n.substr(0,n.indexOf(i)),u.length>0&&e._pf.unusedInput.push(u),n=n.slice(n.indexOf(i)+i.length),f+=i.length),z[o]?(i?e._pf.empty=!1:e._pf.unusedTokens.push(o),xt(o,i,e)):e._strict&&!i&&e._pf.unusedTokens.push(o);e._pf.charsLeftOver=a-f,n.length>0&&e._pf.unusedInput.push(n),e._isPm&&e._a[l]<12&&(e._a[l]+=12),e._isPm===!1&&e._a[l]===12&&(e._a[l]=0),Tt(e),lt(e)}function Lt(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i})}function At(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ot(e){var t,n,r,i,s;if(e._f.length===0){e._pf.invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++){s=0,t=Q({},e),ct(t),t._f=e._f[i],kt(t);if(!ht(t))continue;s+=t._pf.charsLeftOver,s+=t._pf.unusedTokens.length*10,t._pf.score=s;if(r==null||s<r)r=s,n=t}Q(e,n||t)}function Mt(e){var t,n=e._i,r=M.exec(n);if(r){e._pf.iso=!0;for(t=4;t>0;t--)if(r[t]){e._f=D[t-1]+(r[6]||" ");break}for(t=0;t<4;t++)if(P[t][1].exec(n)){e._f+=P[t][0];break}L.exec(n)&&(e._f+="Z"),kt(e)}else e._d=new Date(n)}function _t(t){var n=t._i,r=m.exec(n);n===e?t._d=new Date:r?t._d=new Date(+r[1]):typeof n=="string"?Mt(t):et(n)?(t._a=n.slice(0),Tt(t)):tt(n)?t._d=new Date(+n):typeof n=="object"?Nt(t):t._d=new Date(n)}function Dt(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return e<1970&&u.setFullYear(e),u}function Pt(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function Ht(e,t){if(typeof e=="string")if(!isNaN(e))e=parseInt(e,10);else{e=t.weekdaysParse(e);if(typeof e!="number")return null}return e}function Bt(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function jt(e,t,n){var r=s(Math.abs(e)/1e3),i=s(r/60),o=s(i/60),u=s(o/24),a=s(u/365),f=r<45&&["s",r]||i===1&&["m"]||i<45&&["mm",i]||o===1&&["h"]||o<22&&["hh",o]||u===1&&["d"]||u<=25&&["dd",u]||u<=45&&["M"]||u<345&&["MM",s(u/30)]||a===1&&["y"]||["yy",a];return f[2]=t,f[3]=e>0,f[4]=n,Bt.apply({},f)}function Ft(e,t,n){var i=n-t,s=n-e.day(),o;return s>i&&(s-=7),s<i-7&&(s+=7),o=r(e).add("d",s),{week:Math.ceil(o.dayOfYear()/7),year:o.year()}}function It(e,t,n,r,i){var s=(new Date(Date.UTC(e,0))).getUTCDay(),o,u;return n=n!=null?n:i,o=i-s+(s>r?7:0),u=7*(t-1)+(n-i)+o+1,{year:u>0?e:e-1,dayOfYear:u>0?u:at(e-1)+u}}function qt(e){var t=e._i,n=e._f;return typeof e._pf=="undefined"&&ct(e),t===null?r.invalid({nullInput:!0}):(typeof t=="string"&&(e._i=t=mt().preparse(t)),r.isMoment(t)?(e=Q({},t),e._d=new Date(+t._d)):n?et(n)?Ot(e):kt(e):_t(e),new J(e))}function Rt(e,t){r.fn[e]=r.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return e!=null?(this._d["set"+n+t](e),r.updateOffset(this),this):this._d["get"+n+t]()}}function Ut(e){r.duration.fn[e]=function(){return this._data[e]}}function zt(e,t){r.duration.fn["as"+e]=function(){return+this/t}}function Wt(e){var t=!1,n=r;if(typeof ender!="undefined")return;e?this.moment=function(){return!t&&console&&console.warn&&(t=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),n.apply(null,arguments)}:this.moment=r}var r,i="2.4.0",s=Math.round,o,u=0,a=1,f=2,l=3,c=4,h=5,p=6,d={},v=typeof module!="undefined"&&module.exports,m=/^\/?Date\((\-?\d+)/i,g=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,y=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,b=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,w=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,E=/\d\d?/,S=/\d{1,3}/,x=/\d{3}/,T=/\d{1,4}/,N=/[+\-]?\d{1,6}/,C=/\d+/,k=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,L=/Z|[\+\-]\d\d:?\d\d/i,A=/T/i,O=/[\+\-]?\d+(\.\d{1,3})?/,M=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d:?\d\d|Z)?)?$/,_="YYYY-MM-DDTHH:mm:ssZ",D=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],P=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],H=/([\+\-]|\d\d)/gi,B="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),j={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},F={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},I={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},q={},R="DDD w W M D d".split(" "),U="M D H h m s w W".split(" "),z={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return Y(this.year()%100,2)},YYYY:function(){return Y(this.year(),4)},YYYYY:function(){return Y(this.year(),5)},gg:function(){return Y(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return Y(this.weekYear(),5)},GG:function(){return Y(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return Y(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return ot(this.milliseconds()/100)},SS:function(){return Y(ot(this.milliseconds()/10),2)},SSS:function(){return Y(this.milliseconds(),3)},SSSS:function(){return Y(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+Y(ot(e/60),2)+":"+Y(ot(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+Y(ot(10*e/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}},W=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];while(R.length)o=R.pop(),z[o+"o"]=V(z[o],o);while(U.length)o=U.pop(),z[o+o]=X(z[o],2);z.DDDD=X(z.DDD,3),Q($.prototype,{set:function(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;this._monthsParse||(this._monthsParse=[]);for(t=0;t<12;t++){this._monthsParse[t]||(n=r.utc([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(i.replace(".",""),"i"));if(this._monthsParse[t].test(e))return t}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,i;this._weekdaysParse||(this._weekdaysParse=[]);for(t=0;t<7;t++){this._weekdaysParse[t]||(n=r([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i"));if(this._weekdaysParse[t].test(e))return t}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return(e+"").toLowerCase().charAt(0)==="p"},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return typeof n=="function"?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return Ft(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),r=function(t,n,r,i){return typeof r=="boolean"&&(i=r,r=e),qt({_i:t,_f:n,_l:r,_strict:i,_isUTC:!1})},r.utc=function(t,n,r,i){var s;return typeof r=="boolean"&&(i=r,r=e),s=qt({_useUTC:!0,_isUTC:!0,_l:r,_i:t,_f:n,_strict:i}).utc(),s},r.unix=function(e){return r(e*1e3)},r.duration=function(e,t){var n=r.isDuration(e),i=typeof e=="number",s=n?e._input:i?{}:e,o=null,u,a,d,v,m;return i?t?s[t]=e:s.milliseconds=e:(o=g.exec(e))?(u=o[1]==="-"?-1:1,s={y:0,d:ot(o[f])*u,h:ot(o[l])*u,m:ot(o[c])*u,s:ot(o[h])*u,ms:ot(o[p])*u}):!(o=y.exec(e))||(u=o[1]==="-"?-1:1,d=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*u},s={y:d(o[2]),M:d(o[3]),d:d(o[4]),h:d(o[5]),m:d(o[6]),s:d(o[7]),w:d(o[8])}),a=new K(s),n&&e.hasOwnProperty("_lang")&&(a._lang=e._lang),a},r.version=i,r.defaultFormat=_,r.updateOffset=function(){},r.lang=function(e,t){var n;return e?(t?dt(pt(e),t):t===null?(vt(e),e="en"):d[e]||mt(e),n=r.duration.fn._lang=r.fn._lang=mt(e),n._abbr):r.fn._lang._abbr},r.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),mt(e)},r.isMoment=function(e){return e instanceof J},r.isDuration=function(e){return e instanceof K};for(o=W.length-1;o>=0;--o)st(W[o]);r.normalizeUnits=function(e){return rt(e)},r.invalid=function(e){var t=r.utc(NaN);return e!=null?Q(t._pf,e):t._pf.userInvalidated=!0,t},r.parseZone=function(e){return r(e).parseZone()},Q(r.fn=J.prototype,{clone:function(){return r(this)},valueOf:function(){return+this._d+(this._offset||0)*6e4},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return bt(r(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return ht(this)},isDSTShifted:function(){return this._a?this.isValid()&&nt(this._a,(this._isUTC?r.utc(this._a):r(this._a)).toArray())>0:!1},parsingFlags:function(){return Q({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=bt(this,e||r.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return typeof e=="string"?n=r.duration(+t,e):n=r.duration(e,t),Z(this,n,1),this},subtract:function(e,t){var n;return typeof e=="string"?n=r.duration(+t,e):n=r.duration(e,t),Z(this,n,-1),this},diff:function(e,t,n){var i=this._isUTC?r(e).zone(this._offset||0):r(e).local(),s=(this.zone()-i.zone())*6e4,o,u;return t=rt(t),t==="year"||t==="month"?(o=(this.daysInMonth()+i.daysInMonth())*432e5,u=(this.year()-i.year())*12+(this.month()-i.month()),u+=(this-r(this).startOf("month")-(i-r(i).startOf("month")))/o,u-=(this.zone()-r(this).startOf("month").zone()-(i.zone()-r(i).startOf("month").zone()))*6e4/o,t==="year"&&(u/=12)):(o=this-i,u=t==="second"?o/1e3:t==="minute"?o/6e4:t==="hour"?o/36e5:t==="day"?(o-s)/864e5:t==="week"?(o-s)/6048e5:o),n?u:G(u)},from:function(e,t){return r.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(r(),e)},calendar:function(){var e=this.diff(r().zone(this.zone()).startOf("day"),"days",!0),t=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){return ft(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=Ht(e,this.lang()),this.add({d:e-t})):t},month:function(e){var t=this._isUTC?"UTC":"",n;if(e!=null){if(typeof e=="string"){e=this.lang().monthsParse(e);if(typeof e!="number")return this}return n=this.date(),this.date(1),this._d["set"+t+"Month"](e),this.date(Math.min(n,this.daysInMonth())),r.updateOffset(this),this}return this._d["get"+t+"Month"]()},startOf:function(e){e=rt(e);switch(e){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"?this.weekday(0):e==="isoWeek"&&this.isoWeekday(1),this},endOf:function(e){return e=rt(e),this.startOf(e).add(e==="isoWeek"?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t=typeof t!="undefined"?t:"millisecond",+this.clone().startOf(t)>+r(e).startOf(t)},isBefore:function(e,t){return t=typeof t!="undefined"?t:"millisecond",+this.clone().startOf(t)<+r(e).startOf(t)},isSame:function(e,t){return t=typeof t!="undefined"?t:"millisecond",+this.clone().startOf(t)===+r(e).startOf(t)},min:function(e){return e=r.apply(null,arguments),e<this?this:e},max:function(e){return e=r.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return e==null?this._isUTC?t:this._d.getTimezoneOffset():(typeof e=="string"&&(e=St(e)),Math.abs(e)<16&&(e*=60),this._offset=e,this._isUTC=!0,t!==e&&Z(this,r.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return typeof this._i=="string"&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e?e=r(e).zone():e=0,(this.zone()-e)%60===0},daysInMonth:function(){return ut(this.year(),this.month())},dayOfYear:function(e){var t=s((r(this).startOf("day")-r(this).startOf("year"))/864e5)+1;return e==null?t:this.add("d",e-t)},weekYear:function(e){var t=Ft(this,this.lang()._week.dow,this.lang()._week.doy).year;return e==null?t:this.add("y",e-t)},isoWeekYear:function(e){var t=Ft(this,1,4).year;return e==null?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return e==null?t:this.add("d",(e-t)*7)},isoWeek:function(e){var t=Ft(this,1,4).week;return e==null?t:this.add("d",(e-t)*7)},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return e==null?t:this.add("d",e-t)},isoWeekday:function(e){return e==null?this.day()||7:this.day(this.day()%7?e:e-7)},get:function(e){return e=rt(e),this[e]()},set:function(e,t){return e=rt(e),typeof this[e]=="function"&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=mt(t),this)}});for(o=0;o<B.length;o++)Rt(B[o].toLowerCase().replace(/s$/,""),B[o]);Rt("year","FullYear"),r.fn.days=r.fn.day,r.fn.months=r.fn.month,r.fn.weeks=r.fn.week,r.fn.isoWeeks=r.fn.isoWeek,r.fn.toJSON=r.fn.toISOString,Q(r.duration.fn=K.prototype,{_bubble:function(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data,i,s,o,u;r.milliseconds=e%1e3,i=G(e/1e3),r.seconds=i%60,s=G(i/60),r.minutes=s%60,o=G(s/60),r.hours=o%24,t+=G(o/24),r.days=t%30,n+=G(t/30),r.months=n%12,u=G(n/12),r.years=u},weeks:function(){return G(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+ot(this._months/12)*31536e6},humanize:function(e){var t=+this,n=jt(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,t){var n=r.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=r.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=rt(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=rt(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:r.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),r=Math.abs(this.hours()),i=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(r||i||s?"T":"")+(r?r+"H":"")+(i?i+"M":"")+(s?s+"S":""):"P0D"}});for(o in j)j.hasOwnProperty(o)&&(zt(o,j[o]),Ut(o.toLowerCase()));zt("Weeks",6048e5),r.duration.fn.asMonths=function(){return(+this-this.years()*31536e6)/2592e6+this.years()*12},r.lang("en",{ordinal:function(e){var t=e%10,n=ot(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),v?(module.exports=r,Wt(!0)):typeof n=="function"&&n.amd?n("moment",["require","exports","module"],function(t,n,i){return i.config().noGlobal!==!0&&Wt(i.config().noGlobal===e),r}):Wt()}.call(this),n("massrel-js-backbone/StatusModel",["require","./backbone","./MediaCollection","lodash","moment"],function(e){var t=e("./backbone"),n=e("./MediaCollection"),r=e("lodash"),i=e("moment"),s=new RegExp("(https?:)?//i\\.embed\\.ly/\\d+/image"),o={minute:i.duration(1,"minute").asMilliseconds(),hour:i.duration(1,"hour").asMilliseconds(),day:i.duration(1,"day").asMilliseconds(),week:i.duration(1,"week").asMilliseconds(),month:i.duration(1,"month").asMilliseconds()};return t.Model.extend({idAttribute:"_id",defaults:function(){return{retweet:!1,formattedDate:"",relativeDateFormat:"display",formattedText:"",klout:null,formattedStory:"",config:{},place:null,media:new n}},constructor:function(e,n){n=n||{},n.parse=!0,t.Model.call(this,e,n),this.generateFormattedDates()},embedlyImageProxyUrl:function(e){return s.test(e)||(e="//i.embed.ly/1/image?key=fd577f7497bf11e0b95d4040d3dc5c07&url="+window.encodeURIComponent(e)),e},parse:function(e){return e._id=r.uniqueId(),e.klout=this.kloutData(e),e},kloutData:function(e){var t=e.massrel&&e.massrel.klout||null;return t&&t.score&&(t.score_floor=Math.floor(window.parseInt(t.score))),t},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("created_at")))},formattedDates:function(e,t){var n={display:e,"short":e,full:e,timestamp:e},r=i(e,t);return r.isValid()&&(n={display:this.displayDate(r),"short":this.shortDate(r),full:this.fullDate(r),timestamp:this.timestamp(r)}),n},displayDate:function(e){return e.fromNow()},shortDate:function(e){var t=i().diff(e),n=i.duration(t),r;return t<o.minute?r=n.seconds()+"s":t<o.hour?r=n.minutes()+"m":t<o.day?r=n.hours()+"h":t<o.week?r=n.days()+"d":t<o.month?r=n.weeks()+"w":r=e.format("M/D/YY"),r},fullDate:function(e){return e.format("lll")},timestamp:function(e){return e.toISOString()}})}),function(){function r(t,n){return n=n||"",typeof t!="string"&&(t.global&&n.indexOf("g")<0&&(n+="g"),t.ignoreCase&&n.indexOf("i")<0&&(n+="i"),t.multiline&&n.indexOf("m")<0&&(n+="m"),t=t.source),new RegExp(t.replace(/#\{(\w+)\}/g,function(t,n){var r=e.txt.regexen[n]||"";return typeof r!="string"&&(r=r.source),r}),n)}function i(e,t){return e.replace(/#\{(\w+)\}/g,function(e,n){return t[n]||""})}function s(e,t,n){var r=String.fromCharCode(t);return n!==t&&(r+="-"+String.fromCharCode(n)),e.push(r),e}function g(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function E(e,t,n){return n?!e||e.match(t)&&RegExp["$&"]===e:typeof e=="string"&&e.match(t)&&RegExp["$&"]===e}if(typeof e=="undefined"||e===null)var e={};e.txt={},e.txt.regexen={};var t={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};e.txt.htmlEscape=function(e){return e&&e.replace(/[&"'><]/g,function(e){return t[e]})},e.txt.regexSupplant=r,e.txt.stringSupplant=i,e.txt.addCharsToCharClass=s;var o=String.fromCharCode,u=[o(32),o(133),o(160),o(5760),o(6158),o(8232),o(8233),o(8239),o(8287),o(12288)];s(u,9,13),s(u,8192,8202);var a=[o(65534),o(65279),o(65535)];s(a,8234,8238),e.txt.regexen.spaces_group=r(u.join("")),e.txt.regexen.spaces=r("["+u.join("")+"]"),e.txt.regexen.invalid_chars_group=r(a.join("")),e.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/,e.txt.regexen.rtl_chars=/[\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF]/mg,e.txt.regexen.non_bmp_code_pairs=/[\uD800-\uDBFF][\uDC00-\uDFFF]/mg;var f=[];s(f,1024,1279),s(f,1280,1319),s(f,11744,11775),s(f,42560,42655),s(f,1425,1471),s(f,1473,1474),s(f,1476,1477),s(f,1479,1479),s(f,1488,1514),s(f,1520,1524),s(f,64274,64296),s(f,64298,64310),s(f,64312,64316),s(f,64318,64318),s(f,64320,64321),s(f,64323,64324),s(f,64326,64335),s(f,1552,1562),s(f,1568,1631),s(f,1646,1747),s(f,1749,1756),s(f,1758,1768),s(f,1770,1775),s(f,1786,1788),s(f,1791,1791),s(f,1872,1919),s(f,2208,2208),s(f,2210,2220),s(f,2276,2302),s(f,64336,64433),s(f,64467,64829),s(f,64848,64911),s(f,64914,64967),s(f,65008,65019),s(f,65136,65140),s(f,65142,65276),s(f,8204,8204),s(f,3585,3642),s(f,3648,3662),s(f,4352,4607),s(f,12592,12677),s(f,43360,43391),s(f,44032,55215),s(f,55216,55295),s(f,65441,65500),s(f,12449,12538),s(f,12540,12542),s(f,65382,65439),s(f,65392,65392),s(f,65296,65305),s(f,65313,65338),s(f,65345,65370),s(f,12353,12438),s(f,12441,12446),s(f,13312,19903),s(f,19968,40959),s(f,173824,177983),s(f,177984,178207),s(f,194560,195103),s(f,12291,12291),s(f,12293,12293),s(f,12347,12347),e.txt.regexen.nonLatinHashtagChars=r(f.join(""));var l=[];s(l,192,214),s(l,216,246),s(l,248,255),s(l,256,591),s(l,595,596),s(l,598,599),s(l,601,601),s(l,603,603),s(l,611,611),s(l,616,616),s(l,623,623),s(l,626,626),s(l,649,649),s(l,651,651),s(l,699,699),s(l,768,879),s(l,7680,7935),e.txt.regexen.latinAccentChars=r(l.join("")),e.txt.regexen.hashSigns=/[#ï¼]/,e.txt.regexen.hashtagAlpha=r(/[a-z_#{latinAccentChars}#{nonLatinHashtagChars}]/i),e.txt.regexen.hashtagAlphaNumeric=r(/[a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}]/i),e.txt.regexen.endHashtagMatch=r(/^(?:#{hashSigns}|:\/\/)/),e.txt.regexen.hashtagBoundary=r(/(?:^|$|[^&a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}])/),e.txt.regexen.validHashtag=r(/(#{hashtagBoundary})(#{hashSigns})(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi),e.txt.regexen.validMentionPrecedingChars=/(?:^|[^a-zA-Z0-9_!#$%&*@ï¼ ]|(?:rt|RT|rT|Rt):?)/,e.txt.regexen.atSigns=/[@ï¼ ]/,e.txt.regexen.validMentionOrList=r("(#{validMentionPrecedingChars})(#{atSigns})([a-zA-Z0-9_]{1,20})(/[a-zA-Z][a-zA-Z0-9_-]{0,24})?","g"),e.txt.regexen.validReply=r(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/),e.txt.regexen.endMentionMatch=r(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/),e.txt.regexen.validUrlPrecedingChars=r(/(?:[^A-Za-z0-9@ï¼ $#ï¼#{invalid_chars_group}]|^)/),e.txt.regexen.invalidUrlWithoutProtocolPrecedingChars=/[-_.\/]$/,e.txt.regexen.invalidDomainChars=i("#{punct}#{spaces_group}#{invalid_chars_group}",e.txt.regexen),e.txt.regexen.validDomainChars=r(/[^#{invalidDomainChars}]/),e.txt.regexen.validSubdomain=r(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/),e.txt.regexen.validDomainName=r(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/),e.txt.regexen.validGTLD=r(RegExp("(?:(?:academy|accountants|active|actor|aero|agency|airforce|archi|army|arpa|asia|associates|attorney|audio|autos|axa|bar|bargains|bayern|beer|berlin|best|bid|bike|bio|biz|black|blackfriday|blue|bmw|boutique|brussels|build|builders|buzz|bzh|cab|camera|camp|cancerresearch|capetown|capital|cards|care|career|careers|cash|cat|catering|center|ceo|cheap|christmas|church|citic|claims|cleaning|clinic|clothing|club|codes|coffee|college|cologne|com|community|company|computer|condos|construction|consulting|contractors|cooking|cool|coop|country|credit|creditcard|cruises|cuisinella|dance|dating|degree|democrat|dental|dentist|desi|diamonds|digital|direct|directory|discount|dnp|domains|durban|edu|education|email|engineer|engineering|enterprises|equipment|estate|eus|events|exchange|expert|exposed|fail|farm|feedback|finance|financial|fish|fishing|fitness|flights|florist|foo|foundation|frogans|fund|furniture|futbol|gal|gallery|gift|gives|glass|global|globo|gmo|gop|gov|graphics|gratis|green|gripe|guide|guitars|guru|hamburg|haus|hiphop|hiv|holdings|holiday|homes|horse|host|house|immobilien|industries|info|ink|institute|insure|int|international|investments|jetzt|jobs|joburg|juegos|kaufen|kim|kitchen|kiwi|koeln|kred|land|lawyer|lease|lgbt|life|lighting|limited|limo|link|loans|london|lotto|luxe|luxury|maison|management|mango|market|marketing|media|meet|menu|miami|mil|mini|mobi|moda|moe|monash|mortgage|moscow|motorcycles|museum|nagoya|name|navy|net|neustar|nhk|ninja|nyc|okinawa|onl|org|organic|ovh|paris|partners|parts|photo|photography|photos|physio|pics|pictures|pink|place|plumbing|post|press|pro|productions|properties|pub|qpon|quebec|recipes|red|rehab|reise|reisen|ren|rentals|repair|report|republican|rest|reviews|rich|rio|rocks|rodeo|ruhr|ryukyu|saarland|schmidt|schule|scot|services|sexy|shiksha|shoes|singles|social|software|sohu|solar|solutions|soy|space|spiegel|supplies|supply|support|surf|surgery|suzuki|systems|tattoo|tax|technology|tel|tienda|tips|tirol|today|tokyo|tools|town|toys|trade|training|travel|university|uno|vacations|vegas|ventures|versicherung|vet|viajes|villas|vision|vlaanderen|vodka|vote|voting|voto|voyage|wang|watch|webcam|website|wed|wien|wiki|works|wtc|wtf|xxx|xyz|yachts|yokohama|zone|Ð´ÐµÑÐ¸|Ð¼Ð¾ÑÐºÐ²Ð°|Ð¾Ð½Ð»Ð°Ð¹Ð½|Ð¾ÑÐ³|ÑÐ°Ð¹Ñ|Ø¨Ø§Ø²Ø§Ø±|Ø´Ø¨ÙØ©|ÙÙÙØ¹|à¤¸à¤à¤à¤ à¤¨|ã¿ããª|ä¸ç|ä¸­ä¿¡|ä¸­æç½|å¬å¸|å¬ç|åå|åæ |å¨çº¿|æç±ä½ |æ¿å¡|æºæ|æ¸¸æ|ç§»å¨|ç»ç»æºæ|ç½å|ç½ç»|éå¢|ì¼ì±)(?=[^0-9a-zA-Z@]|$))")),e.txt.regexen.validCCTLD=r(RegExp("(?:(?:ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bl|bm|bn|bo|bq|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mf|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|Ð¼ÐºÐ´|Ð¼Ð¾Ð½|ÑÑ|ÑÑÐ±|ÑÐºÑ|ÒÐ°Ð·|Ø§ÙØ§Ø±Ø¯Ù|Ø§ÙØ¬Ø²Ø§Ø¦Ø±|Ø§ÙØ³Ø¹ÙØ¯ÙØ©|Ø§ÙÙØºØ±Ø¨|Ø§ÙØ§Ø±Ø§Øª|Ø§ÛØ±Ø§Ù|Ø¨Ú¾Ø§Ø±Øª|ØªÙÙØ³|Ø³ÙØ¯Ø§Ù|Ø³ÙØ±ÙØ©|Ø¹ÙØ§Ù|ÙÙØ³Ø·ÙÙ|ÙØ·Ø±|ÙØµØ±|ÙÙÙØ³ÙØ§|Ù¾Ø§Ú©Ø³ØªØ§Ù|à¤­à¤¾à¤°à¤¤|à¦¬à¦¾à¦à¦²à¦¾|à¦­à¦¾à¦°à¦¤|à¨­à¨¾à¨°à¨¤|àª­àª¾àª°àª¤|à®à®¨à¯à®¤à®¿à®¯à®¾|à®à®²à®à¯à®à¯|à®à®¿à®à¯à®à®ªà¯à®ªà¯à®°à¯|à°­à°¾à°°à°¤à±|à¶½à¶à¶à·|à¹à¸à¸¢|áá|ä¸­å½|ä¸­å|å°æ¹¾|å°ç£|æ°å å¡|é¦æ¸¯|íêµ­)(?=[^0-9a-zA-Z@]|$))")),e.txt.regexen.validPunycode=r(/(?:xn--[0-9a-z]+)/),e.txt.regexen.validSpecialCCTLD=r(RegExp("(?:(?:co|tv)(?=[^0-9a-zA-Z@]|$))")),e.txt.regexen.validDomain=r(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/),e.txt.regexen.validAsciiDomain=r(/(?:(?:[\-a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi),e.txt.regexen.invalidShortDomain=r(/^#{validDomainName}#{validCCTLD}$/i),e.txt.regexen.validSpecialShortDomain=r(/^#{validDomainName}#{validSpecialCCTLD}$/i),e.txt.regexen.validPortNumber=r(/[0-9]+/),e.txt.regexen.validGeneralUrlPathChars=r(/[a-z0-9!\*';:=\+,\.\$\/%#\[\]\-_~@|&#{latinAccentChars}]/i),e.txt.regexen.validUrlBalancedParens=r("\\((?:#{validGeneralUrlPathChars}+|(?:#{validGeneralUrlPathChars}*\\(#{validGeneralUrlPathChars}+\\)#{validGeneralUrlPathChars}*))\\)","i"),e.txt.regexen.validUrlPathEndingChars=r(/[\+\-a-z0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i),e.txt.regexen.validUrlPath=r("(?:(?:#{validGeneralUrlPathChars}*(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*#{validUrlPathEndingChars})|(?:@#{validGeneralUrlPathChars}+/))","i"),e.txt.regexen.validUrlQueryChars=/[a-z0-9!?\*'@\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i,e.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i,e.txt.regexen.extractUrl=r("((#{validUrlPrecedingChars})((https?:\\/\\/)?(#{validDomain})(?::(#{validPortNumber}))?(\\/#{validUrlPath}*)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi"),e.txt.regexen.validTcoUrl=/^https?:\/\/t\.co\/[a-z0-9]+/i,e.txt.regexen.urlHasProtocol=/^https?:\/\//i,e.txt.regexen.urlHasHttps=/^https:\/\//i,e.txt.regexen.cashtag=/[a-z]{1,6}(?:[._][a-z]{1,2})?/i,e.txt.regexen.validCashtag=r("(^|#{spaces})(\\$)(#{cashtag})(?=$|\\s|[#{punct}])","gi"),e.txt.regexen.validateUrlUnreserved=/[a-z0-9\-._~]/i,e.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i,e.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i,e.txt.regexen.validateUrlPchar=r("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|[:|@])","i"),e.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i,e.txt.regexen.validateUrlUserinfo=r("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*","i"),e.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i,e.txt.regexen.validateUrlIpv4=r(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i),e.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i,e.txt.regexen.validateUrlIp=r("(?:#{validateUrlIpv4}|#{validateUrlIpv6})","i"),e.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i,e.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i,e.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i,e.txt.regexen.validateUrlDomain=r(/(?:(?:#{validateUrlSubDomainSegment]}\.)*(?:#{validateUrlDomainSegment]}\.)#{validateUrlDomainTld})/i),e.txt.regexen.validateUrlHost=r("(?:#{validateUrlIp}|#{validateUrlDomain})","i"),e.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,e.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,e.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,e.txt.regexen.validateUrlUnicodeDomain=r(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i),e.txt.regexen.validateUrlUnicodeHost=r("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})","i"),e.txt.regexen.validateUrlPort=/[0-9]{1,5}/,e.txt.regexen.validateUrlUnicodeAuthority=r("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?","i"),e.txt.regexen.validateUrlAuthority=r("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?","i"),e.txt.regexen.validateUrlPath=r(/(\/#{validateUrlPchar}*)*/i),e.txt.regexen.validateUrlQuery=r(/(#{validateUrlPchar}|\/|\?)*/i),e.txt.regexen.validateUrlFragment=r(/(#{validateUrlPchar}|\/|\?)*/i),e.txt.regexen.validateUrlUnencoded=r("^(?:([^:/?#]+):\\/\\/)?([^/?#]*)([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$","i");var c="tweet-url list-slug",h="tweet-url username",p="tweet-url hashtag",d="tweet-url cashtag",v={urlClass:!0,listClass:!0,usernameClass:!0,hashtagClass:!0,cashtagClass:!0,usernameUrlBase:!0,listUrlBase:!0,hashtagUrlBase:!0,cashtagUrlBase:!0,usernameUrlBlock:!0,listUrlBlock:!0,hashtagUrlBlock:!0,linkUrlBlock:!0,usernameIncludeSymbol:!0,suppressLists:!0,suppressNoFollow:!0,targetBlank:!0,suppressDataScreenName:!0,urlEntities:!0,symbolTag:!0,textWithSymbolTag:!0,urlTarget:!0,invisibleTagAttrs:!0,linkAttributeBlock:!0,linkTextBlock:!0,htmlEscapeNonEntities:!0},m={disabled:!0,readonly:!0,multiple:!0,checked:!0};e.txt.tagAttrs=function(t){var n="";for(var r in t){var i=t[r];m[r]&&(i=i?r:null);if(i==null)continue;n+=" "+e.txt.htmlEscape(r)+'="'+e.txt.htmlEscape(i.toString())+'"'}return n},e.txt.linkToText=function(t,n,r,s){s.suppressNoFollow||(r.rel="nofollow"),s.linkAttributeBlock&&s.linkAttributeBlock(t,r),s.linkTextBlock&&(n=s.linkTextBlock(t,n));var o={text:n,attr:e.txt.tagAttrs(r)};return i("<a#{attr}>#{text}</a>",o)},e.txt.linkToTextWithSymbol=function(t,n,r,i,s){var o=s.symbolTag?"<"+s.symbolTag+">"+n+"</"+s.symbolTag+">":n;r=e.txt.htmlEscape(r);var u=s.textWithSymbolTag?"<"+s.textWithSymbolTag+">"+r+"</"+s.textWithSymbolTag+">":r;return s.usernameIncludeSymbol||!n.match(e.txt.regexen.atSigns)?e.txt.linkToText(t,o+u,i,s):o+e.txt.linkToText(t,u,i,s)},e.txt.linkToHashtag=function(t,n,r){var i=n.substring(t.indices[0],t.indices[0]+1),s=e.txt.htmlEscape(t.hashtag),o=g(r.htmlAttrs||{});return o.href=r.hashtagUrlBase+s,o.title="#"+s,o["class"]=r.hashtagClass,s.charAt(0).match(e.txt.regexen.rtl_chars)&&(o["class"]+=" rtl"),r.targetBlank&&(o.target="_blank"),e.txt.linkToTextWithSymbol(t,i,s,o,r)},e.txt.linkToCashtag=function(t,n,r){var i=e.txt.htmlEscape(t.cashtag),s=g(r.htmlAttrs||{});return s.href=r.cashtagUrlBase+i,s.title="$"+i,s["class"]=r.cashtagClass,r.targetBlank&&(s.target="_blank"),e.txt.linkToTextWithSymbol(t,"$",i,s,r)},e.txt.linkToMentionAndList=function(t,n,r){var i=n.substring(t.indices[0],t.indices[0]+1),s=e.txt.htmlEscape(t.screenName),o=e.txt.htmlEscape(t.listSlug),u=t.listSlug&&!r.suppressLists,a=g(r.htmlAttrs||{});return a["class"]=u?r.listClass:r.usernameClass,a.href=u?r.listUrlBase+s+o:r.usernameUrlBase+s,!u&&!r.suppressDataScreenName&&(a["data-screen-name"]=s),r.targetBlank&&(a.target="_blank"),e.txt.linkToTextWithSymbol(t,i,u?s+o:s,a,r)},e.txt.linkToUrl=function(t,n,r){var i=t.url,s=i,o=e.txt.htmlEscape(s),u=r.urlEntities&&r.urlEntities[i]||t;u.display_url&&(o=e.txt.linkTextWithEntity(u,r));var a=g(r.htmlAttrs||{});return i.match(e.txt.regexen.urlHasProtocol)||(i="http://"+i),a.href=i,r.targetBlank&&(a.target="_blank"),r.urlClass&&(a["class"]=r.urlClass),r.urlTarget&&(a.target=r.urlTarget),!r.title&&u.display_url&&(a.title=u.expanded_url),e.txt.linkToText(t,o,a,r)},e.txt.linkTextWithEntity=function(t,n){var r=t.display_url,s=t.expanded_url,o=r.replace(/â¦/g,"");if(s.indexOf(o)!=-1){var u=s.indexOf(o),a={displayUrlSansEllipses:o,beforeDisplayUrl:s.substr(0,u),afterDisplayUrl:s.substr(u+o.length),precedingEllipsis:r.match(/^â¦/)?"â¦":"",followingEllipsis:r.match(/â¦$/)?"â¦":""};for(var f in a)a.hasOwnProperty(f)&&(a[f]=e.txt.htmlEscape(a[f]));return a.invisible=n.invisibleTagAttrs,i("<span class='tco-ellipsis'>#{precedingEllipsis}<span #{invisible}>&nbsp;</span></span><span #{invisible}>#{beforeDisplayUrl}</span><span class='js-display-url'>#{displayUrlSansEllipses}</span><span #{invisible}>#{afterDisplayUrl}</span><span class='tco-ellipsis'><span #{invisible}>&nbsp;</span>#{followingEllipsis}</span>",a)}return r},e.txt.autoLinkEntities=function(t,n,r){r=g(r||{}),r.hashtagClass=r.hashtagClass||p,r.hashtagUrlBase=r.hashtagUrlBase||"https://twitter.com/#!/search?q=%23",r.cashtagClass=r.cashtagClass||d,r.cashtagUrlBase=r.cashtagUrlBase||"https://twitter.com/#!/search?q=%24",r.listClass=r.listClass||c,r.usernameClass=r.usernameClass||h,r.usernameUrlBase=r.usernameUrlBase||"https://twitter.com/",r.listUrlBase=r.listUrlBase||"https://twitter.com/",r.htmlAttrs=e.txt.extractHtmlAttrsFromOptions(r),r.invisibleTagAttrs=r.invisibleTagAttrs||"style='position:absolute;left:-9999px;'";var i,s,o;if(r.urlEntities){i={};for(s=0,o=r.urlEntities.length;s<o;s++)i[r.urlEntities[s].url]=r.urlEntities[s];r.urlEntities=i}var u="",a=0;n.sort(function(e,t){return e.indices[0]-t.indices[0]});var f=r.htmlEscapeNonEntities?e.txt.htmlEscape:function(e){return e};for(var s=0;s<n.length;s++){var l=n[s];u+=f(t.substring(a,l.indices[0])),l.url?u+=e.txt.linkToUrl(l,t,r):l.hashtag?u+=e.txt.linkToHashtag(l,t,r):l.screenName?u+=e.txt.linkToMentionAndList(l,t,r):l.cashtag&&(u+=e.txt.linkToCashtag(l,t,r)),a=l.indices[1]}return u+=f(t.substring(a,t.length)),u},e.txt.autoLinkWithJSON=function(t,n,r){if(n.user_mentions)for(var i=0;i<n.user_mentions.length;i++)n.user_mentions[i].screenName=n.user_mentions[i].screen_name;if(n.hashtags)for(var i=0;i<n.hashtags.length;i++)n.hashtags[i].hashtag=n.hashtags[i].text;if(n.symbols)for(var i=0;i<n.symbols.length;i++)n.symbols[i].cashtag=n.symbols[i].text;var s=[];for(var o in n)s=s.concat(n[o]);return e.txt.modifyIndicesFromUnicodeToUTF16(t,s),e.txt.autoLinkEntities(t,s,r)},e.txt.extractHtmlAttrsFromOptions=function(e){var t={};for(var n in e){var r=e[n];if(v[n])continue;m[n]&&(r=r?n:null);if(r==null)continue;t[n]=r}return t},e.txt.autoLink=function(t,n){var r=e.txt.extractEntitiesWithIndices(t,{extractUrlsWithoutProtocol:!1});return e.txt.autoLinkEntities(t,r,n)},e.txt.autoLinkUsernamesOrLists=function(t,n){var r=e.txt.extractMentionsOrListsWithIndices(t);return e.txt.autoLinkEntities(t,r,n)},e.txt.autoLinkHashtags=function(t,n){var r=e.txt.extractHashtagsWithIndices(t);return e.txt.autoLinkEntities(t,r,n)},e.txt.autoLinkCashtags=function(t,n){var r=e.txt.extractCashtagsWithIndices(t);return e.txt.autoLinkEntities(t,r,n)},e.txt.autoLinkUrlsCustom=function(t,n){var r=e.txt.extractUrlsWithIndices(t,{extractUrlsWithoutProtocol:!1});return e.txt.autoLinkEntities(t,r,n)},e.txt.removeOverlappingEntities=function(e){e.sort(function(e,t){return e.indices[0]-t.indices[0]});var t=e[0];for(var n=1;n<e.length;n++)t.indices[1]>e[n].indices[0]?(e.splice(n,1),n--):t=e[n]},e.txt.extractEntitiesWithIndices=function(t,n){var r=e.txt.extractUrlsWithIndices(t,n).concat(e.txt.extractMentionsOrListsWithIndices(t)).concat(e.txt.extractHashtagsWithIndices(t,{checkUrlOverlap:!1})).concat(e.txt.extractCashtagsWithIndices(t));return r.length==0?[]:(e.txt.removeOverlappingEntities(r),r)},e.txt.extractMentions=function(t){var n=[],r=e.txt.extractMentionsWithIndices(t);for(var i=0;i<r.length;i++){var s=r[i].screenName;n.push(s)}return n},e.txt.extractMentionsWithIndices=function(t){var n=[],r,i=e.txt.extractMentionsOrListsWithIndices(t);for(var s=0;s<i.length;s++)r=i[s],r.listSlug==""&&n.push({screenName:r.screenName,indices:r.indices});return n},e.txt.extractMentionsOrListsWithIndices=function(t){if(!t||!t.match(e.txt.regexen.atSigns))return[];var n=[],r;return t.replace(e.txt.regexen.validMentionOrList,function(t,r,i,s,o,u,a){var f=a.slice(u+t.length);if(!f.match(e.txt.regexen.endMentionMatch)){o=o||"";var l=u+r.length,c=l+s.length+o.length+1;n.push({screenName:s,listSlug:o,indices:[l,c]})}}),n},e.txt.extractReplies=function(t){if(!t)return null;var n=t.match(e.txt.regexen.validReply);return!n||RegExp.rightContext.match(e.txt.regexen.endMentionMatch)?null:n[1]},e.txt.extractUrls=function(t,n){var r=[],i=e.txt.extractUrlsWithIndices(t,n);for(var s=0;s<i.length;s++)r.push(i[s].url);return r},e.txt.extractUrlsWithIndices=function(t,n){n||(n={extractUrlsWithoutProtocol:!0});if(!t||(n.extractUrlsWithoutProtocol?!t.match(/\./):!t.match(/:/)))return[];var r=[];while(e.txt.regexen.extractUrl.exec(t)){var i=RegExp.$2,s=RegExp.$3,o=RegExp.$4,u=RegExp.$5,a=RegExp.$7,f=e.txt.regexen.extractUrl.lastIndex,l=f-s.length;if(!o){if(!n.extractUrlsWithoutProtocol||i.match(e.txt.regexen.invalidUrlWithoutProtocolPrecedingChars))continue;var c=null,h=0;u.replace(e.txt.regexen.validAsciiDomain,function(t){var n=u.indexOf(t,h);h=n+t.length,c={url:t,indices:[l+n,l+h]},(a||t.match(e.txt.regexen.validSpecialShortDomain)||!t.match(e.txt.regexen.invalidShortDomain))&&r.push(c)});if(c==null)continue;a&&(c.url=s.replace(u,c.url),c.indices[1]=f)}else s.match(e.txt.regexen.validTcoUrl)&&(s=RegExp.lastMatch,f=l+s.length),r.push({url:s,indices:[l,f]})}return r},e.txt.extractHashtags=function(t){var n=[],r=e.txt.extractHashtagsWithIndices(t);for(var i=0;i<r.length;i++)n.push(r[i].hashtag);return n},e.txt.extractHashtagsWithIndices=function(t,n){n||(n={checkUrlOverlap:!0});if(!t||!t.match(e.txt.regexen.hashSigns))return[];var r=[];t.replace(e.txt.regexen.validHashtag,function(t,n,i,s,o,u){var a=u.slice(o+t.length);if(a.match(e.txt.regexen.endHashtagMatch))return;var f=o+n.length,l=f+s.length+1;r.push({hashtag:s,indices:[f,l]})});if(n.checkUrlOverlap){var i=e.txt.extractUrlsWithIndices(t);if(i.length>0){var s=r.concat(i);e.txt.removeOverlappingEntities(s),r=[];for(var o=0;o<s.length;o++)s[o].hashtag&&r.push(s[o])}}return r},e.txt.extractCashtags=function(t){var n=[],r=e.txt.extractCashtagsWithIndices(t);for(var i=0;i<r.length;i++)n.push(r[i].cashtag);return n},e.txt.extractCashtagsWithIndices=function(t){if(!t||t.indexOf("$")==-1)return[];var n=[];return t.replace(e.txt.regexen.validCashtag,function(e,t,r,i,s,o){var u=s+t.length,a=u+i.length+1;n.push({cashtag:i,indices:[u,a]})}),n},e.txt.modifyIndicesFromUnicodeToUTF16=function(t,n){e.txt.convertUnicodeIndices(t,n,!1)},e.txt.modifyIndicesFromUTF16ToUnicode=function(t,n){e.txt.convertUnicodeIndices(t,n,!0)},e.txt.getUnicodeTextLength=function(t){return t.replace(e.txt.regexen.non_bmp_code_pairs," ").length},e.txt.convertUnicodeIndices=function(e,t,n){if(t.length==0)return;var r=0,i=0;t.sort(function(e,t){return e.indices[0]-t.indices[0]});var s=0,o=t[0];while(r<e.length){if(o.indices[0]==(n?r:i)){var u=o.indices[1]-o.indices[0];o.indices[0]=n?i:r,o.indices[1]=o.indices[0]+u,s++;if(s==t.length)break;o=t[s]}var a=e.charCodeAt(r);55296<=a&&a<=56319&&r<e.length-1&&(a=e.charCodeAt(r+1),56320<=a&&a<=57343&&r++),i++,r++}},e.txt.splitTags=function(e){var t=e.split("<"),n,r=[],i;for(var s=0;s<t.length;s+=1){i=t[s];if(!i)r.push("");else{n=i.split(">");for(var o=0;o<n.length;o+=1)r.push(n[o])}}return r},e.txt.hitHighlight=function(t,n,r){var i="em";n=n||[],r=r||{};if(n.length===0)return t;var s=r.tag||i,o=["<"+s+">","</"+s+">"],u=e.txt.splitTags(t),a,f,l="",c=0,h=u[0],p=0,d=0,v=!1,m=h,g=[],y,b,w,E,S;for(a=0;a<n.length;a+=1)for(f=0;f<n[a].length;f+=1)g.push(n[a][f]);for(y=0;y<g.length;y+=1){b=g[y],w=o[y%2],E=!1;while(h!=null&&b>=p+h.length)l+=m.slice(d),v&&b===p+m.length&&(l+=w,E=!0),u[c+1]&&(l+="<"+u[c+1]+">"),p+=m.length,d=0,c+=2,h=u[c],m=h,v=!1;!E&&h!=null?(S=b-p,l+=m.slice(d,S)+w,d=S,y%2===0?v=!0:v=!1):E||(E=!0,l+=w)}if(h!=null){d<m.length&&(l+=m.slice(d));for(y=c+1;y<u.length;y+=1)l+=y%2===0?u[y]:"<"+u[y]+">"}return l};var y=140,b=[o(65534),o(65279),o(65535),o(8234),o(8235),o(8236),o(8237),o(8238)];e.txt.getTweetLength=function(t,n){n||(n={short_url_length:22,short_url_length_https:23});var r=e.txt.getUnicodeTextLength(t),i=e.txt.extractUrlsWithIndices(t);e.txt.modifyIndicesFromUTF16ToUnicode(t,i);for(var s=0;s<i.length;s++)r+=i[s].indices[0]-i[s].indices[1],i[s].url.toLowerCase().match(e.txt.regexen.urlHasHttps)?r+=n.short_url_length_https:r+=n.short_url_length;return r},e.txt.isInvalidTweet=function(t){if(!t)return"empty";if(e.txt.getTweetLength(t)>y)return"too_long";for(var n=0;n<b.length;n++)if(t.indexOf(b[n])>=0)return"invalid_characters";return!1},e.txt.isValidTweetText=function(t){return!e.txt.isInvalidTweet(t)},e.txt.isValidUsername=function(t){if(!t)return!1;var n=e.txt.extractMentions(t);return n.length===1&&n[0]===t.slice(1)};var w=r(/^#{validMentionOrList}$/);e.txt.isValidList=function(e){var t=e.match(w);return!!t&&t[1]==""&&!!t[4]},e.txt.isValidHashtag=function(t){if(!t)return!1;var n=e.txt.extractHashtags(t);return n.length===1&&n[0]===t.slice(1)},e.txt.isValidUrl=function(t,n,r){n==null&&(n=!0),r==null&&(r=!0);if(!t)return!1;var i=t.match(e.txt.regexen.validateUrlUnencoded);if(!i||i[0]!==t)return!1;var s=i[1],o=i[2],u=i[3],a=i[4],f=i[5];return(!r||E(s,e.txt.regexen.validateUrlScheme)&&s.match(/^https?$/i))&&E(u,e.txt.regexen.validateUrlPath)&&E(a,e.txt.regexen.validateUrlQuery,!0)&&E(f,e.txt.regexen.validateUrlFragment,!0)?n&&E(o,e.txt.regexen.validateUrlUnicodeAuthority)||!n&&E(o,e.txt.regexen.validateUrlAuthority):!1},typeof module!="undefined"&&module.exports&&(module.exports=e.txt),typeof n=="function"&&n.amd&&n("twitter-text/twitter-text",[],e.txt);if(typeof window!="undefined")if(window.twttr)for(var S in e)window.twttr[S]=e[S];else window.twttr=e}(),n("twitter-text",["twitter-text/twitter-text"],function(e){return e}),n("massrel-js-backbone/TwitterStatusModel",["require","massrel-js","./StatusModel","twitter-text","lodash"],function(e){var t=e("massrel-js"),n=e("./StatusModel"),r=e("twitter-text"),i=e("lodash"),s={thumb:"_normal",small:"_normal",medium:"_bigger",large:"_reasonably_small",huge:""},o=["network","sourceNetwork","sourceName","massrel"],u=["original_referer"],a={video:!0,animated_gif:!0},f="ddd MMM DD HH:mm:ss ZZ YYYY";return n.extend({defaults:i.extend(i.result(n.prototype,"defaults"),{original_referer:t.intents.original_referer,relativeDateFormat:"short"}),parse:function(e){e=n.prototype.parse.apply(this,arguments);if(e.retweeted_status){var t=e;e=e.retweeted_status,e.original_status=t,delete e.original_status.retweeted_status,e.retweet=!0,e.retweeted_by_user=e.original_status.user,i.extend(e,i.pick(e.original_status,o)),e.klout=this.kloutData(e)}e.extended_entities&&e.extended_entities.media&&e.extended_entities.media.length>0&&i.each(e.entities.media,function(t,n){var r=i.find(e.extended_entities.media,{id:t.id});r&&a[r.type]===!0&&(e.entities.media[n]=r)});var s=[];e.entities&&(e.entities.urls&&e.entities.urls.length>0&&(s=s.concat(e.entities.urls)),e.entities.media&&e.entities.media.length>0&&(s=s.concat(e.entities.media))),e.formattedText=r.autoLink(e.text,{usernameIncludeSymbol:!0,urlEntities:s});var u=e.geo||e.geo_hint;return u&&(e.coordinates=u.coordinates),e},constructor:function(){n.apply(this,arguments),this.generateIntentUrls(),this.generateAvatarUrl(),this.on("change:original_referer",i.bind(this.generateIntentUrls,this)),this.on("change:avatar_resolution",i.bind(this.generateAvatarUrl,this))},generateAvatarUrl:function(){var e=this.get("avatar_resolution"),t=this.get("user"),n=s[e];if(n){var r=t.profile_image_url_https.replace("_normal",n);t.profile_image_url_https=r}},generateIntentUrls:function(){var e=i.pick(this.toJSON(),u),n=this.get("id_str");this.set("replyUrl",t.intents.reply(n,e)),this.set("retweetUrl",t.intents.retweet(n,e)),this.set("favUrl",t.intents.favorite(n,e))},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("created_at"),f))}})}),n("massrel-js-backbone/FacebookStatusModel",["require","./StatusModel","twitter-text","lodash"],function(e){var t=e("./StatusModel"),n=e("twitter-text"),r=e("lodash");return t.extend({parse:function(e){e=t.prototype.parse.apply(this,arguments);var n="https://www.facebook.com/",i=e.facebook_id.split("_"),s=e.type;r.contains(["photo","video","link","post"],s)?n+=[i[0],"posts",i[1]].join("/"):e.kind==="comment"?i.length===2?n+=i[0]+"?comment_id="+i[1]:(n+=[i[0],"posts",i[1]].join("/"),i[2]&&(n+="?comment_id="+i[2])):n+=e.facebook_id,e.permalink=n,e.action_available={comment:!0,share:!1,like:!1},e.kind==="comment"&&(e.action_available.comment=!1),e.share_text&&e.story&&(e.formattedStory=this.autoLink(e.story)),e.originalStatus=r.extend({},e),typeof e.originalStatus.id=="string"&&(e.originalStatus.id=e.originalStatus.id.replace("facebook:",""));if(e.message||e.name)e.formattedText=this.autoLink(e.message||e.name);return e.hide_app_cards&&e.fbapp_id&&e.application&&e.fbapp_id===e.application.id&&(e.mediaHtml=""),e.author?e.author.is_page>0?e.action_available.like=!0:e.action_available.like=!1:e.from&&e.from.broadcast_name&&(e.author={name:e.from.broadcast_name,is_page:!0},e.action_available.like=!0),e},autoLink:function(e){var t=n.extractUrlsWithIndices(e).concat(n.extractHashtagsWithIndices(e,{checkUrlOverlap:!1}));return n.removeOverlappingEntities(t),n.autoLinkEntities(e,t,{hashtagClass:"facebook-hashtag",urlClass:"facebook-url",hashtagUrlBase:"https://www.facebook.com/hashtag/",targetBlank:!0})},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("created_time")))}})}),n("massrel-js-backbone/InstagramStatusModel",["require","./StatusModel","twitter-text"],function(e){var t=e("./StatusModel"),n=e("twitter-text");return t.extend({parse:function(e){return e=t.prototype.parse.apply(this,arguments),e.user.profile_picture&&(e.user.profile_picture=this.embedlyImageProxyUrl(e.user.profile_picture),e.caption&&e.caption.from.profile_picture&&(e.caption.from.profile_picture=this.embedlyImageProxyUrl(e.caption.from.profile_picture))),e.caption&&(e.caption.text=n.autoLinkUrlsCustom(e.caption.text)),e.location&&_.isNumber(e.location.latitude)&&_.isNumber(e.location.longitude)&&(e.coordinates=[e.location.latitude,e.location.longitude]),e.place=e.location,delete e.location,e},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("created_time"),"X"))}})}),n("massrel-js-backbone/GoogleStatusModel",["require","./StatusModel","twitter-text"],function(e){var t=e("./StatusModel"),n=e("twitter-text");return t.extend({parse:function(e){return e=t.prototype.parse.apply(this,arguments),e.title=n.autoLinkUrlsCustom(e.title),e.place=e.location,delete e.location,e.formattedText=e.title,e.object&&e.object.content&&(e.formattedText=e.object.content),e},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("published")))}})}),n("massrel-js-backbone/GetglueStatusModel",["require","./StatusModel","twitter-text","lodash"],function(e){var t=e("./StatusModel"),n=e("twitter-text"),r=e("lodash"),i={thumb:"tiny_",small:"tiny_",medium:"",large:"large_",huge:"large_"},s=/\/[a-z_]*tile\./;return t.extend({defaults:r.extend(r.result(t.prototype,"defaults"),{relativeDateFormat:"short"}),parse:function(e){return e=t.prototype.parse.apply(this,arguments),e.actor&&e.actor.image&&(e.actor.image=this.embedlyImageProxyUrl(e.actor.image)),e.canonical_link=e.link,r.isUndefined(e.inReplyTo)||(e.canonical_link=e.inReplyTo.link),e.body=n.autoLinkUrlsCustom(e.body),e},initialize:function(){t.prototype.initialize.apply(this,arguments),this.generateAvatarUrl()},generateAvatarUrl:function(){var e=this.get("actor"),t=this.get("avatar_resolution"),n=i[t];if(n){var r=e.image.replace(s,"/"+n+"tile.");e.image=r}},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("publishTime")))}})}),n("massrel-js-backbone/RssStatusModel",["./StatusModel","twitter-text"],function(e,t){return e.extend({parse:function(n){return n=e.prototype.parse.apply(this,arguments),n.description&&(n.raw_description=n.description,n.description=t.autoLinkUrlsCustom(n.description)),n},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("pub_date")))}})}),n("massrel-js-backbone/YoutubeStatusModel",["./StatusModel","twitter-text","./MediaCollection","./MediaModel","lodash","moment"],function(e,t,n,r,i,s){return e.extend({defaults:i.extend(i.result(e.prototype,"defaults"),{relativeDurationFormat:"display",formattedDuration:"",relativeDateFormat:"short"}),initialize:function(){e.prototype.initialize.apply(this,arguments),this.on("change:relativeDurationFormat",i.bind(this.generateFormattedDurations,this)),this.generateFormattedDurations()},parse:function(t){return t=e.prototype.parse.apply(this,arguments),t.title=t.snippet.title,t.description=t.snippet.description,t.link="//youtu.be/"+t.youtube_video_id,t.channelTitle=t.snippet.channelTitle,t},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("snippet").publishedAt))},generateFormattedDurations:function(){var e=this.computeDuration(this.get("contentDetails").duration),t=this.get("relativeDurationFormat");i.isFunction(t)?this.set("formattedDuration",t(e)):this[t+"Duration"]&&this.set("formattedDuration",this[t+"Duration"](e))},computeDuration:function(e){var t=s.duration(e);return{hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),totalSeconds:t.asSeconds()}},displayDuration:function(e){function t(e){return e<10?"0"+e:e}var n=":"+t(e.seconds);return e.hours?n=e.hours+":"+t(e.minutes)+n:n=e.minutes+n,n},secondsDuration:function(e){return e.totalSeconds}})}),n("massrel-js-backbone/statusModelFactory",["./StatusModel","./TwitterStatusModel","./FacebookStatusModel","./InstagramStatusModel","./GoogleStatusModel","./GetglueStatusModel","./RssStatusModel","./YoutubeStatusModel"],function(e,t,n,r,i,s,o,u){var a=function(t,n,r){var i;return a.detectSource(t),typeof r=="undefined"&&(r=a.constructors),r[t.sourceName]!==undefined?i=r[t.sourceName]:i=e,new i(t,n)};return a.constructors={twitter:t,facebook:n,instagram:r,google:i,getglue:s,rss:o,youtube:u},a.detectSource=function(e){return e.sourceNetwork={facebook:!1,twitter:!1,getglue:!1,google:!1,instagram:!1,rss:!1,youtube:!1,message:!1},typeof e.sourceNetwork[e.network]!="undefined"&&(e.sourceNetwork[e.network]=!0,e.sourceName=e.network),e.network==="google_plus"&&(e.sourceNetwork.google=!0,e.sourceName="google"),e.network==="youtube"&&(e.sourceNetwork.youtube=!0,e.sourceName="youtube"),e.network==="massrelevance"&&(e.sourceNetwork.message=!0,e.sourceName="message"),e},a}),n("massrel-js-backbone/mediaCollectionFactory",["q","./MediaCollection","media-meta"],function(e,t,n){var r=function(r,i){var s=e.defer(),o=n.promise(r.toJSON(),i);return o.done(function(e){s.resolve(new t(e))},function(){s.reject()}),s.promise};return r}),n("massrel-js-backbone/StreamPoller",["require","lodash","q","./backbone","./statusModelFactory","./mediaCollectionFactory","massrel-js"],function(e){var t=e("lodash"),n=e("q"),r=e("./backbone"),i=e("./statusModelFactory"),s=e("./mediaCollectionFactory"),o=e("massrel-js"),u=o.protocol==="https";return r.Model.extend({defaults:{embed_media:!1,avatar_resolution:"small",total:0,media_config:{secure:u,autoplay_video:!1,loop_video:!1}},initialize:function(){var e=this;e.filters=[],e.asyncFilters=[],e.queue=new r.Collection,e.moreQueue=new r.Collection;var n=e.toJSON();e.stream=new o.Stream(n.stream_name),e.poller=e.stream.poller(n),e.poller.data(function(t){var n=e.get("total")+t.length;e.set("total",n),n===0&&e.trigger("no-data"),t.length===0&&e.trigger("no-new-data")}),e.poller.batch(t.bind(e.handleBatch,e))},start:function(){var e=this;return this.get("stream_name")&&e.poller.start(),e},handleBatch:function(e){var t=this;t.createModels(e).done(function(e){t.queue.add(e,{at:0}),t.trigger("loaded-batch",e.length)})},createModels:function(e){var r=this,o=n.defer(),u=r.get("embed_media"),a=r.get("avatar_resolution"),f=r.get("media_config"),l=[],c=[];t.each(e,function(e,t){if(e.in_reply_to){var n=i(e.in_reply_to);l.push(n)}var r=i(e);l.push(r),e.in_reply_to&&(n.set("reply",r),r.set("in_reply_to",n))}),t.each(l,function(e,t){a&&e.set("avatar_resolution",a);if(u){var n=s(e,f);n.then(function(t){e.set("media",t)}).fail(function(){}),c.push(n)}});if(u)n.allSettled(c).done(function(){var e=r.applyFilters(l);r.applyAsyncFilters(e).then(function(e){o.resolve(e)})});else{var h=r.applyFilters(l);r.applyAsyncFilters(h).then(function(e){o.resolve(e)})}return o.promise},stop:function(){var e=this;return e.poller.stop(),e},filter:function(e){var t=this;return t.filters.push(e),t.queue.remove(t.queue.reject(e)),t.moreQueue.remove(t.moreQueue.reject(e)),t},asyncFilter:function(e){var n=this;n.asyncFilters.push(e);var r=t.clone(n.queue.models),i=t.clone(n.moreQueue.models);return n.applyAsyncFilters(n.queue.models).then(function(e){var i=t.difference(r,e);n.queue.remove(i)}),n.applyAsyncFilters(n.moreQueue.models).then(function(e){var r=t.difference(i,e);n.moreQueue.remove(r)}),n},applyFilters:function(e){var n=this;return t.each(n.filters,function(n){e=t.filter(e,n)}),e},applyAsyncFilters:function(e){var r=n.defer(),i=function(e){r.resolve(e)};if(this.asyncFilters.length){var s=n(e);t.each(this.asyncFilters,function(e){s=s.then(e)}),s.then(i)}else r.resolve(e);return r.promise},more:function(){var e=this;return e.trigger("loading-more"),e.poller.more(t.bind(e.loadedMore,e)),e},loadedMore:function(e){var t=this;e.length===0?t.trigger("end-of-data"):t.createModels(e).done(function(e){t.moreQueue.add(e),t.trigger("loaded-more",e.length)})}})}),n("massrel-js-backbone/Filters",["require","./backbone","q","jquery","lodash"],function(e){function s(e){var t=r("head"),i=n.defer(),s=r("<img/>");return s.on("load",function(){s.remove(),i.resolve()}).on("error",function(){s.remove(),i.reject()}),t.append(s),s.attr("src",e),i.promise}function o(e,t){var r=[],o=[],u=n.defer();return i.each(e,function(e){var u=n.defer();r.push(u.promise);var a=e.get("media");if(a&&a.length>0){var f=a.at(0),l=f.get("photo_urls"),c=[];i.each(l,function(e){c.push(s(e.url))}),n.all(c).then(function(){o.push(e),u.resolve()},function(){u.resolve()})}else t&&t.includeText&&o.push(e),u.resolve()}),n.allSettled(r).then(function(){u.resolve(i.intersection(e,o))}),u.promise}function u(e){return o(e,{includeText:!0})}function a(e){return String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.get("formattedText")&&e.get("formattedText").trim().length>0?!0:e.get("network")==="instagram"&&e.get("caption")&&e.get("caption").text&&e.get("caption").text.trim().length>0?!0:e.get("network")==="rss"&&(e.get("title")&&e.get("title").trim().length>0||e.get("description")&&e.get("description").trim().length>0)?!0:!1}var t=e("./backbone"),n=e("q"),r=e("jquery"),i=e("lodash");return{sync:{hasTextStatus:a},async:{hasValidImages:o,hasValidImagesOrText:u}}}),n("massrel-js-backbone/ComparePoller",["./backbone","massrel-js"],function(e,t){return e.Model.extend({defaults:function(){return{streams:[],frequency:20}},initialize:function(){var e=this,n=e.toJSON();e.compare=new t.Compare(n.streams),e.poller=e.compare.poller(n)},start:function(){var e=this;this.get("streams")&&this.get("streams").length>0&&(e.set("loading",!0),e.poller.data(function(t){e.set("data",t),e.set("loading",!1)}),e.poller.start())},stop:function(){this.poller.stop()}})}),n("massrel-js-backbone/MetaPoller",["require","./backbone","massrel-js"],function(e){var t=e("./backbone"),n=e("massrel-js");return t.Model.extend({defaults:function(){return{stream_name:"",networks:1,disregard:"",frequency:20,loading:!1,activity:{},count:{},networks:{}}},initialize:function(){var e=this,t=e.toJSON();e.stream=new n.Stream(t.stream_name),e.poller=e.stream.metaPoller(t)},start:function(){var e=this;this.get("stream_name")&&(e.set("loading",!0),e.poller.data(function(t){e.set(t),e.set("loading",!1)}),e.poller.start())},stop:function(){var e=this;e.poller.stop()}})}),n("massrel-js-backbone/TopThingsPoller",["require","./backbone","massrel-js","lodash"],function(e){var t=e("./backbone"),n=e("massrel-js"),r=e("lodash");return t.Model.extend({defaults:function(){return{stream_name:"",networks:1,frequency:20,resolution:"1h",start:"-1h",finish:"",thing:"",limit:50,loading:!1,data:{}}},start:function(){this.stop();if(this.get("stream_name")){var e=r.pick(this.toJSON(),["thing","resolution","start","finish","limit","stream_name"]);this.stream=new n.Stream(e.stream_name),this.poller=this.stream.topThingsPoller(e),this.set("loading",!0),this.poller.data(r.bind(function(e){this.set("data",e),this.set("loading",!1)},this)),this.poller.start()}},stop:function(){this.poller&&this.poller.stop()}})}),n("massrel-js-backbone/main",["require","./StreamPoller","./Filters","./ComparePoller","./MetaPoller","./TopThingsPoller","./statusModelFactory","./StatusModel","./TwitterStatusModel","./FacebookStatusModel","./GoogleStatusModel","./GetglueStatusModel","./InstagramStatusModel","./RssStatusModel","./mediaCollectionFactory","./MediaCollection","./MediaModel"],function(e){var t=e("./StreamPoller"),n=e("./Filters"),r=e("./ComparePoller"),i=e("./MetaPoller"),s=e("./TopThingsPoller"),o=e("./statusModelFactory"),u=e("./StatusModel"),a=e("./TwitterStatusModel"),f=e("./FacebookStatusModel"),l=e("./GoogleStatusModel"),c=e("./GetglueStatusModel"),h=e("./InstagramStatusModel"),p=e("./RssStatusModel"),d=e("./mediaCollectionFactory"),v=e("./MediaCollection"),m=e("./MediaModel");return{StreamPoller:t,ComparePoller:r,MetaPoller:i,TopThingsPoller:s,statusModelFactory:o,StatusModel:u,TwitterStatusModel:a,FacebookStatusModel:f,GoogleStatusModel:l,GetglueStatusModel:c,InstagramStatusModel:h,RssStatusModel:p,mediaCollectionFactory:d,MediaCollection:v,MediaModel:m,Filters:n}}),n("massrel-js-backbone",["massrel-js-backbone/main"],function(e){return e}),n("js/mediaTest",[],function(){var e=function(e){function n(e){var t=e.get("type");return t.photo&&!t.video}function r(e){return e.get("type").video}function i(e){var t=e.get("type");return t.photo||t.video}var t;return e==="photos"?t=n:e==="videos"?t=r:e==="both"&&(t=i),function(e){return e&&t(e)}};return e}),t.config({map:{"*":{underscore:"js/lodash",jquery:"js/jquery",lodash:"js/lodash"}}}),n("js/index",["require","lodash","jquery","massrel-js-backbone","./mediaTest"],function(e){var t=e("lodash"),n=e("jquery"),r=e("massrel-js-backbone"),i=e("./mediaTest"),s=function(){n(".toggle-status > .icon-chevron-down").on("click",function(){n("#modal .attribution").fadeIn()}),n(".toggle-status > .icon-chevron-up").on("click",function(){n("#modal .attribution").fadeOut()})};return{ready:function(e){var r=MR.ENV,i=MR.templateConfig.settings,s=e.modalStatus;r.instance.on("#mediaFirstStatus:showStatusAndView",function(e){MR.modal.open({data:{model:e.payload.model,View:s.viewFactory(e.payload.model)},fallback:t.bind(r.instance.trigger,r.instance,"#modal:show")})});var o=n("<style></style>").appendTo("head"),u=100/i.gridWidth;o.text(".grid-cell { width: "+u+"%; }")},render:function(e){var o=n("#media-grid"),u=MR.templateConfig.settings,a,f=e.mediaFirstStatus,l=u.gridWidth*u.gridHeight,c=0,h=!0,p=0,d;n("#mr-logo").css("display")==="none"&&(o.css({bottom:"0"}),n(".footer").css({height:"0"}));var v=function(){var e=d[p];p=(p+1)%d.length;var t=Math.floor(Math.random()*l),r=f.viewFactory(e),i=(new r({model:e})).render();i.$el.addClass("grid-cell"),i.$el.hide();var s=n("#media-grid > .grid > .grid-body > .grid-cell").eq(t);s.fadeOut(function(){s.replaceWith(i.$el),i.$el.fadeIn(),i.$el.on("click",function(){MR.ENV.instance.trigger("#mediaFirstStatus:showStatusAndView",{model:e,view:r})})})},m=function(){var e=parseInt(u.cell_delay,10);setInterval(function(){d.length&&v()},e*1e3)},g=function(e){var r=i(u.media_type);e=t.filter(e,function(e){return e.get("media").find(function(e){return e.get("photo_urls")&&e.get("photo_urls").medium&&r(e)})});if(h){if(e.length>l){var s=t.last(e,l);e=s.concat(t.first(e,e.length-l).reverse())}d=e}else d=d.concat(e),d.length>l*2&&(p<d.length-l*2&&(p=0),d=d.slice(d.length-l*2));t.each(e||[],function(e){e.set("mediaFilter",function(e){return r(e)}),c<l&&(p+=1,t.defer(function(){var t=f.viewFactory(e),r=(new t({model:e})).render();r.$el.addClass("grid-cell"),n("#media-grid > .grid > .grid-body").append(r.$el),r.$el.on("click",function(){MR.ENV.instance.trigger("#mediaFirstStatus:showStatusAndView",{model:e,view:t})}),MR.resize()}),c+=1)}),h&&u.replace_content&&m(),h=!1,MR.resize()},y=function(e){var t=a.queue.slice(0,e);a.queue.reset(),g(t,!0),c<l&&a.more()},b=function(){var e=a.moreQueue.slice(0,a.moreQueue.length-1);g(e,!1),c<l&&a.more()};a=new r.StreamPoller({stream_name:u.streamName,embed_media:!0,limit:u.gridWidth*u.gridHeight*2,frequency:30,page_links:!0,avatar_resolution:"small",media_config:{autoplay_video:!0,loop_video:!1}}),a.on("loaded-more",b),a.on("loaded-batch",y);var w=function(){n("#noNewContent").show()};a.on("no-data",w),a.start(),n(window).resize(t.throttle(function(){MR.resize()},50)),MR.resize(),MR.ENV.instance.on("#modal:open",function(){t.delay(s,250)}),n("html").hasClass("lt-ie10")&&MR.ENV.instance.on("#modal:close",function(){n("#modal iframe")[0]&&(n("#modal iframe")[0].src=" ")})},modal:{ready:function(){},render:function(){MR.ENV.instance.on("#modal:open",function(){t.delay(s,250)}),MR.ENV.instance.trigger("#modal:show",MR.modal.getData()),MR.ENV.instance.on("#modal:close",function(){n("html").hasClass("lt-ie10")&&n("#modal iframe")[0]&&(n("#modal iframe")[0].src=" "),MR.modal.close()})}}}}),t(["js/index"]),window.MRT.require=t,window.MRT.define=n,window.MRT.requirejs=e}();