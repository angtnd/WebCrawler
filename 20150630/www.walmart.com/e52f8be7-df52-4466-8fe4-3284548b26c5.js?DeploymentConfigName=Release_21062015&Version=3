			
// Copyright 2006-2015 ClickTale Ltd., US Patent Pending
// PID: 5
// Generated on: 6/29/2015 6:36:26 AM (UTC 6/29/2015 11:36:26 AM)

if (!navigator.userAgent.match(/msies(d+)/i) || (navigator.userAgent.match(/msies(d+)/i)[1] && parseInt(navigator.userAgent.match(/msies(d+)/i)[1], 10) > 8)) { (function(){var e=!0,f=null,i=!1,k=this;var m,n,o,p;function ba(){return k.navigator?k.navigator.userAgent:f}p=o=n=m=i;var q;if(q=ba()){var ca=k.navigator;m=0==q.indexOf("Opera");n=!m&&-1!=q.indexOf("MSIE");o=!m&&-1!=q.indexOf("WebKit");p=!m&&!o&&"Gecko"==ca.product}var da=m,u=n,w=p,x=o,y;
a:{var z="",A;if(da&&k.opera)var B=k.opera.version,z="function"==typeof B?B():B;else if(w?A=/rv\:([^\);]+)(\)|;)/:u?A=/MSIE\s+([^\);]+)(\)|;)/:x&&(A=/WebKit\/(\S+)/),A)var ea=A.exec(ba()),z=ea?ea[1]:"";if(u){var C,fa=k.document;C=fa?fa.documentMode:void 0;if(C>parseFloat(z)){y=""+C;break a}}y=z}var ga={};
function E(b){var g;if(!(g=ga[b])){g=0;for(var h=(""+y).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),j=(""+b).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),l=Math.max(h.length,j.length),r=0;0==g&&r<l;r++){var v=h[r]||"",Z=j[r]||"",aa=RegExp("(\\d*)(\\D*)","g"),D=RegExp("(\\d*)(\\D*)","g");do{var t=aa.exec(v)||["","",""],s=D.exec(Z)||["","",""];if(0==t[0].length&&0==s[0].length)break;g=((0==t[1].length?0:parseInt(t[1],10))<(0==s[1].length?0:parseInt(s[1],10))?-1:(0==t[1].length?0:parseInt(t[1],
10))>(0==s[1].length?0:parseInt(s[1],10))?1:0)||((0==t[2].length)<(0==s[2].length)?-1:(0==t[2].length)>(0==s[2].length)?1:0)||(t[2]<s[2]?-1:t[2]>s[2]?1:0)}while(0==g)}g=ga[b]=0<=g}return g}var ha={};function ia(){ha[9]||(ha[9]=u&&!!document.documentMode&&9<=document.documentMode)};!u||ia();!u||ia();u&&E("8");!x||E("528");w&&E("1.9b")||u&&E("8")||da&&E("9.5")||x&&E("528");!w||E("8");function F(b,g,h,j,l){b&&g&&("undefined"==typeof h&&(h=1E3),"undefined"==typeof j&&(j=20),0>--j?"function"===typeof l&&l():g()?b():setTimeout(function(){F(b,g,h,j,l)},h))};function ja(b){function g(){h||(h=e,b())}var h=i;if("complete"===document.readyState||"interactive"===document.readyState)g();else{if(document.addEventListener)document.addEventListener("DOMContentLoaded",g,i);else if(document.attachEvent){try{var j=window.frameElement!=f}catch(l){}if(document.documentElement.doScroll&&!j){var r=function(){if(!h)try{document.documentElement.doScroll("left"),g()}catch(b){setTimeout(r,10)}};r()}document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&
g()})}if(window.addEventListener)window.addEventListener("load",g,i);else if(window.attachEvent)window.attachEvent("onload",g);else{var v=window.onload;window.onload=function(){v&&v();g()}}}};function G(b){"function"===typeof ClickTaleExec&&ClickTaleExec(b)}function H(){"function"===typeof ClickTaleStop&&ClickTaleStop()}function I(b,g){"function"===typeof ClickTaleEvent&&(g?I.d[b]!==e&&(I.d[b]=e,ClickTaleEvent(b)):ClickTaleEvent(b))}I.d={};function J(b){"function"===typeof window.ClickTaleRegisterFormSubmit&&window.ClickTaleRegisterFormSubmit(b)}function K(b){"function"===typeof window.ClickTaleRegisterFormSubmitSent&&window.ClickTaleRegisterFormSubmitSent(b)}
function ka(b){"function"===typeof window.ClickTaleRegisterFormSubmitSuccess&&(b?window.ClickTaleRegisterFormSubmitSuccess(b):window.ClickTaleRegisterFormSubmitSuccess())}function L(b){"function"===typeof window.ClickTaleRegisterFormSubmitFailure&&(b?window.ClickTaleRegisterFormSubmitFailure(b):window.ClickTaleRegisterFormSubmitFailure())}function M(){var b=document.location.href;"function"===typeof window.ClickTaleLogical&&(I.d={},window.ClickTaleLogical(b))}
function N(b,g){"function"===typeof window.ClickTaleRegisterElementAction&&ClickTaleRegisterElementAction(b,g)}window.ClickTaleDetectAgent&&window.ClickTaleDetectAgent()&&window.ClickTaleDetectAgent();function la(b,g){"object"==typeof b&&"string"==typeof g&&(window.ClickTaleSetCustomElementID=window.ClickTaleSetCustomElementID||function(b,g){b.ClickTale=b.ClickTale||{};b.ClickTale.CustomID=g},window.ClickTaleSetCustomElementID(b,g))}
function O(){"function"===typeof ClickTaleRebindEvents&&ClickTaleRebindEvents()};var ma=G,P=I;var Q="",R=document.location.pathname.toLowerCase(),na=document.location.search.toLowerCase(),oa={oo_store:"Store",oo_site:"Website",oo_both:"Both"},S="",T,U,V="";function W(b){return 0<b.length?e:i}function X(b,g){jQuery(document).one("mouseup",function(h){b===h.target&&g()})}function pa(){var b=R.split("/");return 3==b.length?jQuery.isNumeric(b[2]):i}
function qa(){if("/"===R)Q="Homepage: ",I("Homepage: HomePage");else if(/^\/cp\//.test(R)){Q="Category Page: ";var b=jQuery(".breadcrumb-list a").map(function(b,h){return jQuery.trim(jQuery(h).text())}).toArray().join(" > ");b&&I("Category Page: "+b);-1<R.toLowerCase().indexOf("/gifts-registry")?P("Category Page: Gifts & Registry"):-1<R.toLowerCase().indexOf("/wedding/")?P("Category Page: Wedding Shop"):pa()&&P("Category Page: Credit Card")}else/^\/ip\//.test(R)?(0<jQuery(".js-product-care-plans").length?
I("Item page: With Warranty"):I("Item page: No Warranty"),-1<R.toLowerCase().indexOf("-gift-card")&&P("Category Page: Gift Cards"),jQuery("button:contains('Specifications')").length&&P("item page with specifications"),jQuery(".product-controls.product-buying-table-row.module > .product-controls-row").length&&(b=jQuery(".product-controls.product-buying-table-row.module > .product-controls-row"),b.find(".js-variants-summary").length&&b.find(".js-variants-summary .js-product-variant-row.product-variant-row[data-id='actual_color']").length&&
b.find(".js-variants-summary .js-product-variant-row.product-variant-row[data-id='size']").length?I("item page: with color and size"):2==b.children().length&&b.find(".product-care-plans-container").length?I("item page: with care plan only"):1==b.children().length&&b.find(".grid")?I("item page: qty only"):3==b.children().length&&I("item page: with color and care plan")),"object"==typeof window.s_omni&&("string"==typeof window.s_omni.prop3&&window.s_omni.prop3.length&&I("Item page category  "+window.s_omni.prop3),
"string"==typeof window.s_omni.prop8&&window.s_omni.prop8.length&&I("Item page department - "+window.s_omni.prop8),"string"==typeof window.s_omni.prop4&&window.s_omni.prop4.length&&I("Item page subcategory - "+window.s_omni.prop4))):/^\/search\//.test(R)&&/^\??query=/.test(na)&&(Q="Search Page: ",I(Q+"Search Results"),"Showing 0 of 0 results"===jQuery(".result-summary-container").text().trim()&&I(Q+"Search Results Empty"));-1<document.location.href.toLowerCase().indexOf("reviews/write-review")&&I("rate and review page");
W(jQuery(".header-account-signin"))||I("Login: User is Logged In")}Function.prototype.b=function(b,g){var h=this,j;return function(){var l=this,r=arguments;j?clearTimeout(j):g&&h.apply(l,r);j=setTimeout(function(){g||h.apply(l,r);j=f},b||100)}};function Y(b,g){var h={},j;for(j in g)h[j]=g[j];h.target=b;h.srcElement=b;N("mouseover",h);N("click",h)}
Function.prototype.b=function(b,g){var h=this,j;return function(){var l=this,r=arguments;j?clearTimeout(j):g&&h.apply(l,r);j=setTimeout(function(){g||h.apply(l,r);j=f},b||100)}};function ra(){var b=jQuery(".slick-list:eq(0) .slick-track .selected img").attr("alt");return b?b:f}
function sa(){if(!window.ClickTaleFirstPCCGo){window.ClickTaleFirstPCCGo=e;var b=document.location.href.toLowerCase();if(0<jQuery("#orderSummary").length&&0<jQuery(".CheckoutHeading.BodyLableBold").length&&"Choose Payment Method"==jQuery(".CheckoutHeading.BodyLableBold").text()&&0<jQuery(".osoPaymentType.clearfix>a:eq(0).active").length&&0==jQuery(".listedCCShow").length){P("Checkout process: choose payment method");if(0<jQuery("#addCreditCardForm").length){var g=jQuery("#addCreditCardForm")[0];jQuery(document).on("mousedown",
'.btnwrapper.btnCCard.bottom  .mainSpriteSliderBTN[title="Continue"]',function(){J(g);K(g)})}0<jQuery(".errorFormLabel").length&&L()}jQuery(".btn-badge:contains('Supplement facts')").length&&la(jQuery(".btn-badge:contains('Supplement facts')")[0],"CustomIDSupplementalFacts");jQuery(".btn-badge:contains('Nutrition facts')").length&&la(jQuery(".btn-badge:contains('Nutrition facts')")[0],"CustomIDNutritionFacts");W(jQuery(".nutrition-section"))&&P("item page with nutrition facts");W(jQuery(".supplement-section"))&&
P("item page with Supplemental facts");ta();-1<b.indexOf("cart2/cart")&&(jQuery(document).on("mousedown",".ProceedtoCo",function(){P("Cart - Proceed to checkout",e)}),0<jQuery("#CartBtnCount").length&&("3"==jQuery("#CartBtnCount").html()||"2"==jQuery("#CartBtnCount").html()||"1"==jQuery("#CartBtnCount").html())&&P("Cart with 1-3 products",e));W(jQuery(".ErrorContainer:visible"))&&L();2<jQuery(".customer-review").length&&P("item page with over three reviews (R&R)");2<jQuery("tr.question:visible").length&&
P("item page with over three Q&A");if(0<jQuery(".slick-list:eq(0) .slick-track").length&&window.MutationObserver){var h=document.querySelector(".slick-list .slick-track"),j=new window.MutationObserver(function(){var a=ra();a&&P("home page carousel banner - "+a);if(jQuery(".slick-slide.slick-active.selected").length&&(a=jQuery(".slick-slide").index(jQuery(".slick-slide.slick-active.selected")),-1<a)){var d=jQuery(".multistory-pov-pagination .slick-list .slick-track").attr("style"),c='jQuery(".multistory-pov-pagination ul.carousel-paginator-list li").removeClass("slick-active"); jQuery(".multistory-pov-pagination ul.carousel-paginator-list li").eq('+
jQuery(".multistory-pov-pagination ul.carousel-paginator-list li").index(jQuery(".multistory-pov-pagination ul.carousel-paginator-list li.slick-active"))+').addClass("slick-active");';G('jQuery(".multistory-pov-pagination .slick-list .slick-track").attr("style","'+d+'transition-duration:500ms;"); jQuery(".multistory-pov-pagination .slick-list .slick-slide").removeClass("slick-active selected");jQuery(".multistory-pov-pagination .slick-list .slick-slide").eq('+a+').addClass("slick-active selected");'+
c)}}.b(250,i)),l=ra();l&&P("home page carousel banner - "+l);j.observe(h,{attributes:e,f:e,e:e})}(-1<b.indexOf("/ip/")||-1<b.indexOf("/cp/")||"/"==document.location.pathname)&&-1<b.indexOf("/ip/")&&0<jQuery("#recently-review .carousel-heading").length&&P("Item page - You recently viewed carousel");-1<b.indexOf("/ip/")&&-1<b.indexOf("bundle")&&0<jQuery(".accordion-header-collapsed.accordion-container").length&&P("bundle item page");jQuery(".nav-dropdown.js-nav-dropdown>li>button").on("mousedown",function(a){var d=
jQuery(".nav-dropdown.js-nav-dropdown>li>button").index(this),c={},b;for(b in a)c[b]=a[b];c.target=jQuery(".nav-dropdown.js-nav-dropdown>li>button").eq(d)[0];c.srcElement=jQuery(".nav-dropdown.js-nav-dropdown>li>button").eq(d)[0];N("mouseover",c);N("click",c)});jQuery(".spotlight-tiles.js-spotlight-tiles map>area").on("mousedown",function(a){var d=jQuery(".spotlight-tiles.js-spotlight-tiles map>area").index(this);if(0<jQuery(".spotlight-tiles.js-spotlight-tiles map>area:eq("+d+")").closest(".spotlight-tiles.js-spotlight-tiles").length&&
0<jQuery(".spotlight-tiles.js-spotlight-tiles map>area:eq("+d+")").closest(".spotlight-tiles.js-spotlight-tiles").find("img").length){var c={},b;for(b in a)c[b]=a[b];c.target=jQuery(".spotlight-tiles.js-spotlight-tiles map>area:eq("+d+")").closest(".spotlight-tiles.js-spotlight-tiles").find("img")[0];c.srcElement=jQuery(".spotlight-tiles.js-spotlight-tiles map>area:eq("+d+")").closest(".spotlight-tiles.js-spotlight-tiles").find("img")[0];N("mouseover",c);N("click",c)}});jQuery(".paginator-list.pull-left button").on("mousedown",
function(a){var d=jQuery(".paginator-list.pull-left button").index(this),c={},b;for(b in a)c[b]=a[b];c.target=jQuery(".paginator-list.pull-left button:eq("+d+")")[0];c.srcElement=jQuery(".paginator-list.pull-left button:eq("+d+")")[0];N("mouseover",c);N("click",c)});jQuery(".paginator-list.pull-left a").on("mousedown",function(a){var d=jQuery(".paginator-list.pull-left a").index(this),c={},b;for(b in a)c[b]=a[b];c.target=jQuery(".paginator-list.pull-left a:eq("+d+")")[0];c.srcElement=jQuery(".paginator-list.pull-left a:eq("+
d+")")[0];N("mouseover",c);N("click",c)});jQuery(".nav-dropdown.js-nav-dropdown>li>button").on("mousedown",function(a){var d=jQuery(".nav-dropdown.js-nav-dropdown>li>button").index(this),c={},b;for(b in a)c[b]=a[b];c.target=jQuery(".nav-dropdown.js-nav-dropdown>li>button").eq(d)[0];c.srcElement=jQuery(".nav-dropdown.js-nav-dropdown>li>button").eq(d)[0];N("mouseover",c);N("click",c)});qa();jQuery(".wmicon.wmicon-search").on("mousedown",function(a){if(0<jQuery(".wmicon.wmicon-search").parent("button").length){var d=
jQuery(".wmicon.wmicon-search").parent("button")[0],c={},b;for(b in a)c[b]=a[b];c.target=d;c.srcElement=d;N("mouseover",c);N("click",c)}});jQuery(".wmicon.wmicon-remove").on("mousedown",function(a){if(0<jQuery(".wmicon.wmicon-remove").parent("button").length){var d=jQuery(".wmicon.wmicon-remove").parent("button")[0],c={},b;for(b in a)c[b]=a[b];c.target=d;c.srcElement=d;N("mouseover",c);N("click",c)}});jQuery(".js-searchbar-clear.searchbar-clear.btn-link.absolute-center-v>span").on("mousedown",function(a){if(0<
jQuery(".js-searchbar-clear.searchbar-clear.btn-link.absolute-center-v>span").parent("button").length){var d=jQuery(".js-searchbar-clear.searchbar-clear.btn-link.absolute-center-v>span").parent("button")[0],c={},b;for(b in a)c[b]=a[b];c.target=d;c.srcElement=d;N("mouseover",c);N("click",c)}});jQuery(".js-searchbar-input.js-header-instant-placeholder.searchbar-input.tt-input").on("mousedown",function(a){var d=jQuery(".js-searchbar-input.js-header-instant-placeholder.searchbar-input.tt-input")[0],c=
{},b;for(b in a)c[b]=a[b];c.target=d;c.srcElement=d;N("mouseover",c);N("click",c)});jQuery(document).keyup(function(){if(jQuery(".js-searchbar-input.js-header-instant-placeholder.searchbar-input").length){var a=jQuery(".js-searchbar-input.js-header-instant-placeholder.searchbar-input").val();ma('jQuery(".js-searchbar-input.js-header-instant-placeholder.searchbar-input").val("'+a+'");')}});if(window.ClickTaleSettings&&window.ClickTaleSettings.ChangeMonitor&&!window.ClickTaleSettings.ChangeMonitor.Enable==
e)jQuery(document).on("shown hidden",".js-header-flyout, .js-flyout",function(a){var d=jQuery(".js-header-flyout, .js-flyout").index(this),c="shown"===a.type?"show":"hide";jQuery(".js-header-flyout, .js-flyout").eq(d).parent("SPAN").hasClass("js-refine-store-container")?setTimeout(function(){var a=jQuery(".js-header-flyout, .js-flyout").eq(d).html(),a="jQuery('.js-header-flyout, .js-flyout').eq("+d+").html(unescape('"+escape(a)+"')).flyout('"+c+"');",a=a+("jQuery('.js-header-flyout, .js-flyout').eq("+
d+").find('.spinner-backdrop').hide();");G(a)},500):G("jQuery('.js-header-flyout, .js-flyout').eq("+d+").flyout('"+c+"');")});jQuery(document).on("change",'[id*="product-care-plan"]',function(){I("Item page: Care plan",e)});jQuery(document).on("mouseenter","nav.nav-main > ul > li > a, nav.nav-main ul.nav-dropdown > li > a",function(){var a=jQuery("nav.nav-main > ul > li > a, nav.nav-main ul.nav-dropdown > li > a").index(this);G("jQuery('nav.nav-main > ul > li > a, nav.nav-main ul.nav-dropdown > li > a').eq("+
a+").mouseover();")});jQuery(document).on("mouseleave","nav.nav-main > ul > li > div.js-nav-dropdown-container, nav.nav-main > ul > li > a",function(){var a=jQuery("nav.nav-main > ul > li > div.js-nav-dropdown-container, nav.nav-main > ul > li > a").index(this);G("jQuery('nav.nav-main > ul > li > div.js-nav-dropdown-container, nav.nav-main > ul > li > a').eq("+a+").mouseout();")});jQuery(document).on("mouseenter mouseleave","button.js-nav-dropdown-toggle, .carousel, .js-lhn-menu > li",function(a){var d=
jQuery(this),a="mouseover"===a.type||"mouseenter"===a.type?["over","add"]:["out","remove"];d.is(".js-lhn-menu > li")?(d=jQuery(".js-lhn-menu > li").index(this),G("jQuery('.js-lhn-menu > li').eq("+d+").children('a').mouse"+a[0]+"();")):window.ClickTaleSettings&&window.ClickTaleSettings.ChangeMonitor&&!window.ClickTaleSettings.ChangeMonitor.Enable==e&&d.hasClass("carousel")?(d=jQuery(".carousel").index(this),G("jQuery('.carousel').eq("+d+")."+a[1]+"Class('cthover');")):d.is("button.js-nav-dropdown-toggle")&&
(d=jQuery("button.js-nav-dropdown-toggle").index(this),G("jQuery('button.js-nav-dropdown-toggle').eq("+d+").mouse"+a[0]+"();"))});jQuery(document).on("closeend.expander openend.expander",".expander",function(a){var d=jQuery(".expander").index(this),a="openend"===a.type?"open":"close",c=jQuery(this);G("ctHandleExpander("+d+", '"+a+"');");Q&&!c.hasClass("see-more")&&(d=jQuery.trim(c.children(".expander-toggle").text()))&&I(Q+"open/close refiner: "+d,e)}.b(250,e));"Search Page: "===Q&&(jQuery(document).on("click.expander",
".expander",function(a){var d=jQuery(".expander").index(this),c=jQuery(this),a=jQuery(a.target);a.attr("class");(a.is("A.expander-toggle")||a.parent().is("A.expander-toggle"))&&G("jQuery('.expander').eq("+d+").children('.expander-toggle').click();");Q&&(a.is("A.expander-toggle")||a.parent().is("A.expander-toggle")&&!a.hasClass("js-facet-see-more"))?-1<c.children(".expander-toggle").children(".expander-text").text().indexOf("See all")?I(Q+"See all",e):(d=c.children(".expander-toggle").text().trim())&&
I(Q+"open/close refiner: "+d,e):Q&&a.hasClass("js-facet-see-more")&&G("jQuery('.expander').eq("+d+").find('.js-facet-see-more').click();")}.b(250,e)),jQuery(document).on("click","#tile-container .js-tile",function(){I(Q+"click on result",e)}),jQuery(document).on("click","#related-search-container A",function(){I(Q+"related searches",e)}),jQuery(document).on("click",".paginator A",function(){I(Q+"pager",e)}));-1<document.location.href.toLowerCase().indexOf("reviews/write-review")&&(jQuery("#review-title").on("keyup",
function(){var a=jQuery(this).val();G("jQuery('input#review-title').val(unescape('"+escape(a)+"'));")}),jQuery("#review-body").on("keyup",function(){var a=jQuery(this).val();G("jQuery('textarea#review-body').val(unescape('"+escape(a)+"'));")}));jQuery(document).on("selected",".carousel",function(a,d){var c=a.target;if("function"===typeof d.index){var c=jQuery(".carousel").index(c),b=d.index();G("ctHandleCarousel("+c+", "+b+");")}});var r=function(){setTimeout(function(){H();ClickTaleFetchFrom=ClickTaleFetchFromWithCookies.constructFetchFromUrl(document.location.href+
"#"+encodeURIComponent("CTFetchUserAgent=VisitorUserAgent"));window.ClickTaleIncludedOnDomReady=e;window.ClickTaleIncludedOnWindowLoad=e;M();qa()},500)};if(-1<document.location.href.toLowerCase().indexOf("checkout")){document.location.href.toLowerCase().indexOf("#checkout/sign-in")&&P("Checkout: Sign in");jQuery(window).on("hashchange",function(){if("function"===typeof window.ClickTaleLogical&&"function"===typeof window.ClickTaleUploadPage)var a=setInterval(function(){jQuery(".js-checkout-load-spinner").is(":visible")||
(v(),clearInterval(a))},1500)});var v=function(){-1<document.location.href.toLowerCase().indexOf("/#checkout/payment")?setTimeout(function(){H();ClickTaleUploadPage();window.ClickTaleIncludedOnDomReady=e;M();D()},1E3):(H(),ClickTaleUploadPage(),window.ClickTaleIncludedOnDomReady=e,M(),D())},Z=function(a){-1<document.location.href.toLowerCase().indexOf("/#checkout/payment")&&F(function(){return function(){window.ClickTaleIncludedOnDomReady=e;window.ClickTaleIncludedOnWindowLoad=e;ClickTaleUploadPage();
M();D()}}(a),function(a){return function(){if(window.jQuery&&"function"===typeof jQuery.fn.on)return"COAC3PayCCBtn"==a&&!jQuery("section[data-view-name = 'creditcard']").hasClass("hide-content")||"COAC3PayGiftCardBtn"==a&&!jQuery("section[data-view-name = 'giftcard']").hasClass("hide-content")||"COAC3PayPayPalBtn"==a&&!jQuery("section[data-view-name = 'paypal']").hasClass("hide-content")||"COAC3PayCashBtn"==a&&!jQuery("section[data-view-name = 'pip']").hasClass("hide-content")?e:i}}(a),250,40)},aa=
function(){"function"===typeof window.ClickTaleFormDisableAll&&window.ClickTaleFormDisableAll();var a=jQuery(".col12.l-col6.accordion-col-alpha select:visible,.col12.l-col6.accordion-col-alpha input:visible, #COAC3PayBillAddrChkBox",".js-credit-card-identity.credit-card-identity.grid.accordion-form").toArray(),d=jQuery("#COAC3PayReviewOrderBtn");W(a)&&W(d)&&(d=[d[0]],T="function"===typeof window.ClickTaleLogicalForm?window.ClickTaleLogicalForm("Payment Form",a,d):0)},D=function(){ta();if(jQuery("[data-view-name='shipping-address']").hasClass("expanded")&&
!jQuery(".validation-wrap").is(":visible"))S=jQuery("form[data-view-name='global-ui-shipping-address-form']")[0],I("Checkout: shipping address");else if(jQuery("[data-view-name='pickup-person']").hasClass("expanded"))S=jQuery("form[name='pickupIdentity']")[0],I("Checkout: pickup person");else if(jQuery("[data-view-name='payment']").hasClass("expanded")){jQuery("[data-view-name='payment'] section[data-view-name='giftcard']:not('.hide-content')").length&&I("Checkout: payment - Gift card");var a=jQuery("[data-view-name='payment'] section:not('.hide-content') > form");
S=a[0];a.filter(".js-credit-info").length&&(I("Checkout: payment - credit card"),F(function(){return new function(){I("Checkout: payment - edit")}},function(){return jQuery(".credit-card-expanded").length?e:i},200,15),F(aa,function(){return jQuery(".credit-card-identity").length?e:i},200,15));a.filter(".js-paypal-info").length&&I("Checkout: payment - PayPal");a.filter(".js-submit-cash-info").length&&I("Checkout: payment - Cash")}-1<document.location.href.indexOf("shipping-address")&&0<jQuery("#COAC2ShpAddrAddNewAddrLnk").length&&
0==jQuery('.accordion-header-expanded.accordion-container:contains("Enter a pickup person"):visible').length&&0==jQuery('.accordion-header-expanded.accordion-container:contains("Select payment method"):visible').length&&I("Add Address");-1<document.location.href.toLowerCase().indexOf("fulfillment")&&!jQuery(".js-fulfillment-groups-container").hasClass("expanded")?I("zip page"):-1<document.location.href.toLowerCase().indexOf("fulfillment")?I("Shipping and delivery: select shipping or delivery"):jQuery(".validation-wrap").is(":visible")&&
I("Verify address");jQuery("#COPlaceOrderBtn:visible").length&&ka()}}jQuery(document).on("ajaxComplete",function(a,d,c){"function"===typeof ClickTaleRebindEvents&&ClickTaleRebindEvents();a="";-1<c.url.indexOf("adConfig=midas-v2&placementId=midas-v2&module=midas-v2&pageType=search")?(a=jQuery(".sponsored-container-middle").html(),0<a.length&&(G("jQuery('.sponsored-container-middle').html(unescape('"+escape(a)+"')).show();"),I(Q+"sponsored products",e))):-1<c.url.indexOf("ajax=true")?r():(-1<c.url.indexOf("/product/shippingOptions/")||
-1<c.url.indexOf("/product/api/"))&&setTimeout(function(){G("jQuery('#location-search-1').val('-----');");G("jQuery('.js-product-fulfillment-default-location.product-freight-default-location').text('Showing options for -----');")},100)});jQuery(document).on("click keyup",function(a){a=jQuery(a.target);a.hasClass("js-sf-flyout-form")?I("All Pages: Store Locator",e):a.hasClass("js-searchbar")?I("All Pages: Search"):a.hasClass("js-footer-email-signup-form")&&I("All Pages: Sign Up")});jQuery(".js-sf-flyout-form").submit(function(){I("All Pages: Store Locator",
e)});jQuery(document).mousedown(function(a){var d=a.target,c=jQuery(d),b=c.closest(".see-all-reviews");(W(c.closest("a[href=#reviews]"))||W(b))&&P("item page clicked on reviews (R&R)");b=c.closest("a.qa-question");(W(c.closest("a[href=#qa]"))||W(b))&&P("item page clicked on Q&A");1===a.which&&(c.is(".nav-dropdown-container a")?X(d,function(a){return function(){"function"===typeof window.ClickTaleRegisterElementAction&&(ClickTaleRegisterElementAction("mouseover",a),ClickTaleRegisterElementAction("click",
a))}}(a)):(a=c.closest("button.js-nav-dropdown-toggle"),W(a)?X(d,function(a){return function(){var b=jQuery("button.js-nav-dropdown-toggle").index(a);G("jQuery('button.js-nav-dropdown-toggle').eq("+b+").click();")}}(a)):W(c.closest(".js-searchbar"))?(I("All Pages: Interacted with search box",e),d=jQuery(".js-searchbar-input").val(),G("jQuery('.js-searchbar-input').val('"+d+"').trigger('input');")):(a=c.closest(".nav-customer-list a.nav-customer-list-link"),W(a)?X(d,function(a){return function(){var b=
a.text(),b=jQuery.trim(b);I("All Pages: "+b)}}(a)):W(c.closest(".header-cart a"))?X(d,function(){I("All Pages: Shopping Cart")}):c.is("#oo_w_content > a[id]")?X(d,function(a){return function(){var b=oa[a];b&&I("All Pages: "+b+" Feedback Clicked")}}(d.id)):(a=c.closest('[id^="nav-department-submenu-"] a'),W(a)?(d=a.closest("ul").find(".nav-flyout-heading").text(),(d=jQuery.trim(d))&&I("All Pages: Category Click: "+d)):W(c.closest(".carousel.js-carousel-one-up .items li"))?X(d,function(){Q&&I(Q+"Click on carousel")}):
(a=c.closest(".expander-content li"),W(a)?(d=jQuery.trim(a.closest(".expander:not(.see-more)").children(".expander-toggle").text()))&&I(Q+"interact with refiner: "+d,e):W(c.closest(".utility-bar-refiner .dropdown.js-flyout-toggle"))?(d=c.text().trim())&&I(Q+"Refine "+d,e):(a=c.closest(".utility-bar-sorter .chooser-option-list>[class^=chooser-option]"),W(a)?X(d,function(a){return function(){var b=jQuery(".utility-bar-sorter .chooser-option-list>[class^=chooser-option]").index(a);2>b&&G("jQuery('.utility-bar-sorter .chooser-option-list>[class^=chooser-option]').eq("+
b+").click();");Q&&I(Q+"Sort",e)}}(a)):W(c.closest(".product-media.js-product-media"))?I("Item page: Interact with product image",e):c.is(".variant-swatch")?I("Item page: Select color",e):(c.is(".submit-review-ratings-container .submit-review-ratings button[data-index = '0']")&&I("Review product - one star rating",e),c.is("label[for='recommend-friend-no']")&&I("would not recommend to a friend",e),c.closest("button").hasClass("js-tab-pickup-btn")&&setTimeout(function(){G("jQuery('#location-search-2').val('-----');");
G("jQuery('.js-product-fulfillment-default-location.product-freight-default-location').text('Showing options for -----');")},100))))))))});document.location.href.indexOf("/ip/")&&(jQuery(".btn-link.js-tab-ship-btn.product-fulfillment-btn i, .btn-link.js-tab-ship-btn.product-fulfillment-btn b, .btn-link.js-tab-ship-btn.product-fulfillment-btn span").mouseup(function(a){Y(jQuery(".btn-link.js-tab-ship-btn.product-fulfillment-btn")[0],a)}),jQuery(".btn-link.js-tab-pickup-btn.product-fulfillment-btn a, .btn-link.js-tab-pickup-btn.product-fulfillment-btn b, .btn-link.js-tab-pickup-btn.product-fulfillment-btn span").mouseup(function(a){Y(jQuery(".btn-link.js-tab-pickup-btn.product-fulfillment-btn")[0],
a)}),jQuery(".product-media.js-product-media").mouseup(function(a){Y(jQuery(".product-image.js-product-image.js-product-primary-image")[0],a)}),jQuery(document).on("mouseup","#location-search-1, #location-search-2",function(a){"location-search-1"===jQuery(this).attr("id")?Y(jQuery("#location-search-1")[0],a):Y(jQuery("#location-search-2")[0],a)}),jQuery(".js-carousel-items.items.animate.slick-initialized .slick-slide").mouseup(function(a){var b=jQuery(".js-carousel-items.items.animate.slick-initialized .slick-slide").index(this);
Y(jQuery(".product-recommendations.top-product-recommendations .slick-list li img:eq("+b+")")[0],a)}),jQuery(".product-thumb.js-product-thumb.Selector").mouseup(function(a){var b=jQuery(".product-thumb.js-product-thumb.Selector").index(this);Y(jQuery(".product-thumb.js-product-thumb.Selector:eq("+b+")")[0],a)}),jQuery(".js-carousel-items.animate-vertical:eq(1) div").mouseup(function(a){jQuery(".js-carousel-items.animate-vertical:eq(1) div").index(this);Y(jQuery(".js-carousel-items.animate-vertical:eq(1) div a")[0],
a)}),jQuery.isFunction(jQuery.fn.on)&&(jQuery(".about-product-section .heading-a:contains('About this item')").on("mouseenter click",function(){I("about this item")}),jQuery(".btn-badge:contains('Specifications')").on("mouseenter click",function(){I("item page specifications")}),jQuery(".btn-badge:contains('Nutrition facts')").on("mousedown",function(){I("item page nutrition facts")}),jQuery(".btn-badge:contains('Supplement facts')").on("mousedown",function(){I("item page Supplemental facts")}),jQuery(".btn-badge:contains('Drug facts')").on("mouseenter click",
function(){I("item page Drug facts ")})));jQuery(".nav-dropdown.js-nav-dropdown.nav-dropdown-homepage button").mousedown(function(a){0<jQuery(this).length&&Y(jQuery(this)[0],a)});jQuery(document).click(function(a){var a=a.target,b=jQuery(a);b.hasClass("js-footer-feedback-opinion-lab")?(a=jQuery(".js-footer-feedback-opinion-lab").index(a),G("jQuery('.js-footer-feedback-opinion-lab').eq("+a+").click();"),I("All Pages: Feedback Clicked")):W(b.closest(".oo_w_close, .oo_cc_close, #oo_overlay, .oo_cc_wrapper > span"))||
"oo_w_container"===a.id?G("jQuery('.oo_w_close').click();"):b.is("button.js-expandcollapse-btn")?(a=jQuery("button.js-expandcollapse-btn").index(a),G("jQuery('button.js-expandcollapse-btn').eq("+a+").click();")):b.is(".js-facet-tab-btns button")?(a=jQuery(".js-facet-tab-btns button").index(a),G("jQuery('.js-facet-tab-btns button').eq("+a+").click();")):(b.is(".js-add-to-cart.js-btn-progress.add-to-cart")&&I("Item page: add to cart",e),b.is(".js-flyout-toggle.js-btn-add-to-list")&&I("Item page: add to list",
e),b.is(".js-flyout-toggle.js-btn-add-to-list")&&I("Item page: add to list",e),b.is(".js-btn-add-to-registry")&&I("Item page: add to registry",e))});if(-1<document.location.href.toLowerCase().indexOf("checkout")){jQuery(document).on("mousedown",function(a){var b=jQuery(a.target),c="",g=0;if(b.hasClass("js-form-save-button")){if(jQuery("#COAC1ShpOptChangeZipInp").hasClass("error"))return;var g=0,h=setInterval(function(){10>g?(g++,jQuery(".js-fulfillment-groups-container").hasClass("expanded")&&!jQuery(".js-checkout-load-spinner").is(":visible")&&
(clearInterval(h),setTimeout(function(){v()},1500))):clearInterval(h)},700)}c=b.closest("#COAC0WelAccntSignInBtn");W(c)&&(V="LogIn",I("Sign in: Sign in"),setTimeout(function(){s()},500));c=b.closest("#COAC0WelAccntSignUpBtn");W(c)&&(V="NewUser",I("Sign in: Create account"),setTimeout(function(){s()},500));c=b.closest(".js-shipping-opts.shipping-opts");W(c)&&I("Shipping and delivery: Interact with shipping",e);c=b.closest(".js-pickup-opts.pickup-opts");W(c)&&I("Shipping and delivery: Interact with pickup",
e);c=b.closest("#COAC1ShpOptPickUpAllLnk");W(c)&&Y(jQuery("#COAC1ShpOptPickUpAllLnk")[0],a);c=b.closest("#COAC3PayCCEditLnk0");W(c)&&Y(jQuery("#COAC3PayCCEditLnk0")[0],a);c=b.closest(".js-edit-credit-card");W(c)&&setTimeout(function(){O()},1E3);c=b.closest("#COAC1ShpOptSeeAllLnk");W(c)&&Y(jQuery("#COAC1ShpOptSeeAllLnk")[0],a);c=b.closest("#COAC3PayCCAddNewLnk");W(c)&&setTimeout(function(){O()},1500);c=b.closest("#COAC3PayAddaCardLnk");W(c)&&(G('window["giftCardButtons"]();'),ua(),setTimeout(function(){O()},
1500));c=b.closest("label[for = 'COAC3PayCashAddrChkBox']");W(c)&&setTimeout(function(){O()},100);b.is("#COAC3PayCardCancel")&&U!=f&&(G('jQuery(".js-gift-card-backdrop.gift-card-book-backdrop").addClass("hide-content");jQuery(".gift-card-form-flyout").removeClass("expanded")'),U.disconnect());b.is("#COAC1ShpCancelEditBtn")&&Y(jQuery("#COAC1ShpCancelEditBtn")[0],a);b.is("#global-email-signup-input")&&Y(jQuery("#global-email-signup-input")[0],a);b.is("#COAC1ShpOptContBtn")&&(Y(jQuery("#COAC1ShpOptContBtn")[0],
a),I("Shipping and delivery: Continue",e));b.is("#COAC3PayReviewOrderBtn")&&I("Payment: Review your order",e);b.is("#COAC3ProceedPayPalBtn")&&(Y(jQuery("#COAC3ProceedPayPalBtn")[0],a),I("Payment: proceed to PayPal",e));b.hasClass("js-shipping-address-continue")&&(J(S),K(S),I("Shipping address: Continue",e),setTimeout(function(){0<jQuery(".required").length?(I("Shipping address: General error",e),L(S)):ka(S)},700),setTimeout(function(){if(jQuery(".validation-wrap").is(":visible")){g=0;var a=setInterval(function(){10>
g?(g++,jQuery(".js-checkout-load-spinner").is(":visible")||(clearInterval(a),v())):clearInterval(a)},700)}},1200));b.is("[data-view-name='creditcard'] #COAC3PayReviewOrderBtn")&&(J(T),K(T),setTimeout(function(){0<jQuery(".js-server-alert-checkout:visible").length&&L(T)},400));b.hasClass("auto-submit-pickup-person")&&(J(S),K(S),I("Pickup person: continue",e),setTimeout(function(){0<jQuery(".required").length?(I("Pickup person: General error",e),L(S)):ka(S)},700));if(b.hasClass("save-address-validation")){Y(jQuery(".save-address-validation")[0],
a);var g=0,j=setInterval(function(){10>g?(g++,jQuery(".accordion-module.checkout-payment-options.expanded").is(":visible")&&(clearInterval(j),setTimeout(function(){v()},600))):clearInterval(j)},500)}});var t=function(){var a=i;"NewUser"==V&&jQuery(".js-create-account.create-account .error-label.parsley-error-list").length&&(I("Sign in: General error"),a=e);"LogIn"==V&&jQuery(".signin-form .error-label.parsley-error-list").length&&(I("Sign in: General error"),a=e);!a&&jQuery(".alert-error.alert-block.active").length&&
I("Sign in: General error")},s=function(){F(t,function(){return!jQuery(".spinner:visible").length?e:i},600,50)};jQuery(document).on("click",function(a){a=a.target;jQuery(a).is("[data-view-name='payment'] input[name='radio-option-radio'][id]")&&"function"===typeof window.ClickTaleLogical&&"function"===typeof window.ClickTaleUploadPage&&(H(),Z(a.id))});jQuery(document).on("mousedown",function(a){jQuery(a.target).hasClass("edit-address-validation")&&(Y(jQuery(".edit-address-validation")[0],a),setTimeout(function(){v()},
700))});jQuery("#COAC1ShpOptPickUpAllLnk").mousedown(function(a){Y(jQuery("#COAC1ShpOptPickUpAllLnk")[0],a);setTimeout(function(){0<jQuery(".pickup-modal-content.scrollable.js-pickup-modal-content").length&&(jQuery(".pickup-modal-content.scrollable.js-pickup-modal-content")[0].onscroll=function(){var a=jQuery(".pickup-modal-content.scrollable.js-pickup-modal-content").scrollTop();G("jQuery('.pickup-modal-content.scrollable.js-pickup-modal-content').scrollTop(\""+a+"\", { duration: 'slow' });")})},
800)});D();var ua=function(){if(window.MutationObserver){var a=document.querySelector(".js-gift-card-form-flyout");U=new window.MutationObserver(function(a){a.forEach(function(){setTimeout(function(){var a="",b=jQuery(".js-gift-card-form-flyout #COAC3PayCardNbr").siblings().filter(".error-label.parsley-error-list"),d=jQuery(".js-gift-card-form-flyout #COAC3PayCardPin").siblings().filter(".error-label.parsley-error-list");if(jQuery(".js-gift-card-form .js-form-server-alert:visible").length){var g=
jQuery(".js-form-server-alert").html();jQuery(".js-gift-card-form .js-form-server-alert").hasClass("alert-warning")&&(a="jQuery('.js-gift-card-form').prepend(\"<span class='js-form-server-alert alert alert-warning alert-block active'></span>\"); jQuery('.js-gift-card-form .js-form-server-alert').html(unescape('"+escape(g)+"'))");jQuery(".js-gift-card-form .js-form-server-alert").hasClass("alert-error")&&(a="jQuery('.js-gift-card-form').prepend(\"<span class='js-form-server-alert alert alert-error alert-block active'></span>\"); jQuery('.js-gift-card-form .js-form-server-alert').html(unescape('"+
escape(g)+"'))");G("jQuery('.js-form-server-alert').remove();"+a)}(b.length||jQuery("#COAC3PayCardNbr").val().length&&!b.length)&&G('jQuery(".js-gift-card-form-flyout #COAC3PayCardNbr").siblings().filter(".error-label.parsley-error-list").remove();jQuery(".js-gift-card-form-flyout #COAC3PayCardNbr").siblings().filter(".validation-marker").remove(); jQuery("#COAC3PayCardNbr").css("border-color","#79b9e7");');(d.length||jQuery("#COAC3PayCardPin").val().length&&!d.length)&&G('jQuery(".js-gift-card-form-flyout #COAC3PayCardPin").siblings().filter(".error-label.parsley-error-list").remove();jQuery(".js-gift-card-form-flyout #COAC3PayCardPin").siblings().filter(".validation-marker").remove(); jQuery("#COAC3PayCardPin").css("border-color","#79b9e7");');
b.length&&(a=b.html(),G('jQuery(".js-gift-card-form-flyout .validation-group:eq(0)").append("<div class=\'error-label parsley-error-list\'></div>"); jQuery("#COAC3PayCardNbr").css("border-color","#f42121"); jQuery(".js-gift-card-form-flyout .validation-group:eq(0)").append("<i class=\'validation-marker validation-marker-error\'><span class=\'visuallyhidden\'></span></i>"); jQuery(".error-label.parsley-error-list:eq(0)").html(unescape("'+escape(a)+'"));'));d.length&&(a=d.html(),G('jQuery(".js-gift-card-form-flyout .validation-group:eq(1)").append("<div class=\'error-label parsley-error-list\'></div>"); jQuery("#COAC3PayCardPin").css("border-color","#f42121"); jQuery(".js-gift-card-form-flyout .validation-group:eq(1)").append("<i class=\'validation-marker validation-marker-error\'><span class=\'visuallyhidden\'></span></i>"); jQuery(".error-label.parsley-error-list:eq(1)").html(unescape("'+
escape(a)+'"));'))},500)}.b(500))});U.observe(a,{childList:e,characterData:e,subtree:e})}}}}}window.addEventListener("onbeforeunload",function(){var b=ClickTaleDetectAgent();b.t==b.IE&&9==b.v&&H()},i);
(function(b){function g(){2==++window.okToStartOn2&&b()}window.okToStartOn2=0;ja(function(){g()});if("undefined"!==typeof window.ClickTaleIsRecording&&window.ClickTaleIsRecording()===e)g();else{var h=window.ClickTaleOnRecording||function(){};window.ClickTaleOnRecording=function(){g();return h.apply(this,arguments)}}})(function(){F(sa,function(){return window.jQuery&&"function"===typeof jQuery.fn.on?e:i},250,40)});
function ta(){if("object"==typeof window.s_omni&&"string"==typeof window.s_omni.prop20)for(var b=document.location.href.toLowerCase(),g="",h=i,j=window.s_omni.prop20.split(","),l=0;l<j.length;l++)"undefined"!=typeof j[l]&&j[l].length&&"0|0"!=j[l]&&(h=i,-1<b.indexOf("/ip/")?(h=e,g="A/B test - Item Page - "):-1<b.indexOf("/cp/")?(h=e,g="A/B test - Category Page - "):-1<b.indexOf("/checkout/#checkout")?(h=e,g="A/B test - Checkout Page "):"/"==document.location.pathname&&(h=e,g="A/B test - Home Page - "),
h&&P(g+j[l]))};})(); }


window.ClickTaleRulesMetaData = {"Data":[{"Rule":"{\"Action\":{\"actionType\":\"EventAction\",\"params\":{\"eventName\":\"test event for tips and ideas - visual editor\"}},\"Trigger\":{\"event\":\"click\",\"elements\":[[{\"tagCode\":2884,\"index\":0},{\"tagCode\":40,\"elementID\":\"top\",\"index\":0},{\"tagCode\":2884,\"index\":1},{\"tagCode\":2884,\"index\":0},{\"tagCode\":2830,\"index\":0},{\"tagCode\":2884,\"index\":0},{\"tagCode\":2884,\"index\":0},{\"tagCode\":2884,\"index\":1},{\"tagCode\":117,\"index\":0},{\"tagCode\":76,\"index\":2},{\"tagCode\":1,\"index\":0}]]},\"Location\":{}}"}]};
!function(){var l=!0,m=null,n=!1,o=this;function q(a,d){var c=a.split("."),b=o;!(c[0]in b)&&b.execScript&&b.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)!c.length&&void 0!==d?b[f]=d:b=b[f]?b[f]:b[f]={}};var r;var s=n;function t(){return l}var u=n,v={},w={};function x(a){r.console&&r.console.log(a)}function y(a,d){var c=d.firstChild,b=d.ClickTale;b&&"CustomID"in b&&(b=b.CustomID,b||(b in a?(v[b]=l,x("duplicate registration of custom id "+b+"were found on multiple elements")):a[b]=d));for(;c;c=c.nextSibling)1===c.nodeType&&y(a,c)}function z(a){u||(a.c=A(a.c),u=l)}function B(a,d){D(a).CustomID=d}
function A(a){return function(d,c){c in w?(v[c]=l,x("duplicate registration of custom id "+c+" were found on multiple elements")):(a(d,c),s&&(w[c]=d))}}var E=A(B);function D(a){var d=a.ClickTale;d||(d={},a.ClickTale=d);return d}function F(a){return r.getComputedStyle?r.getComputedStyle(a,m):a.currentStyle}var G={};function H(a){G[a]||(G[a]=(a.charCodeAt(0)-64&31)+((a.charCodeAt(1)-64&28)<<3)+((a.charCodeAt(2)-64&30)<<7));return G[a]}
function I(a,d){for(var c=t,b=0,f=d.length,g=n,h=m,k=m,c=c||t,e=0;a&&e<f;e++){g=n;k=d[e];for(h=a.firstChild,b=0;!g&&h;h=h.nextSibling)1===h.nodeType&&H(h.tagName)===k.tagCode&&(b===k.index&&c(h)&&(g=l,a=h),b++)}return(g=g&&"none"!==F(a).display.toLowerCase())?a:m}function K(a,d){var c;if(a.map)c=a.map(d,void 0);else{c=[];for(var b=a.length,f=window,g=0;g<b;g++)c.push(d.call(f,a[g],g))}return c}
function L(a,d,c){for(var b=n,f=m,g=a.ownerDocument,h=d.length,k=h,e={},i,c=c||t;0<k;k--){var j=d[k-1];if(j.customID){if(j.customID in v&&v[j.customID])return x("duplicate custom id "+j.customID+" were found on multiple elements"),{};f=w[j.customID];b=!!f;if(!b)return{}}if(!b&&j.elementID){try{i=g.querySelectorAll("#"+j.elementID),i.length||(i=g.querySelectorAll("[id='"+j.elementID.replace(/'/g,"\\'")+"']"))}catch(O){i=g.querySelectorAll("[id='"+j.elementID.replace(/'/g,"\\'")+"']")}i&&(1===i.length?
(f=i[0],b=!!f):1<i.length&&x("duplicate id "+j.elementID+" were found on multiple elements"))}if(!b&&j.name&&(j.tagCode===H("input")||j.tagCode===H("select")||j.tagCode===H("textarea"))){i=d.slice(0,k-1);b=M(a,i);i=g.getElementsByName(j.name);if(b){var p=m;if(1<i.length){for(var J=l,C=0;C<i.length;C++)if(p=i[C],N(b,p)&&"radio"!==p.type.toLowerCase()){J=n;break}J?f=I(b,d):x("duplicate name "+j.name+" found on multiple non radio elements")}else 1===i.length&&(p=i[0],N(b,p)&&(f=p))}b=!!f}if(b&&c(f))return a=
d.slice(k,h),e.b=a,e.a=f,e;b=n}e.b=d;e.a=a;return e}function N(a,d){var c=d;do{if(a===c)return l;if("form"===c.tagName.toLowerCase())break}while((c=c.parentNode)&&1===c.nodeType);return n}function M(a,d){var c=L(a,d,function(a){return 1===a.nodeType&&"form"===a.tagName.toLowerCase()});return c?c.a:m};q("ct.ElementAddressing.bootstrap",function(a,d){d=!!d;r=a;a.c=B;a.document.addEventListener?a.document.addEventListener("DOMContentLoaded",function(){var c=d;z(a);c&&y(w,a.document.documentElement);s=l},n):document.attachEvent("onreadystatechange",function(){if("complete"===document.readyState){var c=d;z(a);c&&y(w,a.document.documentElement);s=l}})});
q("ct.ElementAddressing.elementFromPath",function(a,d,c){var b=!(a[0]instanceof Array);b&&(a=[a]);a=K(a,function(a){a=L(d,a,t);a.a&&0<a.b.length&&(a.a=I(a.a,a.b));return!c&&a.a&&"hidden"===F(a.a).visibility.toLowerCase()?m:a.a});return b?a[0]:a});
q("ct.ElementAddressing.pathFromElement",function(a,d){var c=0,b,f=0,g=m,h=[],k=m;b=m;var e=a;if(!d)return window.console&&window.console.log("Base element was not specified"),h;for(;e&&e!==d;)if(1!==e.nodeType)e=e.parentNode;else{f=0;g={};a=e;c=H(e.nodeName);g.tagCode=c;if(b=D(a).CustomID)g.customID=b;e.id&&(g.elementID=e.id);b=e.attributes;if((k=b.getNamedItem("name"))&&k.value)g.name=k.value;for(b=e;b=b.previousSibling;)H(b.nodeName)===c&&f++;g.index=f;e=e.parentNode;h.push(g)}h.reverse();return h});
q("ct.ElementAddressing.elementAndVisibilityFromPath",function(a,d){var c=!(a[0]instanceof Array);c&&(a=[a]);var b=K(a,function(a){a=L(d,a,t);a.a&&0<a.b.length&&(a.a=I(a.a,a.b));if(a.a){var b={};b.dom=a.a;b.isHidden="hidden"===F(a.a).visibility.toLowerCase();a=b}else a=m;return a});return c?b[0]:b});q("ct.ElementAddressing.setCustomElementID",E);}();
if (typeof ctlogger=== 'undefined') {

    var ctlogger= {
        levels: {"off":0, "on":1 },
    }
    
    ctlogger.level = ctlogger.levels.off,
    ctlogger.setLogLevel = function (levelSelected) { this.level = levelSelected; },
    ctlogger.enableDebug = function() {

        ctlogger.level = ctlogger.levels.on;

        if (typeof (Storage) !== "undefined") {
            sessionStorage.setItem("ctlogger.level.on", true);
        }


    },
    ctlogger.disableDebug = function () { ctlogger.level = ctlogger.levels.off; },
    ctlogger.isDebug = function () { return ctlogger.level == ctlogger.levels.on; },
    ctlogger.checkSiteForDebugMode = function() {

        var loc = window.location.href;
        var urlParts = loc.split('?');
        if (urlParts.length == 2) {

            var qs = urlParts[1];
            var qsParams = qs.split('&');
            for (var i = 0; i < qsParams.length; i++) {
                var pair = qsParams[i].split('=');
                var name = decodeURIComponent(pair[0]).toLowerCase();
                if (pair.length == 2 && (name == "ct" || name == "clicktale") && decodeURIComponent(pair[1]).toLowerCase().indexOf("debug")>-1) {
                    ctlogger.setLogLevel(ctlogger.levels.on);
                } 
            }
        }

    },
    ctlogger.log = function () {

        if (!ctlogger.isDebug()) {

            if (typeof (Storage) !== "undefined") {
                var enabledIsStorage = sessionStorage.getItem("ctlogger.level.on");
                if (enabledIsStorage == "true") {
                    ctlogger.level = ctlogger.levels.on;
                }
            }
        }

        if (window.console && (ctlogger.level != ctlogger.levels.off || ctlogger.checkSiteForDebugMode())) {
            console.log("clicktale.visualEditor.common.logger: ", arguments);
        }
    }
}
var CTrulesImplementationUtils = {

    create: function(o, properties) {
        if (Object.create) {
            return Object.create(o, properties);
        } else {//polyfill Object.create method if not supported by the browser 
            
            if (typeof o !== 'object' && typeof o !== 'function') throw new TypeError('Object prototype may only be an Object: ' + o);
            else if (o === null) throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");

            if (typeof properties != 'undefined') throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");

            function F() {}

            F.prototype = o;

            return new F();
        }
    },

    isEmptyObject: function (obj) {
        var name;
        for (name in obj) {
            return false;

        }
        return true;

    },
    validateRuleLocation: function (location, documentUrl) {

        var valid = false;
        if (CTrulesImplementationUtils.isEmptyObject(location)) //all pages
        {
            valid = true;
        }
        else
        {


            var url = documentUrl.toLowerCase().trim().replace(/\/$/, "");
            var currentRuleLocation = location.url.toLowerCase().trim().replace(/\/$/, "");
            

            switch (location.urlMode) {

                case "Equals":
                    if (url == currentRuleLocation) valid = true;
                    break;
                case "StartsWith":
                    if (url.indexOf(currentRuleLocation) == 0) valid = true;
                    break;
                case "Contains":
                    if (url.indexOf(currentRuleLocation) > -1) valid = true;
                    break;
                }
        }

        return valid;

    },
};

//for ie8
if (typeof String.prototype.trim !== 'function') {
    String.prototype.trim = function () {
        return this.replace(/^\s+|\s+$/g, '');
    }
}
var BaseAction = {

    execute: function () { throw ("execute is not implemented"); }
}

var EventAction = CTrulesImplementationUtils.create(BaseAction);

EventAction.execute = function (eventAction) {

    var params = eventAction.params || eventAction.parameters; //compatability
    var eventName = params.name || params.eventName; //compatability
    ctlogger.log("create event action: ", eventName);
    return ClickTaleEvent(eventName);

}
var ct_tag = EventAction; //compatability

var abstractListener = {
    constructor: function () {

        if (!this._registered) {
            RuleManager.registerListener(this);
            this._registered = true;
        }

    },
    startListen: function () { throw ("method not implemented"); },
    registerRule: function () { throw ("method not implemented"); },

}


var clickListener = CTrulesImplementationUtils.create(abstractListener);

clickListener.startListen = function () {

    if (!CTrulesImplementationUtils.isEmptyObject(clickListener._rulesList)) {
        if (window.addEventListener) {
            document.addEventListener("mousedown", function (e) { clickListener._onMouseDown(e); }, false);
            document.addEventListener("mouseup", function (e) { clickListener._onMouseUp(e); }, false);
        } else {
            document.attachEvent("onmousedown", function (e) { clickListener._onMouseDown(e); });
            document.attachEvent("onmouseup", function (e) { clickListener._onMouseUp(e); }, false);
        }

    }
};
clickListener.registerRule = function(rule) {

	abstractListener.constructor.call(this);


	if (!rule.Trigger.hasOwnProperty("elements")) {
		//compatability mode.
		clickListener.bindElementRule(rule, rule.Trigger.elementSelection);
	} else {
		for (var i = 0; i < rule.Trigger.elements.length; i++) {
			clickListener.bindElementRule(rule, rule.Trigger.elements[i]);
		}
	}
}

clickListener.bindElementRule = function (rule, elementAddressingPath) {

    var selectedElementStr = JSON.stringify(elementAddressingPath);

    ctlogger.log("EA path: " + selectedElementStr);

    var obj = ct.ElementAddressing.elementFromPath(elementAddressingPath, document.body, true);

    if (ctlogger.isDebug() && obj && obj.outerHTML) {
        ctlogger.log("Dom element is: ", obj.outerHTML);
    }
    if (clickListener._rulesList == null) {
        clickListener._rulesList = [];
    }

    if (typeof (clickListener._rulesList[selectedElementStr]) == "object") {

        clickListener._rulesList[selectedElementStr].rules.push(rule);
    } else {

        clickListener._rulesList[selectedElementStr] = { selectedElement: obj, rules: [rule] };
    }

    clickListener._attachRulesToElement(obj, rule);


};

clickListener._rulesList = null;
clickListener._currentMouseDownElement = null;

clickListener._onMouseDown = function (e) {

    clickListener._currentMouseDownElement = e.target || e.srcElement;

};
clickListener._onMouseUp = function (e) {

    var startTime = null;

    try {

        var domElement = e.target || e.srcElement;

        ctlogger.log("detected mouse up on: " + domElement.outerHTML);

        if (domElement == clickListener._currentMouseDownElement) {

            startTime = new Date();
            while (domElement != null) {

                clickListener._setElementRules(domElement);

                for (var i = 0; i < domElement.ClickTale.CTrules.length; i++) {

                    var rule = domElement.ClickTale.CTrules[i];
                    if (CTrulesImplementationUtils.validateRuleLocation(rule.Location, document.location.href)) {

                        window[rule.Action.actionType].execute(rule.Action);
                    }

                }

                domElement = domElement.parentElement;

            }
        } else {
            ctlogger.log("no mouse down found on: " + domElement);
        }
        
        if (startTime != null) {
            ctlogger.log("Event Processing Time: " + (new Date() - startTime) / 1000 + " sec");
        }


    } catch (e) {
        ctlogger.log("onmouse up " + e);
    }


};
clickListener._attachRulesToElement = function (domElement, ruleObj) {

    if (domElement) {
        if (typeof (domElement.ClickTale) == "undefined" || domElement.ClickTale == null) {
            domElement.ClickTale = {};
        }

        if (typeof (domElement.ClickTale.CTrules) == "undefined" || domElement.ClickTale.CTrules == null) {
            domElement.ClickTale.CTrules = [];
        }

        if (ruleObj != null) {
            domElement.ClickTale.CTrules = domElement.ClickTale.CTrules.concat(ruleObj);
        }

    }
};
clickListener._setElementRules = function (domElement) {

    if (!domElement.ClickTale || !domElement.ClickTale.CTrules) {

        var elementRules = [];
        for (var selectedElementStr in clickListener._rulesList) {
            var selectedDomElement = clickListener._rulesList[selectedElementStr].selectedElement;

            if (selectedDomElement == null) {
                try {
                    selectedDomElement = ct.ElementAddressing.elementFromPath(JSON.parse(selectedElementStr), document.body, true);
                } catch (e) {
                    ctlogger.log("error on finding element onMouseUp  " + e);
                }

            }

            if (selectedDomElement != null && selectedDomElement == domElement) {
                elementRules = elementRules.concat(clickListener._rulesList[selectedElementStr].rules);
            }
        }

        if (elementRules.length == 0) {
            elementRules = null;
        }
        clickListener._attachRulesToElement(domElement, elementRules);

    }

}
var RuleManager = {
    _listeners: [],
    registerListener: function (listener) { RuleManager._listeners.push(listener); },
    engageListeners: function() {

        for (i=0; i< RuleManager._listeners.length; i++) {
            RuleManager._listeners[i].startListen();
        }
        

    },
    dispatchRules: function(rules) {

        ctlogger.log("parsing rules ");


        for (var i = 0; rules.Data && i < rules.Data.length; i++) {
            try {

                if (rules.Data[i].Rule) {

                    ctlogger.log(i + ") parsing: ", rules.Data[i].Rule);
                    var rule = JSON.parse(rules.Data[i].Rule);
                    
                    window[rule.Trigger.event + "Listener"].registerRule(rule);

                }
            } catch (e) {

                ctlogger.log(i + ") rule: cannot be parsed ");

            }

        }


    }

};
/*window.ClickTaleRulesMetaData = [{"Trigger"sss:{"triggerTypes":"UserEvents","event":"click","elementSelection":[{"tagCode":2884,"elementID":"container","index":2},{"tagCode":2884,"elementID":"main","index":0},{"tagCode":2884,"elementID":"mainContent","index":0},{"tagCode":2884,"index":0},{"tagCode":2884,"index":0},{"tagCode":2884,"index":0},{"tagCode":2884,"index":0},{"tagCode":2884,"index":1},{"tagCode":2884,"elementID":"body_0_mcgContainer","index":0},{"tagCode":2884,"elementID":"body_0_rptMCG_sblMCContainer_3","name":"NOV-HP-LP-Alexa-Chung","index":3},{"tagCode":2884,"index":0},{"tagCode":2884,"elementID":"body_0_rptMCG_ctl00_3_rptMC_3_ctl00_0_rptMosaic_0_ctl00_0_imageElement_0","index":0},{"tagCode":873,"index":0}]},"Location":{4444"urlMode":"Equals","url":"http://de.tommy.com/___$ttty?"},"Action":{"actionType":"ct_tag","parameters":{"6666name":"img_w"}}}
];
*/

(function () {// CTrulesImplementation = {
    var ClickTaleRuleImplementationOkToStartOn2 = 0;

    function init () {


        //window['ClickTaleRuleImplementationOkToStartOn2'] = 0;

        function allReady() {
            if (2 == ++ClickTaleRuleImplementationOkToStartOn2) {
                
                interpreterRulesToCode();
            }
        }

        onDomReady(function () {
            allReady();
        });

        if (typeof window['ClickTaleIsRecording'] !== 'undefined' && window['ClickTaleIsRecording']() === true) {
            allReady();
        }
        else {
            var prevClickTaleOnRecording = window['ClickTaleOnRecording'];
            window['ClickTaleOnRecording'] = function () {

                allReady();
                if (typeof prevClickTaleOnRecording !== 'undefined' && typeof prevClickTaleOnRecording == "function") {
                     prevClickTaleOnRecording.apply(this, arguments);
                }
                

            }
        }



    }

    function onDomReady(handler) {

        var called = false;

        function ready() {
            if (called) { return; }

            called = true;
            handler();
        }

        if (document.readyState === "complete" || document.readyState === "interactive") {
            ready();
            return;
        }
        else if (document.addEventListener) { // native event
            document.addEventListener("DOMContentLoaded", ready, false);
        }
        else if (document.attachEvent) { // IE

            try {
                var isFrame = window.frameElement != null;
            } catch (e) { }

            // IE, the document is not inside a frame
            if (document.documentElement.doScroll && !isFrame) {
                function tryScroll() {
                    if (called)
                        return;
                    try {
                        document.documentElement.doScroll("left");
                        ready();
                    } catch (e) {
                        setTimeout(tryScroll, 10);
                    }
                }
                tryScroll();
            }

            // IE, the document is inside a frame
            document.attachEvent("onreadystatechange", function () {
                if (document.readyState === "complete") {
                    ready();
                }
            });
        }

        // Old browsers
        if (window.addEventListener) {
            window.addEventListener('load', ready, false);
        } else if (window.attachEvent) {
            window.attachEvent('onload', ready);
        } else {
            var fn = window.onload; // very old browser, copy old onload
            window.onload = function () { // replace by new onload and call the old one
                fn && fn();
                ready();
            }
        }
    }

    function interpreterRulesToCode() {
        //init - only on windowload
        //CT.DMZ.ElementAddressing.mapElementsOnDomReady(window);

      
        
        try {
            ct.ElementAddressing.bootstrap(window, true);
            if (window.ClickTaleRulesMetaData) {
                //CTrulesImplementationTrigger.init(window.ClickTaleRulesMetaData);
                RuleManager.dispatchRules(window.ClickTaleRulesMetaData);
                RuleManager.engageListeners();
            }
            
        } catch (e) {
            
            ctlogger.log("interpreterRulesToCode: " + e);
        }
    }

   window.CTrulesImplementation= init;

    init();
})();
