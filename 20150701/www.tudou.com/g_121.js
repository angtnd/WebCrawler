/**
 * @modified $Author: hhfu $
 * @version $Rev: d2cc608a8c9790bb5067e05214748bdd0fd1dc68 $
 */
!function($){require.config({enable_ozma:true});if("object"!==typeof JSON)JSON={};!function(){"use strict";function f(e){return e<10?"0"+e:e}if("function"!==typeof Date.prototype.toJSON){Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"===typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,a,n,r,s=gap,o,l=t[e];if(l&&"object"===typeof l&&"function"===typeof l.toJSON)l=l.toJSON(e);if("function"===typeof rep)l=rep.call(t,e,l);switch(typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";gap+=indent;o=[];if("[object Array]"===Object.prototype.toString.apply(l)){r=l.length;for(i=0;i<r;i+=1)o[i]=str(i,l)||"null";n=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]";gap=s;return n}if(rep&&"object"===typeof rep){r=rep.length;for(i=0;i<r;i+=1)if("string"===typeof rep[i]){a=rep[i];n=str(a,l);if(n)o.push(quote(a)+(gap?": ":":")+n)}}else for(a in l)if(Object.prototype.hasOwnProperty.call(l,a)){n=str(a,l);if(n)o.push(quote(a)+(gap?": ":":")+n)}n=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}";gap=s;return n}}if("function"!==typeof JSON.stringify)JSON.stringify=function(e,t,i){var a;gap="";indent="";if("number"===typeof i)for(a=0;a<i;a+=1)indent+=" ";else if("string"===typeof i)indent=i;rep=t;if(t&&"function"!==typeof t&&("object"!==typeof t||"number"!==typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})};if("function"!==typeof JSON.parse)JSON.parse=function(text,reviver){var j;function walk(e,t){var i,a,n=e[t];if(n&&"object"===typeof n)for(i in n)if(Object.prototype.hasOwnProperty.call(n,i)){a=walk(n,i);if(void 0!==a)n[i]=a;else delete n[i]}return reviver.call(e,t,n)}text=String(text);cx.lastIndex=0;if(cx.test(text))text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return"function"===typeof reviver?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}();define("lib/json2",JSON);define("tui/random",[],function(e,t){function i(){var e=4022871197;var t=function(t){t=t.toString();for(var i=0;i<t.length;i++){e+=t.charCodeAt(i);var a=.02519603282416938*e;e=a>>>0;a-=e;a*=e;e=a>>>0;a-=e;e+=4294967296*a}return 2.3283064365386963e-10*(e>>>0)};t.version="Mash 0.9";return t}function a(){return function(e){var t=4294967087;var a=4294944443;var n=12345,r=12345,s=123,o=12345,l=12345,c=123;if(0===e.length)e=[+new Date];var u=i();for(var d=0;d<e.length;d++){n+=4294967296*u(e[d]);r+=4294967296*u(e[d]);s+=4294967296*u(e[d]);o+=4294967296*u(e[d]);l+=4294967296*u(e[d]);c+=4294967296*u(e[d])}n%=t;r%=t;s%=t;o%=a;l%=a;c%=a;u=null;var f=function(){var e=4294967087;var t=4294944443;var i=1403580;var a=810728;var u=527612;var d=1370589;var f,h,m;h=i*r-a*n;f=0|h/e;h-=f*e;if(h<0)h+=e;n=r;r=s;s=h;m=u*c-d*o;f=0|m/t;m-=f*t;if(m<0)m+=t;o=l;l=c;c=m;if(h<=m)return h-m+e;else return h-m};var h=function(){return 2.3283064365386963e-10*f()};h.uint32=f;h.fract53=function(){return h()+1.1102230246251565e-16*(2097151&f())};h.version="MRG32k3a 0.9";h.args=e;return h}(Array.prototype.slice.call(arguments))}function n(e,t){t="undefined"==typeof t?"":t;var i=new a(e||0,location.href,Date.now());return t+(+new Date).toString(32)+parseInt(1e5*i()).toString(32)}t.rand=n});define("tui/class",[],function(){function e(){return function(){if(this.initialize)this.initialize.apply(this,arguments)}}function t(t,i){var a=this;var n=e();$.extend(n,a,i);var r=Object.create(a.prototype);r.constructor=n;n.prototype=r;$.extend(n.prototype,t);n.superClass=a.prototype;return n}var i=function(i){var a=e();$.extend(a.prototype,i);a.extend=t;return a};i.extend=t;return i});define("tui/event",["tui/class"],function(e){var t=e({initialize:function(){this.__event=window.Zepto?new window.Zepto.Events:$({})}});var i=t.prototype;["bind","one"].forEach(function(e){i[e]=function(t,i,a){if($.isPlainObject(t))for(var n in t)this[e](n,t[n]);else{var r=this.__event;var s=function(){return i.apply(a||r,arguments.length>0?window.Zepto?arguments:Array.prototype.slice.call(arguments,1):[])};r[e].call(r,t,s);i.guid=s.guid}return this}});["unbind","trigger","triggerHandler"].forEach(function(e){i[e]=function(){var t=this.__event;if(require.debug)console.log("[event] "+this.constructor.__mid+" : "+arguments[0],arguments[1]);var i=t[e].apply(t,arguments);if(require.debug&&i!=t&&void 0!=i)console.log(i);return i}});i.fire=i.trigger;i.firing=i.triggerHandler;t.mix=function(e){return $.extend(e,new t)};return t});define("tui/cookie",[],function(){return function(e,t,i,a){if("string"==typeof e){a=i;i=t;t=e;e=window}if(void 0!==i){a=a||{};var n,r="";if(a.expires){if(a.expires.constructor==Date)n=a.expires;else{n=new Date;n.setTime(n.getTime()+1e3*60*60*24*a.expires)}r="; expires="+n.toGMTString()}var s=a.path?"; path="+a.path:"";var o=a.domain?"; domain="+a.domain:"";var l=a.secure?"; secure":"";e.document.cookie=[t,"=",encodeURIComponent(i),r,s,o,l].join("")}else{i=e.document.cookie.match(new RegExp("(?:\\s|^)"+t+"\\=([^;]*)"));return i?decodeURIComponent(i[1]):null}}});define("module/stat/common",["tui/cookie","tui/event","tui/random"],function(e,t,i,a,n){var r={UL:1,OL:2,LI:3,INPUT:4,DIV:5,BODY:6,STRONG:7,SPAN:8,FORM:9,BUTTON:10,CAPTION:11,FIELDSET:12,COLGROUP:13,TFOOT:14,LABEL:15,LEGEND:16,THEAD:17,OPTGROUP:18,OPTION:19,SELECT:20,TABLE:21,TBODY:22,IFRAME:0,SCRIPT:0,OBJECT:0,EMBED:0,IMG:0};function s(){return i.rand(e("u_id"))}function o(){var t=e("juid");if(!t){t=i.rand(e("u_id"),"0");e("juid",t,{expires:365*100,domain:"tudou.com",path:"/"});t=e("juid")||1}window.juidStr=t;return t}function l(){var t=e("seid");if(!t||+new Date>(parseInt(e("seidtimeout"))||0)){t=i.rand(e("u_id"),"0");e("seid",t,{domain:"tudou.com",path:"/"});t=e("seid")||1}var a=e("referhost");if(!a||+new Date>(parseInt(e("seidtimeout"))||0)){var n=/^https?:\/\/[^\/]+/.exec(document.referrer||"");a=n?n[0]:"";e("referhost",a,{domain:"tudou.com",path:"/"})}e("seidtimeout",Date.now()+30*6e4,{domain:"tudou.com",path:"/"});return t}function c(e){e=$(e)[0];var t=[];if(e.id)return"#"+e.id;for(;e;e=e.parentNode){var i=e.nodeName.toUpperCase();if("BODY"==i)break;if(e.id&&"i"!=e.getAttribute("cs")){t.splice(0,0,"#"+e.id);return t.join("~")}var a=0;for(var n=e.previousSibling;n;n=n.previousSibling){var s=n.nodeName.toUpperCase();if(0===r[s])continue;if(s==i)++a}i=r[i]||i;var o=a?"!"+(a+1):"";t.splice(0,0,i+o)}return t.length?t.join("~"):null}function u(e){var t=$(e).attr("href")||$(e).attr("data-stat-href");if(!t)return"";if(/^(javascript:|#)/i.test(t))return"";t=$.trim(t);var i=location.href;var a=i.replace(/(https?:\/\/[^\/]+).*/,"$1");var n=a===i?a+"/":i.replace(/[#?].*/,"").replace(/[^\/]*$/,"");return t.replace(/^\.[\.\/]+/g,function(e){var t=(e.match(/\.\.\//g)||[]).length;for(var i=0;i<t;i++)n=n.replace(/[^\/]+\/$/,"");return n}).replace(/&amp;/g,"&").replace(/^\//,a+"/").replace(/^[^\h\/]/,n+"$&")}function d(e){var t={A:1,INPUT:1,BUTTON:1};if("LABEL"==e.nodeName){var i;var a=$(e);var n=a.attr("for");if(n)i=$("input#"+n).get(0);if(!i){var r=a.find("input:first");if(r.length>0)i=r.get(0)}if(i)e=i}if(e.getAttribute&&"ck"==e.getAttribute("data-stat-role"))return e;else{var s=e.parentNode;try{if(s&&s.getAttribute&&"ck"==s.getAttribute("data-stat-role"))return s}catch(o){}}if(!t[e.nodeName]){e=e.parentNode||{};if(!t[e.nodeName])return false}return e}function f(e){if(!e)return e;if(0==e.indexOf("#"))e=e.replace(/\#([^~\s]+)~/,function(e,t){return'//*[@id="'+t+'"]~'});else e="~html~body~"+e;e=e.replace(/\!(\d+)/g,function(e,t){return"["+t+"]"});e=e.replace(/(~?)(\d+)(~|\[)/g,function(e,t,i,a){for(var n in r)if(r[n]==parseInt(i))return t+n+a;return e});e=e.replace(/~/g,"/");return e}function h(e){var t=document.evaluate(e,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);if(t.snapshotLength>0)return t.snapshotItem(0);return null}function m(e){var t=[];$.each(e,function(e,i){if(""!==i)t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))});return t.join("&")}function p(e,i){if(!i)t.mix(e);return $.extend(e,{__callbacks:[],addData:function(e){this.__callbacks.push(e)},getData:function(){var e=this;var t={};var i=arguments;e.__callbacks.forEach(function(a){var n=a.apply(e,i)||{};$.extend(t,n)});return t}})}n.referrer=document.referrer||"";n.updateRefer=function(e){n.referrer=e||location.href};n.getPositionCode=c;n.getTrueLink=u;n.getStatTarget=d;n.getXpathFromPositionCode=f;n.getElementByXPath=h;n.param=m;n.mix=p;n.juid=o;n.seid=l;n.pvid=s});define("module/domain",[],function(e,t){var i={main:"www.tudou.com",passport:"passport.tudou.com",ui:"ui.tudou.com",css:"css.tudouui.com",js:"js.tudouui.com",v:"v.tudou.com",login:"login.tudou.com",xn:"login.tudou.com",search:"www.soku.com/t",imake:"imake.tudou.com",ent:"ent.tudou.com",music:"music.tudou.com",movie:"movie.tudou.com",fun:"fun.tudou.com",cartoon:"cartoon.tudou.com",game:"game.tudou.com",lady:"lady.tudou.com",shop:"shop.tudou.com",sports:"sports.tudou.com",life:"life.tudou.com",edu:"edu.tudou.com",etc:"etc.tudou.com",fashion:"fashion.tudou.com",fortune:"fortune.tudou.com",tv:"tv.tudou.com",zy:"zy.tudou.com",news:"news.tudou.com",jilupian:"jilupian.tudou.com",health:"health.tudou.com",beauty:"beauty.tudou.com",it:"it.tudou.com",auto:"auto.tudou.com",message:"message.tudou.com",hint:"tip.tudou.soku.com/search_keys",minichannel:"www.tudou.com/my/channel",tui:"www.tudou.com/my/tui",playlist:"www.tudou.com/playlist",comment:"www.tudou.com/comments",adextensioncpt:"v2.tudou.com/tdct/commonadv.html",programstat:"istat.tudou.com",commentcode:"rd.tudou.com",tmversion:"tmversion.tudou.com",adextensionurl:"tdct.tudou.com/adcontrol/specialadv.html",dig:"dig.tudou.com",live:"istat.tudou.com",douwan:"douwan.tudou.com",mini:"mini.tudou.com",feedback:"feedback.tudou.com",tjpt:"tdrec.youku.com",cms:"cms.tudou.com",wa:"wa.tudou.com",cps:"cps.tudou.com",pay:"pay.tudou.com",vip:"vip.tudou.com",yun:"yun.tudou.com",hinty:"tip.soku.com/search_yun",hd:"hd.tudou.com",crp:"crp.tudou.com",danmu:"danmu.tudou.com",danmus:"service.danmu.tudou.com",gc:"gc.tudou.com",korea:"korea.tudou.com",activity:"activity.tudou.com",index:"index.tudou.com",zhibo:"live.tudou.com",wanhuo:"wanhuo.tudou.com",img:"u"+~~(4*Math.random()+1)+".tdimg.com"};var a={};function n(e){$.each(e,function(e,t){a[e]=a[e]||"http://"+t})}n(i);t.join=n;t.url=t.domain=a});define("tui/drag",["tui/event"],function(e){var t=$(window);function i(){if(window.getSelection)window.getSelection().removeAllRanges();else if(document.selection)document.selection.empty();return this}function a(e){e.preventDefault()}var n=e.extend({initialize:function(e,r){var s=this;r=r||{};var o=r.handler||e;n.superClass.initialize.call(s);s.limit=r.limit;s.bubble=r.bubble;s.isCustom=r.isCustom;s.enable2=true;s.state2=false;s.hasMove2=false;s.fx=s.fy=-1;s.x2=s.y2=s.mx2=s.my2=s.px2=s.py2=s.cx2=s.cy2=0;s.node2="string"==$.type(e)?$(e):e;s.container2=r.container||s.node2.parent();s.fixed2="fixed"==s.node2.css("position").toLowerCase();s.handler2="string"==$.type(o)?$(o):o;var l=s.handler2||s.node2;function c(e){e.preventDefault();if(!s.bubble||e.target==l[0]){s.start(e);if(l[0].setCapture)l[0].setCapture()}}l.bind("mousedown",c);function u(e){if(s.state2){s.state2=false;var i=e.pageX-s.mx2+s.x2-s.px2,n=e.pageY-s.my2+s.y2-s.py2;if(s.fixed2){i-=t.scrollLeft();n-=t.scrollTop()}if(s.limit){i=Math.max(i,s.cx2-s.px2);n=Math.max(n,s.cy2-s.py2);i=Math.min(i,s.cWidth-(s.px2-s.cx2)-s.dWidth);n=Math.min(n,s.cHeight-(s.py2-s.cy2)-s.dHeight)}s.x2=s.node2.offset().left;s.y2=s.node2.offset().top;s.trigger("drag:end",[i,n,e.pageX,e.pageY,s.node2,s.container2])}$(document).unbind("selectstart",a);if(l[0].releaseCapture)l[0].releaseCapture()}$(document).bind("mouseup",u);function d(e){if(s.state2&&s.enable2){if(!s.hasMove()&&e.pageX==s.fx&&e.pageY==s.fy);else s.hasMove2=true;var a=e.pageX-s.mx2+s.x2-s.px2,n=e.pageY-s.my2+s.y2-s.py2;if(s.fixed2){a-=t.scrollLeft();n-=t.scrollTop()}if(s.limit){a=Math.max(a,s.cx2-s.px2);n=Math.max(n,s.cy2-s.py2);a=Math.min(a,s.cWidth-(s.px2-s.cx2)-s.dWidth);n=Math.min(n,s.cHeight-(s.py2-s.cy2)-s.dHeight)}if(!s.isCustom)s.node2.css({left:a,top:n});i();s.trigger("drag:move",[a,n,e.pageX,e.pageY,s.node2,s.container2])}}$(document).bind("mousemove",d);s.cancel=function(){l.unbind("mousedown",c);$(document).unbind("mouseup",u);$(document).unbind("mousemove",d)}},start:function(e){var t=this;$(document).bind("selectstart",a);t.offsetParent2=t.node2.offsetParent();if(t.limit){t.cWidth=t.container2.outerWidth();t.cHeight=t.container2.outerHeight();t.pWidth=t.offsetParent2.outerWidth();t.pHeight=t.offsetParent2.outerHeight();t.dWidth=t.node2.outerWidth();t.dHeight=t.node2.outerHeight()}t.fx=e.pageX;t.fy=e.pageY;t.cx2=t.container2.offset().left;t.cy2=t.container2.offset().top;t.px2=t.offsetParent2.offset().left;t.py2=t.offsetParent2.offset().top;t.x2=t.node2.offset().left;t.y2=t.node2.offset().top;t.mx2=e.pageX;t.my2=e.pageY;t.state2=true;t.trigger("drag:start",[t.x2,t.y2,e.pageX,e.pageY,t.node2,t.container2]);return this},enable:function(){this.enable2=true;return this},disable:function(){this.enable2=false;return this},state:function(){return this.state2},hasMove:function(){return this.hasMove2}});return n});define("tui/template",[],function(e,t){t.ns=function(e,t,i){var a,n=i||window,r=e.split(".").reverse();while((a=r.pop())&&r.length>0){if("undefined"===typeof n[a])n[a]={};else if("object"!==typeof n[a])return false;n=n[a]}if("undefined"!==typeof t)n[a]=t;return n[a]};t.format=function(e,t){return e.replace(/<%\=(\w+)%>/g,function(e,i){return null!=t[i]?t[i]:""})};t.escapeHTML=function(e){e=e||"";var t={"<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;","{":"&#123;","}":"&#125;","@":"&#64;"};return e.replace(/[<>'"\{\}@]/g,function(e){return t[e]})};t.substr=function(e,t,i){if(!e||"string"!==typeof e)return"";var a=e.substr(0,t).replace(/([^\x00-\xff])/g,"$1 ").substr(0,t).replace(/([^\x00-\xff])\s/g,"$1");return i?i.call(a,a):e.length>a.length?a+"...":a};t.strsize=function(e){return e.replace(/([^\x00-\xff]|[A-Z])/g,"$1 ").length};var i=this.document;t.tplSettings={_cache:{},evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};t.tplHelpers={mix:$.extend,escapeHTML:t.escapeHTML,substr:t.substr,include:a,_has:function(e){return function(i){return t.ns(i,void 0,e)}}};function a(e,n,r){var s,o=t.tplSettings,l=r?"#"+r:"";if(!/[\t\r\n% ]/.test(e)){s=o._cache[e+l];if(!s){var c=i.getElementById(e);if(c)s=o._cache[e+l]=a(c.innerHTML,false,r)}}else{var u="var __p=[];"+(r?"":"with(obj){")+"var mix=api.mix,escapeHTML=api.escapeHTML,substr=api.substr,include=api.include,has=api._has("+(r||"obj")+");"+"__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(o.interpolate,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(o.evaluate||null,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');"+(r?"":"}")+"return __p.join('');";try{s=new Function(r||"obj","api",u)}catch(d){console.log("Could not create a template function: \n"+u)}}return!s?"":n?s(n,t.tplHelpers):s}t.convertTpl=a;t.reloadTpl=function(e){delete t.tplSettings._cache[e]}});define("tui/widget",["tui/event","tui/template"],function(e,t){function i(e,t){var i;var a;var n=e.split(" ");if(1==n.length){i=t;a=e}else{i=n.shift();a=n.join(" ")}return[i,a]}var a=e.extend({element:null,template:"<div></div>",eventType:"click",model:{},events:{},targetNode:$(document.body),renderMethod:"append",initialize:function(e){var t=this;e=e||{};a.superClass.initialize.call(t);t.model=$.extend(true,{},t.model);t.events=$.extend(true,{},t.events);$.each(["element","targetNode"],function(){"undefined"!==typeof e[this]&&(t[this]=$(e[this]))});$.each(["template","eventType","renderMethod"],function(){"undefined"!==typeof e[this]&&(t[this]=e[this])});$.each(["model","events"],function(){"undefined"!==typeof e[this]&&$.extend(t[this],e[this])})},find:function(e){return this.element.find(e)},delegate:function(e,t){var a=this;if("string"==$.type(e)&&$.isFunction(t)){var n={};n[e]=t;e=n}$.each(e,function(e,t){var n=function(e){if($.isFunction(t))return t.call(a,e);else return a[t](e)};var r=i(e,a.eventType);a.element.on(r[0],r[1],n)});return a},undelegate:function(e){var t=this;var a=i(e,t.eventType);t.element.off(a[0],a[1]);return t},render:function(e){var i=this;if(!i.element||!i.element[0])i.element=$(t.convertTpl(i.template,$.extend({getUrl:this.getUrl||n},e||i.model)));i.delegate(i.events);if(i.renderMethod)i.targetNode[i.renderMethod](i.element);return i},update:function(e){if(this.renderMethod)this.targetNode[this.renderMethod](t.convertTpl(this.template,$.extend({getUrl:this.getUrl||n},e)))}});function n(e){return e}return a});define("tui/mask",[],function(){var e=$('<div class="tui_mask">');var t;var i=$(window);var a=$(document);var n=$(document.body);var r=$.browser.msie&&$.browser.version<7;var s=4096;function o(){var t=Math.max(i.width(),a.width());var n=Math.max(i.height(),a.height());var o="absolute";var l=0;if($.browser.msie&&n>s){if(!r)o="fixed";else{l=i.scrollTop();if(l+s>n)l=n-s}n=s}e.css({position:o,top:l,width:t,height:n})}return{node:function(){return e},resize:function(){o()},show:function(a){i.bind("resize",o);if(r)i.bind("scroll",o);e.css("z-index",a||9e4);this.resize();if(!t){n.append(e);t=true}else e.show();return this},hide:function(a){i.unbind("resize",o);if(r)i.unbind("scroll",o);if(a){e.remove();t=false}else e.hide();return this},update:function(){o()},state:function(){return e.is(":visible")}}});define("tui/art",[],function(){var e=window;var t=function(e,i){return t["string"===typeof i?"compile":"render"].apply(t,arguments)};t.version="2.0.2";t.openTag="<%";t.closeTag="%>";t.isEscape=true;t.isCompress=false;t.parser=null;t.render=function(e,i){var a=t.get(e)||n({id:e,name:"Render Error",message:"No Template"});return a(i)};t.compile=function(e,a){var s=arguments;var o=s[2];var l="anonymous";if("string"!==typeof a){o=s[1];a=s[0];e=l}try{var c=r(e,a,o)}catch(u){u.id=e||a;u.name="Syntax Error";return n(u)}function d(i){try{return new c(i,e)+""}catch(r){if(!o)return t.compile(e,a,true)(i);return n(r)()}}d.prototype=c.prototype;d.toString=function(){return c.toString()};if(e!==l)i[e]=d;return d};var i=t.cache={};var a=t.helpers=function(){var e=function(t,i){if("string"!==typeof t){i=typeof t;if("number"===i)t+="";else if("function"===i)t=e(t.call(t));else t=""}return t};var i={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"};var a=function(t){return e(t).replace(/&(?![\w#]+;|#\d+)|[<>"']/g,function(e){return i[e]})};var n=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)};var r=function(e,t){if(n(e))for(var i=0,a=e.length;i<a;i++)t.call(e,e[i],i,e);else for(i in e)t.call(e,e[i],i)};return{$include:t.render,$string:e,$escape:a,$each:r}}();t.helper=function(e,t){a[e]=t};t.onerror=function(t){var i="Template Error\n\n";for(var a in t)i+="<"+a+">\n"+t[a]+"\n\n";if(e.console)console.error(i)};t.get=function(a){var n;if(i.hasOwnProperty(a))n=i[a];else if("document"in e){var r=document.getElementById(a);if(r){var s=r.value||r.innerHTML;n=t.compile(a,s.replace(/^\s*|\s*$/g,""))}}return n};var n=function(e){t.onerror(e);return function(){return"{Template Error}"}};var r=function(){var e=a.$each;var i="break,case,catch,continue,debugger,default,delete,do,else,false"+",finally,for,function,if,in,instanceof,new,null,return,switch,this"+",throw,true,try,typeof,var,void,while,with"+",abstract,boolean,byte,char,class,const,double,enum,export,extends"+",final,float,goto,implements,import,int,interface,long,native"+",package,private,protected,public,short,static,super,synchronized"+",throws,transient,volatile"+",arguments,let,yield"+",undefined";var n=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g;var r=/[^\w$]+/g;var s=new RegExp(["\\b"+i.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g");var o=/^\d[^,]*|,\d[^,]*/g;var l=/^,+|,+$/g;var c=function(e){return e.replace(n,"").replace(r,",").replace(s,"").replace(o,"").replace(l,"").split(/^$|,+/)};return function(i,n,r){var s=t.openTag;var o=t.closeTag;var l=t.parser;var u=n;var d="";var f=1;var h={$data:1,$id:1,$helpers:1,$out:1,$line:1};var m={};var p="var $helpers=this,"+(r?"$line=0,":"");var g="".trim;var v=g?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"];var b=g?"if(content!==undefined){$out+=content;return content;}":"$out.push(content);";var w="function(content){"+b+"}";var _="function(id,data){"+"data=data||$data;"+"var content=$helpers.$include(id,data,$id);"+b+"}";e(u.split(s),function(e,t){e=e.split(o);var i=e[0];var a=e[1];if(1===e.length)d+=x(i);else{d+=$(i);if(a)d+=x(a)}});u=d;if(r)u="try{"+u+"}catch(e){"+"throw {"+"id:$id,"+"name:'Render Error',"+"message:e.message,"+"line:$line,"+"source:"+C(n)+".split(/\\n/)[$line-1].replace(/^[\\s\\t]+/,'')"+"};"+"}";u=p+v[0]+u+"return new String("+v[3]+");";try{var y=new Function("$data","$id",u);y.prototype=m;return y}catch(k){k.temp="function anonymous($data,$id) {"+u+"}";throw k}function x(e){f+=e.split(/\n/).length-1;if(t.isCompress)e=e.replace(/[\n\r\t\s]+/g," ").replace(/<!--.*?-->/g,"");if(e)e=v[1]+C(e)+v[2]+"\n";return e}function $(e){var i=f;if(l)e=l(e);else if(r)e=e.replace(/\n/g,function(){f++;return"$line="+f+";"});if(0===e.indexOf("=")){var n=0!==e.indexOf("==");e=e.replace(/^=*|[\s;]*$/g,"");if(n&&t.isEscape){var s=e.replace(/\s*\([^\)]+\)/,"");if(!a.hasOwnProperty(s)&&!/^(include|print)$/.test(s))e="$escape("+e+")"}else e="$string("+e+")";e=v[1]+e+v[2]}if(r)e="$line="+i+";"+e;S(e);return e+"\n"}function S(t){t=c(t);e(t,function(e){if(!h.hasOwnProperty(e)){T(e);h[e]=true}})}function T(e){var t;if("print"===e)t=w;else if("include"===e){m["$include"]=a["$include"];t=_}else{t="$data."+e;if(a.hasOwnProperty(e)){m[e]=a[e];if(0===e.indexOf("$"))t="$helpers."+e;else t=t+"===undefined?$helpers."+e+":"+t}}p+=e+"="+t+","}function C(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}}}();return t});define("tui/browser",[],function(){var e=navigator.userAgent.toLowerCase();var t={ie6:$.browser.msie&&6==$.browser.version,html5:function(){var e=document.createElement("input");var t=document.createElement("video");return{h264:!!(t.canPlayType&&t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,"")),history:!!(window.history&&window.history.pushState&&window.history.popState),placeholder:"placeholder"in e}},lang:(navigator.language||navigator.systemLanguage).toLowerCase(),iOS:(e.match(/(ipad|iphone|ipod)/)||[])[0],iOSVersion:(e.match(/os\s+([\d_]+)\s+like\s+mac\s+os/)||[0,"0_0_0"])[1].split("_"),wphone:parseFloat((e.match(/windows\sphone\s(?:os\s)?([\d.]+)/)||["","0"])[1]),android:parseFloat((e.match(/android[\s|\/]([\d.]+)/)||["","0"])[1])};t.isMobile=!!t.iOS||!!t.wphone||!!t.android||void 0!==window.orientation||false;t.isPad=t.isMobile&&("ipad"==t.iOS||e.indexOf("mobile")==-1||e.indexOf("windows nt")!=-1&&e.indexOf("touch")!=-1)||false;return t});define("tui/dialog",["tui/browser","tui/art","tui/mask","tui/widget","tui/drag"],function(e,t,i,a,n){var r=$(window);var s=$.browser.msie&&$.browser.version<=7||!$.support.boxModel;var o=10002;var l='<div class="tui_dialog_button"><% for (var i = 0; i < buttons.length; i++) { %>'+'<a data-role="button_<%=i%>" href="#" <%if(buttons[i].className){%>class="<%=buttons[i].className%>"<%}%>><%=buttons[i].name%></a>'+"<% } %></div>";var c='<div class="tui_dialog <%=className%>"><div<% if (hasWrap) { %> class="tui_dialog_wrap"<% } %>><div class="tui_dialog_holder" data-role="holder">'+'<div class="tui_dialog_resize"></div>'+'<div class="tui_dialog_w_tp"></div><div class="tui_dialog_w_bm"></div>'+'<div class="tui_dialog_w_lf"></div><div class="tui_dialog_w_rt"></div>'+'<div class="tui_dialog_w_tl"></div><div class="tui_dialog_w_tr"></div>'+'<div class="tui_dialog_w_bl"></div><div class="tui_dialog_w_br"></div>'+'<div class="tui_dialog_header" data-role="header"><span class="tui_dialog_close" data-role="close" title="å³é­">å³é­</span>'+'<div class="tui_dialog_title" data-role="title"><%=title%></div><div class="tui_dialog_bar"><%=bar%></div></div>'+'<div class="tui_dialog_content" data-role="content"></div>'+'<% if (buttons.length > 0) { %><div class="tui_dialog_footer" data-role="footer">'+l+"</div><% } %>"+'<% if (info) { %><div class="tui_dialog_info"><%=info%></div><% } %>'+"</div></div></div>";var u=a.extend({events:{"click [data-role=close]":function(e){e.preventDefault();this.close()}},initialize:function(e){var i=this;var a={template:c,buttons:[],zIndex:o,hasDrag:true,hasMask:true,isFixed:true};e=$.extend(a,e||{});o=e.zIndex;var n=$.browser.msie&&parseFloat($.browser.version)<9;if("undefined"!=typeof e.hasWrap)n=e.hasWrap;var r={hasWrap:n,className:e.className||"tudou_dialog",title:e.title||"",bar:e.bar||"",info:e.info||"",buttons:e.buttons};e.element=$(t.compile(e.template)(r));u.superClass.initialize.call(this,e);i.dom={holder:i.element.find("[data-role=holder]"),header:i.element.find("[data-role=header]"),title:i.element.find("[data-role=title]"),content:i.element.find("[data-role=content]"),footer:i.element.find("[data-role=footer]"),close:i.element.find("[data-role=close]")};i.config=e;i.open();var s=function(e){if(27==e.keyCode){i.close();$(document).unbind("keydown",s)}};$(document).keydown(s)},title:function(e){this.dom.title.html(e);return this},content:function(e){this.dom.content.html(e);return this},open:function(){var e=this;var t=e.config;var a=e.element;var l=e.dom;a.css("z-index",o);o+=2;if(t.hasMask)i.show(a.css("z-index")-1);a.css("position",s||!t.isFixed?"absolute":"fixed");e.iframeMask=$("<iframe>",{src:"about:blank",frameborder:0,css:{border:"none","z-index":-1,position:"absolute",top:0,left:0,width:"100%",height:"100%"}}).prependTo(l.holder);e.content(t.content||"");$.each(t.buttons,function(t){e.events["[data-role=button_"+t+"]"]=this.callback});if(!e.element.parent()[0])e.render();e.element.show();e.locate();e.resizeLocate=function(t){e.locate()};r.bind("resize",e.resizeLocate);if(s&&t.isFixed){e.iefixScroll=function(t){e.locate()};r.bind("scroll",e.iefixScroll);e.iframeMask.css({height:l.holder.height()})}if(e.config.hasDrag)new n(a,{handler:l.header,limit:true});return e},close:function(e){var t=this;if(t.config.hasMask)i.hide(true);t.trigger("close",[t]);if(!e)t.element.find("iframe").remove();t.element[e?"hide":"remove"]();if(t.resizeLocate)r.unbind("resize",t.resizeLocate);if(t.iefixScroll){r.unbind("scroll",t.iefixScroll);t.iefixScroll=null}return t},locate:function(){var e=this;var t=Math.max(0,r.width()-e.element.width()>>1);if(!e.config.isFixed)var i=r.scrollTop()+(r.height()-e.element.height())/2;else var i=Math.max(0,r.height()-e.element.height()>>1)+(s?r.scrollTop():0);e.element.css({left:t,top:i});return e}});u.confirm=function(e,t){var i={};if($.isPlainObject(e)){i=e;e=i.msg;t=i.callback}return new u($.extend({className:"tudou_dialog alert",title:"åè±æç¤º",content:'<div class="tui_dialog_logo"></div><div class="tui_dialog_text">'+e+"</div>",hasMask:true,buttons:[{name:"ç¡®å®",callback:function(e){e.preventDefault();t&&t.call(this);this.close()}},{name:"åæ¶",callback:function(e){e.preventDefault();this.close()}}]},i))};u.alert=function(e,t){var i={};if($.isPlainObject(e)){i=e;e=i.msg;t=i.callback}return new u($.extend({className:"tudou_dialog alert",title:"åè±æç¤º",content:'<div class="tui_dialog_logo"></div><div class="tui_dialog_text">'+e+"</div>",hasMask:true,buttons:[{name:"ç¡®å®",callback:function(e){e.preventDefault();t&&t.call(this);this.close()}}]},i))};return u});define("tui/net",[],function(e,t){t.getScript=function(e,t){var i=document.createElement("script");i.type="text/javascript";i.async=true;if(!t)t={};else if($.isFunction(t))t={callback:t};if(t.charset)i.charset=t.charset;i.src=e;var a=document.getElementsByTagName("head")[0];var n=false;i.onload=i.onreadystatechange=function(){if(!n&&(!this.readyState||"loaded"==this.readyState||"complete"==this.readyState)){n=true;i.onload=i.onreadystatechange=null;a.removeChild(i);if(t.callback)t.callback()}};a.appendChild(i)};var i=0;t.getJSON=function(e,a,n,r){var s=e.match(/https?\:\/\/(.+?)\//);if(n)if((!r||!r.isScript)&&(!s||s[1]===window.location.host)){$.ajax({url:e,data:a,success:n,dataType:"json"});return true}r=$.extend({charset:"gbk",callback:"tuijsonp"+ ++i},r||{});if(r.random)a[r.random]=+new Date;var o=r.callbackName||"jsoncallback";a[o]=r.callback;e=[e,/\?/.test(e)?"&":"?",$.param(a)].join("");if(n)window[r.callback]=n;delete r.callback;t.getScript(e,r)};t.getRequest=function(e,t){var i=new Image;i.onload=function(){};i.src=!t?e:[e,e.match(/\?/)?"&":"?","string"==typeof t?t:$.param(t)].join("")}});define("module/login/login",["tui/cookie","tui/event","tui/net","tui/dialog","module/domain"],function(e,t,i,a,n,r,s){var o=new t;var l=n.url;window.hasAutoLogin=window.hasAutoLogin;window.loginCallback=window.loginCallback||[];window.loginData=window.loginData;o.juid="";o.DWriteCookie=function(e,t){var i;if("string"==$.type(e))i=e;else{i=e.yktk;i=i+"|"+(e.isRemember?1:0)}if(i&&""!=i){var a="http://passport.tudou.com/user/crossdomain?yktk="+encodeURIComponent(i);var n=l.login+"/login.do?act=loginOver";if(t){var r="login"+(""+Math.random()).replace(/\D/g,"")+(new Date).getTime();window[r]=function(){t&&t();s.remove();window[r]=null};n+="&callback="+r}a+="&return_url="+encodeURIComponent(n);var s=$('<iframe src="'+a+'" style="position:absolute;left:-9999px;bottom:0;width:0;height:0;visibility:hidden;">');$(document.body).append(s)}};o.autoLogin=function(e,t){var i=this;e=e||{};t=t||function(){};var a=l.login;var n="www";var r=location.hostname.split(".");if(["wwwtest","logintest"].indexOf(r[0])>-1)n="wwwtest";a={www:"http://login.tudou.com",wwwtest:"http://logintest.tudou.com"}[n];$.ajax({url:a+"/login.do?act=ytAutoLogin&useYktk=true",type:"GET",jsonp:"jsoncallback",dataType:"jsonp",success:function(a){var n=1==a.status?true:false;t(n,a);if(n&&a.data)o.DWriteCookie({isRemember:e.isRemember,yktk:a.data.yktk},function(){if(n){i.trigger("after:login");i.trigger("after:autoLogin")}})},error:function(){t(false)}})};o.isLogin=function(t){var i=this;t=t||function(){};if(e("u_user")&&e("u_id")){if(e("u_login"))t(true);else if(e("u_passport_info"))window.loginCallback&&loginCallback.push(t);else return false;return true}return false};o.isLogin2=function(t){var i=this;var a=0;var n=0;var r=e("yktk");t=t||function(){};if(e("u_user")&&e("u_id")){if(e("u_login")){t(true);return}else if(e("u_passport_info"))a=1;else if(r)a=2}else if(r)a=2;if(r)n="|1"==r.slice(-2,r.length)?1:0;if(a){window.loginCallback&&loginCallback.push(t);if(!hasAutoLogin){hasAutoLogin=true;i.autoLogin({isRemember:n},function(e,t){t=t||{};loginData=e?t:e;if(window.loginCallback&&loginCallback.length){loginCallback.forEach(function(t){t(e,loginData)});window.loginCallback=[]}})}else if(void 0!==loginData)"boolean"==$.type(loginData)?t(loginData):t(1==loginData.status?true:false,loginData)
}else t(false)};o.uid=function(){return this.isLogin()?e("u_id")||0:0};o.ucode=function(){return this.isLogin()?e("u_code")||"":""};o.userInfo=function(){var t=this.uid();var i={};i._vip=e("u_member")||0;i._usr=e("u_user");i._nic=e("u_nick")||i._usr;i._ico=e("u_pic")||"";i.isGuest=!!t;i.isXN=t.toString()===(e("xn")||"").split("_")[0];i.isSINA=!!e("sinawb");i.isQZONE=!!e("qzone");i.isMSN=!!e("msn");i.isTWEIBO=!!e("tweibo");i.isKAIXIN=!!e("kaixin");i.isFEIXIN=!!e("feixin");i.isYOUKU=!!e("youku");i.ulvl=(t?e("u_l"):0)||0;i.prefix=i.isXN&&"xn"||i.isSINA&&"sina"||i.isQZONE&&"qzone"||i.isMSN&&"msn"||i.isTWEIBO&&"tweibo"||i.isYOUKU&&"youku"||i.isKAIXIN&&"kaixin"||i.isFEIXIN&&"feixin"||"";return i};var c="login"+(""+Math.random()).replace(/\D/g,"")+(new Date).getTime();o.needLogin=function(e,t){var i=this;e=e||{};if("function"==$.type(e)){t=e;e={}}i.isLogin2(function(n){if(n)t&&t();else{window[c]=function(e){if(!e){s.close();window["setupLoginDialog"]=null;window["closeLoginDialog"]=null}t&&t();i.trigger("after:login");i.trigger("after:miniLogin");window[c]=null};window["setupLoginDialog"]=function(e){var t={};var i=s.element.find(".tui_dialog_holder, iframe");if(e.height)t.height=e.height;if(e.width)t.width=e.width;i.css(t);s.locate()};window["closeLoginDialog"]=function(){s.close()};var r={mini:"ok",callback:c};if(e.isReg)r.isReg=true;if(e.title)r.title=encodeURIComponent(e.title);if(e.email)r.email=e.email;var s=new a({className:"tudou_dialog login_dialog "+(r.isReg?"reg_dialog":"log_dialog"),title:"ç»å½",content:'<iframe scrolling="no" frameborder="0" width="100%" height="100%" src="'+l.login+"/login.do?"+$.param(r)+'"></iframe>',hasDrag:false});i.fire("login:open",[r]);s.bind("close",function(e){i.trigger("login:close",[r])})}});return i};o.isVip=function(){return e("u_member")};return o});define("tui/storage",["tui/class"],function(e){var t=e({initialize:function(e){var t=this;if(e){t.iframe1=$('<iframe src="'+e+'" style="position:absolute;left:-9999px;bottom:0;width:0;height:0;visibility:hidden;">');var a=/https?:\/\/[^\/]+/.exec(e);t.origin=a?a[0]:""}else{t.storage=i(window);t.loaded1=true;return}t.gcbs1=[];t.scbs1=[];t.rcbs1=[];t.loaded1=!!t.storage;if(t.iframe1.on)t.iframe1.on("load",n);else t.iframe1.bind("load",n);function n(){t.storage=i(this.contentWindow,t.origin);t.loaded1=true;t.gcbs1.forEach(function(e){t.getItem(e.k,e.cb)});t.scbs1.forEach(function(e){t.setItem(e.k,e.v,e.cb)});t.rcbs1.forEach(function(e){t.removeItem(e.k,e.cb)});t.gcbs1=[];t.scbs1=[];t.rcbs1=[]}$(document.body).append(this.iframe1)},getItem:function(e,t){if(this.loaded1)this.storage.getItem(e,t);else this.gcbs1.push({k:e,cb:t});return this},setItem:function(e,t,i){if($.isPlainObject(t)||$.isArray(t))t=JSON.stringify(t);if(this.loaded1)this.storage.setItem(e,t,i);else this.scbs1.push({k:e,v:t,cb:i});return this},removeItem:function(e,t){if(this.loaded1)this.storage.removeItem(e,t);else this.rcbs1.push({k:e,cb:t});return this}});function i(e,t){var i=parseInt($.browser.version);if(e!==window&&$.browser.mozilla&&(i>=13&&i<=14||i>=30))return a(e,t);else if(e.localStorage)return n(e);else if(e.ActiveXObject)return r(e);else throw new Error("Local storage not exist.")}function a(e,t){window.addEventListener("message",function(e){var t=JSON.parse(e.data);i[t.id](t.val);delete i[t.id]},false);var i={},a=0,n={};n.setItem=function(n,r,s){i[a]=s||function(){};e.postMessage(JSON.stringify({id:a++,key:n,val:r}),t)};n.getItem=function(n,r){i[a]=r||function(){};e.postMessage(JSON.stringify({id:a++,key:n}),t)};n.removeItem=function(n,r){i[a]=r||function(){};e.postMessage(JSON.stringify({id:a++,key:n,val:null}),t)};return n}function n(e){var t={};t.setItem=function(t,i,a){e.localStorage.setItem(t,i);if(a)a()};t.getItem=function(t,i){if(i)i(e.localStorage.getItem(t))};t.removeItem=function(t,i){e.localStorage.removeItem(t);if(i)i()};return t}function r(e){var t={},i=e.document.documentElement;i.addBehavior("#default#userdata");t.setItem=function(e,t,a){try{i.setAttribute("tui",t);i.save(e)}catch(n){throw new Error("[V3] userData behavior error")}if(a)a()};t.getItem=function(e,t){try{i.load(e);if(t)t(i.getAttribute("tui"))}catch(a){return null}};t.removeItem=function(e,t){try{i.load(e);i.expires=new Date(315532799e3).toUTCString();i.save(e);if(t)t()}catch(a){}};return t}return t});define("module/global",["tui/event","tui/cookie","tui/storage","module/stat/common","module/login/login"],function(e,t,i,a,n,r,s){try{document.domain="tudou.com"}catch(o){}var l={};l.juid=a.juid();l.seid=a.seid();l.pvid=a.pvid();l.uid=n.uid();n.bind("after:login",function(){l.uid=n.uid()});n.juid=l.juid;l.storage=new i("http://ui.tudou.com/js/embed/xstorage/storage.html");return l});define("module/stat/stat-info",["tui/cookie","tui/browser","module/global","module/stat/common"],function(e,t,i,a){var n=window;var r=encodeURIComponent;var s=n.config||{};var o=s.item||n.itemData||{};var l=s.pageId||n.pageId||1;var c=navigator.userAgent.toLowerCase();var u=t.iOS;var d=t.iOSVersion;var f=t.android;var h=t.wphone;var m=c.indexOf("micromessenger")>-1;var p={1:96001,2:96002,3:96003,4:96003,5:96003,6:96004,81:96081}[l];var g={1:96311,2:96310,3:96312,4:96312,5:96312,6:96313,81:96381}[l];var v={1:11e3,2:1e4,3:10200,4:10200,5:10200,6:10300}[l];var b={1:31100,2:31e3,3:31200,4:31200,5:31200,6:31300}[l];if(f){p+=1e3;g+=1e3}if(m){p+=2e3;g+=2e3}var w={device:u||f&&(t.isPad?"androidpad":"androidphone")||h&&"wphone"||"others",version:u&&d.join(".")||f||h||0,iOSVersion:d,isMobile:!!u||!!f||false,isRetina:(n.devicePixelRatio||1)<2?false:true,areacode:e("tudouad_citycode")||0,uid:i.uid||0,lid:s.lid||n.lid||0,aid:n.aid||0,sid:s.lid||n.lid||n.aid||0};if(s.lid&&s.pageId>=3&&s.pageId<=5)w.aid=s.lid;var _={icode:function(){return o.icode||n.icode||0},iid:function(){return o.iid||n.iid||0},cid:function(){return o.cid||n.cid||0},oid:function(){return o.oid||n.oid||0},time:function(){return o.time||n.time||""},url:function(){return r(o.url||n.location.href)},refer:function(){return r(o.referrer||a.referrer)},get:function(e){if(void 0!=w[e])return w[e];else if(this[e])return this[e]();else return""},update:function(){o=s.item||n.itemData||{};this.checkYoukuSrc()},getSourceId:function(){if(w.isMobile)return i.isYoukuSrc?g:p;else return i.isYoukuSrc?b:v},checkYoukuSrc:function(){if(o&&o.vcode)return i.isYoukuSrc=true;else return i.isYoukuSrc=false}};_.checkYoukuSrc();return _});define("module/stat/rec",["tui/net","module/global","module/stat/stat-info"],function(e,t,i){var a={};var n={};var r=i.get("iid");var s=i.get("cid");var o=i.get("sid");var l=i.get("uid");function c(c,u){u=u||a.req_id;var d=n[u];var f=d&&d.recommendItems;if(!(f&&f[c]))return;var m=f[c];if(u!=a.req_id)a=h(d.reqInfo);r=i.get("iid");s=i.get("cid");var p={};p.cookie_id=t.juid;l&&(p.uid=l);r&&(p.vid=r);o&&(p.sid=o);s&&(p.sct=s);p.apt=a.apt;p.pg=a.pg;p.md=a.md;p.pos=c||0;var g=m.iid||m.itemId;g&&(p.dvid=g);m.sid&&(p.dsid=m.sid);var v=m.cid||m.channelId;v&&(p.dct=v);p.abver=a.abver;p.dma=m.dma||0;p.ord=a.ord;p.req_id=u;p.algInfo=m.algInfo||"";p.rand=+new Date;e.getRequest("http://r.l.youku.com/trecommendclick",p)}function u(t){e.getRequest(t)}function d(c,u){c=c||{};var d=c.reqInfo||{};if(d.req_id)n[d.req_id]=c;r=i.get("iid");s=i.get("cid");a=h(d);var m={};m.cookie_id=t.juid;l&&(m.uid=l);r&&(m.vid=r);o&&(m.sid=o);s&&(m.sct=s);m.apt=a.apt;m.pg=a.pg;m.md=a.md;m.abver=a.abver;m.ord=a.ord;m.req_id=a.req_id;u&&(m.reqtype=u);m.showlist=f(c);m.rand=+new Date;e.getRequest("http://r.l.youku.com/trecommendshow",m);return d.req_id}function f(e){var t=[];if(e.recommendItems)e.recommendItems.forEach(function(e,i){t.push([e.iid||e.itemId||e.ownerId,e.type,e.dma,e.algInfo].join("_"))});return t.join(",")}function h(e){return{apt:e.apt||1,pg:e.pg||1,md:e.md||1,abver:e.abver||"A",ord:e.ord||1,req_id:e.req_id||""}}return{send:c,onShow:d,sendMM:u}});define("tui/util/str",[],function(e,t){function i(e){return e.replace(/([^\x00-\xff])/g,"$1 ").length}function a(e,t,i){e=e||"";if(void 0==i)i="..";if(this.byteLen(e)<=t)return e;var a=e.substr(0,t).replace(/([^\x00-\xff])/g,"$1 ").substr(0,t).replace(/([^\x00-\xff])\s/g,"$1");return a+i}function n(e,t){t=t||400;e=e.replace(/(\r\n|\n)+/g,"<br>");e=e.replace(/\s{2,}/g," ");e=e.replace(/(<(?:img|embed).*?>)([\s\S]*)$/gi,function(e,t,i){return t+i.replace(/<(?:img|embed).*?>/gi,"")});e=e.replace(/<\/(p|div|ol|ul|li)>/gi,"<br>");e=e.replace(/<(?!img|embed|br).*?>/gi,"");e=e.replace(/(<br[^>]*>\s*){2,}/gi,"$1");var i=e.length;e=e.substr(0,t);e=e.replace(/<[^>]*$/,"");if(e.length<i)e+=" ...";return e}var r=[];for(var s=0;s<256;s++)r[s]=(s<16?"0":"")+s.toString(16);function o(){var e=0|4294967295*Math.random();var t=0|4294967295*Math.random();var i=0|4294967295*Math.random();var a=0|4294967295*Math.random();return r[255&e]+r[255&e>>8]+r[255&e>>16]+r[255&e>>24]+"-"+r[255&t]+r[255&t>>8]+"-"+r[64|15&t>>16]+r[255&t>>24]+"-"+r[128|63&i]+r[255&i>>8]+"-"+r[255&i>>16]+r[255&i>>24]+r[255&a]+r[255&a>>8]+r[255&a>>16]+r[255&a>>24]}function l(e){var t={"&#60;":"<","&#62;":">","&#34;":'"',"&#39;":"'","&#38;":"&"};return e.replace(/(&#\d{2};)/g,function(e){return t[e]})}t.unescapeHTML=l;t.byteLen=i;t.substr=a;t.subHtml=n;t.uuid=o});define("tui/util/num",[],function(e,t){function i(e,t){var i="",a=e<0,n=String(Math.abs(e));if(n.length<t)i=new Array(t-n.length+1).join("0");return(a?"-":"")+i+n}function a(e,t){t=t.length;e=e||0;return 1==t?e:(e=String(Math.pow(10,t)+e)).substr(e.length-t)}function n(e,t){t=t||",";return String(e).replace(/(\d)(?=(\d{3})+($|\.))/g,"$1"+t)}function r(e){e=parseInt(e);var t;if(e>=1e8)t=(e/1e8).toFixed(2)+"äº¿";else if(e>=1e4){var i=e/1e4;var a=parseInt(i).toString();var r=a.length;if(r<4&&i!=a)a=i.toFixed(1==r?2:4-r);t=n(a)+"ä¸"}else t=n(e);return t}function s(e){e=parseInt(e);var t=-1;do{e/=1024;t++}while(e>1024);return Math.max(e,.1).toFixed(1)+["KB","MB","GB","TB"][t]}t.pad=i;t.format=a;t.split=n;t.field=r;t.bytes=s});define("tui/util/date",["tui/util/num"],function(e,t,i){var a=e.format;function n(e,t){if(void 0===t)t=new Date;else if($.isNumeric(t))t=new Date(parseInt(t,10));return e.replace(/([YMDhsm])\1*/g,function(e){switch(e.charAt()){case"Y":return a(t.getFullYear(),e);case"M":return a(t.getMonth()+1,e);case"D":return a(t.getDate(),e);case"w":return t.getDay()+1;case"h":return a(t.getHours(),e);case"m":return a(t.getMinutes(),e);case"s":return a(t.getSeconds(),e)}})}var r=60*24*60;function s(e,t,i){if($.isNumeric(e))e=new Date(parseInt(e,10));if($.isNumeric(t))t=new Date(parseInt(t,10));if(void 0===e)e=new Date;if(void 0===t)t=new Date;if(!i)i="YYYYå¹´MMæDDæ¥";var a=new Date(t.toDateString());var s=(+t-+e)/1e3;var o=(+t-+a)/1e3;if(s<=60)return"åå";else if(s<=60*60)return Math.floor(s/60)+"åéå";else if(s<=o)return Math.floor(s/3600)+"å°æ¶å";else if(s<=o+r)return"æ¨å¤©";else if(s<=o+2*r)return"åå¤©";else if(s<=o+25*r)return Math.floor(s/r)+"å¤©å";else return n(i,e)}function o(e,t){var i=0;e=String(e).split(":");for(var a=0,n=e.length;a<n;a++)i+=parseInt(e[a],10)*Math.pow(60,n-a-1);return t?1e3*i:i}function l(e,t){var i=[],a,n,e;if(void 0==t||t){a=parseInt(e/3600);n=parseInt(e%3600/60)}else n=parseInt(e/60);e%=60;if(n<10)n="0"+n;if(e<10)e="0"+e;i=[n,e];if(a>0)i.unshift(a);return i.join(":")}function c(e,t,i){if("date"==$.type(t))t=t.getTime();else t=parseInt(t);var n=new Date(t),r=n.getHours();if(n>432e5)r+=Math.floor(n/432e5);if(i)e=e.replace(/(\w)\1+/g,"$1");return e.replace(/([hms])\1*/g,function(t){switch(t.charAt()){case"h":return a(r-8,t);case"m":var i=60*(/h+/.test(e)?0:r-8)+n.getMinutes();return a(i,t);case"s":return a(n.getSeconds(),t)}})}function u(e,t){if(e<36e5)return this.formatTime("mm:ss",e,t);else return this.formatTime("hh:mm:ss",e,t)}i.release=s;i.formatDate=n;i.formatTime=c;i.formatTimeE=u;i.beautyTime=l;i.parseTime=o});define("module/uitcid",["tui/browser"],function(e,t,i){var a={1700:"2",2000:"11",2001:"9",1:"3",2:"4",3:"5",4:"5",5:"5",6:"6",7:"19",11:"13",200:"1"};var n=window.config;var r=window.pageId||n&&n.pageId||0;i.get=function(t,i,n){return[n||(e.isMobile?3:1),a[i||r]||0,t].join("_")};i.from=function(t,i,n,s){return[s||(e.isMobile?3:1),a[n||r]||0,t||0,i||0].join("_")};i.getFromId=function(e){return a[e||r]||0}});define("module/stat/sub",["tui/browser","tui/net","module/stat/common","module/global","module/uitcid"],function(e,t,i,a,n,r,s){var o=i.mix({getExt:function(){var e=this;var t={};$.extend(t,e.getData());return i.param(t)},send:function(r){var s={};s.uid=a.uid||0;s.tuid=6==r.favType?r.subId:"";s.shid=3==r.favType?r.subId:"";s.stype=r.subType;s.ftype=r.favType;s.did=e.isMobile?3:1;s.sid=r.sourceID||n.getFromId();s.url=location.href;s.vid=r.videoID||"";s.ext=this.getExt();t.getRequest("http://p.l.youku.com/tsubscribe?"+i.param(s));this.trigger("send")}});return o});define("module/subscribe",["tui/event","module/login/login","tui/art","module/domain","tui/util/num","tui/browser","module/stat/sub","tui/util/date"],function(e,t,i,a,n,r,s,o){var l=$(document.body);var c=l.width();var u=a.url.main;var d='<iframe src="about:blank" class="mask" frameborder="0"></iframe><i class="succ iconfont">&#xe647;</i><a class="cls iconfont" href="#">&#xe640;</a><p class="p"><b>è®¢éæå!</b>ä½ å¯ä»¥å» <a href="<%=domain%>/watch/" target="<%=target%>">æçè®¢é</a> æ¥çæ´æ°</p>';var f='<iframe src="about:blank" class="mask" frameborder="0"></iframe><i class="fail iconfont">&#xe640;</i><a class="cls iconfont" href="#">&#xe640;</a><p class="p"><%=txt%>~<br />ä½ å¯ä»¥åå» <a href="<%=domain%>/watch/" target="<%=target%>">æçè®¢é</a>æ´çä¸</p>';var h='<%\nvar cs1 = \'\', cs2 = \'\', str = \'\';\nvar detail = cfg.locate;\nvar app = cfg.app;\nvar link = cfg.linkTxt;\nvar target = cfg.target;\nvar total = data.total;\nvar skin = cfg.skin;\nvar id = data.id;\nvar videoID = data.videoID;\nvar isSubed = data.subed;\nswitch(skin){\ncase 1:\ncs1 = \'gbtn_sub_w\';\ncs2 = \'gbtn_sub_w\';\nbreak;\ncase 2:\ncs1 = \'gbtn_sub_b\';\ncs2 = \'gbtn_sub_b\';\nbreak;\ncase 3:\ncs1 = \'gbtn_sub_txt\';\ncs2 = \'gbtn_sub_txt\';\nbreak;\ncase 4:\ncs1 = \'gbtn_sub_txt gbtn_sub_w\';\ncs2 = \'gbtn_subed_txt\';\nbreak;\ncase 5:\ncs1 = \'gbtn_sub_txt gbtn_sub_b\';\ncs2 = \'gbtn_subed_txt gbtn_subed\';\nbreak;\ncase 6:\ncs1 = \'gbtn_sub_s\';\ncs2 = \'gbtn_subed_s\';\nbreak;\n};\nif(detail == \'left\'){\nstr = \'<em class="num_l">\' + splitNum(total) +\'<i class="ac"><i></i></i></em>\';\n}else if(detail == \'right\'){\nstr = \'<em class="num_r">\' + splitNum(total) +\'<i class="ac"><i></i></i></em>\';\n}\nvar attr = \' data-id=\'+ id + \' data-skin=\' + skin + \' data-disrecom =\' + cfg.disRecom;\n%>\n<%if(!data.click){%>\n<%if(skin == 6){%>\n<%if(!isSubed){%>\n<span class="gbtn_sub gbtn_sub_s" data-id="<%=id%>">\n<%==str%><a href="#" title="ç¹å»è®¢é" id="sub_<%=app%>_<%=id%>" <%=attr%>><i class="iconfont">&#xe637;</i></a>\n</span>\n<%}else{%>\n<span class="gbtn_sub gbtn_subed_s"  data-id="<%=id%>">\n<%==str%><a href="#" title="ç¹å»åæ¶è®¢é" <%=attr%> id="unsub_<%=app%>_<%=id%>"><i class="iconfont">&#xe637;</i></a>\n</span>\n<%if(link){%>			\n<a class="gbtn_link" href="<%=domain%>/watch/subscribe/" target="<%=target%>" id="sublink_<%=app%>_<%=id%>"><%=link%></a>\n<%}%>\n<%}%>\n<%}else{%>\n<%if(!isSubed){%>\n<span class="gbtn_sub <%=cs1%>"  data-id="<%=id%>">\n<%==str%><a href="#" title="ç¹å»è®¢é" <%=attr%> id="sub_<%=app%>_<%=id%>"><i class="iconfont">&#xe637;</i>è®¢é</a>\n</span>\n<%}else{%>\n<span class="gbtn_sub <%=cs2%> gbtn_subed"  data-id="<%=id%>">\n<%==str%><a href="#" title="ç¹å»åæ¶è®¢é" <%=attr%> id="unsub_<%=app%>_<%=id%>"><span class="f1"><i class="iconfont">&#xe647;</i>å·²è®¢é</span><span class="f2">åæ¶è®¢é</span></a>\n</span>\n<%if(link){%>			\n<a class="gbtn_link" id="sublink_<%=app%>_<%=id%>" href="<%=domain%>/watch/subscribe/" target="<%=target%>"><%=link%></a>\n<%}%>\n<%}%>\n<%}%>\n<%}else{%>\n<%if(skin == 6){%>\n<%if(!isSubed){%>\n<%==str%><a href="#" title="ç¹å»è®¢é" id="sub_<%=app%>_<%=id%>" <%=attr%>><i class="iconfont">&#xe637;</i></a>\n<%}else{%>\n<%==str%><a href="#" title="ç¹å»åæ¶è®¢é" <%=attr%> id="unsub_<%=app%>_<%=id%>"><i class="iconfont">&#xe637;</i></a>\n<%}%>\n<%}else{%>\n<%if(!isSubed){%>\n<%==str%><a href="#" title="ç¹å»è®¢é" <%=attr%> id="sub_<%=app%>_<%=id%>"><i class="iconfont">&#xe637;</i>è®¢é</a>		\n<%}else{%>\n<%==str%><a href="#" title="ç¹å»åæ¶è®¢é" <%=attr%> id="unsub_<%=app%>_<%=id%>"><span class="f1"><i class="iconfont">&#xe647;</i>å·²è®¢é</span><span class="f2">åæ¶è®¢é</span></a>\n<%}%>\n<%}%>\n<%}%>\n';var m=false;var p=location.href;var g=n.field;var v=1;if(r.isMobile||r.isPad)v=3;l.on("click",".gbtn_subbox .cls",function(e){e.preventDefault();$(".gbtn_subbox").remove()});$(window).on("resize",function(){$(".gbtn_subbox").remove()});var b=e.extend({initialize:function(e){var i=this;b.superClass.initialize.apply(i,arguments);var a=window.config&&window.config.pageId||window.pageId||0;m=a>=1&&a<=8;if(!e.box||!e.type)return;i.op=$.extend({app:"unknow",skin:0,isBelow:false,target:"_blank",disRecom:0},e);if(i.op.below)i.op.isBelow=i.op.below;if(i.op.link)i.op.linkTxt=i.op.link;if(i.op.detail)i.op.locate=i.op.detail;i.CACHE={};i.checkSub(e.box);t.bind("after:login",function(){i.checkSub(e.box)});$(e.box).on("click",".gbtn_sub a",function(e){e.preventDefault();var a=$(this);var n=a.closest(".gbtn_sub");var r=a.attr("data-id");var s=a.offset();var o=i.CACHE[r];if(!o)return;var l={subId:r,type:i.op.type,app:i.op.app,deviceID:v,url:p};if(o.videoID)l.videoID=o.videoID;if(o.from)l.from=o.from;t.needLogin(function(){l.uid=t.uid();if(n.hasClass("gbtn_subed"))i.unsub(l,function(e){i.toggle(r,false,a);$(".gbtn_subbox").remove()},null,n);else i.sub(l,function(e){i.toggle(r,true,a)},function(e){var t=e.msg||"åçäºæªç¥éè¯¯ã";if(2e3==e.code&&"ä¸å¯ä»¥éå¤è®¢é"===t)i.toggle(r,true,a);else i.dialog(false,s,t)},n)})})},dialog:function(e,t,a){var n=this;var r=t.left;r=r>c/2?r-242:r-12;var s=n.op.isBelow?t.top+(e?25:70):t.top-100;$(".gbtn_subbox").remove();l.append('<div class="gbtn_subbox">'+i.compile(e?d:f)({txt:a,target:n.target,domain:u})+"</div>");$(".gbtn_subbox").css({left:r,top:s})},update:function(){var e=this;e.checkSub(e.op.box)},checkSub:function(e){var i=this;var a=[];var n=t.uid();var r,s,o,l;$(e).find(".gbtn_sub[data-id]").forEach(function(e,t){r=$(e);s=r.attr("data-id");l={};if(s){a.push(s);l.total=r.attr("data-total")||0;l.id=s;l.videoID=r.attr("data-videoid")||i.op.videoID||0;l.from=r.attr("data-from")||i.op.from||0;i.CACHE[s]=l}});var c={subId:a.join(","),type:i.op.type,app:i.op.app,uid:n};if(n)i.check(c,function(e){if($.isPlainObject(e.data))a.forEach(function(t){i.render(t,e.data[t])});else i.render(a[0],e.data)});else a.forEach(function(e,t){i.render(e,false)})},render:function(e,t){var a=this;var n=a.CACHE[e];if(!n)return;n.subed=t;n.click=false;var r=i.compile(h)({data:n,cfg:a.op,domain:u,splitNum:g});$(a.op.box).find('.gbtn_sub[data-id="'+e+'"]').replaceWith(r);if(a.op.callback)a.op.callback.call(a,$(r))},toggle:function(e,t,a){var n=this;var r=n.CACHE[e];var s=$('.gbtn_sub a[data-id="'+e+'"]').parent();var o=n.op;r.click=true;r.subed=t;if(a){o.skin=a.attr("data-skin")||o.skin;o.disRecom=a.attr("data-disRecom")||o.disRecom}t?r.total++:r.total--;var l=i.compile(h)({data:r,cfg:o,domain:u,splitNum:g});s[t?"addClass":"removeClass"]("gbtn_subed").html(l);if(!o.linkTxt)return;if(t)s.after('<a class="gbtn_link" id="sublink_'+o.app+"_"+r.id+'" href="'+u+'/watch/subscribe/" target="'+o.target+'">'+o.linkTxt+"</a>");else s.next(".gbtn_link").remove()},check:function(e,t){var i=this;return $.getJSON(u+"/uis/sub/checkSub.action?jsoncallback=?",e,function(a){if(a.code){i.trigger("check:fail",[a]);b.globalEvent.trigger("check:fail",[e,a])}else{t&&t(a);i.trigger("check:success",[a]);b.globalEvent.trigger("check:success",[e,a])}},"jsonp")},sub:function(e,t,i,a){var n=this;var r;var o=e.subId.split(",");if(m){var l=n._getPlayTime();s.addData(function(){return{playtime:l}})}o.forEach(function(t){s.send({subId:t,subType:1,favType:1==e.type?3:6,sourceID:e.from,videoID:e.videoID})});if(e.codes&&""!=e.codes)delete e.subId;return $.getJSON(u+"/uis/sub/sub.action?jsoncallback=?",e,function(r){if(r.code){i&&i(r);n.trigger("sub:fail",[r]);b.globalEvent.trigger("sub:fail",[e,r,a])}else{t&&t(r);n.trigger("sub:success",[r,a]);b.globalEvent.trigger("sub:success",[e,r,a]);if(e.subId)n._loadInfo(e)}},"jsonp")},unsub:function(e,t,i,a){var n=this;s.send({subId:e.subId,subType:2,favType:1==e.type?3:6,deviceID:e.deviceID,sourceID:e.from,videoID:e.videoID});return $.getJSON(u+"/uis/sub/unsub.action?jsoncallback=?",e,function(r){if(r.code){i&&i(r);n.trigger("unsub:fail",[r]);b.globalEvent.trigger("unsub:fail",[e,r,a])}else{t&&t(r);n.trigger("unsub:success",[r,a]);b.globalEvent.trigger("unsub:success",[e,r,a])}},"jsonp")},_loadInfo:function(e){var t=this;if(1==e.type)$.getJSON(u+"/crp/getAlbumPosters.action?jsoncallback=?",{aids:e.subId},function(t){if(t&&t.data&&t.data[0])b.globalEvent.trigger("picAdded",[e,t.data[0]])},"jsonp");if(2==e.type)$.getJSON(u+"/uis/userInfo.action?jsoncallback=?",{app:e.app,uid:e.subId},function(t){if(t&&t.data)b.globalEvent.trigger("picAdded",[e,t.data])},"jsonp")},_getPlayTime:function(){var e=this;var t=window.mgr;var i=window.config;var a="";var n="";if(i&&i.item&&i.item.time)a=i.item.time;if(t&&t.widgets&&t.widgets.playCtrl){n=t.widgets.playCtrl.notifyPlayer("getPlaytime");n*=1e3;n=o.formatTimeE(n)}return[n,a]}});b.globalEvent=new e;return b});define("module/subsrecom",["module/subscribe","module/login/login","tui/art","tui/util/str","tui/cookie","module/domain","module/stat/rec"],function(e,t,i,a,n,r,s,o,l){var c;var u='\n<%data.forEach(function(o, i){%>\n<li ord="<%=i+1%>">\n<a href="<%=o.playLink%>" target="_blank" title="<%=o.ownerName%>" class="img"><img src="<%=o.picUrl%>" /></a>\n<a href="<%=o.playLink%>" target="_blank" title="<%=o.ownerName%>" class="li"><%=o.ownerName%></a>\n<span class="li"><%=o.cate%></span>\n<i class="gbtn_sub" data-id="<%=o.ownerId%>"></i>\n</li>\n<%})%>\n';var d=i.compile(u);var f=$("body");var h=$(window);var m=$("#gSideBar").length;var p=m?"æå¼å·¦ä¾§å¯¼èªå¯æ¥çTAçææ°æ´æ°":"";var g='<div class="g_dialog_recom"><iframe src="about:blank" class="mask" frameborder="0"></iframe>'+'<div class="top">'+'<i class="succ iconfont">&#xe647;</i>'+'<span class="t">è®¢éæå</span>'+p+'<a class="iconfont cls" href="#" data-role="close">&#xe640;</a>'+"</div>"+'<div class="recom"><h4>è®¢éäºTAçäººï¼è¿è®¢éäº</h4><ul class="fix"><li class="loading">æ°æ®æ­£å¨è½½å¥ä¸­...</li></ul></div></div>';var v=[113077064,113077233,102599789,113077370,113077877,113077745,113077988,116673329,120663473,120663556,120663623,120663663,120663699,366570608,366571453,366573231,366572712];function b(e,t){e=4-e;var i=[];$.ajax({url:"http://cmssrv.jj.tudou.com/oclient/portal/service/getIndexRecommendUserList.do?app=tudou&jsoncallback=?",dataType:"jsonp",success:function(a){if(a.items&&a.items.length){var n=a.items[0].userInfos;if(n.length)n.splice(0,e).forEach(function(e){i.push({picUrl:e.userPic,ownerName:e.nickName,ownerId:e.userId,playLink:e.url,cate:a.items[0].title})});t(i)}}})}function w(e,t,i,a){i&&$.ajax({url:r.url.tjpt+"/tjpt/tdrecuploader?callback=?",data:{encode:"utf-8",userid:i,juid:n("juid"),count:e,pcode:t,req_type:4,filterHot:1},dataType:"jsonp",success:function(e){if("1"==e.status)a&&a(e);else{cb2&&cb2(e);console.log(e)}}})}function _(e){e&&e.preventDefault();if(c){c.remove();c=null}}function y(t,i,a){if("1"===a.find("a").attr("data-disrecom")||1==t.type||2e3==i.code&&"ä¸å¯ä»¥éå¤è®¢é"!=i.msg)return false;_();var n=a.offset();var r=f.width();var o=f.height();var l=a.outerHeight();var u=t.nickname;var p=n.left?n.left>r/2?n.left-330:n.left:(r-420)/2;var y=n.top?n.top-h.scrollTop()>h.height()/2?n.top-300:n.top+l:h.scrollTop()+(h.height()-300)/2;c=$(g);c.css({left:p,top:y});f.append(c);c.on("click",".cls",_);w(4,10000203,t.subId,function(t){var i=t.recommendItems;i.forEach(function(e,t){if(e.cate.length<=2&&e.tag)e.cate+="/"+e.tag.split(",").shift();if($.inArray(e.ownerId,v)>-1){i.splice(t,1);return}});var a=i.splice(0,4);if(a.length<4)b(a.length,function(t){a=a.concat(t);c.find(".recom ul").html(d({data:a,hasSideBar:m}));new e({box:".g_dialog_recom",type:2,app:"gDialogRecom",skin:1,from:23,disRecom:1})});else{c.find(".recom ul").html(d({data:a,hasSideBar:m}));new e({box:".g_dialog_recom",type:2,app:"gDialogRecom",skin:1,from:23,disRecom:1})}var n=t.reqInfo.req_id;s.onShow(t,"p");c.on("click","li a",function(e){var t=$(this).closest("li").attr("ord");s.send(t,n)})})}l.init=function(){e.globalEvent.bind("sub:success",y);e.globalEvent.bind("sub:fail",y)}});define("module/sidebar/curve-motion",[],function(){var e=.0017;var t=function(t,i,a){if(!$.isArray(t))return;if($.isFunction(i)){a=i;i={}}this.options=i||(i={});if(i.easing)this._easing=i.easing;if(i.gravity)e=i.gravity;this.originX=t[0];this.originY=t[1];this.targetX=t[2];this.targetY=t[3];this.absX=Math.abs(this.targetX-this.originX);this.absY=Math.abs(this.targetY-this.originY);this.upward=this.targetY-this.originY<0;this.angle=180*Math.atan(this.absY/this.absX)/Math.PI;this.angle+=Math.cos(this.angle*Math.PI/180)*(i.elevationAngle||0);this.rad=this.angle*Math.PI/180;this.speed=Math.sqrt(e*this.absX*this.absX/(2*(this.absX*Math.tan(this.rad)-this.absY)),2)/Math.cos(this.rad);this.duration=this.absX/(this.speed*Math.cos(this.rad));this.draw=this.draw.bind(this);this._completeCallback=$.isFunction(a)&&a||function(){}};t.prototype={draw:function(){var e=+new Date-this.startTime;e=Math.min(e/this.duration,1);e=this._easing(e);if(e<1&&!this._paused)a(this.draw);var t=this._calcX(this.originX,this.targetX,e);var i=this._calcY(Math.abs(this.upward?t-this.originX:this.targetX-t));if(this._frameTimer)clearTimeout(this._frameTimer);var n=this;n._frameTimer=setTimeout(function(){if(n._useTransform)n._updateCallback(t-n.originX,n.upward?-i:n.absY-i);else n._updateCallback(t,n.upward?n.originY-i:n.targetY-i);if(1==e)n._completeCallback(t,i)},0)},start:function(){this._paused=false;this.startTime=+new Date;this.draw()},pause:function(){this._paused=true},updateFrame:function(e,t){this._updateCallback=e;this._useTransform=!!t},_calcX:function(e,t,i){return e+(t-e)*i},_calcY:function(t){return t*Math.tan(this.rad)-e*t*t/(2*Math.pow(this.speed*Math.cos(this.rad),2))},_easing:function(e){return e*e*(3-2*e)}};var i=!!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame);var a=window.requestAnimationFrame||function(){var e=0;return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){var i=(new Date).getTime(),a;a=Math.max(0,16-(i-e));e=i+a;return setTimeout(function(){t(i+a)},a)}}();t.supportCSSTransform=i;return t});define("tui/view",["tui/event"],function(e){var t="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;var i=0;var a;var n=".delegateEvents";var r=function(t){this.clsid=i++;this._configure(t||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents();$.extend(this,new e)};var s={};var o=["el","id","attrs","className","tagName","model"];var l=/^(\S+)\s*(.*)$/;$.extend(r.prototype,{tagName:"div",initialize:function(){},render:function(){return this},get:function(e){return s[e]||null},find:function(e){return this.$el.find(e)},remove:function(){this.$el.remove();this.undelegateEvents();this.unbind();return this},create:function(e,t,i){var a=document.createElement(e);if(t)$(a).attr(t);if(i)$(a).html(i);return a},setElement:function(e,t){if(this.$el)this.undelegateEvents();this.$el=e instanceof $?e:$(e);this.el=this.$el[0];if(false!==t)this.delegateEvents();return this},delegateEvents:function(e){if(!(e||(e=this.events)))return;this.undelegateEvents();for(var t in e){var i=e[t];if(!$.isFunction(i))i=this[e[t]];if(!i)continue;var a=t.match(l);var r=a[1],s=a[2];i=i.bind(this);r=this._ensureTouch(r,s);r+=n+this.clsid;if(""===s)this.$el.on(r,i);else this.$el.on(r,s,i)}return this},undelegateEvents:function(e,t){var e=e?this._ensureTouch(e):"";this.$el.off(e+n+this.clsid,t);return this},modelEvents:function(e,t){t="{"+($.trim(t)||"mod")+"} ";for(var i in this)if(0===i.indexOf(t))e.bind(i.slice(t.length),this[i],this)},_configure:function(e){if(this.options)e=$.extend({},this.options,e);for(var t=0,i=o.length;t<i;t++){var a=o[t];if(e[a])this[a]=e[a]}this.options=e},_ensureElement:function(){if(this.el)this.setElement(this.el,false);else{var e=this.attrs||{};if(this.id)e.id=this.id;if(this.className)e["class"]=this.className;this.setElement(this.create(this.tagName,e),false)}},_ensureTouch:function(e,i){if(t&&window.tudouClickStat){if(("click"==e||"tap"==e||"singleTap"==e)&&""!==i){var r=e+n+this.clsid;this.$el.on(r,i,function(e){e.preventDefault();if(!tudouClickStat.getStatTarget(e.target)){if(void 0===e.pageX)e.pageX=e.pageY=0;if(a)clearTimeout(a);a=setTimeout(function(){tudouClickStat.send(e,{},function(){},true)},10)}})}return e}switch(e){case"tap":case"singleTap":return"click";case"doubleTap":return"dblclick"}return e},_clearTimer:function(){var e=arguments;for(var t=0,i=e.length;t<i;t++){var a=e[t];if(a){clearTimeout(a);clearInterval(a)}}return null}});r.create=function(e,t){if(e&&!s[e])return s[e]=new this(t);return new this(t)};r.instance=function(e,t){if(e&&!s[e])return s[e]=t;return s[e]||null};r.destroy=function(e){if(e){if(s[e]){s[e].remove();delete s[e]}}else for(var t in s)arguments.callee(t)};r.extend=function(e,t){var i=this;var a=function(){i.apply(this,arguments)};$.extend(a,i,t);var n=function(){this.constructor=a};n.prototype=i.prototype;a.prototype=new n;$.extend(a.prototype,e);a.superClass=i.prototype;return a};return r});define("module/sidebar/curvefly",["tui/view","module/sidebar/curve-motion"],function(e,t){var i;var a=e.extend({initialize:function(){this._coords=this.options.coords;this._picurl=this.options.picurl||null;this._motion=new t(this._coords,{elevationAngle:this.options.elevationAngle||33},this._complete.bind(this));this._motion.updateFrame(this._update.bind(this),t.supportCSSTransform);this.render()},remove:function(){a.superClass.remove.call(this)},render:function(){var e=this._picurl;if(!(e&&e.indexOf("&#x")!==-1)){e=this._picurl?'<img src="'+this._picurl+'" />':'<i class="iconfont">&#xe637;</i>';var t=$('<div class="g-subs-ani">'+e+"</div>")}else var t=$('<div class="g-subs-ani g-curvefly-wrap">'+e+"</div>");t.css({left:this._coords[0],top:this._coords[1]});$(document.body).append(t);this.setElement(t)},start:function(){this.$el.show();this._motion.start()},pause:function(){this._motion.pause()},_update:function(e,i){if(t.supportCSSTransform)this.$el.get(0).style[n+"Transform"]="translate3d("+e+"px, "+i+"px, 0)";else this.$el.css({left:e,top:i})},_complete:function(){var e=this.$el;if(t.supportCSSTransform)e.get(0).style[n+"Transform"]="none";e.css({left:this._coords[2],top:this._coords[3]}).fadeOut(300)}});a.create=function(e,t,n,r,s,o){a.destory();i=new a({coords:[e,t,n,r],picurl:s,elevationAngle:o});return i};a.destory=function(){if(i){i.remove();i=null}};var n="";var r=document.createElement("div");$.each({Webkit:"webkit",Moz:"moz",O:"o",ms:"ms"},function(e,t){if(void 0!==r.style[e+"TransitionProperty"]){n=e;return false}});return a});define("module/sidebar/recent-rec-panel",["tui/net","tui/art","tui/cookie","tui/dialog","module/domain"],function(e,t,i,a,n){var r=t.compile('<% if (channel.length) { %>\n<% channel.forEach(function(item, index){ %>\n<div class="rec-item">\n<div class="pic">\n<a href="<%=$getUserHomeUrl(item.userId)%>" target="_blank"><img src="<%=item.userpic%>" /></a>\n</div>\n<div class="txt">\n<a href="<%=$getUserHomeUrl(item.userId)%>" target="_blank"><%=item.nickname || item.username%></a>\n</div>\n</div>\n<% }); %>\n<% } %>\n<% if (album.length) { %>\n<% album.forEach(function(item, index){ %>\n<div class="rec-item">\n<div class="pic">\n<a href="<%=$getAlbumCoverUrl(item.acode)%>" target="_blank"><img src="<%=item.albumPicUrl%>" /></a>\n</div>\n<div class="txt">\n<a href="<%=$getAlbumCoverUrl(item.acode)%>" target="_blank"><%=item.albumName%></a>\n</div>\n</div>\n<% }); %>\n<% } %>\n');var s='<div class="g-recent-rec" data-role="holder">'+'<h2 data-role="title">è¿æ¯ä½ ç»å¸¸ççèªé¢é</h2>'+"<h3>æå®ä»¬å å¥ä½ çè®¢éåè¡¨</h3>"+'<a href="#" class="rec-close" data-role="close"><i class="iconfont">&#xe63f;</i></a>'+'<div class="rec-content" data-role="content"></div>'+'<a href="#" class="rec-sub">ç¡®å®</a>'+"</div>";
var o=a.extend({events:{"click .rec-sub":"subAll"},initialize:function(){var e={template:s,hasDrag:false};$.extend(this.events,o.superClass.events);o.superClass.initialize.call(this,e)},destory:function(){o.superClass.close.call(this)},open:function(){var e=this;var t=i("g_recent_rec")||0;if(!t)setTimeout(function(){e.fetch()},100);else e.destory()},close:function(){this.report(2);this.destory();this.setCookie(true)},setCookie:function(e){i("g_recent_rec",1,{path:"/",domain:"tudou.com",expires:e?30:1})},report:function(t){e.getRequest(n.url.main+"/watch/seriesAndSub/doOpearation.do?uid="+window.uid+"&status="+t)},fetch:function(){var e=this;$.getJSON(n.url.main+"/watch/seriesAndSub/show.do?jsoncallback=?",{uid:window.uid},function(t){if(t&&0===t.code&&t.data){var i=t.data;if((i.channel||i.album)&&i.album_size+i.channel_size>0){o.superClass.open.call(e);if(i.channel_size>0&&i.channel_size<6){if(i.album_size>0){i.album=i.album.slice(0,6-i.channel_size);e.title("è¿æ¯ä½ ç»å¸¸ççèªé¢éåå§é")}}else if(0==i.channel_size)e.title("è¿æ¯ä½ ç»å¸¸ççå§é");e._data=i;e.content(r(i));e.locate()}else{e.destory();e.setCookie()}}else{e.destory();e.setCookie()}})},subAll:function(e){e&&e.preventDefault();var t=this;var i=t._data;var r=[];var s=[];var o=[];if(i.channel_size>0){i.channel.forEach(function(e){s.push(e.ucode)});r.push($.getJSON(n.url.main+"/uis/sub/sub.action?jsoncallback=?",{app:"watchcenter",uid:window.uid,type:2,codes:s.join(",")}))}if(i.album_size>0&&i.channel_size<6){i.album.forEach(function(e){o.push(e.acode)});r.push($.getJSON(n.url.main+"/uis/sub/sub.action?jsoncallback=?",{app:"watchcenter",uid:window.uid,type:1,codes:o.join(",")}))}$.when.apply(t,r).done(function(e,i){var a=false,n={};if(3===arguments.length){if(0==e.code){$.extend(n,e.data||{});a=true}}else{if(0==e[0].code){$.extend(n,e[0].data||{});a=true}if(0==i[0].code){$.extend(n,i[0].data||{});a=true}}if(a){t.report(1);t.destory();t.trigger("suball:success",[t._matchSubedData(n)])}}).fail(function(){t.destory();a.alert("æ¹éè®¢éå¤±è´¥")})},_getDataMap:function(){var e={};var t=this._data;t.channel&&t.channel.forEach(function(t){e[t.ucode]=t});t.album&&t.album.forEach(function(t){e[t.acode]=t});return e},_matchSubedData:function(e){var t=[];var i=this._getDataMap();for(var a in e){var n=i[a];if("1"==e[a])if(n.acode)t.push({type:1,id:n.aid,title:n.albumName,smallPic:n.albumPicUrl});else t.push({type:2,id:n.userId,title:n.nickname||n.username,smallPic:n.userpic})}return t}});t.helper("$getAlbumCoverUrl",function(e){return n.url.main+"/albumcover/"+e+".html"});t.helper("$getUserHomeUrl",function(e){return n.url.main+"/home/_"+e+"/"});return o});define("page/watch/model/rec-new",["tui/event","module/global","tui/net","module/domain"],function(e,t,i,a){var n=e.extend({initialize:function(e){n.superClass.initialize.call(this);this.options=e||(e={})},fetch:function(e,t){var n=this;var r=Math.ceil(3*Math.random());var s={callbackName:"jsoncallback",charset:"utf-8"};var o="";e=e||8;if(t)o="&userId="+t;i.getJSON(a.url.gc+"/newsData.html?pageNo="+r+"&pageSize="+e+o,{},function(e){if(e.length)n.trigger("getrec:success",[e])},s)}});return n});define("page/watch/model/api",["module/domain","module/login/login"],function(e,t){var i=e.url;return{subList:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/sub/subList.do?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},subListGroupAlbum:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/sub/subListGroupAlbum.do?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},subListJson:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/sub/subListJson.do?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},subCount:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/uis/sub/subCount.action",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},subedCount:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/uis/sub/subedCount.action",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},subAlbumGroupCount:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/sub/subAlbumGroupCount.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},updateList:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/sub/updateListAllInfo.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},marrowUpdateList:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/sub/marrowUpdateList.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},sub:function(e,t,a){e.app="watchcenter";e._=+new Date;return $.getJSON(i.main+"/uis/sub/sub.action?jsoncallback=?",e,function(e){if(e.code){console&&console.error(e.msg);a&&a(e)}else t&&t(e)})},unSub:function(e,t){e.app="watchcenter";e._=+new Date;return $.getJSON(i.main+"/uis/sub/unsub.action?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},addTop:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/uis/sub/addTopSub.action?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},removeTop:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/uis/sub/removeTopSub.action?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},albumDetail:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/album/detail.do?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},albumItems:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/album/items.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},albumItemsById:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/album/itemsByIds.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},albumEssence:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/album/marrows.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},userDetail:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/user/detail.do?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},userItems:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/user/items.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},userItemsById:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/user/itemsWithPlaylistsByUids.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},userEssence:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/user/marrows.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},interDetail:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/interest/detail.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},interItems:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/interest/items.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},interEssence:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/interest/marrows.do",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},getUserInfos:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/history/getUserInfos.do?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},expose:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/exposure/exposure.do?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},exposeByType:function(e,t){e.app="watchcenter";return $.getJSON(i.main+"/watch/exposure/exposureByType.do?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},itemInfo:function(e,t){return $.getJSON(i.main+"/watch/play/getPlayInfo.do",{itemId:e,app:"watchcenter"},function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})},alist:function(e,t){return $.getJSON(i.main+"/tvp/alist.action",{a:e},function(e){t&&t(e)})},recommend:function(e,t){return $.post(i.main+"/watch/recommendSources.do",e||{},function(e){t&&t(e)},"json")},favor:function(t,i){return $.getJSON(e.url.programstat+"/itemFavor.srv",{iabcdefg:t,app:"watchlater"},function(e){i&&i(e)},"jsonp")},qrcode:function(e){return"http://yun.tudou.com/qrcode.action?"+$.param(e)},unlike:function(e,a){e.app="watchcenter";e.uid=t.uid();return $.getJSON(i.main+"/watch/dislike.do",e,function(e){if(e.code)console&&console.error(e.msg);else a&&a(e)})},getItemInfos2:function(e,a){e.app="watchcenter";e.uid=t.uid();return $.getJSON(i.main+"/crp/getItemInfos2.action",e,function(e){if(e.error)console&&console.error(e.msg);else a&&a(e)})},getDetailByUrl:function(e,t,a){return $.getJSON(i.main+"/watch/sourceData/getDetailByUrl.do",{url:e,app:"watchcenter"},function(e){if(e.code)a&&a(e.msg);else t&&t(e)})},wcstat:function(e,a){e.app="watchcenter";e.uid=t.uid();return $.getJSON(i.main+"/watch/wcstat.do",e,function(e){if(e.code)console&&console.error(e.msg);else a&&a(e)})},listFavoriteItems:function(e,t){return $.getJSON(i.main+"/my/programs/srv/listFavoriteItems.html",e,function(e){if(1==e.system)t&&t(e);else console&&console.error(e.msg)})},deleteFavor:function(e,t){return $.getJSON(i.main+"/my/programs/srv/deleteFavor.html",e,function(e){if(1==e)t&&t(e)})},getUserSubedPlaylists:function(e,t){return $.getJSON(i.main+"/my/tui/getUserSubedPlaylists.html",e,function(e){t&&t(e)})},cancelSubscribePlaylist:function(e,t){return $.get(i.main+"/playlist/service/cancelSubscribePlaylist.html",e,function(e){t&&t(e)})},getRecommendUsers:function(e,t){e=$.extend({size:10,keys:"å¨é¨"},e);return $.getJSON(i.main+"/watch/getRecommendUsers.do?jsoncallback=?",e,function(e){if(e.code)console&&console.error(e.msg);else t&&t(e)})}}});define("page/watch/model/sublist",["tui/event","tui/template","module/global","module/login/login","page/watch/model/api"],function(e,t,i,a,n){var r;var s=e.extend({items:[],byId:{},byType:{},initialize:function(){s.superClass.initialize.call(this);r=this},getItemById:function(e){return this.byId[e]||null},getItemsByType:function(e){return this.byType[e]||[]},getItemCount:function(e){if(e)return this.getItemsByType(e).length;else return this.items.length},index:function(e,t){var i=this;var a=t?i.items.length:0;e||(e=i.items);e=e.slice(0);if(!t){i.byId={};i.byType={};i.items=e}e.forEach(function(e,n){if(!e)return;i.byId[e.id]={index:n+a,data:e};i.byType[e.type]||(i.byType[e.type]=[]);i.byType[e.type].push(e);if(t)i.items.push(e)});i.trigger("sublist:change",[i.items])},fetch:function(e,t){var i=this;t=t||999;n.subListGroupAlbum({uid:a.uid(),start:0,end:t,order:e||0},function(e){var t=[];var a=e&&e.data;if(a){t=t.concat(a.type1,a.type2);i.updateCount=a.updateCount;i.index(t);i.trigger("sublist:data",[0,t]);i.isDataLoaded=true}})},unSub:function(e,t,i){var r=this;var s=this.items;n.unSub({uid:a.uid(),subId:e,type:t},function(a){var n=r.getItemById(e);r.prevItemsData=s.slice(0);s.splice(n.index,1);r.index();r.trigger("unsubed",[e,t,i])})},reSub:function(e,t,i){var r=this;n.sub({uid:a.uid(),subId:e,type:t},function(a){var n=a&&a.data;if(n){if(r.prevItemsData){r.items=r.prevItemsData;r.index();r.prevItemsData=null}r.trigger("resubed",[e,t,i])}})},addSub:function(e,t){var i=this;var r=this.items;var s=1==t?"albumDetail":"userDetail";n[s]({id:e,uid:a.uid()},function(a){var n=a&&a.data;if(n){r.unshift({added:true,top:false,id:e,type:t,title:n.albumName||n.nickname||n.username,smallPic:n.albumPicUrl||n.userpic,updateCount:n.updateCount||0});i.index(r);i.trigger("subadded",[r[0],t])}})},removeSub:function(e,t){var i=this.getItemById(e);if(i){var a=this.items.splice(i.index,1);this.index();this.trigger("subremoved",[a[0],i.index])}},search:function(e){this._searchKW=e=e.toLowerCase();var i=this;var a=[];var n=e.length;var r=this.items;var s=r.length-1;if(""==e){this.trigger("sublist:data",[0,r]);return}r.forEach(function(o,l){if(i._searchKW!=e)return false;var c=t.escapeHTML(o.title);var u=c.toLowerCase().indexOf(e);if(u>-1){o=r.slice(l,l+1)[0];o._title=c.substring(0,u)+"<em>"+c.substring(u,u+n)+"</em>"+c.substring(u+n);o._highlight=true;a.push(o)}if(s==l)i.trigger("sublist:data",[1,a])})},expose:function(e,t){var i=this;var r=a.uid();if(e&&t)n.expose({sourceId:t,sourceType:e,uid:r},function(a){i.trigger("expose",[e,t])});else if(e)n.exposeByType({type:e,uid:r},function(t){i.trigger("expose",[e])})}});s.get=function(){return r||null};s.create=function(){if(!r)r=new s;return r};s.remove=function(){if(r)r=null};return s});define("page/watch/model/setting",["tui/cookie","tui/browser"],function(e,t){var i={expires:365,domain:"tudou.com",path:"/"};var a=JSON.parse(e("watch_center_setting")||"{}");var n={getItem:function(e){return e?a[e]:a},setItem:function(t,n){a[t]=n;e("watch_center_setting",JSON.stringify(a),i)}};window._watch_setting=n;return n});define("page/watch/model/local-record",["module/global"],function(e){var t="mysub-action-data";var i=e.storage;var a;i.getItem(t,function(e){e||(e="{}");a=JSON.parse(e)});var n={add:function(e,n,r){r||(r=1);if(a[e])a[e]["C"]+=r;else{n["C"]=r;a[e]=n}try{i.setItem(t,JSON.stringify(a))}catch(s){this.remove()}},remove:function(e){if(!e){a=null;i.removeItem(t)}else{a[e]=null;delete a[e];i.setItem(t,JSON.stringify(a))}},size:function(e){var t=0;for(var i in a)if(!e||e&&a[i]["type"]==e)t++;return t},get:function(e){return e?a&&a[e]:a},getCountById:function(e){var t=this.get(e);return t&&t["C"]||0},getAllCountByType:function(e){var t=0;for(var i in a)if(a[i]["type"]==e)t+=a[i]["C"];return t},getAllCount:function(){var e=0;for(var t in a)e+=a[t]["C"];return e}};return n});define("tui/countdown",[],function(){return function(e,t,i){var t=t||3;var a;var e=$(e).html(t);a=setInterval(function(){t--;if(t<=0){clearInterval(a);if(i)i()}e.html(t)},1e3);return{close:function(){clearInterval(a)}}}});define("module/stat/expose",["tui/class","tui/net","module/stat/common","module/global"],function(e,t,i,a,n,r){var s=window.rqtime||new Date;return e(i.mix({initialize:function(e,t){this.element=e;this.eventType=t?2:1;this.startTime=new Date;this.endTime=0;this.isSent=false;this.__callbacks=[]},start:function(){this.startTime=new Date;this.isSent=false},end:function(){this.endTime=new Date;this.send()},send:function(){var e=i.getPositionCode(this.element);var n=this.endTime||new Date;var r=encodeURIComponent;var o=this.getData(e);var l={pvid:a.pvid||"",chid:window.cid||0,uid:a.uid||0,juid:a.juid||"",seid:a.seid||"",url:location.href,rurl:i.referrer||"",mcode:e,etype:this.eventType,etime:n-s,ltime:n-this.startTime,ext:i.param(o)};t.getRequest("http://p.l.youku.com/texpose?"+i.param(l)+"&r="+ +new Date);var c=[];$.each(o,function(e,t){c.push(r(e)+"="+r(t))});var u=c.join("|");var d=[a.pvid||"",window.cid||0,a.uid||0,a.juid||"",a.seid||"",r(i.referrer||""),r(e),this.eventType,n-s,n-this.startTime,u].join("|");t.getRequest("http://stats.tudou.com/ep1/?v=1&s="+d+"&r="+(new Date).getTime());this.isSent=true}},true))});define("module/stat/ck",["tui/cookie","tui/net","module/login/login","module/stat/common","module/global"],function(e,t,i,a,n,r,s){var o=screen.width;var l=screen.height;function c(e,t){return e.replace(/\/?#.*|\/$/,"")===t.replace(/\/?#.*|\/$/,"")}window.tudouClickStat=a.mix({pvid:n.pvid,getRequest:function(r){var s=$(window).width();var o=$(window).height();var l=$(document).width();var c=r.eventId;var u=r.pvid;var d=r.channelId;var f=n.uid;var h=r.screenW;var m=r.screenH;var p=s;var g=o;var v=r.pageX-r.scrollLeft-Math.round(s/2);var b=r.pageY-r.scrollTop;var w=r.pageX-Math.round(l/2);var _=r.pageY;var y=n.juid;var k=n.seid;var x=encodeURIComponent(r.positionCode||"");var S=encodeURIComponent(a.referrer||"");var T=encodeURIComponent(r.targetUrl||"");var C="";var I=r.appData;I.referhost=e("referhost")||"";if(i.uid()){var D=$.trim(e("u_data")).split("_");if(D.length)D.forEach(function(e){e=e.split("|");I[e[0]]=e[1]})}$.extend(I,this.getData(c,x,r.event));var L={eid:c,pvid:u,chid:d,uid:f,juid:y,seid:k,sw:h,sh:m,bw:p,bh:g,bpx:v,bpy:b,ppx:w,ppy:_,pcode:r.positionCode||"",url:location.href,rurl:a.referrer||"",turl:r.targetUrl||"",ext:a.param(I)};t.getRequest("http://p.l.youku.com/tclick?"+a.param(L)+"&r="+ +new Date);var M=[];$.each(I,function(e,t){M.push(encodeURIComponent(e)+"="+encodeURIComponent(t))});C=M.join("|");var N=[c,u,d,f,h,m,p,g,v,b,w,_,y,k,x,S,T,C].join("|");t.getRequest("http://stats.tudou.com/ck2/?s="+N+"&r="+ +new Date)},send:function(e,t,i,n){var r=this;if(!e.target)e.target=e.srcElement||document;if(null==e.pageX&&null!=e.clientX){var s=document.documentElement;var u=document.body;e.pageX=r.clientX+(s&&s.scrollLeft||u&&u.scrollLeft||0)-(s&&s.clientLeft||u&&u.clientLeft||0);e.pageY=r.clientY+(s&&s.scrollTop||u&&u.scrollTop||0)-(s&&s.clientTop||u&&u.clientTop||0)}if("undefined"==typeof e.pageX)return;var d=e.target;if(!n){d=a.getStatTarget(e.target);if(!d)return}if("A"==d.nodeName&&$(d).attr("data-openurl"))return;var f=false;var h=a.getTrueLink(d);if("A"!==d.nodeName||""===h||c(h,location.href))f=true;if("ck"==$(d).attr("data-stat-role")&&""!==h)f=false;var m=$(d).attr("data-ck");if(m)$.each(m.split("&"),function(e,i){var a=i.split("=");if(2!==a.length)return;t[a[0]]=a[1]});r.getRequest({event:e,eventId:f?2:1,pvid:r.pvid,channelId:window.cid||0,positionCode:a.getPositionCode(d),targetUrl:f?"":h,pageX:e.pageX,pageY:e.pageY,scrollLeft:$(window).scrollLeft(),scrollTop:$(window).scrollTop(),screenW:o,screenH:l,appData:t||{}});if(i)i.call(r,{isButton:f,targetUrl:h})},init:function(){var e=this;$(document.body).mousedown(function(t){e.send(t,{})})},getXpathFromPositionCode:a.getXpathFromPositionCode,getElementByXPath:a.getElementByXPath,getTrueLink:a.getTrueLink,getStatTarget:a.getStatTarget});s.tudouClickStat=tudouClickStat;s.init=function(){tudouClickStat.init()}});define("module/responsive",["tui/event"],function(e){var t=null;var i=$(window);var a="responsed";var n="resize";var r=null;var s=e.extend({initialize:function(e){var t=this;s.superClass.initialize.call(t)},init:function(e){var t=this;t.divide=e;var a;i.resize(function(){a&&clearTimeout(a);a=setTimeout(function(){t.check()},100)});return t},check:function(){var e=this;var t=e.viewPort();var i=t.width;if(r&&i>=r.s[0]&&i<r.s[1]){e.fire(n,[i,t.height,r.v]);return}r=e._getCurRes();var s=$("body")[0];s.className=s.className.replace(/\s*\bw\d+\b/g,"")+" w"+r.v;e.fire(n,[i,t.height,r.v]);e.fire(a,[r.v])},_getCurRes:function(){var e=this;var t=e.viewPort().width;var i;$.each(e.divide,function(e,a){var n=a.s[0];var r=a.s[1];if(t>=n&&t<r){i=a;return false}});return i},getCurWidth:function(){var e=this._getCurRes();return e.v},viewPort:function(){var e=window,t="inner";var i=this.padding||0;if(!("innerWidth"in window)){t="client";e=document.documentElement||document.body}return{width:e[t+"Width"]-i,height:e[t+"Height"]}}});s.getInstance=function(){if(t)return t;else return t=new s};return s.getInstance()});define("tui/scrollbar",["tui/event","tui/drag"],function(e,t){var i=e.extend({initialize:function(e,a){a=a||{};var n=this;i.superClass.initialize.apply(n,arguments);n.isShow=false;n.barMinSize=a.barMinSize||60;n.wheelDelta=a.wheelDelta||60;n.prevNextDelta=a.prevNextDelta||n.wheelDelta;n.horizontalScroll=a.horizontalScroll||false;var r=n.horizontalScroll;var s=$(e);var o=a.container||s.parent();var l=a.scrollbar||$('<div class="scrollbar_container"><a href="#" class="scrollbar_prev"></a><div class="scrollbar_track"><span class="scrollbar_bar"></span></div><a href="#" class="scrollbar_next"></a></div>');var c=l.find(".scrollbar_track");var u=l.find(".scrollbar_bar");var d=l.find(".scrollbar_prev");var f=l.find(".scrollbar_next");if(!a.scrollbar)o.after(l);var h=new t(u,{limit:true});h.bind("drag:move",function(e,t){n.scrollTo(n.horizontalScroll?e:t)});o.bind("scroll",function(e){n.updateBarPosition()});if($.browser.mozilla)o[0].addEventListener("DOMMouseScroll",function(e){var t=e.detail>0?n.wheelDelta:-n.wheelDelta;o[0][r?"scrollLeft":"scrollTop"]+=t*n._wheelRate;if(n.isShow)e.preventDefault()},false);else o[0].onmousewheel=function(e){e=e||window.event;var t=e.wheelDelta>0?-n.wheelDelta:n.wheelDelta;o[0][r?"scrollLeft":"scrollTop"]+=t*n._wheelRate;if(n.isShow){e.returnValue=false;return false}};u.click(function(e){e.stopPropagation()});c.click(function(e){e.preventDefault();n.scrollTo(e[r?"pageX":"pageY"]-c.offset()[r?"left":"top"]-n._barSize/2)});d.click(function(e){e.preventDefault();o[0][r?"scrollLeft":"scrollTop"]-=n.prevNextDelta});f.click(function(e){e.preventDefault();o[0][r?"scrollLeft":"scrollTop"]+=n.prevNextDelta});n.content=s;n.container=o;n.scrollbar=l;n.track=c;n.prev=d;n.next=f;n.bar=u;n._contentSize=0;n._containerSize=0;n._trackSize=0;n._barSize=0;n.update()},updateBarPosition:function(){var e=this.horizontalScroll;var t=this.container[e?"scrollLeft":"scrollTop"]();var i=(t*this._trackSize-t*this._barSize)/(this._contentSize-this._containerSize);i=i?i:0;this.bar.css(e?"left":"top",i);if(i>=this._trackSize-this._barSize)this.trigger("scroll:end")},scrollTo:function(e,t){var i=this.horizontalScroll;var a=t?e:(e*this._contentSize-e*this._containerSize)/(this._trackSize-this._barSize);this.container[i?"scrollLeft":"scrollTop"](a?a:0)},update:function(){this.show();var e=this.horizontalScroll;var t=e?"width":"height";this._contentSize=this.content[e?"innerWidth":"innerHeight"]();this._containerSize=this.container[t]();this._trackSize=this.track[t]();this._wheelRate=Math.min(Math.atan(this._contentSize/3e3),1);if(this._contentSize>this._containerSize){this._barSize=Math.floor(this._containerSize*this._trackSize/this._contentSize);this._barSize=Math.max(this._barSize,this.barMinSize);this.bar.css(t,this._barSize);this.updateBarPosition()}else this.hide()},show:function(){this.isShow=true;this.scrollbar.show();this.trigger("show")},hide:function(){this.isShow=false;this.scrollbar.hide();this.trigger("hide")}});return i});define("tui/util/url",[],function(e,t){function i(e,t){if(!$.browser.msie)if(t)window.open(e,t);else location.href=e;else{var i=$('<a href="'+e+'" target="'+(t||"_self")+'" data-openurl="true"> </a>')[0];document.body.appendChild(i);i.click()}}function a(e){e=e||location.search||location.href;var t={},i=e.match(/[^\s&?#=\/]+=[^\s&?#=]+/g);if(i)for(var a=0,n=i.length;a<n;a++){var r=i[a].split("=");t[r[0]]=decodeURIComponent(r[1])}return t}t.openURL=i;t.params=a});define("module/sidebar/view",["tui/view","tui/browser","tui/art","tui/dialog","tui/util/url","tui/cookie","tui/scrollbar","module/domain","module/subscribe","module/responsive","module/login/login","module/stat/ck","module/stat/expose","module/global","tui/countdown","page/watch/model/local-record","page/watch/model/setting","page/watch/model/sublist","page/watch/model/rec-new","module/sidebar/recent-rec-panel","module/sidebar/curvefly"],function(e,t,i,a,n,r,s,o,l,c,u,d,f,h,m,p,g,v,b,w,_){var y=$(window);var k=$(document.body);var x=$("#gSilderNav");var S=y.height();var T=$.browser.msie&&parseInt($.browser.version)||0;var C=6==T;var I=false;var D=false;var L=false;var M="";var N=30;var E=34;var O=i.compile('<li data-sub="<%=item.userId%>" class="subtn">\n<a href="<%=$domain.url.main%>/home/_<%=item.userId%>/?from=gsidebar_rec" class="sub-item" data-pos="<%=index%>" title="<%=item.nickname%>"<% if (isPlayPage) { %> target="_blank"<% } %>>\n<span class="img"><img src="<%=item.userpic%>" /></span>\n<span class="sub-item-title"><%=item.nickname%></span>\n<b>æ¨è</b>\n</a>\n<div class="gbtn_sub gBtnSub" data-id="<%=item.userId%>"></div>\n</li>\n');var z=i.compile('<li data-act="album" data-group="1">\n<a href="<%=$domain.url.main%>/watch/subscribe/?type=album" class="sub-item sub-group sub-group-mv" data-role="pagex"<% if (isPlayPage) { %> target="_blank"<% } %>><span class="img"><i class="iconfont">&#xe645;</i></span>å§é\n<% if (count && count > 99) { %>\n<b class="p99" title="<%=count%>ä¸ªæ´æ°">99+</b>\n<% } else { %>\n<b><%=count || \'\'%></b>\n<% } %>\n<i class="iconfont">&#xe646;</i></a>\n</li>\n');var j=e.extend({tpl:i.compile('<li data-act="<%=item.id%>" data-type="<%=item.type%>" data-title="<%=item.title%>">\n<a href="<%=$domain.url.main%><% if (item.type == 1) { %>/watch/home/?id=<%=item.id%>&type=album<% } else { %>/home/_<%=item.id%>/?from=gsidebar&count=<%=item.updateCount%><% } %>" class="sub-item" title="<%=item.title%>"<% if (item.type == 1) { %> data-role="pagex"<% } %><% if (isPlayPage) { %> target="_blank"<% } %>><span class="img"><img<% if (type < 1 && index > 19) { %> src="http://css.tudouui.com/skin/__g/img/sprite.gif" data-src="<%=item.smallPic%>" <% } else { %> src="<%=item.smallPic%>"<% } %> /></span><% if (type == 1 && item._highlight) { %><%==item._title%><% } else { %><%=item.title%><% } %>\n<% if (item.updateCount && item.updateCount > 99) { %>\n<b class="p99" title="<%=item.updateCount%>ä¸ªæ´æ°">99+</b>\n<% } else { %>\n<b><%=item.updateCount || \'\'%></b>\n<% } %>\n<i class="iconfont">&#xe646;</i></a>\n</li>\n'),events:{"click #gSideEdit":"edit","click .cancel":"cancel","click .del":"unSub","click .img":"fixClick","click .icon-cancel":"empty","click li[data-order]":"sort","click #gSideSubSort":"toggleSort","click #gRecentTipsClose":"_closeRecentTips","mousedown li[data-act=sub]":"clearUpdateCount","mousedown #gSideSubItems .sub-item":"_updateLocal","mouseleave #gSideSubSort":"leaveSort","click .g-side-login .btn":"toLogin","mouseenter .view_all":"openMore","mouseleave .view_all":"closeMore","mouseenter #gSideMore":"closeClear","mouseleave #gSideMore":"closeMore","click #gSideMenu [data-role=pagex]":"toLogin"},openMore:function(){this.closeClear();this.$sidemo.addClass("g-sidemo-expand");this.find(".view_all").addClass("hover");var e=this.$sidemo.find("[data-act]").length;if(e<4)this.$sidemo.css({bottom:100});this.updateScrollbar();this.loadImg()},closeClear:function(){if(this.moretimer)clearTimeout(this.moretimer)},closeMore:function(){this.closeClear();this.moretimer=setTimeout(function(){this.$sidemo.removeClass("g-sidemo-expand");this.find(".view_all").removeClass("hover")}.bind(this),550)},showTips:function(){var e=+new Date;var t=1e3*60*24*60;var i=this;h.storage.getItem("gsidetip",function(a){if(!a){h.storage.setItem("gsidetip",e);i.initTip()}else if(e-a>t){h.storage.setItem("gsidetip",e);i.initTip()}})},initTip:function(){var e='<div class="g-side-tip" id="gSideTip"><a href="#" class="close">x</a><a href="http://gc.tudou.com/index.html" '+M+' class="c">å» å¹¿åº ééå§ï¼<br>è®¢éæä½ åæ¬¢çèªé¢éï¼</a><i class="ankle ak1"><i class="ankle ak2"></i></i></div>';var t=this;this.$manage.append(e);m("",5,function(){t.removeTips()});this.$manage.on("click",".close",function(e){e.preventDefault();t.removeTips()})},removeTips:function(){var e=this.find("#gSideTip");if(e.length)e.remove()},initialize:function(){var e=this;e.setElement($("#gSideBar"));e.$subs=e.find("#gSideSubs");e.$list=e.find(".g-subs-list");e.$items=e.find("#gSideSubItems");e.$group=e.find("#gSideSubGroup");e.$recom=e.find("#gSideRecom");e.$ritems=e.find("#gSideRecomItems");e.$scroll=e.find("#gSideSubScroll");e.$scrollList=e.find(".g-sidesub-scroll");e.$count=e.find("#gSideSubCount");e.$msg=e.find("#gSideSubMessage");e.$sort=e.find("#gSideSubSort");e.$sidemo=e.find("#gSideMore");e.$manage=e.find(".g-side-manage");e.$loading=e.find(".gSideloading");var i=window.config&&window.config.pageId||window.pageId||0;I=i>=1&&i<=8||701==i;L=300==i;D=I||t.isPad;M=I?'target="_blank"':"";if(!u.uid())k.addClass("g-sidebar-guest");else{e.$el.removeClass("g-sidebar-init");e.showTips()}e._initStat();u.bind("after:login",e.afterLogin.bind(e));y.bind("resize",e.resize.bind(e));e.resize();e.$scrollList.bind("scroll",e.loadImg.bind(e));e.model=new v;e.model.bind("sublist:change",e.change.bind(e));e.model.bind("sublist:data",e.render.bind(e));e.model.bind("subremoved",e.removeItem.bind(e));e.model.bind("subadded",e.addItem.bind(e));e.model.bind("unsubed",e.unSubed.bind(e));e.model.bind("resubed",e.reSubed.bind(e));e.recom=new b;e.recom.bind("getrec:success",e.renderRec.bind(e));var a=g.getItem("subListOrder");e.order=$.isNumeric(a)?a:1;e.$sort.find("[data-order="+e.order+"]").addClass("current");var n='<div class="g-top-cartoon"><i class="i2"></i><i class="i1"></i></div>';if(!k.hasClass("g-sidebar-hide")){e.isExpanded=true;c.padding=200;e.initLoad();x.addClass("active");n='<div class="g-top-cartoon"><i class="i3"></i><i class="i1"></i></div>'}e.isFitTop=k.hasClass("g-sidebar-top");e.updateNum();e._recentRecommend();l.globalEvent.bind("sub:success",e.gAddSub.bind(e));l.globalEvent.bind("unsub:success",e.gUnSub.bind(e));if(!D)y.bind("resize",e.fitTop.bind(e));if(!t.isMobile&&!e.scrollbar)e.scrollbar=new s(e.$scroll,{barMinSize:30});x.on("click",e.toggleShow.bind(e));k.on("mousedown",e.bodyClick.bind(e));if(k.width()>1250)e.cartoon(n)},cartoon:function(e){var t=x.offset();var i=$(e);k.append(i);setTimeout(function(){i.css({left:t.left+70,top:13})},250);setTimeout(function(){i.css({opacity:0})},1e4)},toggleShow:function(e){e.preventDefault();if(!this.isExpanded){this.show();this.expand();$(".g-top-cartoon").html('<i class="i3"></i><i class="i1"></i>')}else{this.fold();$(".g-top-cartoon").html('<i class="i2"></i><i class="i1"></i>')}},bodyClick:function(e){var t=$(e.target||e.srcElement);if(!t.hasClass("g_slidernav")&&!t.closest("#gSideBar").length&&k.hasClass("g-sidebar-top")&&this.isExpanded)this.fold()},initLoad:function(){this.isLoaded=true;if(u.uid())this.model.one("sublist:data",this._subCountReady.bind(this));else this._sendExpose();this.loadSub()},nav:function(e){var t=this.$list.eq(1);if(!e)return;var i=this.find('[data-act="'+e+'"]');if(i.length){this.find(".current[data-act]").removeClass("current");i.addClass("current")}var a=t.find('[data-act="'+e+'"]');if(a.length&&$.isNumeric(e)){var n=t.height();var r=t[0].scrollTop;var s=a.offset().top-t.offset().top;if(s>r+n)t[0].scrollTop=s}},afterLogin:function(){k.removeClass("g-sidebar-guest");this.isRecLoaded=false;this.$items.empty();this.$ritems.empty();this.updateNum();this.loadSub();this._recentRecommend();this.showTips()},render:function(e,t){e=0;t=t||this.renderData||[];this.renderData=t;this.renderType=e;var i=this;var a=this.model;var n=[],r=t.length;var s=a.getItemCount(1);var l=a.getItemCount(2);var c=Math.floor((y.height()-420)/E);c=s?c-1:c;c=c<1?1:c;i.mainCount=c;t=a.getItemsByType(2);r=t.length||0;if(r){var d=0;for(var f=0,h=r>c?c:r;f<h;f++)n.push(i.tpl({type:e||0,index:d++,item:t[f],isPlayPage:I}));this.renderGroup(true);if(r>c){n.push('<li class="view_all"><a href="'+o.url.main+'/watch/subscribe/"'+M+" >æ¥çå¨é¨&gt;&gt;</a></li>");this.renderMore(t.slice(c),s)}this.$loading.remove();this.$items.html(n.join(""));if(r<c){this.trigger("sublist:loaded",[r,s]);this.$scroll.empty();this.closeMore()}var m=c-l;if((s&&l<5||!s&&l<6)&&m>0)!this.isRecLoaded&&this.recom.fetch(m,u.uid())}else{!this.isRecLoaded&&this.recom.fetch(l,u.uid());this.$items.empty();this.$recom.addClass("g-side-nosub");this.find(".g-subs-title").hide();this.find(".g-subs-recom").show()}},renderMore:function(e,t){if(this.renderTimer)clearTimeout(this.renderTimer);var i=this;var a=e.length||0;var n=[],r=0;var s=i.mainCount+Math.floor(310/E);this.renderTimer=setTimeout(function(){for(var o=0,l=a;o<l;o++)n.push(i.tpl({type:0,index:r++,item:e[o],isPlayPage:I}));this.$scroll.html(n.join(""));if(r>=s)this.$scrollList.height(s*E);this.trigger("sublist:loaded",[a,t])}.bind(this),150)},renderRec:function(e){var t=[];var i=Math.floor((y.height()-420)/E);var a=e.length;if(a>i&&!u.uid())a-=2;for(var n=0;n<a;n++){if(this.model.getItemById(e[n].ownerId))continue;t.push(O({item:e[n],index:n,isPlayPage:I}))}if(this.$el.hasClass("g-sidebar-init"))this.$el.removeClass("g-sidebar-init");this.$loading.remove();this.$ritems.html(t.join(""));this.$recom.show();new l({box:this.$ritems,app:"watch",type:2,from:15,skin:3,disRecom:1});this.isRecLoaded=true},renderGroup:function(e){var t=this.model;if(t.getItemCount(1))if(e)this.$group.html(z({count:t.updateCount["album"],isPlayPage:I}));
else;else this.$group.empty()},change:function(e){var t=e.length;if(t){var i=this.model.getItemCount(1);var a=this.model.getItemCount(2);this.$items.find(".empty").remove();this.$sort[t>4?"show":"hide"]();if(this.isRecLoaded){if(this.$ritems.find(".subtn").size()<=1)this.$recom.hide();if(this.$recom.hasClass("g-side-nosub"))this.$recom.removeClass("g-side-nosub")}}else if(this.isRecLoaded)this.$recom.addClass("g-side-nosub");else if(!this.$items.find(".empty").get(0))this.$items.append('<li class="empty">æ²¡æè®¢éé¢é</li>');this.renderGroup(true);this.trigger("sublist:update")},loadImg:function(){var e=this.$scrollList;var t=this.find("#gSideSubScroll");var i=this.$group.find("[data-group]").size();if(this.lazyTimer)clearTimeout(this.lazyTimer);this.lazyTimer=setTimeout(function(){var a=e[0].scrollTop;var n=e.height();var r=t.find("li[data-act]").outerHeight();for(var s=Math.floor(a/r);s<Math.ceil((a+n)/r);s++){var o=t.find("img").eq(s-i);var l=o.attr("data-src");if(l){o.removeAttr("data-src");o.attr("src",l)}}},50)},loadSub:function(){var e=this.order;var t=this.model;var i=this.recom;var a=Math.floor((y.height()-470)/E);if(a<1)return;u.isLogin2(function(n){if(n)t.fetch(e,99);else i.fetch(a||8,u.uid())})},fitTop:function(){var e=L?1140:1252;var t=this;var i=y.width();if(t._fitTimer)clearTimeout(t._fitTimer);t._fitTimer=setTimeout(function(){if(i<e&&!t.isFitTop){t.isFitTop=true;t.fold();k.addClass("g-sidebar-top")}if(i>=e&&t.isFitTop){t.show();t.isFitTop=false;t.expand();k.removeClass("g-sidebar-top")}},200)},show:function(e){if(!this.isLoaded){this._expose.eventType=2;this.initLoad()}},expand:function(){this.isExpanded=true;k.removeClass("g-sidebar-hide");x.addClass("active");if(!D){c.padding=200;c.check()}},fold:function(){this.isExpanded=false;k.addClass("g-sidebar-hide");x.removeClass("active");if(!D){c.padding=0;c.check()}},resize:function(){var e=this;if(e._resizeTimer)clearTimeout(e._resizeTimer);e._resizeTimer=setTimeout(function(){e.updateHeight()},100)},sort:function(e){var t=$(e.target);var i=parseInt(t.attr("data-order")||0);if(i==this.order)return;t.parents("ul").find("li").removeClass("current");t.addClass("current");g.setItem("subListOrder",this.order=parseInt(i));this.loadSub()},toggleSort:function(e){if(this.$sort.hasClass("hover"))this.$sort.removeClass("hover");else this.$sort.addClass("hover")},leaveSort:function(){this.$sort.removeClass("hover")},edit:function(e){var t="g-subs-del";var i=this.$subs.hasClass(t);this.$subs[i?"removeClass":"addClass"](t);e.preventDefault()},unSub:function(e){e.preventDefault();var t=e.target;var i=$("a"==t.nodeName.toLowerCase()?t:t.parentNode);var a=i.attr("data-type");var n=i.attr("data-id");this.model.unSub(n,a);if(this._timer&&this._timerCallback){clearTimeout(this._timer);this._timerCallback()}},cancel:function(e){e.preventDefault();if(this._timer){clearTimeout(this._timer);this._timer=this._timerCallback=null}var t=$(e.target);var i=t.attr("data-id");var a=t.attr("data-type");this.model.reSub(i,a)},unSubed:function(e,t,i){var a=this;var n=a.find('[data-act="'+e+'"]');n.slideUp(200);if(!i)this.$msg.html('æååæ¶è®¢é<a href="#" class="cancel" title="æ¤é" data-id="'+e+'" data-type="'+t+'">æ¤é</a>').slideDown(200);this._timerCallback=function(){a._timer=a._timerCallback=null;!i&&a.$msg.slideUp(200).empty();n.remove();a.mv2Main()};this._timer=setTimeout(this._timerCallback,700)},reSubed:function(e,t,i){var a=this;if(this._timer){clearTimeout(this._timer);this._timer=this._timerCallback=null}if(!i)this.$msg.slideUp(200);this.find('[data-act="'+e+'"]').slideDown(200)},gAddSub:function(e,t,i){this.model.addSub(e.subId,e.type);if(!this.isExpanded)this.gSubFly(i)},gUnSub:function(e){this.model.removeSub(e.subId,e.type)},gSubFly:function(e){var t=x.offset();var i=t.left+8;var a=t.top;var n=e.offset();var r=n.left;var s=n.top-4;if(D)_.create(r,s,i,a,null,18).start();else _.create(r,s,i,a).start()},addItem:function(e,t){if(2!=t){this.addGroupItem(t);return}var i=this;var a=this.get("app");var n=a&&a.params&&a.params.id||0;var r=$(i.tpl({type:0,index:0,item:e,isPlayPage:I}));if(n==e.id)r.addClass("current");r.addClass("added").hide();i.mv2Sub();r.prependTo(this.$items);if(T&&T<8)r.fadeIn(200);else r.slideDown(200);this.$recom.find("li[data-sub="+e.id+"]").remove();setTimeout(function(){r.removeClass("added")},6e3)},mv2Sub:function(){var e=this.$items;var t=e.find("li");var i=e.find(".view_all").length;var a=t.eq(t.length-(i?2:1));var n=this.$scroll;var r=this.$ritems.find("li");var s=r.length;if(s)r.eq(0).remove();if(1==s)this.$recom.empty();if(t.length<this.mainCount||s>0)return;if(!i)e.append('<li class="view_all"><a href="'+o.url.main+'/watch/subscribe/" '+M+">æ¥çå¨é¨&gt;&gt;</a></li>");n.prepend(a.show())},mv2Main:function(){var e=this.$list.eq(1).find("li");var t=e.eq(0);if(e.length<=0)this.$list.find(".view_all").remove();if(this.$list.eq(0).find("li").length>this.mainCount)return;if(e.length)this.$list.eq(0).find(".view_all").before(t)},addGroupItem:function(e){var t=this.$group.find("[data-group="+e+"]");t.addClass("added");this.$list.get(0).scrollTop=0;setTimeout(function(){t.removeClass("added")},6e3)},removeItem:function(e,t){var i=this;var a=this.$list.find("li[data-act="+e.id+"]");a.slideUp(200,function(){a.remove();i.mv2Main()})},updateHeight:function(){if(Math.abs(y.height()-S)<2*E||this.isRecLoaded)return;this.render();S=y.height()},updateScrollbar:function(){if(!t.isMobile&&this.scrollbar)this.scrollbar.update()},updateNum:function(){var e=this;u.isLogin2(function(t){if(t)$.getJSON(o.url.main+"/watch/sub/totalUpdateCount.do?jsoncallback=?",{uid:u.uid()},function(t){e._updateCountReady(t&&t.data||0);if(t&&t.data){e.$count.html(t.data>99?"99+":t.data).show();x.append('<em class="dot"></em>');e.trigger("getUpdateCount:success",[t])}})})},clearUpdateCount:function(){this._updateCount=0;this.$count.hide().empty();x.find(".dot").remove()},expose:function(e,t){if(e&&t){this.model.expose(e,t);this.$list.find("li[data-act="+t+"] b").empty()}else if(e){this.model.expose(e);this.$list.find("li[data-group="+e+"] b").empty()}},fixClick:function(e){var t=T&&T<8;if(!t)return;var i=$(e.target).parents("a");window.location.replace(i.attr("href"))},toLogin:function(e){var t=$(e.target).closest("li");var i=t.attr("data-act");var a=t.find("a");var r=a.attr("href");var s=u.uid();if(!t.length){e.preventDefault();u.needLogin();return}if(!s&&"sub"==i){e.preventDefault();u.needLogin(function(){if(r&&r.length>5)n.openURL(r,a.attr("target")||"")});return}if(0!=window.location.pathname.indexOf("/watch"))n.openURL(r,a.attr("target")||"")},_recentRecommend:function(e,t){if(u.uid()&&location.href.indexOf("/watch/")>-1){this.recPanel=new w;this.recPanel.bind("suball:success",this._recentAllSubed.bind(this));if(!this.isLoaded){this._expose.eventType=2;this.initLoad()}}},_closeRecentTips:function(e){e.preventDefault();this.find(".g-recent-subtips").remove();this.$list.find(".added").removeClass("added")},_recentAllSubed:function(e){var t=this;setTimeout(function(){t.model.index(e,true);t.change(e);e.forEach(function(e){t.addItem(e,e.type)});t.$subs.append('<div class="g-recent-subtips"><a href="#" id="gRecentTipsClose">ç¥éå¦</a></div>');t.trigger("recentallsubed")},300)},_initStat:function(){var e=this;e._expose=new f(e.$el);e._expose.addData(function(){return e._getExtData()});d.tudouClickStat.addData(function(){return e._getExtData()})},_getExtData:function(){return{etype:this._expose&&this._expose.eventType||1,subCount:this.model&&this.model.getItemCount()||0,updateCount:this._updateCount||0}},_sendExpose:function(){var e=this;if(e._expose.isSent)return;u.isLogin2(function(t){if(t){if(e._updateCountLoaded&&e._subCountLoaded)e._expose.send()}else e._expose.send()})},_subCountReady:function(){this._subCountLoaded=true;this._sendExpose()},_updateCountReady:function(e){this._updateCountLoaded=true;this._updateCount=e||0;this._sendExpose()},_updateLocal:function(e){var t=$(e.currentTarget).closest("li");var i=parseInt(t.attr("data-act")||0);var a=parseInt(t.attr("data-type")||0);var n=t.attr("data-title")||"";p.add(i,{type:a,title:n},2)},_sendLocalStat:function(){},_recUserClick:function(e){e&&e.preventDefault();var t=$(e.currentTarget);var i=t.attr("href");var a=t.attr("data-pos");var r=t.attr("target")||"";this.recom.userClick(a);n.openURL(i,r)}});i.helper("$domain",o);function U(e,t,i){e||(e={});var a=document.createDocumentFragment("div");a.id=t;e.target=a;e.pageX=0;e.pageY=0;window.tudouClickStat.send(e,i||{},function(){},true)}j.init=function(){if($("#gSideBar")[0])return j.create("gsidebar");return null};j.get=function(){var e=j.instance("gsidebar");return e||this.init()};return j});define("module/uicommon",["tui/browser","tui/util/url"],function(e,t){return function(){if(!e.isPad&&!e.isMobile)$(document.body).delegate(".pack .pic,.packs","mouseenter",function(){var e=$(this);var t=e.hasClass("packs")?e:e.closest(".pack");var i=t.find(".caption a");if(t.hasClass("disable"))return;var a=t.attr("class").split(" ");var n="packs packs_plist packs_plist2 pack_albums pack_albums2";var r="pack_hover";a[0]&&a.forEach(function(e){if(""!=$.trim(e)&&new RegExp(e+"\\b").test(n)){r="pack_hover packs_hover";t.find(".txt, .info").attr({"data-stat-role":"ck","data-stat-href":i.attr("href")})}});t.attr({"data-stat-role":"ck","data-stat-href":i.attr("href")});t.addClass(r)}).delegate(".pack","mouseleave",function(){$(this).removeClass("pack_hover packs_hover")}).delegate(".packs_hover","click",function(e){if("a"!=e.target.nodeName.toLowerCase()){var i=$(this);var a=i.find(".caption a");a[0]&&t.openURL(a.attr("href"),a.attr("target"))}})}});define("tui/easing",[],function(e,t){jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,i,a,n){return jQuery.easing[jQuery.easing.def](e,t,i,a,n)},easeInQuad:function(e,t,i,a,n){return a*(t/=n)*t+i},easeOutQuad:function(e,t,i,a,n){return-a*(t/=n)*(t-2)+i},easeInOutQuad:function(e,t,i,a,n){if((t/=n/2)<1)return a/2*t*t*t+i;return a/2*((t-=2)*t*t+2)+i},easeInBack:function(e,t,i,a,n,r){if(void 0==r)r=1.70158;return a*(t/=n)*t*((r+1)*t-r)+i},easeOutBack:function(e,t,i,a,n,r){if(void 0==r)r=1.70158;return a*((t=t/n-1)*t*((r+1)*t+r)+1)+i},easeOutBounce:function(e,t,i,a,n){if((t/=n)<1/2.75)return a*7.5625*t*t+i;else if(t<2/2.75)return a*(7.5625*(t-=1.5/2.75)*t+.75)+i;else if(t<2.5/2.75)return a*(7.5625*(t-=2.25/2.75)*t+.9375)+i;else return a*(7.5625*(t-=2.625/2.75)*t+.984375)+i}})});define("tui/flyin",[],function(){return function(e,t){var i=$(e.source);var a=$(e.target);var n=e.pos||{left:0,top:0};var r=e.duration||300;var s=e.easing||"linear";if(e.target)n=a.offset();var o=i.clone();$(document.body).append(o);if(e.className)o.addClass(e.className);var l=i.offset();l.position="absolute";l.width=i.width();l.height=i.height();l.zIndex=9999;o.css(l);var c={opacity:e.opacity||1,left:n.left,top:n.top};if(void 0!==e.opacity)c.opacity=true===e.opacity?0:e.opacity;if(void 0!==e.width)c.width=true===e.width?a.width():e.width;if(void 0!==e.height)c.height=true===e.height?a.height():e.height;o.animate(c,r,s,function(){o.remove();t&&t()})}});define("page/btn/btn",["module/domain","module/global","tui/art","tui/cookie","module/login/login","tui/view","tui/util/url","module/subscribe","tui/flyin","tui/easing"],function(e,t,i,a,n,r,s,o,l){if(true===window.NO_GLOBAL_POSITION_BTN)return;var c=$(window);var u=0;var d=$.browser.msie&&parseInt($.browser.version)<7;var f=null;var h="watchcenternum";var m="watchcentertime";var p=$(document.body);var g=r.extend({subDetailTpl:'<div class="hd">\n<i class="iconfont">&#xe637;</i><span>æçè®¢é</span>\n<a href="#" class="sub_close"><i class="iconfont">&#xe63f;</i></a>\n</div>\n<div class="bd">\n<div class="sub_list">\n<%if(!!subNum){%>\n<div class="loading"></div>\n<!-- <p class="noupdate">ä½ è®¢éçé¢éææ æ´æ°</p> -->\n<%}%>\n</div>\n</div>\n<div class="ft">\n<a class="sub_more" href="<%=domain.domain.main%>/watch/subscribe" target="_blank">\n<%if(!!subNum){%>\næ¥çå¨é¨ <span class="sub_totalnum"></span>\n<%}else{%>\n<span class="sub_more_big">æ¥çæçè®¢é</span>\n<%}%>\n</a>\n</div>\n',subDetailListTpl:'<ul>\n<%list.forEach(function(o, i){%>\n<li class="sub_item<%if(o.type==1){%> sub_item_album<%}%>">\n<div class="sub_icon">\n<%if(o.type === 1){%>\n<a href="<%=getUrl(o.type, o.code)%>" target="_blank"><img src="<%=o.pic%>" /></a>\n<%}else{%>\n<a href="<%=getUrl(o.type, o.id)%>" target="_blank"><img src="<%=o.pic%>" /></a>\n<%}%>\n</div>\n<div class="sub_con">\n<%if(o.type === 1){%>\n<a href="<%=getUrl(o.type, o.code)%>" target="_blank" class="sub_title"><%=o.title%></a>\n<%}else{%>\n<a href="<%=getUrl(o.type, o.id)%>" target="_blank" class="sub_title"><%=o.title%></a>\n<%}%>\n<p><%if(o.lastItem){%><a href="<%=o.lastItem.playLink%>" target="_blank"><%=o.lastItem.title%></a><%}%></p>\n</div>\n<div class="update_num"><span><%=o.updateCount%></span>ä¸ªæ´æ°</div>\n</li>\n<%});%>\n</ul>',initialize:function(){var e=this;e.bWith=980;var t=e.appObj={};p.append(e.$el);e.subNum=0;e.isSubOpen=false;e.lastCloseSubNum=0;e.resize();c.bind("resize",function(){var t=c.width();if(u==t)return;u=t;e.resize()});if(d)c.bind("scroll",e.resize.bind(e));c.bind("scroll",i);i();function i(){var e=c.scrollTop();var i=c.height();for(var a in t){var n=t[a].scroll;if($.isFunction(n))n.call(t[a],e,i)}}},bodyWith:function(e){this.bWith=e;u=0;this.resize()},resize:function(){var e=this;var t=c.width();var i=e.appObj;for(var a in i){var n=i[a].resize;if($.isFunction(n))n.call(i[a],t,e.bWith)}if(d){var r=c.scrollTop()+c.height();var s=e.$el;s.css("top",r-s.height()-80)}},add:function(e,t){var i=this;if(i.appObj[e])return;i.appObj[e]=t;var a=t.$el=$(t.el);if(t.click)a.click(function(e){e.preventDefault();t.click.call(t)});i.$el[t.method?t.method:"prepend"](a);if(true==t.autoRun)t.click.call(t);return t},get:function(e){return this.appObj[e]||this.appObj},ewm:function(e,t){},showSub:function(){var e=this;var t=e.lastCloseSubNum!=e.subNum;$(".watchcenter",e.$el).addClass("watchcenter_hide");if(!e._subDetail){e._subDetail=$('<div class="sub_detail sub_panel" id="subDetail" />').appendTo(e.$el);e._renderSub()}e.$subList=$(".sub_list",e._subDetail);e._subDetail.slideDown(function(){if(!!e.subNum&&t){e.$subList.html('<div class="loading" />');e.loadSubList()}});e.isSubOpen=true},hideSub:function(e){var t=this;e.preventDefault();t.isSubOpen=false;t.lastCloseSubNum=t.subNum;$(".sub_panel",t.$el).slideUp();$(".watchcenter",t.$el).removeClass("watchcenter_hide")},gotoWatchCenter:function(t){var i=this;t&&t.preventDefault();if(!n.uid())n.needLogin(function(){});else s.openURL(e.domain.main+"/watch/subscribe","_blank")},showSubedContent:function(){var e=this;var t=$(".watchcenter",e.$el);var i=t.offset().left;var a=t.offset().top;var n=$('<div id="sub_success" class="sub_success"><i class="iconfont">&#xe647;</i><span>è®¢éæå</span></div>').appendTo(t);t.removeClass("watchcenter_hide");$("#sub_success").slideDown();setTimeout(function(){$("#sub_success").slideUp(function(){$(this).remove()})},3e3)},_renderSub:function(){var t=this;var a=i.compile(t.subDetailTpl)({subNum:t.subNum,domain:e});t._subDetail.html(a)},updateSub:function(){var e=this;var i=5*1e3*60;var a=v.get("watchcenter").$el;t.storage.getItem(h,function(t){if(t&&parseInt(t)){e.subNum=parseInt(t);e._updateSubNum(t)}});t.storage.getItem(m,function(a){var n=+new Date;a=a||0;a=parseInt(a);if(n>a+i){t.storage.setItem(m,n);e.loadSub()}});f=setTimeout(e.updateSub.bind(e),i)},loadSub:function(){var i=this;var a=v.get("watchcenter").$el;$.getJSON(e.domain.main+"/watch/sub/totalUpdateCount.do?jsoncallback=?",{uid:n.uid()},function(e){if(!e.code){i.subNum=e.data;t.storage.setItem(h,e.data);a.find("b").remove();i._updateSubNum(e.data);if(e.data)i.autoOpen();i.trigger("getUpdateCount:success",[e])}},"jsonp")},loadSubList:function(){var t=this;var a=null;var r=[];var s=[];var o;$.getJSON(e.domain.main+"/watch/sub/updateListLastItem.do?jsoncallback=?",{uid:n.uid(),start:0,end:10,base:false,itemShowType:1},function(e){if(e&&e.data){$.each(e.data,function(e,t){if(1==t.type&&t.updateCount)a=t;if(2==t.type&&t.updateCount)r.push(t)});if(a){s=s.concat(r.slice(0,2));s.push(a)}else s=r.slice(0,3);o=i.compile(t.subDetailListTpl)({list:s,getUrl:t._getWatchCenterUrl});t.$subList.html(o)}},"jsonp")},_updateSubNum:function(e){var t=this;var i=v.get("watchcenter").$el;if(e){i.append("<b>"+(e>99?"...":e)+"</b>");i.attr("title",e+"ä¸ªæ°è§é¢")}},_getWatchCenterUrl:function(t,i){var a=e.domain.main+"/home/_"+i+"/";if(1==t)a=e.domain.main+"/albumcover/"+i+".html";return a},autoOpen:function(){var e=this;if(!+a("_sub_autoopen")&&!e.hasAutoOpen){e.showSub();a("_sub_autoopen",1,{domain:"tudou.com",path:"/",expires:1})}e.hasAutoOpen=true},shakeInit:function(e,t,i,a,n){var r=this;r.shakeObj=e;r.shakeLeft=parseInt(e.css("left"));r.shakeBottom=parseInt(e.css("bottom"));r.shakeRate=t;r.shakeRange=a;r.shakeSpeed=i;r.shakeRangeTime=n;r.shakeTime=null;r.shakeState=0;r.shakeStart()},shakeStart:function(){var e=this;if(0==e.shakeState&&!d){e._shakeStart();e.shakeState=1}else;setTimeout(function(){e.shakeStop()},e.shakeRangeTime)},_shakeStart:function(){var e=this;if(parseInt(e.shakeObj.css("left"))==e.shakeLeft-e.shakeRange){e.shakeObj.css("bottom",e.shakeBottom+1);setTimeout(function(){e.shakeObj.css("left",e.shakeLeft+e.shakeRange)},e.shakeRate)}else{e.shakeObj.css("bottom",e.shakeBottom-1);setTimeout(function(){e.shakeObj.css("left",e.shakeLeft-e.shakeRange)},e.shakeRate)}e.shakeTime=setTimeout(function(){e._shakeStart()},e.shakeSpeed)},shakeStop:function(){var e=this;clearTimeout(e.shakeTime);e.shakeState=0;setTimeout(function(){e.shakeObj.css("left",e.shakeLeft);e.shakeObj.css("bottom",e.shakeBottom);$(".sub_panel",e.$el).hide();$(".watchcenter",e.$el).addClass("watchcenter_hide");e.showSubedContent()},100)},addEffect:function(e,t){if(this.isHideSub())return;var i=this;var a=i.get("watchcenter").$el;var n=1==e.type?"album":"home";var r=1==e.type?t.p_s_s:t.userpic;if(!this.isSubOpen){p.addClass("subing");var s=$('<div class="sub_imgwrap" />').appendTo(p);var o=$('<img src="'+r+'" class="sub_img_'+n+'" />').appendTo(s).css({top:a.offset().top-300}).load(function(){l({source:o,target:a,duration:800,easing:"easeOutBounce"},function(){s.remove();p.removeClass("subing")})})}setTimeout(function(){i.shakeInit(a,20,70,3,500)},300)},isHideSub:function(){return window.pageId>=2e3||8==window.pageId}});var v=new g({id:"gBtn",className:"gbtn"});function b(e,t){if(e>t)this.$el.addClass("ttop_show");else this.$el.removeClass("ttop_show")}v.add("goTop",{el:'<a href="#" class="btn ttop" title="è¿åé¡¶é¨"><i class="iconfont">&#xe641;</i>è¿åé¡¶é¨</a>',scroll:b,click:function(){$(window).scrollTop(0)}});v.add("help",{el:'<a href="'+e.url.main+'/service/feedback/" target="_blank" class="btn help" title="å¸®å©åé¦"><i class="iconfont">&#xe60f;</i><span>å¸®å©åé¦</span></a>'});return v});define("page/watchlater/tip",["tui/template"],function(e,t){return function(t,i){var a='<table class="tui_mesbox">\n<tbody>\n<tr>\n<td class="round left_top"></td>\n<td class="line top"></td>\n<td class="round right_top"></td>\n</tr>\n<tr>\n<td class="line left"></td>\n<td class="center">\n<div class="container">\n<ul id="globalNotifier">\n<li><%=msg%></li>\n</ul>\n<a href="#" class="close"></a>\n</div>\n</td>\n<td class="line right"></td>\n</tr>\n<tr>\n<td class="round left_bottom"></td>\n<td class="line bottom"></td>\n<td class="round right_bottom"></td>\n</tr>\n</tbody>\n</table>',n=$(e.convertTpl(a,{msg:i}));n.css({left:t.offset().left,top:t.offset().top,zIndex:9e3});n.find(".close").click(function(e){e.preventDefault();n.fadeOut(function(){n.remove()})});$(document.body).append(n);setTimeout(function(){n.fadeOut(function(){n.remove()})},2e3)}});define("module/ui/scrollbar",["tui/event","tui/drag"],function(e,t){var i=e.extend({initialize:function(e,a){var n=this;i.superClass.initialize.apply(n,arguments);n.target=e;n.targetParent=e.parent();n.bar=a;n.barParent=a.parent();var r=new t(n.bar,{limit:true});r.bind("drag:move",function(e,t){n.scrollTop(t)});n.targetParent.bind("scroll",function(e){n.updateBarTop()});n.targetParent.trigger("scroll");n.update();if($.browser.mozilla)n.targetParent[0].addEventListener("DOMMouseScroll",function(e){e.preventDefault();n.targetParent[0].scrollTop+=e.detail>0?60:-60},false);else n.targetParent[0].onmousewheel=function(e){e=e||window.event;n.targetParent[0].scrollTop+=e.wheelDelta>0?-60:60;e.returnValue=false;return false}},updateBarTop:function(){var e=this.targetParent.scrollTop()*this.barParent.height()/this.target.height();this.bar.css("top",e?e:0)},scrollTop:function(e){var t=Math.floor(e*this.target.height()/this.barParent.height());this.targetParent.scrollTop(t?t:0)},update:function(){this.barParent.parent().show();var e=this.target.height(),t=this.targetParent.height(),i=this.barParent.height();if(e>t){this.bar.css("height",Math.floor(t*i/e));this.updateBarTop()}else this.hide()},hide:function(){this.barParent.parent().hide()}});return i});define("module/common",["tui/template","module/domain"],function(e,t){var i=t.url;var a={getProgramUrl:function(e,t){if("string"!==typeof e)return"";var a=i.main+"/programs/view/"+e+"/";if($.isPlainObject(t))a=a+"?"+$.param(t);return a},getPlaylistUrl:function(e,t,a){if("string"!==typeof e)return"";if($.isPlainObject(t)){a=t;t=""}var n=i.main+"/listplay/"+e;if(t)n=n+"/"+t;n+=".html";if($.isPlainObject(a))n=n+"?"+$.param(a);return n},getPlayalbumUrl:function(e,t,a){if("string"!==typeof e)return"";if($.isPlainObject(t)){a=t;t=""}var n=i.main+"/albumplay/"+e;if(t)n=n+"/"+t;n+=".html";if($.isPlainObject(a))n=n+"?"+$.param(a);return n},getUserHomeUrl:function(e){return i.main+"/home/"+e},parseUrl:function(e){var t=e.match(/\/(view|listplay|albumplay|oplay)\d?\/([\w-]{11})(\/([\w-]{11}))?/);var i,a;if(!t){t=e.match(/playlist\/p\/l(\d+)(i(\d+))?\.html/);if(t)return{type:"list",lid:t[1],iid:t[3]};t=e.match(/playlist\/p\/a(\d+)(i(\d+))?\.html/);if(t)return{type:"album",aid:t[1],iid:t[3]};t=e.match(/albumcover\/([\w-]{11})/);if(t)return{type:"albumcover",acode:t[1]};t=e.match(/playlist\/id\/(\d+)/);if(t)return{type:"listcover",lid:t[1]};return{type:"",code:""}}i={view:"program",listplay:"list",albumplay:"album",oplay:"other"}[t[1]];a={type:i,icode:"program"==i?t[2]:t[4]||""};if("list"==i)a.lcode=t[2];else if("album"==i)a.acode=t[2];return a}};a.getPlayOtherUrl=a.getPlayalbumUrl;return a});define("tui/util",["tui/util/date","tui/util/num","tui/util/str","tui/util/url"],function(e,t,i,a){return $.extend({},e,t,i,a)});define("module/stat/jserror",["tui/net","module/global"],function(e,t,i,a){var n=encodeURIComponent;var r=n(location.href);var s=n(navigator.userAgent);var o=window.ERROR_RAND||.01;var l={};var c=function(i,a,c){if(!c)i="custom: "+i;a=a||o;if(Math.random()<a){if(l[i])return;e.getRequest("http://stats.tudou.com/e/page/js/fail/?v=1&s="+[n(i),r,t.juid+"_"+t.uid,s].join("|"));l[i]=true}};c.addVersion=function(e){r=n(e+":"+location.href)};if(Math.random()<o)window.onerror=function(e){setTimeout(function(){c(e,1,true)},0)};return c});define("page/watchlater/model",["module/login/login","module/domain","tui/event","module/global","module/stat/jserror"],function(e,t,i,a,n){var r="watchlater",s="watchlaterlocal",o="watchlaterfirst",l=7==window.pageId?"watchlater":"wlbar",c=i.extend({initialize:function(){c.superClass.initialize.apply(this,arguments);this.setFirst=false},loadLocal:function(e){var t=this;a.storage.getItem(r,function(t){t=t||null;try{t=JSON.parse(t)}catch(i){throw new Error("[V3] userData behavior error");t=null}if($.isFunction(e))e(t)});return this},loadRemote:function(e,i,a){var n=this;i=i||[];i=i.map(function(e){return{icode:e.icode,acode:e.acode,watched:e.watched,ct:e.ct}});if($.browser.msie&&parseInt($.browser.version)<8&&i.length>5)i.splice(5,i.length-5);$.ajax({url:t.domain.main+"/watchlater/srv/merge2.html?jsoncallback=?",dataType:"jsonp",data:{infos:JSON.stringify(i),app:l},scriptCharset:"utf-8",success:function(t){if(1==t.status){if($.isFunction(e))e(t.data)}else if($.isFunction(a))a(t)}})},addLocal:function(e,t){n("watchlater_local");var i=this;if("array"!=$.type(e))e=[e];i.loadLocal(function(a){a=a||[];var n={},r={},s={},o={},l={};var c=[];a.forEach(function(e){if(3==e.type)n[e.type+e.icode+"~"+e.lcode]=true;else if(2==e.type)n[e.type+e.lcode]=true;else if(1==e.type||e.acode)n[e.type+e.acode]=true;else n[e.type+e.icode]=true});for(var u=0,d=e.length;u<d;u++)if(3==e[u].type){if(!o[e[u].icode+"~"+e[u].lcode]&&!n[e[u].type+e[u].icode+"~"+e[u].lcode]){o[e[u].icode+"~"+e[u].lcode]=true;c.push(e[u])}}else if(2==e[u].type){if(!s[e[u].lcode]&&!n[e[u].type+e[u].lcode]){s[e[u].lcode]=true;c.push(e[u])}}else if((2==e[u].type||e[u].acode)&&!n[e[u].type+e[u].acode]){if(!l[e[u].acode]){l[e[u].acode]=true;c.push(e[u])}}else if(!r[e[u].icode]&&!n[e[u].type+e[u].icode]){r[e[u].icode]=true;c.push(e[u])}if(c.length){a=a.concat(c);i.saveLocal(a,function(){if($.isFunction(t))t(c,a)})}else if($.isFunction(t))t(c,a)});return i},addRemote:function(e,i,a){n("watchlater_remote");var r=this;if("array"!=$.type(e))e=[e];e=e.map(function(e){return{type:e.type||"0",icode:e.icode,acode:e.acode,lcode:e.lcode,watched:e.watched}});$.getJSON(t.domain.main+"/watchlater/srv/add.html?jsoncallback=?",{infos:JSON.stringify(e),app:l},function(e){if(1==e.status){if($.isFunction(i))i(e.data.add,e.data.all)}else if($.isFunction(a))a(e)},"jsonp");return r},saveLocal:function(e,t){try{e=JSON.stringify(e);a.storage.setItem(r,e,t)}catch(i){throw new Error("[V3] userData behavior error")}return this},delLocal:function(e,t){var i=this;if("array"!=$.type(e))e=[e];i.loadLocal(function(a){a=a||[];var n=a.length,r=a.map(function(e){return e.icode}),s=a.map(function(e){return e.acode}),o=a.map(function(e){return e.lcode});for(var l=0,c=e.length;l<c;l++){var u=e[l];if(3==u.type)a.forEach(function(e,t){if(3==e.type&&e.lcode==u.lcode&&e.icode==u.icode)a.splice(t,1)});else if(2==u.type)a.forEach(function(e,t){if(2==e.type&&e.lcode==u.lcode)a.splice(t,1)});else if(1==u.type||u.acode)a.forEach(function(e,t){if(1==e.type||e.acode==u.acode)a.splice(t,1)});else a.forEach(function(e,t){if(e.icode==u.icode&&(0===e.type||!e.lcode&&!e.acode))a.splice(t,1)})}if(a.length<n)i.saveLocal(a,function(){if($.isFunction(t))t(a)});else if($.isFunction(t))t(a)});return i},delRemote:function(e,i,a){var n=this;if("array"!=$.type(e))e=[e];e.forEach(function(t){if("undefined"==typeof t.type)if(e.acode)e.type=1;else e.type=0});$.getJSON(t.domain.main+"/watchlater/srv/clear.html?jsoncallback=?",{infos:JSON.stringify(e),app:l},function(e){if(1==e.status){if($.isFunction(i))i(e.data)}else if($.isFunction(a))a(e)},"jsonp");return n},clearLocal:function(e){var t=this;a.storage.removeItem(r,function(){if($.isFunction(e))e()});return t},clearBackUp:function(e){var t=this;a.storage.removeItem(s,function(){if($.isFunction(e))e()});return t},clearRemote:function(e){var i=this;$.getJSON(t.domain.main+"/watchlater/srv/clearAll.html?jsoncallback=?",{app:l},function(t){if(1==t.status)if($.isFunction(e))e()},"jsonp");return i},backUpLocal:function(e){var t=this;t.loadLocal(function(t){t=t||[];a.storage.setItem(s,t,function(){if($.isFunction(e))e(t)})});return t},loadBackUp:function(e){var t=this;a.storage.getItem(s,function(t){t=t||null;try{t=JSON.parse(t)}catch(i){throw new Error("[V3] userData behavior error");t=null}if($.isFunction(e))e(t)});return t},clearBackUp:function(e){a.storage.removeItem(s,e);return this},saveBackUp:function(e,t){a.storage.setItem(s,e,t);return this},first:function(e){var t=this;if("function"==$.type(e))a.storage.getItem(o,function(i){e(i||t.setFirst)});else a.storage.setItem(o,e)}});return c});define("page/watchlater/gmodel",["module/login/login","page/watchlater/model","module/global","module/domain","tui/util"],function(e,t,i,a,n){var r=3e3,s=t.extend({initialize:function(){s.superClass.initialize.apply(this,arguments);this.isLogin=false;this.interval=null;this.cache=[];this.hasInit=false;this.hasLoad=false;this.queue=[];return this},checkLocal:function(e,t){var i=this;return i.check(e,t,function(e){i.trigger("localdata",[e])})},check:function(e,t,i){var a=this;if(e&&e.length){var n={},r={},s={},o={};t.forEach(function(e){if(3==e.type)o[e.icode+"~"+e.lcode]=true;else if(2==e.type)s[e.lcode]=true;else if(1==e.type||e.acode)n[e.acode]=true;else r[e.icode]=true});t=[];e.forEach(function(e,i){if(3==e.type){if(!o[e.icode+"~"+e.lcode])t.push(e)}else if(2==e.type){if(!s[e.lcode])t.push(e)}else if(1==e.type||e.acode){if(!n[e.acode])t.push(e)}else if(!r[e.icode])t.push(e)});if(t.length&&i)i(t)}return a},importLocal:function(e){var t=this;return t.addRemote(e,function(e,i){t.saveBackUp([]);t.trigger("add:success",[e,i])})},del:function(t){var i=this;if("array"!=$.type(t))t=[t];t.forEach(function(e){if("r2RoS3IieCM"==e.icode&&!e.acode&&!e.lcode){i.setFirst=true;i.first(true)}});if(e.isLogin())i.delRemote(t,function(e){i.saveLocal(e,function(a){i.cache=e;i.trigger("del:success",[t,e])})},function(e){i.trigger("del:fail",[e])});else i.delLocal(t,function(e){i.cache=e;i.trigger("del:success",[t,e])});return i},add:function(t){var i=this,a=i.max();if(i.cache&&i.cache.length>=a){i.trigger("add:fail",[t,"è¶è¿ç¹æ­åä¸é"]);return}if("array"!=$.type(t))t=[t];t.forEach(function(e){if("undefined"==typeof e.type)if(e.acode)e.type=1;else e.type=0});if(e.isLogin())i.addRemote(t,function(e,t){i.saveLocal(t,function(){i.cache=t;i.trigger("add:success",[e,t])})},function(){i.trigger("add:fail",[t,"æ·»å å¤±è´¥"])});else i.getItemInfo(t,function(e){i.addLocal(e,function(e,t){i.cache=t;i.trigger("add:success",[e,t])})});return i},parse:function(e){var t=e.attr("data").split("|");var i="type icode lcode acode iid lid aid".split(" ");var a={};i.forEach(function(e,i){if(t[i])a[e]=t[i]});return a},getItemInfo:function(e,t){var i=this;if("array"!=$.type(e))e=[e];$.ajax({url:a.domain.main+"/watchlater/srv/getItemInfos.html?infos="+JSON.stringify(e)+"&app=wlbar&jsoncallback=?",dataType:"jsonp",scriptCharset:"utf-8",success:function(e){if(1==e.status)t(e.data)}})},has:function(e){var t=false;if(this.cache&&this.cache.length)this.cache.forEach(function(i){if(i.icode==e&&(0===i.type||!i.acode&&!i.lcode))t=true});return t},hasA:function(e){var t=false;if(this.cache&&this.cache.length)this.cache.forEach(function(i){if(i.acode==e)t=true});return t},hasL:function(e){var t=false;if(this.cache&&this.cache.length)this.cache.forEach(function(i){if(2==i.type&&i.lcode==e)t=true});return t},hasLi:function(e,t){var i=false;if(this.cache&&this.cache.length)this.cache.forEach(function(a){if(3==a.type&&a.lcode==e&&a.icode==t)i=true});return i},hasi:function(e){var t=false;if(this.cache&&this.cache.length)this.cache.forEach(function(i){if(3==i.type&&i.icode==e)t=true;else if(i.icode==e&&(0===i.type||!i.acode&&!i.lcode))t=true});return t},init:function(){if(this.hasInit)return;this.hasInit=true;var t=this;function i(){if(e.isLogin()!=t.isLogin){clearInterval(t.interval);if(e.isLogin()){n();t.trigger("loginchange",[true])}else{s();t.trigger("loginchange",[false])}}else{var i=t.cache;t.loadLocal(function(e){t.check(e,i,function(i){t.cache=e;t.trigger("add:success",[i,t.cache])});t.check(i,e,function(i){t.cache=e;t.trigger("del:success",[i,t.cache])})})}}function a(){t.hasLoad=true;t.queue.forEach(function(e){e(t.cache)});t.queue=[]}function n(){t.isLogin=true;function e(e){t.loadLocal(function(n){t.loadRemote(function(n){t.saveLocal(n,function(){t.cache=n;a();t.trigger("load:success",[n]);t.interval=setInterval(i,r);t.checkLocal(e,n);if(!n||!n.length)t.first(function(e){if(!e)t.add({type:0,icode:"r2RoS3IieCM"})})})},n)})}t.loadBackUp(function(i){if(i)e(i);else t.backUpLocal(function(t){e(t)})})}function s(){t.isLogin=false;t.loadBackUp(function(e){if(e)t.saveLocal(e,function(){t.clearBackUp();t.cache=e;a();t.trigger("load:success",[e]);t.interval=setInterval(i,r)});else t.loadLocal(function(e){e=e||[];t.cache=e;a();t.trigger("load:success",[e]);t.interval=setInterval(i,r);if(!e||!e.length)t.first(function(e){if(!e)t.add({type:0,icode:"r2RoS3IieCM"})
})})})}if(e.isLogin())n();else s();e.bind("after:miniLogin",function(){t.trigger("loginchange",[true]);clearInterval(t.interval);n()});return this},data:function(e){if(!e)return this.cache;if(true==this.hasLoad)e(this.cache);else this.queue.push(e)},max:function(){return e.isLogin()?50:20},updateTime:function(e,t){if(3==e.type){for(var i=0,a=this.cache.length;i<a;i++)if(3==this.cache[i].type&&this.cache[i].lcode==e.lcode&&this.cache[i].icode==e.icode){this.cache[i].watched=t;this.cache[i].ct=+new Date;this.saveLocal(this.cache);break}}else if(2==e.type){for(var i=0,a=this.cache.length;i<a;i++)if(2==this.cache[i].type&&this.cache[i].lcode==e.lcode){this.cache[i].watched=t;this.cache[i].ct=+new Date;this.saveLocal(this.cache);break}}else if(1==e.type||e.acode){for(var i=0,a=this.cache.length;i<a;i++)if(this.cache[i].acode==e.acode){this.cache[i].watched=t;this.cache[i].ct=+new Date;this.saveLocal(this.cache);break}}else for(var i=0,a=this.cache.length;i<a;i++)if(this.cache[i].icode==e.icode){this.cache[i].watched=t;this.cache[i].ct=+new Date;this.saveLocal(this.cache);break}},updateA:function(e,t){for(var i=0,a=this.cache.length;i<a;i++)if(this.cache[i].acode==e){this.cache[i].icode=t.icode;this.cache[i].iid=t.iid;this.cache[i].seconds=n.parseTime(t.time);this.cache[i].watched=0;this.cache[i].ct=+new Date;this.cache[i].kw=t.kw;this.cache[i].pic=t.pic;this.saveLocal(this.cache);break}},updateL:function(e,t){for(var i=0,a=this.cache.length;i<a;i++)if(2==this.cache[i].type&&this.cache[i].lcode==e){this.cache[i].icode=t.icode;this.cache[i].iid=t.iid;this.cache[i].seconds=n.parseTime(t.time);this.cache[i].watched=0;this.cache[i].ct=+new Date;this.cache[i].kw=t.kw;this.cache[i].pic=t.pic;this.saveLocal(this.cache);break}}}),o=new s;return o});define("module/watchlater/main",["page/watchlater/gmodel","tui/template","tui/util","module/login/login","module/domain","module/common","module/global","tui/browser","module/ui/scrollbar","page/watchlater/tip","tui/event"],function(e,t,i,a,n,r,s,o,l,c,u,d){var f=$(window),h=$(document.body),m=7==window.pageId,p=/douwan/.test(location.host),g=window.top!=window,v=[1,2,3,4,5,6].indexOf(window.pageId)>-1,b=false,w={},_={},y={},k={},x=f,S=1e3,T="wlzhuiju",C="wlzjdata",I=[36e6,504e5,648e5,792e5],D=new u;function L(e,t){if($.isFunction(e))s.storage.getItem(C,function(t){t=t||"[]";t=JSON.parse(t);e(t)});else s.storage.setItem(C,JSON.stringify(e),t)}function M(e){var t;if(3==e.type)t=k[e.icode+"~"+e.lcode];else if(2==e.type)t=y[e.lcode];else if(1==e.type||e.acode)t=_[e.acode];else t=w[e.icode];if(t){t.addClass("quickAdded").removeClass("quicking").find("a").attr("title","åæ¶ç¨åè§ç");D.trigger("add",[t,e])}}function N(e){var t;if(3==e.type)t=k[e.icode+"~"+e.lcode];else if(2==e.type)t=y[e.lcode];else if(1==e.type||e.acode)t=_[e.acode];else t=w[e.icode];if(t){t.removeClass("quickAdded").removeClass("quicking").find("a").attr("title","ç¨åè§ç");D.trigger("del",[t,e])}return t}function E(t){if(t);else if(m||b||o.isMobile||g||p){b=true;return}function i(e,t){if(m)return;if(!b){b=true;z(h);D.trigger("init")}}e.bind("load:success",i);e.bind("add:success",function(e,t){D.trigger("render");i(t)});e.bind("del:success",function(e,t){D.trigger("render");i(t)});e.init()}e.bind("add:success",function(e,t){e.forEach(function(e){M(e)})});e.bind("add:fail",function(e,t){var i=e.customNode?$(e.customNode):N(e);if(i)if(m)c(i,"çæä¸äºåæ¥å å§ï¼");else c(i,'çæä¸äºåæ¥å å§ï¼<a href="'+n.domain.main+'/wlplay/view/" target="new2">è¿å°±å»çã</a>')});e.bind("del:success",function(e,t){e.forEach(function(e){N(e)})});var O=".pack_clipImg,.pack_listImg,.pack_albumImg,.quic";function z(t){t.find(O).each(function(t,i){i=$(i);var a=$(i).closest(".pic").find("a:first");if(a.hasClass("quick_hook"))return;var n=r.parseUrl(a.attr("href")||"");if(!n.acode&&!n.icode&&!n.lcode)return;if("other"==n.type||"0"===a.attr("wl"))return;if(1!=a.attr("wl")){if("album"==n.type||"albumplay"==n.type||"albumcover"==n.type)if(n.icode){delete n.acode;n.type=0}else n.type=1;else if("list"==n.type||"listplay"==n.type||"listcover"==n.type)if(n.icode)n.type=3;else n.type=2;else if(n.icode){delete n.acode;delete n.lcode;n.type=0}}else if(1==a.attr("wl")){delete n.icode;if(!n.acode)return;n.type=1}var s=$("<div>");s.addClass("quick");if(0==n.type){a.before(s);if(e.has(n.icode)){s.html('<a href="#" data-ck="quick='+n.type+'" data="'+[n.type,n.icode,n.lcode,n.acode,n.iid,n.lid,n.aid].join("|")+'" title="åæ¶ç¨åè§ç" class="quick_hook"></a>');s.addClass("quickAdded");w[n.icode]=s;D.trigger("add",[s,n])}else s.html('<a href="#" data-ck="quick='+n.type+'" data="'+[n.type,n.icode,n.lcode,n.acode,n.iid,n.lid,n.aid].join("|")+'" title="ç¨åè§ç" class="quick_hook"></a>');w[n.icode]=s}else if(1==n.type){a.before(s);if(e.hasA(n.acode)){s.html('<a href="#" data-ck="quick='+n.type+'" data="'+[n.type,n.icode,n.lcode,n.acode,n.iid,n.lid,n.aid].join("|")+'" title="åæ¶ç¨åè§ç" class="quick_hook"></a>');s.addClass("quickAdded");_[n.acode]=s;D.trigger("add",[s,n])}else s.html('<a href="#" data-ck="quick='+n.type+'" data="'+[n.type,n.icode,n.lcode,n.acode,n.iid,n.lid,n.aid].join("|")+'" title="ç¨åè§ç" class="quick_hook"></a>');_[n.acode]=s}else if(2==n.type){var o=a.closest(".pic").find(".cnt .p b");if(o[0]&&0==o.html())return;a.before(s);if(e.hasL(n.lcode)){s.html('<a href="#" data-ck="quick='+n.type+'" data="'+[n.type,n.icode,n.lcode,n.acode,n.iid,n.lid,n.aid].join("|")+'" title="åæ¶ç¨åè§ç" class="quick_hook"></a>');s.addClass("quickAdded");y[n.lcode]=s;D.trigger("add",[s,n])}else s.html('<a href="#" data-ck="quick='+n.type+'" data="'+[n.type,n.icode,n.lcode,n.acode,n.iid,n.lid,n.aid].join("|")+'" title="ç¨åè§ç" class="quick_hook"></a>');y[n.acode]=s}else if(3==n.type){a.before(s);if(e.hasLi(n.lcode,n.icode)){s.html('<a href="#" data-ck="quick='+n.type+'" data="'+[n.type,n.icode,n.lcode,n.acode,n.iid,n.lid,n.aid].join("|")+'" title="åæ¶ç¨åè§ç" class="quick_hook"></a>');s.addClass("quickAdded");k[n.icode+"~"+n.lcode]=s;D.trigger("add",[s,n])}else s.html('<a href="#" data-ck="quick='+n.type+'" data="'+[n.type,n.icode,n.lcode,n.acode,n.iid,n.lid,n.aid].join("|")+'" title="ç¨åè§ç" class="quick_hook"></a>');k[n.icode+"~"+n.lcode]=s}})}return $.extend(D,{init:E,add:function(e){if(e&&!o.isMobile&&b)z($(e))},pos:function(e){x=e},del:N,notify:L,specailW:function(e){S=e;f.trigger("scroll")}})});define("module/user/notify",["tui/util","tui/art","tui/event","module/domain","module/login/login"],function(e,t,i,a,n,r,s){var o='<i class="caret"><i></i></i>\n<div class="g_dropdown_menu">\n<iframe src="about:blank" class="mask" frameborder="0"></iframe>\n<ul>\n<%if(list == \'login\'){%>\n<li class="none bdnone" style="cursor: pointer">æ¨è¿æ²¡æç»å½ã</li>\n<%}else if(list.length == 0){%>\n<li class="none bdnone">æ¨æè¿æ²¡ææ¶å°æ°çæ¶æ¯</li>\n<%}else{\nvar length = list.length - 1;\nlist.forEach(function(o, i){\nvar msg = o.msg;\n%>    \n<li>\n<span class="th"><%==o.stype%></span>\n<div class="td">\n<span class="t elis"><%==msg.title%></span>\n<span class="desc elis"><%==msg.content%></span>\n</div>\n<span class="tn"><%=o.count%></span>\n<a class="link" href="<%=o.link%>" target="_blank" ></a>\n</li>\n<%});%>\n<li class="more">\n<a href="/my/center/message.action" target="_blank">æ¥çå¨é¨</a>\n</li>\n<%}%>\n</ul>\n</div>';var l=null;var c=n.uid();var u=$("#gTopMessage");var d=['<i class="iconfont">&#xe63b; </i>','<i class="iconfont">&#xe63c; </i>','<i class="iconfont">&#xe62b; </i>','<i class="iconfont">&#xe634; </i>'];var f=[a.url.main+"/my/center/message.action",a.url.main+"/my/center/comment/myRecComments.do",a.url.message+"/msgList.html",a.url.main+"/my/center/sub/fans.do"];e.parseInt=parseInt;e.JSON=JSON;var h=i.extend({initialize:function(){var e=this;h.superClass.initialize.apply(e,arguments);e.loaded=false;e.loading=false;var t;u.on("mouseenter",function(){if(!e.loaded)e.loadMsg();u.addClass("active")}).on("mouseleave",function(){if(t)clearTimeout(t);t=setTimeout(function(){u.removeClass("active")},250)}).on("mouseenter",".g_dropdown_menu li",function(){if(t)clearTimeout(t);$(this).addClass("current")}).on("mouseleave",".g_dropdown_menu li",function(){$(this).removeClass("current")}).click(function(t){if(!n.uid()){t.preventDefault();n.needLogin()}setTimeout(function(){e.show()},5e3)});n.bind("after:login",function(){c=n.uid();e.show();u.find(".g_dropdown_menu, .caret").remove();e.loaded=false})},loadMsg:function(){var i=t.compile(o);var a=this;if(a.loading)return;a.loading=true;if(!c){u.append(i({list:"login",Util:e}));a.loaded=true;return}$.getJSON("http://www.tudou.com/ump/getUserNewestMsgs.action?jsoncallback=?",{destUid:c,msgTypes:"-1,1,2,3,4,5,6,7,8",withFreshCount:1},function(t){if(t.code)return;var n=t.data.msg;var r=t.data.freshCount;var s=[],o=0;for(var l in n)if(r[l]&&0!=r[l])switch(true){case l==-1:case 1==l:case 2==l:case 3==l:case 4==l:case 8==l:s[0]=n[l];s[0].stype=d[0];s[0].link=f[0];o+=r[l];break;case 5==l:s[1]=n[l];s[1].stype=d[1];s[1].link=f[1];s[1].count=r[l];break;case 6==l:s[2]=n[l];s[2].stype=d[2];s[2].link=f[2];s[2].count=r[l];break;case 7==l:s[3]=n[l];s[3].stype=d[3];s[3].link=f[3];s[3].count=r[l]}if(s[0])s[0].count=o;u.append(i({list:s,Util:e}));a.loaded=true;a.loading=false})},show:function(){var e=this;var t=0;if(!c)return;u.show();$.getJSON("http://www.tudou.com/ump/getFreshCount.action?jsoncallback=?",{destUid:c,msgTypes:"-1,1,2,3,4,5,6,7"},function(i){if(0!=i.code)return;$.each(i.data,function(e,i){t+=i});e.total=t;if(u.find(".total").length)u.find(".total").remove();if(t>0)u.find(".g_dropdown_toggle").append('<em class="total"></em>')})}});h.getInstance=function(){if(l)return l;else return l=new h};return h.getInstance()});define("module/translate/translate",["tui/cookie"],function(e,t,i){i.init=function(){var i=parseInt(e("lang"));var a=$("#translate_s2t");a.html(i?"ç®ä½ç":"ç¹é«ç").click(i?r:n);if(i)n();function n(i){i&&i.preventDefault();var n=this;t(["lazy/translate"],function(t){e("lang",1,{domain:"tudou.com",path:"/",expires:1e3});t.traditionalized();n.innerHTML="ç®ä½ç";$(".g_notify").hide();a.unbind().click(r)})}function r(t){t.preventDefault();e("lang",1,{domain:"tudou.com",path:"/",expires:-1});location.reload()}}});define("module/stat/iwt",[],function(e,t){_iwt_no_flash=window._iwt_no_flash||0;var i="UA-tudou-000001";!function(e,t,a){var n=false,r=!-[1],s="http://irs01.com/irt?_iwt_id=",o="http://irs01.net/MTFlashStore.swf#",l="http://irs01.com/_iwt.gif",c="_iwt_id",u="_iwt_cid",d="",f="",h="",m=t.getElementsByTagName("head")[0],p={available:false,guid:function(){return["MT",(+new Date+g++).toString(36),(1e18*Math.random()).toString(36)].join("").slice(0,16).toUpperCase()},get:function(e,t){return p._sendFlashMsg(t,"jGetItem",e)},set:function(e,t,i){return p._sendFlashMsg(i,"jSetItem",e,t)},clear:function(e,t){return p._sendFlashMsg(t,"jClearItem",e)},clearAll:function(e){return p._sendFlashMsg(e,"jClearAllItems")},_sendFlashMsg:function(t,i,a,n){t=t||S;var r=p.guid();e[r]=t;if(y&&y[i])switch(arguments.length){case 2:y[i](r);break;case 3:y[i](a,r);break;case 4:y[i](a,n,r)}},initSWF:function(e,t){if(!p.available)return t&&t();if(p.inited)return e&&setTimeout(e,0);e&&v.push(e);t&&b.push(t)}},g=1,v=[],b=[],w="",_,y,k,x=t.createElement("DIV"),$=p.guid();function S(){}function T(t){if(n)if(e.console&&e.console.log)e.console.log("MTFlashStore:"+t)}if(!e._iwt_no_flash){try{_=e.navigator.plugins["Shockwave Flash"]||e.ActiveXObject;w=_.description||function(){return new _("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}()}catch(C){}w=(w.match(/\d+/g)||[0])[0];if(w<9)p.available=false;else{p.available=true;e[$]=function(t,i){switch(t){case"onecall":if(!e[i])return;e[i].apply(e,[].slice.call(arguments,2));delete e[i];break;case"error":p.available=false;while(k=b.shift())k();T(i);break;case"load":T("Flash load success!");p.inited=true;p.available=true;while(k=v.shift())setTimeout(k,0)}};function I(){x.setAttribute("style","display:block;clear:both;float:none;position:absolute;right:0;bottom:0;border:none;");if(t.body.firstChild)t.body.insertBefore(x,t.body.firstChild);else t.body.appendChild(x);x.innerHTML='<object id="'+p.guid()+(r?' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ':"")+'" data="'+o+'" type="application/x-shockwave-flash" '+' width="10" height="10" style="position:absolute;right:0;bottom:0;border:none;" >'+'<param name="movie" value="'+o+'" />'+'<param name="wmode" value="transparent" />'+'<param name="version" value="10" />'+'<param name="allowScriptAccess" value="always" />'+'<param name="flashvars" value="jsproxyfunction='+$+'" />'+"</object>";y=x.firstChild;p.swf=y}var D=setInterval(function(){if(t.body){I();clearInterval(D)}},100)}}var L={track:function(){if(!p.available){if(""!=this._getQueryStrByName(u))h=s+"&_iwt_cid="+this._getQueryStrByName(u)+"&_iwt_UA="+this._getUAId();else h=s+"&_iwt_UA="+this._getUAId();z(h,function(e){var t=e;d=e})}else{p.initSWF(O);setTimeout(function(){if(!p.inited){p.available=false;e[$]=S;L.track()}},3e3)}},record_video_api:function(e,t,i,a){if("0"==a+""){f=this._getHashId();this._feedBack_video(e,t,i,a);return}this._feedBack_video(e,t,i,a)},_feedBack_video:function(e,t,i,a){var n=["ta="+a,"eid="+f,"pt="+encodeURIComponent(document.title),"vid="+e,"du="+t,"la="+i,"_iwt_id="+d,"_iwt_UA="+this._getUAId(),"r="+(new Date).getTime()].join("&");var r=l+"?"+n;this._img=new Image;this._img.src=r},_getHashId:function(){var e=location.href,t=(new Date).valueOf(),i=navigator.userAgent,a="";a=this._md5([location.host,e,i,t,Math.random()].join(""));return a},_getUAId:function(){if("undefined"==typeof i)return"";return i},_getQueryStrByName:function(e){var t=location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));if(null==t||t.length<1)return"";return t[1]},_getCookie:function(e){var t,i,a,n=document.cookie.split(";");for(t=0;t<n.length;t++){i=n[t].substr(0,n[t].indexOf("="));a=n[t].substr(n[t].indexOf("=")+1);i=i.replace(/^\s+|\s+$/g,"");if(i==e)return unescape(a)}},getReferrer:function(){var e="";try{e=window.top.document.referrer}catch(t){if(window.parent)try{e=window.parent.document.referrer}catch(i){e=""}}if(""==e)e=document.referrer;return e},_md5:function(e){function t(e,t){return e<<t|e>>>32-t}function i(e,t){var i,a,n,r,s;n=2147483648&e;r=2147483648&t;i=1073741824&e;a=1073741824&t;s=(1073741823&e)+(1073741823&t);if(i&a)return 2147483648^s^n^r;if(i|a)if(1073741824&s)return 3221225472^s^n^r;else return 1073741824^s^n^r;else return s^n^r}function a(e,t,i){return e&t|~e&i}function n(e,t,i){return e&i|t&~i}function r(e,t,i){return e^t^i}function s(e,t,i){return t^(e|~i)}function o(e,n,r,s,o,l,c){e=i(e,i(i(a(n,r,s),o),c));return i(t(e,l),n)}function l(e,a,r,s,o,l,c){e=i(e,i(i(n(a,r,s),o),c));return i(t(e,l),a)}function c(e,a,n,s,o,l,c){e=i(e,i(i(r(a,n,s),o),c));return i(t(e,l),a)}function u(e,a,n,r,o,l,c){e=i(e,i(i(s(a,n,r),o),c));return i(t(e,l),a)}function d(e){var t;var i=e.length;var a=i+8;var n=(a-a%64)/64;var r=16*(n+1);var s=Array(r-1);var o=0;var l=0;while(l<i){t=(l-l%4)/4;o=8*(l%4);s[t]=s[t]|e.charCodeAt(l)<<o;l++}t=(l-l%4)/4;o=8*(l%4);s[t]=s[t]|128<<o;s[r-2]=i<<3;s[r-1]=i>>>29;return s}function f(e){var t="",i="",a,n;for(n=0;n<=3;n++){a=255&e>>>8*n;i="0"+a.toString(16);t+=i.substr(i.length-2,2)}return t}function h(e){e=e.replace(/\r\n/g,"\n");var t="";for(var i=0;i<e.length;i++){var a=e.charCodeAt(i);if(a<128)t+=String.fromCharCode(a);else if(a>127&&a<2048){t+=String.fromCharCode(192|a>>6);t+=String.fromCharCode(128|63&a)}else{t+=String.fromCharCode(224|a>>12);t+=String.fromCharCode(128|63&a>>6);t+=String.fromCharCode(128|63&a)}}return t}var m=Array();var p,g,v,b,w,_,y,k,x;var $=7,S=12,T=17,C=22;var I=5,D=9,L=14,M=20;var N=4,E=11,O=16,z=23;var j=6,U=10,A=15,P=21;e=h(e);m=d(e);_=1732584193;y=4023233417;k=2562383102;x=271733878;for(p=0;p<m.length;p+=16){g=_;v=y;b=k;w=x;_=o(_,y,k,x,m[p+0],$,3614090360);x=o(x,_,y,k,m[p+1],S,3905402710);k=o(k,x,_,y,m[p+2],T,606105819);y=o(y,k,x,_,m[p+3],C,3250441966);_=o(_,y,k,x,m[p+4],$,4118548399);x=o(x,_,y,k,m[p+5],S,1200080426);k=o(k,x,_,y,m[p+6],T,2821735955);y=o(y,k,x,_,m[p+7],C,4249261313);_=o(_,y,k,x,m[p+8],$,1770035416);x=o(x,_,y,k,m[p+9],S,2336552879);k=o(k,x,_,y,m[p+10],T,4294925233);y=o(y,k,x,_,m[p+11],C,2304563134);_=o(_,y,k,x,m[p+12],$,1804603682);x=o(x,_,y,k,m[p+13],S,4254626195);k=o(k,x,_,y,m[p+14],T,2792965006);y=o(y,k,x,_,m[p+15],C,1236535329);_=l(_,y,k,x,m[p+1],I,4129170786);x=l(x,_,y,k,m[p+6],D,3225465664);k=l(k,x,_,y,m[p+11],L,643717713);y=l(y,k,x,_,m[p+0],M,3921069994);_=l(_,y,k,x,m[p+5],I,3593408605);x=l(x,_,y,k,m[p+10],D,38016083);k=l(k,x,_,y,m[p+15],L,3634488961);y=l(y,k,x,_,m[p+4],M,3889429448);_=l(_,y,k,x,m[p+9],I,568446438);x=l(x,_,y,k,m[p+14],D,3275163606);k=l(k,x,_,y,m[p+3],L,4107603335);y=l(y,k,x,_,m[p+8],M,1163531501);_=l(_,y,k,x,m[p+13],I,2850285829);x=l(x,_,y,k,m[p+2],D,4243563512);k=l(k,x,_,y,m[p+7],L,1735328473);y=l(y,k,x,_,m[p+12],M,2368359562);_=c(_,y,k,x,m[p+5],N,4294588738);x=c(x,_,y,k,m[p+8],E,2272392833);k=c(k,x,_,y,m[p+11],O,1839030562);y=c(y,k,x,_,m[p+14],z,4259657740);_=c(_,y,k,x,m[p+1],N,2763975236);x=c(x,_,y,k,m[p+4],E,1272893353);k=c(k,x,_,y,m[p+7],O,4139469664);y=c(y,k,x,_,m[p+10],z,3200236656);_=c(_,y,k,x,m[p+13],N,681279174);x=c(x,_,y,k,m[p+0],E,3936430074);k=c(k,x,_,y,m[p+3],O,3572445317);y=c(y,k,x,_,m[p+6],z,76029189);_=c(_,y,k,x,m[p+9],N,3654602809);x=c(x,_,y,k,m[p+12],E,3873151461);k=c(k,x,_,y,m[p+15],O,530742520);y=c(y,k,x,_,m[p+2],z,3299628645);_=u(_,y,k,x,m[p+0],j,4096336452);x=u(x,_,y,k,m[p+7],U,1126891415);k=u(k,x,_,y,m[p+14],A,2878612391);y=u(y,k,x,_,m[p+5],P,4237533241);_=u(_,y,k,x,m[p+12],j,1700485571);x=u(x,_,y,k,m[p+3],U,2399980690);k=u(k,x,_,y,m[p+10],A,4293915773);y=u(y,k,x,_,m[p+1],P,2240044497);_=u(_,y,k,x,m[p+8],j,1873313359);x=u(x,_,y,k,m[p+15],U,4264355552);k=u(k,x,_,y,m[p+6],A,2734768916);y=u(y,k,x,_,m[p+13],P,1309151649);_=u(_,y,k,x,m[p+4],j,4149444226);x=u(x,_,y,k,m[p+11],U,3174756917);k=u(k,x,_,y,m[p+2],A,718787259);y=u(y,k,x,_,m[p+9],P,3951481745);_=i(_,g);y=i(y,v);k=i(k,b);x=i(x,w)}var R=f(_)+f(y)+f(k)+f(x);return R.toLowerCase()}},M,N=false,E=false;function O(){p.get(c,function(e){if(!e){if(""!=L._getQueryStrByName(u))h=s+"&_iwt_cid="+L._getQueryStrByName(u)+"&_iwt_UA="+L._getUAId();else h=s+"&_iwt_UA="+L._getUAId();z(h,function(e){p.set(c,e);d=e})}else{if(""!=L._getQueryStrByName(u))h=s+e+"&_iwt_cid="+L._getQueryStrByName(u)+"&_iwt_UA="+L._getUAId();else h=s+e+"&_iwt_UA="+L._getUAId();z(h,function(e){p.set(c,e);d=e})}})}function z(i,n){var r=t.createElement("script"),s=p.guid();e[s]=function(){try{n.apply(e,arguments);m.removeChild(r)}catch(t){}e[s]=a};r.setAttribute("type","text/javascript");r.setAttribute("charset","utf-8");var o=i+"&jsonp="+s+"&";if("undefined"==typeof _iwt_p1)o+="_iwt_p1=&";else o=o+"_iwt_p1="+_iwt_p1+"&";if("undefined"==typeof _iwt_p2)o+="_iwt_p2=&";else o=o+"_iwt_p2="+_iwt_p2+"&";if("undefined"==typeof _iwt_p3)o+="_iwt_p3=&";else o=o+"_iwt_p3="+_iwt_p3+"&";if("undefined"!=typeof _iwt_no_referrer&&!_iwt_no_referrer){var l=L.getReferrer();if(""!=l)o=o+"ref="+encodeURIComponent(l)+"&"}r.setAttribute("src",o);if(m.firstChild)m.insertBefore(r,m.firstChild);else m.appendChild(r)}e._iwt=L;L.FC=p}(window,document);return _iwt});define("module/stat/comscore",["module/global"],function(e,t,i){var a={beacon:function(e){var t=1.7,i=document,a=i.location,n=512,r=function(e,t){if(null==e)return"";e=(encodeURIComponent||escape)(e);if(t)e=e.substr(0,t);return e},s=["https:"==a.protocol?"https://sb":"http://b",".scorecardresearch.com/b?","c1=",r(e.c1),"&c2=",r(e.c2),"&rn=",Math.random(),"&c7=",r(a.href,n),"&c3=",r(e.c3),"&c4=",r(e.c4,n),"&c5=",r(e.c5),"&c6=",r(e.c6),"&c10=",r(e.c10),"&c15=",r(e.c15),"&c16=",r(e.c16),"&c8=",r(i.title),"&c9=",r(i.referrer,n),"&cv=",t,e.r?"&r="+r(e.r,n):""].join("");s=s.length>2080?s.substr(0,2075)+"&ct=1":s;var o=new Image;o.onload=function(){};o.src=s;return s},send:function(){a.beacon({c1:2,c2:6035715,c3:window.config&&config.item&&config.item.cid?config.item.cid:"",c4:window.location.href,c5:"",c6:window.comscore_c6||"",c10:e.juid||0,c11:e.uid||0,c15:""})}};return a});define("module/stat/combo-stat",["tui/cookie"],function(e,t,i){if(window.ComboStat)return window.ComboStat;var a={cookie:function(t,i,a){if("undefined"==typeof i)return e(t);var n={domain:"tudou.com",path:"/"};if(!a)n.expires=36500;e(t,i,n)},uuid:function(e){e=e||6;var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");var i="";var a=t.length;for(var n=0;n<e;n++){var r=parseInt(Math.random()*Math.pow(10,6))%a;i+=t[r]}return(new Date).getTime()+i},init:function(){var e=this;if(e.pvid)return;var t=e.cookie("ypvid")||"";var i=e.uuid();e.cookie("ypvid",i,true);var a=e.cookie("yseid");var n=1;var r=1;if(!a||(new Date).getTime()>(parseInt(e.cookie("yseidtimeout"))||0)){a=e.uuid();e.cookie("yseid",a,true);e.cookie("ysestep",1);r=parseInt(e.cookie("yseidcount")||0)+1;e.cookie("yseidcount",r)}else{n=parseInt(e.cookie("ysestep")||0)+1;e.cookie("ysestep",n)}var s=(new Date).getTime()+120*6e4;e.cookie("yseidtimeout",s,true);var o=e.cookie("ycid")||"";var l=window.cid||window.config&&window.config.item&&window.config.item.cid||0;e.cookie("ycid",l,true);var c=parseInt(e.cookie("ystep")||0)+1;e.cookie("ystep",c);e.juid=e.cookie("yjuid")||"";e.seid=a;e.pvid=i;e.cid=l;e.referPvid=t;e.referCid=o;e.step=c;e.seStep=n;e.seidTimeout=s;e.seidCount=r;e.isFrame=top.location!=window.location?1:0;e.noCookie=!navigator.cookieEnabled?1:0}};a.init();return a});define("module/stat/pv",["tui/browser","tui/util","tui/cookie","tui/net","module/login/login","module/stat/common","module/stat/combo-stat","module/global"],function(e,t,i,a,n,r,s,o,l,c){var u=Date.now();var d=window.config||{};if(!d.item)d.item={};var f=window.pageId||d.pageId;var h=r.mix({param:function(e){var t=[];$.each(e,function(e,i){if(""!==i)t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))});return t.join("&")},getExt:function(){var t=this;var a={};if(s.isFrame)a.frame=s.isFrame;if(s.noCookie)a.noCookie=s.noCookie;a.referhost=i("referhost")||"";if(screen.availWidth-$(window).width()<20)a.winheight=$(window).height();if(f)if(f>=1&&f<=7){var l=(r.referrer||"").replace(/\?.*$/,"");if(/tudou\.com\/(listplay|programs\/view|albumplay|wlplay\/view)\//.test(l))a.preferurl=i("preferurl")||"";else a.preferurl=l;i("preferurl",l,{domain:"tudou.com",path:"/"})}if(e.isMobile)a.mtype=e.iOS||(0!==e.android?e.isPad?"androidpad":"androidphone":0!==e.wphone?"wphone":"other");a.tjuid=o.juid||"";$.extend(a,t.getData());if(n.uid()){var c=$.trim(i("u_data")).split("_");if(c.length)c.forEach(function(e){e=e.split("|");a[e[0]]=e[1]})}return t.param(a)},send:function(){var e={};e.did=2;e.juid=s.juid;e.sid=s.seid;e.uid=o.uid||0;e.pid=s.pvid;e.cid=s.cid;e.rurl=r.referrer;e.rpid=s.referPvid;e.rct=s.referCid;e.ext=this.getExt();e.stp=s.step;e.sstp=s.seStep;e.scnt=s.seidCount;a.getRequest("http://p.l.youku.com/compvlog?"+this.param(e));this.trigger("send")}});var m=r.mix({send:function(){var e=1;var n=window.SUBDOMAIN;var s=0;var l=o.uid;var c=o.juid;var u=o.seid;var f=+new Date,h=0,m="",p=f,g=i("pageStep"),v=g?Math.max(1,g):1,b=encodeURIComponent(r.referrer);var w=this.getData(e,m);s=w.pageFlag||0;h="1"+(window.abtest||d.abtest||0)+0+t.pad(window.cid||d.item.cid||0,3)+t.pad(0,3)+(window.top==window?"00":"01")+(w.timeOfRef||"");a.getRequest("http://stats.tudou.com/pv3/?s="+[e,l,v,"",h,c,u,s,m,b||""].join("*_*")+"&r="+ +new Date);this.trigger("send")},getPCode:r.getPositionCode,getXByPC:r.getXpathFromPositionCode,getElByX:r.getElementByXPath,getTrueLink:r.getTrueLink,getStatTarget:r.getStatTarget});c.ComboPvStat=h;c.tudouStat=m;c.init=c.send=function(){c.pvCount=c.pvCount||0;c.pvCount++;if(c.pvCount>1){s.pvid="";s.init();o.pvid=r.pvid()}h.send();m.send()}});define("tui/flash",["tui/class","tui/event","tui/template","tui/util","tui/dialog"],function(e,t,i,a,n,r,s){function o(e,t,i,a){var n,r=i||window,s=e.split(".").reverse();while((n=s.pop())&&s.length>0){if("undefined"===typeof r[n])r[n]={};else if("object"!==typeof r[n])return false;r=r[n]}if("undefined"!=typeof t)if("object"!=typeof r[n])r[n]=t;else $.extend(r[n],t);return r[n]}s.getFlashMC=function(e){return document.getElementById(e)||window[e]};s.swfobject=function(){var r=0;var l=!(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length);var c=$.browser.webkit;var u=s.getFlashMC;var d={object:'<object id="<%=id%>" <%=classid%> width="<%=width%>" height="<%=height%>" name="<%=name%>" <%=data%> style="<%=style%>" <%=mimetype%> >',embed:'<embed id="<%=id%>" width="<%=width%>" height="<%=height%>" flashvars="<%=flashvars%>" quality="high" name="<%=name%>" src="<%=src%>" style="<%=style%>" <%=mimetype%> ',pluginspage:'<a id=<%=id%> class="tui_noflash" href="#" style="width:<%=width%>;height:<%=height%>;display:block;overflow:hidden;cursor:pointer;<%=style%>" onclick="<%=fn%>()">éè¦flashplayeræä»¶ï¼ç¹å»å®è£</a>'};var f="application/x-shockwave-flash";var h=s.swfClass=e({initialize:function(e){var i=this;r++;$.extend(this,e);var a=e.attrs;var n=a.id;if(!n)n=a.id="TUI_flashObj_"+r;this.flashId=n;if(!a.name)a.name=a.id;this.pluginspage=e.pluginspage||g;this.pluginspageTpl=e.pluginspageTpl||v;var s=p();this.isSupport=s&&s[0]>0;var l=this.jsapiName=e.flashvars.jsapi="_TUI_flashObj_"+r;var c=this.jsapi=window[l]={};var u=e.params.allowscriptaccess||e.params.allowScriptAccess;if(u&&"never"!=u){this.event=new t;$.extend(c,{flashReady:function(e){i.event.fire("load",e)},getValue:function(e){return o(e)},callFunc:function(e,t){try{return o(e).apply(o(e.replace(/\.[^\.]+$/,"")),t)}catch(i){return false}},notify:function(e,t){i.event.fire(e,t)}})}},load:function(e){var t=e?$("#"+e)[0]:false;if(t)if(t.outerHTML&&!$.browser.opera)t.outerHTML=this.getHTML();else{var i=this,a=$(this.getHTML())[0];t.parentNode.replaceChild(a,t)}else document.write(this.getHTML())},getHTML:function(){var e,t,a=this,n=[],r=[],s=this.attrs,o=this.flashvars,u=this.params;if(this.isSupport)if(c&&c<312||!l&&"embed"===this.type){for(e in o)r.push(e+"="+o[e]);s.flashvars=r.join("&");s.mimetype='type="'+f+'"';n.push(i.format(d["embed"],s));for(t in u)n.push(t+'="'+u[t]+'" ');n.push(" ></embed>")}else{if(l)s.classid='classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"';else{s.data='data="'+s.src+'"';s.mimetype='type="'+f+'"'}n.push(i.format(d["object"],s));if(l)u["movie"]=s.src;u["quality"]="high";for(t in u)n.push('<param name="',t,'" value="',u[t],'" />');for(e in o)r.push(e+"="+o[e]);if(r.length>0)n.push('<param name="flashvars" value="',r.join("&"),'" />');n.push("</object>")}else{var h=s.width,m=s.height;n.push(i.format(this.pluginspageTpl(),$.extend(s,{width:!h&&"auto"||/%$/.test(h)&&h||h+"px",height:!m&&"auto"||/%$/.test(m)&&m||m+"px",fn:this.jsapiName+".pluginspage"})));this.jsapi.pluginspage=function(){return a.pluginspage.call(a)}}return n.join("")},ready:function(e){this.event.bind("load",e)},bind:function(e,t){this.event.bind(e,t);u(this.flashId)._addEventListener(e,this.jsapiName+".notify")},callMethod:function(e,t){return u(this.flashId)._call(e,t)}});function m(e,t,i,a,n,r){r=$.extend(r||{},{src:e,width:t,height:i});var s=r.tagType;delete r.tagType;return new h({type:s,attrs:r,params:n,flashvars:a,pluginspage:g,pluginspageTpl:v})}$.extend(m,{getVersion:p,setPluginspage:function(e){var t=g;g=function(){return e.call(this,t)}},setPluginspageTpl:function(e){var t=v;v=function(){return e.call(this,t)}}});return m;function p(){var e=[0,0,0];if(navigator.plugins&&navigator.mimeTypes.length){var t=navigator.plugins["Shockwave Flash"];if(t&&t.description)e=t.description.replace(/^\D+/,"").replace(/\s*r/,".").replace(/\s*[a-z]+\d*/,".0").split(".")}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var i=1;var a=3;while(i)try{a++;i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a);e=[a,0,0]}catch(n){i=null}}else{try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(n){try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");e=[6,0,21];i.AllowScriptAccess="always"}catch(n){if(6==e.major)return e}try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(n){}}if(null!=i)e=i.GetVariable("$version").split(" ")[1].split(",")}return e}function g(){n.alert("å®è£å®flashplayerä¹åï¼è¦è®°å¾åéæ°å¯å¨æµè§å¨ï¼åè®¿é®åè±å",function(){a.openURL("http://get.adobe.com/flashplayer/","_blank")});return false}function v(){return d["pluginspage"]}}()});define("module/ad/youku",["tui/browser","tui/event","tui/net","tui/flash","module/global","module/stat/combo-stat"],function(e,t,i,a,n,r,s,o){window.TUI=window.TUI||{};TUI.event=new t;TUI.swfobject=a.swfobject;window.uid=n.uid;window.juidStr=n.juid;$.fn.forEach=Array.prototype.forEach;TUI.event.bind("ad:loaded",function(){var e=$("#gTop .ad_banner");if(e&&$.trim(e.html()).length>0)$("#gTop .logo").addClass("mini_logo")});var l={1:"play",2:"play",3:"play",4:"play",5:"play",6:"play",11:"albumcover",300:"index",10001:"so",10002:"so",10003:"so",10004:"so"};var c={index:"101012,101385,101014,101015,101016,101027,101028,101029,101030,101031,101032,101196,101215,101312,101313,101392,101299,101626,101678",so:"101041,101042,101043,101044",play:"101192,101193,101194,101195",top:"101185,101395",rank:"101396,101630",albumtop:"101184,101393",albumcover:"101386,101387,101388,101389,101487,101488",playlist:"101183,101394",imake:"101045,101046,101049,101050,101051,101052,101221,101459,101489,101490,101491,101641",tv:"101172,101173,101176,101177,101205,101399,101400,101426,101432,101495,101496,101497,101638",movie:"101166,101167,101170,101171,101206,101401,101402,101450,101492,101493,101494,101636",zy:"101053,101054,101057,101058,101059,101060,101203,101448,101498,101499,101500,101639",cartoon:"101082,101083,101086,101087,101088,101222,101397,101460,101501,101502,101503,101640",news:"101124,101125,101128,101129,101130,101207,101415,101451,101507,101508,101509,101623",fortune:"101110,101111,101114,101115,101116,101201,101418,101446",auto:"101034,101035,101038,101039,101040,101209,101413,101453,101510,101511,101512,101644",it:"101103,101104,101107,101108,101109,101204,101416,101449,101513,101514,101515,101629",sports:"101096,101097,101100,101101,101102,101224,101404,101462,101516,101517,101518,101631",ent:"101061,101062,101065,101066,101067,101212,101398,101456,101519,101520,101521,101635",music:"101089,101090,101093,101094,101095,101200,101445,101504,101505,101506,101547,101625",game:"101159,101160,101163,101164,101165,101208,101414,101452,101522,101523,101524,101642",fun:"101075,101076,101079,101080,101081,101211,101411,101455,101525,101526,101527,101632",fashion:"101131,101132,101135,101136,101137,101199,101419,101444,101528,101529,101530,101624",beauty:"101145,101146,101149,101150,101151,101202,101417,101447,101531,101532,101533",lady:"101152,101153,101156,101157,101158,101213,101410,101457",life:"101068,101069,101072,101073,101074,101220,101403,101458,101534,101535,101536,101646",health:"101138,101139,101142,101143,101144,101223,101405,101461,101537,101538,101539,101645",edu:"101117,101118,101121,101122,101123,101210,101412,101454,101540,101541,101542,101633",jilupian:"101647,101648,101643,101650,101649",korea:"101652,101653,101651,101655,101654"};o.getAd=function(e){e=e||{};var t=window.SUBDOMAIN||l[window.pageId]||"";var a=c[t];if(e.page)a=c[e.page];if(a||e.id){var n={p:e.id||a,site:"tudou",sid:r.pvid,s:e.s||"",ct:e.ct||"",cs:e.cs||"",k:e.k||""};i.getScript("http://html.atm.youku.com/html?"+$.param(n),{charset:"gbk"})}};o.init=function(t){if(e.iOS){var i=$(".seed, .s .seedplayerbox");var a="http://zone.tudou.com/tudougroovin/";var n="http://i1.tdimg.com/b/20130422/c449.jpg";i.css({width:"auto",height:"auto",padding:"12px 14px"});i.html('<a href="'+a+'" target="_blank"><img width="285" height="260" style="display:block;margin:0 auto" src="'+n+'" /></a>').slideDown()}o.getAd(t)}});define("module/nav/user",["tui/event","tui/art","tui/cookie","module/domain","module/login/login","tui/util/url"],function(e,t,i,a,n,r){var s=a.url;window.pageId=window.pageId||300;var o=e.extend({userTpl:'<iframe src="about:blank" class="mask" frameborder="0"></iframe>\n<%if(isLogined){%>\n<div class="hd">\n<div class="user_wrap">\n<div class="user_icon">\n<a href="<%=Url.main%>/home/<%=usr%>/" target="_blank" title="<%=nic%>çä¸»é¡µ"><img src="<%=ico%>"></a>\n</div>\n<div class="user_name">\n<a class="nic" target="_blank" href="<%=Url.main%>/home/<%=usr%>/" title="<%=nic%>"><%=nic%></a>\n</div>\n<div class="user_authority">\n<a href="<%=Url.main%>/verify/index.do" title="åè±è®¤è¯" target="_blank" class="g_vip3<%if(!isVuser){%> gray<%}%> iconfont">&#xe614;</a>\n<a href="<%=Url.vip%>" title="åè±ä¼å" target="_blank" class="g_vip4<%if(!isMember){%> gray<%}%> iconfont">&#xe644;</a>\n<%if(level){%>\n<a title="ç¨æ·ç­çº§" href="<%=Url.main%>/utsfront/index" target="_blank" class="g_task"><img src="http://i3.tdimg.com/b/20141125/co3.png"><em><%=level%></em></a>\n<%}%>\n<%if(taskNum_unfinished){%>\n<a href="http://www.tudou.com/utsfront/index" target="_blank" class="task-num">\n<i class="caret"><i></i></i>\n<span class="ci"><%=taskNum_unfinished%></span>ä¸ªä»»å¡å¨ç­ä½ åï¼å»çç\n</a>\n<%}%>\n</div>\n</div>\n<%if(u_supply == \'0\'){%>\n<span class="user_tips user_tips_t2">\næ¨çè´¦å·å­å¨å®å¨é£é©ï¼å»ºè®®ç«å³ <a href="<%=Url.main%>/my/setting/mobile.action" target="_blank">ç»å®ææº</a>\n<a class="close" href="#"><i class="iconfont">&#xe63f;</i></a>\n</span>\n<%}%>\n</div>\n<div class="user_sub"><i class="loading"></i></div>\n<div class="bd">\n<ul>\n<li class="i_home">\n<a href="<%=Url.main%>/home/<%=usr%>/" class="home_link" target="_blank"><i class="iconfont">&#xe635;</i><%=nic%>çèªé¢é</a>\n<%if(!isVuser){%>\n<a href="<%=Url.main%>/verify/index.do" class="p_right" target="_blank">ç³è¯·è®¤è¯</a>\n<%}%>\n</li>\n<li class="i_favor">\n<a href="<%=Url.main%>/watch/favorite/" target="_blank"><i class="iconfont">&#xe611;</i>æçæ¶è</a>\n</li>\n<li class="i_vip">\n<a href="http://vip.tudou.com/index.html" target="_blank"><i class="iconfont">&#xe630;</i>ä¼å</a>\n<a href="http://cps.tudou.com/redirect.html?id=000003d6" target="_blank" class="p_right">\n<%if(vip==2){%>\nå©ä½ <%=vipDay%> å¤©\n<%}else if(vip==1){%>\n<span class="ci">ç«å³ç»­è´¹</span>\n<%}else{%>\n<span class="ci">ç«å³å¼é</span>\n<%}%>\n</a>\n</li>\n<li class="i_watchhistory">\n<a href="<%=Url.main%>/watch/history/" target="_blank">\n<i class="iconfont">&#xe613;</i>\nè§çè®°å½\n</a>\n</li>\n<li class="i_cart">\n<a href="<%=Url.main%>/my/center/mycart.action" target="_blank"><i class="iconfont">&#xe662;</i>è´­ç©è½¦</a>\n<a href="http://wanhuo.tudou.com" target="_blank" class="p_right">\n<%if(goodsCount>0){%>\n<%=goodsCount%> ä»¶å®è´\n<%}else{%>\n<span class="ci">åç°å®è´</span>\n<%}%>\n</a>\n</li>\n</ul>\n</div>\n<div class="ft">\n<a href="<%=Url.main%>/my/setting/info.action" target="_blank">è´¦æ·è®¾ç½®</a>\n<a href="<%=Url.login%>/loginOut.do?r=<%=t%>" class="logout">éåº</a>\n</div>\n<a class="QRcode_login_btn" href="#" id="QRcodeLoginBtn"></a>\n<div class="QRcode_login" id="QRcodeLogin">\n<div class="img">\n<img id="QRcodeImg" >\n<div class="mask"></div>\n<div class="invalid_note">æ æ³å®æç»å½Tï¹T<br/>ä½ çäºç»´ç å·²è¿æ</div>\n<a href="#" class="refresh">ç¹å»å·æ°</a>\n</div>\n<h3>æ«ä¸æ«</h3>\n<div class="title">ç§»å¨ç«¯ä¹ç»å½å¯ï¼</div>\n<i class="bg"></i>\n</div>\n<%}else{%>\n<ul class="ul_top fix">\n<li class="hellow"><%=hellow%></li>\n<li><a href="<%=Url.login%>/login.do?noreg=ok" class="login_btn g_needlogin" target="_blank" id="login">ç»å½</a></li>\n<li><a href="<%=Url.login%>/reg.do" class="reg_btn g_needlogin g_needreg" target="_blank" id="login">æ³¨å</a></li>\n</ul>\n<ul class="ul_bottom">\n<li class="i_favor">\n<a href="<%=Url.main%>/watch/favorite/" target="_blank"><i class="iconfont">&#xe611;</i>æçæ¶è</a></li>\n<li class="i_vip">\n<a href="http://vip.tudou.com/index.html" target="_blank"><i class="iconfont">&#xe630;</i>ä¼å</a>\n<a href="http://cps.tudou.com/redirect.html?id=000003d6" target="_blank" class="p_right"><span>ç«å³å¼é</span></a>\n</li>\n<li class="i_watchhistory">\n<a href="<%=Url.main%>/watch/history/" target="_blank"><i class="iconfont">&#xe613;</i>è§çè®°å½</a>\n</li>\n<li class="i_cart">\n<a href="<%=Url.main%>/my/center/mycart.action" target="_blank"><i class="iconfont">&#xe662;</i>è´­ç©è½¦</a>\n<a href="http://wanhuo.tudou.com" target="_blank" class="p_right"><span>åç°å®è´</span></a>\n</li>\n</ul>\n<i class="bg"></i>\n<%}%>\n',menuTpl:'<span class="g_dropdown_toggle <%=prefix%>">					<a class="txt" href="<%=Url.main%>/home/<%=usr%>" target="_blank" title="<%=nic%>"><%=nic%></a>					<span class="user_icon">						<a class="img" href="<%=Url.main%>/home/<%=usr%>" target="_blank">							<img src="<%=ico%>" />						</a>						<%if(isMember){%><i class="iconfont g_vip4">&#xe630;</i><%}%>					</span>				</span>				<i class="caret"><i></i></i>				<div class="g_dropdown_menu fix">					<i class="loading"></i>				</div>				<%if(u_supply=="0"){%>				<span class="user_tips user_tips_t1">					æ¨çè´¦å·å­å¨å®å¨é£é©ï¼å»ºè®®ç«å³ <a href="<%=Url.main%>/my/setting/mobile.action" target="_blank">ç»å®ææº</a>					<a class="close" href="#"><i class="iconfont">&#xe63f;</i></a>					<span class="arrow iconfont">&#xe641;</span>				</span>				<%};%>',initialize:function(e){var t=this;
o.superClass.initialize.apply(t,arguments);$.extend(t,e);t.$uInfo=$("#uInfo");t.MAX=0;var r;t.$uInfo.bind({mouseenter:function(){if(r)clearTimeout(r);r=setTimeout(function(){t.$uInfo.addClass("active");if(!t.isLoaded)n.ucode()?t.logined():t.unlogin();if(!t.isLoadInfo&&t.data)t.getUserInfo(true)},150)},mouseleave:function(){if(r)clearTimeout(r);r=setTimeout(function(){t.$uInfo.removeClass("active")},150)}});if(!n.ucode())t.$uInfo.delegate(".g_needlogin","click",function(e){e.preventDefault();var t=$(this);n.needLogin({isReg:t.hasClass("g_needreg")})});t.$uInfo.delegate(".user_tips .close","click",function(e){e.preventDefault();t.$uInfo.find(".user_tips").remove()}).delegate(".user_tips","mouseenter",function(e){e.stopPropagation()});if(n.uid()&&!window.isQRcodeloaded){var s;var l=true;function c(e){var t=$("#QRcodeLogin");var n=$("#QRcodeImg");$.getJSON(a.domain.login+"/qrcode/getCode.do?jsoncallback=?",{showLogo:1,cookie:encodeURIComponent(i("yktk")),size:148},function(e){if(0==e.code){n.attr("src",e.data.url);n.load(function(){n.show();t.removeClass("invalid");l=false});if(s)clearTimeout(s);s=setTimeout(function(){t.addClass("invalid");l=true},60*1e3)}})}t.$uInfo.delegate("#QRcodeLoginBtn","click",function(e){e.preventDefault();if(t.$uInfo.hasClass("QRcode_active"))t.$uInfo.removeClass("QRcode_active");else{t.$uInfo.addClass("QRcode_active");if(l)c()}}).delegate(".QRcode_login .refresh","click",function(e){e.preventDefault();c()});window.isQRcodeloaded=true}},getUserCard:function(){var e=s.main+"/uis/userCard.action";var t=this;var i=n.ucode();$.ajax({url:e,data:{app:window.config&&window.config.pageId||window.pageId||0,uidCode:i,jsoncallback:"jsoncallback"},cache:true,dataType:"jsonp",jsonpCallback:"jsoncallback",success:function(e){if(e&&0==e.code){t.data=e.data;t.fire("get:success",[e.data,t]);t.getUserInfo(false)}else t.fire("get:fail",[{status:"error",msg:"error",ret:e},t])}})},init:function(e){var t=this;$.extend(t,e)},showLoginStatus:function(){var e=this;if(n.isLogin()){var a=n.userInfo();e.$uInfo.addClass("g_user").removeClass("g_login");e.$uInfo.html(t.compile(e.menuTpl)({prefix:a.prefix,nic:a._nic,usr:a._usr,ico:a._ico,Url:s,isMember:parseInt(a._vip),u_supply:i("u_supply")}));e.$content=$(".g_dropdown_menu",e.$uInfo);setTimeout(function(){e.getUserCard()},150)}else e.unlogin()},getUserInfo:function(e){var t=this;var i=t.data;if(!i&&t.MAX<3){t.getUserCard();t.MAX++;return}var a=i.isMember;var n=i.verifyType;if(e){t.$content.find(".user_name .num").html(i.subedNum);if(n)t.$content.find(".user_authority .g_vip3").show();t.isLoadInfo=true}else if(!a&&n)t.$uInfo.find(".user_icon").append('<i class="iconfont g_vip3">&#xe614;</i>')},unlogin:function(){var e=this;var a=["Hi~ç»éåå¯ä»¥æ¥ä¸åå¼¹å¹å¦~","Hi~ç»å½åå¯è®¢éæ¬§å·´çèªé¢éå¦~","Hi~ç»éåå¯ä»¥æ¶èåæ¬¢çè§é¢å¦~","éªå¹´ï¼èµ¶å¿«ç»éå§~","è¿ç­ä»ä¹ï¼èµ¶å¿«ç»éå§~","éªå¹´ï¼ç»å½åå¯ä»¥å°½æå°ç©èæå¦~","Hi~ç»å½åå¯ä»¥åä»»å¡è·å¥å±å¦~","ä½ å¥½ï¼å¯¼æ¼ï¼æ±ç»å½~","ç»å½åå¯ä»¥çæ´ç²¾å½©çåå®¹å¦~"];e.$uInfo.html("").removeClass("g_user").addClass("g_login").append('<a href="http://login.tudou.com/login.do?noreg=ok" class="g_dropdown_toggle" target="_blank" id="login">ç»å½</a>									<i class="caret"><i></i></i>								<div class="g_dropdown_menu">'+t.compile(e.userTpl)({Url:s,hellow:a[Math.floor(Math.random()*a.length)],isLogined:false,u_supply:i("u_supply")})+"</div>");e.isLoaded=true},getProfile:function(e){var t=s.main+"/uis/myProfile.action?jsoncallback=?&app="+window.pageId;$.getJSON(t,{},function(t){e&&e(t)},"jsonp")},logined:function(){var e=this;if(!e.$content)return;var a=n.userInfo();var r=null;$.getJSON(s.main+"/watch/sub/totalUpdateCount.do?jsoncallback=?",{app:window.pageId,uid:window.uid},function(e){if(0==e.code){r=e.data;return}},"jsonp");e.getProfile(function(o){if(o&&0!=o.code)return;var l=o.data;var c='\n<%if (num==0){%>\n<h3>\nè®¢éæ´æ° <span class="ci">0</span> \n<span class="desc">æ¨å¯è½ä¼åæ¬¢è¿äºèªé¢éï¼èµ¶å¿«ççå§ï¼</span>\n</h3>\n<dl>\n<dt>\n<a href="http://gc.tudou.com/" >å»å¹¿åºçç</a>\n</dt>\n<%data.forEach(function(o, i){%>	\n<dd>\n<a href="<%=Url.main%>/home/<%=o.name%>/" title="<%=o.nickname%>"><img src="<%=o.userpic%>" width=42 height=42></a>\n</dd>\n<%})%>									\n</dl>\n<%}else{%>\n<h3>\nè®¢éæ´æ° <span class="ci"><%=num%></span> \n</h3>\n<dl>\n<dt>\n<a href="<%=Url.main%>/watch/subscribe/"><i class="iconfont">&#xe647;</i>æ¥çå¨é¨</a>\n</dt>\n<%data.forEach(function(o, i){%>\n<%if(o.lastItem){%>	\n<dd>\n<a href="<%=o.lastItem.playLink%>"  title="<%=o.lastItem.title%>" class="img"><img src="<%=o.lastItem.picurl%>" width=75 height=42 /></a>\n</dd>\n<%}%>						\n<%})%>			\n</dl>\n<%}%>	';var u="";e.$content.html(t.compile(e.userTpl)({nic:a._nic,usr:a._usr,ico:a._ico,Url:s,uid:n.uid(),isMember:parseInt(a._vip),isLogined:true,vip:l.vip,isVuser:l.isVuser,level:l.level,taskNum_unfinished:l.taskNum_unfinished,vipDay:l.vipDay,goodsCount:l.goodsCount,t:+new Date,u_supply:i("u_supply")}));var d=e.$content.find(".user_sub");var f=window.setInterval(function(){if(null!==r){clearInterval(f);if(0==r){u="http://gc.tudou.com/newsData.html?jsoncallback=?";$.getJSON(u,{pageNo:1,pageSize:5},function(e){d.html(t.compile(c)({data:e,Url:s,num:0}))},"jsonp")}else{u=s.main+"/uis/watch/subListJson.action?jsoncallback=?";$.getJSON(u,{app:window.pageId,ucode:n.ucode(),order:1,page:1,show:3,pageSize:3},function(e){if(0==e.data.subs.length)return;d.html(t.compile(c)({data:e.data.subs,Url:s,num:r}))},"jsonp")}}},500)});window.uid=n.uid();e.isLoaded=true}});return o});define("tui/suggest",["tui/widget","tui/util","tui/art","module/login/login"],function(e,t,i,a){var n=e.extend({initialize:function(e,t){if("string"==typeof e)e=$(e);t=t||{};var i=t.callback;var a=t.time||200;var r=this;n.superClass.initialize.apply(this,arguments);r.input=e=$(e);r.form=e.closest("form");if(i)r.form.bind("submit",function(e){i.call(r,e)});r.box=$('<div class="g_searchhint g_searchhint_ex"><iframe frameborder="0" class="gst" src="about:blank"></iframe><div class="g_searchhint_c fix"></div></div>');r.boxc=r.box.find(".g_searchhint_c");r.box.delegate(".g_searchhint a","click",function(t){var i=e.val();var a=$(this);var n=a.closest(".g_search_pack");var s;if(n.length){e.val(n.find("h4 a").html());s=1}else{t.preventDefault();s=0;e.val(a.find("span").text())}r.trigger("choose",[e.val(),e,$(this),i,s])}).delegate(".g_search_l a","mouseover",function(e){var t=$(this);r.box.find(".current").removeClass("current");t.addClass("current");r.expand(t.attr("ex"),t.attr("ord"))});var s="",o,l;e.bind("focus",function(){if(""!=s.trim())r.box.show();if(o)clearTimeout(o);o=setTimeout(function(){r.trigger("focus",[s,e.val()])},a);clearTimeout(l)}).bind("blur",function(){if(l)clearTimeout(l);l=setTimeout(function(){r.box.hide();r.box.find(".current").removeClass("current")},200)}).bind("keyup cut paste",function(t){if(s!=e.val()){if(o)clearTimeout(o);if("keyup"==t.type&&[13,27,38,39,40].indexOf(t.keyCode)>-1)return;o=setTimeout(function(){s=e.val();if(""==s.trim())r.clear();else r.trigger("input",[s])},a)}}).bind("keydown",function(e){if(13==e.keyCode||27==e.keyCode)r.box.hide();else if(38==e.keyCode)r.prev();else if(39==e.keyCode)r.box.find("a.current").click();else if(40==e.keyCode)r.next()})},clear:function(){this.boxc.html("");this.box.hide();return this},expand:function(e,t){var i=this;if(void 0===e)return;i.exItem.hide();i.exItem.forEach(function(a){var n=$(a);if(n.attr("ord")==t){n.show();i.trigger("expand",[e,t,n])}})},hightLine:function(e,i){i=t.substr(i,26);var a=e?e.length:0;var n=i.substring(0,a);return{w:0===a?i:n,q:0!=a?i.substring(a):""}},add:function(e){var n=this;var r=['<ul class="g_search_l">'];var s=['<div class="g_search_p">'];var o=e.q||"";var l=[];var c;i.helper("split",t.split);e.r.forEach(function(e,t){if(!e.c)return;e.mo="";e.u=e.u?e.u[0]:0;e.b=e.b||"";if(e.u){e.u.ord=t;e.u.e=e.u.e||1;l.push(e.u);!e.z&&(e.mo='<i class="mo iconfont">&#xe603;</i>')}e.i=t;e.k=n.hightLine(o,e.c);c=i.compile('<li><a href="###" pos="1" wordtype="<%=item.b%>" ord="<%=item.i%>" ex="<%=item.mo? 1: 0%>" ><span><%=item.k.w%><%if(item.k.q){%><b><%=item.k.q%></b><%}%></span><%==item.mo%></a></li>');r.push(c({item:e}))});r.push("</ul>");var u='<div class="g_search_p">\n<%data.forEach(function(dt){%>\n<%\nvar cate = dt.m || \'\';\nvar url = dt.d;\nvar person = dt.p || \'\';\nvar area = dt.w || \'\';\nvar bstyle = dt.b || \'\';\nif(dt.e == 2){\ndt.j = dt.n;\ndt.a = dt.p;\nurl = dt.u;\n}		\n%>	\n<div class="g_search_pack" data-e="<%=dt.e%>" ord="<%=dt.ord%>" <%if(dt.ord == 0){%> style="display:block"<%}%>>\n<div class="pic<%if(dt.e == 2){%> pic_u<%}%>">\n<a href="<%=url%>" target="_blank" pos="2" title="<%=dt.j%>"><img src="<%=dt.a%>" /></a>\n</div>			\n<h4><a href="<%=url%>" target="_blank" title="<%=dt.j%>"  pos="2" ><%=dt.j%></a></h4>\n<ul class="txt">\n<%if(cate){%>\n<li><%=cate%></li>\n<%}%>\n<%if(person && cate !== "å¨æ¼«" && dt.e != 2){%>\n<li><%=(cate === "çµå½±" || cate === "çµè§å§") ? "ä¸»æ¼" : "ä¸»æäºº"%>: <%=person%></li>\n<%}%>\n<%if (cate === "çµè§å§" || cate === "çµå½±" || cate === "å¨æ¼«") {%>\n<li>å¹´ä»£: <%=dt.y%></li>\n<%}%>\n<%if(area && cate !== "çµè§å§" && cate !== "çµå½±") {%>\n<li>å°åº: <%=area%></li>\n<%}%>\n<%if(bstyle === "1"){%>\n<li class="goplay"><a href="<%=dt.k%>" target="_blank" pos="5" >ç»§ç»­ç</a></li>\n<%}else if(dt.e != 2){%>\n<li class="play"><a href="<%=dt.k%>" target="_blank"  pos="3">æ­æ¾</a></li>				\n<%}%>\n<%if(dt.e == 2){%>\n<li>èç®ï¼<%=split(dt.c)%></li>\n<li>è®¢éï¼<%=split(dt.f)%></li>\n<li style="height:30px;"></li>\n<%}%>\n</ul>		\n<%if (url.indexOf(\'www.tudou.com/albumplay\') != -1 || url.indexOf(\'www.tudou.com/albumcover\') != -1 || dt.e == 2) {%>\n<%if(logined){%>\n<a href="#" class="gbtn_sub gBtnSub" data-type="<%=dt.e%>" data-id="<%=dt.i%>" style="display:none;"></a>\n<%}else{%>\n<span class="gbtn_sub gBtnSub" data-type="<%=dt.e%>" data-id="<%=dt.i%>" style="display:none;"><a title="ç¹å»è®¢é" href="#"><i class="iconfont">&#xe637;</i>è®¢é</a></span>\n<%}%>			\n<%}%>\n</div>\n<%});%>\n</div>';var d=i.compile(u)({data:l,logined:a.uid()});n.boxc.html(r.join("")+d);n.box.show();n.exItem=n.box.find(".g_search_pack");if(l[0]&&0==l[0].ord)n.trigger("expand",[1,0,n.exItem.eq(0)]);return this},msg:function(e){this.boxc.html(e);this.box.show();return this},prev:function(){var e=this.box.find(".current");if(e[0]){e.removeClass("current");e=e.closest("li").prev().find("a")}if(!e[0])e=this.box.find(".g_search_l a:last");this.expand(e.attr("ex"),e.attr("ord"));e.addClass("current");this.input.val(e.find("span").text());this.box.show();return this},next:function(){var e=this.box.find(".current");if(e[0]){e.removeClass("current");e=e.closest("li").next().find("a")}if(!e[0])e=this.box.find(".g_search_l a:first");this.expand(e.attr("ex"),e.attr("ord"));e.addClass("current");this.input.val(e.find("span").text());this.box.show();return this},current:function(){var e=this.box.find(".current");if(e[0])return e;else return null},node:function(){return this.box},render:function(){this.form.after(this.box);return this}});return n});define("module/nav/nav",["tui/net","tui/util","tui/art","tui/event","module/domain","module/global","module/login/login","tui/suggest","module/nav/user","tui/browser","module/responsive","module/sidebar/view","module/subscribe"],function(e,t,i,a,n,r,s,o,l,c,u,d,f,h,m){var p=encodeURIComponent;var g=n.url;var v=r.storage;m=new a;m.search=function(){window._initHeader=function(e){try{$(".g-search-text").each(function(){var t="";var i=this;var a=$(i);var n=[];var r;var s;a.blur(function(){if(null==a.val().match(/\S/)){a.val(t);a.addClass("g-search-focus").removeClass("g-bot-txtfocus");if(r&&r[0])r.removeClass("g-bot-btnfocus")}});a.focus(function(){if(a.val()==t)a.val("");a.removeClass("g-search-focus").addClass("g-bot-txtfocus");r=a.closest(".g-search-box").siblings(".g-search-submit");r[0]&&r.addClass("g-bot-btnfocus")});$(function(){if(!i["_gs_focus"]&&(!i.value||i.value==t)){a.val(t);a.addClass("g-search-focus")}});if(e&&e.sk){t=e.sk[0][0];a.val(t)}})}catch(t){}};var t=window.SUBDOMAIN||"www";var i=$("#gTop");if(i[0])if(!i.hasClass("g-mini"))e.getScript(g.main+"/util/tools/"+t+"_hd.txt",{charset:"gbk"})};m.subnav=function(){var e=$("#gTop .g-link-more");var t;e.mouseenter(function(){var e=this;t&&clearTimeout(t);t=setTimeout(function(){$(e).addClass("active")},100)}).mouseleave(function(){var e=this;t&&clearTimeout(t);t=setTimeout(function(){$(e).removeClass("active")},200)})};m.dropdown=function(){var e=$("#gMiniNav, #uploadNav,#ulogin");var t;e.mouseenter(function(){var e=$(this);$(".g_user_wrap>.active").not(e).removeClass("active");t&&clearTimeout(t);e.addClass("active");if(!e.find("iframe").length)e.find(".g_dropdown_menu").prepend('<iframe src="about:blank" class="mask" frameborder="0"></iframe>')}).mouseleave(function(){var e=$(this);t&&clearTimeout(t);t=setTimeout(function(){e.removeClass("active")},200)})};m.weixin=function(){var e=$("#gBot .qrcode");$("#gBot").on("mouseenter",".weixin",function(){e.show();var t=e.find(".lazy");if(t.length){t.attr("src",t.attr("alt"));t.removeClass("lazy").removeAttr("alt")}}).on("mouseleave",".sns",function(){e.hide()}).on("click",".weixin",function(e){e.preventDefault()})};m.showLoginStatus=function(){var e=this;var t=new l;t.showLoginStatus();t.bind("get:success",function(t){e.trigger("getUserInfo:success",[t])})};m.fixnav=function(e){e=$.extend({force:true,top:50,disabled:false},e);var t=$(window);var i=t.height();var a=$("#gTop");var n=a.find(".g_main");var r=$("#gTop .g_nav");var s=$("#gSideBar");var o=a.hasClass("g-mini-top");var l=0;var c=e.top;var u=t.scrollTop();var c="function"===$.type(c)?c():c;var d=e.force||c<i;n.append(r);if(e.disabled)return;var f=t.scrollTop()<=c;if(d){n.addClass("g_top_fix");s.addClass("g-sidebar-fixed")}if(!f){a.addClass("g-mini-top");n.addClass("g_top_fix");l=1}t.bind("scroll",function(){c="function"===$.type(c)?c():c;if(t.scrollTop()>u&&u>150)r.hide();else if(t.scrollTop()<u)!o&&r.show();u=t.scrollTop();f=t.scrollTop()<=c;if(!f&&0===l){a.addClass("g-mini-top");n.addClass("g_top_fix");l=1}if(f&&1===l){!o&&a.removeClass("g-mini-top");!d&&n.removeClass("g_top_fix");l=0}})};m.responsive=function(e){var t=e||[{s:[0,1276],v:"992"},{s:[1276,1e10],v:"1216"}];u.init(t);u.bind("responsed",function(){m.trigger("responsed")});return u};m.init=function(e){if(!e)e={};$.getScript("http://static.soku.com/v2.0.4/soku/giantstar/js/sk-box-open.js",function(){XBox.init({site:15,css:"http://static.soku.com/v2.0.4/soku/giantstar/css/s_kubox.css"})});m.subnav();m.search();m.weixin();m.fixnav(e.fixnav);m.dropdown();m.responsive(e.responsive);m.showLoginStatus();s.bind("after:login",m.showLoginStatus);$("#login").click(function(e){e.preventDefault();if(s.isLogin())m.showLoginStatus();else s.needLogin()});$("#reg").click(function(e){e.preventDefault();if(s.isLogin())m.showLoginStatus();else s.needLogin({isReg:true})})};return m});try{if(!/^http:\/\/(js|css)\.tudouui\.com\//.test(require.rootUrl))document.write("<scri"+'pt charset="utf-8" src="'+require.rootUrl+"/dist/js/autodomain.js?t="+Date.now()+'.js"></s'+"cript>")}catch(e){}define("g",["tui/cookie","tui/browser","module/login/login","module/global","module/nav/nav","module/ad/youku","module/stat/common","module/stat/pv","module/stat/ck","module/stat/comscore","module/stat/iwt","module/stat/jserror","module/translate/translate","module/user/notify","module/watchlater/main","page/btn/btn","module/uicommon","module/sidebar/view","module/subsrecom","lib/json2"],function(e,t,i,a,n,r,s,o,l,c,u,d,f,h,m,p,g,v,b,w,_,y){i.isLogin2();y.sendPv=function(){u.track();c.send();o.init()};y.init=function(t){if(!t)t={};y.sendPv();l.init();r.init(t.ad);function i(t,i){var a=$.trim(e("u_data"));var n={subnum:/subnum\|\d*/,updatenum:/updatenum\|\d*/}[t];if(""==a)a=t+"|"+i;else if(a.match(n))a=a.replace(n,t+"|"+i);else a+="_"+t+"|"+i;e("u_data",a,{domain:".tudou.com",path:"/"})}n.init(t);n.bind("getUserInfo:success",function(e){i("subnum",e.subNum)});var a=v.init();if(a)a.bind("getUpdateCount:success",function(e){i("updatenum",e.data)});b.init();p.bind("getUpdateCount:success",function(e){i("updatenum",e.data)});f.init();setTimeout(function(){h.show()},1e3);g()};y.initPartial=function(e,t){s.updateRefer(t);y.sendPv()}});require(["g"],function(){})}(window.jQuery);;