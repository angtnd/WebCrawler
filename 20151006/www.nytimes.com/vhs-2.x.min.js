!function(a){"use strict";var b=function(a,c,d){return 1===arguments.length?b.get(a):b.set(a,c,d)};b._document=document,b._navigator=navigator,b.defaults={path:"/"},b.get=function(a){return b._cachedDocumentCookie!==b._document.cookie&&b._renewCache(),b._cache[a]},b.set=function(c,d,e){return e=b._getExtendedOptions(e),e.expires=b._getExpiresDate(d===a?-1:e.expires),b._document.cookie=b._generateCookieString(c,d,e),b},b.expire=function(c,d){return b.set(c,a,d)},b._getExtendedOptions=function(c){return{path:c&&c.path||b.defaults.path,domain:c&&c.domain||b.defaults.domain,expires:c&&c.expires||b.defaults.expires,secure:c&&c.secure!==a?c.secure:b.defaults.secure}},b._isValidDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)&&!isNaN(a.getTime())},b._getExpiresDate=function(a,c){switch(c=c||new Date,typeof a){case"number":a=new Date(c.getTime()+1e3*a);break;case"string":a=new Date(a)}if(a&&!b._isValidDate(a))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return a},b._generateCookieString=function(a,b,c){a=a.replace(/[^#$&+\^`|]/g,encodeURIComponent),a=a.replace(/\(/g,"%28").replace(/\)/g,"%29"),b=(b+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),c=c||{};var d=a+"="+b;return d+=c.path?";path="+c.path:"",d+=c.domain?";domain="+c.domain:"",d+=c.expires?";expires="+c.expires.toUTCString():"",d+=c.secure?";secure":""},b._getCookieObjectFromString=function(c){for(var d={},e=c?c.split("; "):[],f=0;f<e.length;f++){var g=b._getKeyValuePairFromCookieString(e[f]);d[g.key]===a&&(d[g.key]=g.value)}return d},b._getKeyValuePairFromCookieString=function(a){var b=a.indexOf("=");return b=0>b?a.length:b,{key:decodeURIComponent(a.substr(0,b)),value:decodeURIComponent(a.substr(b+1))}},b._renewCache=function(){b._cache=b._getCookieObjectFromString(b._document.cookie),b._cachedDocumentCookie=b._document.cookie},b._areEnabled=function(){var a="cookies.js",c="1"===b.set(a,1).get(a);return b.expire(a),c},b.enabled=b._areEnabled(),"function"==typeof define&&define.amd&&"function"==typeof require&&require.version?define("cookies/vhs",function(){return b}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports.Cookies=b):window.Cookies=b}(),function(a,b){"object"==typeof exports?module.exports=b(require("jQuery"),require("Cookies")):"function"==typeof define&&define.amd&&"function"==typeof require&&require.version?define("vhs",["jquery/nyt","cookies/vhs"],b):a.VHS=b(a.jQuery,a.Cookies)}(this,function(a,b){"use strict";var c=a;if("undefined"==typeof c)throw new Error("VHS requires jQuery");var d=function(a){var b=function(b,e){var f,g=c(a);g.one("vhs:"+e,function(a,c){b(c)}),g.each(function(a,b){var g=c(b);g.data(e)&&(f=d.findInstance(g),g.trigger("vhs:"+e,f))})};return{ready:function(a){b(a,"ready")},loaded:function(a){b(a,"loaded")}}};return d.config={allowMultiplePlayers:!1},d.api=d.api||{},d.html=d.html||{},d.configs=d.configs||{},function(a){function b(a){return d[a]}function c(a){return a=null==a?"":String(a),a&&(e.lastIndex=0,e.test(a))?a.replace(e,b):a}this.VHS=a;var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},e=/[&<>"'`]/g,f=window._||{};f.escape=f.escape||c,this.VHS=this.VHS||{},this.VHS.templates=this.VHS.templates||{},this.VHS.templates.contextualMenu=function(a){{var b,c="";f.escape,Array.prototype.join}return c+='<ul class="'+(null==(b=a.pluginClassName)?"":b)+'">\n',a.items.forEach(function(a){c+='\n  <li class="'+(null==(b=a.isVersion?"version ":"")?"":b)+(null==(b=a.isActive?"active":"")?"":b)+'">'+(null==(b=a.text)?"":b)+"</li>\n"}),c+="\n</ul>\n"},this.VHS.templates.copySlate=function(a){{var b,c="";f.escape}return c+='<div class="'+(null==(b=a.pluginClassName)?"":b)+'">\n    <i class="'+(null==(b=a.pluginClassName+"-close-button")?"":b)+'">\n        <span class="vhs-copy-slate-close-button-x">\n            &#215;\n        </span>\n    </i>\n    <div class="'+(null==(b=a.pluginClassName+"-center-container")?"":b)+'">\n        <h4>'+(null==(b=a.text)?"":b)+'</h4>\n        <div class="vhs-embed-form-container">\n            <input type="text" value="'+(null==(b=a.value)?"":b)+'" />\n        </div>\n    </div>\n</div>\n'},this.VHS.templates.cover=function(a){{var b,c="";f.escape,Array.prototype.join}return c+='<div class="vhs-player-cover-background vhs-'+(null==(b=a.mode)?"":b)+'-cover"></div>\n',"mobile"===a.mode&&(c+='\n    <i class="vhs-icon-play vhs-cover-play-button vhs-mobile-play-button"></i>\n'),c+='\n<div class="vhs-media-action-overlay vhs-'+(null==(b=a.mode)?"":b)+'-cover">\n    <i class="vhs-icon-play vhs-cover-play-button"></i>\n\n    ',"clean"!==a.mode&&(c+='\n    <div class="vhs-metadata-container">\n\n        ',"duration"===a.mode?c+='\n            <section class="vhs-metadata">\n                <span class="vhs-video-cta">Play Video</span>\n                <span class="vhs-video-length">'+(null==(b=a.data.duration)?"":b)+"</span>\n            </section>\n        ":("article"===a.mode||"offsite"===a.mode||"mobile"===a.mode)&&(c+='\n            <section class="vhs-metadata">\n                ',"mobile"!==a.mode&&(c+="\n                    ",a.data.channelName&&(c+='\n                        <span class="vhs-channel-name">'+(null==(b=a.data.channelName)?"":b)+"</span>\n                    "),c+="\n                    ",a.data.showName&&(c+='\n                        <span class="vhs-show-name">'+(null==(b=a.data.showName)?"":b)+"</span>\n                    "),c+="\n                "),c+="\n                ",c+=a.data.byline?'\n                    <span class="vhs-byline">'+(null==(b=a.data.byline)?"":b)+"</span>\n                ":'\n                    <span class="vhs-byline vhs-no-byline"></span>\n                ',c+='\n                <span class="vhs-video-cta">Play Video</span>\n                <span class="vhs-video-length">'+(null==(b=a.data.duration)?"":b)+'</span>\n            </section>\n            <section class="vhs-video-title">\n                <span>'+(null==(b=a.data.headline)?"":b)+"</span>\n            </section>\n        "),c+="\n    </div>\n    "),c+="\n\n    ","offsite"===a.mode&&(c+='\n        <i class="vhs-icon-times-video-logo vhs-embedded-player-cover-logo"></i>\n    '),c+="\n\n</div>\n"},this.VHS.templates.deeplinkingClickOverlay=function(a){{var b="";f.escape}return b+='<div class="nytd-player-video-area" >\n    <div class="nytd-player-deeplinking-message-container" >\n        <span class="nytd-player-deeplinking-message" >\n            Watch in Times Video &#187;\n        </span>\n    </div>\n</div>\n'},this.VHS.templates.embedCode=function(a){{var b,c="";f.escape}return c+='<iframe\n title="'+(null==(b=a.title)?"":b)+'"\n width="480"\n height="321"\n frameborder="0"\n scrolling="no"\n allowfullscreen="true"\n marginheight="0"\n marginwidth="0"\n id="'+(null==(b=a.id)?"":b)+'"\n src="'+(null==(b=a.src)?"":b)+'">\n</iframe>\n'},this.VHS.templates.endSlate=function(a){{var b,c="";f.escape,Array.prototype.join}return c+='<div class="vhs-end-slate-background"></div>\n<div data-id="'+(null==(b=a.data.id)?"":b)+'" class="vhs-player-header" data-vhs-et-module="end-slate" data-vhs-et-region="end-slate-header">\n    <div class="vhs-video-title">\n        <a href="http://www.nytimes.com/video" target="_blank" class="vhs-times-logo vhs-icon-times-video-logo vhs-anchor-button" data-vhs-et-name="link-logo"></a>\n        ',a.data.byline||(a.titleClasses="vhs-no-byline"),c+='\n        <div class="vhs-video-title-wrapper '+(null==(b=a.titleClasses)?"":b)+'">\n            <p class="vhs-data"> '+(null==(b=a.data.headline)?"":b)+'</p>\n            <span class="vhs-byline"><span>'+(null==(b=a.data.byline)?"":b)+'</span></span>\n        </div>\n    </div>\n</div>\n<div class="vhs-end-slate" data-vhs-et-module="end-slate" data-vhs-et-region="end-slate-share">\n    <div class="vhs-social">\n        <button class="vhs-anchor-button vhs-social-icon-wrapper vhs-replay-button" data-vhs-et-name="replay">\n            <h2>Replay</h2>\n            <i class="vhs-icon-replay"></i>\n        </button>\n        ',a.url||(c+='\n        <a class="vhs-anchor-button vhs-social-icon-wrapper" target="_blank" href="'+(null==(b=a.url||a.data.domain+a.data.seo_url)?"":b)+'" data-vhs-et-name="link-logo">\n            <h2>Times Video</h2>\n            <i class="vhs-anchor-button vhs-icon-times-video-logo"></i>\n        </a>\n        '),c+='\n        <button class="vhs-anchor-button vhs-share-item vhs-social-icon-wrapper" alt="facebook" data-share-handler="popup" data-share-name="facebook" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-facebook">\n            <h2>Share</h2>\n            <i class="vhs-icon-facebook"></i>\n        </button>\n        <button class="vhs-anchor-button vhs-share-item vhs-social-icon-wrapper" alt="twitter" data-share-handler="urlshortener" data-share-name="twitter" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-twitter">\n            <h2>Tweet</h2>\n            <i class="vhs-icon-twitter"></i>\n        </button>\n    </div>\n</div>\n'},this.VHS.templates.flash=function(a){{var b,c="";f.escape}return c+='<object type="application/x-shockwave-flash" id="'+(null==(b=a.objectId)?"":b)+'" data="'+(null==(b=a.swfPath)?"":b)+'" width="100%" height="100%" style="visibility: visible;">\n   <param name="allowFullScreen" value="true">\n   <param name="allowScriptAccess" value="always">\n   <param name="wmode" value="opaque">\n   <param name="seamlessTabbing" value="false">\n   <param name="swliveconnect" value="true">\n   <param name="quality" value="high">\n   <param name="bgcolor" value="#000000">\n   <param name="flashvars" value="'+(null==(b=a.flashVars)?"":b)+'">\n</object>\n'},this.VHS.templates.pauseSlate=function(a){{var b,c="";f.escape,Array.prototype.join}if(c+='<div class="vhs-player-header-background"></div>\n<div data-id="'+(null==(b=a.data.id)?"":b)+'" class="vhs-player-header vhs-pause-slate vhs-top-banner">\n    <div class="vhs-video-title">\n        <a href="http://www.nytimes.com/video" target="_blank" class="vhs-times-logo vhs-icon-times-video-logo vhs-anchor-button '+(null==(b=a.view.logoClasses)?"":b)+'"></a>\n        ',a.data.byline||(a.view.titleClasses+=" vhs-no-byline"),c+='\n        <div class="vhs-video-title-wrapper '+(null==(b=a.view.titleClasses)?"":b)+'">\n\n            ',!a.linkUrl||a.isOnSite&&a.isEmbeddedOnly?c+='\n                <p class="vhs-data"> '+(null==(b=a.data.headline)?"":b)+" </p>\n            ":(c+='\n                <p class="vhs-data"> <a href="'+(null==(b=a.linkUrl)?"":b)+'?action=click&amp;gtype=vhs&amp;version=vhs-heading&amp;module=vhs&amp;region=title-area" ',a.isOnSite||(c+=' target="_blank" '),c+=" > "+(null==(b=a.data.headline)?"":b)+" </a> </p>\n            "),c+='\n\n            <span class="vhs-byline">\n                <span>'+(null==(b=a.data.byline)?"":b)+"</span>\n            </span>\n        </div>\n    </div>\n    ",a.showShareTools&&(c+='\n    <div class="vhs-tools '+(null==(b=a.view.shareClasses)?"":b)+'" data-vhs-et-module="video-player-share" data-vhs-et-region="playback-share">\n        <div class="vhs-social">\n            <button class="vhs-share-item vhs-icon-facebook" alt="facebook" data-share-handler="popup" data-share-name="facebook" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-facebook"></button>\n            <button class="vhs-share-item vhs-icon-twitter" alt="twitter" data-share-handler="urlshortener" data-share-name="twitter" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-twitter"></button>\n        </div>\n        <div class="vhs-embed">\n            <button class="vhs-share-menu vhs-icon-embed" alt="embed" data-vhs-et-name="share-embed"></button>\n        </div>\n    </div>\n    '),c+='\n</div>\n<div class="vhs-share-module-overlay"></div>\n',a.showShareTools){c+='\n<div class="vhs-share-module" data-vhs-et-module="video-player-share" data-vhs-et-region="playback-extended-share">\n    <div class="vhs-share-module-arrow"></div>\n    <div class="vhs-share-module-inner">\n        <div class="vhs-times-video-link vhs-share-section">\n            <div class="vhs-icon-group">\n                <span>Times Video</span>\n                <a href="http://www.nytimes.com/video" target="_blank" class="vhs-times-logo vhs-icon-times-video-logo vhs-anchor-button"></a>\n            </div>\n        </div>\n        <div class="vhs-share-sidebar">\n            <div class="vhs-social vhs-share-section">\n                <div class="vhs-icon-group">\n                    <span>Share</span>\n                    <button class="vhs-share-item vhs-icon-facebook" alt="facebook" data-share-handler="popup" data-share-name="facebook" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-facebook"></button>\n                </div>\n                <div class="vhs-icon-group">\n                    <span>Tweet</span>\n                    <button class="vhs-share-item vhs-icon-twitter" alt="twitter" data-share-handler="urlshortener" data-share-name="twitter" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-twitter"></button>\n                </div>\n            </div>\n            <div class="vhs-embed vhs-share-section">\n                <div class="vhs-icon-group">\n                    <label for="vhs-embed-form">Embed</label>\n                    <button class="vhs-icon-embed" alt="embed"></button>\n                    <div class="vhs-embed-form-container">\n                        ';var d=a.data.article_data&&a.data.article_data.id?"&amp;articleId="+a.data.article_data.id:"";c+="\n                        ";var e=!d&&a.data.blogpost_data&&a.data.blogpost_data.url?"&amp;blogPostUrl="+a.data.blogpost_data.url:"";c+='\n                        <input\n                            onClick="this.setSelectionRange(0, this.value.length)"\n                            id="vhs-embed-form"\n                            type="text"\n                            value="<iframe width=&quot;480&quot; height=&quot;321&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot; allowfullscreen=&quot;true&quot; marginheight=&quot;0&quot; marginwidth=&quot;0&quot; id=&quot;nyt_video_player&quot; title=&quot;New York Times Video - Embed Player&quot; src=&quot;http://graphics8.nytimes.com/video/players/offsite/index.html?videoId='+(null==(b=a.data.id)?"":b)+"&amp;playerType=embed"+(null==(b=d)?"":b)+(null==(b=e)?"":b)+'&quot;></iframe>">\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'}return c+="\n\n\n"}}.call({},d),d.util={extend:function(a){function b(){}return Object.create?Object.create(a):(b.prototype=a,new b)},checkFlashSupport:function(){var a=d.util.getFlashVersion();return parseInt(a.split(",").shift(),10)>=10},getFlashVersion:function(){try{try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{a.AllowScriptAccess="always"}catch(b){return"6,0,0"}}catch(b){}return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(b){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(c){}}return"0,0,0"},checkHtmlSupport:function(){var a=document.createElement("video"),b=document.createElement("canvas").getContext,c=!1;return a&&b&&(c=!0),c},supportWebM:function(){var a='video/webm; codecs="vp8, vorbis"';return this.canPlayType(a)},supportH264:function(){var a='video/mp4; codecs="avc1.42E01E"',b='video/mp4; codecs="avc1.42E01E, mp4a.40.2"';return this.canPlayType(a)||this.canPlayType(b)},supportHLS:function(a){return"flash"===a||this.isSafari()||this.isIphone()||this.isIpad()},canPlayType:function(a){var b=document.createElement("video");return"function"==typeof b.canPlayType&&""!==b.canPlayType(a)},getDeviceType:function(){for(var a=null,b=d.util.getUserAgent(),c=[["android_chrome","(android.*chrome)"],["android_firefox","(android.*firefox)"],["android_legacy","(android )(2|3)"],["android_ics","(android 4.0)"],["android_jellybean","(android 4.)(1|2|3)"],["android_kitkat","(android 4.4)"],["ie_mobile","(windows phone).*(iemobile)"],["ipad","ipad"],["kindle","kindle"],["iphone","iphone"],["other mobile","(touchpad|blackberry|opera mobi)"]],e=0;e<c.length;e++){var f=new RegExp(c[e][1]),g=b.match(f);null!==g&&(a=c[e][0])}return a||"desktop"},isIphone:function(){return-1!==d.util.getUserAgent().indexOf("iphone")?!0:!1},isIpad:function(){return-1!==d.util.getUserAgent().indexOf("ipad")?!0:!1},isIE9:function(){return-1!==d.util.getUserAgent().indexOf("msie 9")?!0:!1},isAndroid:function(){return-1!==d.util.getUserAgent().indexOf("android")?!0:!1},isSafari:function(){var a=d.util.getUserAgent();return-1!==a.indexOf("safari")&&!d.util.isChrome()},isChrome:function(){return-1!==d.util.getUserAgent().indexOf("chrome")?!0:!1},isFirefox:function(){return-1!==d.util.getUserAgent().indexOf("firefox")?!0:!1},getUserAgent:function(){var a=d.util.getNavigator();return a.userAgent.toLowerCase().replace(/\[.*\]/,"")},supportsAds:function(){return"android_legacy"===d.util.getDeviceType()||"android_ics"===d.util.getDeviceType()?!1:!0},supportsAutoplay:function(){return!(d.util.isAndroid()||d.util.isIpad()||d.util.isIphone())},getErrorMessage:function(a,b,c){var d,e=a;if(d=b&&"vod"===b?"This video is currently unavailable.":"This stream is not currently available.",e&&e.code)switch(e.code){case e.MEDIA_ERR_ABORTED:d="The video playback was aborted. Please refresh to resume playback.";break;case e.MEDIA_ERR_NETWORK:d="The video connection was lost. Please refresh to resume playback.";break;case e.MEDIA_ERR_DECODE:d="There was a video playback error. Please refresh to resume playback.";break;case e.MEDIA_ERR_SRC_NOT_SUPPORTED:d=c?"This video is currently unavailable. Please refresh to try again.":"The video format is currently not supported in this browser."}return d},getWindow:function(){return window},getDocument:function(){return document},getNavigator:function(){return navigator},getHost:function(){return window.location.host},getQueryString:function(){return window.location.search},getHash:function(){return window.location.hash},getParentHostname:function(){try{return parent.window.location.hostname}catch(a){return""}},getReferrer:function(){return document.referrer},getSupportedType:function(a){return"flash"===a||this.supportH264()?"mp4":this.supportWebM()?"webm":void 0},supportsFullscreen:function(){return d.api.Fullscreen.prototype._canRequestFullScreen()},zeptoInUse:function(){return"object"==typeof c.zepto},jqueryInUse:function(){return"string"==typeof c.fn.jquery},getScript:function(a){d.util.jqueryInUse()?(a.dataType="script",c.ajax(a)):d.util.getScriptNative(a)},getScriptNative:function(a){var b,c,e,f,g,h,i=document.createElement("script");b=a.url,c=a.success,e=a.error,i.type="text/javascript",i.src=b,i.onload=function(){"function"==typeof c&&c()},i.onerror=function(a){"function"==typeof e&&e(a)},h=d.util.getDocument(),f=h.getElementsByTagName("head")[0],f?f.appendChild(i):(g=h.getElementsByTagName("body")[0],g&&g.appendChild(i))},normalizeUnit:function(a){var b="px";return"string"==typeof a&&(a=-1===a.indexOf("%")&&-1===a.indexOf("px")?[a,b].join(""):a),a},inIframe:function(){try{return window.self!==window.top}catch(a){return!0}},isOnNYTDomain:function(){var a,b=this.getReferrer();return this.inIframe()&&b&&-1===b.indexOf(".nytimes.com")?!1:this.inIframe()||(a=this.getParentHostname(),-1!==a.indexOf(".nytimes.com"))?!0:!1},seekStringToSeconds:function(a){var b,c=0,d=this.getUrlParameterByName("t"),e={h:3600,m:60,s:1};return isNaN(d)?(b=d.match(/[0-9]+[hms]+/g)||[],b.forEach(function(a){if(a){var b=a[a.length-1],d=parseInt(a.slice(0,a.length-1),10);c+=d*e[b]}}),c):Number(d)},getCurrentURL:function(){return window.location.href},getUrlParameterByName:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&#]"+a+"=([^&#]*)"),c=b.exec(this.getCurrentURL());return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},getEnvFromHost:function(){var a=d.util.getHost()||"",b="production";return"localhost"===a?b="localhost":-1!==a.indexOf(".dev.")?b="development":(-1!==a.indexOf(".stg.")||-1!==a.indexOf(".sbx."))&&(b="staging"),b},getPlayerMode:function(a,b,e){var f=d.util.isSafari()||!a&&(d.util.isFirefox()||d.util.isChrome());return d.util.isChrome()&&"article-lede"===b&&c("#"+e).closest("figure.video").hasClass("layout-jumbo-horizontal")&&(f=!1),!d.util.checkFlashSupport()||"html5"===a&&this.getSupportedType()||f?"html5":"flash"},escapeHtml:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},serialize:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+"="+a[c]);return b.join("&")}},d.api.Logger=function(a){this.debug=a.options.debug,this.canConsole=a.options.debug&&window.console},d.api.Logger.prototype={log:function(){this.canConsole&&window.console.log(arguments)},info:function(){this.canConsole&&window.console.info(arguments)},warn:function(){this.canConsole&&window.console.warn(arguments)},error:function(){this.canConsole&&window.console.error(arguments)}},d.configs.features={"test-feature":{environments:{production:!1,staging:!1,development:!0,localhost:!0}},"flash-hd-switch-seek":{environments:{production:!0,staging:!0,development:!0,localhost:!0}},"poster-image-select":{ticket:"https://jira.nyt.net/browse/VR-6438",environments:{production:!0,staging:!0,development:!0,localhost:!0}},hls:{ticket:"https://jira.nyt.net/browse/VR-6966",environments:{production:!0,staging:!0,development:!0,localhost:!0}}},d.api.FeatureFlags=function(a){this._player=a,this._options=a.options,this._logger=a.logger,this.config=d.configs.features||{}},d.api.FeatureFlags.prototype={isEnabled:function(a){var b=!1;if(a in this.config){try{b=this.config[a].environments[this._options.env]}catch(c){this._logger.warn("feature flags: config for feature '"+a+"' in env '"+this._options.env+"' is missing or malformed")}"boolean"!=typeof b&&(b=!1)}return b}},d.api.Poller=function(a,b,c,d){this._id=null,this._polling=!1,this._tryCount=0,this._maxTries=c,this._interval=b,this._callback=d,this._objectName=a},d.api.Poller.prototype={start:function(){this._polling||this._poll()},cancel:function(){window.clearTimeout(this._id),this._polling=!1},isPolling:function(){return this._polling},_poll:function(){this._polling=!0,this._id=window.setTimeout(c.proxy(this._check,this),this._interval)},_check:function(){this.cancel(),this._getObjectToCheck(this._objectName)?this._callback():this._tryCount<this._maxTries&&this._poll(),this._tryCount++},_getObjectToCheck:function(a){var b,e=d.util.getWindow();if("string"==typeof a)b=e[a];else if(c.isArray(a)){b=e;for(var f=0,g=a.length;g>f;f++){if(!b[a[f]]){b=null;break}b=b[a[f]]}}return b}},d.plugin=function(a,b,c){var e=c||!1,f=d.api._plugins||{};return b._on=function(a,b){this._player.on(/^plugin:/gi.test(a)?a:"plugin:"+this._name+":"+a,b)},b._off=function(a,b){this._player.off(/^plugin:/gi.test(a)?a:"plugin:"+this._name+":"+a,b)},b._trigger=function(a,b){this._player.trigger(/^plugin:/gi.test(a)?a:"plugin:"+this._name+":"+a,b)},f[a]={enable:e,proto:b},d.api._plugins=f,f},d.api.Plugins=function(a){this.player=a,this._plugins=d.api._plugins,this._pluginInstances=[],this.register()},d.api.Plugins.prototype.register=function(){var a,b,c=this,d=this.player.options,e=function(){this._player=c.player,this._container=c.player.container,this._data=c.player._data,this._options=c.player.options,this._logger=c.player.logger};for(a in this._plugins)(d[a]===!0||this._plugins[a].enable===!0&&d[a]!==!1)&&(e.prototype=this._plugins[a].proto,b=new e,b._name=a,this._pluginInstances.push(b),"function"==typeof b._initialize&&b._initialize(),this.listeners(b))},d.api.Plugins.prototype.reload=function(){var a,b;for(a in this._pluginInstances)b=this._pluginInstances[a],b._data=this.player._data},d.api.Plugins.prototype.listeners=function(a){var b=function(b,c){"function"==typeof a[c]&&this.player.on(d.api.events[b],function(b){a[c](b)})},c={READY:"_ready",LOADED:"_loaded",PLAY:"_play",PAUSE:"_pause",MUTE:"_mute",SEEKED:"_seeked",ENDED:"_ended",PLAYING:"_playing",AD_STARTED:"_ad_started",AD_COMPLETED:"_ad_completed",AD_PAUSED:"_ad_paused",AD_RESUMED:"_ad_resumed",AD_SKIPPED:"_ad_skipped",GO_FULLSCREEN:"_go_fullscreen",EXIT_FULLSCREEN:"_exit_fullscreen",PROGRESS:"_progress",TIME_UPDATE:"_time_update",LOAD_START:"_loadstart",ERROR:"_error",HD_ON:"_hd_on",HD_OFF:"_hd_off",SHOW_CONTROLS:"_show_controls",HIDE_CONTROLS:"_hide_controls",RENDERED:"_rendered",TRACKING_EVENT:"_tracking_event",RENDITION_NOT_FOUND:"_rendition_not_found"};for(var e in c)c.hasOwnProperty(e)&&b.call(this,e,c[e])},d.plugin("webtrends",{_initialize:function(){this.utils=d.util,this.tracked=!1,this.firstPlay=!0,this.trackingHistory=[],this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1},getId:function(){if(this._data||this._options.id){var a=this._data?this._data.id:this._options.id;return a}return this._logger.warn("VHS::PLUGIN::WEBTRENDS:: ID is not defined"),!1},getName:function(){if(this._data||this._options.name){var a=this._data?this._data.headline:this._options.name;return a}return this._logger.warn('VHS::PLUGIN::WEBTRENDS:: NAME is optional <video data-setup=\'{"name: "name_video"}\'></video>'),!1},getCategory:function(){var a;if(this._data)this._data.section&&(a=this._data.section.content);else{if(!this._options.category)return this._logger.warn('VHS::PLUGIN::WEBTRENDS:: CATEGORY is optional <video data-setup=\'{"category: "category_video"}\'></video>'),!1;a=this._options.category}return a},getSeries:function(){var a="";if(this._data)this._data.contentSeries&&(a=this._data.contentSeries.name);else{if(!this._options.series)return this._logger.warn('VHS::PLUGIN::WEBTRENDS:: SERIES is optional <video data-setup=\'{"series: "series_video"}\'></video>'),!1;a=this._options.series}return a},getParams:function(a){var b=["DCS.dcssip","www.nytimes.com","DCS.dcsuri","/video/"+this.getName()+"/"+a.action+".html","WT.ti","Video "+this.getName()+" "+a.ti,"WT.cg_n","Video","WT.videoCategory",this.getCategory(),"WT.videoEvent",a.event,"WT.videoLoad",a.load,"WT.videoName",this.getName(),"WT.z_gpt","Multimedia","WT.z_gpst","Video","WT.z_gpsst","Video-"+a.gpsst,"WT.z_vid",this.getId(),"WT.z_vpt",this._player.getPlayerType()+"|"+this.utils.getDeviceType(),"WT.z_vft",this.getSeries(),"WT.z_dcsm",1];return a.z_vaud&&"Audio"===a.action&&b.push("WT.z_vaud",a.z_vaud),b},track:function(a){"undefined"!=typeof window.dcsMultiTrack?(this._logger.info("VHS::PLUGIN::WEBTRENDS::",a),window.dcsMultiTrack.apply(this,a),this.sendTrackingQueue(),this.wtPoller&&this.wtPoller.isPolling()&&this.wtPoller.cancel()):(this.trackingHistory.push(a),this.wtPoller||(this.wtPoller=new d.api.Poller("dcsMultiTrack",1e3,30,c.proxy(this.sendTrackingQueue,this)),this.wtPoller.start()))},sendTrackingQueue:function(){if(this.trackingHistory.length>0){for(var a=0,b=this.trackingHistory.length;b>a;a++)window.dcsMultiTrack.apply(this,this.trackingHistory[a]);this.trackingHistory=[]}},_play:function(){if(!this.tracked){var a,b={action:"Play",event:"play",gpsst:"Play"};this._options.autoplay&&this.firstPlay&&!this._options.userInitiatedPlay?(b.ti=this._options.autoPlayNext?"Play":"PlayStart",b.load="auto",this.firstPlay=!1):this.firstPlay?(b.ti="PlayStart",b.load="user",this.firstPlay=!1):this._options.userInitiatedNext?(b.ti="Play",b.load="user"):this.videoCompleted&&!this.adStarted&&this.mediaChanged?(b.ti="Play",b.load="auto"):this.videoCompleted&&this.adStarted&&this.adCompleted&&this.mediaChanged?(b.ti="Play",b.load="auto"):(b.ti="Play",b.load="user"),a=this.getParams(b),this.track(a),this.tracked=!0,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1}},_mute:function(a){var b;b=this.getParams(a?{action:"Audio",event:"AudioOff",load:"null",gpsst:"Audio",ti:"Audio",z_vaud:"Off"}:{action:"Audio",event:"AudioOn",load:"null",gpsst:"Audio",ti:"Audio",z_vaud:"On"}),this.track(b)},_ended:function(){var a=this.getParams({action:"Finish",event:"finish",load:"null",gpsst:"Play",ti:"FinishStop"});this.track(a),this.tracked=!1,this.videoCompleted=!0},_go_fullscreen:function(){var a=this.getParams({action:"GoBig",event:"Go Big",load:"null",gpsst:"Play",ti:"GoBig"});this.track(a)},_exit_fullscreen:function(){var a=this.getParams({action:"GoSmall",event:"Go Small",load:"null",gpsst:"Play",ti:"GoSmall"});this.track(a)},_ad_started:function(){this.adStarted=!0},_ad_completed:function(){this.adCompleted=!0},_ad_skipped:function(){this.adCompleted=!0},_loadstart:function(){this.tracked=!1,this.mediaChanged=!0}},!0),d.plugin("comscore",{_initialize:function(){this.tracked=!1},loadLibrary:function(a){var b=("https:"===document.location.protocol?"https://sb":"http://b")+".scorecardresearch.com/beacon.js";d.util.getScript({url:b,success:a,dataType:"script"})},getParams:function(a){var b=this._player.adPlaying()?"09":"02",c={c1:1,c2:"3005403",c3:"",c4:"",c5:b};return this._logger.log("VHS::PLUGIN::COMSCORE::",c),c},track:function(){var a=this.getParams();"undefined"!=typeof COMSCORE&&COMSCORE.beacon?COMSCORE.beacon(a):this.loadLibrary(function(){"undefined"!=typeof COMSCORE&&COMSCORE.beacon&&COMSCORE.beacon(a)})},_playing:function(){this.tracked||(this.track(),this.tracked=!0)},_ended:function(){this.tracked=!1},_ad_started:function(){this.track()},_loadstart:function(){this.tracked=!1}},!0),d.plugin("eventTracker",{_initialize:function(){this.util=d.util,this.ETEvents={USER_PLAY:"user-play",MID_STREAM_PLAY:"mid-stream-play",AUTO_PLAY_NEXT:"auto-play-next",AUTO_PLAY_START:"auto-play-start",VIDEO_COMPLETE:"video-complete",PAUSE:"pause",UNPAUSE:"unpause",GO_FULLSCREEN:"go-fullscreen",EXIT_FULLSCREEN:"exit-fullscreen",MUTED:"muted",UNMUTED:"unmuted",SKIP_AD:"skip-ad",AD_START:"ad-start",AD_COMPLETE:"ad-complete",PLAYER_LOAD:"player-load",PERCENT_25_VIEWED:"percent-25-viewed",PERCENT_50_VIEWED:"percent-50-viewed",PERCENT_75_VIEWED:"percent-75-viewed",SEEK:"seek",AD_PAUSE:"ad-pause",AD_RESUME:"ad-resume",MEDIA_ERROR:"media-error",HD_ON:"hd-on",HD_OFF:"hd-off",VIDEO_TIME_TO_START:"video-time-to-start",QOS_LOAD_FAILURE:"qos-library-load-failure",RENDITION_NOT_FOUND:"rendition-not-found",FW_ADMANAGER_LOAD_ERROR:"fw-admanager-load-error",FW_AD_MANAGER_LOAD_TIMEOUT:"fw-ad-manager-load-timeout",CHERRY_API_REQUEST_ERROR:"cherry-api-request-error",OSMF_HLS_PLUGIN_LOAD_FAILED:"osmf-hls-plugin-load-failed",OSMF_QOS_PLUGIN_LOAD_FAILED:"osmf-qos-plugin-load-failed",OSMF_FW_AD_REQUEST_TIMEOUT:"osmf-fw-ad-request-timeout",OSMF_FW_AD_MANAGER_LOAD_TIMEOUT:"osmf-fw-ad-manager-load-timeout",OSMF_FW_AD_MANAGER_LOAD_TIME:"osmf-fw-ad-manager-load-time"},this.tracker=null,this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.paused=!1,this.firstPlay=!0,this.trackingHistory=[],this.adDurationCache=null,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1,this.loadedTimestamp=null,this.endTimestamp=null,this.startUpTimeSent=!1,this.percentages={duration:0,calculate:function(a,b){if(!(1>a||b.length<1)){this.duration=a;for(var c=b.length-1;c>=0;c--)this[b[c]]=.01*a*b[c];this.ready=!0}}}},isAdPlaying:function(){return this._player&&this._player.adsController&&(this._player.adsController.isContentPlaying||this._player.adsController.isInitializing)},getId:function(){if(this._data||this._options.id){var a=this._data?this._data.id:this._options.id;return a}return this._logger.warn("VHS::PLUGIN::EVENTTRACKER:: ID is not defined"),!1},getName:function(){if(this._data||this._options.name){var a=this._data?this._data.headline:this._options.name;return a}return this._logger.warn('VHS::PLUGIN::EVENTTRACKER:: NAME is optional <video data-setup=\'{"name: "name_video"}\'></video>'),
!1},getCategory:function(){var a;if(this._data)this._data.section&&(a=this._data.section.content);else{if(!this._options.category)return this._logger.warn('VHS::PLUGIN::EVENTTRACKER:: CATEGORY is optional <video data-setup=\'{"category: "category_video"}\'></video>'),!1;a=this._options.category}return a},getSeries:function(){var a="";if(this._data)this._data.contentSeries&&(a=this._data.contentSeries.name);else{if(!this._options.series)return this._logger.warn('VHS::PLUGIN::EVENTTRACKER:: SERIES is optional <video data-setup=\'{"series: "series_video"}\'></video>'),!1;a=this._options.series}return a},getPrimaryPlaylistId:function(){var a;return this._data?(this._data.playlist&&(a=this._data.playlist.id),a):(this._logger.warn("VHS::PLUGIN::EVENTTRACKER:: playlistId missing _data"),!1)},getCurrentVideoPosition:function(){var a,b=0;return this._element&&this._element.length>0&&this._element[0].currentTime&&(a="function"==typeof this._element[0].currentTime?this._element[0].currentTime():this._element[0].currentTime,b=Math.round(a)),b},getErrorCode:function(a){var b="";return this._element&&this._element.length>0&&this._element[0].error?b=this._element[0].error.code:a&&a.error&&a.error.code&&(b=a.error.code),b},getTrackingObject:function(a){var b=this,c={subject:"video-nytv",url:window.location.href||"",referrer:document.referrer||"",playerType:b._player.getPlayerType()||"",device:b.util.getDeviceType(),tech:b._player.getType(),event:a||"",playerVersion:d._version,playerUsage:b._options.usage||"",playerMode:b._options.mode,videoDeliveryMethod:b._options.live?"live":"vod"};switch(a){case this.ETEvents.USER_PLAY:case this.ETEvents.AUTO_PLAY_NEXT:case this.ETEvents.AUTO_PLAY_START:case this.ETEvents.VIDEO_COMPLETE:case this.ETEvents.PAUSE:case this.ETEvents.UNPAUSE:case this.ETEvents.PERCENT_25_VIEWED:case this.ETEvents.PERCENT_50_VIEWED:case this.ETEvents.PERCENT_75_VIEWED:case this.ETEvents.PLAYER_LOAD:case this.ETEvents.SEEK:case this.ETEvents.MEDIA_ERROR:case this.ETEvents.HD_ON:case this.ETEvents.HD_OFF:case this.ETEvents.QOS_LOAD_FAILURE:case this.ETEvents.RENDITION_NOT_FOUND:case this.ETEvents.FW_ADMANAGER_LOAD_ERROR:case this.ETEvents.FW_AD_MANAGER_LOAD_TIMEOUT:case this.ETEvents.OSMF_HLS_PLUGIN_LOAD_FAILED:case this.ETEvents.OSMF_QOS_PLUGIN_LOAD_FAILED:case this.ETEvents.OSMF_FW_AD_MANAGER_LOAD_TIMEOUT:case this.ETEvents.OSMF_FW_AD_MANAGER_LOAD_TIME:c=this.addBaseVideoProps(c),c=this.addVideoProps(c);break;case this.ETEvents.GO_FULLSCREEN:case this.ETEvents.EXIT_FULLSCREEN:case this.ETEvents.MUTED:case this.ETEvents.UNMUTED:case this.ETEvents.VIDEO_TIME_TO_START:case this.ETEvents.OSMF_FW_AD_REQUEST_TIMEOUT:c=this.addBaseVideoProps(c),c=this.addVideoProps(c),this.isAdPlaying()&&(c=this.addAdProps(c));break;case this.ETEvents.SKIP_AD:case this.ETEvents.AD_START:case this.ETEvents.AD_COMPLETE:case this.ETEvents.AD_PAUSE:case this.ETEvents.AD_RESUME:c=this.addBaseVideoProps(c),c=this.addAdProps(c)}return c},addVideoProps:function(a){var b=a;return b.videoFranchise=this.getSeries(),b.videoDuration=this._player.getDuration(),b.videoSection=this.getCategory(),b.videoSubSection="",b.videoPrimaryPlaylistId=this.getPrimaryPlaylistId(),b.videoTimeOfEvent=this.getCurrentVideoPosition(),b},addBaseVideoProps:function(a){var b=a;return b.videoId=this.getId(),b.videoName=this.getName(),b.videoType=this.isAdPlaying()?"ad":"video",b},addAdProps:function(a){var b=a;return this.adDurationCache=null===this.adDurationCache?this._player.adDuration():this.adDurationCache,b.adPosition="preroll",b.adDuration=Math.round(this.adDurationCache),b},track:function(a){this._logger.info("VHS::PLUGIN::EVENTTRACKER::",a),this.tracker?this.tracker.track(a):"undefined"!=typeof window.NYTD&&window.NYTD.EventTracker?(this.sendTrackingQueue(),this.tracker.track(a),this.etPoller&&this.etPoller.isPolling()&&this.etPoller.cancel()):(this.trackingHistory.push(a),this.etPoller||(this.etPoller=new d.api.Poller(["NYTD","EventTracker"],1e3,30,c.proxy(this.sendTrackingQueue,this)),this.etPoller.start()))},sendTrackingQueue:function(){if(this.tracker=new window.NYTD.EventTracker,this.trackingHistory.length>0){for(var a=this.trackingHistory.length,b=a-1;b>=0;b--)this.tracker.track(this.trackingHistory[b]);this.trackingHistory=[]}},videoStartUpTime:function(){this.startUpTimeSent=!0;var a=this.getTrackingObject(this.ETEvents.VIDEO_TIME_TO_START),b=this.endTimestamp,c=this.loadedTimestamp,d=this._player?this._player.playerStartTimestamp:null;b&&c&&d&&(a.videoTimeToStartFromLoaded=b.getTime()-c.getTime(),a.videoTimeToStartFromInit=b.getTime()-d.getTime(),this.track(a))},_loadstart:function(){this._logger.info("VHS::PLUGIN::EVENTTRACKER::LOADSTART"),this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.paused=!1,this.mediaChanged=!0},_play:function(){var a={};this.tracked?this.paused&&!this._player.hdRenditionChanging&&(a=this.getTrackingObject(this.ETEvents.UNPAUSE),this.track(a),this.paused=!1):(this._options.autoplay&&this.firstPlay&&!this._options.userInitiatedPlay?(a=this.getTrackingObject(this._player.startupSeek?this.ETEvents.MID_STREAM_PLAY:this._options.autoPlayNext?this.ETEvents.AUTO_PLAY_NEXT:this.ETEvents.AUTO_PLAY_START),this.firstPlay=!1,this.startUpTimeSent||(this.endTimestamp=new Date,this.videoStartUpTime())):a=this.getTrackingObject(this._options.userInitiatedNext?this._player.startupSeek?this.ETEvents.MID_STREAM_PLAY:this.ETEvents.USER_PLAY:this.videoCompleted&&!this.adStarted&&this.mediaChanged?this.ETEvents.AUTO_PLAY_NEXT:this.videoCompleted&&this.adStarted&&this.adCompleted&&this.mediaChanged?this.ETEvents.AUTO_PLAY_NEXT:this._player.startupSeek?this.ETEvents.MID_STREAM_PLAY:this.ETEvents.USER_PLAY),this.track(a),this.tracked=!0,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1,this.startUpTimeSent=!0)},_pause:function(){if(this._player&&(this._options.live||this._player.getDuration()>0)&&!this._player.hdRenditionChanging){var a=this.getTrackingObject(this.ETEvents.PAUSE);this.track(a),this.paused=!0}},_seeked:function(){if(!this._player.hdRenditionChanging){var a=this.getTrackingObject(this.ETEvents.SEEK);this.track(a)}},_mute:function(a){var b;b=this.getTrackingObject(a?this.ETEvents.MUTED:this.ETEvents.UNMUTED),this.track(b)},_go_fullscreen:function(){var a=this.getTrackingObject(this.ETEvents.GO_FULLSCREEN);this.track(a)},_exit_fullscreen:function(){var a=this.getTrackingObject(this.ETEvents.EXIT_FULLSCREEN);this.track(a)},_ended:function(){var a=this.getTrackingObject(this.ETEvents.VIDEO_COMPLETE);this.track(a),this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.videoCompleted=!0},_ad_started:function(){var a;this.adDurationCache=null,a=this.getTrackingObject(this.ETEvents.AD_START),this.track(a),this.adStarted=!0,this.startUpTimeSent||!this._options.autoplay||this._options.userInitiatedPlay||(this.endTimestamp=new Date,this.videoStartUpTime())},_ad_completed:function(){var a=this.getTrackingObject(this.ETEvents.AD_COMPLETE);this.track(a),this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.adCompleted=!0},_ad_skipped:function(){var a=this.getTrackingObject(this.ETEvents.SKIP_AD);this.track(a),this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.adCompleted=!0},_ad_paused:function(){var a=this.getTrackingObject(this.ETEvents.AD_PAUSE);this.track(a)},_ad_resumed:function(){var a=this.getTrackingObject(this.ETEvents.AD_RESUME);this.track(a)},_hd_on:function(){var a=this.getTrackingObject(this.ETEvents.HD_ON);this.track(a)},_hd_off:function(){var a=this.getTrackingObject(this.ETEvents.HD_OFF);this.track(a)},_loaded:function(){this._logger.info("VHS::PLUGIN::EVENTTRACKER::LOADED");var a=this.getTrackingObject(this.ETEvents.PLAYER_LOAD);this.track(a),this.loadedTimestamp=new Date},_error:function(a){var b=this.getTrackingObject(this.ETEvents.MEDIA_ERROR);b.errorCode=this.getErrorCode(a),this.track(b)},_time_update:function(a){var b=this._player.getDuration(),c=Math.round(parseInt(a,10)),d=Math.round(parseInt(b,10));if(!this._player.isEnded()){this.percentages.ready&&this.percentages.duration==d||this.percentages.calculate(d,[25,50,75]);var e={};c>0&&(c>=this.percentages[25]&&!this.tracked25Percent?(e=this.getTrackingObject(this.ETEvents.PERCENT_25_VIEWED),this.track(e),this.tracked25Percent=!0):c>=this.percentages[50]&&!this.tracked50Percent?(e=this.getTrackingObject(this.ETEvents.PERCENT_50_VIEWED),this.track(e),this.tracked50Percent=!0):c>=this.percentages[75]&&!this.tracked75Percent&&(e=this.getTrackingObject(this.ETEvents.PERCENT_75_VIEWED),this.track(e),this.tracked75Percent=!0))}},_rendition_not_found:function(a){var b=this.getTrackingObject(this.ETEvents.RENDITION_NOT_FOUND);this.track(b)},_tracking_event:function(a){var b;if(a&&a.data&&a.data.name)switch(a.data.name){case this.ETEvents.FW_ADMANAGER_LOAD_ERROR:b=this.getTrackingObject(this.ETEvents.FW_ADMANAGER_LOAD_ERROR),b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"",this.track(b);break;case this.ETEvents.CHERRY_API_REQUEST_ERROR:b=this.getTrackingObject(this.ETEvents.CHERRY_API_REQUEST_ERROR),b.videoId=this.getId(),b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"",this.track(b);break;case this.ETEvents.QOS_LOAD_FAILURE:b=this.getTrackingObject(this.ETEvents.QOS_LOAD_FAILURE),b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"",this.track(b);break;case this.ETEvents.OSMF_FW_AD_MANAGER_LOAD_TIME:b=this.getTrackingObject(this.ETEvents.OSMF_FW_AD_MANAGER_LOAD_TIME),b.loadtime=a.data.loadtime?a.data.loadtime:-1,this.track(b);break;default:this.track(this.getTrackingObject(a.data.name))}},_rendered:function(a){this._element=this._player.element}},!0),d.plugin("tagx",{_initialize:function(){this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.trackingHistory=[],this.paused=!1,this.firstPlay=!0,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1,this.loadedTimestamp=null,this.endTimestamp=null,this.startUpTimeSent=!1,this.adDurationCache=null,this.events={PLAYER_LOAD:"player-load",VIDEO_LOAD:"video-load",USER_PLAY:"user-play",MID_STREAM_PLAY:"mid-stream-play",AUTO_PLAY_NEXT:"auto-play-next",AUTO_PLAY_START:"auto-play-start",VIDEO_COMPLETE:"video-complete",PAUSE:"pause",RESUME:"resume",PERCENT_25_VIEWED:"percent-25-viewed",PERCENT_50_VIEWED:"percent-50-viewed",PERCENT_75_VIEWED:"percent-75-viewed",SEEK:"seek",GO_FULLSCREEN:"go-fullscreen",EXIT_FULLSCREEN:"exit-fullscreen",MUTED:"muted",UNMUTED:"unmuted",HD_ON:"hd-on",HD_OFF:"hd-off",SKIP_AD:"skip-ad",AD_START:"ad-start",AD_PAUSE:"ad-pause",AD_RESUME:"ad-resume",AD_COMPLETE:"ad-complete",MEDIA_ERROR:"media-error",VIDEO_TIME_TO_START:"video-time-to-start",QOS_LOAD_FAILURE:"qos-library-load-failure",RENDITION_NOT_FOUND:"rendition-not-found",FW_ADMANAGER_LOAD_ERROR:"fw-admanager-load-error",FW_AD_MANAGER_LOAD_TIMEOUT:"fw-ad-manager-load-timeout",CHERRY_API_REQUEST_ERROR:"cherry-api-request-error",OSMF_HLS_PLUGIN_LOAD_FAILED:"osmf-hls-plugin-load-failed",OSMF_QOS_PLUGIN_LOAD_FAILED:"osmf-qos-plugin-load-failed",OSMF_FW_AD_REQUEST_TIMEOUT:"osmf-fw-ad-request-timeout",OSMF_FW_AD_MANAGER_LOAD_TIMEOUT:"osmf-fw-ad-manager-load-timeout",OSMF_FW_AD_MANAGER_LOAD_TIME:"osmf-fw-ad-manager-load-time"},this.video_type={VIDEO:"video",AD:"ad"},this.videoConfig={videoType:this.video_type.VIDEO,module:"video-player"},this.adConfig={videoType:this.video_type.AD,module:"video-player"},this.bindEvents()},bindEvents:function(){this._on("track",function(a){var b;a&&a.eventName&&"string"==typeof a.eventName&&(b={videoType:a.videoType||this.video_type.VIDEO,module:a.module||"",region:a.region||"",action:a.action||""},this.track(a.eventName,b,a.additionalData))}.bind(this))},track:function(a,b,e){var f=["interaction","tagx-event-video"],g=this.getTrackingData(a,b,e);window.TAGX?(window.TAGX.EventProxy.trigger(a,g,f),this.sendTrackingQueue(),this.tagxPoller&&this.tagxPoller.isPolling()&&this.tagxPoller.cancel()):(this.trackingHistory.push({name:a,data:g,interaction:f}),this.tagxPoller||(this.tagxPoller=new d.api.Poller("TAGX",1e3,30,c.proxy(this.sendTrackingQueue,this)),this.tagxPoller.start()))},sendTrackingQueue:function(){if(this.trackingHistory.length>0){for(var a=this.trackingHistory.length,b=a-1;b>=0;b--){var c=this.trackingHistory[b];window.TAGX.EventProxy.trigger(c.name,c.data,c.interaction)}this.trackingHistory=[]}},getTrackingData:function(a,b,d){var e=b.module||"video-player",f=b.region||"",g=b.action||"",h=b.videoType||this.video_type.VIDEO,i=a===this.events.VIDEO_COMPLETE?"completed":this._player.isPaused()?"paused":"playing",j={module:e,version:this._player.getPlayerType()||"unknown",state:i,contentCollection:this._player.getCategory(),region:f,action:g,contentPlacement:"0",contentId:this._player.getVideoId(),eventName:a,eventTimestamp:(new Date).getTime(),mData:c.extend({videoName:this._player.getTitle()},d)};return"video-player"===e&&(j=this.addVideoData(j,h)),j},addVideoData:function(a,b){return a.mData.device=d.util.getDeviceType(),a.mData.playerMode=this._options.mode,a.mData.playerType=this._player.getPlayerType()||"",a.mData.playerUsage=this._options.usage||"",a.mData.playerVersion=d._version,a.mData.tech=this._player.getType(),a.mData.videoDeliveryMethod=this._options.live?"live":"vod",a.mData.videoDuration=this._player.getDuration(),a.mData.videoFranchise=this._player.getSeries(),a.mData.videoPrimaryPlaylistId=this._player.getPrimaryPlaylistId(),a.mData.videoSection=this._player.getCategory(),a.mData.videoSubSection="",a.mData.videoTimeOfEvent=this._player.getCurrentTime(),a.mData.videoType=b,b===this.video_type.AD&&(a.mData.adPosition="preroll",this.adDurationCache=null===this.adDurationCache?this._player.adDuration():this.adDurationCache,a.mData.adDuration=Math.round(this.adDurationCache)),a},getErrorCode:function(a){var b="";return this._element&&this._element.length>0&&this._element[0].error?b=this._element[0].error.code:a&&a.error&&a.error.code&&(b=a.error.code),b},videoStartUpTime:function(){var a,b,c=this._player?this._player.playerStartTimestamp:null;this.startUpTimeSent=!0,this.endTimestamp&&this.loadedTimestamp&&c&&(a=this._player.adPlaying()?this.adConfig:this.videoConfig,b={videoTimeToStartFromLoaded:this.endTimestamp.getTime()-this.loadedTimestamp.getTime(),videoTimeToStartFromInit:this.endTimestamp.getTime()-c.getTime()},this.track(this.events.VIDEO_TIME_TO_START,a,b))},_loaded:function(){this._logger.info("VHS::PLUGIN::TAGX::LOADED"),this.track(this.events.PLAYER_LOAD,this.videoConfig),this.loadedTimestamp=new Date},_loadstart:function(){this._logger.info("VHS::PLUGIN::TAGX::LOADSTART"),this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.paused=!1,this.mediaChanged=!0,this.track(this.events.VIDEO_LOAD,this.videoConfig)},_play:function(){var a=this.events.USER_PLAY;this.trackedPlay?this.paused&&!this._player.hdRenditionChanging&&this.track(this.events.RESUME,this.videoConfig):(this._options.autoplay&&this.firstPlay&&!this._options.userInitiatedPlay?(a=this._player.startupSeek?this.events.MID_STREAM_PLAY:this._options.autoPlayNext?this.events.AUTO_PLAY_NEXT:this.events.AUTO_PLAY_START,this.startUpTimeSent||(this.endTimestamp=new Date,this.videoStartUpTime())):a=this._options.userInitiatedNext?this.events.USER_PLAY:this.videoCompleted&&!this.adStarted&&this.mediaChanged?this.events.AUTO_PLAY_NEXT:this.videoCompleted&&this.adStarted&&this.adCompleted&&this.mediaChanged?this.events.AUTO_PLAY_NEXT:this._player.startupSeek?this.events.MID_STREAM_PLAY:this.events.USER_PLAY,this.trackedPlay=!0,this.firstPlay=!1,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1,this.startUpTimeSent=!0,this.track(a,this.videoConfig)),this.paused=!1},_pause:function(){this._player&&(this._options.live||this._player.getDuration()>0)&&!this._player.hdRenditionChanging&&(this.paused=!0,this.track(this.events.PAUSE,this.videoConfig))},_ended:function(){this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.videoCompleted=!0,this.track(this.events.VIDEO_COMPLETE,this.videoConfig)},_time_update:function(a){var b=Math.round(parseInt(a,10)),c=Math.round(parseInt(this._player.getDuration(),10));if(!(1>c||1>b||this._player.isEnded())){var d,e=.25*c,f=.5*c,g=.75*c;b>0&&(b>=e&&f>b&&!this.tracked25Percent?(d=this.events.PERCENT_25_VIEWED,this.tracked25Percent=!0):b>=f&&g>b&&!this.tracked50Percent?(d=this.events.PERCENT_50_VIEWED,this.tracked50Percent=!0):b>=g&&!this.tracked75Percent&&(d=this.events.PERCENT_75_VIEWED,this.tracked75Percent=!0),d&&this.track(d,this.videoConfig))}},_seeked:function(){this._player.hdRenditionChanging||this.track(this.events.SEEK,this.videoConfig)},_mute:function(a){var b=a?this.events.MUTED:this.events.UNMUTED,c=this._player.adPlaying()?this.adConfig:this.videoConfig;this.track(b,c)},_go_fullscreen:function(){var a=this._player.adPlaying()?this.adConfig:this.videoConfig;this.track(this.events.GO_FULLSCREEN,a)},_exit_fullscreen:function(){var a=this._player.adPlaying()?this.adConfig:this.videoConfig;this.track(this.events.EXIT_FULLSCREEN,a)},_hd_on:function(){this.track(this.events.HD_ON,this.videoConfig)},_hd_off:function(){this.track(this.events.HD_OFF,this.videoConfig)},_ad_started:function(){this.adStarted=!0,this.adDurationCache=null,this.track(this.events.AD_START,this.adConfig),this.startUpTimeSent||!this._options.autoplay||this._options.userInitiatedPlay||(this.endTimestamp=new Date,this.videoStartUpTime())},_ad_completed:function(){this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.adCompleted=!0,this.track(this.events.AD_COMPLETE,this.adConfig)},_ad_skipped:function(){this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.adCompleted=!0,this.track(this.events.SKIP_AD,this.adConfig)},_ad_paused:function(){this.track(this.events.AD_PAUSE,this.adConfig)},_ad_resumed:function(){this.track(this.events.AD_RESUME,this.adConfig)},_error:function(a){var b=this._player.adPlaying()?this.adConfig:this.videoConfig,c={};c.errorCode=this.getErrorCode(a),this.track(this.events.MEDIA_ERROR,b,c)},_rendition_not_found:function(){this.track(this.events.RENDITION_NOT_FOUND,this.videoConfig)},_tracking_event:function(a){var b={};if(a&&a.data&&a.data.name){switch(a.data.name){case this.events.FW_ADMANAGER_LOAD_ERROR:case this.events.QOS_LOAD_FAILURE:b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"";break;case this.events.CHERRY_API_REQUEST_ERROR:b.videoId=this._player.getVideoId(),b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"";break;case this.events.OSMF_FW_AD_MANAGER_LOAD_TIME:b.loadtime=a.data.loadtime?a.data.loadtime:-1}this.track(a.data.name,this.videoConfig,b)}},_rendered:function(){this._element=this._player.element,this.bindTaggedDomElement()},bindTaggedDomElement:function(){var a=this;this._container&&this._container.on("click","[data-vhs-et-name]",function(b){a.trackDomClickEvent(c(this))})},trackDomClickEvent:function(a){var b=a.data("vhsEtName"),c=a.closest("[data-vhs-et-module]").data("vhsEtModule")||"default-module",d=a.closest("[data-vhs-et-region]").data("vhsEtRegion")||c,e={module:c,videoType:this.video_type.VIDEO,region:d,action:"click"};this.track(b,e)}},!0),d.plugin("playNext",{_initialize:function(){this.playlist=null,this.currentVideo=0},_ended:function(){var a=this;this.getPlaylistData(function(){var b=a.playlist.videos[a.currentVideo];a._data.id===b.id&&(a.currentVideo=a.currentVideo+1),a._options.poster="",a._player.load(b.id,!0),a.currentVideo=a.currentVideo+1})},getPlaylistData:function(a){var b=this;b.playlist?a():this._player.getData(this._data.playlist.id,"playlist",function(c){b.playlist=c,a()})}},!1),d.plugin("sharetools",{_initialize:function(){this.config={facebook:{name:"facebook",active:!0,postUrl:"http://www.facebook.com/sharer.php",shareParameters:{url:"u"},smid:"fb-share",width:655,height:430},twitter:{name:"twitter",active:!0,postUrl:"https://twitter.com/share",shareParameters:{url:"url",title:"text",related:"nytimes",via:"nytvideo"},smid:"tw-share",width:600,height:450}},this.bind(this._container),this._container.addClass("vhs-plugin-"+this._name)},openShareHandler:function(a,b,d){var e,f=c(a),g=f.data("shareName"),h=f.data("shareHandler"),i=f.data("shareUrl"),j=this[h],k=this.config[g],l=i?i:d.tiny_url||d.url;k&&(e=c.extend({},k,{shareUrl:l})),e=this.checkShareDataOverride(e,d),"function"==typeof j&&j.call(this,e,d)},checkShareDataOverride:function(a,b){return b.blogpost_data&&b.blogpost_data.url&&(a.shareUrl=b.blogpost_data.url,a.headline=b.blogpost_data.headline||""),b.article_data&&b.article_data.publish_url&&(a.shareUrl="http://www.nytimes.com"+b.article_data.publish_url,a.headline=b.article_data.headline||""),a},popup:function(a){var b=a.encoded?a.postUrl:a.postUrl+"?"+a.shareParameters.url+"="+encodeURIComponent(a.shareUrl);window.open(b,a.name+"Share","toolbar=0,status=0,height="+a.height+",width="+a.width+",scrollbars=yes,resizable=yes")},urlshortener:function(a,b){var d="",e=/[\?&]share_url=([^&#]*)/,f=e.exec(window.location.search),g=a.name,h="",i="http://www.nytimes.com/svc/bitly/shorten.jsonp",j=a.shareUrl,k=a.headline||b.headline||"";if(k&&(h+="&text="+encodeURIComponent(k)),a.shareParameters&&(a.shareParameters.related&&(h+="&related="+encodeURIComponent(a.shareParameters.related)),a.shareParameters.via&&(h+="&via="+encodeURIComponent(a.shareParameters.via))),j===b.tiny_url)return void this.popup(c.extend({},a,{postUrl:a.postUrl+"?url="+encodeURIComponent(b.tiny_url)+h,encoded:!0}));null!==f&&(d=decodeURIComponent(f[1].replace(/\+/g," ")));var l=['<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',"<html><head>",'<script type="text/javascript" src="http://graphics8.nytimes.com/js/common.js"></script>','<script type="text/javascript">',"function loadShortUrl() {","var url;",'var ricoUrl = "',d,'".replace(/\\s/g, "");',"if (ricoUrl.length > 0) {","shortUrlRedirect(ricoUrl);","} else {","NYTD.jQuery.ajax({",'url: "',i,'",','dataType: "jsonp",','data: { "url" : "',j,'" },','jsonpCallback: "callback",',"cache: true","}).success(function(data, textStatus, jqXHR){","if (data && data.payload && data.payload.short_url) {","short_url = data.payload.short_url;","url = short_url;","}","shortUrlRedirect(url);","}).error(function(jqXHR, textStatus, errorThrown){","shortUrlRedirect(url);","});","}","};","function shortUrlRedirect(url) {",'window.location.href = "',a.postUrl,'?url=" + encodeURIComponent(url) + "',h,'";',"};","</script>","</head>",'<body onload="loadShortUrl();"></body></html>'].join(""),m=window.open("",g+"Share","toolbar=0,status=0,height="+a.height+",width="+a.width+",scrollbars=yes,resizable=yes");m.document.write(l),m.document.close()},bind:function(a){var b=this;a.on("click",".vhs-share-item[data-share-handler]",function(a){b.openShareHandler.call(b,this,a,b._data)}),a.on("click",".vhs-share-module-overlay",c.proxy(function(){d.util.jqueryInUse()&&a.find(".vhs-share-module, .vhs-share-module-overlay").fadeToggle(),a.find(".vhs-pause-slate, .nytd-player-controls").toggleClass("vhs-share-showing"),this._player.play()},b)),a.on("click",".vhs-share-menu",c.proxy(function(){this._player.pause(),d.util.jqueryInUse()&&a.find(".vhs-share-module, .vhs-share-module-overlay").fadeToggle().find("input").select().focus(),a.find(".vhs-pause-slate, .nytd-player-controls").toggleClass("vhs-share-showing")},b)),a.on("click",".vhs-icon-group span",function(){c(this).siblings("button").first().trigger("click");var a=c(this).siblings("a").first();a.length>0&&window.open(a.attr("href"),"_blank")})}},!0),d.plugin("endSlate",{shareToolsClass:"vhs-plugin-sharetools",el:null,template:d.templates.endSlate,replayButtonClick:function(){this._player.seek(0),this._player.play()},canRender:function(){var a=this._player.options.playNext===!0,b=!a&&!!this._container&&this._container.length>0&&!!this._data&&this._container.hasClass(this.shareToolsClass);return null!==this.options&&"object"==typeof this.options&&b},renderSlate:function(){var a;this.canRender()&&(a=c.extend({},this.options,{data:this._data}),this.el=c('<div class="vhs-plugin-'+this._name+'" />'),this.el.html(this.template(a)),this._container.prepend(this.el))},removeSlate:function(){this.isVisible()&&(this.el.remove(),this.el=null)},isVisible:function(){return this.el&&this.el.length},_initialize:function(){var a=this._player.options[this._name];(a===!0||"true"===a)&&(a={}),this.options=a},_ready:function(){this.canRender()&&(this._container.addClass("vhs-plugin-"+this._name),this._container.on("click",".vhs-replay-button",c.proxy(this.replayButtonClick,this)))},_show_controls:function(){this.isVisible()&&this._player.modules&&this._player.modules.controls&&"function"==typeof this._player.modules.controls.hide&&this._player.modules.controls.hide(!0)},_play:function(){this.removeSlate()},_playing:function(){this.removeSlate()},_ad_started:function(){this.removeSlate()},_ended:function(){this.renderSlate()}},!0),d.plugin("controlsOverlay",{shareToolsClass:"vhs-plugin-sharetools",defaults:{mode:"clean"},template:d.templates.pauseSlate,renderContainer:function(){this.el=c('<div class="vhs-plugin-container-'+this._name+'" style="display: none;" />').prependTo(this._container),this.templateFn=this.options.template||this.template,this._container.addClass("vhs-plugin-"+this._name)},renderSlate:function(a){var b;this.isEnabled&&"function"==typeof this.templateFn&&"object"==typeof this._data&&(this.options.showShareTools=this.isValidShareUrl(),this.options.isOnSite=d.util.isOnNYTDomain(),this.options.linkUrl=this.getVideoLinkUrl(),this.options.isEmbeddedOnly=this._player.isEmbeddedOnly(),b=c.extend({},this.options,{view:this.viewSettings[this.options.mode],data:this._data}),this._player.options.shareOptions&&this._player.options.shareOptions.url&&(b.url=this._player.options.shareOptions.url),this.el.find(".vhs-pause-slate[data-id]").length||this.el.append(this.templateFn(b)),d.util.jqueryInUse()?this.el.show().find(".vhs-pause-slate, .vhs-player-header-background").stop(!0,!1).fadeTo(a.fadeArgs[0],a.fadeArgs[1]):this.el.show().find(".vhs-pause-slate, .vhs-player-header-background").css({opacity:a.fadeArgs[1]}),this.setupTimesVideoLinks(a),this._trigger("rendered"))},removeSlate:function(a){var b,c=this;this.isEnabled&&(b=this.el.find(".vhs-pause-slate, .vhs-player-header-background, .vhs-share-module, .vhs-share-module-overlay"),d.util.jqueryInUse()?b.fadeTo(a.fadeArgs[0],a.fadeArgs[1],function(){c.el.find(".vhs-pause-slate").removeClass("vhs-share-showing"),c.el.empty(),c._container.find(".nytd-player-controls").removeClass("vhs-share-showing")}):(b.css({opacity:a.fadeArgs[1]}),this.el.find(".vhs-pause-slate").removeClass("vhs-share-showing"),this.el.empty(),this._container.find(".nytd-player-controls").removeClass("vhs-share-showing")),this.hidePlayerAreaClickOverlay(a))},createOptions:function(){var a=c.extend({},this.defaults,this._player.options[this._name]||{});return a.mode=d.util.isAndroid()||d.util.isIphone()?"clean":a.mode,a},isValidShareUrl:function(){var a=!1;return a=!this._player.isEmbeddedOnly(),this.options.url&&(a=!0),this._player.options.shareOptions&&this._player.options.shareOptions.url&&(a=!0),this._data.article_data&&this._data.article_data.publish_url&&(a=!0),this._data.blogpost_data&&this._data.blogpost_data.url&&(a=!0),a},getVideoLinkUrl:function(){return this._player.isEmbeddedOnly()?this._data.article_data&&this._data.article_data.publish_url?"http://www.nytimes.com"+this._data.article_data.publish_url:this._data.blogpost_data&&this._data.blogpost_data.url?this._data.blogpost_data.url:null:this._data.domain+this._data.publish_url},setupTimesVideoLinks:function(a){this._player.options.deeplinkingToTimesVideo?"titleandlogo"===this.getDeepLinkingType()?this.bindTitleAndLogo():this.renderPlayerAreaClickOverlay(a):this.bindTitleAndLogo()},getDeepLinkingType:function(){var a,c,d=b.get("nytvhsdeeplinking");return d||(d=10*Math.random()>5?"titleandlogo":"playerarea",a=new Date,c=new Date(a.setMonth(a.getMonth()+1)),b.set("nytvhsdeeplinking",d,{expires:c})),d},bindTitleAndLogo:function(){var a=this,b=this.el.find(".vhs-video-title-wrapper .vhs-data a"),d=this.el.find(".vhs-player-header .vhs-times-logo");b.off("click"),b.one("click",c.proxy(function(b){b.preventDefault(),a.pauseAndRedirect("title-area")},this)),this.options.linkUrl&&(d.off("click"),d.one("click",c.proxy(function(b){b.preventDefault(),a.pauseAndRedirect("times-logo-area")},this)))},renderPlayerAreaClickOverlay:function(a){var b,c=this;this.clickOverlay||(b=this._player.container.find(".nytd-player-video-area"),b.length>0?this.clickOverlay=b:(this._player.container.append(d.templates.deeplinkingClickOverlay),this.clickOverlay=this._player.container.find(".nytd-player-video-area"))),this.clickOverlay.addClass("nytd-clickable-area"),this.clickOverlay.off(),this.clickOverlay.one("click",function(){c.pauseAndRedirect("video-area")}),d.util.jqueryInUse()?this.clickOverlay.show().stop(!0,!1).fadeTo(a.fadeArgs[0],a.fadeArgs[1]):this.clickOverlay.show().css({opacity:a.fadeArgs[1]})},hidePlayerAreaClickOverlay:function(a){this.clickOverlay&&(d.util.jqueryInUse()?this.clickOverlay.stop(!0,!1).fadeTo(a.fadeArgs[0],a.fadeArgs[1]):this.clickOverlay.css({opacity:a.fadeArgs[1]}))},pauseAndRedirect:function(a){this._player.pause();var b=this.getRedirectUrl(a);window.open(b,"_blank")},getRedirectUrl:function(a){var b,c,d="?action=click&gtype=vhs&version=vhs-heading&module=vhs&region="+a;return this._player.options.deeplinkingToTimesVideo?(b="times-logo-area"===a||"title-area"===a?"&video-click-enabled-with-msg=false":"&video-click-enabled-with-msg=true",c=Math.round(this._player.getCurrentTime()),this.getVideoLinkUrl()+d+b+"&t="+c+"&cview=true"):"times-logo-area"===a?"http://nytimes.com/video":this.getVideoLinkUrl()+d},initEvents:function(){this._on("plugin:copySlate:rendered",function(){this.removeSlate({fadeArgs:[0,1]})}.bind(this))},_initialize:function(){this.options=this.createOptions(),this.initEvents()},_rendered:function(){this.isEnabled=this._data&&"clean"!==this.options.mode&&"object"==typeof this.viewSettings[this.options.mode],this.isEnabled&&this._container.hasClass(this.shareToolsClass)&&this.renderContainer(),"clean"==this.options.mode&&this.destroy()},_show_controls:function(a){this._player.adPlaying()||this._player.isEnded()||this.renderSlate(a)},_hide_controls:function(a){this._player.adPlaying()||this._player.isEnded()||this.removeSlate(a)},_ad_started:function(){this.removeSlate({fadeArgs:[0,1]})},_ended:function(){this.removeSlate({fadeArgs:[0,1]})},destroy:function(){var a=function(){};this._show_controls=a,this._hide_controls=a,this._ad_started=a},viewSettings:{share:{logoClasses:"vhs-no-pipe",titleClasses:"vhs-invisible"},article:{logoClasses:"",titleClasses:""},offsite:{logoClasses:"",titleClasses:""}}},!0),d.plugin("stats",{_initialize:function(){this.stats=!1,this.videoStats={droppedFrames:0,decodedFrames:0,videoDecodedBytes:0,audioDecodedBytes:0,bitrate:0,mimetype:"",volume:100,videoId:0,dimensions:{width:0,height:0},videoResolution:{width:0,height:0},streamType:"http",bandwidth:0,buffered:0,currentTime:0}},_loaded:function(){this._player.element[0];this.videoStats.videoId=this._data?this._data.id:this._options.id||-1},_time_update:function(a){var b=this._player.element[0];this.videoStats.decodedFrames=b.webkitDecodedFrameCount,this.videoStats.droppedFrames=b.webkitDroppedFrameCount,this.videoStats.videoDecodedBytes=b.webkitVideoDecodedByteCount,
this.videoStats.audioDecodedBytes=b.webkitAudioDecodedByteCount,this.videoStats.currentTime=a,this.videoStats.volume=b.volume,this.videoStats.buffered=b.buffered,this.videoStats.videoResolution={width:b.videoWidth,height:b.videoHeight},this.videoStats.dimensions={width:this._container.width(),height:this._container.width()}}},!1),d.plugin("vpaidUpdateAd",{_time_update:function(a){this._player.element.get(0)&&"function"==typeof this._player.element.get(0).updateAd&&this._player.element.get(0).updateAd({videoTime:a})}},!0),d.plugin("contextualMenu",{_initialize:function(){this.initDOMEvents()},pluginClassName:"vhs-plugin-contextual-menu",template:d.templates.contextualMenu,initDOMEvents:function(){this._container.off("contextmenu").on("contextmenu",function(a){var b=c(a.target);b.is("input")||this.onContextmenu(a)}.bind(this))},onDocumentClick:function(a){var b=c(a.target),d=2!==a.button,e=b.parents("."+this.pluginClassName).length<=0&&!b.hasClass(this.pluginClassName);this.$contextMenu&&d&&e&&this.destroy()},onContextmenu:function(a){a.preventDefault(),c(document).on("click",this.onDocumentClick.bind(this)),this.render(),this.resolvePosition(a.pageY,a.pageX)},resolvePosition:function(a,b){var e,f,g,h,i=a,j=b;d.util.zeptoInUse()?(e=c(window).width(),f=c(window).height(),g=this.$contextMenu.width(),h=this.$contextMenu.height()):(e=c(window).outerWidth(!0),f=c(window).outerHeight(!0),g=this.$contextMenu.outerWidth(!0),h=this.$contextMenu.outerHeight(!0)),h>f-a-5&&(i=a-h),g>e-b-5&&(j=b-g),this.$contextMenu.css({top:i,left:j})},getMenuItems:function(){var a=!!this._player.getVideoCanonical(),b=!!this._player.getVideoCanonicalAtCurrentTime(),c=!!this._player.getEmbedCode(),e="unknown"!==this._player.getVideoId()||!!this._player.getVideoId();return this._player.isEmbeddedOnly()&&(a=!1,b=!1),this._player.options.api||(a=!1,b=!1,c=!1,e=!1),[{isActive:a,text:"Get Video URL",eventName:"get-video-canonical"},{isActive:b,text:"Get Video URL at Current Time",eventName:"get-video-canonical-at-current-time"},{isActive:c,text:"Get Embed Code",eventName:"get-embed-code"},{isActive:e,text:"Get Video ID",eventName:"get-video-id"},{isActive:!1,isVersion:!0,text:"VHS Version "+d._version}]},render:function(){var a,b=this;return this.$contextMenu?!1:(a={pluginClassName:this.pluginClassName,items:this.getMenuItems()},this.$contextMenu=c(this.template(a)).appendTo("body"),this.$contextMenu.find("li").each(function(a){var d=b.getMenuItems()[a];d&&d.isActive===!0&&c(this).on("click",function(a){b.destroy(),b._trigger("item:clicked",d),b._trigger("plugin:copySlate:open:"+d.eventName)})}),void b._trigger("rendered"))},destroy:function(){this.$contextMenu&&(c(document).off("click",this.onDocumentClick.bind(this)),this.$contextMenu.find("li").off("click"),this.$contextMenu.remove(),this.$contextMenu=null)}},!1),d.plugin("copySlate",{_initialize:function(){this.initDOMEvents(),this.initEvents()},pluginClassName:"vhs-copy-slate",template:d.templates.copySlate,initDOMEvents:function(){this._container.on("click",function(a){var b=c(a.target),d=b.parents("."+this.pluginClassName).length<=0&&!b.hasClass(this.pluginClassName);this.$copyInputField&&d&&this.destroy()}.bind(this)),this._container.off("click","."+this.pluginClassName).on("click","."+this.pluginClassName,function(a){var b=c(a.target),d=b.parents("."+this.pluginClassName+"-center-container").length<=0&&!b.hasClass(this.pluginClassName+"-center-container");this.$copyInputField&&d&&this.destroy()}.bind(this)),this._container.off("click","."+this.pluginClassName+" input").on("click","."+this.pluginClassName+" input",function(){this.focus(),this.setSelectionRange?this.setSelectionRange(0,this.value.length):this.select&&this.select()})},initEvents:function(){this._on("close",this.destroy.bind(this)),this._on("open:get-video-canonical",function(a){this.render({text:"Video URL",value:this._player.getVideoCanonical()})}.bind(this)),this._on("open:get-video-canonical-at-current-time",function(a){this.render({text:"Video URL at Current Time",value:this._player.getVideoCanonicalAtCurrentTime()})}.bind(this)),this._on("open:get-embed-code",function(a){this.render({text:"Embed Code",value:this._player.getEmbedCode()})}.bind(this)),this._on("open:get-video-id",function(a){this.render({text:"Video ID",value:this._player.getVideoId()})}.bind(this))},_play:function(){this.destroy()},_playing:function(){this.destroy()},_ad_started:function(){this.destroy()},render:function(a){var b=c.extend({},a);if(!b||!b.text||!b.value)throw new Error("The data passed is not semantic.");this.$copyInputField&&this.destroy(),this._player.pause(),b.pluginClassName=this.pluginClassName,this.$copyInputField=c(this.template(b)).appendTo(this._container),this.$copyInputField.find("input").focus().trigger("click"),this._trigger("rendered")},destroy:function(){this.$copyInputField&&(this.$copyInputField.remove(),this.$copyInputField=null)}},!1),d.libraries=d.libraries||{},d.libraries.qos={loading:!1,loaded:!1,failed:!1,callbacks:[],reset:function(){d.libraries.qos.loading=!1,d.libraries.qos.loaded=!1,d.libraries.qos.failed=!1,d.libraries.qos.callbacks=[]},queueInitialization:function(a,b){d.libraries.qos.callbacks.push({context:a,callback:b})},initializePlayersForQos:function(){if(d.libraries.qos.callbacks.length>0){var a=d.libraries.qos.callbacks.pop(),b=a.callback,c=a.context;"function"==typeof b&&"object"==typeof c&&b.apply(c)}}},d.api.Qos=function(a){this._player=a,this._options=a.options,this._logger=a.logger,this.buffering=!1,this.firstPlay=!0,this.paused=!0,this.ended=!1,this.sessionExists=!1,this.CONFIG_PATH=this._options.qosConfigUrl||"http://ma800-r.analytics.edgesuite.net/config/beacon-8173.xml?enableGenericAPI=1",this.SWF_PATH="http://79423.analytics.edgekey.net/csma/plugin/csma.swf",this.JS_URL="http://79423.analytics.edgekey.net/js/csma.js",this._options.qos&&"html5"===this._options.mode&&!d.config.allowMultiplePlayers&&this.initialize()},d.api.Qos.prototype={initialize:function(){window.AKAMAI_MEDIA_ANALYTICS_CONFIG_FILE_PATH=this.CONFIG_PATH,d.libraries.qos.loaded&&!d.libraries.qos.loading?this.qosInitialize():!d.libraries.qos.loaded&&d.libraries.qos.loading?d.libraries.qos.queueInitialization(this,this.qosInitialize):this.loadQosLibrary()},loadQosLibrary:function(){var a=this;d.libraries.qos.loading=!0,d.util.getScript({url:this.JS_URL,success:function(){d.libraries.qos.loaded=!0,d.libraries.qos.loading=!1,a.qosInitialize(),d.libraries.qos.initializePlayersForQos()},error:function(b,c,d){a.qosLoadLibraryErrorHandler(b,c,d)},timeout:5e3,cache:!0,dataType:"script"})},qosInitialize:function(){var a,b=this;this._player.on(d.api.events.LOAD_START,c.proxy(this.onLoadStart,this)),this._player.on(d.api.events.PLAY,c.proxy(this.onPlay,this)),this._player.on(d.api.events.PAUSE,c.proxy(this.onPause,this)),this._player.on(d.api.events.PROGRESS,c.proxy(this.onProgress,this)),this._player.on(d.api.events.ENDED,c.proxy(this.onEnded,this)),this._player.on(d.api.events.ERROR,function(a){b.onMediaError(a)}),this._player.on(d.api.events.AD_STARTED,c.proxy(this.onAdStarted,this)),this._player.on(d.api.events.AD_COMPLETED,c.proxy(this.onAdCompleted,this)),this._player.on(d.api.events.AD_SKIPPED,c.proxy(this.onAdSkipped,this)),this._player.on(d.api.events.AD_STOPPED,c.proxy(this.onAdStopped,this)),this._player.on(d.api.events.AD_FIRST_QUARTILE,c.proxy(this.onAdFirstQuartile,this)),this._player.on(d.api.events.AD_MIDPOINT,c.proxy(this.onAdMidpoint,this)),this._player.on(d.api.events.AD_THIRD_QUARTILE,c.proxy(this.onAdThirdQuartile,this)),this._player.on(d.api.events.AD_ERROR,c.proxy(this.onAdError,this)),a=function(){b.setupPlugin(),b._player.options.autoplay&&!b._player.isPaused()&&b.akaPlugin&&(b.setVideoData(),b.akaPlugin.handleSessionInit(),b.akaPlugin.handlePlaying(),b.firstPlay=!1,b.sessionExists=!0)},this._player.rendered?a():this._player.on(d.api.events.RENDERED,function e(){a(),b._player.off(d.api.events.RENDERED,e)})},setupPlugin:function(){var a=this;this.akaPluginCallBack={},this.akaPluginCallBack.streamHeadPosition=function(){return a._player.getCurrentTime()},this.akaPluginCallBack.streamLength=function(){return a._player.duration()},this.akaPluginCallBack.streamURL=function(){return a._player.getCurrentSource()},this.akaPlugin=new window.AkaHTML5MediaAnalytics(this.akaPluginCallBack),this.setPlayerData()},qosLoadLibraryErrorHandler:function(a,b,c){this._player&&"function"==typeof this._player.trigger&&this._player.trigger(d.api.events.TRACKING_EVENT,{data:{name:"qos-library-load-failure",errorStatus:b||"",errorThrown:c||""}}),d.libraries.qos.loading=!1,d.libraries.qos.loaded=!1,d.libraries.qos.failed=!0;for(var e in window.vhs_instances)window.vhs_instances.hasOwnProperty(e)&&window.vhs_instances[e].options&&(window.vhs_instances[e].options.qos=!1)},onLoadStart:function(){this.firstPlay=!0,this.akaPlugin&&(this.sessionExists&&!this.ended&&this.akaPlugin.handlePlayEnd("Interupted.New.Media.Requested"),this.setVideoData(),this.akaPlugin.handleSessionInit(),this.sessionExists=!0,this.ended=!1)},onPlay:function(){this.akaPlugin&&(this.firstPlay?(this.akaPlugin.handlePlaying(),this.firstPlay=!1):this.paused&&this.akaPlugin.handleResume()),this.paused=!1},onPause:function(){this.akaPlugin&&this.akaPlugin.handlePause(),this.paused=!0},onProgress:function(){var a,b,c=this._player.video;!c||c.ended||c.paused||c.buffered.length<=0||(a=Math.floor(c.buffered.end(c.buffered.length-1)),b=Math.floor(this._player.getCurrentTime()),b>=a?this.onBufferStart():this.onBufferEnd())},onBufferStart:function(){this.akaPlugin&&(this.buffering=!0,this.akaPlugin.handleBufferStart())},onBufferEnd:function(){this.akaPlugin&&this.buffering&&(this.akaPlugin.handleBufferEnd(),this.buffering=!1)},onEnded:function(){this.firstPlay=!0,this.ended=!0,this.akaPlugin&&this.akaPlugin.handlePlayEnd("Play.End.Detected")},onMediaError:function(a){var b="";this.akaPlugin&&(a.currentTarget&&a.currentTarget.error&&(b=a.currentTarget.error),this.akaPlugin.handleError(b))},onAdStarted:function(){this.onAdLoaded(),this.akaPlugin&&this.akaPlugin.handleAdStarted()},onAdCompleted:function(){this.akaPlugin&&this.akaPlugin.handleAdCompleted()},onAdSkipped:function(){this.akaPlugin&&this.akaPlugin.handleAdStopped()},onAdStopped:function(){this.akaPlugin&&this.akaPlugin.handleAdStopped()},onAdFirstQuartile:function(){this.akaPlugin&&this.akaPlugin.handleAdFirstQuartile()},onAdMidpoint:function(){this.akaPlugin&&this.akaPlugin.handleAdMidPoint()},onAdThirdQuartile:function(){this.akaPlugin&&this.akaPlugin.handleAdThirdQuartile()},onAdError:function(a){this.akaPlugin&&this.akaPlugin.handleAdError()},onAdLoaded:function(){this.akaPlugin&&this.akaPlugin.handleAdLoaded({adTitle:this._player.getAdTitle(),adDuration:this._player.adDuration()})},setPlayerData:function(){this.akaPlugin&&(this.akaPlugin.setData("mode",this._options.mode),this.akaPlugin.setData("autoplay",this._options.autoplay),this.akaPlugin.setData("version",d._version),this.akaPlugin.setData("playerId",this._player.getPlayerType()),this._options.live===!0?this.akaPlugin.setData("deliveryType","L"):this.akaPlugin.setData("deliveryType","O"))},setVideoData:function(){this.akaPlugin&&(this.akaPlugin.setData("title",this._player.getTitle()),this.akaPlugin.setData("contentLength",this._player.getDuration()),this.akaPlugin.setData("category",this._player.getCategory()),this.akaPlugin.setData("videoId",this._player.getVideoId()))}},d.api.Controls=function(a){var b=['<div class="nytd-player-controls">','<span class="nytd-player-controls-play vhs-icon-play"></span>','<span class="nytd-player-controls-reload vhs-icon-reload"></span>','<span class="nytd-player-controls-exclamation vhs-icon-exclamation"></span>','<div class="nytd-player-controls-ad-label">Advertisement</div>','<div class="nytd-player-controls-live-label">LIVE</div>','<div class="nytd-player-controls-error-msg">Error</div>','<div class="nytd-player-controls-current-time">00:00</div>','<div class="nytd-player-controls-progress">','<span class="nytd-player-controls-progress-marker vhs-icon-circle"></span>','<span class="nytd-player-controls-progress-time"></span>','<span class="nytd-player-controls-progress-buffer"></span>','<span class="nytd-player-controls-progress-scrubber"></span>',"</div>",'<span class="nytd-player-controls-fullscreen vhs-icon-resize-full"></span>','<span class="nytd-player-controls-volume vhs-icon-volume-up"></span>','<span class="nytd-player-controls-hd vhs-icon-hd-off"></span>','<div class="nytd-player-controls-duration">00:00</div>',"</div>"].join("");this.player=a,this.rendered=!1,this.seeking=!1,this.draggingMarker=!1,this.mouseoverContainer=!0,this.controlsVisible=!1,this.element=c(b),this.device=d.util.getDeviceType(),this.live=this.player&&this.player.options&&this.player.options.live?!0:!1},d.api.Controls.prototype={initialize:function(){this.render(),this.registerUI(),this.actions(),this.listeners(),this.live&&this.configureLive()},render:function(){return this.rendered||"android_legacy"===this.device||"ie_mobile"===this.device?!1:(this.player.container.append(this.element),this.rendered=!0,void(this.controlsVisible=!0))},registerUI:function(){this.ui={play:this.element.find(".nytd-player-controls-play"),reload:this.element.find(".nytd-player-controls-reload"),fullscreen:this.element.find(".nytd-player-controls-fullscreen"),volume:this.element.find(".nytd-player-controls-volume"),progress:this.element.find(".nytd-player-controls-progress"),marker:this.element.find(".nytd-player-controls-progress-marker"),progressBuffer:this.element.find(".nytd-player-controls-progress-buffer"),progressTime:this.element.find(".nytd-player-controls-progress-time"),duration:this.element.find(".nytd-player-controls-duration"),current:this.element.find(".nytd-player-controls-current-time"),errormsg:this.element.find(".nytd-player-controls-error-msg"),hd:this.element.find(".nytd-player-controls-hd")}},actions:function(){var a=this;this.ui.play.on("click",function(b){a.player.togglePlay(),a.player.isTouch&&(b.preventDefault(),b.stopPropagation())}),this.ui.reload.on("click",function(b){a.player.reloadVideo(),a.live||a.player.play(),a.player.isTouch&&(b.preventDefault(),b.stopPropagation())}),this.ui.fullscreen.on("click",function(b){a.player.toggleFullscreen(),a.player.isTouch&&(b.preventDefault(),b.stopPropagation())}),d.util.supportsFullscreen()||(this.ui.fullscreen.addClass("vhs-icon-disabled"),this.ui.fullscreen.off()),this.ui.volume.on("click",function(b){a.player.toggleVolume(),a.player.isTouch&&(b.preventDefault(),b.stopPropagation())}),this.ui.marker.on("click",function(a){a.preventDefault(),a.stopPropagation()}),this.ui.progress.on("mousedown touchstart",function(b){b.stopPropagation(),a.draggingMarker=!0}),this.ui.progress.on("touchstart click",function(b){b.preventDefault(),b.stopPropagation(),a.seek(b)}),this.ui.hd.on("click",function(b){b.preventDefault(),b.stopPropagation(),a.player.adPlaying()||(a.player.toggleHD(b),a.setHDIconState())}),c(document).on("mouseup touchend",c.proxy(this.onDocumentMouseup,this)),c(document).on("mousemove touchmove",c.proxy(this.onDocumentMousemove,this)),d.util.jqueryInUse()&&this.element.hover(function(){a.element.addClass("nytd-player-controls-hover")},function(){a.element.removeClass("nytd-player-controls-hover")})},listeners:function(){this.player.on(d.api.events.PLAY,c.proxy(this.onPlay,this)),this.player.on(d.api.events.PLAYING,c.proxy(this.onPlay,this)),this.player.on(d.api.events.ENDED,c.proxy(this.onEnded,this)),this.player.on(d.api.events.LEVEL_ENDLIST,c.proxy(this.hlsEndListFound,this)),this.player.on(d.api.events.AD_COMPLETED,c.proxy(this.onAdCompleted,this)),this.player.on(d.api.events.AD_PAUSED,c.proxy(this.onAdPaused,this)),this.player.on(d.api.events.AD_RESUMED,c.proxy(this.onAdResumed,this)),this.player.on(d.api.events.AD_STARTED,c.proxy(this.onAdStarted,this)),this.player.on(d.api.events.AD_TIME_UPDATE,c.proxy(this.onAdTimeUpdate,this)),this.player.on(d.api.events.AD_SKIPPED,c.proxy(this.onAdSkipped,this)),this.player.on(d.api.events.AD_STOPPED,c.proxy(this.onAdStopped,this)),this.player.on(d.api.events.PAUSE,c.proxy(this.onPause,this)),this.player.on(d.api.events.MUTE,c.proxy(this.onMute,this)),this.player.on(d.api.events.DURATION_CHANGE,c.proxy(this.onDurationChange,this)),this.player.on(d.api.events.TIME_UPDATE,c.proxy(this.onTimeupdate,this)),this.player.on(d.api.events.GO_FULLSCREEN,c.proxy(this.onEnterFullscreen,this)),this.player.on(d.api.events.EXIT_FULLSCREEN,c.proxy(this.onExitFullscreen,this)),this.player.on(d.api.events.ERROR,c.proxy(this.onError,this)),this.player.on(d.api.events.LOAD_START,c.proxy(this.onLoadStart,this)),this.player.on(d.api.events.PROGRESS,c.proxy(this.onProgress,this)),this.player.on(d.api.events.VIDEO_FLASH_BYTES_LOADED_CHANGE,c.proxy(this.onVideoFlashBytesLoadedChange,this)),this.player.container.on("touchend",c.proxy(this.onTouchEndVideo,this)),this.element.on("touchend",c.proxy(this.onTouchEndControls,this)),this.player.container.on("mouseenter",c.proxy(this.onMouseEnterVideo,this)),this.player.container.on("mouseleave",c.proxy(this.onMouseLeaveVideo,this)),this.player.container.on("mousemove",c.proxy(this.onMouseMoveVideo,this)),this.element.on("mouseenter",c.proxy(this.onMouseEnterControls,this)),this.element.on("mouseleave",c.proxy(this.onMouseLeaveControls,this))},configureLive:function(){this.element.addClass("nytd-player-live-controls"),this.element.addClass("withouthd")},configureVOD:function(){this.element.removeClass("nytd-player-live-controls"),this.renderHdButton(this.player._data&&this.player._data.renditions&&!this.player.options.live)},hlsEndListFound:function(){this.configureVOD()},onMouseEnterVideo:function(){this.mouseoverContainer=!0,this.show(),this.element.hasClass("nytd-player-controls-hover")||this.startFadeOutTimer()},onMouseLeaveVideo:function(){this.mouseoverContainer=!1,this.player.isPaused()?"desktop"===this.device&&this.startFadeOutTimer(2e3,!0):this.hide()},onMouseMoveVideo:function(){this.mouseoverContainer&&!this.controlsVisible&&(this.show(),this.element.hasClass("nytd-player-controls-hover")||this.startFadeOutTimer())},onMouseEnterControls:function(){clearInterval(this.controlsHideTimeout)},onMouseLeaveControls:function(){this.mouseoverContainer&&this.controlsVisible&&this.startFadeOutTimer()},onTouchEndVideo:function(a){a.target===this.player.video&&(this.player.adPlaying()?this.show():this.controlsVisible?this.startFadeOutTimer(100):(this.show(),this.startFadeOutTimer()))},onTouchEndControls:function(a){this.show(),this.player.adPlaying()||this.startFadeOutTimer()},onPlay:function(){this.ui.play.addClass("vhs-icon-pause").removeClass("vhs-icon-play"),this.hideErrorSlate(),this.setHDIconState(),this.startFadeOutTimer(300)},onEnded:function(){this.ui.play.addClass("vhs-icon-play").removeClass("vhs-icon-pause"),this.live&&"html5"===this.player.getType()&&this.configureVOD(),this.show()},onAdCompleted:function(){this.element.removeClass("nytd-player-ad-controls"),this.ui.hd.removeClass("vhs-icon-hd-disabled"),this.ui.play.removeClass("vhs-icon-pause").addClass("vhs-icon-play"),this.player.isTouch&&this.hide()},onAdPaused:function(){this.ui.play.removeClass("vhs-icon-pause").addClass("vhs-icon-play"),this.show()},onAdResumed:function(){this.ui.play.addClass("vhs-icon-pause").removeClass("vhs-icon-play"),this.startFadeOutTimer(300)},onAdStarted:function(){this.element.addClass("nytd-player-ad-controls"),this.ui.hd.addClass("vhs-icon-hd-disabled"),this.ui.play.addClass("vhs-icon-pause").removeClass("vhs-icon-play"),this.player.poster&&this.player.poster.hide(),this.player.isTouch&&this.show()},onAdSkipped:function(){this.element.removeClass("nytd-player-ad-controls"),this.ui.hd.removeClass("vhs-icon-hd-disabled"),this.player.isTouch&&this.hide()},onAdStopped:function(){this.element.removeClass("nytd-player-ad-controls"),this.ui.hd.removeClass("vhs-icon-hd-disabled"),this.player.isTouch&&this.hide()},onPause:function(a){this.ui.play.addClass("vhs-icon-play").removeClass("vhs-icon-pause"),this.show()},onMute:function(a){a?this.ui.volume.addClass("vhs-icon-volume-off").removeClass("vhs-icon-volume-up"):this.ui.volume.addClass("vhs-icon-volume-up").removeClass("vhs-icon-volume-off")},onEnterFullscreen:function(){d.util.isIpad()&&(this.hide(!0),this.player.element.attr("controls","controls")),this.ui.fullscreen.addClass("vhs-icon-resize-default").removeClass("vhs-icon-resize-full")},onExitFullscreen:function(){d.util.isIpad()&&(this.show(),this.player.element.removeAttr("controls")),this.ui.fullscreen.addClass("vhs-icon-resize-full").removeClass("vhs-icon-resize-default")},onError:function(a){this.player.logger.error("!!! Error Event",a),this.live?this.showLiveStreamDownMsg(a):this.showVodErrorMsg(a)},onLoadStart:function(){this.hideErrorSlate()},onDurationChange:function(a){var b=parseInt(a,10);this.ui.duration.html(this.formatTime(b))},onTimeupdate:function(a){this.seeking||this.updateProgressUI(a)},onAdTimeUpdate:function(a){var b=this.player.adDuration()-a,c=this.formatTime(b);this.ui.duration.html(c),this.player.options.skipAd&&this.player.skipAdUpdate(b)},onDocumentMousemove:function(a){var b,c,d,e;this.draggingMarker&&this.player&&"function"==typeof this.player.duration&&(c=0,d=0,e=0,b=this.player.isTouch&&a&&a.originalEvent&&a.originalEvent.touches?a.originalEvent.touches[0].pageX||a.originalEvent.changedTouches[0].pageX:a.pageX,d=-1*(this.ui.progress.offset().left-b),d>c&&d<this.ui.progress.width()?e=this.player.duration()*d/this.ui.progress.width():d>=this.ui.progress.width()&&(e=this.player.duration()),this.player.seek(e),this.updateProgressUI(e),this.seeking=!0)},onDocumentMouseup:function(){var a=this;this.draggingMarker=!1,setTimeout(function(){a.seeking=!1},500)},onProgress:function(a){var b=0,c=0;if(this.player&&this.player.element&&this.player.element[0]&&this.player.element[0].buffered&&this.player.element[0].buffered.end)try{var d=this.player.element[0].buffered.length-1;d>=0&&(c=this.player.element[0].buffered.end(d))}catch(e){this.player.logger.error("error getting the buffer from the video element",e)}b=this.getTimePosition(c),this.ui.progressBuffer.css({width:b+"%"})},onVideoFlashBytesLoadedChange:function(a){var b=a&&a.data&&a.data.bytesloaded?a.data.bytesloaded:0,c=a&&a.data&&a.data.bytestotal?a.data.bytestotal:0,d=c>0?Math.round(b/c*100):0;this.ui.progressBuffer.css({width:d+"%"})},show:function(){var a=[400,1];this.player.logger.log("controls show"),clearInterval(this.controlsHideTimeout),this.controlsVisible=!0,d.util.jqueryInUse()?this.element.stop(!0,!1).fadeTo(a[0],a[1]):this.element.css({opacity:a[1]}),this.player.trigger(d.api.events.SHOW_CONTROLS,{fadeArgs:a})},hide:function(a){var b=[400,0];if(this.player.logger.log("controls hide"),!this.player.firstPlay||a){var c=this;d.util.jqueryInUse()?this.element.stop(!0,!1).fadeTo(b[0],b[1],function(){c.controlsVisible=!1}):(this.element.css({opacity:b[1]}),this.controlsVisible=!1),this.player.trigger(d.api.events.HIDE_CONTROLS,{fadeArgs:b})}},startFadeOutTimer:function(a,b){if(b=b||!1,!b&&this.player.isPaused())return!1;this.player.logger.log("controls startFadeOutTimer");var c=a||6e3,d=this;clearInterval(this.controlsHideTimeout),this.controlsHideTimeout=setTimeout(function(){d.hide()},c)},seek:function(a){var b=0;b=this.player.isTouch?a.originalEvent.touches[0].pageX||a.originalEvent.changedTouches[0].pageX:a.pageX;var c=-1*(this.ui.progress.offset().left-b),d=Math.round(this.player.duration()*c/this.ui.progress.width());this.player.seek(d),this.updateProgressUI(d)},formatTime:function(a){var b,c,d;return b=parseInt(a,10),0>b&&(b=0),c=Math.floor(b/60),d=b-60*c,10>c&&(c="0"+c),10>d&&(d="0"+d),c+":"+d},getTimePosition:function(a){var b=a/this.player.duration()*100;return parseFloat(b.toFixed(2))},updateProgressUI:function(a){var b,c=this.getTimePosition(a);this.ui.progressTime.css({width:c+"%"}),b=(this.ui.progressTime.width()-9)/this.ui.progress.width()*100,this.ui.marker.css({left:b.toFixed(2)+"%"}),this.ui.current.html(this.formatTime(a))},onSourceError:function(){this.live||3!==this.player.element[0].networkState||this.player.trigger(d.api.events.ERROR,{error:{code:203,msg:"NETWORK_NO_SOURCE: All video sources unavailable."}})},showLiveStreamDownMsg:function(a){var b=this.player.element&&this.player.element[0]?this.player.element[0].error:null,c=d.util.getErrorMessage(b);this.element.addClass("nytd-player-error-controls"),this.ui.errormsg.html(c),b&&b.code&&b.code===b.MEDIA_ERR_SRC_NOT_SUPPORTED&&this.player&&this.player.element[0]&&""===this.player.element[0].canPlayType("application/x-mpegURL")&&this.element.addClass("nytd-player-error-not-supported")},showVodErrorMsg:function(a){if(a){var b,c=a.currentTarget?a.currentTarget.error:a.error,e=!0;this.element.addClass("nytd-player-error-controls"),"html5"===this.player.options.mode&&c&&c.code&&c.code===c.MEDIA_ERR_SRC_NOT_SUPPORTED&&this.player&&this.player.element[0]&&""===this.player.element[0].canPlayType("video/mp4")&&(this.element.addClass("nytd-player-error-not-supported"),e=!1),b=d.util.getErrorMessage(c,"vod",e),this.ui.errormsg.html(b),this.show()}},hideErrorSlate:function(){this.element.removeClass("nytd-player-error-controls"),this.element.removeClass("nytd-player-error-not-supported"),this.ui.errormsg.html("")},renderHdButton:function(a){a?this.element.removeClass("withouthd"):this.element.addClass("withouthd")},setHDIconState:function(){this.player.enableHD?this.ui.hd.addClass("vhs-icon-hd-on"):this.ui.hd.removeClass("vhs-icon-hd-on")}},d.api.Fullscreen=function(a){this.player=a,this.listeners()},d.api.Fullscreen.prototype={_permissionGranted:!1,_isFullscreen:!1,_resizeProxy:null,listeners:function(){this._resizeProxy=c.proxy(this.onVHSFullscreenResize,this),c(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange vhsfullscreenchange",c.proxy(this.onFullscreenChange,this)),c(window).on("keydown",c.proxy(this.onEscKey,this))},_canRequestFullScreen:function(a){var b=a||document.createElement("video"),c=function(a,b){return"function"==typeof a[b]};return c(b,"requestFullscreen")||c(b,"webkitRequestFullscreen")||c(b,"webkitEnterFullScreen")||c(b,"mozRequestFullScreen")||c(b,"msRequestFullscreen")},onFullscreenChange:function(){if(this.getPermission()){var a=this.player.container,b=a.data("ratioFix");return d.util.isIpad()?(this.isEnabled()?this.player.trigger(d.api.events.GO_FULLSCREEN):(this.player.trigger(d.api.events.EXIT_FULLSCREEN),this.setPermission(!1)),!1):void(this.isEnabled()?(this.player.trigger(d.api.events.GO_FULLSCREEN),a.width(c(document).width())):(this.player.trigger(d.api.events.EXIT_FULLSCREEN),a.css({height:b?0:d.util.normalizeUnit(this.player.options.height),width:d.util.normalizeUnit(this.player.options.width)}),this.setPermission(!1)))}},onVHSFullscreenResize:function(){if(this.getPermission()){var a=this.computePlayerRect(),b={width:d.util.normalizeUnit(a.width),height:d.util.normalizeUnit(a.height),left:d.util.normalizeUnit(a.left),top:d.util.normalizeUnit(a.top),"padding-bottom":0};this.player.container.css(b)}},computePlayerRect:function(){{var a,b,e,f=c(window).height(),g=c(window).width(),h=f*(16/9),i=g*(9/16);this.player.container}return g>f&&(i=f),h>g&&(h=g,i=9*h/16),a=.5*(g-h),b=0>=a?.5*(f-i):0,e={width:d.util.normalizeUnit(h),height:d.util.normalizeUnit(i),left:d.util.normalizeUnit(a),top:d.util.normalizeUnit(b)}},onEscKey:function(a){var b=a.keyCode||a.which;27===b&&this.exit()},vhsEnterFullscreen:function(){this.renderVHSFullscreenElement(),this._isFullscreen=!0,this.onFullscreenChange(),this.onVHSFullscreenResize(),c(window).resize(this._resizeProxy)},vhsExitFullscreen:function(){this.removeVHSFullscreenElement(),this._isFullscreen=!1,this.onFullscreenChange(),c(window).off("resize",this._resizeProxy)},enter:function(){var a=this.player.container[0],b=function(a,b){return"function"==typeof a[b]};this.setPermission(!0),(d.util.isIpad()||d.util.isAndroid())&&(a=this.player.element.get(0)),b(a,"requestFullscreen")?a.requestFullscreen():b(a,"webkitRequestFullscreen")?a.webkitRequestFullscreen():b(a,"webkitEnterFullScreen")?a.webkitEnterFullScreen():b(a,"mozRequestFullScreen")?a.mozRequestFullScreen():b(a,"msRequestFullscreen")?(a.msRequestFullscreen(),this.player.container.addClass("ms-fullscreen")):this.vhsEnterFullscreen()},exit:function(){if(this.getPermission()){var a=this.player.container[0];d.util.isIpad()&&(a=this.player.element.get(0)),"function"==typeof a.webkitCancelFullScreen?a.webkitCancelFullScreen():"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.msExitFullscreen?(document.msExitFullscreen(),this.player.container.removeClass("ms-fullscreen")):this.vhsExitFullscreen()}},getPermission:function(){return this._permissionGranted},setPermission:function(a){this._permissionGranted=a},isEnabled:function(){var a=d.util.getDocument();return a.fullScreen||a.mozFullScreen||a.webkitIsFullScreen||this.player.container.get(0).webkitIsFullScreen||this._isFullscreen||a.msIsFullScreen},renderVHSFullscreenElement:function(){var a=this.player.container,b=this.player.controls,d=1e5;a.data("style",a.attr("style")),a.css({position:"fixed",top:0,left:0,"z-index":d}),c('<div class="nytd-player-fullscreen"></div>').appendTo("body").css({width:"100%",height:"100%",background:"#000",position:"fixed",top:0,left:0,zIndex:d-1}),c("body").data("overflow",c("body").css("overflow")),c("body").css("overflow","hidden"),b.data("style",b.attr("style")),b.css("z-index",d+1)},removeVHSFullscreenElement:function(){var a=this.player.container,b=this.player.controls;c("body").css("overflow",c("body").data("overflow")),a.attr("style",a.data("style")),b.attr("style",b.data("style")),c(".nytd-player-fullscreen").remove()}},d.api.RenditionSelector=function(a){this.renditionsData=null,this.activeRendition=null,this.isHLSEnabled=a.isHLSEnabled,this.LIMITS=c.extend({SD:{min:360,max:480},HD:{min:480,max:720}},a&&a.renditions?a.renditions:{})},d.api.RenditionSelector.prototype={findNearest:function(a,b,c,d,e){for(var f=-1,g=a.length,h=1080+e,i=0;g>i;i++){var j=Math.abs(e-a[i][b]);h>=j&&a[i][b]>=d&&a[i][b]<=c&&(f=i,h=j)}return f},filterByFileType:function(a,b){for(var c={},d=[],e=b.length,f=0;e>f;f++)!c.hasOwnProperty(b[f].height)&&b[f]&&b[f].url&&b[f].url.indexOf(a)>-1&&(d.push(b[f]),c[b[f].height]=!0);return d},getCompatibleRenditions:function(a,b,c){var e=[];if(this.isHLSEnabled&&!c&&d.util.supportHLS(b)&&(e=this.filterByFileType(".m3u8",a)),0===e.length&&(e=this.filterByFileType("."+d.util.getSupportedType(b),a)),0===e.length&&"flash"===b){e=this.filterByFileType(".flv",a);for(var f=0;f<e.length;f++)e[f].url=e[f].url.replace(".flv","")}return e.sort(function(a,b){var c=a.height,d=b.height;return c>d?1:d>c?-1:c===d?-1:1}),e},getClosestRendition:function(a,b,c,d,e){var f,g=c?"HD":"SD",h=this.LIMITS[g].max,i=this.LIMITS[g].min,j="url"===e?"":{};return b=c?this.LIMITS[g].max:b,this.renditionsData=this.getCompatibleRenditions(a,d,c),f=this.findNearest(this.renditionsData,"height",h,i,b),-1===f&&(f=this.renditionsData.length>>1),this.renditionsData&&this.renditionsData[f]&&("url"===e?j=this.renditionsData[f].url:(j=this.renditionsData[f],j&&j.type&&(j.bitrate=this.getBitrate(j.type)))),j},getClosestRenditionUrl:function(a,b,c,d){return this.getClosestRendition(a,b,c,d,"url")},getClosestRenditionObject:function(a,b,c,d){return this.getClosestRendition(a,b,c,d,"object")},getBitrate:function(a){var b={video_xs_2g_mob:100,video_l_3g_mob:350,video_xxxl_hb_mm:1200,video_s_3g_hp:350,video_l_bb_lib:620,video_xl_bb_art:700,video_xxl_bb_mm:850,video_s_nb_well:450,video_well_s_nb:360,syndication:8e3,mobile_win:90,mobile_reg2:106,mobile_reg:56,video_s_nb:275,video_s_bb:514,video_l_nb:464,video_l_bb:714,video_a_nb:525,video_a_bb:750,video_well_s:550,
touch_itunes:1328,mobile_iphone:160,video_xl_bb_mm:720,video_144p_mp4:248,video_240p_mp4:369,video_360p_mp4:935,video_480p_mp4:1513,video_720p_mp4:2545,video_1080p_mp4:3689,video_240p_webm:369,video_360p_webm:968,video_480p_webm:1568,video_720p_webm:2632};return b[a]||2400},resetActive:function(){this.activeRendition=null},setActive:function(a){this.activeRendition=a},getActive:function(){return this.activeRendition},findRenditionByUrl:function(a){for(var b=0,c=this.renditionsData.length;c>b;b++)if(this.renditionsData[b].url===a)return this.renditionsData[b]}},d.api.Responsive=function(a){this.player=a,this.setResponsiveClass=c.proxy(this.setResponsiveClass,this),this.setResponsiveClass(),this.bindWindow()},d.api.Responsive.prototype.bindWindow=function(a){c(window).off("resize."+this.player.instance,this.setResponsiveClass),c(window).on("resize."+this.player.instance,this.setResponsiveClass)},d.api.Responsive.prototype.destroy=function(){c(window).off("resize."+this.player.instance,this.setResponsiveClass)},d.api.Responsive.classSizes={XXSMALL:{className:"vhs-xxs",rule:"lte",size:335},XSMALL:{className:"vhs-xs",rule:"lt",size:390},SMALL:{className:"vhs-s",rule:"lt",size:540},MEDIUM:{className:"vhs-m",rule:"lt",size:720},LARGE:{className:"vhs-l",rule:"lt",size:945},XLARGE:{className:"vhs-xl",rule:"lt",size:1050},XXLARGE:{className:"vhs-xxl",rule:"gte",size:1050}},d.api.Responsive.orderedClassSizes=[d.api.Responsive.classSizes.XXSMALL,d.api.Responsive.classSizes.XSMALL,d.api.Responsive.classSizes.SMALL,d.api.Responsive.classSizes.MEDIUM,d.api.Responsive.classSizes.LARGE,d.api.Responsive.classSizes.XLARGE,d.api.Responsive.classSizes.XXLARGE],d.api.Responsive.prototype.setResponsiveClass=function(){var a,b,c=this.player.container,e=c.get(0).offsetWidth,f=d.api.Responsive.orderedClassSizes.length,g=d.api.Responsive.orderedClassSizes,h=!1,i="",j={lt:function(a,b){return b>a},lte:function(a,b){return b>=a},gte:function(a,b){return a>=b}};for(b=0;f>b;b++)a=g[b],!h&&j[a.rule](e,a.size)?(h=!0,c.addClass(a.className)):i+=a.className+" ";c.removeClass(i)},d.api.Poster=function(a){this.player=a,this.ui={play:""},this.defaultMode="duration",this.template=d.templates&&d.templates.cover?d.templates.cover:null},d.api.Poster.prototype={getUrl:function(){var a,b=[];if("undefined"!=typeof this.player.options.poster)a=this.player.options.poster;else if(this.player._data)if(this.player.features.isEnabled("poster-image-select"))a=this.getClosestPosterMatch();else{b=this.player._data.images;for(var c in b)"videoSmall"===b[c].type&&(a=this.player.staticBaseUrl+b[c].url)}return a},getAvailableImages:function(){var a,b,c=this.player._data.images||[],d=c.length,e=[],f=[],g=[{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-96x54.png",width:96,height:54},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-225x126.png",width:225,height:126},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-310x174.png",width:310,height:174},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-500x281.png",width:500,height:281},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-1050x591.png",width:1050,height:591},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-1920x1080.png",width:1920,height:1080}];for(a=0;d>a;a++)c[a].type&&c[a].type.indexOf("videoSixteenByNine")>-1?e.push({url:this.player.staticBaseUrl+c[a].url,width:c[a].width,height:c[a].height}):f.push({url:this.player.staticBaseUrl+c[a].url,width:c[a].width,height:c[a].height}),"videoSmall"===c[a].type&&(b={url:this.player.staticBaseUrl+c[a].url,width:500,height:281});return 0===e.length&&(e=b?[b]:f.length>0?f:g),e},getClosestPosterMatch:function(){var a,b,c,d,e=this.getAvailableImages(),f=e.length,g=this.player.container.get(0).offsetWidth,h=.1;if(0===f)return"";if(1===f)return e[0].url;for(a=0;f>a;a++){if(e[a].width===g){b=e[a];break}e[a].width<=g&&(void 0===c||c.width<e[a].width)&&(c=e[a],c.widthDiff=Math.abs(c.width-g)),e[a].width>=g&&(void 0===d||d.width>e[a].width)&&(d=e[a],d.widthDiff=Math.abs(d.width-g))}return!b&&c&&d&&c.widthDiff<d.widthDiff&&c.widthDiff<g*h&&(b=c),b=b||d||c,b.url},render:function(){var a=this,b=this.getUrl(),e=['<div class="nytd-player-poster">',"</div>"].join("");return b?(this.element&&this.element.remove(),this.element=c(e).css({width:d.util.normalizeUnit(this.player.options.width),height:d.util.normalizeUnit(this.player.options.height),background:"url("+b+") center center no-repeat","background-size":"cover"}),this.player.poster=this.element,this.processCover(),this.player.container.prepend(this.element),!this.player.options.nativeControls||this.player.options.controls||this.player.options.cover||this.element.hide(),this.player.on(d.api.events.PLAYING,function(){a.hide()}),this.player.on(d.api.events.AD_STARTED,function(){a.hide()}),void this.player.on(d.api.events.RENDITION_NOT_FOUND,function(){a.hide()})):!1},renderNativePoster:function(){var a=this.getUrl();a&&this.player&&this.player.element&&"html5"===this.player.getType()&&this.player.element.attr("poster",a)},removeNativePoster:function(){this.player&&this.player.element&&"html5"===this.player.getType()&&this.player.element.removeAttr("poster")},update:function(){var a=this.getUrl();this.element&&a&&this.element.css({background:"url("+a+") center center no-repeat","background-size":"cover"})},handleOnClick:function(){var a=this;this.element&&this.element.on("click",function(){a.player.firstPlay&&a.player.addLoader(),a.player.rendered===!1?"flash"===a.player.getType()?(a.player.on(d.api.events.RENDERED,function b(){a.player.play(),a.player.off(d.api.events.RENDERED,b)}),a.player.render()):(a.player.render(),a.player.play()):a.player.play(),a.hide(),a.player.container&&a.player.options.spacebarToggleEnabled&&a.player.container.focus()})},hide:function(){var a=this;this.element&&!this.player.isIphone?this.element.hide():this.player.isIphone&&this.player.element&&this.player.element.one("webkitendfullscreen",function(){a.player&&(a.player.adsController&&(a.player.adsController.isCompleted=!1,a.player.adsController.isContentPlaying=!1),a.player.element&&(a.player.element.off(),a.player.element.remove()),a.player.rendered=!1,a.player.listenersInitialized=!1)})},processCover:function(){if(this.player.options.cover&&!this.player.options.autoplay&&this.template){var a=this.player.options.cover.mode||this.defaultMode;switch(a=a.toLowerCase()){case"duration":case"clean":case"article":case"mobile":break;default:a=this.defaultMode}0===this.player.getDuration()&&(a="clean"),this.renderCover(a)}},renderCover:function(a){var b,d=this.formatDuration(this.player.getDuration()),e={mode:a||this.defaultMode,data:{headline:"",byline:"",duration:d,channelName:"",showName:""}};this.player._data&&(e.data.headline=this.player._data.headline,e.data.byline=this.player._data.byline,e.data.showName=this.player._data.playlist.display_name,e.data.channelName=this.player._data.playlist.parent_display_name),b=c.trim(this.template(e)),this.element&&(this.element.append(b),this.ui.play=this.element.find(".vhs-icon-play"))},formatDuration:function(a){var b=parseInt(a,10),c=Math.floor(b/3600),d=Math.floor((b-3600*c)/60),e=b-3600*c-60*d,f="";return c?(f=c+":",f+=("0"+d).slice(-2)+":"):d?f+=d+":":f="00:",f+=("0"+e).slice(-2)}},d.api.Errors=function(a){this.player=a,this.options=a.options,this.logger=a.logger,this.errorContainer=null,this.messages={},this.messages[d.api.events.RENDITION_NOT_FOUND]="This video is not currently supported on your browser.",this.initialize()},d.api.Errors.prototype={initialize:function(){var a=this;this.player.on(d.api.events.RENDITION_NOT_FOUND,function(){a.logger.error("RENDITION_NOT_FOUND. Update Error Slate."),a.updateErrorSlate(d.api.events.RENDITION_NOT_FOUND)}),this.player.on(d.api.events.PLAYING,function(){a.logger.log("Playing a video. Hide Error Slate."),a.hideErrorSlate()}),this.player.on(d.api.events.AD_STARTED,function(){a.logger.log("Playing an ad. Hide Error Slate."),a.hideErrorSlate()})},createErrorSlate:function(a){this.errorContainer&&this.errorContainer.remove(),this.icon='<i class="vhs-icon-alert"></i>',this.errorContainer=c('<div class="vhs-error-slate"><p>'+this.icon+"</p></div>"),this.player.container.append(this.errorContainer)},updateErrorSlate:function(a){this.errorContainer||this.createErrorSlate(),this.errorContainer.find("p").html(this.icon+this.messages[a]),d.util.jqueryInUse()?this.errorContainer.fadeIn(100):this.errorContainer.show()},hideErrorSlate:function(){var a=this;this.errorContainer&&this.errorContainer.is(":visible")&&(d.util.jqueryInUse()?this.errorContainer.fadeOut(100,function(){a.errorContainer&&a.errorContainer.hide()}):this.errorContainer.hide())}},d.api.events={READY:"ready",LOADED:"loaded",PLAY:"play",PAUSE:"pause",MUTE:"mute",PLAYING:"playing",PROGRESS:"progress",SEEKED:"seeked",ENDED:"ended",BUFFERING:"buffering",BUFFER_FULL:"bufferfull",DURATION_CHANGE:"durationchange",TIME_UPDATE:"timeupdate",GO_FULLSCREEN:"gofullscreen",EXIT_FULLSCREEN:"exitfullscreen",AD_STARTED:"adstarted",AD_PAUSED:"adpaused",AD_RESUMED:"adresumed",AD_COMPLETED:"adcompleted",AD_TIME_UPDATE:"adtimeupdate",AD_PROGRESS:"adprogress",AD_SKIPPED:"adskipped",AD_STOPPED:"adstopped",AD_FIRST_QUARTILE:"ad-first-quartile",AD_MIDPOINT:"ad-mid-point",AD_THIRD_QUARTILE:"ad-third-quartile",AD_ERROR:"ad-error",RENDITION_CHANGED:"renditionchanged",LOADED_DATA:"loadeddata",RENDERED:"rendered",LOAD_START:"loadstart",ERROR:"error",STALLED:"stalled",WAITING:"waiting",VIDEO_READY:"video:ready",VIDEO_LOADING:"video:loading",VIDEO_FLASH_BYTES_LOADED_CHANGE:"video:flash:bytesloadedchange",VIDEO_FLASH_BUFFER_TIME_CHANGE:"video:flash:buffertimechange",LEVEL_ENDLIST:"levelendlist",HD_ON:"hdon",HD_OFF:"hdoff",SHOW_CONTROLS:"showcontrols",HIDE_CONTROLS:"hidecontrols",TRACKING_EVENT:"trackingevent",RENDITION_NOT_FOUND:"renditionnotfound"},d.api.Player=function(a,b){this.MAX_SD_RENDITION=480,this.enableHD=!1,this.isIphone=d.util.isIphone(),this.device=d.util.getDeviceType(),this._data=null,this._evts={},this.poster=null,this.totalTimeToSkipAd=15,this.skipAdThreshold=20,this.isReady=!1,this.isLoaded=!1,this.seeking=!1,this.readyCallbacks=[],this.loadedCallbacks=[],this.instance=b,this.instanceId=b,this.isTouch="ontouchstart"in document.documentElement,this.videoFullscreen=!1,this.listenersInitialized=!1,this.rendered=!1,this.rendering=!1,this.queuedPlayOnRendered=!1,this.adPaused=!1,this.adSkipped=!1,this.hdRenditionChanging=!1,this.videoChanged=!1,this.modules={fullscreen:null,renditions:null,responsive:null,errors:null,qos:null},this.playerStartTimestamp=new Date;var e=!(this.isIphone||"ie_mobile"===this.device||d.util.isAndroid()),f="ie_mobile"===this.device||d.util.isAndroid();this.options=c.extend({id:"",name:null,category:null,element:null,container:null,type:null,src:null,source:null,render:!0,width:600,height:338,muted:!1,preload:"none",autoplay:!1,duration:null,controls:e,nativeControls:f,nativePoster:!1,loop:!1,ads:!0,skipAd:!0,cover:!0,shareOptions:{articleId:null,blogPostUrl:null,url:null},loader:!0,freewheel:null,siteSection:null,playlist:!1,ratio:"16:9",debug:!1,api:!0,usage:"vanilla_js",mode:null,live:!1,userInitiatedPlay:!1,userInitiatedNext:!1,autoPlayNext:!1,onReady:null,onLoaded:null,renditions:{},qos:!0,flashHdSwitchSeek:!1,qosConfigUrl:null,enableVHSFullscreen:!1,spacebarToggleEnabled:!0},a),this.controlsIsVisible=!0,this.controlsRendered=!1,this.initialize()},d.api.Player.prototype={initialize:function(){this.logger=new d.api.Logger(this),this.validateEnvironment(),this.setupEnvPaths(),this.options.debugPathSWF=this.options.debugPathSWF||"../../"+d._version+"-"+d._release+"/vhs-debug.swf",this.firstPlay=!0,this.firstEnded=!0,this.restoreHDState(),this.ensureOptionDependencies(),this.checkForDeeplink(),this.validate()&&this.create()},checkForDeeplink:function(){var a,b=["t","cview"],c=function(){var a="graphics8.nytimes.com",b=d.util.getReferrer();return-1!==b.indexOf(a)},e=function(a){var b,c,e,f="",g=d.util.getCurrentURL(),h=g.split("?")[0],i=d.util.getQueryString(),j=i.replace(/^\?/,"").split("&"),k=a.length;if(window.history&&window.history.replaceState){for(b=0;k>b;b++)for(c=j.length-1;c>=0;c--)if(0===j[c].indexOf(a[b]+"=")){j.splice(c,1);break}j.length>0&&(f="?"+j.join("&")),e=h+f+d.util.getHash(),window.history.replaceState({},"",e)}};this.options.deeplinking&&(a=d.util.getCurrentURL(),this.startupSeek=d.util.seekStringToSeconds(a),d.util.getUrlParameterByName("cview")&&c()&&(this.defaultAdsState=this.options.ads,this.options.ads=!1),this.startupSeek&&d.util.getQueryString()&&e(b))},ensureOptionDependencies:function(){d.util.supportsAutoplay()||(this.options.autoplay=!1),!this.options.cover||this.options.poster||this.options.id&&this.options.api||(this.options.cover=!1),this.options.loop&&(this.options.ads=!1,this.options.analytics=!1),this.options.conviva===!1&&(this.options.qos=!1),this.options.analytics===!1&&(this.options.comscore=!1,this.options.eventTracker=!1,this.options.qos=!1,this.options.webtrends=!1,this.options.tagx=!1)},validateEnvironment:function(){var a=["localhost","development","staging","production"],b=["www.nytimes.com","cooking.nytimes.com","paidpost.nytimes.com","brandedplaylist.nytimes.com"],e=d.util.getHost();void 0!==this.options.env||this.options.debug?(-1===c.inArray(this.options.env,a)||-1!==c.inArray(e,b))&&(this.options.env="production"):this.options.env=d.util.getEnvFromHost()},setupEnvPaths:function(){switch(this.options.env){case"localhost":this.apiBaseDomain="http://video-api.dev.nytimes.com",this.staticBaseUrl="http://static.dev.nytimes.com/",this.fwAdManager="http://adm.fwmrm.net/p/nytimes_test/AdManager.swf",this.fwServer="http://fw.stg.nytimes.com/ad/g/1",this.fwNetworkId=379535,this.fwProfile="ny_times_prop_as3_test";break;case"development":this.apiBaseDomain="http://www.stg.nytimes.com",this.staticBaseUrl="http://static.dev.nytimes.com/",this.fwAdManager="http://adm.fwmrm.net/p/nytimes_test/AdManager.swf",this.fwServer="http://fw.stg.nytimes.com/ad/g/1",this.fwNetworkId=379535,this.fwProfile="ny_times_prop_as3_test";break;case"staging":this.apiBaseDomain="http://www.stg.nytimes.com",this.staticBaseUrl="http://static.stg.nytimes.com/",this.fwAdManager="http://adm.fwmrm.net/p/nytimes_test/AdManager.swf",this.fwServer="http://fw.stg.nytimes.com/ad/g/1",this.fwNetworkId=379535,this.fwProfile="ny_times_prop_as3_test";break;default:this.apiBaseDomain="http://www.nytimes.com",this.staticBaseUrl="http://static01.nyt.com/",this.fwAdManager="http://adm.fwmrm.net/p/nytimes_live/AdManager.swf",this.fwServer="http://fw.nytimes.com/ad/g/1",this.fwNetworkId=379536,this.fwProfile="ny_times_prop_as3"}this.options.apiBaseDomain&&(this.apiBaseDomain=this.options.apiBaseDomain),this.apiBasePath=this.options.apiBasePath||"/svc/video/api/v2/",this.apiBaseUrl=this.apiBaseDomain+this.apiBasePath},create:function(){var a=this,b=this.options.id;this.element=this.options.element||null,this.features||(this.features=new d.api.FeatureFlags(this)),this.options.flashHdSwitchSeek=this.features.isEnabled("flash-hd-switch-seek"),this.options.isHLSEnabled=this.features.isEnabled("hls"),this.modules.renditions=new d.api.RenditionSelector(this.options),this.detectTearsheeting(),this.renderContainer(),this.plugins=new d.api.Plugins(this),this.modules.qos||(this.modules.qos=new d.api.Qos(this)),this.modules.errors||(this.modules.errors=new d.api.Errors(this)),""!==this.options.id&&this.options.api?this.getData(b,"video",function(b){a._data=b,a.plugins.reload(),a.renderPlayer()}):this.renderPlayer(),d.styleLoaded||this.loadControlsStyle(),this.modules.fullscreen=d.util.supportsFullscreen()||this.options.enableVHSFullscreen?new d.api.Fullscreen(this):null},destroy:function(a){this.element&&("html5"===this.options.mode?(this.isPaused()||this.video.pause(),this.adsController&&("function"==typeof this.adsController.unregisterContextListeners&&this.adsController.unregisterContextListeners(),this.adsController.isContentPlaying&&this.adsController.stop()),this.element.attr("src",""),this.element.off(),this.element.unbind(),this.element.remove()):"flash"===this.options.mode&&this.objectId&&c("#"+this.objectId).remove()),this.container&&this.container.remove(),delete window.vhs_instances[this.instance],"function"==typeof a&&a()},validate:function(){var a=!0;if(""===this.options.id&&null===this.options.src&&null===this.options.source)throw a=!1,new Error("ID, SRC or SOURCE should be provided");if(""===this.options.id&&null===this.options.name)throw a=!1,new Error("NAME should be provided");if(null===this.options.element&&null===this.options.container)throw a=!1,new Error("CONTAINER should be provided");return a},getData:function(a,b,e){var f=this.apiBaseUrl+b+"/"+a,g=a,h=this;for(var i in window.vhs_instances)a===window.vhs_instances[i].options.id&&(g=this.instance);this.options.shareOptions&&(this.options.shareOptions.articleId?f+="?articleId="+encodeURIComponent(this.options.shareOptions.articleId):this.options.shareOptions.blogPostUrl&&(f+="?blogPostUrl="+encodeURIComponent(this.options.shareOptions.blogPostUrl))),c.ajax({url:f,cache:!0,dataType:"jsonp",jsonpCallback:"vhs_callback_"+g,timeout:15e3,success:function(a){e(h.transformData(a,b))},error:function(a,b,c){h.logger.error("error",a,b,c),h.trigger(d.api.events.TRACKING_EVENT,{data:{name:"cherry-api-request-error",errorStatus:b,errorThrown:c}})}})},transformData:function(a,b){return"object"==typeof a&&"video"===b&&"string"==typeof a.byline&&(a.byline=0===a.byline.toLowerCase().indexOf("by ")||0===a.byline.length?a.byline:["By ",a.byline].join("")),a},renderPlayer:function(){var a=this.options.render&&this.options.cover===!1||this.options.autoplay===!0;this.on(d.api.events.RENDERED,function(){a&&this.modules.poster&&this.modules.poster.handleOnClick()}),this.registerSharedListeners(),this.options.autoplay?this.poster=c("<div></div>"):this.renderPoster(),this.modules.responsive||(this.modules.responsive=new d.api.Responsive(this)),(this.options.ads&&this.options.skipAd&&this.options.controls||this.options.deeplinking)&&this.renderSkipAd(),!a&&this.modules.poster&&this.modules.poster.handleOnClick(),a?(this.on(d.api.events.RENDERED,function b(){this._loaded(),this._ready(),this.off(d.api.events.RENDERED,b)}),this.render()):(this._loaded(),this._ready())},renderPoster:function(){this.modules.poster&&this.modules.poster.element?this.modules.poster.update():(this.modules.poster=new d.api.Poster(this),this.modules.poster.render())},render:function(){},renderContainer:function(){var a=this,b=this.options.container;return this.element?(this.container=c("<div></div>"),this.container.insertAfter(this.element)):this.container=null!==b&&"object"==typeof b&&b.length?b:c("#"+b),this.container.addClass("nytd-player-container"),this.container.attr("id")||this.container.attr("id",this.instanceId),"16:9"===this.options.ratio&&"100%"===this.options.height&&"100%"===this.options.width?this.container.css({background:"#000","padding-bottom":"56.25%",height:0,position:"relative",overflow:"hidden",width:d.util.normalizeUnit(this.options.width)}).data("ratioFix",!0):this.container.css({width:d.util.normalizeUnit(this.options.width),height:d.util.normalizeUnit(this.options.height)}),this.on("playing",function(){a.options.controls&&a.isTouch&&a.modules.controls.hide()}),this.container},loadControlsStyle:function(){var a=c("head"),b=this.staticBaseUrl+"video/vhs/"+d._version+"-"+d._release+"/vhs.css";this.options.debug&&(b="../../"+d._version+"-"+d._release+"/vhs.css",this.options.debugPathCSS&&(b=this.options.debugPathCSS)),d.styleLoaded||(a.append('<style type="text/css">.nytd-player-controls{ display: none; }</style>'),a.append('<link href="'+b+'" rel="stylesheet">'),d.styleLoaded=!0)},adPlaying:function(){throw new Error("This method must be overriden")},getCurrentTime:function(){throw new Error("This method must be overriden")},_skipAd:function(){this.trigger(d.api.events.AD_SKIPPED),this.skipAd()},renderSkipAd:function(){var a=this;this.skipAdElement=c('<div class="nytd-player-ad-skip-ad" style="display: none;"><span></span><button>skip ad</button></div>'),this.container.append(this.skipAdElement),this.skipAdElement.bind("click",function(b){c(this).hasClass("vhs-countdown-done")&&(b.preventDefault(),a._skipAd())}),this.on(d.api.events.AD_STARTED,function(){a.skipAdElement&&(a.skipAdElement.removeClass("vhs-countdown-done").addClass("vhs-countdown-started").show(),a.skipAdButtonVisible=!1)}),this.on(d.api.events.AD_COMPLETED,function(){a.hideSkipAd()}),this.on(d.api.events.AD_SKIPPED,function(){a.hideSkipAd()}),this.on(d.api.events.AD_STOPPED,function(){a.hideSkipAd()})},hideSkipAd:function(){this.skipAdElement&&this.skipAdElement.hide()},skipAdUpdate:function(a){var b,c,d=Math.round(a),e=("0"+d).slice(-2),f=this.skipAdElement.find("span"),g=(this.skipAdElement.find("button"),Math.round(this.adDuration()));g>=this.skipAdThreshold?d>this.totalTimeToSkipAd?(b=d-this.totalTimeToSkipAd,c=("0"+b).slice(-2),f.html("YOU CAN SKIP THIS AD IN <strong>"+c+"</strong> SECONDS")):this.skipAdButtonVisible||(this.skipAdElement.removeClass("vhs-countdown-started"),this.skipAdElement.addClass("vhs-countdown-done"),this.skipAdButtonVisible=!0):f.html("YOUR VIDEO WILL START IN <strong>"+e+"</strong> SECONDS")},renderControls:function(){this.modules.controls||(this.modules.controls=new d.api.Controls(this),this.modules.controls.initialize(),this.controls=this.modules.controls.element,this.modules.controls.renderHdButton(this._data&&this._data.renditions&&!this.options.live))},_loaded:function(){"function"==typeof this.options.onLoaded&&this.options.onLoaded.apply(this);for(var a=this.loadedCallbacks.length,b=0;a>b;b++)"function"==typeof this.loadedCallbacks[b]&&this.loadedCallbacks[b].apply(this);this.isLoaded=!0,this.container.data("loaded",!0),this.container.trigger("vhs:loaded",this),this.trigger(d.api.events.LOADED)},loaded:function(a){this.isLoaded?a.apply(this):this.loadedCallbacks.push(a)},_ready:function(){"function"==typeof this.options.onReady&&this.options.onReady.apply(this);for(var a=this.readyCallbacks.length,b=0;a>b;b++)"function"==typeof this.readyCallbacks[b]&&this.readyCallbacks[b].apply(this);this.isReady=!0,this.container.data("ready",!0),this.container.trigger("vhs:ready",this),this.trigger(d.api.events.READY),this.readyCallbacks=[]},ready:function(a){this.isReady?a.apply(this):this.readyCallbacks.push(a)},on:function(a,b){if("function"!=typeof b)throw new Error("The callback argument should be a function");this._evts[a]=this._evts[a]||[],this._evts[a].unshift(b)},off:function(a,b){var c;if(this._evts.hasOwnProperty(a)){if(!b)return void delete this._evts[a];c=this._evts[a]||[];for(var d=0,e=c.length;e>d;d++)if(c[d]===b){c.splice(d,1);break}}},trigger:function(a,b){if(this._evts&&"object"==typeof this._evts)for(var c in this._evts)if(c===a)for(var d=this._evts[c]||[],e=d.length-1;e>=0;e--)"function"==typeof d[e]&&d[e].call(this,b)},toggleFullscreen:function(){this.fullscreen(!this.isFullscreen())},isFullscreen:function(){return this.modules.fullscreen.isEnabled()},fullscreen:function(a){if(!this.modules.fullscreen)return!1;var b=this.modules.fullscreen,c=a===!1?!1:!0;c&&this.poster&&this.poster.hide(),c?b.enter():b.exit()},getSiteSection:function(){function a(a){var b=""===a?"none":a;return b.replace(/[^a-zA-Z]/g,"").toLowerCase()}var b=c('meta[name="CG"]').attr("content")||"",d=c('meta[name="SCG"]').attr("content")||"",e=c('meta[name="PT"]').attr("content")||"",f=a(b)+"_"+a(d)+"_"+a(e);return f},getPlayerType:function(){var a=c('meta[name="PT"]').attr("content"),b=c('meta[name="PST"]').attr("content"),d=c('meta[name="slug"]').attr("content"),e=a&&b?a.toLowerCase()+"-"+b.toLowerCase():null,f=null;return this.options.type?f=this.options.type:"multimedia-interactive"===e&&d?f=e+"|"+d:e?f=e:this.logger.error("Player TYPE should be provided"),f},isEmbeddedOnly:function(){return this._data&&this._data.playlist&&"object"==typeof this._data.playlist&&Object.getOwnPropertyNames(this._data.playlist).length>0?!1:!0},getVideoId:function(){var a="unknown";return this._data&&this._data.id?a=this._data.id:this.options&&this.options.id&&(a=this.options.id),a},getTitle:function(){var a="";return this.options.name?a=this.options.name:this._data&&this._data.headline&&(a=this._data.headline),a},getCategory:function(){var a="";return this.options.category?a=this.options.category:this._data&&this._data.section&&this._data.section.content&&(a=this._data.section.content),a},getSeries:function(){var a="";return this.options.series?a=this.options.series:this._data&&this._data.contentSeries&&(a=this._data.contentSeries.name),a},getDuration:function(){var a=0;return this.options.duration?a=this.options.duration/1e3:this._data&&this._data.duration?a=this._data.duration/1e3:this.video&&(a="function"==typeof this.video.duration?this.video.duration():this.video.duration),a||0},getPrimaryPlaylistId:function(){var a="";return this.options.playlistId?a=this.options.playlistId:this._data&&this._data.playlist&&(a=this._data.playlist.id),a},getVideoCanonical:function(){var a="";return this._data&&this._data.publish_url&&this._data.domain&&(a=this._data.domain+this._data.publish_url),a},getVideoCanonicalAtCurrentTime:function(){var a="";return this._data&&this._data.publish_url&&this._data.domain&&(a=this._data.domain+this._data.publish_url,this.adPlaying()||(a+="?t="+Math.round(this.getCurrentTime()))),a},getEmbedCode:function(){var a="",b=this._data&&this._data.article_data&&this._data.article_data.id?"&articleId="+this._data.article_data.id:"",c=!b&&this._data&&this._data.blogpost_data&&this._data.blogpost_data.url?"&blogPostUrl="+this._data.blogpost_data.url:"";return d.templates.embedCode&&(a=d.templates.embedCode({id:"nyt_video_player",title:"New York Times Video - Embed Player",src:"http://graphics8.nytimes.com/video/players/offsite/index.html?videoId="+this.getVideoId()+b+c})),d.util.escapeHtml(a)},togglePlay:function(){this.isPaused()||this.isEnded()?this.play():this.pause()},hideControls:function(){this.modules&&this.modules.controls&&this.modules.controls.hide()},showControls:function(){this.modules&&this.modules.controls&&this.modules.controls.show()},addLoader:function(){this.container&&this.options.loader&&0===this.container.find(".vhs-loader").length&&this.container.append('<div class="vhs-loader"></div>')},removeLoader:function(){var a;this.container&&(a=this.container.find(".vhs-loader"),a.length>0&&a.remove())},registerSharedListeners:function(){this.on(d.api.events.PLAY,function(){this.firstPlay=!1,this.pauseOtherPlayers(),this.removeLoader()}),this.on(d.api.events.AD_STARTED,function(){this.firstPlay=!1,this.pauseOtherPlayers(),this.removeLoader()}),this.on(d.api.events.AD_RESUMED,function(){this.pauseOtherPlayers()})},pauseOtherPlayers:function(){if(!d.config.allowMultiplePlayers)for(var a in window.vhs_instances)this.instance!==a&&window.vhs_instances[a].pause()},triggerHDEvent:function(){this.enableHD?(b.enabled&&b.set("nytvhshd","1"),this.trigger(d.api.events.HD_ON)):(b.enabled&&b.set("nytvhshd"),this.trigger(d.api.events.HD_OFF))},restoreHDState:function(){this.enableHD="1"===b.get("nytvhshd")},bindStartupSeekEvents:function(){var a=this,b="html5"===this.options.mode?d.api.events.VIDEO_READY:d.api.events.PLAY;this.on(d.api.events.RENDERED,function c(){this.on(b,function e(){a.off(b,e),this.startupSeek<this.getDuration()&&a.seek(this.startupSeek)}),this.off(d.api.events.RENDERED,c)}),this.options.ads&&(this.on(d.api.events.AD_COMPLETED,function e(){this.on(b,function c(){a.off(b,c),this.startupSeek<this.getDuration()&&a.seek(this.startupSeek)}),this.off(d.api.events.AD_COMPLETED,e)}),this.on(d.api.events.AD_SKIPPED,function f(){this.on(b,function c(){a.off(b,c),this.startupSeek<this.getDuration()&&a.seek(this.startupSeek)}),this.off(d.api.events.AD_SKIPPED,f)})),this.on(d.api.events.ENDED,function g(){a.off(d.api.events.ENDED,g),a.resetStartupSeekState()})},resetStartupSeekState:function(){this.options.ads=this.defaultAdsState?this.defaultAdsState:this.options.ads,"flash"===this.options.mode&&this.startupSeek&&this.restoreAdsStatus(),this.startupSeek=void 0},detectTearsheeting:function(){d.config.ts||(d.config.ts=!0,function(a){var b,c,d,e,f,g=window.location.search,h="",i="_ro",j=1;if(g){if(b=/[&?]tsdel=/.exec(g),!b){if(c=/[&?]tspid=([^&#]*)/.exec(g),!c)return;f=c[1],d=a?"tearsheet.fw.nytimes.com":"tearsheet.fw.stg.nytimes.com",h=encodeURIComponent(["Candidate-Ads=",f,";","Internal-Call;","Opt-Out;","Testing-Placement=true;","Commercial-Pattern=14852;;","Target-Server;","domain=",d,";","Reload-Ads=",f].join(""))}e=new Date,e.setTime(e.getTime()+24*j*60*60*1e3),document.cookie=i+"="+h+";expires="+e+";domain=.nytimes.com;path=/"}}("production"===this.options.env))}},d.api.HtmlFive=function(a,b){d.api.Player.call(this,a,b)},d.api.HtmlFive.prototype=d.util.extend(d.api.Player.prototype),d.api.HtmlFive.prototype.getType=function(){return"html5"},d.api.HtmlFive.prototype.load=function(a,b){var c=this,e=b||!1;this.hdRenditionChanging=!1,this.resetStartupSeekState(),this.getData(a,"video",function(a){c._data=a,c.plugins.reload(),c.renderSource(),c.trigger(d.api.events.LOAD_START),c.modules.poster&&(c.modules.poster.update(),c.options.nativePoster&&c.modules.poster.removeNativePoster()),c.element[0].load(),c.adPlaying()&&c.trigger(d.api.events.AD_STOPPED),c.adsController&&(c.adsController.isCompleted=!1,c.adsController.isContentPlaying=!1),e&&c.play()})},d.api.HtmlFive.prototype.render=function(){this.on(d.api.events.RENDERED,function(){this.options.muted&&this.mute(!0),this.trigger(d.api.events.LOAD_START),this.options.autoplay&&this.play()}),this.startupSeek&&this.bindStartupSeekEvents(),this.options.autoplay&&this.addLoader(),this.renderElement(),this.container.append(this.element),this.video=this.element[0],this.primeVideoElement(),this.renderElementAttr(),this.renderSource(),this.options.controls&&!this.options.nativeControls&&(this.renderControls(),this.element.find("source").on("error",c.proxy(this.modules.controls.onSourceError,this.modules.controls))),this.registerListeners(),this.rendered=!0,this.trigger(d.api.events.RENDERED)},d.api.HtmlFive.prototype.primeVideoElement=function(){var a=d.util.isIpad()||d.util.isIphone()||d.util.isAndroid();a&&this.video&&(this.video.play(),this.video.pause())},d.api.HtmlFive.prototype.renderElement=function(){if(this.options.element){var a=this.options.element;this.element=a.clone(!0),a.remove()}else this.element=c("<video />")},d.api.HtmlFive.prototype.renderElementAttr=function(){var a=this.element.attr("id"),b=this.options.cover||this.options.autoplay?"auto":this.options.preload;this.element.attr({preload:b,"x-webkit-airplay":"allow"}),this.element.css({height:"100%",width:"100%"}),"16:9"===this.options.ratio&&"100%"===this.options.height&&"100%"===this.options.width&&this.element.css({position:"absolute",top:0,left:0}),this.options.loop&&this.element.attr("loop","loop"),this.options.src&&this.element.attr("src",this.options.src),a&&""!==a||this.element.attr("id","video_"+(new Date).getTime()),this.options.nativeControls&&this.element.attr("controls","controls"),this.modules.poster&&this.options.nativePoster&&this.modules.poster.renderNativePoster()},d.api.HtmlFive.prototype.renderSource=function(){var a,b;if(this.options.src)b=this.options.src;else if(this.options.source){this.element.empty();for(var e in this.options.source)a=c("<source />"),a.attr({src:this.options.source[e],type:e}),this.element.append(a)}else this._data&&this._data.renditions&&(b=this.modules.renditions.getClosestRenditionUrl(this._data.renditions,this.element.height(),this.enableHD));b?(this.element.attr("src",b),this.modules.renditions.setActive(b)):this.options.source?this.modules.renditions.setActive(this.options.source):(this.trigger(d.api.events.RENDITION_NOT_FOUND),this.modules.renditions.resetActive()),
this.videoChanged=!0},d.api.HtmlFive.prototype.adPlaying=function(){return this.adsController&&this.adsController.isContentPlaying?!0:!1},d.api.HtmlFive.prototype.adInitializing=function(){return this.adsController&&this.adsController.isInitializing?!0:!1},d.api.HtmlFive.prototype.adCompleted=function(){return this.adsController&&this.adsController.isCompleted?!0:!1},d.api.HtmlFive.prototype.getAdTitle=function(){var a="";return this.adsController&&(a=this.adsController.getAdTitle()),a},d.api.HtmlFive.prototype.fixForAndroidHLSBug=function(){"android_jellybean"===this.device&&this.firstEnded&&(this.pause(),this.play(),this.firstEnded=!1)},d.api.HtmlFive.prototype.registerListeners=function(){var a=this,b=this.element.attr("controls");this.listenersInitialized===!1&&(this.element.on(d.api.events.LOADED_DATA,function(){a.trigger(d.api.events.VIDEO_READY)}),this.element.on("play",function(){a.logger.log("html5 play event"),a.options.ads&&!a.adPlaying()&&!a.adCompleted()&&d.util.supportsAds()?a.adsController?a.adsController.nextAd(function(a,b){this.start()}):a.adsController=new d.html.Ads(a,function(a,b){this.start()}):a.adPaused&&!a.adCompleted()?(a.adPaused=!1,a.trigger(d.api.events.AD_RESUMED)):a.adPlaying()||a.trigger(d.api.events.PLAY)}),b||this.isTouch||this.element.on("click",function(b){a.togglePlay(),b.stopPropagation()}),this.element.on("playing",function(){a.logger.log("html5 playing event"),a.modules.poster&&a.modules.poster.hide(),a.adPlaying()||a.adInitializing()||a.trigger(d.api.events.PLAYING)}),this.element.on("progress",function(b){a.adPlaying()?a.trigger(d.api.events.AD_PROGRESS,b):a.trigger(d.api.events.PROGRESS,b)}),this.element.on("timeupdate",function(b){a.adPlaying()?a.trigger(d.api.events.AD_TIME_UPDATE,a.video.currentTime):a.trigger(d.api.events.TIME_UPDATE,a.video.currentTime)}),this.element.on("seeked",function(){a.logger.log("html5 seeked event"),a.adPlaying()||a.trigger(d.api.events.SEEKED)}),this.element.on("pause",function(){a.logger.log("html5 pause event"),a.isEnded()||(a.adPlaying()||a.adInitializing()?a.adPlaying()&&!a.adSkipped&&(a.adPaused=!0,a.trigger(d.api.events.AD_PAUSED)):a.trigger(d.api.events.PAUSE))}),this.element.on("durationchange",function(){a.trigger(d.api.events.DURATION_CHANGE,a.element[0].duration||0)}),this.element.on("ended",function(){a.logger.log("html5 ended event"),a.adPlaying()||a.trigger(d.api.events.ENDED),a.options.live&&a.fixForAndroidHLSBug()}),this.element.on(d.api.events.ERROR,function(b){a.logger.log("html5 error event",b),a.trigger(d.api.events.ERROR,b)}),this.element.on(d.api.events.STALLED,function(b){a.logger.log("html5 stalled event",b),a.trigger(d.api.events.STALLED,b)}),this.element.on(d.api.events.WAITING,function(){a.logger.log("html5 waiting event"),a.trigger(d.api.events.WAITING)}),this.initializeSpacebarToggle(),this.listenersInitialized=!0)},d.api.HtmlFive.prototype.initializeSpacebarToggle=function(){var a=this;this.options.spacebarToggleEnabled&&(this.container.attr("tabindex","-1"),this.container.off("keydown.vhs"),this.container.on("keydown.vhs",function(b){b&&32===b.keyCode&&(b.preventDefault(),a.togglePlay())}))},d.api.HtmlFive.prototype.reloadVideo=function(){this.video&&(this.video.load(),this.video.play(),this.trigger(d.api.events.LOAD_START))},d.api.HtmlFive.prototype.toggleVolume=function(){this.mute(!this.isMuted())},d.api.HtmlFive.prototype.duration=function(){return this.video?this.video.duration:0},d.api.HtmlFive.prototype.play=function(){var a=this;this.firstPlay&&!this.options.autoplay&&this.addLoader(),this.rendered?this.video.play():"desktop"===d.util.getDeviceType()?(this.on(d.api.events.LOAD_START,function b(){a.video.play(),a.off(d.api.events.LOAD_START,b)}),this.render()):(this.render(),this.video.play())},d.api.HtmlFive.prototype.pause=function(){this.video&&this.video.pause()},d.api.HtmlFive.prototype.isPaused=function(){return this.video?this.video.paused:!0},d.api.HtmlFive.prototype.isEnded=function(){return this.video?this.video.ended:!1},d.api.HtmlFive.prototype.mute=function(a){this.video&&(this.video.muted=!!a,this.trigger(d.api.events.MUTE,this.video.muted))},d.api.HtmlFive.prototype.isMuted=function(){return this.video?this.video.muted:void 0},d.api.HtmlFive.prototype.getCurrentTime=function(){return this.video?this.video.currentTime:0},d.api.HtmlFive.prototype.getCurrentSource=function(){return this.video?this.video.src||this.video.currentSrc:""},d.api.HtmlFive.prototype.seek=function(a){var b=this.element[0];if("number"!=typeof a)throw new Error("time argument should be a Number");if(0>a||a>b.duration)throw new Error("time should be greater than 0 and lower than the duration of the video");b.currentTime=a},d.api.HtmlFive.prototype.skipAd=function(){this.adSkipped=!0,this.adsController.stop()},d.api.HtmlFive.prototype.adDuration=function(){var a=0;return this.adsController&&(a=this.adsController.currentSlot?this.adsController.currentSlot.getTotalDuration():this.adsController.getAdInstanceDuration()),a},d.api.HtmlFive.prototype.toggleHD=function(){var a=this,b=this.element.get(0),c=b.currentTime;this.hdRenditionChanging=!0,this.enableHD=!this.enableHD,b.pause(),this.renderSource(),this.triggerHDEvent(),this.element.one("canplaythrough",function(){b.currentTime=c,b.play()}),this.element.one("seeked",function(){a.hdRenditionChanging=!1}),b.load()},d.html.Ads=function(a,b){var c=this,d=!0;switch(this.player=a,this.callback=b,this.adsLoaded=!1,this.serverURL="http://fw.nytimes.com/ad/g/1",this.siteSectionId=this.player.options.siteSection||this.player.options.freewheel||this.player.getSiteSection(),this.isCompleted=!1,this.isContentPlaying=!1,this.currentSlot=null,this.isInitializing=!0,this.adStarted=!1,this.player.options.env){case"development":case"staging":this.networkId=379535,this.profileId="379535:ny_times_js_test",this.adManagerUrl="http://adm.fwmrm.net/p/nytimes_test/AdManager.js",this.serverURL="http://fw.stg.nytimes.com/ad/g/1",d=!1;break;default:this.networkId=379536,this.profileId="379536:ny_times_js_live",this.adManagerUrl="http://adm.fwmrm.net/p/nytimes_live/AdManager.js"}this.player.element[0].pause(),this.loadAdManager(function(){c.adManager=new tv.freewheel.SDK.AdManager,c.adManager.setNetwork(c.networkId),c.adManager.setServer(c.serverURL),c.setupAdContext()})},d.html.Ads.prototype.nextAd=function(a){this.callback=a,this.isCompleted=!1,this.setupAdContext()},d.html.Ads.prototype.loadAdManager=function(a){var b=this,c=function(a,b,c){this.player.options.ads=!1,this.adStarted=!1,this.isCompleted=!0,this.isContentPlaying=!1,this.isInitializing=!1,this.player.adSkipped=!1,this.player.element[0].play(),this.player.trigger(d.api.events.TRACKING_EVENT,{data:{name:d.api.events.FW_ADMANAGER_LOAD_ERROR,errorStatus:b||"",errorThrown:c||""}})};d.util.getScript({url:b.adManagerUrl,success:function(){a.call(b)},error:function(a,d,e){c.call(b,a,d,e)},cache:!0,dataType:"script",timeout:5e3})},d.html.Ads.prototype.setupAdContext=function(){var a=(this.player.element,this.player.element.attr("id"),this.player.container.attr("id")),b=this.player.getDuration(),c=this.player.instance;this.player._data&&this.player._data.id?c=this.player._data.id:this.player.options&&this.player.options.id&&(c=this.player.options.id),this.theContext&&"function"==typeof this.theContext.dispose&&(this.unregisterContextListeners(),this.theContext.dispose()),this.theContext=this.adManager.newContext(),this.theContext.registerVideoDisplayBase(a),this.theContext.setProfile(this.profileId),this.theContext.setVideoAsset(c,b,this.networkId),this.theContext.setSiteSection(this.siteSectionId,this.networkId),this.registerContextListeners(),this.theContext.setParameter(tv.freewheel.SDK.PARAMETER_RENDERER_VIDEO_START_DETECT_TIMEOUT,1e4,tv.freewheel.SDK.PARAMETER_LEVEL_GLOBAL),this.theContext.setParameter(tv.freewheel.SDK.PARAMETER_RENDERER_VIDEO_PROGRESS_DETECT_TIMEOUT,1e4,tv.freewheel.SDK.PARAMETER_LEVEL_GLOBAL),this.theContext.setParameter(tv.freewheel.SDK.PARAMETER_RENDERER_VIDEO_DISPLAY_CONTROLS_WHEN_PAUSE,!1,tv.freewheel.SDK.PARAMETER_LEVEL_GLOBAL),this.theContext.addTemporalSlot("Preroll_1",tv.freewheel.SDK.ADUNIT_PREROLL,0),this.theContext.submitRequest(2)},d.html.Ads.prototype.registerContextListeners=function(){this.theContext&&tv&&tv.freewheel&&"function"==typeof this.theContext.addEventListener&&(this.theContext.addEventListener(tv.freewheel.SDK.EVENT_REQUEST_COMPLETE,c.proxy(this.onRequestComplete,this)),this.theContext.addEventListener(tv.freewheel.SDK.EVENT_SLOT_ENDED,c.proxy(this.onSlotEnded,this)),this.theContext.addEventListener(tv.freewheel.SDK.EVENT_SLOT_STARTED,c.proxy(this.onSlotStarted,this)),this.theContext.addEventListener(tv.freewheel.SDK.EVENT_AD,c.proxy(this.onEventAd,this)))},d.html.Ads.prototype.unregisterContextListeners=function(){this.theContext&&tv&&tv.freewheel&&"function"==typeof this.theContext.removeEventListener&&(this.theContext.removeEventListener(tv.freewheel.SDK.EVENT_REQUEST_COMPLETE),this.theContext.removeEventListener(tv.freewheel.SDK.EVENT_SLOT_ENDED),this.theContext.removeEventListener(tv.freewheel.SDK.EVENT_SLOT_STARTED),this.theContext.removeEventListener(tv.freewheel.SDK.EVENT_AD,c.proxy(this.onEventAd,this)))},d.html.Ads.prototype.onRequestComplete=function(a){if(this.adsLoaded=!0,this.prerollSlots=[],this.midrollSlots=[],this.overlaySlots=[],this.postrollSlots=[],a.success)for(var b=this.theContext.getTemporalSlots(),c=0,d=b.length;d>c;c++){var e=b[c];switch(e.getTimePositionClass()){case tv.freewheel.SDK.TIME_POSITION_CLASS_PREROLL:this.prerollSlots.push(e);break;case tv.freewheel.SDK.TIME_POSITION_CLASS_MIDROLL:this.midrollSlots.push(e);break;case tv.freewheel.SDK.TIME_POSITION_CLASS_OVERLAY:this.overlaySlots.push(e);break;case tv.freewheel.SDK.TIME_POSITION_CLASS_POSTROLL:this.postrollSlots.push(e)}}this.prerollSlots&&this.prerollSlots.length?this.callback(null,this.prerollSlots):this.callback(new Error("No prerolls available"))},d.html.Ads.prototype.getState=function(){return this.isCompleted},d.html.Ads.prototype.onEventAd=function(a){if(a&&a.subType)switch(a.subType){case tv.freewheel.SDK.EVENT_AD_FIRST_QUARTILE:this.player.trigger(d.api.events.AD_FIRST_QUARTILE);break;case tv.freewheel.SDK.EVENT_AD_MIDPOINT:this.player.trigger(d.api.events.AD_MIDPOINT);break;case tv.freewheel.SDK.EVENT_AD_THIRD_QUARTILE:this.player.trigger(d.api.events.AD_THIRD_QUARTILE);break;case tv.freewheel.SDK.EVENT_ERROR:this.player.trigger(d.api.events.AD_ERROR,a);break;case tv.freewheel.SDK.EVENT_AD_CLICK:case tv.freewheel.SDK.EVENT_AD_IMPRESSION:case tv.freewheel.SDK.EVENT_AD_IMPRESSION_END:case tv.freewheel.SDK.EVENT_AD_COMPLETE:case tv.freewheel.SDK.EVENT_AD_MUTE:case tv.freewheel.SDK.EVENT_AD_UNMUTE:case tv.freewheel.SDK.EVENT_AD_PAUSE:case tv.freewheel.SDK.EVENT_AD_RESUME:case tv.freewheel.SDK.EVENT_AD_REWIND:case tv.freewheel.SDK.EVENT_AD_EXPAND:case tv.freewheel.SDK.EVENT_AD_COLLAPSE:case tv.freewheel.SDK.EVENT_AD_MINIMIZE:case tv.freewheel.SDK.EVENT_AD_ACCEPT_INVITATION:case tv.freewheel.SDK.EVENT_AD_CLOSE:case tv.freewheel.SDK.EVENT_RESELLER_NO_AD:}},d.html.Ads.prototype.onSlotStarted=function(a){var b=a.slot.getTimePositionClass(),c=a.slot.getTotalDuration();if(c>0)switch(b){case tv.freewheel.SDK.TIME_POSITION_CLASS_PREROLL:this.isCompleted=!1,this.isContentPlaying=!0,this.adStarted=!0,this.setCurrentlyPlayingSlot(this.prerollSlots[0]),this.player.trigger(d.api.events.AD_STARTED)}},d.html.Ads.prototype.onSlotEnded=function(a){var b=a.slot.getTimePositionClass(),c=a.slot.getTotalDuration();switch(b){case tv.freewheel.SDK.TIME_POSITION_CLASS_PREROLL:this.prerollSlots.length&&(this.prerollSlots.shift(),this.prerollSlots.length?(this.prerollSlots[0].play(),this.setCurrentlyPlayingSlot(this.prerollSlots[0])):this.resumeContent(c));break;case tv.freewheel.SDK.TIME_POSITION_CLASS_POSTROLL:case tv.freewheel.SDK.TIME_POSITION_CLASS_MIDROLL:case tv.freewheel.SDK.TIME_POSITION_CLASS_OVERLAY:case tv.freewheel.SDK.TIME_POSITION_CLASS_DISPLAY:}},d.html.Ads.prototype.setPlayerSource=function(){var a=this.player.modules.renditions.getActive(),b=this.player.element.find("source").length>0;b?this.player.element.removeAttr("src"):this.player.element.attr("src",a)},d.html.Ads.prototype.resumeContent=function(a){var b=this;!this.player.adSkipped&&(a&&a>0||this.adStarted)&&this.player.trigger(d.api.events.AD_COMPLETED),this.adStarted=!1,this.isCompleted=!0,this.isContentPlaying=!1,this.setPlayerSource(),this.player.element[0].load(),this.player.element[0].play(),this.setCurrentlyPlayingSlot(null),this.theContext&&this.theContext.setVideoState(tv.freewheel.SDK.VIDEO_STATE_PLAYING),this.player.on(d.api.events.ENDED,function(){b.theContext&&b.theContext.setVideoState(tv.freewheel.SDK.VIDEO_STATE_COMPLETED)}),this.player.adSkipped=!1},d.html.Ads.prototype.setCurrentlyPlayingSlot=function(a){this.currentSlot=a},d.html.Ads.prototype.getCurrentlyPlayingSlot=function(){return this.currentSlot},d.html.Ads.prototype.getAdTitle=function(){var a,b=this.getCurrentlyPlayingSlot(),c=[],d="";return b&&(c=b.getAdInstances(),c.length>0&&(a=c[0],a&&(d=a.getAdId()))),d},d.html.Ads.prototype.getAdInstanceDuration=function(){var a,b=this.getCurrentlyPlayingSlot(),c=[],d=0;return b&&(c=b.getAdInstances(),c.length>0&&(a=c[0],a&&(d=a.getDuration()))),d},d.html.Ads.prototype.start=function(){this.isInitializing=!1,this.player.options.ads&&(this.prerollSlots&&this.prerollSlots.length?(this.isCompleted=!1,this.isContentPlaying=!0,this.setCurrentlyPlayingSlot(this.prerollSlots[0]),this.prerollSlots[0].play()):this.resumeContent())},d.html.Ads.prototype.stop=function(){this.currentSlot&&this.currentSlot.stop()},d.html.Ads.prototype.pause=function(){this.player.element[0].pause()},d.html.Ads.prototype.resume=function(){this.player.element[0].play()},d.api.Flash=function(a,b){d.api.Player.call(this,a,b)},d.api.Flash.prototype=d.util.extend(d.api.Player.prototype),d.api.Flash.prototype.getType=function(){return"flash"},d.api.Flash.prototype.load=function(a,b){var c=this,e=b||!1;this.hdRenditionChanging=!1,this.resetStartupSeekState(),this.adPlaying()&&this.stopAd(),this.getData(a,"video",function(a){c._data=a,c.plugins.reload(),c.renderSource(),c.trigger(d.api.events.LOAD_START),c.modules.poster&&c.modules.poster.update(),e&&c.play()})},d.api.Flash.prototype.restoreAdsStatus=function(){this.video&&this.video.setAdsStatus({status:this.options.ads,fwAdManager:this.fwAdManager,fwServer:this.fwServer,fwNetworkId:this.fwNetworkId,fwProfile:this.fwProfile,fwSiteSection:this.options.siteSection||this.options.freewheel||this.getSiteSection()})},d.api.Flash.prototype.render=function(){this.rendering||this.rendered||(this.rendering=!0,this.element&&this.element.remove(),this.options.autoplay&&this.addLoader(),this.renderElement(),this.options.controls&&!this.options.nativeControls&&this.renderControls(),this.registerListeners())},d.api.Flash.prototype.renderElement=function(){this.objectId="video_"+(new Date).getTime();var a,b=this.getFlashVars(),c=this;this.startupSeek&&this.bindStartupSeekEvents(),this.options.autoplay&&this.on(d.api.events.RENDERED,function e(){c.logger.log("RENDERED RECEIVED. HAPPENS WHEN FLASH RETURNS VIDEO_READY"),c.play(),c.off(d.api.events.RENDERED,e)}),a=this.options.debug&&this.options.debugPathSWF?this.options.debugPathSWF:this.staticBaseUrl+"video/vhs/"+d._version+"-"+d._release+"/vhs.swf",this.embedSwf(a,this.objectId,b)},d.api.Flash.prototype.getFlashVars=function(){var a={instance:this.instance};return a.live=this.options.live,a.ads=this.options.ads,a.id=this.options.id||"",a.autoplay=this.options.autoplay,a.env=this.options.env,a.type=this.getPlayerType(),a.version=d._version,a.hdSwitchSeek=this.options.flashHdSwitchSeek,a.spacebarToggleEnabled=this.options.spacebarToggleEnabled,a.loop=this.options.loop,a.muted=this.options.muted?!0:!1,a.ads&&(a.mediaLocation=this.options.live?this.options.src:null,a.fwAdManager=this.fwAdManager,a.fwServer=this.fwServer,a.fwNetworkId=this.fwNetworkId,a.fwProfile=this.fwProfile,a.fwSiteSection=this.options.siteSection||this.options.freewheel||this.getSiteSection()),a.qos=this.options.qos,this.modules.qos&&(a.QOS_CONFIG_PATH=this.modules.qos.CONFIG_PATH,a.QOS_SWF_PATH=this.modules.qos.SWF_PATH),d.util.serialize(a)},d.api.Flash.prototype.embedSwf=function(a,b,e){var f=c(d.templates.flash({objectId:b,swfPath:a,flashVars:e}));this.container.append(f)},d.api.Flash.prototype.externalInterface=function(){this.logger.log("ExternalInterface initialized"),this.element=this.container.find("object"),this.video=this.element[0];var a=this,b=function(){a.rendered||(a.rendered=!0,a.trigger(d.api.events.RENDERED)),a.off(d.api.events.VIDEO_READY,b)};this.on(d.api.events.VIDEO_READY,b),this.renderSource(),this.modules.renditions.getActive()||b()},d.api.Flash.prototype.renderSource=function(){var a,b,c,e=this.options,f=e.id,g=e.name,h=e.category,i=this.hdUserInteraction?"true":"false";if(e.src)a=this.options.src;else if(e.source)for(var j in e.source)"video/mp4"===j&&(a=e.source[j]);else{if(!this._data||!this._data.renditions)throw new Error("at least one rendition should be provided.");f=this._data.id,g=this._data.headline,c=this.modules.renditions.getClosestRenditionObject(this._data.renditions,this.element.height(),this.enableHD,this.getType()),c&&c.url&&(a=c.url,b=c.bitrate),this._data.section&&(h=this._data.section.content)}a?(this.modules.renditions.setActive(a),this.video.loadPlayerData({id:f,name:g,url:a,type:"video/mp4",duration:this.getDuration(),hdInteraction:i,bitrate:b,category:h})):(this.trigger(d.api.events.RENDITION_NOT_FOUND),this.modules.renditions.resetActive())},d.api.Flash.prototype.registerListeners=function(){this.on(d.api.events.BUFFERING,function(){this.addLoader()}),this.on(d.api.events.BUFFER_FULL,function(){this.removeLoader()})},d.api.Flash.prototype.duration=function(){return this.video?this.video.duration():0},d.api.Flash.prototype.skipAd=function(){this.video&&this.video.skipAd()},d.api.Flash.prototype.stopAd=function(){this.video&&(this.video.stopAd(),this.trigger(d.api.events.AD_STOPPED))},d.api.Flash.prototype.playAd=function(){this.video&&this.video.playAd()},d.api.Flash.prototype.pauseAd=function(){this.video&&this.video.pauseAd()},d.api.Flash.prototype.stop=function(){this.video&&this.video.stopVideo()},d.api.Flash.prototype.reloadLiveVideo=function(){var a=this;this.on(d.api.events.VIDEO_READY,function b(){a.logger.log("Reload LIVE Video VIDEO_READY (flash)"),a.video.playVideo(),a.off(d.api.events.VIDEO_READY,b)}),this.renderSource(),this.modules&&this.modules.controls&&this.modules.controls.configureLive()},d.api.Flash.prototype.play=function(){var a=this;this.firstPlay&&!this.options.autoplay&&this.addLoader();var b=function(){a.modules.renditions.getActive()&&a.video&&(a.firstPlay&&a.trigger(d.api.events.LOAD_START),a.adPlaying()?a.playAd():a.options.live&&a.isEnded()?a.reloadLiveVideo():a.video.playVideo&&a.video.playVideo())};if(this.rendered)b();else if(this.rendering){if(this.options.autoplay||this.queuedPlayOnRendered)return;this.queuedPlayOnRendered=!0,this.on(d.api.events.RENDERED,function c(){b(),a.off(d.api.events.RENDERED,c),a.queuedPlayOnRendered=!1})}else this.on(d.api.events.RENDERED,function e(){b(),a.off(d.api.events.RENDERED,e)}),this.render()},d.api.Flash.prototype.pause=function(){this.rendered&&(this.adPlaying()?this.pauseAd():this.isContentPlaying()&&this.video.pauseVideo())},d.api.Flash.prototype.isPaused=function(){return this.video?this.video.isPaused():!0},d.api.Flash.prototype.isEnded=function(){return this.video?this.video.isEnded():!1},d.api.Flash.prototype.isContentPlaying=function(){return this.video?this.video.isContentPlaying():void 0},d.api.Flash.prototype.adPlaying=function(){return this.video?this.video.adPlaying():void 0},d.api.Flash.prototype.adCompleted=function(){return this.video?this.video.adComplete():void 0},d.api.Flash.prototype.adDuration=function(){return this.video?this.video.adDuration():0},d.api.Flash.prototype.adCurrentTime=function(){return this.video?this.video.adCurrentTime():void 0},d.api.Flash.prototype.seek=function(a){if("number"!=typeof a)throw new Error("time argument should be a Number");if(0>a||a>this.video.duration())throw new Error("time should be greater than 0 and lower than the duration of the video");this.video.seek({seconds:a})},d.api.Flash.prototype.reloadVideo=function(){var a=this;this.on(d.api.events.VIDEO_READY,function b(){a.logger.log("Reload Video VIDEO_READY (flash)"),a.play(),a.off(d.api.events.VIDEO_READY,b)}),this.renderSource(),this.trigger(d.api.events.LOAD_START)},d.api.Flash.prototype.mute=function(a){this.video&&(a?this.video.mute():this.video.unmute())},d.api.Flash.prototype.unmute=function(){this.video&&this.video.unmute()},d.api.Flash.prototype.toggleVolume=function(){this.video&&this.mute(!this.video.isMuted())},d.api.Flash.prototype.isMuted=function(){return this.video?this.video.isMuted():void 0},d.api.Flash.prototype.onElementClick=function(){this.togglePlay()},d.api.Flash.prototype.getCurrentTime=function(){return this.video?this.video.currentTime():0},d.api.Flash.prototype.getCurrentSource=function(){return this.video?this.video.getCurrentSource():""},d.api.Flash.prototype.toggleHD=function(a){var b=this.video.currentTime(),c=this;this.on(d.api.events.VIDEO_READY,function e(){c.logger.log("Flash HD Rendition Switch VIDEO_READY"),c.play(),c.off(d.api.events.VIDEO_READY,e),c.seek(b),c.hdRenditionChanging=!1}),this.hdRenditionChanging=!0,this.enableHD=!this.enableHD,this.hdUserInteraction=null!==a.type.match(/(click|touch)/gi),this.pause(),this.renderSource(),this.hdUserInteraction=!1,this.triggerHDEvent()},window.vhs_instances=window.vhs_instances||{},d.styleLoaded=!1,d.findInstance=function(a){if(a){var b="string"==typeof a?a:a.attr("id");for(var c in window.vhs_instances)if(window.vhs_instances.hasOwnProperty(c)&&window.vhs_instances[c].container.attr("id")===b)return window.vhs_instances[c]}},d.player=function(a){var b,c,e="player_"+Math.round(Math.random()*(new Date).getTime());this.options=a;var f=new d.api.Logger({options:{debug:!0}});return(c=d.findInstance(a.container))?(f.error("VHS ERROR: Container is already in use. Please destroy before creating a new VHS instance using this container: ",a.container),c):(this.options.mode=d.util.getPlayerMode(this.options.mode,this.options.type,this.options.container),this.options.ads=this.options.source&&d.util.isIE9()&&"flash"!==this.options.mode?!1:this.options.ads,b="html5"===this.options.mode?new d.api.HtmlFive(this.options,e):new d.api.Flash(this.options,e),window.vhs_instances[e]=b,b)},d.auto=function(){var a,b,e,f,g=c("figure[data-nytd]");if(g.length>0)for(a=0,b=g.length;b>a;a++)f=g.eq(a),e=f.data("setup")||{},e.id=e.nytd||f.data("nytd"),e.container=f,e.usage="figure_tag",d.player(e)},d.shortcuts=function(){c&&c(function(){d.auto()})},d._version="2.44.0",d._release="435",d._build="desktop",d.shortcuts(),d});