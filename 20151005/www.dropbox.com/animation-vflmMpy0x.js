// Generated by CoffeeScript 1.10.0
define(['jquery'], function($j) {
  var Animation;
  return Animation = (function() {
    var determineEndPosition;

    function Animation(arg) {
      this.id = arg.id, this.animationQueue = arg.animationQueue;
      this.$el = $j("#" + this.id);
      this.$strip = this.$el.find('.animator-strip');
      this.imageLoadCount = 0;
      this.animationQueue = (function() {
        return $j.grep(arguments[0], function(n) {
          return n !== "" && n !== null;
        });
      })(this.animationQueue);
      this.imagesInit();
      this.$strip.on('webkitAnimationEnd mozAnimationEnd MSAnimationEnd OAnimationEnd animationend', this.onAnimationEnd);
    }

    Animation.prototype.onAnimationEnd = function(event) {
      determineEndPosition();
      $j(this).removeClass('intro-animation').addClass('loop-animation');
      return true;
    };

    determineEndPosition = function() {
      var animatorPosterWidth, animatorStripWidth, translateDistance;
      animatorPosterWidth = $j('.animator-poster').width();
      animatorStripWidth = $j('.animator-frame--intro').width();
      translateDistance = animatorStripWidth - animatorPosterWidth;
      return $j('.animator-frame--intro').css('transform', 'translateX(-' + translateDistance + 'px)');
    };

    Animation.prototype.setAnimationLoadClass = function() {
      var loadedClass;
      this.imageLoadCount++;
      loadedClass = 'loop-animation';
      if (this.animationQueue.length === 2) {
        loadedClass = 'intro-animation';
      }
      if (this.imageLoadCount === this.animationQueue.length) {
        return this.$strip.addClass('loaded ' + loadedClass);
      }
    };

    Animation.prototype.imagesInit = function() {
      var strip, that;
      that = this;
      strip = this.$strip;
      return $j(document).ready(function() {
        return strip.find('img').each(function(index, element) {
          if ($j(element).data('src')) {
            $j(element).on('load', function() {
              return that.setAnimationLoadClass();
            });
            $j(element).attr('src', $j(element).data('src'));
            if ($j(element).prop('complete')) {
              return that.setAnimationLoadClass();
            }
          }
        });
      });
    };

    return Animation;

  })();
});

//# sourceMappingURL=animation.js.map
