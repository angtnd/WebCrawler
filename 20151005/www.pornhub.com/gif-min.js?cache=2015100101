(function(b){b([],function(A){function z(c){if(!Cookies){throw new Error("Could not load the required cookie library.")}Cookies.json=true;this._key=c;this.update=function(d){Cookies.set(this._key,d)};this.clear=function(){Cookies.remove(this._key)};this.get=function(){return Cookies.get(this._key)}}function v(c){this._key=c;this.update=function(d){sessionStorage.setItem(this._key,JSON.stringify(d))};this.clear=function(){sessionStorage.removeItem(this._key)};this.get=function(){var e={};try{e=JSON.parse(sessionStorage.getItem(this._key))}catch(d){this.clear()}return e}}Function.prototype.bind=Function.prototype.bind||function(h){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var g=Array.prototype.slice,f=g.call(arguments,1),e=this,c=function(){},d=function(){return e.apply(this instanceof c?this:h||window,f.concat(g.call(arguments)))};c.prototype=this.prototype;d.prototype=new c();return d};Array.prototype.indexOf=function(d){var e=this.length>>>0;var c=Number(arguments[1])||0;c=(c<0)?Math.ceil(c):Math.floor(c);if(c<0){c+=e}for(;c<e;c++){if(c in this&&this[c]===d){return c}}return -1};function r(f){var e=typeof(f);var c="";var d=false;switch(e){case"string":c="s";break;case"number":c="n";break;case"boolean":c="b";break;default:d=true;break}return{prefix:c,err:d}}function B(f,c,d){var e=c.split("."),g=f,h,i;h=e.length;for(i=0;i<h;i++){if(typeof g[e[i]]=="undefined"){if(i==(h-1)){if(d){g[e[i]]=d}else{g[e[i]]={}}}else{g[e[i]]={}}}g=g[e[i]]}return g}var a={rbracket:/\[\]$/,r20:/%20/g,class2type:{},hasOwn:Object.prototype.hasOwnProperty,noop:function(){},type:function(c){if(c==null){return c+""}var d=({}).toString;var e=typeof c==="object"||typeof c==="function"?a.class2type[d.call(c)]||"object":typeof c;return e},isFunction:function(c){return a.type(c)==="function"},isPlainObject:function(c){if(a.type(c)!=="object"||c.nodeType||a.isWindow(c)){return false}if(c.constructor&&!a.hasOwn.call(c.constructor.prototype,"isPrototypeOf")){return false}return true},isWindow:function(c){return c!=null&&c===c.window},isArray:Array.isArray||function(c){return a.type(c)==="array"},forEach:function(c,d,e){return q(c,function(f,h,g){d(h,f,g)},e)}.bind(a),buildParams:function(e,c,f,d){var g;f=false;if(a.isArray(c)){a.forEach(c,function(h,i){if(f||a.rbracket.test(e)){d(e,i)}else{a.buildParams(e+"["+(typeof i==="object"?h:"")+"]",i,f,d)}})}else{if(!f&&a.type(c)==="object"){for(g in c){a.buildParams(e+"["+g+"]",c[g],f,d)}}else{d(e,c)}}},extend:function(){var f,c,e,d,i,h,j=arguments[0]||{},k=1,l=arguments.length,g=false;if(typeof j==="boolean"){g=j;j=arguments[k]||{};k++}if(typeof j!=="object"&&!a.isFunction(j)){j={}}if(k===l){j=this;k--}for(;k<l;k++){if((f=arguments[k])!=null){for(c in f){e=j[c];d=f[c];if(j===d){continue}if(g&&d&&(a.isPlainObject(d)||(i=a.isArray(d)))){if(i){i=false;h=e&&a.isArray(e)?e:[]}else{h=e&&a.isPlainObject(e)?e:{}}j[c]=a.extend(g,h,d)}else{if(d!==A){j[c]=d}}}}}return j}.bind(a),param:function(g){var d,e=false,f=[],c=function(i,h){h=a.isFunction(h)?h():(h==null?"":h);f[f.length]=encodeURIComponent(i)+"="+encodeURIComponent(h)};if(a.isArray(g)||(g.jFn&&!a.isPlainObject(g))){a.forEach(g,function(){c(this.name,this.value)})}else{for(d in g){a.buildParams(d,g[d],e,c)}}return f.join("&").replace(a.r20,"+")}.bind(a),exportPublic:function(){var c={};var d=this;a.forEach(["param","noop","extend"],function(e,f){c[f]=d[f]});return c},init:function(){var c="Boolean Number String Function Array Date RegExp Object Error".split(" "),d=c.length;while(d--){var e=c[d];a.class2type["[object "+e+"]"]=e.toLowerCase()}return this}};a.init();var u=Array.prototype;var y={nativeKeys:Object.keys,nativeMap:u.map,nativeReduce:u.reduce,has:function(c,d){return c!=null&&Object.prototype.hasOwnProperty.call(c,d)},isObject:function(c){var d=typeof c;return d==="function"||d==="object"&&!!c},keys:function(c){if(!y.isObject(c)){return[]}if(this.nativeKeys){return this.nativeKeys(c)}var d=[];for(var e in c){if(y.has(c,e)){d.push(e)}}return d}.bind(y),foldl:function(c,d,g,e){var f=arguments.length>2;if(c===null){c=[]}if(this.nativeReduce&&c.reduce===this.nativeReduce){if(e){d=_.bind(d,e)}return f?c.reduce(d,g):c.reduce(d)}q(c,function(h,j,i){if(!f){g=h;f=true}else{g=d.call(e,g,h,j,i)}});if(!f){throw new TypeError(reduceError)}return g},map:function(c,d,e){var f=[];if(c===null){return f}if(this.nativeMap&&c.map===this.nativeMap){return c.map(d,e)}q(c,function(g,i,h){f.push(d.call(e,g,i,h))});return f}};function q(c,f,g){if(c==null){return c}if(u.forEach&&c.forEach===u.forEach){c.forEach(f,g)}else{if(c.length===+c.length){for(var h=0,d=c.length;h<d;h++){if(f.call(g,c[h],h,c)==={}){return}}}else{var e=y.keys(c);for(var h=0,d=e.length;h<d;h++){if(f.call(g,c[e[h]],e[h],c)==={}){return}}}}return c}y.each=y.forEach=q;var t={format:function(){var c=arguments[0],d=arguments.length;while(d-->0){c=c.replace(new RegExp("\\{"+(d-1)+"\\}","gm"),arguments[d])}return c}};function w(c,e,d){return function(){var h=arguments;function g(i,j){setTimeout(function(){var k=c.apply(e,h);if(k){k.then(i)["catch"](j)}},10)}var f=d?new d.Promise(g):(g(y.noop,y.noop)|null);return f}}function x(d){var c=d;if(!(/^(http:\/\/|https:\/\/)/.test(c))){c=s()+c}else{c=c.replace(/^(http:\/\/|https:\/\/)/,s())}return c}function s(){return("https:"==document.location.protocol?"https://":"http://")}var p={extendNamespace:B,str:t,keys:y.keys,foldl:y.foldl,each:y.each,map:y.map,getDeferredFunc:w,determineTypePrefix:r,httpScheme:s,ensureProperUrlScheme:x,sessionStorageClass:v,cookieStorageClass:z};a.extend(p,a.exportPublic());return p})}(typeof define==="function"&&define.amd?define:function(g,e){var h="BES.ProTrack.Vortex.Modules.Utils";var f=e();f.extendNamespace(window,h,f)}));(function(b){b(["./utils"],function(k,i){var l={},n=k;function m(d){if(n.keys(l).indexOf(d)==-1){l[d]=[]}var c=l[d];return{writeLine:function(e){c.push(e)},getLines:function(){return[].concat(c)}}}function a(){return n.keys(l)}function j(d){var c=l[d];return c?[].concat(c):[]}return{getLog:m,getExistingLogs:a,getLogLines:j}})}(typeof define==="function"&&define.amd?define:function(h,f){var g=BES.ProTrack.Vortex.Modules.Utils;var i=f(g);var j="BES.ProTrack.Vortex.Modules.Log";g.extendNamespace(window,j,i)}));(function(b){b(["./utils","./log.js"],function(af,J,X){var ah="AgentInfo",Q=af,V=J?J.getLog("pl_agentinfo.js"):{writeLine:Q.noop};var H="",O,aa,ad,U,ae,N,I;try{var M="-";if(screen.width){width=(screen.width)?screen.width:"";height=(screen.height)?screen.height:"";H+=""+width+" x "+height}var S=navigator.appVersion;var P=navigator.userAgent;O=navigator.appName;aa=""+parseFloat(navigator.appVersion);var R=parseInt(navigator.appVersion,10);var e,ag,ac;if((ag=P.indexOf("Opera"))!=-1){O="Opera";aa=P.substring(ag+6);if((ag=P.indexOf("Version"))!=-1){aa=P.substring(ag+8)}}else{if((ag=P.indexOf("OPR"))!=-1){O="Opera";aa=P.substring(ag+4);if((ag=P.indexOf("Version"))!=-1){aa=P.substring(ag+8)}}else{if((ag=P.indexOf("MSIE"))!=-1){O="Microsoft Internet Explorer";aa=P.substring(ag+5)}else{if((ag=P.indexOf("Chrome"))!=-1){O="Chrome";aa=P.substring(ag+7)}else{if((ag=P.indexOf("Safari"))!=-1){O="Safari";aa=P.substring(ag+7);if((ag=P.indexOf("Version"))!=-1){aa=P.substring(ag+8)}}else{if((ag=P.indexOf("Firefox"))!=-1){O="Firefox";aa=P.substring(ag+8)}else{if(P.indexOf("Trident/")!=-1){O="Microsoft Internet Explorer";aa=P.substring(P.indexOf("rv:")+3)}else{if((e=P.lastIndexOf(" ")+1)<(ag=P.lastIndexOf("/"))){O=P.substring(e,ag);aa=P.substring(ag+1);if(O.toLowerCase()==O.toUpperCase()){O=navigator.appName}}}}}}}}}if((ac=aa.indexOf(";"))!=-1){aa=aa.substring(0,ac)}if((ac=aa.indexOf(" "))!=-1){aa=aa.substring(0,ac)}if((ac=aa.indexOf(")"))!=-1){aa=aa.substring(0,ac)}R=parseInt(""+aa,10);if(isNaN(R)){aa=""+parseFloat(navigator.appVersion);R=parseInt(navigator.appVersion,10)}ad=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(S);N=(navigator.cookieEnabled)?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!N){document.cookie="testcookie";N=(document.cookie.indexOf("testcookie")!=-1)?true:false}U=M;var u=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows Phone",r:/(Windows Phone)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var L in u){var Y=u[L];if(Y.r.test(P)){U=Y.s;break}}ae=M;if(/Windows Phone/.test(U)){ae=/Windows Phone (.*?);/.exec(P)[1]}else{if(/Windows/.test(U)){ae=/Windows (.*)/.exec(U)[1]}}switch(U){case"Mac OS X":ae=/Mac OS X (10[\.\_\d]+)/.exec(P)[1];break;case"Android":var Z=/Android ([\.\_\d]+)/.exec(P);if(Z){ae=Z[1]}else{var W=/Firefox\//.exec(P);if(W){ae=M+"(Firefox does not report)"}}break;case"iOS":ae=/OS (\d+)_(\d+)_?(\d+)?/.exec(S);ae=ae[1]+"."+ae[2]+"."+(ae[3]|0);break}I="no check";if(typeof swfobject!="undefined"){var ab=swfobject.getFlashPlayerVersion();if(ab.major>0){I=ab.major+"."+ab.minor+" r"+ab.release}else{I=M}}}catch(T){V.writeLine("Error running agent detection: "+T.toString())}var K={screen:H,browser:O,browserVersion:aa,mobile:ad,os:U,osVersion:ae,cookies:N,flashVersion:I,languages:navigator.languages?navigator.languages.join(","):(navigator.language||navigator.userLanguage),plugins:Q.map(navigator.plugins,function(c){return c.name}).join(",")};function a(c){return{process:function(f,d){Q.each(K,function(g,h){var i=Q.determineTypePrefix(g);if(!i.err){d["_"+i.prefix+h]=g}else{errs[100]=true}});return d}}}a.getName=function(){return ah};return a})}(typeof define==="function"&&define.amd?define:function(i,g){var h=BES.ProTrack.Vortex.Modules.Utils;var j=BES.ProTrack.Vortex.Modules.Log;var l=g(h,j);var k="BES.ProTrack.Vortex.Plugins."+l.getName();h.extendNamespace(window,k,l)}));(function(b){b(["./utils"],function(g){if(!JSON){throw new Error("BES.ProTrack.Vortex.Modules.Ajax depends on JSON support.")}if(!g){throw new Error("BES.ProTrack.Vortex.Modules.Ajax depends on Utils module.")}var j=g,h={0:200,1223:204};j.extendNamespace(window,"BES.ProTrack.Vortex.Modules");function i(e){try{var c=new XMLHttpRequest();if(!("withCredentials" in c)){c=new XDomainRequest()}return c}catch(d){}return null}function a(C,y,f,E,B,A){var x,c,d={app_id:y.app_id,eventName:y.eventName},I,F,G,e,D;delete y.app_id;delete y.eventName;I=j.param(d);F=j.param(y);G=I.length+F.length;D=(G<1250)?"GET":"POST";if((Object.prototype.toString.call(window.operamini)==="[object OperaMini]")||(c=i(window))==null){(function(){var k=document.createElement("script");k.type="text/javascript";k.src=C+"?"+I+"&"+F+"&"+Math.ceil(((new Date()).getTime()/1000));document.body.appendChild(k)})();return}if(A){var z=new Image();z.src=C+"?"+I+"&"+F+"&"+Math.ceil(((new Date()).getTime()/1000));z.style.height="1px";z.style.width="1px";document.body.appendChild(z);return}c=i(window);if(typeof D!=="string"&&(D!=="POST"||D!=="GET")){throw"method request must be 'POST' or 'GET'"}if(f&&typeof f!=="function"||(E&&typeof E!=="function")){throw"callbacks must be a function"}var H=function(k){return function(){if(k==="error"){E({status:c.status,statusText:c.statusText})}else{f({status:c.status,statusText:c.statusText,text:typeof c.responseText==="string"?{text:c.responseText}:undefined,headers:c.getAllResponseHeaders?c.getAllResponseHeaders():""})}}};f&&typeof f=="function"&&(c.onload=H());E&&typeof E=="function"&&(c.onerror=H("error"));C+="?"+I;if(D==="GET"){C+="&"+F}c.open(D,C,true);c.withCredentials=true;if(c.setRequestHeader!=undefined){if(B){for(x=0;x<B.length;x++){c.setRequestHeader(B[x].name,B[x].value)}}}c.send(D=="POST"?F:undefined)}return{sendRequest:a}})}(typeof define==="function"&&define.amd?define:function(h,f){var g=BES.ProTrack.Vortex.Modules.Utils;var j=f(g);var i="BES.ProTrack.Vortex.Modules.Ajax";g.extendNamespace(window,i,j)}));(function(b){b(["./utils","./log","./ajax","./pl_ns"],function(x,B,G,H){if(!JSON){throw new Error("BES.ProTrack.Vortex depends on JSON support.")}if(!x){throw new Error("BES.ProTrack.Vortex depends on Utils module.")}if(!G){throw new Error("BES.ProTrack.Vortex depends on Ajax module.")}var u=x,w=G,y=[],v=[],C=B?B.getLog("send.interface.modern.js"):{writeLine:u.noop},D={url:u.httpScheme()+"etahub.com/events",sendPixel:false,activatePlugins:"all",skipActivatePlugins:[],plugins:{}},E=u.extend({},D),z={uniqueId:null},a={appid:null};y=u.foldl(H,function(c,d,e){C.writeLine("Plugin "+d.getName()+" loaded");c.push(d);return c},[]);function F(c,f,d,g){if(!(d&&(typeof(d)==="object"))){var e="You cannot pass non-object as container for generic attributes.";C.writeLine(e);throw new Error(e)}this.asQueryObject=function(){var i={app_id:c,eventName:f};var h={};u.each(d,function(o,p){var l=o+"";var n=p+"";if(!/^[A-Za-z0-9_-]{0,30}$/.test(n)){h[101]=true}else{var k=u.determineTypePrefix(o);if(!k.err){var m=k.prefix;i[m+p]=o}else{h[100]=true}}});if(z.uniqueId){i._suniqueId=z.uniqueId}u.each(g,function(k){k(i)});var j=u.keys(h);if(j.length){i._errors=j.concat(",")}return i}}function s(c,e,d){u.each({appId:c,eventName:e},function(f,g){if(!f){var h=u.str.format("validateEvent: Parameter '{0}' cannot be empty, undefined, or null.",g);C.writeLine(h);throw new Error(h)}})}function t(g,c){var d=[{name:"Content-Type",value:"application/x-www-form-urlencoded"}];var e=g.asQueryObject();function f(i,h){w.sendRequest(E.url,e,i,h,d,E.sendPixel)}C.writeLine(u.str.format("sendEvent: sent event {0}.",JSON.stringify(g)));c=c||u.noop;f(function(h){c(null,h)},function(h){c(h,null)})}function A(d,c,i,j){var e=u.noop,h={};j=j||{};var k=[].slice.call(arguments,A.length);switch(k.length){case 0:break;case 1:if(typeof k[0]=="object"){h=k[0]}else{if(typeof k[0]=="function"){e=k[0]}}break;default:if(typeof k[0]=="object"){h=k[0]}if(typeof k[1]=="function"){e=k[1]}break}var l=u.extend(c,h);C.writeLine("sendEventModern: sending a generic event ");s(d,i,j?j.value:undefined);var f=u.foldl(v,function(m,n){var p=n.instance,o=n.constructor;if((l.activatePlugins==="all"||(l.activatePlugins.indexOf(o.getName())!==-1))&&l.skipActivatePlugins.indexOf(o.getName())==-1){m.push(p.process.bind(n,l))}return m},[]);var g=new F(d,i,j,f);return t(g,e)}return function(c,d){var e=this;E=u.extend(E,d);if(!(c&&typeof(c)=="number")){throw new Error("You must specify an application id.")}a.appid=c;v=u.foldl(y,function(f,g){f[g.getName()]={constructor:g,instance:g(E)};return f},{});e.pl=u.foldl(v,function(g,f){g[f.constructor.getName()]=f.instance;return g},{});e.unique=function(f){z.uniqueId=f};e.sendEvent=u.getDeferredFunc(A.bind(this,c,E),this)}})}(typeof define==="function"&&define.amd?define:function(h,j){if(!BES.ProTrack.Vortex.Modules){throw new Error("Could not load any modules!")}var f=j(BES.ProTrack.Vortex.Modules.Utils,BES.ProTrack.Vortex.Modules.Log,BES.ProTrack.Vortex.Modules.Ajax,BES.ProTrack.Vortex.Plugins||[]);var g=BES.ProTrack.Vortex.Modules.Utils;var i="BES.ProTrack.Vortex.Modules.SendInterface";g.extendNamespace(window,i,f)}));(function(b){b(["./utils","./log","./ajax","./agentinfo","./send.interface"],function(q,s,x,p,n){if(!JSON){throw new Error("BES.ProTrack.Vortex depends on JSON support.")}if(!q){throw new Error("BES.ProTrack.Vortex depends on Utils module.")}if(!x){throw new Error("BES.ProTrack.Vortex depends on Ajax module.")}var a=q,o=x,r=p,t=s?s.getLog("core.js"):{writeLine:a.noop},u={},v=a.extend({},u);if(!n){var w="Cannot find the SendInterface implementation.";t.writeLine(w);throw new Error(w)}if(r){t.writeLine("Found AgentInfo module, enabling Agent detection!")}return function(){var e=arguments[0],d,c;if(typeof e=="object"){d=e}else{c=e;d=arguments[1]}a.extend(v,d||{});if(v.url){v.url=a.ensureProperUrlScheme(v.url)}return new n(c,v)}})}(typeof define==="function"&&define.amd?define:function(h,f){if(!BES.ProTrack.Vortex.Modules){throw new Error("Could not load any modules!")}var i=f(BES.ProTrack.Vortex.Modules.Utils,BES.ProTrack.Vortex.Modules.Log,BES.ProTrack.Vortex.Modules.Ajax,BES.ProTrack.Vortex.Modules.AgentInfo,BES.ProTrack.Vortex.Modules.SendInterface);var g=BES.ProTrack.Vortex.Modules.Utils;var j="BES.ProTrack.Vortex.Class";g.extendNamespace(window,j,i)}));