(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define(["jquery"],function(e){var i;return i=function(){function i(e,i,r,o){this.request_id=e,this.org_referrer=i,this.logger=r,null==o&&(o={}),this._trackModalHide=t(this._trackModalHide,this),this._trackModalShow=t(this._trackModalShow,this),this._trackScrolling=t(this._trackScrolling,this),this._storeDelayedLinkClick=t(this._storeDelayedLinkClick,this),this._handleLinkClick=t(this._handleLinkClick,this),this._delayed_init=t(this._delayed_init,this),this.init_time=this._now(),this.lastScrollOffset=0,this.sessionStorage=this._isSessionStorageAvailable()&&window.sessionStorage,this.current_modal_id=null,this.modal_class=o.modal_class||".ui-modal",this.delayed_link_click_logging=o.delayed_link_click_logging||!0,this._heartbeat(),setTimeout(this._delayed_init,50)}var r,o,n;return n=500,o={heartbeat:"heartbeat",pageView:"page_view",scroll:"scroll_event",linkClick:"link_click",linkNoSessionStorage:"link_no_session_storage",modalOpen:"modal_open",modalClose:"modal_close"},r={linkClick:"clicked_link",scrollTimer:"scrollTimer"},i.prototype._delayed_init=function(){return this._logPageViewEvent(),this._logDelayedClickEvent(),this._setupListeners()},i.prototype._setupListeners=function(){return e(window).on("scroll",this._throttle(this._trackScrolling,2e3)),e(document.body).on("mousedown","a",this._handleLinkClick),e(document).on("modalOpened",this._trackModalShow),e(document).on("modalClosed",this._trackModalHide)},i.prototype._logPageViewEvent=function(){return this._log(o.pageView)},i.prototype._handleLinkClick=function(t){var i,r,n,l;return r=t.currentTarget,i=e(r),l=null!=i?i.offset():void 0,n={link_id:null!=i?i.attr("data-trackingid"):void 0,origin_href:null!=r?r.href:void 0,url:this._get_safe_href(),vertical_offset:this._vertical_offset(),time_on_page:this._time_on_page(),top:Math.round(null!=l?l.top:void 0),left:Math.round(null!=l?l.left:void 0),link_rank:this._link_rank(r,i,l),request_id:this.request_id},null!=this.org_referrer&&(n.org_referrer=this.org_referrer),this.delayed_link_click_logging?this._storeDelayedLinkClick(n):this._log(o.linkClick,n)},i.prototype._storeDelayedLinkClick=function(t){var e,i;if(!this.sessionStorage)return this._log_on_page(o.linkNoSessionStorage),!1;try{this.sessionStorage.setItem(r.linkClick,JSON.stringify(t))}catch(t){return e=t,!1}return!0},i.prototype._logDelayedClickEvent=function(){var t,e,i,n;if(this.sessionStorage&&(t=this.sessionStorage.getItem(r.linkClick)))try{return n=JSON.parse(t),n.destination_url=this._get_safe_href(),this._log(o.linkClick,n),this.sessionStorage.removeItem(r.linkClick)}catch(t){e=t}},i.prototype._trackScrolling=function(){return clearTimeout(e.data(this,r.scrollTimer)),e.data(this,r.scrollTimer,setTimeout(function(t){return function(){var e;return e=t._vertical_offset(),t.lastScrollOffset!==e?(t.lastScrollOffset=e,t._log_on_page(o.scroll)):void 0}}(this),n))},i.prototype._trackModalShow=function(){var t;return this.current_modal_id=null!=(t=e(this.modal_class).filter(":visible")[0])?t.id:void 0,this.current_modal_id?this._log_modal(o.modalOpen,this.current_modal_id):void 0},i.prototype._trackModalHide=function(){return this.current_modal_id?(this._log_modal(o.modalClose,this.current_modal_id),this.current_modal_id=null):void 0},i.prototype._heartbeat=function(t){return null==t&&(t=0),setTimeout(function(e){return function(){return e._log_on_page(o.heartbeat),e._heartbeat(t+1)}}(this),1e3*Math.pow(3,t)+1e3)},i.prototype._vertical_offset=function(){return e(window).scrollTop()},i.prototype._time_on_page=function(){var t;return t=this._now(),Math.round((t-this.init_time)/1e3)},i.prototype._link_rank=function(t,i,r){var o,n,l,s,a,_;for(_=e("a[href='"+i.attr("href")+"']"),l=s=0,a=_.length;a>s;l=++s){if(o=_[l],n=e(o).offset(),o===t&&n.top===r.top&&n.left===r.left)return l+1;return}return-1},i.prototype._isSessionStorageAvailable=function(){var t,e,i;i="uxa_"+(Math.floor(1e4*Math.random())+1e4);try{return window.sessionStorage.setItem(i,i),window.sessionStorage.removeItem(i),!0}catch(e){return t=e,!1}},i.prototype._get_safe_href=function(t){return null==t&&(t=window),t.location.href},i.prototype._now=function(){return(Date.now||function(){return(new Date).getTime()})()},i.prototype._throttle=function(t,e,i){var r,o,n;return null==i&&(i={}),n=null,o=0,r=function(e){return function(){var r,l,s;return o=i.leading===!1?0:e._now(),n=null,s=t.apply(l,r),n?void 0:l=r=null}}(this),function(l){return function(){var s,a,_,u,c;return _=l._now(),o||i.leading!==!1||(o=_),u=e-(_-o),a=l,s=arguments,0>=u||u>e?(n&&(clearTimeout(n),n=null),o=_,c=t.apply(a,s),n||(a=s=null)):n||i.trailing===!1||(n=setTimeout(r,u)),c}}(this)},i.prototype._log_modal=function(t,e){var i;return i={modal:e},this._log_on_page(t,i)},i.prototype._log_on_page=function(t,e){return null==e&&(e={}),e.vertical_offset||(e.vertical_offset=this._vertical_offset()),e.time_on_page||(e.time_on_page=this._time_on_page()),this._log(t,e)},i.prototype._log=function(t,e){var i,r;null==e&&(e={}),t!==o.linkClick&&(e.url||(e.url=this._get_safe_href()),e.request_id||(e.request_id=this.request_id),null!=this.org_referrer&&(e.org_referrer=this.org_referrer));try{return this.logger.log(t,e)}catch(t){i=t}},i}()})}).call(this);