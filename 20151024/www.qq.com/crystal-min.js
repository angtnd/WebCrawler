!function(lib_name,crystal_args,namespace,ua){function testCssPositionFixed(){return 6!==ua.ie}function testCssMozPrefix(){return"MozBinding"in OBJ_CSS_TESTER_EL.style}function testCssRgba(){var testColor="rgba(0,0,0,0.5)",originalColor=OBJ_CSS_TESTER_EL.style.color;
try{return OBJ_CSS_TESTER_EL.style.color=testColor,OBJ_CSS_TESTER_EL.style.color===originalColor?!1:!0}catch(e){return!1}}function sns_pingurl(opt,act){var actid=0,subactid=0,m_options=mix({},opt);switch(act){case"follow_success":actid=80001;break;case"sns_plus_success":actid=85001;
break;case"share_success":actid=80002;break;case"banner_click":actid=80005;break;case"relation_click":actid=80007;break;case"relation_click_weibo":actid=70007;break;case"banner_close":actid=85004;break;case"act_join_success":actid=80006;break;case"weibo_join_success":actid=80009;
break;case"follow_click":actid=80008}return m_options.actid=actid,m_options.subactid=subactid,m_options.aver=m_options.aver?m_options.aver:"",m_options.token=m_options.token?"&snstoken="+m_options.token:"",m_options.uin=m_options.uin?"&snsuin="+m_options.uin:"",format("http://m.l.qq.com?t=s&mid={oid}&actid={actid}&subactid={subactid}&aver={aver}&oid={oid}&locid={loc}{token}{uin}",m_options)
}var pageStartTime;window.QosSS&&QosSS.t?pageStartTime=QosSS.t[0]:window.QosSS&&QosSS.tQueue?pageStartTime=QosSS.tQueue[0]:window.QosS&&QosS.G?pageStartTime=QosS.G.startTime||QosS.G.st:window.QosS&&QosS.Global?pageStartTime=QosS.Global.startTime:window.d0&&window.d0.getTime&&(pageStartTime=window.d0.getTime());
var DURATION_LOAD_JS=pageStartTime&&window.TIME_BEFORE_LOAD_CRYSTAL?window.TIME_BEFORE_LOAD_CRYSTAL-pageStartTime:-1;Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement,fromIndex){if(void 0===this||null===this)throw new TypeError('"this" is null or not defined');
var length=this.length>>>0;for(fromIndex=+fromIndex||0,1/0===Math.abs(fromIndex)&&(fromIndex=0),0>fromIndex&&(fromIndex+=length,0>fromIndex&&(fromIndex=0));length>fromIndex;fromIndex++)if(this[fromIndex]===searchElement)return fromIndex;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(callback,thisArg){thisArg||(thisArg=null);
var i,len=this.length;for(i=0;len>i;i++)callback.call(thisArg,this[i],i,this)}),Date.now||(Date.now=function(){return(new Date).getTime()});var Uuids={get:function(){for(var s=[],hexDigits="0123456789abcdef",i=0;36>i;i++)s[i]=hexDigits.substr(Math.floor(16*Math.random()),1);
return s[14]="4",s[19]=hexDigits.substr(3&s[19]|8,1),s[8]=s[13]=s[18]=s[23]="-",s.join("")},getReqId:function(){return this.get().replace(/[-]/g,"")},getCurrentPageReqId:function(){return this.cprid?this.cprid:this.cprid=this.getReqId()}};namespace.Uuids=Uuids;
var OBJ_CSS_TESTER_EL=document.createElement("div"),FeatureDetector=namespace.FeatureDetector={cssPositionFixed:testCssPositionFixed(),cssMozPrefix:testCssMozPrefix(),cssRgba:testCssRgba()},CrystalPageSpeed={tagMap:{},time:function(tag,time){var t=time||Date.now();
this.tagMap[tag]?{}:this.tagMap[tag]={};var tagRecord=this.tagMap[tag];-1===tagRecord.start||-1===tagRecord.end||tagRecord.duration||(!tagRecord.start||tagRecord.end)&&(tagRecord.start=t,tagRecord.end=void 0)},timeEnd:function(tag){var endTime=Date.now(),tag=this.tagMap[tag];
return tag?(-1===tag.start||-1===tag.end||tag.duration||tag.end||(tag.end=endTime,tag.duration=-1===tag.start?-1:endTime-tag.start),tag.duration):void 0},setDuration:function(tag,duration){this.tagMap[tag]={start:-1,end:-1,duration:duration}},flush:function(pingSender){if(!this.isDirtyData()&&crystal_args.jsProfileOpen){var k,params={},envInfo=this.getEnvInfo();
for(k in envInfo)params[k]=envInfo[k];for(k in this.tagMap)this.tagMap[k].duration+""&&("lview-l.qq.com"===k?params.lview=this.tagMap[k].duration:params[k]=this.tagMap[k].duration);0===params.err&&("undefined"==typeof params.ping&&(params.err=6001),"undefined"==typeof params.cdn&&(params.err=5001),"undefined"==typeof params.lview&&(params.err=4001),"undefined"==typeof params.dr&&(params.err=3001),-1===params.loadjs&&(params.err=1001)),params.all=(new Date).getTime()-this.tagMap.js.start,params.all<1e3*crystal_args.lview_time_out&&4002===params.err&&(delete params.lview,params.err=4004),pingSender=pingSender||sendPing,pingSender(crystal_args.mo_page_url+"?"+serializeQuery(params))
}this.flush=function(){}},getEnvInfo:function(){if(!this.envInfo){var d=this.getBrowserDimension(),dmMatch=location.href.match(/\/\/([^\?\/]*)\/?\??/),dm=dmMatch&&dmMatch[1]?dmMatch[1]:-1;this.envInfo={err:0,dm:crystal_args.domain||dm,ua:browsersniffer(navigator.userAgent),cv:namespace.version,fv:namespace.getFlashVersion(),bw:d.width,bh:d.height,sw:window.screen.width,sh:window.screen.height,reqid:namespace.Uuids.getCurrentPageReqId()}
}return this.envInfo},getBrowserDimension:function(){var r={width:-1,height:-1},myHeight=(document.documentElement,document.body,-1),myWidth=-1;return"number"==typeof window.innerWidth?(myWidth=window.innerWidth,myHeight=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(myWidth=document.documentElement.clientWidth,myHeight=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(myWidth=document.body.clientWidth,myHeight=document.body.clientHeight),r.width=myWidth,r.height=myHeight,r
},setEnvInfoProperty:function(propName,propValue){this.getEnvInfo()[propName]=propValue},isDirtyData:function(){var i,testTags=["loadjs","js","dr"];for(i=0;i<testTags.length;i++){var t=this.tagMap[testTags[i]];if(t&&t.duration&&t.duration<-1)return!0}return!1
},on:function(el,type,handler){return document.addEventListener?(el.addEventListener(type,handler,!1),handler):(el.attachEvent("on"+type,handler),handler)},isElementInViewport:function(el,adWidth,adHeight){try{if(!el.getBoundingClientRect)throw new Error("Method getBoundingClientRect is not supported to detect advertisement click.");
var rect=el.getBoundingClientRect()}catch(e){return!1}var visibleArea,adArea=parseInt(adWidth)*parseInt(adHeight),top=rect.top,left=rect.left,bottom=rect.bottom,right=rect.right,winHeight=window.innerHeight||document.documentElement.clientHeight,winWidth=window.innerWidth||document.documentElement.clientWidth,visibleHeight=0>top?adHeight+top:bottom>winHeight?adHeight-bottom+winHeight:adHeight,visibleWidth=0>left?adWidth+left:right>winWidth?adWidth-right+winWidth:adWidth;
return visibleArea=visibleHeight*visibleWidth,visibleArea>=adArea/2},adClickMap:{},registerClick:function(adEl,clickableEl,adData){if(crystal_args.jsProfileOpen){var loc=adData.loc,oid=adData.oid;if(!this.adClickMap[loc]){this.adClickMap[loc]={loc:loc,adEl:adEl,adData:adData,visibleStartTime:adData.fodder[0]&&this.isElementInViewport(adEl,adData.fodder[0].width,adData.fodder[0].height)?Date.now():null};
var self=this;this.on(clickableEl,"click",function(){var now=Date.now(),visibleStartTime=self.adClickMap[loc].visibleStartTime;sendPing(crystal_args.mo_ad_click_url+"?"+serializeQuery({loc:loc,oid:oid,reqid:namespace.Uuids.getCurrentPageReqId(),stay:pageStartTime?now-pageStartTime:-1,click:visibleStartTime?now-visibleStartTime:-1}))
})}}},initVisibleAdDetectorEvent:function(){function handler(){var k,v;for(k in self.adClickMap)v=self.adClickMap[k],v.adData.fodder[0]&&self.isElementInViewport(v.adEl,v.adData.fodder[0].width,v.adData.fodder[0].height)&&(v.visibleStartTime=Date.now())}var self=this;
this.on(window,"DOMContentLoaded",handler),this.on(window,"load",handler),this.on(window,"scroll",handler),this.on(window,"resize",handler)}},Cps=namespace.cps=CrystalPageSpeed,PrivacyTag={privateOriganalIcon:function(dsp_name,private_link,css){var privacyTag=this,privateIcon=crystal.dom.createElement({position:"absolute",width:"18px",height:"18px",right:"0px",bottom:"0px",cursor:"pointer","z-index":20,background:"url("+namespace.resource("privacy/white_icon.png")+") no-repeat"},{"class":"absolute"},"div");
return css&&crystal.dom.setStyle(privateIcon,css),crystal.evt.on(privateIcon,"mouseover",function(){var privateName=privacyTag.addPrivateTag(dsp_name,private_link,css);privateIcon.parentNode.appendChild(privateName),privateIcon.parentNode.removeChild(privateIcon)
}),crystal.evt.on(privateIcon,"click",function(){window.open(private_link)}),privateIcon},privateMouseOverIcon:function(css){var privateIcon=crystal.dom.createElement({position:"absolute",width:"18px",height:"18px",right:"0px",bottom:"0px",cursor:"pointer","z-index":20,background:"url("+namespace.resource("privacy/blue_icon.png")+") no-repeat"},{"class":"absolute"},"div");
return css&&crystal.dom.setStyle(privateIcon,css),privateIcon},privateDspName:function(dsp_name,private_link,css){var dspName="  "+dsp_name+" ",privateName=crystal.dom.createElement({position:"absolute",width:"auto","font-size":"12px","line-height":"18px",height:"18px",right:"18px",bottom:"0px",color:"#FFF",cursor:"pointer","z-index":20,"white-space":"pre",background:"url("+namespace.resource("privacy/black_bg.png")+") no-repeat"},{"class":"absolute"},"div",dspName);
if(css){var dspNameCss=JSON.parse(JSON.stringify(css));dspNameCss.width="auto",dspNameCss.right=parseInt(css.right.split("px")[0])+18+"px",crystal.dom.setStyle(privateName,dspNameCss)}return privateName},addPrivateTag:function(dsp_name,private_link,css){var privacyTag=this,privateTag=crystal.dom.createElement({},{},"div"),privateName=privacyTag.privateDspName(dsp_name,private_link,css),privateIcon=privacyTag.privateMouseOverIcon(css);
return privateTag.appendChild(privateName),privateTag.appendChild(privateIcon),crystal.evt.on(privateTag,"mouseout",function(e){var e=e||window.event,obj=e.relatedTarget||e.toElement;obj!==privateName&&(privateTag.parentNode.appendChild(privacyTag.privateOriganalIcon(dsp_name,private_link,css)),privateTag.parentNode.removeChild(privateTag))
}),crystal.evt.on(privateTag,"click",function(){window.open(private_link)}),privateTag},reportIcon:function(el,oid){var report_link="http://ra.gtimg.com/web/jsproxy/reportfakead.html",reportIcon=crystal.dom.createElement({position:"absolute",width:"35px",height:"16px",left:"29px",bottom:"0px",cursor:"pointer",display:"none","z-index":20,background:"url("+namespace.resource("res/icon/report_default.png")+") no-repeat"},{"class":"absolute"},"div");
return crystal.evt.on(reportIcon,"click",function(){var timestamp=(new Date).getTime();window.open(report_link+"?oid="+oid+"&timestamp="+timestamp)}),crystal.evt.on(reportIcon,"mouseover",function(){crystal.dom.setStyle(reportIcon,{background:"url("+namespace.resource("res/icon/report_hover.png")+") no-repeat"})
}),crystal.evt.on(reportIcon,"mouseout",function(){crystal.dom.setStyle(reportIcon,{background:"url("+namespace.resource("res/icon/report_default.png")+") no-repeat"})}),crystal.evt.on(el,"mouseover",function(){crystal.dom.setStyle(reportIcon,{display:"block"})
}),crystal.evt.on(el,"mouseout",function(e){var e=e||window.event,obj=e.relatedTarget||e.toElement;obj!==reportIcon&&crystal.dom.setStyle(reportIcon,{display:"none"})}),reportIcon}},Pt=namespace.pt=PrivacyTag;if(Cps.initVisibleAdDetectorEvent(),Cps.setDuration("loadjs",DURATION_LOAD_JS),Cps.time("js",window.TIME_BEFORE_LOAD_CRYSTAL?window.TIME_BEFORE_LOAD_CRYSTAL:-1),Cps.timeEnd("js"),Cps.time("dr"),"undefined"==typeof window[lib_name]){window[lib_name]=window.crystal2=window.AD2=namespace;
var cpm_prefix_process=function(){var crystal_toberemove=["Finance_Width1","Finance_Width2","Finance_Rectangle","Finance_Width3","Finance_Width4","Finance_Width5","Finance_2nd_Width1","Finance_2nd_Rectangle1","Finance_2nd_bottom_Width","stock_Width1","stock_Rectangle","stock_Width2","stock_Width3","F_Width1_N","F_UpRight1","F_D_Width1","health_width1","health_width2","health_Rectangle1","health_Rectangle2","Edu_Width1","Edu_Width2","Edu_Width3","Edu_Width4","Edu_HP_Rectangle","Edu_2nd_Width1","Edu_KY_Width1","Tech_Width1","Tech_bottom_Width","Tech_2nd_Width1","Tech_2nd_Width2","Tech_Rectangle1","Tech_Rectangle2","Auto_Width1","Auto_Width2","Auto_Width3","Auto_Width4","Auto_Width5","Auto_Width6","Auto_Button1","auto_button2","Auto_Button3","Auto_Button4","Auto_Button5","Auto_2nd_Width1","Auto_2nd_Width2","Fashion_Width1","Fashion_Width2","Fashion_Width3","Fashion_Width4","Fashion_Width5","Fashion_Button1","Fashion_button2","Fashion_button3","Fashion_pic_Width2","Fashion_2nd_Width1","Fashion_2nd_Width2","Digital_Width1","Digital_Width2","Digital_Width5","Digital_Rectangle1","Digital_Rectangle2","Digi_2nd_Width1","Digi_2nd_Width2","Sports_Width1A","News_Width1","News_Rectangle","News_Rectangle2","News_Rectangle3","News_Width2","News_Width3","News_skyscraper","News_Width4","News_Pic_Width2","News_2nd_Width1","News_2nd_Width2","Gamezone_Width1","Gamezone_Width2","Gamezone_Width3","Gamezone_Width4","Game_bottom_Width","Game_2nd_Width1","Game_2nd_Width2","Ent_Button1","Ent_Rectangle1","Ent_Rectangle2","Ent_Width1","Ent_Width2","Ent_Width3","Ent_Width4","Ent_Pic_Width2","Ent_2nd_Width1","Ent_2nd_Width2","Ent_2nd_Rectangle1","Music_Upright","ent_ZL_Rectangle","ent_ZL_Width1","ent_ZL_Width2","Baby_Width2","Baby_Width3","Baby_Width4","Baby_Rectangle","stock_2nd_Width1","stock_2nd_Width2","Music_Width1","Music_Width2"];
return function(){for(var i=0,l=crystal_toberemove.length;l>i;i++){var node=document.getElementById(crystal_toberemove[i]);node&&node.parentNode&&node.parentNode.removeChild(node)}}}();namespace.cpm_prefix_process=cpm_prefix_process,namespace.version="v2.5Beta02",eval(namespace.output(lib_name)),namespace.crystal_args=crystal_args;
var refs=namespace.__images=[],sendPing=function(url,norandom){var img=new Image(1,1);if(!norandom){var constr="?";-1!=url.indexOf("?")&&(constr="&"),url=url+constr+Math.random()}return url.indexOf("[timestamp]")>-1&&(url=url.replace("[timestamp]",Math.round((new Date).getTime()/1e3))),img.src=url,refs.push(img),this
},report_ua=function(){for(var i in ua)if(0!=ua[i])return i+ua[i]}(),importScript=namespace.importScript=function(url,callback,charset,errorCallback){var script=document.createElement("script");script.src=url,charset&&(script.charset=charset),callback&&(ua.ie?script.onreadystatechange=function(){var rs=this.readyState;
("loaded"===rs||"complete"===rs)&&callback()}:script.onload=callback),errorCallback&&"onerror"in script&&(script.onerror=errorCallback),document.getElementsByTagName("head")[0].appendChild(script)},channel;try{var url_search=location.search,channel_match=location.href.match(/([\w\.]+)\.qq\.com/),channel_mapping={cp:"sports",sport:"sports",fcbarcelona:"sports",college:"edu",zhiyun:"sports","kbs.sports":"sports","data.auto":"auto",thr:"ent",space:"tech","view.news":"coral","video.coral":"coral",mil:"news",space:"tech"};
channel=namespace.channel=(channel_match&&channel_match[1]).toLowerCase(),0===location.href.indexOf("http://sports.qq.com/nba")&&(channel="nba"),window.ARTICLE_INFO&&window.ARTICLE_INFO.tpl&&window.ARTICLE_INFO.tpl.dev&&"nba"===window.ARTICLE_INFO.tpl.dev&&(channel=window.ARTICLE_INFO.tpl.dev),channel_mapping[channel]&&(channel=channel_mapping[channel])
}catch(e){}var IPingBase={append:doNothing,flush:doNothing,touch:sendPing};namespace.contains=document.documentElement.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:document.documentElement.compareDocumentPosition?function(a,b){return!!(16&a.compareDocumentPosition(b))
}:function(){return!1},namespace.sns_pingurl=sns_pingurl;var fp11input=null,pageinfo=namespace.pageinfo={info:null,order:[]},limitchar=function(str,maxchar){for(var cl=str.length,ret="",olen=0,i=0;cl>i;i++){var t=encodeURIComponent(str.substr(i,1));olen+=t.length,maxchar>olen&&(ret+=t)
}return ret},encodeURIComLimit=function(str,maxchar){var encodeStr=encodeURIComponent(str);if(encodeStr.length>maxchar)for(var isOver=!1;!isOver;){encodeStr=encodeStr.substr(0,maxchar);try{decodeURIComponent(encodeStr),isOver=!0}catch(e){maxchar--}}return encodeStr
},isFromDiscuz=function(fromStr){return fromStr?fromStr.indexOf("/f/discuz")>-1||fromStr.indexOf("search.php?")>-1:!1},collectInfo=function(mode){var info=null;if(null!=namespace.pageinfo.info)info=namespace.pageinfo.info;else{var keywords="",title="",refer="",soso="";
each(document.getElementsByTagName("meta"),function(o){"keywords"==o.getAttribute("name")&&(keywords=o.getAttribute("content")||"")});try{title=document.getElementsByTagName("title")[0].innerHTML,refer=document.referrer;var regex=new RegExp("(?:yahoo.+?[?|&]p=|openfind.+?query=|google.+?q=|lycos.+?query=|onseek.+?keyword=|search.tom.+?word=|search.qq.com.+?word=|zhongsou.com.+?word=|search.msn.com.+?q=|yisou.com.+?p=|sina.+?word=|sina.+?query=|sina.+?_searchkey=|sohu.+?word=|sohu.+?key_word=|sohu.+?query=|163.+?q=|baidu.+?wd=|baidu.+?kw=|baidu.+?word=|3721.com.+?p=|Alltheweb.+?q=|soso.+?w=|115.+?q=|youdao.+?q=|sogou.+?query=|bing.+?q=|114.+?kw=|/f/discuz.+q=|/.+/search.php.+?kw=)([^&]*)"),result=refer.match(regex);
if(result){var from=result[0];if(0===result[1].indexOf("%25")&&(result[1]=decodeURIComponent(result[1])),isFromDiscuz(from))refer="discuz%7C"+result[1];else try{refer=result[0].substr(0,result[0].indexOf("."))+"%7C"+result[1]}catch(e){refer=result[0].substr(0,result[0].indexOf("."))+"%7C"+result[1]
}}else refer=""}catch(e){}keywords=limitchar(keywords,360),title=limitchar(title,180),refer=refer.substr(0,90),soso=limitchar(soso,90),info={k:keywords,t:title,r:refer,s:soso},namespace.pageinfo.info=info}return 1==mode?"&k="+info.k+"&t="+info.t+"&r="+info.r+"&s="+info.s:info
};window[lib_name].ActionPing={actionCodeDictionary:{RICH_COUPLET_MOUSEOVER:40006,RICH_COUPLET_MOUSEOUT:40005,RICH_COUPLET_CLOSE:40001,RICH_COUPLET_SWITCH:40009,RICH_COUPLET_SHOW:40008,EXTEND_TURNER_EXTEND:60003,EXTEND_TURNER_REDUCE:60004},urlTemplate:"http://m.l.qq.com?t=s&mid={mid}&actid={actid}&subactid={subactid}&aver={aver}&oid={oid}&locid={loc}",_requestByImg:function(url,norandom){var img=new Image(1,1);
if(!norandom){var constr="?";-1!=url.indexOf("?")&&(constr="&"),url=url+constr+Math.random()}return img.src=url,refs.push(img),this},send:function(parameter){var actionId=this.actionCodeDictionary[parameter.actionCode]||parameter.actionId;parameter.actid=actionId,parameter.mid=parameter.mid||parameter.oid,parameter.subactid=parameter.subactid||0;
var currentUrl=format(this.urlTemplate,parameter);this._requestByImg(currentUrl)}};var DataStorage=window[lib_name].DataStorage=function(){function generateExpireDate(expireTime){return expireTime?new Date((new Date).getTime()+6e4*expireTime).toUTCString():void 0
}var userDataDomElement,mod="DataStorage",tests={};return tests.localstorage=function(){try{return localStorage.setItem(mod,mod),localStorage.removeItem(mod),!0}catch(e){return!1}},tests.userdata=function(){try{return userDataDomElement=document.createElement("input"),userDataDomElement.type="hidden","undefined"==typeof userDataDomElement.addBehavior?!1:(userDataDomElement.addBehavior("#default#userData"),document.body.insertBefore(userDataDomElement,document.body.firstChild),userDataDomElement.load(mod),userDataDomElement.setAttribute(mod,mod),userDataDomElement.save(mod),userDataDomElement.load(mod),userDataDomElement.expires=new Date(315532799e3).toUTCString(),!0)
}catch(e){return!1}},tests.localstorage()?{setItem:function(key,value){localStorage.setItem(key,value)},getItem:function(key){return localStorage.getItem(key)},removeItem:function(key){localStorage.removeItem(key)}}:tests.userdata()&&ua.ie<9?{defExps:525600,valueKeyStr:"savedValue",setItem:function(key,value,expireTime){try{userDataDomElement.load(key),userDataDomElement.setAttribute(this.valueKeyStr,value),expireTime=expireTime?expireTime:this.defExps,userDataDomElement.expires=generateExpireDate(expireTime),userDataDomElement.save(key)
}catch(ex){}},getItem:function(key){try{return userDataDomElement.load(key),userDataDomElement.getAttribute(this.valueKeyStr)}catch(ex){return null}},removeItem:function(key){this.setItem(key,!1,-this.defExps)}}:{deserializeString:function(assign_token,pair_separator,need_last,need_decode){var decode=need_decode?decodeURIComponent:function(k){return k
};return function(s){var ret={};need_last&&(s=s.replace(new RegExp(pair_separator+"$"),""));for(var pairArray=s.split(pair_separator),i=0;i<pairArray.length;i++){var pair=pairArray[i],key_value=pair.split(assign_token);ret[decode(key_value[0])]=decode(key_value[1])
}return ret}},setItem:function(key,value,expireTime){var text=key+"="+value;expireTime&&(text+="; expires="+generateExpireDate(expireTime)),text+="; path=/",document.cookie=text},getItem:function(key){if(key){var o=this.deserializeString("=","; ",!1,!1)(document.cookie);
return o[key]}},removeItem:function(key){this.setItem(key,"",-1)}}}(),PageType=function(){var home=["http://www.qq.com","http://finance.qq.com","http://health.qq.com","http://edu.qq.com","http://tech.qq.com","http://auto.qq.com","http://fashion.qq.com","http://digi.tech.qq.com","http://sports.qq.com","http://cul.qq.com","http://news.qq.com","http://games.qq.com","http://ent.qq.com","http://baby.qq.com","http://astro.fashion.qq.com","http://college.qq.com","http://sport.qq.com","http://stock.qq.com","http://sports.qq.com/nba"];
return function(url){if(url.match(/http:\/\/[^\/]*.qq.com\/+a\/+\d{8}/)||url.match(/http:\/\/(video\.)?coral.qq.com\/?/))return 2;var pos=-1,pos1=url.indexOf("#"),pos2=url.indexOf("?");return(pos1>-1||pos2>-1)&&(pos=pos2,-1===pos&&(pos=pos1),url=url.substr(0,pos)),"/"===url.substr(url.length-1)&&(url=url.substr(0,url.length-1)),home.indexOf(url)>-1?1:3
}}(),VISITOR_PING_WITH_HOST_DEFAULT_HOST="p.l.qq.com",VisitorPingWithHost=function(){"use strict";var maxurl=2048,maxRurl=100,rurl=encodeURIComLimit(document.referrer,maxRurl),pingTemplate="http://{host}/p?oid={oid}&cid={cid}&loc={loc}&aver={aver}&soid={soid}&pri={pri}&exp={exp}&pv_type={pv_type}&tango={tango}&dtype={dtype}&targetid={targetid}&btoid={btoid}&pctr={pctr}&btpri={btpri}&extstr={extstr}&index={index}&chl={chl}&rurl="+rurl+"&page_type="+PageType(location.href),defaultHost=VISITOR_PING_WITH_HOST_DEFAULT_HOST,cache={},unique_cache=[],createCacheData=function(host){return{host:host,oid:[],cid:[],loc:[],aver:[],soid:[],pri:[],exp:[],pv_type:[],tango:[],dtype:[],targetid:[],btoid:[],pctr:[],btpri:[],extstr:[],index:[],chl:[]}
},clearCache=function(){cache={},unique_cache=[]},spliceData=function(flushData,len){var cacheDataCopy={};return 0>len&&(len=flushData.oid.length+len),each(flushData,function(v,k){cacheDataCopy[k]="host"===k?v:v.splice(0,len)}),cacheDataCopy},filterFlushData=function(flushData){if(flushData.oid.length){{flushData.oid.length
}flushData.pri.toString().replace(/\,/g,"").length===flushData.pri.length&&(flushData.pri=[]),flushData.tango.toString().indexOf("1")<0&&(flushData.tango=[]);for(var filters=["pctr","targetid","btoid","dtype","btpri","extstr","chl"],i=0,flen=filters.length;flen>i;i++)/[1-9]/.test(flushData[filters[i]].toString())||(flushData[filters[i]]=[])
}return flushData},flush=function(flushData){flushData.oid.length&&(flushData=filterFlushData(flushData),sendPing(format(pingTemplate,flushData)+collectInfo(1),0),namespace.pingSent||(Cps.timeEnd("ping"),namespace.cdnTest&&Cps.flush(),namespace.pingSent=!0))
},flushAll=function(){each(cache,function(v){flush(v)}),clearCache()},dataExists=function(cache,data){for(var i=0;i<cache.length;i++){var ok=[],nk=[];for(var p in cache[i])ok.push(p);for(var p in data)nk.push(p);if(ok.length!==nk.length);else{var allsame=!0;
for(var p in cache[i])cache[i][p]!==data[p]&&(allsame=!1);if(allsame)return!0}}return!1},bufferFlush=buffer(flushAll,2e3);return clearCache(),mix(instance(IPingBase),{append:function(data){var host=data.ping||defaultHost;cache[host]||(cache[host]=createCacheData(host));
var flag=!1;dataExists(unique_cache,data)?flag=!0:unique_cache.push(data),data.loc.indexOf(":")>-1&&(data.loc=data.loc.substr(0,data.loc.indexOf(":"))),each(cache[host],function(v,k){flag||"host"===k||v.push(data[k]?data[k]:0)});var cacheData=cache[host],clen=collectInfo(1).length,purl=format(pingTemplate,cacheData),ncacheData=[];
purl.length+clen>=maxurl?(ncacheData=spliceData(cacheData,-1),flush(ncacheData)):bufferFlush()},flush:flushAll})}(),VisitorPing=namespace.ping=function(){"use strict";return mix(instance(IPingBase),{append:function(data){VisitorPingWithHost.append(data)},flush:function(){VisitorPingWithHost.flush()
}})}(),getFlashVersion=namespace.getFlashVersion=function(){try{if(navigator.plugins&&navigator.plugins.length>0)return parseInt(navigator.plugins["Shockwave Flash"].description.split(" ")[2],10);if("undefined"!=typeof window.ActiveXObject){var flash;try{flash=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")
}catch(e){for(var i=15;i>5;i--)try{flash=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+i);break}catch(e){}}return flash?parseInt(flash.GetVariable("$version").split(" ")[1].split(",")[0],10):0}return 0}catch(e){return 0}},browsersniffer=function(uastr){if(!uastr)return"unknown";
var uastr=uastr.toLowerCase(),pos=-1,ret=uastr.match(/(?:metasr.\d*|qqbrowser.\d*|maxthon.\d*|theworld|lbbrowser|firefox.\d*|opera.\d*|bidubrowser.\d*)/);if(null!==ret)return ret[0].replace(" ","").replace("/","");if((pos=uastr.indexOf("chrome"))>-1)return"chrome"+parseInt(uastr.substr(pos+7,4));
if((pos=uastr.indexOf("safari"))>-1)return"safari";var mpos=uastr.indexOf("msie");if(mpos>-1)return"ie"+parseInt(uastr.substr(mpos+5,2));var tpos=uastr.indexOf("trident");if(tpos>-1){var rvpos=uastr.indexOf("rv:");if(rvpos>-1)return"ie"+parseInt(uastr.substr(rvpos+3,2))
}return uastr};+function(){var action_map={expand:1,shrink:2},PING_TEMPLATE="http://dp3.qq.com/richmedia/?action={ACTION}&oid={OID}&loc={LOC}&site={CHANNEL}&ua={UA}&reqid={CID}";namespace.rmreport=function(option){var actionNum=action_map[option.action],oid=option.oid||"",loc=option.loc||"";
if(!actionNum)throw new Error('[ function:rmreport ] : Invalid value of parameter "action" - '+option.action);sendPing(format(PING_TEMPLATE,{ACTION:actionNum,OID:encodeURIComponent(oid),LOC:encodeURIComponent(loc),CHANNEL:encodeURIComponent(channel),UA:encodeURIComponent(navigator.userAgent),CID:namespace.Uuids.getReqId()}))
}}();var getFlashObject=namespace.getFlashObject=function(flashId){try{return window.document[flashId]?window.document[flashId]:document.getElementById(flashId)}catch(e){return 0}};!function(dom,evt,cookie){function request_force(loc){rot="&rot=1&ri="+loc.substr(-5);
var loc_id=loc;delete display_buffer[loc_id],delete rendered_area[loc_id],crystal.request(loc_id)}function getAntiCSRFToken(){function _getCookie(c_name){var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++)if(x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("=")),y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1),x=x.replace(/^\s+|\s+$/g,""),x==c_name)return unescape(y)
}function _getHash(key,hash,type){if(void 0===key||null===key||0===key.length)return"";for(var i=0,len=key.length;len>i;++i)hash+=(hash<<5)+key.charAt(i).charCodeAt();return hash=2147483647&hash,hash=hash.toString(16),type+(new Array(8-hash.length+1).join("0")+hash).toUpperCase()
}var skeyHash=_getHash(_getCookie("skey"),73231,"1"),lskeyHash=_getHash(_getCookie("lskey"),48995,"2"),version="A";return version+skeyHash+lskeyHash}function apiTokenEncode(oid,locat){function apitoken_num2chr(len){var code;if(len>=0&&9>=len)code="0".charCodeAt(0)+len;
else if(len>=10&&35>=len)code=len-10+"a".charCodeAt(0);else{if(!(len>=36&&61>=len))return-1;code=len-36+"A".charCodeAt(0)}return String.fromCharCode(code)}function apitoken_numlen(num){var dec_num=0;do dec_num++,num/=10;while(parseInt(num));return dec_num}var version="1",oidToken="1"+apitoken_num2chr(apitoken_numlen(oid))+oid,locarToken="2"+apitoken_num2chr(locat.length)+locat,ac=getAntiCSRFToken(),acToken="3"+apitoken_num2chr(ac.length)+ac;
return version+oidToken+locarToken+acToken}if(mix(namespace,{dom:dom,evt:evt,ua:ua,cookie:cookie}),evt.on(window,"load",function(){setTimeout(function(){crystal_args.mo_ping_script&&Math.random()<crystal_args.mo_ping_ratio&&importScript(crystal_args.mo_ping_script)
},1e3)}),ua.gecko){var xhr=new XMLHttpRequest;window.onbeforeunload=function(){Cps.flush(function(url){xhr.open("GET",url,!1),xhr.send(null)})}}else evt.on(window,"beforeunload",function(){Cps.flush()});evt.ready(function(){if(getFlashVersion()>=11){var flashplayerid=generateId();
fp11input=dom.createElement({position:"absolute",left:"-1000px",top:"50px",width:"10px","z-index":-1,cursor:"none"},{type:"text",id:flashplayerid,value:""},"input");var body=document.body||document.documentElement;body.appendChild(fp11input)}}),evt.on(window,"unload",function(){VisitorPing.flush()
}),namespace.resource=function(file){return crystal_args.file_path+file},namespace.resource_swf=function(file){return crystal_args.ext_path+file};var getExtension=namespace.getExtension=function(uri){try{return/\.(\w+)(?:$|\?|\#)/.exec(uri)[1].toLowerCase()
}catch(e){return"jpg"}},htmlEncode=function(){var el=document.createElement("pre");return function(str){return el.innerHTML="",el.appendChild(document.createTextNode(str)),el.innerHTML}}();namespace.getPlayIndex=function(){return parseInt(cookie.get("ad_play_index"))||Math.floor(100*Math.random())
};var display_index=namespace.getPlayIndex();cookie.set("ad_play_index",display_index+1,{expires:1,path:"/"});var queue=function(precondition){var preconditioned=!1,precondition_is_running=!1,fns=[];return function(fn){preconditioned?fn():(fns.push(fn),precondition_is_running||(precondition(function(){each(fns,function(f){f()
}),preconditioned=!0}),precondition_is_running=!0))}},afterImportExtension=queue(function(callback){crystal_args.is_debug&&(crystal_args.extension_js_src+="?_="+(new Date).getTime()),importScript(crystal_args.extension_js_src,callback)}),NONE=namespace.NONE=1,IMMEDIATELY=namespace.IMMEDIATELY=2,LAZY=namespace.LAZY=3,SELF_PING=namespace.SELF_PING=4,default_fodder_count=3,default_index=Math.floor(10*Math.random())%default_fodder_count,getDefaultFodderUrl=function(){var scales=[{scale:7.15,size:"960x90"},{scale:2.4,size:"409x114"},{scale:1,size:"300x250"},{scale:.5,size:"300x600"},{scale:0,size:"300x250"}],getScale=function(width,height){0==height&&(height=1);
for(var s=width/height,i=0;i<scales.length;i++)if(s>=scales[i].scale)return scales[i].size};return function(width,height){return format(namespace.resource("default_fodders/{scale}_{index}.swf?v=20130124"),{scale:getScale(width,height),index:default_index++%default_fodder_count})
}}(),getDefaultFodder=function(el){if(dom.hasClass(el,"has_qq_live_default_ad"))return getQqLiveDefaultFodder(el);var sw=parseInt(el.style.width),sh=parseInt(el.style.height),ow=el.offsetWidth,oh=el.offsetHeight,w=0!==ow||isNaN(sw)?ow:sw,h=0!==oh||isNaN(sh)?oh:sh;
return{resource_url:getDefaultFodderUrl(w,h),width:w,height:h,cover:!1}},getQqLiveDefaultFodder=function(el){return{resource_url:"http://adsrich.qq.com/web/default_fodders/qqliveDefault.jpg",width:el.offsetWidth,height:el.offsetHeight,cover:!0,link_to:"http://itunes.apple.com/cn/app/id458318329?mt=8"}
},getMulticlickurl=function(display_config,el){var initvars={};if(0!=display_config.click_prefix&&0!=display_config.click_content)for(var click_arr=display_config.click_content.split(","),i=0,len=click_arr.length;len>i;i++){var tmp=click_arr[i].split("|");initvars[tmp[0]]=display_config.click_prefix+"seq="+tmp[1]+"&loc="+(el.id||"")
}return initvars},getFodderCover=namespace.getFodderCover=function(el){var childNodes=el.childNodes;if(childNodes&&0!=childNodes.length)for(var len=childNodes.length,i=0;len>i;i++){var currrentChild=childNodes[i];if(dom.hasClass(currrentChild,"a_cover")&&currrentChild.getAttribute("rel"))return currrentChild;
var rt=arguments.callee(currrentChild);if(rt)return rt}},hasFilterInParent=function(el){try{var parent=el.parentNode;return parent?parent.style.filter?!0:hasFilterInParent(parent):!1}catch(e){return!1}},thirdPartyScriptRenderedOrder={},dic_display={third_party_script_plus:{ping:LAZY,render:function(config,el){if(config.fodder&&config.fodder[0]){var ru=config.fodder[0].resource_url,fileName=/.+\/(\w+\.\w+)(?:\?.+)?/g.exec(ru)[1],fileNameArray=fileName.split("."),newFileName=fileNameArray[0]+"_"+config.oid+"_"+config.cid+"."+fileNameArray[1];
config.fodder[0].resource_url=ru.replace(fileName,newFileName),renderFodder(config.fodder[0],el)}}},third_party_script:{ping:LAZY,render:function(config,el){"undefined"!=typeof config.display_config.noadicon&&"1"==config.display_config.noadicon?renderFodder(config.fodder[0],el):renderFodder(config.fodder[0],el,null,null,!0)
}},banner:{ping:LAZY,render:function(config,el){var resetbanner=function(el){for(;el.firstChild;)el.removeChild(el.firstChild)},preprocessFodder=function(config,el,fodder){config.display_config&&config.display_config.click_prefix&&config.display_config.click_content&&(fodder.initvars=namespace.mix(fodder.initvars,getMulticlickurl(config.display_config,el))),config.display_config&&1==config.display_config.support_api&&(fodder.initvars=namespace.mix(fodder.initvars,{token:namespace.getApitoken(config.oid,config.loc)}))
};config.dsp_id&&config.dsp_name&&(config.fodder[0].private_link=config.private_link,config.fodder[0].dsp_name=config.dsp_name.length>8?config.dsp_name.substr(0,8):config.dsp_name,config.fodder[0].privateTag=!0,config.fodder[0].oid=config.oid);var sufprocessBanner=function(config,el,fodder){config.display_config&&"center"===config.display_config.loc_pos&&(el.style.width=fodder.width+"px",el.style.marginLeft="auto",el.style.marginRight="auto"),config.display_config&&1==config.display_config.private_setting&&evt.on(el,"mouseover",function(){var icon=dom.$("private_setting_"+config.oid);
if(!icon){icon=createIcon("private_setting",config.display_config.icon_location||"rt","20px","20px",{title:"\u9690\u79c1\u8bbe\u7f6e",link_to:"http://setting.snswin.qq.com"}),icon.id="private_setting_"+config.oid,el.appendChild(icon);var hideIcon=function(){return setTimeout(function(){el.removeChild(icon)
},3e3)},timer1=hideIcon();evt.on(icon,"mouseover",function(){clearTimeout(timer1)}),evt.on(icon,"mouseout",function(){timer1=hideIcon()})}});var displayConfig=config.display_config,isCover=fodder?fodder.cover:!1,coverElement=getFodderCover(el);coverElement&&Cps.registerClick(el,coverElement,config),displayConfig&&1==displayConfig.support_api&&isCover&&coverElement&&evt.on(coverElement,"click",function(){sendPing(namespace.sns_pingurl(config,"banner_click"))
}),displayConfig&&"_self"===displayConfig.target&&coverElement&&(coverElement.target=""),displayConfig&&displayConfig.pLink&&coverElement&&(coverElement.href="",coverElement.target="",evt.on(coverElement,"click",function(event){event.preventDefault?event.preventDefault():event.returnValue=!1;
try{{new ActiveXObject("QQGAMEDETECT.QQGameDetectCtrl.1")}window.location=displayConfig.pLink}catch(e){window.open(fodder.link_to,"_blank")}})),dom.hasClass(el,"check_double_filter")&&isCover&&coverElement&&hasFilterInParent(coverElement)&&(coverElement.style.backgroundColor="",coverElement.style.filter="",coverElement.style.opacity="")
};config.fodder[0]&&(config.fodder[0].display="banner");var banner_flag={index_above:!1,index_below:!1},render=function(config){var base_width=namespace.dom.getViewportWidth();if(base_width>=config.display_config.critical){var index=config.display_config.index_above;
if(banner_flag.index_above)return;banner_flag={index_above:!0,index_below:!1}}else{var index=config.display_config.index_below;if(banner_flag.index_below)return;banner_flag={index_above:!1,index_below:!0}}resetbanner(el),preprocessFodder(config,el,config.fodder[index]),renderFodder(config.fodder[index],el,null,null,!0),sufprocessBanner(config,el,config.fodder[index])
};config.display_config&&config.display_config.critical?(render(config),evt.on(window,"resize",function(){"undefined"!=typeof namespace.banner_timer&&clearTimeout(namespace.banner_timer),namespace.banner_timer=setTimeout(function(){render(config)},300)})):(preprocessFodder(config,el,config.fodder[0]),renderFodder(config.fodder[0],el,config.icon,"rb",!0),sufprocessBanner(config,el,config.fodder[0]))
}},banner_double:{ping:IMMEDIATELY,render:function(config,el){var banner_double_flag={index_above:!1,index_below:!1},render=function(){var base_width=namespace.dom.getViewportWidth();if(base_width>=config.display_config.critical){var index=config.display_config.index_above;
if(banner_double_flag.index_above)return;banner_double_flag={index_above:!0,index_below:!1}}else{var index=config.display_config.index_below;if(banner_double_flag.index_below)return;banner_double_flag={index_above:!1,index_below:!0}}"undefined"!=typeof config.display_config.noadicon&&"1"==config.display_config.noadicon?renderFodder(config.fodder[index],el):renderFodder(config.fodder[index],el,null,null,!0)
};render(),evt.on(window,"resize",function(){"undefined"!=typeof namespace.banner_double_timer&&clearTimeout(namespace.banner_double_timer),namespace.banner_double_timer=setTimeout(function(){render()},300)})}},auto:{ping:IMMEDIATELY,render:function(config,el){el.style.overflow="hidden",renderFodder(getDefaultFodder(el),el,null,null,!0)
}},"default":{ping:NONE,render:function(config,el){el.style.overflow="hidden",renderFodder(getDefaultFodder(el),el,null,null,!0)}},"null":{ping:IMMEDIATELY,render:function(){}},banner_script_src:{ping:IMMEDIATELY,render:function(config,el){renderFodder(config.fodder[0],el),importScript(config.fodder[1].resource_url)
}},banner_import_monitor_url:{ping:IMMEDIATELY,render:function(config,el){renderFodder(config.fodder[0],el),importScript(config.monitor_url)}},h_banner:{ping:SELF_PING,render:function(){function contains(p,c){return p.contains?p!=c&&p.contains(c):!!(16&p.compareDocumentPosition(c))
}function fixedMouse(e,target){var related,type=e.type.toLowerCase();if("mouseover"==type)related=e.relatedTarget||e.fromElement;else{if("mouseout"!=type)return!0;related=e.relatedTarget||e.toElement}return related&&"xul"!=related.prefix&&!contains(target,related)&&related!==target
}function HBanner(adData,sendPv){this.adData=adData,this.sendPv=sendPv}var IeWindowResizeHook={originalHeight:window.innerHeight||document.documentElement.clientHeight,originalWidth:window.innerWidth||document.documentElement.clientWidth,isResize:function(){var h=window.innerHeight||document.documentElement.clientHeight,w=window.innerWidth||document.documentElement.clientWidth;
return this.originalHeight!=h||this.originalWidth!=w?(this.originalHeight=h,this.originalWidth=w,!0):!1}},CurrentPageAdMap={};window[lib_name].adRequesterCallback=function(adDataArray){var adData=adDataArray[0][0],elId=adData.loc,currentHBanner=CurrentPageAdMap[elId],sendPv=function(adData){var ping_data={loc:adData.loc,cid:adData.cid||0,oid:adData.oid||0,aver:adData.aver||0,soid:adData.soid||0,ping:adData.ping,pri:adData.pri||0,tango:adData.tango||0,dtype:adData.dtype||0,targetid:adData.targetid||0,pctr:adData.pctr||0,btoid:adData.btoid||0,btpri:adData.btpri||0,extstr:adData.extstr||""};
ping_data.dtype>=1&&(ping_data.keywordIds=""!==adData.keywordIds?adData.keywordIds:"",ping_data.whiteListId=""!==adData.whiteListId?adData.whiteListId:"",ping_data.ArticleId=""!==adData.ArticleId?adData.ArticleId:""),VisitorPing.append(ping_data);var monitor_pv_delay=1e3;
adData.monitor_url&&setTimeout(function(){VisitorPing.touch(adData.monitor_url,!0)},monitor_pv_delay),adData.ext_monitor_url&&setTimeout(function(){var ping_list=adData.ext_monitor_url.split(" ");ping_list=ping_list.slice(0,3);for(var i=0,len=ping_list.length;len>i;i++)ping_list[i].indexOf("http://")>-1&&VisitorPing.touch(ping_list[i],!0)
},monitor_pv_delay)};currentHBanner?(currentHBanner.destroy(),CurrentPageAdMap[elId]=new HBanner(adData,sendPv),CurrentPageAdMap[elId].init()):(CurrentPageAdMap[elId]=new HBanner(adData,sendPv),CurrentPageAdMap[elId].init())};var AdRequester={request:function(elId){var lviewUrl=format(crystal_args.lview_template,{loc:elId}),rotParam="&rot=1&ri=hb_"+elId;
importScript(lviewUrl+"&callback="+lib_name+".adRequesterCallback"+rotParam+collectInfo(1),function(){},crystal_args.charset)}};return HBanner.prototype.init=function(){var adData=this.adData;this.adLocationEl=document.getElementById(adData.loc),this.pvCounter=0;
var self=this;if(!this.isNullOrder()){var adContent=document.createElement("div"),picTop=parseInt(dom.getStyle(document.getElementById("picWrap"),"top")),picTop=isNaN(picTop)?9:picTop,closeButton=this.closeButton=dom.createElement({position:"absolute",top:0,right:0,margin:picTop+2+"px 2px 0 0","z-index":100},{src:namespace.resource("takeover_close.gif")},"img");
renderFodder(adData.fodder[0],adContent),dom.setStyle(this.adLocationEl,{display:"none",zIndex:100}),this.adLocationEl.appendChild(adContent),this.adLocationEl.appendChild(closeButton),this.adLocationEl.appendChild(namespace.createAdIcon()),this.addCover(),evt.on(this.adLocationEl,"mouseover",function(e){fixedMouse(e,self.adLocationEl)&&self.removeCover()
}),evt.on(this.adLocationEl,"mouseout",function(e){fixedMouse(e,self.adLocationEl)&&self.addCover()}),evt.on(closeButton,"click",function(){self.close()})}this.resizeFunction=function(){self.resize()},evt.on(window,"resize",this.resizeFunction),setTimeout(function(){var i=hdPic.fn._getUrl()+"";
"1"!==i&&"0"!==i&&self.show()},1e3),namespace.setArea(this.adData.loc,{show:function(){self.show()},hide:function(){self.hide()}})},HBanner.prototype.destroy=function(){this.resizeFunction&&evt.un(window,"resize",this.resizeFunction),this.adLocationEl&&(namespace.clearArea(this.adData.loc),dom.setStyle(this.adLocationEl,{display:"none"}),this.adLocationEl.innerHTML="")
},HBanner.prototype.addCover=function(){var cover=document.getElementById("mengban_"+this.adData.loc);cover||(cover=document.createElement("div"),dom.setStyle(cover,{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:"0.5",filter:"alpha(opacity=50)",backgroundColor:"white"}),cover.id="mengban_"+this.adData.loc,this.adLocationEl.appendChild(cover))
},HBanner.prototype.removeCover=function(){var cover=document.getElementById("mengban_"+this.adData.loc);cover&&this.adLocationEl.removeChild(cover)},HBanner.prototype.isNullOrder=function(){return this.adData.oid+""=="1"?!0:!1},HBanner.prototype.show=function(){if(this.is1stOrLast=!1,this.canBeShowed()){if(0===this.pvCounter)this.sendPv&&this.sendPv(this.adData);
else if(10===this.pvCounter)return void AdRequester.request(this.adData.loc);this.pvCounter++;var self=this;setTimeout(function(){if(!self.isNullOrder()){var picTop=parseInt(dom.getStyle(self.sizeReferenceEl,"top")),picTop=isNaN(picTop)?9:picTop,picHeight=dom.getStyle(self.sizeReferenceEl,"height");
dom.setStyle(self.adLocationEl,{display:"block",height:picHeight,paddingTop:picTop+"px"}),self.closeButton&&dom.setStyle(self.closeButton,{margin:picTop+2+"px 2px 0 0"})}self.resizeLock=!1},300)}},HBanner.prototype.close=function(){dom.setStyle(this.adLocationEl,{display:"none"}),this.closeTimeCookieName||(this.closeTimeName="hbanner"+this.adData.loc),DataStorage.setItem(this.closeTimeCookieName,(new Date).getTime(),1440)
},HBanner.prototype.isClosedWithinTime=function(){this.closeTimeCookieName||(this.closeTimeName="hbanner"+this.adData.loc);var closeTime=parseInt(DataStorage.getItem(this.closeTimeCookieName)||0),intervalTime=(new Date).getTime()-closeTime,minIntervalTime=72e5;
return intervalTime>minIntervalTime?!1:!0},HBanner.prototype.isSizeQualified=function(){this.sizeReferenceEl||(this.sizeReferenceEl=document.getElementById("picWrap"));var size=parseInt(dom.getStyle(this.sizeReferenceEl,"height"));return isNaN(size)||500>size?!1:!0
},HBanner.prototype.getIs1stOrLast=function(){return this.is1stOrLast},HBanner.prototype.hide=function(){dom.setStyle(this.adLocationEl,{display:"none"}),this.is1stOrLast=!0},HBanner.prototype.canBeShowed=function(){return!this.isClosedWithinTime()&&this.isSizeQualified()
},HBanner.prototype.resize=function(){if(!ua.ie||IeWindowResizeHook.isResize()){var self=this;setTimeout(function(){if(self.isSizeQualified()){if(self.canBeShowed()&&!self.getIs1stOrLast()&&!self.resizeLock)if(self.resizeLock=!0,self.resizeHidePage===hdPic.fn._pageNow){var picTop=parseInt(dom.getStyle(self.sizeReferenceEl,"top")),picTop=isNaN(picTop)?9:picTop,picHeight=dom.getStyle(self.sizeReferenceEl,"height");
dom.setStyle(self.adLocationEl,{display:"block",height:picHeight,paddingTop:picTop+"px"}),self.closeButton&&dom.setStyle(self.closeButton,{margin:picTop+2+"px 2px 0 0"}),self.resizeLock=!1}else self.show()}else dom.setStyle(self.adLocationEl,{display:"none"}),self.resizeHidePage=hdPic.fn._pageNow
},1e3)}},namespace.shutongRequest=function(loc){AdRequester.request(loc)},function(){}}()},text:{ping:NONE,render:function(config,el,area_id,ping){if(config.need_ping&&ping(),59===config.oid){var html="<a class='w-l-qq-com'"+config.olink+">"+config.fodder[0]+"</a>";
el.id="",el.innerHTML=html,evt.on(el.childNodes[0],"click",function(){var url="http://c.l.qq.com/lclick?loc="+config.loc+"&oid=59&index="+config.index+"&pv_type=1&exp=1&page_type="+PageType(location.href)+"&chl="+channel;namespace.ping.touch(url)})}else{var fodders=config.fodder,html=fodders[0],url=fodders[1],color=fodders[2],prefix=fodders[3]||"",style=fodders[4]||"",a=document.createElement("a");
a.className=el.className,a.target="_blank",a.href=url,a.style.cssText=style,color&&(a.style.color=color),a.innerHTML=prefix+html,el.parentNode.replaceChild(a,el)}dom.$(area_id)&&arguments.callee(config,dom.$(area_id),area_id,ping)}},richtext:{ping:IMMEDIATELY,render:function(config,el){var fodders=config.fodder,html=fodders[0],url=fodders[1],color=fodders[2],a=document.createElement("a");
a.target="_blank",a.href=url,color&&(a.style.color=color),a.innerHTML=html,el.parentNode.replaceChild(a,el),dom.setStyle(el,{height:"12px"})}},banner_text:{ping:IMMEDIATELY,render:function(config,el){var picFodder=config.fodder[0],textFodder=config.fodder[1],textLinkUrl=picFodder.link_to;
textLinkUrl.indexOf("?")>-1?textLinkUrl.lastIndexOf("&")===textLinkUrl.length-1?(picFodder.link_to=picFodder.link_to+"clicktype=1",textLinkUrl+="clicktype=2"):(picFodder.link_to=picFodder.link_to+"&clicktype=1",textLinkUrl+="&clicktype=2"):(picFodder.link_to=picFodder.link_to+"?clicktype=1",textLinkUrl+="?clicktype=2"),renderFodder(picFodder,el);
var textWrapper=document.createElement("div"),textLink=document.createElement("a"),text=textFodder.text_content;textLink.href=textLinkUrl+collectInfo(1),textLink.target="_blank",textLink.innerHTML=text;var displayConfig=config.display_config,text_position=displayConfig.text_position,textStyle=textFodder.style;
if(textStyle){for(var textStyleAry=textStyle.split(";"),slen=textStyleAry.length,textStyleObj={},i=0;slen>i;i++){var currentStyleStr=textStyleAry[i],currentStylePair=currentStyleStr.split(":");textStyleObj[currentStylePair[0]]=currentStylePair[1]}dom.setStyle(textLink,textStyleObj)
}else dom.setStyle(textLink,{paddingBottom:"3px",lineHeight:"1.5",textDecoration:"none",textSize:"16px",background:"url(http://img1.gtimg.com/fashion/pics/hv1/252/73/1392/90533667.png) repeat-x left bottom"});switch(text_position){case"belowBanner":default:dom.setStyle(textWrapper,{position:"absolute",left:"0px",width:"100%",bottom:"-27px",textAlign:"center"})
}textWrapper.appendChild(textLink),el.appendChild(textWrapper)}},script_src:{ping:NONE,render:function(config,el,area_id,ping){importScript(config.fodder[0].resource_url),ping()}},adbox:{ping:NONE,render:function(config,el,el_id,ping){var v=config.fodder[0].version;
namespace.importScript(config.fodder[0].resource_url+"?v="+v,function(){var fn=namespace["adbox_"+config.oid],fn1=namespace.adbox_ADBOXCALLBACK,fn2=namespace["adbox_"+config.oid+"_"+config.cid];fn2?fn2(config,el,el_id,ping):fn1?fn1(config,el,el_id,ping):fn&&fn(config,el,el_id,ping)
},"utf8")}},custom_script:{ping:IMMEDIATELY,render:function(config){var fodder1=config.fodder[0],scriptUrl=fodder1.resource_url,splitScriptUrl=scriptUrl.split(".");splitScriptUrl.length>0&&"js"!==splitScriptUrl[splitScriptUrl.length-1]&&(scriptUrl+=".js"),document.write('<script id="'+config.cid+'">window.CLICKURL="'+fodder1.link_to+'";</script>'),document.write('<script src="'+scriptUrl+'"></script>')
}}},display_buffer={},NO_AD={},lazyRender;!function(){var event_attached=!1,areas={},ping_effect_height=crystal_args.ping_effect_height,pre_load_offset=crystal_args.pre_load_offset,max_used_height=0,_checkRender=function(force_recalculate){var used_height=dom.getDocumentScrollTop()+dom.getViewportHeight();
if(force_recalculate||!(max_used_height>=used_height)){max_used_height=used_height;var rendered_ids=[];each(areas,function(o,id){if(force_recalculate||!o.y){var xy=dom.getXY(o.el);o.y=xy[1]}o.y<=used_height+pre_load_offset&&(o.rendered||(o.render(),o.rendered=!0)),o.y<=used_height-ping_effect_height&&(o.pinged||(o.ping(),o.pinged=!0)),o.pinged&&o.rendered&&rendered_ids.push(id)
}),each(rendered_ids,function(id){delete areas[id]});var no_area=!0;each(areas,function(){no_area=!1}),no_area&&(evt.un(window,"resize",checkRender),evt.un(window,"scroll",checkRender),event_attached=!1)}},checkRender=function(){_checkRender(!1)};namespace.forceCheckRender=function(){_checkRender(!0)
};var bufferCheckRender=buffer(function(){event_attached||(checkRender(),evt.on(window,"resize",checkRender),evt.on(window,"scroll",checkRender),event_attached=!0)},100);namespace.renderAll=function(){each(areas,function(o){o.rendered||(o.render(),o.rendered=!0)
}),areas={},evt.un(window,"resize",checkRender),evt.un(window,"scroll",checkRender),event_attached=!1},lazyRender=function(id,render,ping){areas[id]={el:dom.$(id),render:render,rendered:!1,ping:ping,pinged:!1},bufferCheckRender()}}();var rendered_area={},in_reqeusting_ids={},renderArea=function(creativity_config,area_id,not_retry){var area=dom.$(area_id);
if(!area)return void(not_retry||evt.ready(function(){renderArea(creativity_config,area_id,!0)}));var render_type=0;area.setAttribute("oid",creativity_config.oid),area.setAttribute("display",creativity_config.display),area.getAttribute("immediately")&&(render_type=IMMEDIATELY);
var display_handler=namespace.getDisplayHandler(creativity_config.display),pingArea=function(pv_type){var posconvert=area_id.indexOf("SLOT");posconvert>-1&&(area_id=area_id.substr(0,posconvert));var blackping=[],ping_data={loc:area_id,cid:creativity_config.cid||0,oid:creativity_config.oid||0,aver:creativity_config.aver||0,soid:creativity_config.soid||0,ping:creativity_config.ping,pri:creativity_config.pri||0,exp:"0"===pv_type?0:1,pv_type:creativity_config.pv_type||1,tango:creativity_config.tango||0,dtype:creativity_config.dtype||0,targetid:creativity_config.targetid||0,pctr:creativity_config.pctr||0,btoid:creativity_config.btoid||0,btpri:creativity_config.btpri||0,extstr:creativity_config.extstr||"",index:creativity_config.index||1,chl:creativity_config.chl||0};
-1==indexOf(blackping,creativity_config.display)&&VisitorPing.append(ping_data);var monitor_pv_delay=1e3;("1"===creativity_config.pv_type||"0"===pv_type)&&(creativity_config.third_send||(creativity_config.monitor_url&&setTimeout(function(){VisitorPing.touch(creativity_config.monitor_url,!0)
},monitor_pv_delay),creativity_config.ext_monitor_url&&setTimeout(function(){var ping_list=creativity_config.ext_monitor_url.split(" ");ping_list=ping_list.slice(0,3);for(var i=0,len=ping_list.length;len>i;i++)ping_list[i].indexOf("http://")>-1&&VisitorPing.touch(ping_list[i],!0)
},monitor_pv_delay),creativity_config.third_send=!0))},render=function(){display_handler.render(creativity_config,area,area_id,pingArea),creativity_config.plugins&&afterImportExtension(function(){namespace.addPlugins(creativity_config.plugins,creativity_config,area,area_id)
})},render_type=render_type||display_handler.ping;switch(crystal_args.lazy_render||render_type!=LAZY||(render_type=IMMEDIATELY),render_type){case IMMEDIATELY:render(),pingArea();break;case LAZY:lazyRender(area_id,render,pingArea);break;case SELF_PING:render();
break;case NONE:render()}(area_id.indexOf(":")>-1||"F_Rectangle_N"===area_id)&&(crystal_args.hasViewed[area_id]||viewer.addLoc(creativity_config,area_id,{50:-1},function(){pingArea("0")}))},buildDefaultCreativityConfig=function(area_id){var el=dom.$(area_id);
return el&&"none"!=dom.getStyle(el,"display")?{display:"auto",oid:89,cid:0}:NO_AD},clearAd=function(creativity_config,area_id){var e=document.getElementById(area_id);e&&(e.innerHTML="")},renderBuffer=function(){each(arguments,function(area_id){rendered_area[area_id]||display_buffer[area_id]||(display_buffer[area_id]=buildDefaultCreativityConfig(area_id))
}),each(display_buffer,function(creativity_config,area_id){if(!rendered_area[area_id]&&("weibo"!=crystal_args.runat&&(dom.$(area_id)&&"1"==dom.$(area_id).getAttribute("rerender")?!1:rendered_area[area_id]=!0),creativity_config!==NO_AD)){var display=creativity_config.display;
namespace.display_orders=[],dic_display[display]?renderAdapter(creativity_config,area_id):afterImportExtension(function(){renderAdapter(creativity_config,area_id)}),dom.$(area_id)&&"1"==dom.$(area_id).getAttribute("rerender")||delete display_buffer[area_id]
}})},order