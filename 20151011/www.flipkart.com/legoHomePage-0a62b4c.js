if(typeof(FKART)=="undefined"){FKART={}}FKART.AppOffer=new function(){var a=[],b=[];this.clearList=function(){a=[];b=[];fk_appoffer.updateTopBanner()};this.addAppOnly=function(c){if(a.indexOf(c)==-1){a.push(c);fk_appoffer.updateTopBanner()}};this.addOpenFsn=function(c){if(b.indexOf(c)==-1){b.push(c);fk_appoffer.updateTopBanner()}};this.updateTopBanner=function(){var e=$("#fk-header"),f=$(".fk-header-banner"),d=$(".apponly-text-some",f),g=$(".apponly-text-all",f),c=$(".apponly-text-default",f);if(a.length===0&&c.length===0){e.removeClass("banner-open");f.slideUp("slow")}else{if(!e.hasClass("banner-open")){e.addClass("banner-open");f.slideDown("slow")}if(a.length===0){d.hide();g.hide();c.show()}else{if(b.length===0){d.hide();g.show();c.hide()}else{d.show();g.hide();c.hide()}}}};this.updateUrl=function(){$(".fk-header-banner .app-link, .product-openx-ad .app-link, .facetList .app-link").data("url",window.location.pathname+window.location.search);$(".fk-header-banner .app-link, .product-openx-ad .app-link, .facetList .app-link").data("title",document.title);var c=$(".fk-header-banner .app-link");if((c.length===0||!c.data("query")||c.data("query").length===0)&&FKART.urlParser().get("sid")=="undefined"){c.hide()}else{c.show()}}};fk_appoffer=FKART.AppOffer;FKART.appOfferPopup=function(aK){var X=$(aK),x=$(".app-link",X),P=$(".app-offers-button",X),ap=$(".app-offers-container",X),aw=$(".appOnlyDialog-popup-content",X),Z=$(".fk-question-mark",X),z,aI,aG,a4,ad,a6,aH,H,e,q,t,C,ao,M,aU,av,aT,L,Y,o,b,ag,v,a2,d,E=false,ak,n,aq,aW=false,aS,aM,aB,a1,h,ay,aa,k,ai,T,l,a,f,V,aY=false,a0,g,aQ,ah,A,F,G,I,al,aV,R,aj,ac,aP,U,p,aJ,a3,K="",an="",O=false,at=false,J,aA;if(aw.length==0){aw=$("#fk-header .appOnlyDialog-popup-content")}if(aw.length==0){aw=$(".fk-mainfooter .appOnlyDialog-popup-content")}if(aw.length==0){aw=$(".appOnlyDialog-popup-content.forcedView")}function c(){P.on("click",function(){if(!O){aZ("Opened");$(this).addClass("open");Z.text("X");setTimeout(function(){ap.slideDown(200);O=true},150)}else{aZ("Closed");ap.slideUp(200,function(){P.removeClass("open");Z.text("?");O=false})}});x.on("click",function(a7){if(!x.hasClass("disabled")){u($(this));aZ("Clicked");a5();a7.preventDefault()}})}function a5(){v=null;m();N();aR();r();W();if(!FKART.login.isUserLoggedIn()){M.hide();aL()}else{if(aW==true){M.show();z.hide();U=setTimeout(function(){E=true;$.ajax({url:"/lc/sendPushNotificationForAccount",data:{pid:a0,lid:g,sid:aQ,query:ah,offerid:V,title:A,subtitle:F,vertical:G,url:I,useDataUrl:aY},type:"POST",dataType:"json",success:function(a7){if(a7.deviceFound&&a7.notificationSent){aN()}else{aE()}},error:function(){aE()}})},7000)}else{aL();ar()}}}function ar(){$.ajax({url:"/lc/sendPushNotificationForAccount",data:{pid:a0,lid:g,sid:aQ,query:ah,offerid:V,title:A,subtitle:F,vertical:G,url:I,useDataUrl:aY},type:"POST",dataType:"json"})}function aZ(a8){var a7={};if(a8=="Clicked"){a7.products=s.products}var a9=new Array("eVar1","eVar2","eVar3","eVar4","eVar5","eVar11","eVar50","eVar55","eVar68","prop1","prop2","prop3","prop4","prop20","prop35");for(i in a9){if(typeof s[a9[i]]!="undefined"){a7[a9[i]]=s[a9[i]]}if((a9[i]=="eVar55"||a9[i]=="eVar11")&&al){a7[a9[i]]=al}if((a9[i]=="eVar68"||a9[i]=="prop20")&&aV){a7[a9[i]]=aV}}a7.prop21="OpenInApp_"+a8;FKART.omni.customEvent("App only offers",a7)}function aN(){r();M.hide();if(R&&R.length>0){var a7=$("<img>");a7.attr("src",R);a6.append(a7)}else{a6.remove()}aI.show();aC();aZ("PNSent")}function aE(){r();M.hide();aH.show();aZ("PNFailed")}function W(){v=new FKART.ui.Dialog({showFooter:false,cssClass:"appOnlyDialog",body:aw.html(),destroyOnHide:true,width:"620px"});d=v.getContainer();M=d.find(".loadingDiv");z=d.find(".smsDiv");aI=d.find(".successDiv");aG=z.find(".stitle");ad=z.find(".footerLoggedIn");a4=z.find(".footerNotLoggedIn");a6=aI.find(".phone-image span");aS=d.find(".smsForm");a2=d.find(".successPrefixDiv");aH=d.find(".errorDiv");aU=d.find(".send-sms-fake-link");av=d.find(".send-otp-fake-link");aT=d.find(".send-sms-link");L=d.find(".send-otp-link");Y=d.find(".resend-sms-fake-link");o=d.find(".resend-otp-fake-link");b=d.find(".resend-sms-link");ag=d.find(".resend-otp-link");p=d.find(".timer");aJ=d.find(".timerResendSMS");a3=d.find(".timerResendOTPSMS");ak=d.find(".retry-notification");J=d.find(".otpForm");v.show();if(!FKART.login.isUserLoggedIn()){a4.show();ad.hide()}else{a4.hide();ad.show()}aF()}function aF(){d.on("beforeHide",function(a7){m();N();aR();r()});aT.on("click",function(){aI.hide();a2.show();aH.hide();aG.remove();aL();aZ("PNExpired")});L.on("click",function(){af();aI.hide();a2.show();aH.hide();aG.remove();aL();aZ("PNExpired")});ak.on("click",function(){v.hide();aW=true;a5();$status="PNTried";if(E){$status="PNReTried"}aZ($status)})}function ax(){ai=k.val();a=a1.val();$.ajax({url:"/lc/sendSMSForNumber",type:"POST",data:{pid:a0,lid:g,sid:aQ,query:ah,offerid:V,title:A,subtitle:F,vertical:G,url:I,phoneNumber:ai,useDataUrl:aY,marketingSMS:a},dataType:"json",success:function(a7){if(a7.smsStatus){aO()}else{aD()}},error:function(){aD()}})}function y(a7){return a7}function am(){l=f.val();$.ajax({url:"/lc/verifyOtp",type:"POST",data:{user_id:ai,otp_key:K,otp:l},dataType:"html",success:function(a7){a7=JSON.parse(a7);if(a7.isOtpVerified=="1"){at=true;FKART.utils.localStorage.setObject("verifiedPhoneNumbers",{phoneNumbers:aA.phoneNumbers+T+"|"});ax()}else{ab()}},error:function(){ab()}})}function af(){ai=k.val();$.ajax({url:"/lc/generateOtp",type:"POST",data:{userId:ai},dataType:"html",success:function(a7){a7=JSON.parse(a7);if(a7.error_code=="1004"){B()}else{K=a7.otp_key;au()}},error:function(){ab()}})}function S(){ai=k.val();$.ajax({url:"/lc/getVerifiedPhoneNumber",type:"POST",data:{phoneNumber:ai},dataType:"html",success:function(a7){a7=JSON.parse(a7);if(a7.verifiedPhoneNumber){ax();aZ("SMSTried");event.preventDefault()}else{T=y(ai);if(aA.phoneNumbers.indexOf(T)<=-1){if(a1.val()=="false"){af()}else{ax();aZ("SMSTried")}}else{ax();aZ("SMSTried")}event.preventDefault()}},error:function(){D()}})}function aO(){N();aR();aG.hide();h.hide();ay.hide();aS.hide();J.hide();aa.html(ai);H.show();e.hide();Y.show();b.hide();j();aZ("SMSSent")}function aD(){N();aR();e.hide();aG.hide();h.hide();ay.hide();aS.hide();aH.hide();aa.html(ai);ao.show();aZ("SMSFailed")}function ab(){aR();N();aG.hide();h.hide();ay.hide();aS.hide();aH.hide();aa.html(ai);e.hide();q.show();aZ("OTPFailed")}function D(){N();aR();aG.hide();h.hide();ay.hide();aS.hide();aH.hide();e.hide();q.hide();C.show();aZ("SMSFailed")}function au(){aR();N();aG.hide();h.hide();ay.show();J.show();aS.hide();aa.html(ai);e.show();o.show();ag.hide();ae();aZ("OTPSent")}function B(){t.show();aG.hide();h.hide();ay.hide();J.hide();aS.hide();aa.html(ai);e.hide();o.hide();ag.hide();aZ("OTPFailed")}function aL(){k=aS.find(".phoneNumber");f=J.find(".otp-field");ai=FKART.login.userPhoneNumber;k.val(ai);aB=aS.find("input[type=button]");aM=J.find("input[type=button]");a1=z.find("#marketingSMS");h=z.find(".infoDiv");ay=z.find(".otpTitle");aG=z.find(".stitle");H=z.find(".smsSuccessDiv");e=z.find(".otpSuccessDiv");q=z.find(".otpErrorDiv");t=z.find(".otpErrorMsgDiv");C=z.find(".otpSendErrorDiv");ao=z.find(".smsErrorDiv");n=z.find(".retry-sms");aq=z.find(".retry-otp");aa=z.find(".phone_number");z.show();J.hide();ay.hide();v.reposition();Q()}function Q(){aB.on("click",function(a7){ai=k.val();if(!(/^[789]\d{9}$/.test(ai))){k.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}if(FKART.login.isUserLoggedIn()){S();a7.preventDefault()}else{T=y(ai);if(aA.phoneNumbers.indexOf(T)<=-1){if(a1.val()=="false"){af();aZ("OTPTried")}else{ax();aZ("SMSTried")}}else{ax();aZ("SMSTried")}a7.preventDefault()}});aM.on("click",function(a7){l=f.val();if(!(/^[0-9]{4,6}$/.test(l))){f.addClass("error").val("").attr("placeholder","Invalid OTP").focus();return}else{am();aG.hide();H.hide();h.hide();ao.hide();e.hide();ay.hide();J.hide();aZ("SMSTried");a7.preventDefault()}});n.on("click",function(){N();aR();aJ.html("45");a3.html("60");aG.hide();H.hide();h.hide();aS.hide();ao.hide();ax();aZ("SMSReTried")});aq.on("click",function(){aR();N();af();aJ.html("45");a3.html("60");ay.show();H.hide();J.show();ao.hide();aZ("SMSReTried")})}function m(){clearInterval(aj);aj=null}function N(){clearInterval(ac);ac=null}function aR(){clearInterval(aP);aP=null}function r(){clearInterval(U);U=null}function aC(){aj=setInterval(function(){var a7=parseInt(p.html());if(a7==0){m();aU.hide();aT.show()}p.html(a7-1)},1000)}function j(){ac=setInterval(function(){var a7=parseInt(aJ.html());if(a7==0){N();aR();Y.hide();b.show()}aJ.html(a7-1)},1000)}function ae(){aP=setInterval(function(){var a7=parseInt(a3.html());if(a7==0){aR();N();o.hide();ag.show()}a3.html(a7-1)},1000)}function w(a8,a7){if(a8.indexOf("?")!==-1){var bb=a8.split("?")[1];var ba=bb.split("&");for(var a9=0;a9<ba.length;a9++){var bc=ba[a9].split("=");if(bc[0]==a7){return bc[1]}}}}function aX(){var a7=FKART.urlParser().get("sid");if(a7!="undefined"){return a7}}function u(a7){R=a7.data("image");if(a7.data("pid")){a0=a7.data("pid").toString();G=a7.data("vertical");if(a7.data("lid")){g=a7.data("lid").toString()}V=a7.data("offerid")}else{ah=a7.data("query");aQ=aX();if(aQ){G=("BROWSE_"+aQ).toUpperCase()}else{if(a7.data("vertical")){G=a7.data("vertical")}else{G="BROWSE_SEARCH"}}if(a7.data("url")){a0=w(a7.data("url"),"pid");aQ=w(a7.data("url"),"sid");V=w(a7.data("url"),"offer");if(w(a7.data("url"),"p[]")||a7.data("url").indexOf("/~")){aY=true}}A=a7.data("title");F=a7.data("subtitle");I=a7.data("url");if(a7.attr("href")){al=w(a7.attr("href"),"icmpid");aV=w(a7.attr("href"),"otracker")}}aW=false;E=false;aA=FKART.utils.localStorage.getObject("verifiedPhoneNumbers")||{phoneNumbers:"|"}}function az(){c()}az()};register_controller("AppOffersCtrl",function(a){FKART.appOfferPopup(a)});FKART.showShutDownPopup=function(c){var b=(new Date()).getTime(),e=FKART.utils.localStorage.getObject("sdPopDetails")||{};function d(g){var f=new FKART.ui.Dialog({header:"Flipkart System Message",showFooter:false,body:c,cssClass:"desk-shut"});FKART.utils.localStorage.setObject("sdPopDetails",{timeStamp:g});f.show()}if(!jQuery.isEmptyObject(e)){var a=e.timeStamp+(24*60*60*1000);if(a<b){d(b)}}else{d(b)}};register_controller("ShutDownPopCtrl",function(a){FKART.showShutDownPopup(a)});FKART.appDownloadPopup=function(P){var u=$(P),r=$(".app-download",u),G,V,A,W,w,L,ac,ae,b,B,j,F,I,k,U,z,K,y,J,l,M,E=false,n="title",Y="subtitle",ad,X,v,a,N,D,m,d=false;function q(){r.click(function(af){if(!r.hasClass("disabled")){g("Clicked");R($(this));t();af.preventDefault()}})}function t(){ae=null;Z();f()}function g(ag){var af={};if(ag=="Clicked"){af.products=s.products}af.prop21="OpenInApp_"+ag;FKART.omni.customEvent("App only offers",af)}function H(){h();if(ad&&ad.length>0){var af=$("<img>");af.attr("src",ad);V.append(af)}else{V.remove()}C();g("PNSent")}function Q(){h();f();g("PNFailed")}function Z(){ae=new FKART.ui.Dialog({showFooter:false,cssClass:"appDownloadDialog",body:$(".appDownloadDialog-popup-content").html(),destroyOnHide:true,width:"620px"});b=ae.getContainer();w=b.find(".headerDiv");G=b.find(".smsDiv");F=b.find(".smsForm");L=b.find(".send-sms-fake-link");ac=b.find(".send-sms-link");m=b.find(".timer");B=b.find(".retry-notification");ae.show();e()}function e(){b.on("beforeHide",function(af){ab();h();E=false});ac.click(function(){f();g("PNExpired")});B.click(function(){ae.hide();t();g("PNReTried")})}function T(){l=J.val();if(!(/^[789]\d{9}$/.test(l))){J.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}else{$.ajax({url:"/lc/sendAppDownloadSMS",type:"POST",data:{title:n,subtitle:Y,phoneNumber:l,captchaText:z.val(),captchaId:K.attr("id")},dataType:"json",success:function(af){if(af.captchaStatus){if(af.smsStatus){S()}else{x()}}else{p()}},error:function(){x()}})}}function p(){o();z.addClass("error").val("").attr("placeholder","Invalid Captcha").focus()}function S(){k.hide();F.hide();y.html(l);A.show();g("SMSSent")}function x(){k.hide();F.hide();y.html(l);W.show();g("SMSFailed")}function f(){J=F.find(".phoneNumber");l=FKART.login.userPhoneNumber;J.val(l);I=F.find("input[type=submit]");k=G.find(".infoDiv");A=G.find(".smsSuccessDiv");W=G.find(".smsErrorDiv");j=G.find(".retry-sms");U=F.find(".captchaDiv");z=F.find(".captchaText");M=F.find(".refreshCaptcha");y=G.find(".phone_number");if(/^\d{10}$/.test(l)){E=true;o()}G.show();ae.reposition();O()}function O(){M.click(function(){o();z.val("").focus()});F.submit(function(af){T();g("SMSTried");af.preventDefault()});j.click(function(){k.show();F.show();A.hide();W.hide();z.removeClass("error").val("").attr("placeholder","Captcha text").focus();o();g("SMSReTried")});J.focus(function(){g("PhoneNumberFocused");if(!E){E=true;o()}})}function o(){$.ajax({url:"/lc/generateCaptcha",type:"POST",dataType:"json",success:function(af){if(af.success){K=U.find("img");K.attr("src","data:image/png;base64,"+af.captchaBytes);K.attr("id",af.id);U.show();z.show();K.load(function(){if(this.complete){ae.reposition()}})}else{U.find("img").attr("alt","Captcha failed to load")}},error:function(){U.find("img").attr("alt","Captcha failed to load")}})}function ab(){clearInterval(N);N=null}function h(){clearInterval(D);D=null}function C(){N=setInterval(function(){var af=parseInt(m.html());if(af==0){ab();L.hide();ac.show()}m.html(af-1)},1000)}function c(ag,af){var aj=ag.split("?")[1];var ai=aj.split("&");for(var ah=0;ah<ai.length;ah++){var ak=ai[ah].split("=");if(ak[0]==af){return ak[1]}}}function R(){$ele=window.location.href}function aa(){q()}aa()};register_controller("AppDownloadCtrl",function(a){FKART.appDownloadPopup(a)});register_controller("AppDownloadInterstitialCtrl",function(aH){var V=$(aH),y=$(".app-link-interstitial",V),O=$(".app-offers-button",V),am=$(".app-offers-container",V),at=$(".appDownloadInterstitial-popup-content",V),X=$(".fk-question-mark",V),A,aF,aD,a1,ab,a3,aE,G,e,q,t,C,al,L,aT,ar,aS,K,W,o,b,ae,v,aZ,d,E=false,ai,n,an,aU=false,aR,aJ,ay,aN,h,av,Y,k,ag,R,l,f,a,T,aW=false,aY,g,aO,af,aP="title",x="subtitle",F,H,ah,aa,aM,S,p,aG,a0,N=false,J="",ak="",N=false,ap=false,I,ax;if(at.length==0){at=$(".fk-mainfooter .appOnlyDialog-popup-content")}if(at.length==0){at=$(".appOnlyDialog-popup-content.forcedView")}function c(){O.on("click",function(){if(!N){aX("Opened");$(this).addClass("open");X.text("X");setTimeout(function(){am.slideDown(200);N=true},150)}else{aX("Closed");am.slideUp(200,function(){O.removeClass("open");X.text("?");N=false})}});y.on("click",function(a4){if(!y.hasClass("disabled")){aX("Clicked");u($(this));a2();a4.preventDefault()}});EventBus.subscribe("appDownloadInterstitialpopup",function(){u($(this));a2();FKART.utils.localStorage.setObject("sAppDownloadInterstitial",{sPopup:false})})}function a2(){v=null;U();aI()}function ao(){$.ajax({url:"/lc/sendPushNotificationForAccount",data:{pid:aY,lid:g,sid:aO,query:af,offerid:T,title:title,subtitle:subtitle,vertical:F,url:H,useDataUrl:aW},type:"POST",dataType:"json"})}function aX(a5){var a4={};if(a5=="Clicked"){a4.products=s.products}var a6=new Array("eVar1","eVar2","eVar3","eVar4","eVar5","eVar50","prop1","prop2","prop3","prop4","prop35");for(i in a6){if(typeof s[a6[i]]!="undefined"){a4[a6[i]]=s[a6[i]]}}a4.prop21="OpenInApp_"+a5;FKART.omni.customEvent("App only offers",a4)}function aK(){r();L.hide();if(imageSrc&&imageSrc.length>0){var a4=$("<img>");a4.attr("src",imageSrc);a3.append(a4)}else{a3.remove()}aF.show();az();aX("PNSent")}function aB(){r();L.hide();aE.show();aX("PNFailed")}function U(){v=new FKART.ui.Dialog({showFooter:false,cssClass:"appDownloadInterstitialDialog",body:at.html(),destroyOnHide:true,width:"730px"});d=v.getContainer();L=d.find(".loadingDiv");A=d.find(".smsDiv");aF=d.find(".successDiv");aD=A.find(".stitle");ab=A.find(".footerLoggedIn");a1=A.find(".footerNotLoggedIn");a3=aF.find(".phone-image span");aR=d.find(".smsForm");aZ=d.find(".successPrefixDiv");aE=d.find(".errorDiv");aT=d.find(".send-sms-fake-link");aS=d.find(".send-sms-link");K=d.find(".send-otp-link");W=d.find(".resend-sms-fake-link");o=d.find(".resend-otp-fake-link");b=d.find(".resend-sms-link");ae=d.find(".resend-otp-link");p=d.find(".timer");aG=d.find(".timerResendSMS");a0=d.find(".timerResendOTPSMS");ai=d.find(".retry-notification");I=d.find(".otpForm");v.show();if(!FKART.login.isUserLoggedIn()){a1.show();ab.hide()}else{a1.hide();ab.show()}aC()}function aC(){d.on("beforeHide",function(a4){m();M();r()});aS.on("click",function(){aF.hide();aZ.show();aE.hide();aD.remove();aI();aX("PNExpired")});K.on("click",function(){ad();aF.hide();aZ.show();aE.hide();aD.remove();aI();aX("PNExpired")});ai.on("click",function(){v.hide();a2();$status="PNTried";if(E){$status="PNReTried"}aX($status)})}function au(){ag=k.val();a=aN.val();$.ajax({url:"/lc/sendAppDownloadSMS",type:"POST",data:{title:aP,subtitle:x,phoneNumber:ag,marketingSMS:a},dataType:"json",success:function(a4){if(a4.smsStatus){aL()}else{aA()}},error:function(){aA()}})}function z(a4){return a4}function aj(){l=f.val();$.ajax({url:"/lc/verifyOtp",type:"POST",data:{user_id:ag,otp_key:J,otp:l},dataType:"html",success:function(a4){a4=JSON.parse(a4);if(a4.isOtpVerified=="1"){ap=true;FKART.utils.localStorage.setObject("verifiedPhoneNumbers",{phoneNumbers:ax.phoneNumbers+R+"|"});au()}else{Z()}},error:function(){Z()}})}function ad(){ag=k.val();$.ajax({url:"/lc/generateOtp",type:"POST",data:{userId:ag},dataType:"html",success:function(a4){a4=JSON.parse(a4);if(a4.error_code=="1004"){B()}else{J=a4.otp_key;aq()}},error:function(){Z()}})}function Q(){ag=k.val();$.ajax({url:"/lc/getVerifiedPhoneNumber",type:"POST",data:{phoneNumber:ag},dataType:"html",success:function(a4){a4=JSON.parse(a4);if(a4.verifiedPhoneNumber){au();aX("SMSTried");event.preventDefault()}else{R=z(ag);if(ax.phoneNumbers.indexOf(R)<=-1){if(aN.val()=="false"){ad();aX("OTPTried")}else{au();aX("SMSTried")}}else{au();aX("SMSTried")}event.preventDefault()}},error:function(){D()}})}function aL(){M();aQ();aD.hide();h.hide();av.hide();aR.hide();I.hide();Y.html(ag);G.show();e.hide();W.show();b.hide();j();aX("SMSSent")}function aA(){M();aQ();e.hide();aD.hide();h.hide();av.hide();aR.hide();aE.hide();Y.html(ag);al.show();aX("SMSFailed")}function Z(){aQ();M();aD.hide();h.hide();av.hide();aR.hide();aE.hide();Y.html(ag);e.hide();q.show();aX("OTPFailed")}function D(){M();aQ();aD.hide();h.hide();av.hide();aR.hide();aE.hide();e.hide();q.hide();C.show();aX("SMSFailed")}function aq(){aQ();M();aD.hide();h.hide();av.show();I.show();aR.hide();Y.html(ag);e.show();o.show();ae.hide();ac();aX("OTPSent")}function B(){t.show();aD.hide();h.hide();av.hide();I.hide();aR.hide();Y.html(ag);e.hide();o.hide();ae.hide();aX("OTPFailed")}function aI(){k=aR.find(".phoneNumber");f=I.find(".otp-field");ag=FKART.login.userPhoneNumber;k.val(ag);ay=aR.find("input[type=button]");aJ=I.find("input[type=button]");aN=A.find("#marketingSMSAppDownload");h=A.find(".infoDiv");av=A.find(".otpTitle");aD=A.find(".stitle");G=A.find(".smsSuccessDiv");e=A.find(".otpSuccessDiv");q=A.find(".otpErrorDiv");t=A.find(".otpErrorMsgDiv");C=A.find(".otpSendErrorDiv");al=A.find(".smsErrorDiv");n=A.find(".retry-sms");an=A.find(".retry-otp");Y=A.find(".phone_number");A.show();I.hide();av.hide();v.reposition();P()}function P(){ay.on("click",function(a4){ag=k.val();if(!(/^[789]\d{9}$/.test(ag))){k.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}if(FKART.login.isUserLoggedIn()){Q();a4.preventDefault()}else{R=z(ag);if(ax.phoneNumbers.indexOf(R)<=-1){if(aN.val()=="false"){ad();aX("OTPTried")}else{au();aX("SMSTried")}}else{au();aX("SMSTried")}a4.preventDefault()}});aJ.on("click",function(a4){l=f.val();if(!(/^[0-9]{4,6}$/.test(l))){f.addClass("error").val("").attr("placeholder","Invalid OTP").focus();return}else{aj();aD.hide();G.hide();h.hide();al.hide();e.hide();av.hide();I.hide();aX("SMSTried");a4.preventDefault()}});n.on("click",function(){M();aQ();aG.html("45");a0.html("60");aD.hide();G.hide();h.hide();aR.hide();al.hide();au();aX("SMSReTried")});an.on("click",function(){aQ();M();ad();aG.html("45");a0.html("60");av.show();G.hide();I.show();al.hide();aX("SMSReTried")})}function m(){clearInterval(ah);ah=null}function M(){clearInterval(aa);aa=null}function aQ(){clearInterval(aM);aM=null}function r(){clearInterval(S);S=null}function az(){ah=setInterval(function(){var a4=parseInt(p.html());if(a4==0){m();aT.hide();aS.show()}p.html(a4-1)},1000)}function j(){aa=setInterval(function(){var a4=parseInt(aG.html());if(a4==0){M();W.hide();b.show()}aG.html(a4-1)},1000)}function ac(){aM=setInterval(function(){var a4=parseInt(a0.html());if(a4==0){aQ();M();o.hide();ae.show()}a0.html(a4-1)},1000)}function w(a5,a4){var a8=a5.split("?")[1];var a7=a8.split("&");for(var a6=0;a6<a7.length;a6++){var a9=a7[a6].split("=");if(a9[0]==a4){return a9[1]}}}function aV(){var a4=FKART.urlParser().get("sid");if(a4!="undefined"){return a4}}function u(){$ele=window.location.href;aU=false;E=false;ax=FKART.utils.localStorage.getObject("verifiedPhoneNumbers")||{phoneNumbers:"|"}}function aw(){c()}aw()});register_controller("SocialCollabCtrl",function(S){var u=$(S),p=$(".app-ping",u),I=$(".app-offers-button",u),J=$(".app-offers-container",u),Q=$(".socialCollabDialog-popup-content",u),ac=$(".fk-question-mark",u),G,Y,A,Z,w,N,ag,ai,b,B,j,F,K,k,X,z,M,y,L,l,P,E=false,n="title",ab="subtitle",ah,aa,v,a,O,D,m,d=false;function r(){I.click(function(){if(!d){g("Opened");$(this).addClass("open");ac.text("X");setTimeout(function(){J.slideDown(200);d=true},150)}else{g("Closed");J.slideUp(200,function(){I.removeClass("open");ac.text("?");d=false})}});EventBus.subscribe("showSocialCollabPopup",function(){$ele=window.location.href;U($ele);t()});p.on("click",function(aj){if(!p.hasClass("disabled")){g("Clicked");$ele=$(this).data("url");U($ele);t();aj.preventDefault()}})}function t(){ai=null;ad();f()}function g(ak){var aj={};if(ak=="Clicked"){aj.products=s.products}aj.prop21="OpenInApp_"+ak;FKART.omni.customEvent("App only offers",aj)}function H(){h();if(ah&&ah.length>0){var aj=$("<img>");aj.attr("src",ah);Y.append(aj)}else{Y.remove()}C();g("PNSent")}function T(){h();f();g("PNFailed")}function ad(){ai=new FKART.ui.Dialog({showFooter:false,cssClass:"socialCollabDialog",body:Q.html(),destroyOnHide:true,width:"650px"});b=ai.getContainer();w=b.find(".headerDiv");G=b.find(".smsDiv");F=b.find(".smsForm");N=b.find(".send-sms-fake-link");ag=b.find(".send-sms-link");m=b.find(".timer");B=b.find(".retry-notification");ai.show();e()}function e(){b.on("beforeHide",function(aj){af();h();E=false});ag.click(function(){f();g("PNExpired")});B.click(function(){ai.hide();t();g("PNReTried")})}function W(){l=L.val();if(!(/^[789]\d{9}$/.test(l))){L.addClass("error").val("").attr("placeholder","Invalid Number").focus();return}else{$.ajax({url:"/lc/sendSocialCollabSMS",type:"POST",data:{title:n,subtitle:ab,phoneNumber:l,cmpId:aa,token:v,vid:a,captchaText:z.val(),captchaId:M.attr("id")},dataType:"json",success:function(aj){if(aj.captchaStatus){if(aj.smsStatus){V()}else{x()}}else{q()}},error:function(){x()}})}}function q(){o();z.addClass("error").val("").attr("placeholder","Invalid Captcha").focus()}function V(){k.hide();F.hide();y.html(l);A.show();g("SMSSent")}function x(){k.hide();F.hide();y.html(l);Z.show();g("SMSFailed")}function f(){L=F.find(".phoneNumber");l=FKART.login.userPhoneNumber;L.val(l);K=F.find("input[type=submit]");k=G.find(".infoDiv");A=G.find(".smsSuccessDiv");Z=G.find(".smsErrorDiv");j=G.find(".retry-sms");X=F.find(".captchaDiv");z=F.find(".captchaText");P=F.find(".refreshCaptcha");y=G.find(".phone_number");if(/^\d{10}$/.test(l)){E=true;o()}G.show();ai.reposition();R()}function R(){P.click(function(){o();z.val("").focus()});F.submit(function(aj){W();g("SMSTried");aj.preventDefault()});j.click(function(){k.show();F.show();Z.hide();z.removeClass("error").val("").attr("placeholder","Captcha text").focus();o();g("SMSReTried")});L.focus(function(){g("PhoneNumberFocused");if(!E){E=true;o()}})}function o(){$.ajax({url:"/lc/generateCaptcha",type:"POST",dataType:"json",success:function(aj){if(aj.success){M=X.find("img");M.attr("src","data:image/png;base64,"+aj.captchaBytes);M.attr("id",aj.id);X.show();z.show();M.load(function(){if(this.complete){ai.reposition()}})}else{X.find("img").attr("alt","Captcha failed to load")}},error:function(){X.find("img").attr("alt","Captcha failed to load")}})}function af(){clearInterval(O);O=null}function h(){clearInterval(D);D=null}function C(){O=setInterval(function(){var aj=parseInt(m.html());if(aj==0){af();N.hide();ag.show()}m.html(aj-1)},1000)}function c(ak,aj){var an=ak.split("?")[1];var am=an.split("&");for(var al=0;al<am.length;al++){var ao=am[al].split("=");if(ao[0]==aj){return ao[1]}}}function U(aj){aa=c(aj,"cmpId");v=c(aj,"token");a=c(aj,"vid")}function ae(){r()}ae()});