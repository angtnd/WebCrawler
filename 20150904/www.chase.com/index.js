/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

//     (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

//! moment.js
//! version : 2.8.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */

window.MRT=window.MRT||{},function(){var e,t,n;(function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("almond",["almond/almond"],function(e){return e}),n("almond/almond",function(){}),n("js/lodash",[],function(){return window._}),n("js/jquery",[],function(){return window.$}),function(e){if(typeof bootstrap=="function")bootstrap("promise",e);else if(typeof exports=="object"&&typeof module=="object")module.exports=e();else if(typeof n=="function"&&n.amd)n("q/q",e);else if(typeof ses!="undefined"){if(!ses.ok())return;ses.makeQ=e}else{if(typeof self=="undefined")throw new Error("This environment was not anticiapted by Q. Please file a bug.");self.Q=e()}}(function(){function u(e){return function(){return o.apply(e,arguments)}}function m(e){return e===Object(e)}function g(e){return v(e)==="[object StopIteration]"||e instanceof y}function w(t,n){if(e&&n.stack&&typeof t=="object"&&t!==null&&t.stack&&t.stack.indexOf(b)===-1){var r=[];for(var i=n;!!i;i=i.source)i.stack&&r.unshift(i.stack);r.unshift(t.stack);var s=r.join("\n"+b+"\n");t.stack=E(s)}}function E(e){var t=e.split("\n"),n=[];for(var r=0;r<t.length;++r){var i=t[r];!T(i)&&!S(i)&&i&&n.push(i)}return n.join("\n")}function S(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function x(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);if(r)return[r[1],Number(r[2])]}function T(e){var t=x(e);if(!t)return!1;var i=t[0],s=t[1];return i===r&&s>=n&&s<=ot}function N(){if(!e)return;try{throw new Error}catch(t){var n=t.stack.split("\n"),i=n[0].indexOf("@")>0?n[1]:n[2],s=x(i);if(!s)return;return r=s[0],s[1]}}function C(e,t,n){return function(){return typeof console!="undefined"&&typeof console.warn=="function"&&console.warn(t+" is deprecated, use "+n+" instead.",(new Error("")).stack),e.apply(e,arguments)}}function k(e){return e instanceof M?e:H(e)?$(e):V(e)}function L(){function u(e){r=e,s.source=e,f(t,function(t,n){k.nextTick(function(){e.promiseDispatch.apply(e,n)})},void 0),t=void 0,n=void 0}var t=[],n=[],r,i=h(L.prototype),s=h(M.prototype);s.promiseDispatch=function(e,i,s){var o=a(arguments);t?(t.push(o),i==="when"&&s[1]&&n.push(s[1])):k.nextTick(function(){r.promiseDispatch.apply(r,o)})},s.valueOf=function(){if(t)return s;var e=D(r);return P(e)&&(r=e),e},s.inspect=function(){return r?r.inspect():{state:"pending"}};if(k.longStackSupport&&e)try{throw new Error}catch(o){s.stack=o.stack.substring(o.stack.indexOf("\n")+1)}return i.promise=s,i.resolve=function(e){if(r)return;u(k(e))},i.fulfill=function(e){if(r)return;u(V(e))},i.reject=function(e){if(r)return;u(X(e))},i.notify=function(e){if(r)return;f(n,function(t,n){k.nextTick(function(){n(e)})},void 0)},i}function A(e){if(typeof e!="function")throw new TypeError("resolver must be a function.");var t=L();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function O(e){return A(function(t,n){for(var r=0,i=e.length;r<i;r++)k(e[r]).then(t,n)})}function M(e,t,n){t===void 0&&(t=function(e){return X(new Error("Promise does not support operation: "+e))}),n===void 0&&(n=function(){return{state:"unknown"}});var r=h(M.prototype);r.promiseDispatch=function(n,i,s){var o;try{e[i]?o=e[i].apply(r,s):o=t.call(r,i,s)}catch(u){o=X(u)}n&&n(o)},r.inspect=n;if(n){var i=n();i.state==="rejected"&&(r.exception=i.reason),r.valueOf=function(){var e=n();return e.state==="pending"||e.state==="rejected"?r:e.value}}return r}function _(e,t,n,r){return k(e).then(t,n,r)}function D(e){if(P(e)){var t=e.inspect();if(t.state==="fulfilled")return t.value}return e}function P(e){return e instanceof M}function H(e){return m(e)&&typeof e.then=="function"}function B(e){return P(e)&&e.inspect().state==="pending"}function j(e){return!P(e)||e.inspect().state==="fulfilled"}function F(e){return P(e)&&e.inspect().state==="rejected"}function U(){I.length=0,q.length=0,R||(R=!0)}function z(e,t){if(!R)return;q.push(e),t&&typeof t.stack!="undefined"?I.push(t.stack):I.push("(no stack) "+t)}function W(e){if(!R)return;var t=l(q,e);t!==-1&&(q.splice(t,1),I.splice(t,1))}function X(e){var t=M({when:function(t){return t&&W(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return z(t,e),t}function V(e){return M({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return t===null||t===void 0?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return d(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function $(e){var t=L();return k.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function J(e){return M({isDef:function(){}},function(n,r){return et(e,n,r)},function(){return k(e).inspect()})}function K(e,t,n){return k(e).spread(t,n)}function Q(e){return function(){function t(e,t){var s;if(typeof StopIteration=="undefined"){try{s=n[e](t)}catch(o){return X(o)}return s.done?k(s.value):_(s.value,r,i)}try{s=n[e](t)}catch(o){return g(o)?k(o.value):X(o)}return _(s,r,i)}var n=e.apply(this,arguments),r=t.bind(t,"next"),i=t.bind(t,"throw");return r()}}function G(e){k.done(k.async(e)())}function Y(e){throw new y(e)}function Z(e){return function(){return K([this,tt(arguments)],function(t,n){return e.apply(t,n)})}}function et(e,t,n){return k(e).dispatch(t,n)}function tt(e){return _(e,function(e){var t=0,n=L();return f(e,function(r,i,s){var o;P(i)&&(o=i.inspect()).state==="fulfilled"?e[s]=o.value:(++t,_(i,function(r){e[s]=r,--t===0&&n.resolve(e)},n.reject,function(e){n.notify({index:s,value:e})}))},void 0),t===0&&n.resolve(e),n.promise})}function nt(e){return _(e,function(e){return e=c(e,k),_(tt(c(e,function(e){return _(e,i,i)})),function(){return e})})}function rt(e){return k(e).allSettled()}function it(e,t){return k(e).then(void 0,void 0,t)}function st(e,t){return k(e).nodeify(t)}var e=!1;try{throw new Error}catch(t){e=!!t.stack}var n=N(),r,i=function(){},s=function(){function o(){while(e.next){e=e.next;var t=e.task;e.task=void 0;var r=e.domain;r&&(e.domain=void 0,r.enter());try{t()}catch(s){if(i)throw r&&r.exit(),setTimeout(o,0),r&&r.enter(),s;setTimeout(function(){throw s},0)}r&&r.exit()}n=!1}var e={task:void 0,next:null},t=e,n=!1,r=void 0,i=!1;s=function(e){t=t.next={task:e,domain:i&&process.domain,next:null},n||(n=!0,r())};if(typeof process!="undefined"&&process.nextTick)i=!0,r=function(){process.nextTick(o)};else if(typeof setImmediate=="function")typeof window!="undefined"?r=setImmediate.bind(window,o):r=function(){setImmediate(o)};else if(typeof MessageChannel!="undefined"){var u=new MessageChannel;u.port1.onmessage=function(){r=a,u.port1.onmessage=o,o()};var a=function(){u.port2.postMessage(0)};r=function(){setTimeout(o,0),a()}}else r=function(){setTimeout(o,0)};return s}(),o=Function.call,a=u(Array.prototype.slice),f=u(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(arguments.length===1)do{if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}while(1);for(;n<r;n++)n in this&&(t=e(t,this[n],n));return t}),l=u(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),c=u(Array.prototype.map||function(e,t){var n=this,r=[];return f(n,function(i,s,o){r.push(e.call(t,s,o,n))},void 0),r}),h=Object.create||function(e){function t(){}return t.prototype=e,new t},p=u(Object.prototype.hasOwnProperty),d=Object.keys||function(e){var t=[];for(var n in e)p(e,n)&&t.push(n);return t},v=u(Object.prototype.toString),y;typeof ReturnValue!="undefined"?y=ReturnValue:y=function(e){this.value=e};var b="From previous event:";k.resolve=k,k.nextTick=s,k.longStackSupport=!1,typeof process=="object"&&process&&process.env&&process.env.Q_DEBUG&&(k.longStackSupport=!0),k.defer=L,L.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(a(arguments,1)):e.resolve(n)}},k.Promise=A,k.promise=A,A.race=O,A.all=tt,A.reject=X,A.resolve=k,k.passByCopy=function(e){return e},M.prototype.passByCopy=function(){return this},k.join=function(e,t){return k(e).join(t)},M.prototype.join=function(e){return k([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},k.race=O,M.prototype.race=function(){return this.then(k.race)},k.makePromise=M,M.prototype.toString=function(){return"[object Promise]"},M.prototype.then=function(e,t,n){function o(t){try{return typeof e=="function"?e(t):t}catch(n){return X(n)}}function u(e){if(typeof t=="function"){w(e,r);try{return t(e)}catch(n){return X(n)}}return X(e)}function a(e){return typeof n=="function"?n(e):e}var r=this,i=L(),s=!1;return k.nextTick(function(){r.promiseDispatch(function(e){if(s)return;s=!0,i.resolve(o(e))},"when",[function(e){if(s)return;s=!0,i.resolve(u(e))}])}),r.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=a(e)}catch(r){n=!0;if(!k.onerror)throw r;k.onerror(r)}n||i.notify(t)}]),i.promise},k.tap=function(e,t){return k(e).tap(t)},M.prototype.tap=function(e){return e=k(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},k.when=_,M.prototype.thenResolve=function(e){return this.then(function(){return e})},k.thenResolve=function(e,t){return k(e).thenResolve(t)},M.prototype.thenReject=function(e){return this.then(function(){throw e})},k.thenReject=function(e,t){return k(e).thenReject(t)},k.nearer=D,k.isPromise=P,k.isPromiseAlike=H,k.isPending=B,M.prototype.isPending=function(){return this.inspect().state==="pending"},k.isFulfilled=j,M.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"},k.isRejected=F,M.prototype.isRejected=function(){return this.inspect().state==="rejected"};var I=[],q=[],R=!0;k.resetUnhandledRejections=U,k.getUnhandledReasons=function(){return I.slice()},k.stopUnhandledRejectionTracking=function(){U(),R=!1},U(),k.reject=X,k.fulfill=V,k.master=J,k.spread=K,M.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},k.async=Q,k.spawn=G,k["return"]=Y,k.promised=Z,k.dispatch=et,M.prototype.dispatch=function(e,t){var n=this,r=L();return k.nextTick(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},k.get=function(e,t){return k(e).dispatch("get",[t])},M.prototype.get=function(e){return this.dispatch("get",[e])},k.set=function(e,t,n){return k(e).dispatch("set",[t,n])},M.prototype.set=function(e,t){return this.dispatch("set",[e,t])},k.del=k["delete"]=function(e,t){return k(e).dispatch("delete",[t])},M.prototype.del=M.prototype["delete"]=function(e){return this.dispatch("delete",[e])},k.mapply=k.post=function(e,t,n){return k(e).dispatch("post",[t,n])},M.prototype.mapply=M.prototype.post=function(e,t){return this.dispatch("post",[e,t])},k.send=k.mcall=k.invoke=function(e,t){return k(e).dispatch("post",[t,a(arguments,2)])},M.prototype.send=M.prototype.mcall=M.prototype.invoke=function(e){return this.dispatch("post",[e,a(arguments,1)])},k.fapply=function(e,t){return k(e).dispatch("apply",[void 0,t])},M.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},k["try"]=k.fcall=function(e){return k(e).dispatch("apply",[void 0,a(arguments,1)])},M.prototype.fcall=function(){return this.dispatch("apply",[void 0,a(arguments)])},k.fbind=function(e){var t=k(e),n=a(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(a(arguments))])}},M.prototype.fbind=function(){var e=this,t=a(arguments);return function(){return e.dispatch("apply",[this,t.concat(a(arguments))])}},k.keys=function(e){return k(e).dispatch("keys",[])},M.prototype.keys=function(){return this.dispatch("keys",[])},k.all=tt,M.prototype.all=function(){return tt(this)},k.allResolved=C(nt,"allResolved","allSettled"),M.prototype.allResolved=function(){return nt(this)},k.allSettled=rt,M.prototype.allSettled=function(){return this.then(function(e){return tt(c(e,function(e){function t(){return e.inspect()}return e=k(e),e.then(t,t)}))})},k.fail=k["catch"]=function(e,t){return k(e).then(void 0,t)},M.prototype.fail=M.prototype["catch"]=function(e){return this.then(void 0,e)},k.progress=it,M.prototype.progress=function(e){return this.then(void 0,void 0,e)},k.fin=k["finally"]=function(e,t){return k(e)["finally"](t)},M.prototype.fin=M.prototype["finally"]=function(e){return e=k(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},k.done=function(e,t,n,r){return k(e).done(t,n,r)},M.prototype.done=function(e,t,n){var r=function(e){k.nextTick(function(){w(e,i);if(!k.onerror)throw e;k.onerror(e)})},i=e||t||n?this.then(e,t,n):this;typeof process=="object"&&process&&process.domain&&(r=process.domain.bind(r)),i.then(void 0,r)},k.timeout=function(e,t,n){return k(e).timeout(t,n)},M.prototype.timeout=function(e,t){var n=L(),r=setTimeout(function(){if(!t||"string"==typeof t)t=new Error(t||"Timed out after "+e+" ms"),t.code="ETIMEDOUT";n.reject(t)},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},k.delay=function(e,t){return t===void 0&&(t=e,e=void 0),k(e).delay(t)},M.prototype.delay=function(e){return this.then(function(t){var n=L();return setTimeout(function(){n.resolve(t)},e),n.promise})},k.nfapply=function(e,t){return k(e).nfapply(t)},M.prototype.nfapply=function(e){var t=L(),n=a(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},k.nfcall=function(e){var t=a(arguments,1);return k(e).nfapply(t)},M.prototype.nfcall=function(){var e=a(arguments),t=L();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},k.nfbind=k.denodeify=function(e){var t=a(arguments,1);return function(){var n=t.concat(a(arguments)),r=L();return n.push(r.makeNodeResolver()),k(e).fapply(n).fail(r.reject),r.promise}},M.prototype.nfbind=M.prototype.denodeify=function(){var e=a(arguments);return e.unshift(this),k.denodeify.apply(void 0,e)},k.nbind=function(e,t){var n=a(arguments,2);return function(){function s(){return e.apply(t,arguments)}var r=n.concat(a(arguments)),i=L();return r.push(i.makeNodeResolver()),k(s).fapply(r).fail(i.reject),i.promise}},M.prototype.nbind=function(){var e=a(arguments,0);return e.unshift(this),k.nbind.apply(void 0,e)},k.nmapply=k.npost=function(e,t,n){return k(e).npost(t,n)},M.prototype.nmapply=M.prototype.npost=function(e,t){var n=a(t||[]),r=L();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},k.nsend=k.nmcall=k.ninvoke=function(e,t){var n=a(arguments,2),r=L();return n.push(r.makeNodeResolver()),k(e).dispatch("post",[t,n]).fail(r.reject),r.promise},M.prototype.nsend=M.prototype.nmcall=M.prototype.ninvoke=function(e){var t=a(arguments,1),n=L();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},k.nodeify=st,M.prototype.nodeify=function(e){if(!e)return this;this.then(function(t){k.nextTick(function(){e(null,t)})},function(t){k.nextTick(function(){e(t)})})};var ot=N();return k}),n("q",["q/q"],function(e){return e}),function(e,r){if(typeof n=="function"&&n.amd)n("backbone-amd/backbone",["underscore","jquery","exports"],function(t,n,i){r(e,i,t,n)});else if(typeof exports!="undefined"){var i=t("underscore");r(e,exports,i)}else e.Backbone=r(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.slice;t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var u=t.Events={on:function(e,t,n){if(!f(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!f(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){if(!this._events||!f(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;var i=e?[e]:n.keys(this._events);for(var s=0,o=i.length;s<o;s++){e=i[s];var u=this._events[e];if(!u)continue;if(!t&&!r){delete this._events[e];continue}var a=[];for(var l=0,c=u.length;l<c;l++){var h=u[l];(t&&t!==h.callback&&t!==h.callback._callback||r&&r!==h.context)&&a.push(h)}a.length?this._events[e]=a:delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!f(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&l(n,t),r&&l(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;!r&&typeof t=="object"&&(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},a=/\s+/,f=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(a.test(n)){var s=n.split(a);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},l=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}},c={listenTo:"on",listenToOnce:"once"};n.each(c,function(e,t){u[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,!i&&typeof r=="object"&&(i=this),t[e](r,i,this),this}}),u.bind=u.on,u.unbind=u.off,n.extend(t,u);var h=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,u,{changed:null,validationError:null,idAttribute:"id",generateId:function(e){return e[this.idAttribute]},initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes;for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;var h=this.id;this.id=this.generateId(c),h!==this.id&&this.trigger("change-id",this,h,r);if(!a){u.length&&(this._pending=r);for(var p=0,d=u.length;p<d;p++)this.trigger("change:"+u[p],this,c[u[p]],r)}if(f)return this;if(!a)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e){if(n.isEqual(i[s],t=e[s]))continue;(r||(r={}))[s]=t}return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){if(!t.set(t.parse(n,e),e))return!1;r&&r(t,n,e),t.trigger("sync",t,n,e)},H(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r);if(i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),r.parse===void 0&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);r.wait&&(t=n.extend(i||{},t));if(n.isObject(t)&&!a.set(t,r))return!1;f&&f(a,e,r),a.trigger("sync",a,e,r)},H(this,r),s=this.isNew()?"create":r.patch?"patch":"update",s==="patch"&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)};if(this.isNew())return e.success(),!1;H(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||P();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];n.each(p,function(e){if(!n[e])return;h.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var d=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(d.prototype,u,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,m))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});for(var i=0,s=e.length;i<s;i++){var o=e[i]=this.get(e[i]);if(!o)continue;delete this._byId[o.id],delete this._byId[o.cid];var u=this.indexOf(o);this.models.splice(u,1),this.length--,t.silent||(t.index=u,o.trigger("remove",o,this,t)),this._removeReference(o,t)}return r?e[0]:e},set:function(e,t){t=n.defaults({},t,v),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:e.slice();var i,s,o,u,a,f=t.at,l=this.comparator&&f==null&&t.sort!==!1,c=n.isString(this.comparator)?this.comparator:null,p=[],d=[],m={},g=t.add,y=t.merge,b=t.remove,w=!l&&g&&b?[]:!1,E=this.model.prototype;for(var S=0,x=e.length;S<x;S++){o=e[S]||{},this._isModel(o)?i=s=o:E.generateId?i=E.generateId(o):i=o[E.idAttribute||h.prototype.idAttribute];if(u=this.get(i))b&&(m[u.cid]=!0),y&&(o=o===s?s.attributes:o,t.parse&&(o=u.parse(o,t)),u.set(o,t),l&&!a&&u.hasChanged(c)&&(a=!0)),e[S]=u;else if(g){s=e[S]=this._prepareModel(o,t);if(!s)continue;p.push(s),this._addReference(s,t)}s=u||s;if(!s)continue;w&&(s.isNew()||!m[s.id])&&w.push(s),m[s.id]=!0}if(b){for(var S=0,x=this.length;S<x;S++)m[(s=this.models[S]).cid]||d.push(s);d.length&&this.remove(d,t)}if(p.length||w&&w.length){l&&(a=!0),this.length+=p.length;if(f!=null)for(var S=0,x=p.length;S<x;S++)this.models.splice(f+S,0,p[S]);else{w&&(this.models.length=0);var T=w||p;for(var S=0,x=T.length;S<x;S++)this.models.push(T[S])}}a&&this.sort({silent:!0});if(!t.silent){for(var S=0,x=p.length;S<x;S++)(s=p[S]).trigger("add",s,this,t);(a||w&&w.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return o.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},H(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_isModel:function(e){return e instanceof h},_addReference:function(e,t){this._byId[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),e==="change-id"&&(n!=null&&delete this._byId[n],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"];n.each(g,function(e){if(!n[e])return;d.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(e){if(!n[e])return;d.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var b=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,E)),this._ensureElement(),this.initialize.apply(this,arguments)},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,u,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[e[t]]);if(!r)continue;var i=t.match(w);this.delegate(i[1],i[2],n.bind(r,this))}return this},delegate:function(e,t,n){this.$el.on(e+".delegateEvents"+this.cid,t,n)},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){this.$el.off(e+".delegateEvents"+this.cid,t,n)},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}else this.setElement(n.result(this,"el"))},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,r,i){var s=x[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||P()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1),o.type==="PATCH"&&S&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,a&&a.apply(this,arguments)};var f=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,f,i),f};var S=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var T=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},N=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,k=/\*\w+/g,L=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(T.prototype,u,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o,r)!==!1&&(s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(L,"\\$&").replace(N,"(?:$1)?").replace(C,function(e,t){return t?e:"([^/?]+)"}).replace(k,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var A=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},O=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,_=/#.*$/;A.started=!1,n.extend(A.prototype,u,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.location.search},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=decodeURI(this.location.pathname+this.location.search),t=this.root.slice(0,-1);return e.indexOf(t)||(e=e.slice(t.length)),e.slice(1)},getFragment:function(e){return e==null&&(this._hasPushState||!this._wantsHashChange?e=this.getPath():e=this.getHash()),e.replace(O,"")},start:function(e){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState),this.fragment=this.getFragment();var t=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};this.root=("/"+this.root+"/").replace(M,"/");if(!this._hasHashChange&&this._wantsHashChange&&(!this._wantsPushState||!this._hasPushState)){var r=document.createElement("iframe");r.src="javascript:0",r.style.display="none",r.tabIndex=-1;var i=document.body;this.iframe=i.insertBefore(r,i.firstChild).contentWindow,this.navigate(this.fragment)}this._hasPushState?t("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe?t("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.location.replace(this.root+"#"+this.getPath()),!0;this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._hasPushState?e("popstate",this.checkUrl,!1):this._wantsHashChange&&this._hasHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe.frameElement),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),A.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!A.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(_,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe)&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new A;var D=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};h.extend=d.extend=T.extend=b.extend=A.extend=D;var P=function(){throw new Error('A "url" property or function must be specified')},H=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t}),n("backbone-amd",["backbone-amd/backbone"],function(e){return e}),n("massrel-js-backbone-2/backbone",["require","backbone-amd"],function(e){var t=e("backbone-amd");return(window["massrel-js-backbone"]||window).Backbone||t}),n("massrel-js-backbone-2/MediaModel",["require","./backbone","lodash"],function(e){var t=e("./backbone"),n=e("lodash");return t.Model.extend({defaults:function(){return{type:{},size:"large",provider:{},providerName:"",photo_urls:{},embed_url:"",embed_html:"",caption:"",description:"",link:"",duration:0,videos:{}}},toJSON:function(){var e=t.Model.prototype.toJSON.apply(this,arguments);if(e.size&&e.photo_urls[e.size])e.photo_url=e.photo_urls[e.size].url;else{var r=n.first(n.values(e.photo_urls));e.photo_url=r?r.url:""}return e}})}),n("massrel-js/globals",{host:"api.massrelevance.com",timeout:1e4,protocol:document.location.protocol==="https:"?"https":"http",min_poll_interval:5e3,max_backoff_interval:6e4,backoff_rate:1.8,jsonp_param:"jsonp"}),n("massrel-js/helpers",["./globals"],function(e){var t={},n=encodeURIComponent;t.step_through=function(e,n,r){e=t.is_array(e)?e:[e];var i=e.length-1;if(i>=0)for(;i>=0;i--){var s=e[i];for(var o=0,u=n.length;o<u;o++)n[o].call(r,s)}},t.extend=function(e,t){var n;for(n in t)typeof e[n]=="undefined"&&(e[n]=t[n]);return e},t.api_url=function(t,n){n=n||e.host;var r=e.port,i=e.protocol+"://"+n+(r?":"+r:"");return i+t},t.req={},t.req.supportsXhr2=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,t.req.supportsCors=t.req.supportsXhr2||"XDomainRequest"in window,t.req.supportsJSON="JSON"in window,t.req.xdr=function(n,r,i,s,o,u,a,f){var l,c=!1,h;a||(a="GET");var p=function(e){c=!0;var n,r=!1;try{n=JSON.parse(e)}catch(i){r=!0,d(new Error("JSON parse error"))}r||(typeof o=="function"?o(n):t.is_array(o)&&o.length>0&&t.step_through(n,o,s))},d=function(e){c=!0,typeof u=="function"&&u(e)};window.XMLHttpRequest&&t.req.supportsXhr2?l=new XMLHttpRequest:window.XDomainRequest&&(l=new XDomainRequest),l?(l.open(a,n+"?"+t.to_qs(r)),l.timeout=e.timeout,l.onerror=d,l.onprogress=function(){},l.ontimeout=d,l.onload=function(){p(l.responseText)},l.send(f),h=setTimeout(function(){c||(l.onerror=function(){},l.onprogress=function(){},l.ontimeout=function(){},l.onload=function(){},l.abort&&l.abort(),d())},e.timeout)):d(new Error("CORS not supported"))},t.req.jsonp=function(n,i,s,o,u,a){var f=s+ ++r,l=!1,c;e._json_callbacks[f]=function(n){typeof u=="function"?u(n):t.is_array(u)&&u.length>0&&t.step_through(n,u,o),delete e._json_callbacks[f],l=!0,clearTimeout(c)},i.push([e.jsonp_param,"massrel._json_callbacks."+f]);var h=t.load(n+"?"+t.to_qs(i));c=setTimeout(function(){l||(e._json_callbacks[f]=function(){delete e._json_callbacks[f]},typeof a=="function"&&a(),h.stop())},e.timeout)},t.jsonp_factory=t.req.jsonp;var r=0;e._json_callbacks={},t.request_factory=function(e,n,r,i,s,o){t.req.supportsCors&&t.req.supportsJSON?t.req.xdr(e,n,r,i,s,o):t.req.jsonp(e,n,r,i,s,o)},t.post_factory=function(e,n,r,i,s,o,u){if(!t.req.supportsCors||!t.req.supportsJSON)throw"POST not supported";t.req.xdr(e,n,i,s,o,u,"POST",r)},t.is_array=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},t.is_number=function(e){return Object.prototype.toString.call(e)==="[object Number]"};var i=document.getElementsByTagName("head")[0]||document.body;t.load=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=e;var r=!1;return n.onload=n.onreadystatechange=function(){!r&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")&&(r=!0,n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),typeof t=="function"&&t())},i.insertBefore(n,i.firstChild),{stop:function(){n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),n.src="#"}}},t.to_qs=function(e){var r=[],i;if(e&&e.length){for(var s=0,o=e.length;s<o;s++){i=e[s][1];if(t.is_array(i)){var u=[];for(var a=0,f=i.length;a<f;a++)u[a]=n(i[a]||"");i=u.join(",")}else i!==undefined&&i!==null?i=n(i):i="";r.push(n(e[s][0])+"="+i)}return r.join("&")}return""};var s=/\+\d{4} \d{4}$/,o=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\+\d{4})$/,u=/^(\d{4})-(\d\d)-(\d\d)T(\d\d)\:(\d\d)\:(\d\d)\.(\d{3})Z$/;return t.fix_date=t.fix_twitter_date=function(e){e=e.toString();if(s.test(e)){e=e.split(" ");var t=e.pop();e.splice(3,0,t),e=e.join(" ")}else o.test(e)?e=e.replace(o,"$1/$2/$3 $4:$5:$6 $7"):u.test(e)&&(e=e.replace(u,"$1/$2/$3 $4:$5:$6 +0000"));return e},t.parse_params=function(e){e=e||window.location.search.substring(1);var t={};e.charAt(0)==="?"&&(e=e.substring(1));if(e.length>0){e=e.replace(/\+/g," ");var n=e.split(/[&;]/g);for(var r=0;r<n.length;r++){var i=n[r].split("="),s=decodeURIComponent(i[0]),o=i.length>1?decodeURIComponent(i[1]):"";if(s in t){var u=t[s];typeof u!="string"?t[s].push(o):(t[s]=[],t[s].push(u),t[s].push(o))}else t[s]=o}}return t},t.poll_interval=function(t){var n=e.min_poll_interval;return Math.max(t||n,n)},t.poll_backoff=function(t,n){var r=e.max_backoff_interval;return t<r&&(n=Math.max(n-1,0),t*=Math.pow(e.backoff_rate,n),t=Math.min(t||r,r)),t},t.callback_group=function(e){e=e||1;var t=0,n=!0,r=function(r,i){return function(){if(n){if(t<=e)return r.apply(i||this,arguments);throw new Error("Callback group max call count exceeded")}}};return r.deactivate=function(){n=!1},r},t.timeParam=function(e,t,n,r){typeof e!="undefined"&&(e.getTime&&(e=e.getTime()/1e3),e=+e,!isNaN(e)&&e>0?(e=Math.floor(e/60)*60,n.push([t,e])):!isNaN(e)&&r&&e<=0&&n.push([t,e]))},t.always=function(e){var t=new $.Deferred;if(e===undefined)return t.resolve(),t.promise();e.length===undefined&&(e=[e]);var n=e.length,r=function(){n--,n===0&&t.resolve()};return $.each(e,function(){this.always(r)}),t.promise()},t}),n("massrel-js/generic_poller_cycle",["./helpers"],function(e){function t(t,n,r){this.cg=e.callback_group(),this.skip=this.cg(t),this.callback=this.cg(n),this.errback=this.cg(r),this._enabled=!0}return t.prototype.enabled=function(){return this._enabled},t.prototype.disable=function(){this.cg.deactivate(),this._enabled=!1},t}),n("massrel-js/generic_poller",["./helpers","./generic_poller_cycle"],function(e,t){function n(r,i){var s=this,o=function(){if(f){var i=e.callback_group(),o=i(u),l=function(t){s.consecutive_errors=0,n.failure_mode=s.failure_mode=!1;if(f){for(var r=0,i=s._filters.length;r<i;r++)t=s._filters[r].call(s,t);e.step_through([t],s._listeners,s),f&&o()}},c=function(){s.consecutive_errors+=1,n.failure_mode=s.failure_mode=!0,o(!0)};a=new t(o,l,c),s.fetch(r,s.opts,a)}},u=function(t){var n=e.poll_interval(s.frequency*1e3);t&&(n=e.poll_backoff(n,s.consecutive_errors)),l=setTimeout(o,n)},a=null,f=!1,l;this._listeners=[],this._filters=[],this.object=r,this.opts=i||{},this.frequency=this.opts.frequency||30,this.alive_count=0,this.consecutive_errors=0,this.failure_mode=!1,this.start=function(){return f||(f=!0,o()),this},this.stop=function(){return a&&(a.disable(),a=null),clearTimeout(l),f=!1,this}}return n.prototype.fetch=function(e,t,n){return e.load(t,n.callback,n.errback),this},n.prototype.data=function(e){return this._listeners.push(e),this},n.prototype.filter=function(e){return this._filters.push(e),this},n.failure_mode=!1,n}),n("massrel-js/poller_queue",["./helpers"],function(e){function t(t,n){function a(){if(!s&&r.length>0&&typeof i=="function"){var e=++o;u.enqueued-=1,u.count+=1;var t=r.shift();s=!0,i.call(u,t,function(){e===o&&(s=!1,setTimeout(a,0))})}}this.poller=t,n=e.extend(n||{},{});var r=[],i=null,s=!1,o=0;this.total=0,this.enqueued=0,this.count=0;var u=this;t.batch(function(e){var t=e.length,n=t-1;for(;n>=0;n--)r.push(e[n]);u.total+=t,u.enqueued+=t,a()}),this.next=function(e){!s&&typeof e=="function"&&(i=e,a())}}return t}),n("massrel-js/poller",["./helpers","./generic_poller","./poller_queue"],function(e,t,n){function r(e,n){t.call(this,e,n),this.stream=this.object,this.filter(this.filter_newer),n=this.opts,this.newest_timestamp=n.newest_timestamp||null,this.stay_realtime="stay_realtime"in n?!!n.stay_realtime:!0,this.hail_mary_mode=!!n.hail_mary_mode,this.first=!0}return e.extend(r.prototype,t.prototype),r.prototype.fetch=function(t,n,r){var i=this,s={start_id:null},o=this.stay_realtime?"since_id":"from_id";return s[o]=i.since_id,n=e.extend({},n),this.first&&(n=e.extend(n.initial||{},n),delete n.initial),s=e.extend(s,n),this.cursorable()||delete s.since_id,t.load(s,function(e){r.enabled()&&(e&&e.length>0&&(i.since_id=e[0].entity_id,i.start_id||(i.start_id=e[e.length-1].entity_id)),r.callback(e),s.timeframe&&i.first&&i.stop(),i.first=!1)},r.errback),this},r.prototype.batch=function(e){return this.data(r.createEnumerator(e,!1))},r.prototype.each=function(e){return this.data(r.createEnumerator(e,!0))},r.prototype.queue=function(e){var t=new n(this);return t.next(e),this},r.prototype.more=function(t,n){var r=this,i=function(){r.object.load(e.extend({start_id:r.start_id,since_id:null},r.opts),function(e){e.length>0&&(r.start_id=e[e.length-1].entity_id,r.since_id||(r.since_id=e[0].entity_id)),t.call(r,e)},function(){typeof n=="function"&&n()})};return i(),this},r.prototype.cursorable=function(){return!(t.failure_mode||this.failure_mode||this.hail_mary_mode)},r.prototype.filter_newer=function(e){return e=r.filter_newer(e,this.newest_timestamp),e&&e.length>0&&(this.newest_timestamp=e[0].queued_at),e},r.prototype.poke=function(){return this},r.createEnumerator=function(t,n){return n?function(n){n&&n.length>0&&e.step_through(n,[t],this)}:function(e){e&&e.length>0&&t.call(this,e)}},r.filter_newer=function(e,t){var n="queued_at";if(e&&e.length>0){var r=this.limit||Infinity;if(t)if(e[0][n]<=t)e=[];else if(e[e.length-1][n]>t)e.length>r&&e.splice(this.limit,e.length-r);else{var i=[];for(var s=0,o=e.length;s<o&&i.length<r;s++){var u=e[s];if(!(u[n]>t))break;i.push(u)}e=i}else e.length>r&&e.splice(this.limit,e.length-r)}return e},r}),n("massrel-js/meta_poller",["./helpers","./generic_poller"],function(e,t){function n(){t.apply(this,arguments)}return e.extend(n.prototype,t.prototype),n.prototype.fetch=function(e,t,n){return e.meta(t,n.callback,n.errback),this},n.prototype.each=n.prototype.data,n}),n("massrel-js/top_things_poller",["./helpers","./generic_poller"],function(e,t){function n(e,n){n.thing=n.thing||"hashtags",typeof n.resolution=="number"&&(n.resolution=n.resolution+"s"),t.apply(this,arguments)}return e.extend(n.prototype,t.prototype),n.prototype.fetch=function(e,t,n){return typeof t.resolution=="number"&&(t.resolution=t.resolution+"s"),e.topThings(t,n.callback,n.errback),this},n.mostRecentBucket=function(e){if(e.data&&e.data.length>0){for(var t=e.data.length-1;t>=0;t--)if(e.data[t].things&&e.data[t].things.length>0)return e.data[t];if(t===-1)return e.data[e.data.length-1]}return null},n.prototype.each=n.prototype.data,n}),n("massrel-js/stream_keyword_insights",["./helpers","./generic_poller"],function(e,t){function r(e,t){this.stream=e,this.defaults=t||{}}var n=encodeURIComponent;return r.prototype.url=function(){return this.stream.keyword_insights_url()},r.prototype.fetch=function(t,n,r){t=e.extend({},t||{}),t=e.extend(t,this.defaults);var i=this.params(t);return e.request_factory(this.url(),i,"_",this,function(e){typeof n=="function"&&n.apply(this,arguments)},r),this},r.prototype.poller=function(e){var n=new t(this,e);return n.fetch=function(e,t,n){return e.fetch(t,n.callback,n.errback)},n},r.prototype.params=function(e){e=e||{};var t=[];return e.topics&&t.push(["topics","1"]),"start"in e&&t.push(["start",e.start]),"finish"in e&&t.push(["finish",e.finish]),e.resolution&&t.push(["resolution",e.resolution]),e.countries&&t.push(["countries",e.countries]),t},r}),n("massrel-js/stream_activity",["./helpers","./generic_poller"],function(e,t){function r(e,t){this.stream=e,this.defaults=t||{}}var n=encodeURIComponent;r.prototype.url=function(){return e.api_url("/"+n(this.stream.account)+"/"+n(this.stream.stream_name)+"/activity.json")},r.prototype.fetch=function(t,n,r){t=e.extend({},t||{}),t=e.extend(t,this.defaults);var i=this.params(t);return e.request_factory(this.url(),i,"_",this,function(r){if(r&&(!t.verbose||t.verbose==="0")&&e.is_array(r.activity)){var i=r.activity;for(var s=0,o=i.length;s<o;s++){var u=r.start+r.period_size*s;i[s]=e.extend(i[s],{start:u,finish:Math.min(u+r.period_size,r.finish)})}}typeof n=="function"&&n.apply(this,arguments)},r),this},r.prototype.poller=function(e){var n=new t(this,e);return n.fetch=function(e,t,n){return e.fetch(t,n.callback,n.errback)},n},r.prototype.params=function(t){t=t||{};var n=[];return t.view?n.push(["view",t.view]):t.topic&&n.push(["topic",t.topic]),e.timeParam(t.start,"start",n,!0),e.timeParam(t.finish,"finish",n,!0),"periods"in t&&n.push(["periods",t.periods]),t.resolution&&n.push(["resolution",t.resolution]),"tz_offset"in t&&n.push(["tz_offset",t.tz_offset]),t.encode&&n.push(["encode",t.encode]),n.push(["verbose",0]),n};var i=function(e,t,n){r.prototype[e]=function(){return this.defaults[t]=n,this}};return i("approved","view","approved"),i("pending","view","pending"),i("rejected","view","rejected"),i("minutes","resolution","1m"),i("ten_minutes","resolution","10m"),i("hours","resolution","1h"),i("days","resolution","1d"),r}),n("massrel-js/stream",["./helpers","./poller","./meta_poller","./top_things_poller","./stream_keyword_insights","./stream_activity"],function(e,t,n,r,i,s){function u(){var e=arguments.length===1?arguments[0].split("/"):arguments;this.account=e[0],this.stream_name=e[1],this._enumerators=[]}var o=encodeURIComponent;return u.prototype.stream_url=function(){return e.api_url("/"+o(this.account)+"/"+o(this.stream_name)+".json")},u.prototype.meta_url=function(){return e.api_url("/"+o(this.account)+"/"+o(this.stream_name)+"/meta.json")},u.prototype.top_things_url=function(t){return e.api_url("/"+o(this.account)+"/"+o(this.stream_name)+"/top_"+t+".json")},u.prototype.keyword_insights_url=function(t){return e.api_url("/"+o(this.account)+"/"+o(this.stream_name)+"/keyword_insights.json")},u.prototype.load=function(t,n,r){t=e.extend(t||{},{});var i=this.buildParams(t);return e.request_factory(this.stream_url(),i,"_",this,n||this._enumerators,r),this},u.prototype.buildParams=function(t){t=t||{};var n=[];return t.limit&&n.push(["limit",t.limit]),t.since_id?n.push(["since_id",t.since_id]):t.from_id?n.push(["from_id",t.from_id]):(t.start_id||t.start)&&n.push(["start",t.start_id||t.start]),t.replies&&n.push(["replies","1"]),t.geo_hint&&n.push(["geo_hint","1"]),t.from&&n.push(["from",t.from]),t.keywords&&n.push(["keywords",t.keywords]),t.lang&&n.push(["lang",t.lang]),t.network&&n.push(["network",t.network]),t.timeline_search&&n.push(["timeline_search","1"]),t.page_links&&n.push(["page_links","1"]),t.klout&&n.push(["klout","1"]),t.timeframe&&(e.timeParam(t.timeframe.start,"timeframe[start]",n),e.timeParam(t.timeframe.finish,"timeframe[finish]",n)),n},u.prototype.each=function(e){return this._enumerators.push(e),this},u.prototype.poller=function(e){return new t(this,e)},u.prototype.meta=function(){var t,n,r;if(typeof arguments[0]=="function")n=arguments[0],r=arguments[1],t={};else{if(typeof arguments[0]!="object")throw new Error("incorrect arguments");t=arguments[0],n=arguments[1],r=arguments[2]}var i=this.buildMetaParams(t);return e.request_factory(this.meta_url(),i,"meta_",this,n,r),this},u.prototype.buildMetaParams=function(e){e=e||{};var t=[];return e.disregard&&t.push(["disregard",e.disregard]),e.num_minutes&&t.push(["num_minutes",e.num_minutes]),e.num_hours&&t.push(["num_hours",e.num_hours]),e.num_days&&t.push(["num_days",e.num_days]),e.num_trends&&t.push(["num_trends",e.num_trends]),e.num_links&&t.push(["num_links",e.num_links]),e.num_hashtags&&t.push(["num_hashtags",e.num_hashtags]),e.num_contributors&&t.push(["num_contributors",e.num_contributors]),e.top_periods&&t.push(["top_periods",e.top_periods]),e.top_periods_relative&&t.push(["top_periods_relative",e.top_periods_relative]),e.top_count&&t.push(["top_count",e.top_count]),e.finish&&t.push(["finish",e.finish]),e.networks&&t.push(["networks","1"]),(e.activity||e.activity===0)&&t.push(["activity",e.activity]),t},u.prototype.metaPoller=function(e){return new n(this,e)},u.prototype.keywordInsights=function(e){return new i(this,e)},u.prototype.topThings=function(){var t,n,r;if(typeof arguments[0]=="function")n=arguments[0],r=arguments[1],t={};else{if(typeof arguments[0]!="object")throw new Error("incorrect arguments");t=arguments[0],n=arguments[1],r=arguments[2]}var i=this.buildTopThingsParams(t);return e.request_factory(this.top_things_url(t.thing),i,"top_things_",this,n,r),this},u.prototype.buildTopThingsParams=function(t){t=t||{};var n=[];if(t.resolution){var r;e.is_number(t.resolution)?r=t.resolution+"s":r=t.resolution,n.push(["resolution",r])}return t.start&&n.push(["start",t.start]),t.finish&&n.push(["finish",t.finish]),t.limit&&n.push(["limit",t.limit]),t.percent&&n.push(["percent","1"]),n},u.prototype.topThingsPoller=function(e){return new r(this,e)},u.prototype.activity=function(e){return new s(this,e)},u}),n("massrel-js/account",["./helpers","./meta_poller"],function(e,t){function r(e){this.user=e}var n=encodeURIComponent;return r.prototype.meta_url=function(){return e.api_url("/"+n(this.user)+".json")},r.prototype.meta=function(){var t,n,r;if(typeof arguments[0]=="function")n=arguments[0],r=arguments[1],t={};else{if(typeof arguments[0]!="object")throw new Error("incorrect arguments");t=arguments[0],n=arguments[1],r=arguments[2]}var i=this.buildMetaParams(t);return e.request_factory(this.meta_url(),i,"meta_",this,n,r),this},r.prototype.buildMetaParams=function(t){t=t||{};var n=[];t.quick_stats&&n.push(["quick_stats","1"]);if(t.streams){var r=e.is_array(t.streams)?t.streams:[t.streams];n.push(["streams",r.join(",")])}return t.num_minutes&&n.push(["num_minutes",t.num_minutes]),t.num_trends&&n.push(["num_trends",t.num_trends]),t.start&&n.push(["start",t.start]),t.finish&&n.push(["finish",t.finish]),n},r.prototype.metaPoller=function(e){return new t(this,e)},r.prototype.toString=function(){return this.user},r}),n("massrel-js/context",["./helpers"],function(e){function t(e){this.status=e,this.source={facebook:!1,twitter:!1,getglue:!1,google:!1,instagram:!1,rss:!1,message:!1},this.known=!1,this.intents=!0}return t.create=function(n,r){n=n||{};var i=new t(n);return r=e.extend(r||{},{intents:!0,retweeted_by:!0}),i.intents=r.intents,typeof i.source[n.network]!="undefined"&&(i.source[n.network]=i.known=!0,i.sourceName=n.network),n.network==="google_plus"&&(i.source.google=i.known=!0,i.sourceName="google"),n.network==="massrelevance"&&(i.source.message=i.known=!0,i.sourceName="message"),i.source.twitter&&n.retweeted_status&&r.retweeted_by&&(i.retweet=!0,i.retweeted_by_user=n.user,i.status=n.retweeted_status),i},t.prototype.getPhotoUrl=function(){if(this.photo_url!==undefined)return this.photo_url;var e=!1;if(this.status&&this.known)if(this.source.twitter)if(this.status.entities.media&&this.status.entities.media.length){var t=this.status.entities.media[0];e={url:t.media_url,width:t.sizes.medium.w,height:t.sizes.medium.h,link_url:t.url||t.expanded_url}}else this.status.entities.urls&&this.status.entities.urls.length&&(e={url:this.status.entities.urls[0].expanded_url||this.status.entities.urls[0].url});else this.source.facebook&&(this.status.type&&this.status.type==="photo"||this.status.kind&&this.status.kind==="photo")?e={url:this.status.picture.replace(/_[st]./,"_n.")}:this.source.google&&this.status.object.attachments.length&&this.status.object.attachments[0].objectType==="photo"?e={url:this.status.object.attachments[0].fullImage.url}:this.source.instagram&&this.status.type==="image"&&(e={url:this.status.images.standard_resolution.url});return this.photo_url=e,e},t}),n("massrel-js/compare_poller",["./helpers","./generic_poller"],function(e,t){function n(){t.apply(this,arguments)}return e.extend(n.prototype,t.prototype),n.prototype.fetch=function(e,t,n){return e.load(t,n.callback,n.errback),this},n.prototype.each=n.prototype.data,n}),n("massrel-js/compare",["./helpers","./compare_poller"],function(e,t){function n(t){e.is_array(t)?this.streams=t.slice(0):typeof t=="string"?this.streams=[t]:this.streams=[]}return n.prototype.compare_url=function(){return e.api_url("/compare.json")},n.prototype.buildParams=function(e){var t=[];return e=e||{},e.streams&&t.push(["streams",e.streams]),(e.target||e.target>=0)&&t.push("target",e.target.toString()),t},n.prototype.load=function(t,n,r){typeof t=="function"&&(r=n,n=t,t=null);var i=this.buildParams(e.extend({streams:this.streams},t||{}));return e.request_factory(this.compare_url(),i,"meta_",this,n,r),this},n.prototype.poller=function(e){return new t(this,e)},n}),n("massrel-js/intents",["./helpers"],function(e){var t={base_url:"https://twitter.com/intent/",params:{text:"(string): default text, for tweet/reply",url:"(string): prefill url, for tweet/reply",hashtags:"(string): hashtag (or list with ,) without #, for tweet/reply",related:"(string): screen name (or list with ,) without @, available for all",in_reply_to:"(number): tweet id, only for reply",via:"(string): screen name without @, tweet/reply",tweet_id:"(number): tweet id, for retweet and favorite",screen_name:"(string): only for user/profile",user_id:"(number): only for user/profile",original_referer:'(string): url to display with related ("www.yahoo.com suggests you follow:")'},original_referer:window.top!==window.self&&document.referrer||null};return t.url=function(n,r){r=e.extend({},r||{}),r.original_referer===undefined&&t.original_referer&&(r.original_referer=t.original_referer),r.original_referer&&!/^https?:\/\//.test(r.original_referer)&&(r.original_referer="http://"+r.original_referer);if(r.hashtags&&navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/)){var i=r.text?[r.text]:[];r.url&&(i.push(r.url),delete r.url),i.push("#"+r.hashtags.split(/\s*,\s*/).join(" #").replace(/^\s+|\s+$/gm,"")),delete r.hashtags,r.text=i.join(" ")}var s=[];for(var o in r)s.push([o,r[o]]);return t.base_url+encodeURIComponent(n)+"?"+e.to_qs(s)},t.tweet=function(e){return t.url("tweet",e)},t.reply=function(e,n){return n=n||{},n.in_reply_to=e,t.tweet(n)},t.retweet=function(e,n){return n=n||{},n.tweet_id=e,t.url("retweet",n)},t.favorite=function(e,n){return n=n||{},n.tweet_id=e,t.url("favorite",n)},t.user=function(e,n){return n=n||{},/^\d+$/.test(e+"")?n.user_id=e:n.screen_name=e,t.url("user",n)},t.profile=t.user,t}),n("massrel-js/search",["require","./helpers"],function(e){var t=e("./helpers"),n=function(e){this.apiToken=e};return n.prototype.url=function(){return t.api_url("/search/search.json")},n.prototype.fetch=function(e,n,r){return e=this.buildQueryString(e),t.request_factory(this.url(),e,"_",this,n,r),this},n.prototype.buildQueryString=function(e){var t=[];typeof e.q=="string"&&t.push(["q",e.q]),e.filters&&(t=t.concat(this.buildParams(e.filters,"filter.")));if(e.views){var n,r;for(n in e.views)r=e.views[n],typeof r=="boolean"?t.push(["view."+n,r?"1":"0"]):t=t.concat(this.buildParams(r,"view."+n+"."))}return t},n.prototype.buildParams=function(e,n){n=n||"";var r,i,s,o=[];for(r in e){i=e[r],t.is_array(i)||(i=[i]);for(s=0,len=i.length;s<len;s++){var u=i[s];typeof u=="boolean"&&(u=u?"1":"0"),o.push([n+r,u])}}return o},n}),n("massrel-js/massrel",["./globals","./helpers","./stream","./account","./stream_keyword_insights","./stream_activity","./generic_poller","./generic_poller_cycle","./poller","./meta_poller","./top_things_poller","./poller_queue","./context","./compare","./compare_poller","./intents","./search"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){e.Stream=n,e.Account=r,e.StreamKeywordInsights=i,e.StreamActivity=s,e.GenericPoller=o,e.GenericPollerCycle=u,e.Poller=a,e.MetaPoller=f,e.TopThingsPoller=l,e.PollerQueue=c,e.Context=h,e.Compare=p,e.ComparePoller=d,e.helpers=t,e.intents=v,e.Search=m;var g=t.parse_params();return g["massrel[host]"]&&(e.host=g["massrel[host]"]),e}),n("massrel-js",["massrel-js/massrel"],function(e){return e}),n("embedly/js/main",["jquery","massrel-js"],function(e,t){function o(e){this.data={key:"fd577f7497bf11e0b95d4040d3dc5c07",secure:n,url:e,maxwidth:"500"}}var n=location.protocol==="https:",r="embedly.massrelevance.com",i="d1gbi9ec0ujnws.cloudfront.net",s="//"+(n?i:r)+"/1/";return o.prototype.task=function(n,r){var i=this,o=new e.Deferred;return t.helpers.request_factory(s+n,[["key",this.data.key],["secure",this.data.secure?"true":"false"],["url",this.data.url],["maxwidth",this.data.maxwidth]],"_",this,function(e){o.resolve(e),e&&typeof r=="function"&&r(e)},function(){o.reject()}),o.promise()},o.prototype.oembed=function(e){return this.task("oembed",e)},o.prototype.preview=function(e){return this.task("preview",e)},function(e){return new o(e)}}),n("embedly/index",["./js/main"],function(e){return e}),n("embedly",["embedly/index"],function(e){return e}),n("media-meta/js/embedly-widget",["require","lodash"],function(e){var t=e("lodash"),n="//cdn.embedly.com/widgets/media.html?",r={url:"",image:"",video:"",video_secure:"true",type:"video/mp4",schema:"instagram"},i=function(e){var n=[];return t.each(e,function(e,t){n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}),n.join("&")},s=t.template('<iframe src="<%= src %>" scrolling="no" frameborder="0"></iframe>');return function(e,o){e=t.extend({},r,e),o=o||{},o.autoplay_video&&(e.autoplay="true"),o.loop_video&&(e.loop="1");var u=n+i(e);return s({src:u})}}),n("placeholder-image-generator/templates/base",["require","lodash"],function(e){var t=e("lodash");return t.template('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="<%= width %>" height="<%= height %>"><rect width="100%" height="100%" fill="<%= color %>"></rect><%= template %></svg>')}),n("placeholder-image-generator/templates/youtube",["require","lodash"],function(e){var t=e("lodash");return t.template('<svg version="1.1" x="<%= (19 / 32) * width %>" y="<%= (5 / 8) * height %>" width="<%= width / 2 %>" height="<%= height / 2%>"      viewBox="0 0 792 1224" enable-background="new 0 0 792 1224"><path fill="#FFFFFF" d="M599.3,594.6c-4.6,0-9.9,2.4-14.6,7.1l0,93.8c4.7,4.7,10,7.1,14.6,7.1c8.1,0,11.7-5.9,11.7-21.4v-66.5    C611,599.2,607.4,594.6,599.3,594.6z"/><path fill="#FFFFFF" d="M297,726h-29.4v-17c-11.1,12.8-20.6,19.2-30.9,19.2c-9,0-15.3-4.3-18.4-12c-1.9-4.7-3.3-12-3.3-22.7V569.8    h29.4v116c0,6.6,0,9.3,0,10.8c0.7,4.3,2.5,5.9,6.3,5.9c5.6,0,10.7-4.9,16.9-13.7V569.8H297L297,726L297,726z"/><path fill="#FFFFFF" d="M164,679.6c1.5,15.5-3.3,23.1-12.4,23.1s-13.9-7.7-12.4-23.1v-61.9c-1.5-15.5,3.2-22.7,12.4-22.7    c9.1,0,13.9,7.3,12.4,22.7L164,679.6L164,679.6z M193.3,620.8c0-16.7-3.4-29.2-9.3-37.1c-7.8-10.7-20.1-15.1-32.5-15.1    c-14,0-24.7,4.4-32.5,15.1c-6,7.9-9.3,20.6-9.3,37.3l0,55.6c0,16.6,2.9,28.1,8.9,35.9c7.8,10.7,20.5,16.3,32.9,16.3    s25.3-5.6,33.1-16.3c5.9-7.8,8.7-19.3,8.7-35.9V620.8L193.3,620.8z"/><path fill="#FFFFFF" d="M77.3,640.9V726H46.4v-85.1c0,0-32.1-104.3-38.7-123.8h32.5l21.7,81.5l21.6-81.5H116L77.3,640.9L77.3,640.9z    "/><g>    <path fill="#FFFFFF" d="M778.1,534c0,0-4.5-31.7-18.4-45.6c-17.6-18.3-37.3-18.4-46.3-19.5c-64.6-4.7-161.6-4.7-161.6-4.7h-0.2        c0,0-97,0-161.6,4.7c-9,1.1-28.7,1.2-46.3,19.5c-13.9,14-18.4,45.6-18.4,45.6s-4.6,37.2-4.6,74.4v34.9c0,37.2,4.6,74.4,4.6,74.4        s4.5,31.7,18.4,45.6c17.6,18.3,40.7,17.7,50.9,19.7c37,3.5,157,4.6,157,4.6s97.1-0.1,161.7-4.8c9-1.1,28.7-1.2,46.3-19.5        c13.8-14,18.4-45.6,18.4-45.6s4.6-37.2,4.6-74.4v-34.9C782.7,571.3,778.1,534,778.1,534z M422.3,726h-30.9V548.1h-32.5v-29.4        l97.5,0v29.4h-34V726z M533.7,726h-29.4v-17c-11.1,12.8-20.6,19.2-30.9,19.2c-9,0-15.3-4.3-18.4-12c-1.9-4.7-3.3-12-3.3-22.7V571.3        h29.4v114.5c0,6.6,0,9.3,0,10.8c0.7,4.3,2.5,5.9,6.3,5.9c5.6,0,10.7-4.9,16.9-13.7V571.3h29.4V726z M640.4,679.6        c0,14.3-1.2,24.4-3.1,30.9c-3.7,11.5-11.9,17.5-23,17.5c-10,0-20.2-6-29.5-17.6l0,15.6h-27.8V518.7h27.8l0,67.6        c9-11.1,19.3-17.5,29.6-17.5c11.2,0,18.6,6.4,22.4,18c1.9,6.2,3.7,16.2,3.7,30.9V679.6z M701.9,702.5c6.9,0,10.9-3.7,12.5-11.2        c0.3-1.5,0.2-8.2,0.2-19.4H744v4.4c0,9-0.7,15.4-1,18.2c-0.9,6.2-3.1,11.8-6.5,16.8c-7.7,11.2-19.2,16.8-33.9,16.8        c-14.7,0-25.8-5.3-33.9-15.8c-5.9-7.7-9.8-19.2-9.8-35.7v-54.1c0-16.5,3.5-29.3,9.4-37.1c8.1-10.6,19.3-16.2,33.5-16.2        c14,0,25.2,5.6,33.1,16.2c5.9,7.8,9.1,19.9,9.1,36.4l0,31.6h-55.7v27.8C688.2,695.4,692.3,702.5,701.9,702.5z"/>    <path fill="#FFFFFF" d="M714.6,613.2c0-14.3-3.7-18.6-13-18.6c-9.4,0-13.3,3.9-13.3,18.4v17.1l26.3,0V613.2z"/></g></svg>')}),n("placeholder-image-generator/js/main",["require","lodash","../templates/base","../templates/youtube"],function(e){var t=e("lodash"),n="data:image/svg+xml;charset=utf-8,",r={width:480,height:360,color:"#333333",template:""},i=e("../templates/base"),s={youtube:e("../templates/youtube")};return function(e){e=t.extend({},r,e);if(e.template!==""){var o=s[e.template];e.template=o?o(e):""}return n+encodeURIComponent(i(e))}}),n("placeholder-image-generator/index",["./js/main"],function(e){return e}),n("placeholder-image-generator",["placeholder-image-generator/index"],function(e){return e}),n("media-meta/js/main",["require","lodash","embedly","q","massrel-js","./embedly-widget","placeholder-image-generator"],function(e){var t=e("lodash"),n=e("embedly"),r=e("q"),i=e("massrel-js"),s=e("./embedly-widget"),o=e("placeholder-image-generator");r.stopUnhandledRejectionTracking();var u={promise:function(e,n){var i,s;return n=t.extend({},a,n),!e||!t.isFunction(N[e.sourceName])?(i=r.defer(),i.reject(),s=i.promise):s=N[e.sourceName](e,n),s},embedlyPromise:function(e,i){var s=r.defer();if(i&&!i.use_embedly)s.reject();else{var u=[];n(e).preview().then(function(e){if(!e.error_code&&e.object){var n=S(e.object.type),r=x(e.provider_name);if(n.photo||n.video){var a={};r.youtube&&(!e.images||!e.images.length)&&(e.images=[{caption:null,height:360,size:16076,url:o({width:480,height:360,template:"youtube"}),width:480}]),e.images&&e.images.length&&t.each(p,function(t){a[t]=e.images[0]});var f={type:n,provider:r,providerName:h[e.provider_name]||e.provider_name,photo_urls:a,author:e.author_name};if(n.video&&e.object.html){var l=e.object.html.match(/src=\"(.*?)\"/);if(i.autoplay_video&&l&&l.length>1&&l[1]){var c=l[1]+"&autoplay=true";f.embed_html=e.object.html.replace(l[1],c)}else f.embed_html=e.object.html}u.push(f)}}u.length===0?s.reject():s.resolve(u)}).fail(function(){s.reject()})}return s.promise}},a={autoplay_video:!1,prefetch:!1,loop_video:!1,muted:!1,secure:!1,use_embedly:!0},f={link:!1,video:!1,photo:!1},l={image:"photo",animated_gif:"video",youtube_video_media:"video"},c={vine:!1,twitter:!1,facebook:!1,google:!1,getglue:!1,youtube:!1,instagram:!1,vimeo:!1},h={YouTube:"youtube",Vine:"vine",Twitter:"twitter",Facebook:"facebook",GetGlue:"getglue","Google+":"google",Instagram:"instagram",Vimeo:"vimeo"},p=["huge","large","medium","small","thumb"],d={huge:"_n.",large:"_n.",medium:"_a.",small:"_s.",thumb:"_t."},v={huge:"w1500-h1500",large:"w800-h800",medium:"w400-h400",small:"w200-h200",thumb:"w75-h75"},m={huge:"large",large:"large",medium:"medium",small:"small",thumb:"thumb"},g={huge:"standard_resolution",large:"standard_resolution",medium:"low_resolution",small:"thumbnail",thumb:"thumbnail"},y={huge:"maxres",large:"standard",medium:"high",small:"medium",thumb:"default"},b=/https?:\/\/[^/]*googleusercontent.com\/.*\/w[0-9]+-h[0-9]+\/.*/,w=/https?:\/\/[^/]*fbcdn.*\/[^/]*_[nast]\.[a-zA-Z]+$/,E=/https?:\/\/video.twimg.com\/ext_tw_video\/.*?\/pu\/vid\/(.*?)x(.*?)\/.*?.mp4/,S=function(e,n){var r=e;e=l[e]||e;var i=t.extend({},f);return t.has(i,e)&&(i[e]=!0),n&&n.sourceNetwork&&n.sourceNetwork.facebook&&n.picture&&(i.photo=!0),i._originalType=r,i},x=function(e){e=h[e]||e;var n=t.extend({},c);return t.has(n,e)&&(n[e]=!0),n},T=function(e){return e&&e.user?"https://twitter.com/"+e.user.screen_name+"/status/"+e.id_str:""},N={twitter:function(e,n){var i=!1,o=!1,a=[],f=r.defer();if(e.entities){e.entities.media&&e.entities.media.length&&(i=!0,t.each(e.entities.media,function(r){var i={},o,u=S(r.type);t.each(m,function(e,t){o=r.sizes[e],i[t]={url:(n.secure?r.media_url_https:r.media_url)+":"+e,short_url:r.url,width:o.w,height:o.h}});if(u.photo)a.push({provider:x("twitter"),providerName:"twitter",type:u,link:T(e),photo_urls:i,author:e.user.screen_name});else if(u.video){var f=t(r.video_info.variants).filter(function(e){return e.content_type==="video/mp4"}).map(function(e){var t=i.huge.width,n=i.huge.height,r=E.exec(e.url);return r&&(t=parseInt(r[1],10),n=parseInt(r[2],10)),{url:e.url,content_type:e.content_type,bitrate:e.bitrate,width:t,height:n}}).sortBy(function(e){return e.height*e.width}).reverse().value();u._originalType==="animated_gif"&&(n=t.extend({},n,{loop_video:!0}));var l=s({video:f[0].url,image:i.huge.url,url:T(e)},n);a.push({provider:x("twitter"),providerName:"twitter",type:u,link:T(e),photo_urls:i,embed_html:l,author:e.user.screen_name,duration:r.video_info.duration_millis,video:f})}}));if(e.entities.urls&&e.entities.urls.length){i=!0,o=!0;var l=[];t.each(e.entities.urls,function(e){var t=u.embedlyPromise(e.expanded_url,n);l.push(t),t.then(function(e){a=a.concat(e)})}),r.allSettled(l).then(function(){a.length===0?f.reject():(t.each(a,function(t){t.link=T(e)}),f.resolve(a))})}}return o||(!i||a.length===0?f.reject():f.resolve(a)),f.promise},facebook:function(e){var n=r.defer(),i=S(e.type||e.kind,e);e.kind==="comment"&&e.attachment&&e.attachment.type==="photo"&&(e.picture=e.attachment.media.image.src,i.photo=!0);if(i.photo||i.link){var s={};if(e.images){var o=t.sortBy(e.images,"height"),u=p.slice().reverse();if(o.length===7){var a=[0,1,3,5,6];for(var f=0;f<a.length;f++){var l=u[f],c=o[a[f]];s[l]={url:c.source,height:c.height,width:c.width}}}else for(var f=0;f<u.length;f++){var l=u[f],c;f<o.length?c=o[f]:c=o[o.length-1],s[l]={url:c.source,height:c.height,width:c.width}}}else if(e.picture){var h=e.picture.replace(/v\/(.\/)?t1.0-\d*\/[p|s]\d*x\d*\//,"");h=h.replace(/v?\/t1.0-\d*(\/q\d*)?\/[p|s]\d*x\d*/,""),h=h.replace(/t1.0-\d*\/[p|s]\d*x\d*\//,"");var v=w.test(h);t.each(d,function(e,t){s[t]={url:v?h.replace(/_[nast]\./,e):h}})}var m;t.has(e,"from")?m=e.from.name:m=e.user.screen_name,n.resolve([{provider:x("facebook"),providerName:"facebook",type:i,photo_urls:s,link:e.link,name:e.name,caption:e.caption,description:e.description,author:m}]),t.has(e,"from")?n.author=e.from.name:n.author=e.user.screen_name}else n.reject();return n.promise},instagram:function(e,n){var i=r.defer();if(e.images){var s=S(e.type);if(s.photo||s.video){var o={};t.each(p,function(t){o[t]=e.images[g[t]],o[t].url=o[t].url.replace(/^https?:/,"")});var a=x("instagram"),f="instagram";if(s.photo)i.resolve([{provider:a,providerName:f,type:s,link:e.link,photo_urls:o,author:e.user.username}]);else if(s.video){var l=u.embedlyPromise(e.link,n);l.then(function(e){i.resolve(e)},function(){i.reject()})}}}else i.reject();return i.promise},google:function(e){var n=r.defer(),i=[];if(e.object&&e.object.attachments&&e.object.attachments.length){var s,o,u;t.each(e.object.attachments,function(n){s=S(n.objectType);if(!s.photo)return;u=b.test(n.image.url),o={},t.each(p,function(e){u?o[e]=t.extend({},n.image,{url:n.image.url.replace(/w[0-9]+-h[0-9]+/,v[e])}):o[e]=t.extend({},n.fullImage,{url:n.fullImage.url})}),i.push({provider:x("google"),providerName:"google",type:s,link:e.url,photo_urls:o,author:e.actor.displayName})})}return i.length===0?n.reject():n.resolve(i),n.promise},youtube:function(e,n){var i=r.defer();if(e.snippet){var s=S(e.kind),u={},a;t.each(p,function(t){var n=e.snippet.thumbnails[y[t]];n&&(u[t]=n,u[t].url=u[t].url.replace(/^https?:/,""),a||(a=u[t]))}),t.each(p,function(t){var n=e.snippet.thumbnails[y[t]];n||(u[t]=a,u[t].url=u[t].url.replace(/^https?:/,""))});var f=x("youtube"),l="youtube",c="//www.youtube.com/embed/"+e.youtube_video_id+"?rel=0";n.autoplay_video&&(c+="&autoplay=1");var h=t.map(u,function(e,t){var n=r.defer(),i=new Image;return i.onload=function(){this.width!==e.width&&this.height!==e.height?n.resolve([t,{width:e.width,height:e.height,url:o({width:e.width,height:e.height,template:"youtube"})}]):n.resolve([t,e])},i.src=e.url,n.promise});r.all(h).then(function(n){var r=t.zipObject(n);i.resolve([{provider:f,providerName:l,type:s,link:e.link,photo_urls:r,author:e.channelTitle,embed_url:c}])})}else i.reject();return i.promise},getglue:function(e){var n=r.defer(),i=[];if(e.object){var s=S(e.object.objectType),o={},u=x("getglue"),a="getglue";s.photo?(t.each(p,function(t){o[t]={url:e.object.link}}),i.push({provider:u,providerName:a,type:s,photo_urls:o,link:e.object.link})):s.video&&(t.each(p,function(t){o[t]={url:e.object.image}}),i.push({provider:u,providerName:a,type:s,photo_urls:o,link:e.object.link,author:e.user.username}))}return i.length>0?n.resolve(i):n.reject(),n.promise}};return u}),n("media-meta/index",["./js/main"],function(e){return e}),n("media-meta",["media-meta/index"],function(e){return e}),n("massrel-js-backbone-2/MediaCollection",["./backbone","./MediaModel","media-meta"],function(e,t,n){return e.Collection.extend({model:t})}),function(e){function rt(e,t,n){switch(arguments.length){case 2:return e!=null?e:t;case 3:return e!=null?e:t!=null?t:n;default:throw new Error("Implement me")}}function it(e,t){return a.call(e,t)}function st(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function ot(e){r.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+e)}function ut(e,t){var n=!0;return dt(function(){return n&&(ot(e),n=!1),t.apply(this,arguments)},t)}function at(e,t){tt[e]||(ot(t),tt[e]=!0)}function ft(e,t){return function(n){return gt(e.call(this,n),t)}}function lt(e,t){return function(n){return this.localeData().ordinal(e.call(this,n),t)}}function ct(){}function ht(e,t){t!==!1&&Dt(e),vt(this,e),this._d=new Date(+e._d)}function pt(e){var t=Ct(e),n=t.year||0,i=t.quarter||0,s=t.month||0,o=t.week||0,u=t.day||0,a=t.hour||0,f=t.minute||0,l=t.second||0,c=t.millisecond||0;this._milliseconds=+c+l*1e3+f*6e4+a*36e5,this._days=+u+o*7,this._months=+s+i*3+n*12,this._data={},this._locale=r.localeData(),this._bubble()}function dt(e,t){for(var n in t)it(t,n)&&(e[n]=t[n]);return it(t,"toString")&&(e.toString=t.toString),it(t,"valueOf")&&(e.valueOf=t.valueOf),e}function vt(e,t){var n,r,i;typeof t._isAMomentObject!="undefined"&&(e._isAMomentObject=t._isAMomentObject),typeof t._i!="undefined"&&(e._i=t._i),typeof t._f!="undefined"&&(e._f=t._f),typeof t._l!="undefined"&&(e._l=t._l),typeof t._strict!="undefined"&&(e._strict=t._strict),typeof t._tzm!="undefined"&&(e._tzm=t._tzm),typeof t._isUTC!="undefined"&&(e._isUTC=t._isUTC),typeof t._offset!="undefined"&&(e._offset=t._offset),typeof t._pf!="undefined"&&(e._pf=t._pf),typeof t._locale!="undefined"&&(e._locale=t._locale);if(y.length>0)for(n in y)r=y[n],i=t[r],typeof i!="undefined"&&(e[r]=i);return e}function mt(e){return e<0?Math.ceil(e):Math.floor(e)}function gt(e,t,n){var r=""+Math.abs(e),i=e>=0;while(r.length<t)r="0"+r;return(i?n?"+":"":"-")+r}function yt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t- +e.clone().add(n.months,"M"),n}function bt(e,t){var n;return t=Ft(t,e),e.isBefore(t)?n=yt(e,t):(n=yt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function wt(e,t){return function(n,i){var s,o;return i!==null&&!isNaN(+i)&&(at(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),o=n,n=i,i=o),n=typeof n=="string"?+n:n,s=r.duration(n,i),Et(this,s,e),this}}function Et(e,t,n,i){var s=t._milliseconds,o=t._days,u=t._months;i=i==null?!0:i,s&&e._d.setTime(+e._d+s*n),o&&mn(e,"Date",vn(e,"Date")+o*n),u&&dn(e,vn(e,"Month")+u*n),i&&r.updateOffset(e,o||u)}function St(e){return Object.prototype.toString.call(e)==="[object Array]"}function xt(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function Tt(e,t,n){var r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0,o;for(o=0;o<r;o++)(n&&e[o]!==t[o]||!n&&Lt(e[o])!==Lt(t[o]))&&s++;return s+i}function Nt(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=J[e]||K[t]||t}return e}function Ct(e){var t={},n,r;for(r in e)it(e,r)&&(n=Nt(r),n&&(t[n]=e[r]));return t}function kt(t){var n,i;if(t.indexOf("week")===0)n=7,i="day";else{if(t.indexOf("month")!==0)return;n=12,i="month"}r[t]=function(s,o){var u,a,f=r._locale[t],l=[];typeof s=="number"&&(o=s,s=e),a=function(e){var t=r().utc().set(i,e);return f.call(r._locale,t,s||"")};if(o!=null)return a(o);for(u=0;u<n;u++)l.push(a(u));return l}}function Lt(e){var t=+e,n=0;return t!==0&&isFinite(t)&&(t>=0?n=Math.floor(t):n=Math.ceil(t)),n}function At(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function Ot(e,t,n){return ln(r([e,11,31+t-n]),t,n).week}function Mt(e){return _t(e)?366:365}function _t(e){return e%4===0&&e%100!==0||e%400===0}function Dt(e){var t;e._a&&e._pf.overflow===-2&&(t=e._a[c]<0||e._a[c]>11?c:e._a[h]<1||e._a[h]>At(e._a[l],e._a[c])?h:e._a[p]<0||e._a[p]>24||e._a[p]===24&&(e._a[d]!==0||e._a[v]!==0||e._a[m]!==0)?p:e._a[d]<0||e._a[d]>59?d:e._a[v]<0||e._a[v]>59?v:e._a[m]<0||e._a[m]>999?m:-1,e._pf._overflowDayOfYear&&(t<l||t>h)&&(t=h),e._pf.overflow=t)}function Pt(t){return t._isValid==null&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&t._pf.charsLeftOver===0&&t._pf.unusedTokens.length===0&&t._pf.bigHour===e)),t._isValid}function Ht(e){return e?e.toLowerCase().replace("_","-"):e}function Bt(e){var t=0,n,r,i,s;while(t<e.length){s=Ht(e[t]).split("-"),n=s.length,r=Ht(e[t+1]),r=r?r.split("-"):null;while(n>0){i=jt(s.slice(0,n).join("-"));if(i)return i;if(r&&r.length>=n&&Tt(s,r,!0)>=n-1)break;n--}t++}return null}function jt(e){var n=null;if(!g[e]&&b)try{n=r.locale(),t("./locale/"+e),r.locale(n)}catch(i){}return g[e]}function Ft(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(r.isMoment(e)||xt(e)?+e:+r(e))- +n,n._d.setTime(+n._d+i),r.updateOffset(n,!1),n):r(e).local()}function It(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function qt(e){var t=e.match(x),n,r;for(n=0,r=t.length;n<r;n++)et[t[n]]?t[n]=et[t[n]]:t[n]=It(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=t[n]instanceof Function?t[n].call(i,e):t[n];return s}}function Rt(e,t){return e.isValid()?(t=Ut(t,e.localeData()),Q[t]||(Q[t]=qt(t)),Q[t](e)):e.localeData().invalidDate()}function Ut(e,t){function r(e){return t.longDateFormat(e)||e}var n=5;T.lastIndex=0;while(n>=0&&T.test(e))e=e.replace(T,r),T.lastIndex=0,n-=1;return e}function zt(e,t){var n,r=t._strict;switch(e){case"Q":return H;case"DDDD":return j;case"YYYY":case"GGGG":case"gggg":return r?F:k;case"Y":case"G":case"g":return q;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return r?I:L;case"S":if(r)return H;case"SS":if(r)return B;case"SSS":if(r)return j;case"DDD":return C;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return O;case"a":case"A":return t._locale._meridiemParse;case"x":return D;case"X":return P;case"Z":case"ZZ":return M;case"T":return _;case"SSSS":return A;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return r?B:N;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return N;case"Do":return r?t._locale._ordinalParse:t._locale._ordinalParseLenient;default:return n=new RegExp(Yt(Gt(e.replace("\\","")),"i")),n}}function Wt(e){e=e||"";var t=e.match(M)||[],n=t[t.length-1]||[],r=(n+"").match(X)||["-",0,0],i=+(r[1]*60)+Lt(r[2]);return r[0]==="+"?-i:i}function Xt(e,t,n){var i,s=n._a;switch(e){case"Q":t!=null&&(s[c]=(Lt(t)-1)*3);break;case"M":case"MM":t!=null&&(s[c]=Lt(t)-1);break;case"MMM":case"MMMM":i=n._locale.monthsParse(t,e,n._strict),i!=null?s[c]=i:n._pf.invalidMonth=t;break;case"D":case"DD":t!=null&&(s[h]=Lt(t));break;case"Do":t!=null&&(s[h]=Lt(parseInt(t.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":t!=null&&(n._dayOfYear=Lt(t));break;case"YY":s[l]=r.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":s[l]=Lt(t);break;case"a":case"A":n._isPm=n._locale.isPM(t);break;case"h":case"hh":n._pf.bigHour=!0;case"H":case"HH":s[p]=Lt(t);break;case"m":case"mm":s[d]=Lt(t);break;case"s":case"ss":s[v]=Lt(t);break;case"S":case"SS":case"SSS":case"SSSS":s[m]=Lt(("0."+t)*1e3);break;case"x":n._d=new Date(Lt(t));break;case"X":n._d=new Date(parseFloat(t)*1e3);break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=Wt(t);break;case"dd":case"ddd":case"dddd":i=n._locale.weekdaysParse(t),i!=null?(n._w=n._w||{},n._w.d=i):n._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=Lt(t));break;case"gg":case"GG":n._w=n._w||{},n._w[e]=r.parseTwoDigitYear(t)}}function Vt(e){var t,n,i,s,o,u,a;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(o=1,u=4,n=rt(t.GG,e._a[l],ln(r(),1,4).year),i=rt(t.W,1),s=rt(t.E,1)):(o=e._locale._week.dow,u=e._locale._week.doy,n=rt(t.gg,e._a[l],ln(r(),o,u).year),i=rt(t.w,1),t.d!=null?(s=t.d,s<o&&++i):t.e!=null?s=t.e+o:s=o),a=cn(n,i,s,u,o),e._a[l]=a.year,e._dayOfYear=a.dayOfYear}function $t(e){var t,n,r=[],i,s;if(e._d)return;i=Kt(e),e._w&&e._a[h]==null&&e._a[c]==null&&Vt(e),e._dayOfYear&&(s=rt(e._a[l],i[l]),e._dayOfYear>Mt(s)&&(e._pf._overflowDayOfYear=!0),n=on(s,0,e._dayOfYear),e._a[c]=n.getUTCMonth(),e._a[h]=n.getUTCDate());for(t=0;t<3&&e._a[t]==null;++t)e._a[t]=r[t]=i[t];for(;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[p]===24&&e._a[d]===0&&e._a[v]===0&&e._a[m]===0&&(e._nextDay=!0,e._a[p]=0),e._d=(e._useUTC?on:sn).apply(null,r),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm),e._nextDay&&(e._a[p]=24)}function Jt(e){var t;if(e._d)return;t=Ct(e._i),e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],$t(e)}function Kt(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Qt(t){if(t._f===r.ISO_8601){en(t);return}t._a=[],t._pf.empty=!0;var n=""+t._i,i,s,o,u,a,f=n.length,l=0;o=Ut(t._f,t._locale).match(x)||[];for(i=0;i<o.length;i++)u=o[i],s=(n.match(zt(u,t))||[])[0],s&&(a=n.substr(0,n.indexOf(s)),a.length>0&&t._pf.unusedInput.push(a),n=n.slice(n.indexOf(s)+s.length),l+=s.length),et[u]?(s?t._pf.empty=!1:t._pf.unusedTokens.push(u),Xt(u,s,t)):t._strict&&!s&&t._pf.unusedTokens.push(u);t._pf.charsLeftOver=f-l,n.length>0&&t._pf.unusedInput.push(n),t._pf.bigHour===!0&&t._a[p]<=12&&(t._pf.bigHour=e),t._isPm&&t._a[p]<12&&(t._a[p]+=12),t._isPm===!1&&t._a[p]===12&&(t._a[p]=0),$t(t),Dt(t)}function Gt(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i})}function Yt(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Zt(e){var t,n,r,i,s;if(e._f.length===0){e._pf.invalidFormat=!0,e._d=new Date(NaN);return}for(i=0;i<e._f.length;i++){s=0,t=vt({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._pf=st(),t._f=e._f[i],Qt(t);if(!Pt(t))continue;s+=t._pf.charsLeftOver,s+=t._pf.unusedTokens.length*10,t._pf.score=s;if(r==null||s<r)r=s,n=t}dt(e,n||t)}function en(e){var t,n,r=e._i,i=R.exec(r);if(i){e._pf.iso=!0;for(t=0,n=z.length;t<n;t++)if(z[t][1].exec(r)){e._f=z[t][0]+(i[6]||" ");break}for(t=0,n=W.length;t<n;t++)if(W[t][1].exec(r)){e._f+=W[t][0];break}r.match(M)&&(e._f+="Z"),Qt(e)}else e._isValid=!1}function tn(e){en(e),e._isValid===!1&&(delete e._isValid,r.createFromInputFallback(e))}function nn(e,t){var n=[],r;for(r=0;r<e.length;++r)n.push(t(e[r],r));return n}function rn(t){var n=t._i,i;n===e?t._d=new Date:xt(n)?t._d=new Date(+n):(i=w.exec(n))!==null?t._d=new Date(+i[1]):typeof n=="string"?tn(t):St(n)?(t._a=nn(n.slice(0),function(e){return parseInt(e,10)}),$t(t)):typeof n=="object"?Jt(t):typeof n=="number"?t._d=new Date(n):r.createFromInputFallback(t)}function sn(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return e<1970&&u.setFullYear(e),u}function on(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function un(e,t){if(typeof e=="string")if(!isNaN(e))e=parseInt(e,10);else{e=t.weekdaysParse(e);if(typeof e!="number")return null}return e}function an(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function fn(e,t,n){var i=r.duration(e).abs(),s=u(i.as("s")),o=u(i.as("m")),a=u(i.as("h")),f=u(i.as("d")),l=u(i.as("M")),c=u(i.as("y")),h=s<G.s&&["s",s]||o===1&&["m"]||o<G.m&&["mm",o]||a===1&&["h"]||a<G.h&&["hh",a]||f===1&&["d"]||f<G.d&&["dd",f]||l===1&&["M"]||l<G.M&&["MM",l]||c===1&&["y"]||["yy",c];return h[2]=t,h[3]=+e>0,h[4]=n,an.apply({},h)}function ln(e,t,n){var i=n-t,s=n-e.day(),o;return s>i&&(s-=7),s<i-7&&(s+=7),o=r(e).add(s,"d"),{week:Math.ceil(o.dayOfYear()/7),year:o.year()}}function cn(e,t,n,r,i){var s=on(e,0,1).getUTCDay(),o,u;return s=s===0?7:s,n=n!=null?n:i,o=i-s+(s>r?7:0)-(s<i?7:0),u=7*(t-1)+(n-i)+o+1,{year:u>0?e:e-1,dayOfYear:u>0?u:Mt(e-1)+u}}function hn(t){var n=t._i,i=t._f,s;return t._locale=t._locale||r.localeData(t._l),n===null||i===e&&n===""?r.invalid({nullInput:!0}):(typeof n=="string"&&(t._i=n=t._locale.preparse(n)),r.isMoment(n)?new ht(n,!0):(i?St(i)?Zt(t):Qt(t):rn(t),s=new ht(t),s._nextDay&&(s.add(1,"d"),s._nextDay=e),s))}function pn(e,t){var n,i;t.length===1&&St(t[0])&&(t=t[0]);if(!t.length)return r();n=t[0];for(i=1;i<t.length;++i)t[i][e](n)&&(n=t[i]);return n}function dn(e,t){var n;if(typeof t=="string"){t=e.localeData().monthsParse(t);if(typeof t!="number")return e}return n=Math.min(e.date(),At(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function vn(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function mn(e,t,n){return t==="Month"?dn(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function gn(e,t){return function(n){return n!=null?(mn(this,e,n),r.updateOffset(this,t),this):vn(this,e)}}function yn(e){return e*400/146097}function bn(e){return e*146097/400}function wn(e){r.duration.fn[e]=function(){return this._data[e]}}function En(e){if(typeof ender!="undefined")return;o=s.moment,e?s.moment=ut("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",r):s.moment=r}var r,i="2.8.4",s=typeof global!="undefined"?global:this,o,u=Math.round,a=Object.prototype.hasOwnProperty,f,l=0,c=1,h=2,p=3,d=4,v=5,m=6,g={},y=[],b=typeof module!="undefined"&&module&&module.exports,w=/^\/?Date\((\-?\d+)/i,E=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,S=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,x=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,T=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,N=/\d\d?/,C=/\d{1,3}/,k=/\d{1,4}/,L=/[+\-]?\d{1,6}/,A=/\d+/,O=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,M=/Z|[\+\-]\d\d:?\d\d/gi,_=/T/i,D=/[\+\-]?\d+/,P=/[\+\-]?\d+(\.\d{1,3})?/,H=/\d/,B=/\d\d/,j=/\d{3}/,F=/\d{4}/,I=/[+-]?\d{6}/,q=/[+-]?\d+/,R=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,U="YYYY-MM-DDTHH:mm:ssZ",z=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],W=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],X=/([\+\-]|\d\d)/gi,V="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),$={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},J={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},K={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Q={},G={s:45,m:45,h:22,d:26,M:11},Y="DDD w W M D d".split(" "),Z="M D H h m s w W".split(" "),et={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return gt(this.year()%100,2)},YYYY:function(){return gt(this.year(),4)},YYYYY:function(){return gt(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+gt(Math.abs(e),6)},gg:function(){return gt(this.weekYear()%100,2)},gggg:function(){return gt(this.weekYear(),4)},ggggg:function(){return gt(this.weekYear(),5)},GG:function(){return gt(this.isoWeekYear()%100,2)},GGGG:function(){return gt(this.isoWeekYear(),4)},GGGGG:function(){return gt(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return Lt(this.milliseconds()/100)},SS:function(){return gt(Lt(this.milliseconds()/10),2)},SSS:function(){return gt(this.milliseconds(),3)},SSSS:function(){return gt(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+gt(Lt(e/60),2)+":"+gt(Lt(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+gt(Lt(e/60),2)+gt(Lt(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},tt={},nt=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];while(Y.length)f=Y.pop(),et[f+"o"]=lt(et[f],f);while(Z.length)f=Z.pop(),et[f+f]=ft(et[f],2);et.DDDD=ft(et.DDD,3),dt(ct.prototype,{set:function(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e,t,n){var i,s,o;this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(i=0;i<12;i++){s=r.utc([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(o="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i"));if(n&&t==="MMMM"&&this._longMonthsParse[i].test(e))return i;if(n&&t==="MMM"&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,i;this._weekdaysParse||(this._weekdaysParse=[]);for(t=0;t<7;t++){this._weekdaysParse[t]||(n=r([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i"));if(this._weekdaysParse[t].test(e))return t}},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return(e+"").toLowerCase().charAt(0)==="p"},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t,n){var r=this._calendar[e];return typeof r=="function"?r.apply(t,[n]):r},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(e){return e},postformat:function(e){return e},week:function(e){return ln(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),r=function(t,n,r,i){var s;return typeof r=="boolean"&&(i=r,r=e),s={},s._isAMomentObject=!0,s._i=t,s._f=n,s._l=r,s._strict=i,s._isUTC=!1,s._pf=st(),hn(s)},r.suppressDeprecationWarnings=!1,r.createFromInputFallback=ut("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),r.min=function(){var e=[].slice.call(arguments,0);return pn("isBefore",e)},r.max=function(){var e=[].slice.call(arguments,0);return pn("isAfter",e)},r.utc=function(t,n,r,i){var s;return typeof r=="boolean"&&(i=r,r=e),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=r,s._i=t,s._f=n,s._strict=i,s._pf=st(),hn(s).utc()},r.unix=function(e){return r(e*1e3)},r.duration=function(e,t){var n=e,i=null,s,o,u,a;return r.isDuration(e)?n={ms:e._milliseconds,d:e._days,M:e._months}:typeof e=="number"?(n={},t?n[t]=e:n.milliseconds=e):(i=E.exec(e))?(s=i[1]==="-"?-1:1,n={y:0,d:Lt(i[h])*s,h:Lt(i[p])*s,m:Lt(i[d])*s,s:Lt(i[v])*s,ms:Lt(i[m])*s}):(i=S.exec(e))?(s=i[1]==="-"?-1:1,u=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*s},n={y:u(i[2]),M:u(i[3]),d:u(i[4]),h:u(i[5]),m:u(i[6]),s:u(i[7]),w:u(i[8])}):typeof n=="object"&&("from"in n||"to"in n)&&(a=bt(r(n.from),r(n.to)),n={},n.ms=a.milliseconds,n.M=a.months),o=new pt(n),r.isDuration(e)&&it(e,"_locale")&&(o._locale=e._locale),o},r.version=i,r.defaultFormat=U,r.ISO_8601=function(){},r.momentProperties=y,r.updateOffset=function(){},r.relativeTimeThreshold=function(t,n){return G[t]===e?!1:n===e?G[t]:(G[t]=n,!0)},r.lang=ut("moment.lang is deprecated. Use moment.locale instead.",function(e,t){return r.locale(e,t)}),r.locale=function(e,t){var n;return e&&(typeof t!="undefined"?n=r.defineLocale(e,t):n=r.localeData(e),n&&(r.duration._locale=r._locale=n)),r._locale._abbr},r.defineLocale=function(e,t){return t!==null?(t.abbr=e,g[e]||(g[e]=new ct),g[e].set(t),r.locale(e),g[e]):(delete g[e],null)},r.langData=ut("moment.langData is deprecated. Use moment.localeData instead.",function(e){return r.localeData(e)}),r.localeData=function(e){var t;e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr);if(!e)return r._locale;if(!St(e)){t=jt(e);if(t)return t;e=[e]}return Bt(e)},r.isMoment=function(e){return e instanceof ht||e!=null&&it(e,"_isAMomentObject")},r.isDuration=function(e){return e instanceof pt};for(f=nt.length-1;f>=0;--f)kt(nt[f]);r.normalizeUnits=function(e){return Nt(e)},r.invalid=function(e){var t=r.utc(NaN);return e!=null?dt(t._pf,e):t._pf.userInvalidated=!0,t},r.parseZone=function(){return r.apply(null,arguments).parseZone()},r.parseTwoDigitYear=function(e){return Lt(e)+(Lt(e)>68?1900:2e3)},dt(r.fn=ht.prototype,{clone:function(){return r(this)},valueOf:function(){return+this._d+(this._offset||0)*6e4},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=r(this).utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():Rt(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):Rt(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return Pt(this)},isDSTShifted:function(){return this._a?this.isValid()&&Tt(this._a,(this._isUTC?r.utc(this._a):r(this._a)).toArray())>0:!1},parsingFlags:function(){return dt({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.zone(0,e)},local:function(e){return this._isUTC&&(this.zone(0,e),this._isUTC=!1,e&&this.add(this._dateTzOffset(),"m")),this},format:function(e){var t=Rt(this,e||r.defaultFormat);return this.localeData().postformat(t)},add:wt(1,"add"),subtract:wt(-1,"subtract"),diff:function(e,t,n){var i=Ft(e,this),s=(this.zone()-i.zone())*6e4,o,u,a;return t=Nt(t),t==="year"||t==="month"?(o=(this.daysInMonth()+i.daysInMonth())*432e5,u=(this.year()-i.year())*12+(this.month()-i.month()),a=this-r(this).startOf("month")-(i-r(i).startOf("month")),a-=(this.zone()-r(this).startOf("month").zone()-(i.zone()-r(i).startOf("month").zone()))*6e4,u+=a/o,t==="year"&&(u/=12)):(o=this-i,u=t==="second"?o/1e3:t==="minute"?o/6e4:t==="hour"?o/36e5:t==="day"?(o-s)/864e5:t==="week"?(o-s)/6048e5:o),n?u:mt(u)},from:function(e,t){return r.duration({to:this,from:e}).locale(this.locale()).humanize(!t)},fromNow:function(e){return this.from(r(),e)},calendar:function(e){var t=e||r(),n=Ft(t,this).startOf("day"),i=this.diff(n,"days",!0),s=i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(s,this,r(t)))},isLeapYear:function(){return _t(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e!=null?(e=un(e,this.localeData()),this.add(e-t,"d")):t},month:gn("Month",!0),startOf:function(e){e=Nt(e);switch(e){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"?this.weekday(0):e==="isoWeek"&&this.isoWeekday(1),e==="quarter"&&this.month(Math.floor(this.month()/3)*3),this},endOf:function(t){return t=Nt(t),t===e||t==="millisecond"?this:this.startOf(t).add(1,t==="isoWeek"?"week":t).subtract(1,"ms")},isAfter:function(e,t){var n;return t=Nt(typeof t!="undefined"?t:"millisecond"),t==="millisecond"?(e=r.isMoment(e)?e:r(e),+this>+e):(n=r.isMoment(e)?+e:+r(e),n<+this.clone().startOf(t))},isBefore:function(e,t){var n;return t=Nt(typeof t!="undefined"?t:"millisecond"),t==="millisecond"?(e=r.isMoment(e)?e:r(e),+this<+e):(n=r.isMoment(e)?+e:+r(e),+this.clone().endOf(t)<n)},isSame:function(e,t){var n;return t=Nt(t||"millisecond"),t==="millisecond"?(e=r.isMoment(e)?e:r(e),+this===+e):(n=+r(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))},min:ut("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=r.apply(null,arguments),e<this?this:e}),max:ut("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=r.apply(null,arguments),e>this?this:e}),zone:function(e,t){var n=this._offset||0,i;return e==null?this._isUTC?n:this._dateTzOffset():(typeof e=="string"&&(e=Wt(e)),Math.abs(e)<16&&(e*=60),!this._isUTC&&t&&(i=this._dateTzOffset()),this._offset=e,this._isUTC=!0,i!=null&&this.subtract(i,"m"),n!==e&&(!t||this._changeInProgress?Et(this,r.duration(n-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):typeof this._i=="string"&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e?e=r(e).zone():e=0,(this.zone()-e)%60===0},daysInMonth:function(){return At(this.year(),this.month())},dayOfYear:function(e){var t=u((r(this).startOf("day")-r(this).startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")},quarter:function(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)},weekYear:function(e){var t=ln(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return e==null?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=ln(this,1,4).year;return e==null?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")},isoWeek:function(e){var t=ln(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")},isoWeekday:function(e){return e==null?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return Ot(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return Ot(this.year(),e.dow,e.doy)},get:function(e){return e=Nt(e),this[e]()},set:function(e,t){return e=Nt(e),typeof this[e]=="function"&&this[e](t),this},locale:function(t){var n;return t===e?this._locale._abbr:(n=r.localeData(t),n!=null&&(this._locale=n),this)},lang:ut("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===e?this.localeData():this.locale(t)}),localeData:function(){return this._locale},_dateTzOffset:function(){return Math.round(this._d.getTimezoneOffset()/15)*15}}),r.fn.millisecond=r.fn.milliseconds=gn("Milliseconds",!1),r.fn.second=r.fn.seconds=gn("Seconds",!1),r.fn.minute=r.fn.minutes=gn("Minutes",!1),r.fn.hour=r.fn.hours=gn("Hours",!0),r.fn.date=gn("Date",!0),r.fn.dates=ut("dates accessor is deprecated. Use date instead.",gn("Date",!0)),r.fn.year=gn("FullYear",!0),r.fn.years=ut("years accessor is deprecated. Use year instead.",gn("FullYear",!0)),r.fn.days=r.fn.day,r.fn.months=r.fn.month,r.fn.weeks=r.fn.week,r.fn.isoWeeks=r.fn.isoWeek,r.fn.quarters=r.fn.quarter,r.fn.toJSON=r.fn.toISOString,dt(r.duration.fn=pt.prototype,{_bubble:function(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data,i,s,o,u=0;r.milliseconds=e%1e3,i=mt(e/1e3),r.seconds=i%60,s=mt(i/60),r.minutes=s%60,o=mt(s/60),r.hours=o%24,t+=mt(o/24),u=mt(yn(t)),t-=mt(bn(u)),n+=mt(t/30),t%=30,u+=mt(n/12),n%=12,r.days=t,r.months=n,r.years=u},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return mt(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+Lt(this._months/12)*31536e6},humanize:function(e){var t=fn(this,!e,this.localeData());return e&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(e,t){var n=r.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=r.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=Nt(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,n;e=Nt(e);if(e==="month"||e==="year")return t=this._days+this._milliseconds/864e5,n=this._months+yn(t)*12,e==="month"?n:n/12;t=this._days+Math.round(bn(this._months/12));switch(e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return t*24+this._milliseconds/36e5;case"minute":return t*24*60+this._milliseconds/6e4;case"second":return t*24*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(t*24*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}},lang:r.fn.lang,locale:r.fn.locale,toIsoString:ut("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),r=Math.abs(this.hours()),i=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(r||i||s?"T":"")+(r?r+"H":"")+(i?i+"M":"")+(s?s+"S":""):"P0D"},localeData:function(){return this._locale}}),r.duration.fn.toString=r.duration.fn.toISOString;for(f in $)it($,f)&&wn(f.toLowerCase());r.duration.fn.asMilliseconds=function(){return this.as("ms")},r.duration.fn.asSeconds=function(){return this.as("s")},r.duration.fn.asMinutes=function(){return this.as("m")},r.duration.fn.asHours=function(){return this.as("h")},r.duration.fn.asDays=function(){return this.as("d")},r.duration.fn.asWeeks=function(){return this.as("weeks")},r.duration.fn.asMonths=function(){return this.as("M")},r.duration.fn.asYears=function(){return this.as("y")},r.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=Lt(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),b?module.exports=r:typeof n=="function"&&n.amd?(n("moment",["require","exports","module"],function(e,t,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(s.moment=o),r}),En(!0)):En()}.call(this),n("massrel-js-backbone-2/StatusModel",["require","./backbone","./MediaCollection","lodash","moment"],function(e){var t=e("./backbone"),n=e("./MediaCollection"),r=e("lodash"),i=e("moment"),s=new RegExp("(https?:)?//i\\.embed\\.ly/\\d+/image"),o={minute:i.duration(1,"minute").asMilliseconds(),hour:i.duration(1,"hour").asMilliseconds(),day:i.duration(1,"day").asMilliseconds(),week:i.duration(1,"week").asMilliseconds(),month:i.duration(1,"month").asMilliseconds()};return t.Model.extend({idAttribute:"_id",defaults:function(){return{retweet:!1,formattedDate:"",relativeDateFormat:"display",formattedText:"",klout:null,formattedStory:"",config:{},place:null,media:new n}},constructor:function(e,n){n=n||{},n.parse=!0,t.Model.call(this,e,n),this.generateFormattedDates()},embedlyImageProxyUrl:function(e){return s.test(e)||(e="//i.embed.ly/1/image?key=fd577f7497bf11e0b95d4040d3dc5c07&url="+window.encodeURIComponent(e)),e},parse:function(e){return e.raw=r.cloneDeep(e),e._id=r.uniqueId(),e.klout=this.kloutData(e),e},kloutData:function(e){var t=e.massrel&&e.massrel.klout||null;return t&&t.score&&(t.score_floor=Math.floor(window.parseInt(t.score))),t},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("created_at")))},formattedDates:function(e,t){var n={display:e,"short":e,full:e,timestamp:e},r=i(e,t);return r.isValid()&&(n={display:this.displayDate(r),"short":this.shortDate(r),full:this.fullDate(r),timestamp:this.timestamp(r)}),n},displayDate:function(e){return e.fromNow()},shortDate:function(e){var t=i().diff(e),n=i.duration(t),r;return t<o.minute?r=n.seconds()+"s":t<o.hour?r=n.minutes()+"m":t<o.day?r=n.hours()+"h":t<o.week?r=n.days()+"d":t<o.month?r=n.weeks()+"w":r=e.format("M/D/YY"),r},fullDate:function(e){return e.format("lll")},timestamp:function(e){return e.toISOString()}})}),function(){function r(t,n){return n=n||"",typeof t!="string"&&(t.global&&n.indexOf("g")<0&&(n+="g"),t.ignoreCase&&n.indexOf("i")<0&&(n+="i"),t.multiline&&n.indexOf("m")<0&&(n+="m"),t=t.source),new RegExp(t.replace(/#\{(\w+)\}/g,function(t,n){var r=e.txt.regexen[n]||"";return typeof r!="string"&&(r=r.source),r}),n)}function i(e,t){return e.replace(/#\{(\w+)\}/g,function(e,n){return t[n]||""})}function s(e,t,n){var r=String.fromCharCode(t);return n!==t&&(r+="-"+String.fromCharCode(n)),e.push(r),e}function g(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function E(e,t,n){return n?!e||e.match(t)&&RegExp["$&"]===e:typeof e=="string"&&e.match(t)&&RegExp["$&"]===e}if(typeof e=="undefined"||e===null)var e={};e.txt={},e.txt.regexen={};var t={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};e.txt.htmlEscape=function(e){return e&&e.replace(/[&"'><]/g,function(e){return t[e]})},e.txt.regexSupplant=r,e.txt.stringSupplant=i,e.txt.addCharsToCharClass=s;var o=String.fromCharCode,u=[o(32),o(133),o(160),o(5760),o(6158),o(8232),o(8233),o(8239),o(8287),o(12288)];s(u,9,13),s(u,8192,8202);var a=[o(65534),o(65279),o(65535)];s(a,8234,8238),e.txt.regexen.spaces_group=r(u.join("")),e.txt.regexen.spaces=r("["+u.join("")+"]"),e.txt.regexen.invalid_chars_group=r(a.join("")),e.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/,e.txt.regexen.rtl_chars=/[\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF]/mg,e.txt.regexen.non_bmp_code_pairs=/[\uD800-\uDBFF][\uDC00-\uDFFF]/mg;var f=[];s(f,1024,1279),s(f,1280,1319),s(f,11744,11775),s(f,42560,42655),s(f,1425,1471),s(f,1473,1474),s(f,1476,1477),s(f,1479,1479),s(f,1488,1514),s(f,1520,1524),s(f,64274,64296),s(f,64298,64310),s(f,64312,64316),s(f,64318,64318),s(f,64320,64321),s(f,64323,64324),s(f,64326,64335),s(f,1552,1562),s(f,1568,1631),s(f,1646,1747),s(f,1749,1756),s(f,1758,1768),s(f,1770,1775),s(f,1786,1788),s(f,1791,1791),s(f,1872,1919),s(f,2208,2208),s(f,2210,2220),s(f,2276,2302),s(f,64336,64433),s(f,64467,64829),s(f,64848,64911),s(f,64914,64967),s(f,65008,65019),s(f,65136,65140),s(f,65142,65276),s(f,8204,8204),s(f,3585,3642),s(f,3648,3662),s(f,4352,4607),s(f,12592,12677),s(f,43360,43391),s(f,44032,55215),s(f,55216,55295),s(f,65441,65500),s(f,12449,12538),s(f,12540,12542),s(f,65382,65439),s(f,65392,65392),s(f,65296,65305),s(f,65313,65338),s(f,65345,65370),s(f,12353,12438),s(f,12441,12446),s(f,13312,19903),s(f,19968,40959),s(f,173824,177983),s(f,177984,178207),s(f,194560,195103),s(f,12291,12291),s(f,12293,12293),s(f,12347,12347),e.txt.regexen.nonLatinHashtagChars=r(f.join(""));var l=[];s(l,192,214),s(l,216,246),s(l,248,255),s(l,256,591),s(l,595,596),s(l,598,599),s(l,601,601),s(l,603,603),s(l,611,611),s(l,616,616),s(l,623,623),s(l,626,626),s(l,649,649),s(l,651,651),s(l,699,699),s(l,768,879),s(l,7680,7935),e.txt.regexen.latinAccentChars=r(l.join("")),e.txt.regexen.hashSigns=/[#ï¼]/,e.txt.regexen.hashtagAlpha=r(/[a-z_#{latinAccentChars}#{nonLatinHashtagChars}]/i),e.txt.regexen.hashtagAlphaNumeric=r(/[a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}]/i),e.txt.regexen.endHashtagMatch=r(/^(?:#{hashSigns}|:\/\/)/),e.txt.regexen.hashtagBoundary=r(/(?:^|$|[^&a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}])/),e.txt.regexen.validHashtag=r(/(#{hashtagBoundary})(#{hashSigns})(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi),e.txt.regexen.validMentionPrecedingChars=/(?:^|[^a-zA-Z0-9_!#$%&*@ï¼ ]|(?:rt|RT|rT|Rt):?)/,e.txt.regexen.atSigns=/[@ï¼ ]/,e.txt.regexen.validMentionOrList=r("(#{validMentionPrecedingChars})(#{atSigns})([a-zA-Z0-9_]{1,20})(/[a-zA-Z][a-zA-Z0-9_-]{0,24})?","g"),e.txt.regexen.validReply=r(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/),e.txt.regexen.endMentionMatch=r(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/),e.txt.regexen.validUrlPrecedingChars=r(/(?:[^A-Za-z0-9@ï¼ $#ï¼#{invalid_chars_group}]|^)/),e.txt.regexen.invalidUrlWithoutProtocolPrecedingChars=/[-_.\/]$/,e.txt.regexen.invalidDomainChars=i("#{punct}#{spaces_group}#{invalid_chars_group}",e.txt.regexen),e.txt.regexen.validDomainChars=r(/[^#{invalidDomainChars}]/),e.txt.regexen.validSubdomain=r(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/),e.txt.regexen.validDomainName=r(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/),e.txt.regexen.validGTLD=r(RegExp("(?:(?:abogado|academy|accountants|active|actor|aero|agency|airforce|allfinanz|alsace|archi|army|arpa|asia|associates|attorney|auction|audio|autos|axa|band|bar|bargains|bayern|beer|berlin|best|bid|bike|bio|biz|black|blackfriday|blue|bmw|bnpparibas|boo|boutique|brussels|budapest|build|builders|business|buzz|bzh|cab|cal|camera|camp|cancerresearch|capetown|capital|caravan|cards|care|career|careers|casa|cash|cat|catering|center|ceo|cern|channel|cheap|christmas|chrome|church|citic|city|claims|cleaning|click|clinic|clothing|club|codes|coffee|college|cologne|com|community|company|computer|condos|construction|consulting|contractors|cooking|cool|coop|country|credit|creditcard|crs|cruises|cuisinella|cymru|dad|dance|dating|day|deals|degree|democrat|dental|dentist|desi|diamonds|diet|digital|direct|directory|discount|dnp|domains|durban|dvag|eat|edu|education|email|emerck|engineer|engineering|enterprises|equipment|esq|estate|eus|events|exchange|expert|exposed|fail|farm|feedback|finance|financial|fish|fishing|fitness|flights|florist|flsmidth|fly|foo|forsale|foundation|frl|frogans|fund|furniture|futbol|gal|gallery|gbiz|gent|gift|gifts|gives|glass|gle|global|globo|gmail|gmo|gmx|google|gop|gov|graphics|gratis|green|gripe|guide|guitars|guru|hamburg|haus|healthcare|help|here|hiphop|hiv|holdings|holiday|homes|horse|host|hosting|house|how|ibm|immo|immobilien|industries|info|ing|ink|institute|insure|int|international|investments|jetzt|jobs|joburg|juegos|kaufen|kim|kitchen|kiwi|koeln|krd|kred|lacaixa|land|lawyer|lease|lgbt|life|lighting|limited|limo|link|loans|london|lotto|ltda|luxe|luxury|maison|management|mango|market|marketing|media|meet|melbourne|meme|menu|miami|mil|mini|mobi|moda|moe|monash|mortgage|moscow|motorcycles|mov|museum|nagoya|name|navy|net|network|neustar|new|nexus|ngo|nhk|ninja|nra|nrw|nyc|okinawa|ong|onl|ooo|org|organic|otsuka|ovh|paris|partners|parts|pharmacy|photo|photography|photos|physio|pics|pictures|pink|pizza|place|plumbing|pohl|poker|post|praxi|press|pro|prod|productions|prof|properties|property|pub|qpon|quebec|realtor|recipes|red|rehab|reise|reisen|ren|rentals|repair|report|republican|rest|restaurant|reviews|rich|rio|rip|rocks|rodeo|rsvp|ruhr|ryukyu|saarland|sarl|sca|scb|schmidt|schule|scot|services|sexy|shiksha|shoes|singles|social|software|sohu|solar|solutions|soy|space|spiegel|supplies|supply|support|surf|surgery|suzuki|systems|taipei|tatar|tattoo|tax|technology|tel|tienda|tips|tirol|today|tokyo|tools|top|town|toys|trade|training|travel|tui|university|uno|uol|vacations|vegas|ventures|vermÃ¶gensberater|vermÃ¶gensberatung|versicherung|vet|viajes|villas|vision|vlaanderen|vodka|vote|voting|voto|voyage|wales|wang|watch|webcam|website|wed|wedding|whoswho|wien|wiki|williamhill|wme|work|works|world|wtc|wtf|xxx|xyz|yachts|yandex|yoga|yokohama|youtube|zip|zone|Ð´ÐµÑÐ¸|Ð¼Ð¾ÑÐºÐ²Ð°|Ð¾Ð½Ð»Ð°Ð¹Ð½|Ð¾ÑÐ³|ÑÑÑ|ÑÐ°Ð¹Ñ|Ø¨Ø§Ø²Ø§Ø±|Ø´Ø¨ÙØ©|ÙÙÙØ¹|à¤¸à¤à¤à¤ à¤¨|ã¿ããª|ä¸ç|ä¸­ä¿¡|ä¸­æç½|ä¼ä¸|ä½å±±|å¬å¸|å¬ç|åå|åæ |å¨çº¿|å¹¿ä¸|æç±ä½ |ææº|æ¿å¡|æºæ|æ¸¸æ|ç§»å¨|ç»ç»æºæ|ç½å|ç½ç»|éå¢|ì¼ì±)(?=[^0-9a-zA-Z@]|$))")),e.txt.regexen.validCCTLD=r(RegExp("(?:(?:ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bl|bm|bn|bo|bq|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mf|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|Ð±ÐµÐ»|Ð¼ÐºÐ´|Ð¼Ð¾Ð½|ÑÑ|ÑÑÐ±|ÑÐºÑ|ÒÐ°Ð·|Ø§ÙØ§Ø±Ø¯Ù|Ø§ÙØ¬Ø²Ø§Ø¦Ø±|Ø§ÙØ³Ø¹ÙØ¯ÙØ©|Ø§ÙÙØºØ±Ø¨|Ø§ÙØ§Ø±Ø§Øª|Ø§ÛØ±Ø§Ù|Ø¨Ú¾Ø§Ø±Øª|ØªÙÙØ³|Ø³ÙØ¯Ø§Ù|Ø³ÙØ±ÙØ©|Ø¹Ø±Ø§Ù|Ø¹ÙØ§Ù|ÙÙØ³Ø·ÙÙ|ÙØ·Ø±|ÙØµØ±|ÙÙÙØ³ÙØ§|Ù¾Ø§Ú©Ø³ØªØ§Ù|à¤­à¤¾à¤°à¤¤|à¦¬à¦¾à¦à¦²à¦¾|à¦­à¦¾à¦°à¦¤|à¨­à¨¾à¨°à¨¤|àª­àª¾àª°àª¤|à®à®¨à¯à®¤à®¿à®¯à®¾|à®à®²à®à¯à®à¯|à®à®¿à®à¯à®à®ªà¯à®ªà¯à®°à¯|à°­à°¾à°°à°¤à±|à¶½à¶à¶à·|à¹à¸à¸¢|áá|ä¸­å½|ä¸­å|å°æ¹¾|å°ç£|æ°å å¡|é¦æ¸¯|íêµ­)(?=[^0-9a-zA-Z@]|$))")),e.txt.regexen.validPunycode=r(/(?:xn--[0-9a-z]+)/),e.txt.regexen.validSpecialCCTLD=r(RegExp("(?:(?:co|tv)(?=[^0-9a-zA-Z@]|$))")),e.txt.regexen.validDomain=r(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/),e.txt.regexen.validAsciiDomain=r(/(?:(?:[\-a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi),e.txt.regexen.invalidShortDomain=r(/^#{validDomainName}#{validCCTLD}$/i),e.txt.regexen.validSpecialShortDomain=r(/^#{validDomainName}#{validSpecialCCTLD}$/i),e.txt.regexen.validPortNumber=r(/[0-9]+/),e.txt.regexen.validGeneralUrlPathChars=r(/[a-z0-9!\*';:=\+,\.\$\/%#\[\]\-_~@|&#{latinAccentChars}]/i),e.txt.regexen.validUrlBalancedParens=r("\\((?:#{validGeneralUrlPathChars}+|(?:#{validGeneralUrlPathChars}*\\(#{validGeneralUrlPathChars}+\\)#{validGeneralUrlPathChars}*))\\)","i"),e.txt.regexen.validUrlPathEndingChars=r(/[\+\-a-z0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i),e.txt.regexen.validUrlPath=r("(?:(?:#{validGeneralUrlPathChars}*(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*#{validUrlPathEndingChars})|(?:@#{validGeneralUrlPathChars}+/))","i"),e.txt.regexen.validUrlQueryChars=/[a-z0-9!?\*'@\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i,e.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i,e.txt.regexen.extractUrl=r("((#{validUrlPrecedingChars})((https?:\\/\\/)?(#{validDomain})(?::(#{validPortNumber}))?(\\/#{validUrlPath}*)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi"),e.txt.regexen.validTcoUrl=/^https?:\/\/t\.co\/[a-z0-9]+/i,e.txt.regexen.urlHasProtocol=/^https?:\/\//i,e.txt.regexen.urlHasHttps=/^https:\/\//i,e.txt.regexen.cashtag=/[a-z]{1,6}(?:[._][a-z]{1,2})?/i,e.txt.regexen.validCashtag=r("(^|#{spaces})(\\$)(#{cashtag})(?=$|\\s|[#{punct}])","gi"),e.txt.regexen.validateUrlUnreserved=/[a-z0-9\-._~]/i,e.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i,e.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i,e.txt.regexen.validateUrlPchar=r("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|[:|@])","i"),e.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i,e.txt.regexen.validateUrlUserinfo=r("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*","i"),e.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i,e.txt.regexen.validateUrlIpv4=r(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i),e.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i,e.txt.regexen.validateUrlIp=r("(?:#{validateUrlIpv4}|#{validateUrlIpv6})","i"),e.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i,e.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i,e.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i,e.txt.regexen.validateUrlDomain=r(/(?:(?:#{validateUrlSubDomainSegment]}\.)*(?:#{validateUrlDomainSegment]}\.)#{validateUrlDomainTld})/i),e.txt.regexen.validateUrlHost=r("(?:#{validateUrlIp}|#{validateUrlDomain})","i"),e.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,e.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,e.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,e.txt.regexen.validateUrlUnicodeDomain=r(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i),e.txt.regexen.validateUrlUnicodeHost=r("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})","i"),e.txt.regexen.validateUrlPort=/[0-9]{1,5}/,e.txt.regexen.validateUrlUnicodeAuthority=r("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?","i"),e.txt.regexen.validateUrlAuthority=r("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?","i"),e.txt.regexen.validateUrlPath=r(/(\/#{validateUrlPchar}*)*/i),e.txt.regexen.validateUrlQuery=r(/(#{validateUrlPchar}|\/|\?)*/i),e.txt.regexen.validateUrlFragment=r(/(#{validateUrlPchar}|\/|\?)*/i),e.txt.regexen.validateUrlUnencoded=r("^(?:([^:/?#]+):\\/\\/)?([^/?#]*)([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$","i");var c="tweet-url list-slug",h="tweet-url username",p="tweet-url hashtag",d="tweet-url cashtag",v={urlClass:!0,listClass:!0,usernameClass:!0,hashtagClass:!0,cashtagClass:!0,usernameUrlBase:!0,listUrlBase:!0,hashtagUrlBase:!0,cashtagUrlBase:!0,usernameUrlBlock:!0,listUrlBlock:!0,hashtagUrlBlock:!0,linkUrlBlock:!0,usernameIncludeSymbol:!0,suppressLists:!0,suppressNoFollow:!0,targetBlank:!0,suppressDataScreenName:!0,urlEntities:!0,symbolTag:!0,textWithSymbolTag:!0,urlTarget:!0,invisibleTagAttrs:!0,linkAttributeBlock:!0,linkTextBlock:!0,htmlEscapeNonEntities:!0},m={disabled:!0,readonly:!0,multiple:!0,checked:!0};e.txt.tagAttrs=function(t){var n="";for(var r in t){var i=t[r];m[r]&&(i=i?r:null);if(i==null)continue;n+=" "+e.txt.htmlEscape(r)+'="'+e.txt.htmlEscape(i.toString())+'"'}return n},e.txt.linkToText=function(t,n,r,s){s.suppressNoFollow||(r.rel="nofollow"),s.linkAttributeBlock&&s.linkAttributeBlock(t,r),s.linkTextBlock&&(n=s.linkTextBlock(t,n));var o={text:n,attr:e.txt.tagAttrs(r)};return i("<a#{attr}>#{text}</a>",o)},e.txt.linkToTextWithSymbol=function(t,n,r,i,s){var o=s.symbolTag?"<"+s.symbolTag+">"+n+"</"+s.symbolTag+">":n;r=e.txt.htmlEscape(r);var u=s.textWithSymbolTag?"<"+s.textWithSymbolTag+">"+r+"</"+s.textWithSymbolTag+">":r;return s.usernameIncludeSymbol||!n.match(e.txt.regexen.atSigns)?e.txt.linkToText(t,o+u,i,s):o+e.txt.linkToText(t,u,i,s)},e.txt.linkToHashtag=function(t,n,r){var i=n.substring(t.indices[0],t.indices[0]+1),s=e.txt.htmlEscape(t.hashtag),o=g(r.htmlAttrs||{});return o.href=r.hashtagUrlBase+s,o.title="#"+s,o["class"]=r.hashtagClass,s.charAt(0).match(e.txt.regexen.rtl_chars)&&(o["class"]+=" rtl"),r.targetBlank&&(o.target="_blank"),e.txt.linkToTextWithSymbol(t,i,s,o,r)},e.txt.linkToCashtag=function(t,n,r){var i=e.txt.htmlEscape(t.cashtag),s=g(r.htmlAttrs||{});return s.href=r.cashtagUrlBase+i,s.title="$"+i,s["class"]=r.cashtagClass,r.targetBlank&&(s.target="_blank"),e.txt.linkToTextWithSymbol(t,"$",i,s,r)},e.txt.linkToMentionAndList=function(t,n,r){var i=n.substring(t.indices[0],t.indices[0]+1),s=e.txt.htmlEscape(t.screenName),o=e.txt.htmlEscape(t.listSlug),u=t.listSlug&&!r.suppressLists,a=g(r.htmlAttrs||{});return a["class"]=u?r.listClass:r.usernameClass,a.href=u?r.listUrlBase+s+o:r.usernameUrlBase+s,!u&&!r.suppressDataScreenName&&(a["data-screen-name"]=s),r.targetBlank&&(a.target="_blank"),e.txt.linkToTextWithSymbol(t,i,u?s+o:s,a,r)},e.txt.linkToUrl=function(t,n,r){var i=t.url,s=i,o=e.txt.htmlEscape(s),u=r.urlEntities&&r.urlEntities[i]||t;u.display_url&&(o=e.txt.linkTextWithEntity(u,r));var a=g(r.htmlAttrs||{});return i.match(e.txt.regexen.urlHasProtocol)||(i="http://"+i),a.href=i,r.targetBlank&&(a.target="_blank"),r.urlClass&&(a["class"]=r.urlClass),r.urlTarget&&(a.target=r.urlTarget),!r.title&&u.display_url&&(a.title=u.expanded_url),e.txt.linkToText(t,o,a,r)},e.txt.linkTextWithEntity=function(t,n){var r=t.display_url,s=t.expanded_url,o=r.replace(/â¦/g,"");if(s.indexOf(o)!=-1){var u=s.indexOf(o),a={displayUrlSansEllipses:o,beforeDisplayUrl:s.substr(0,u),afterDisplayUrl:s.substr(u+o.length),precedingEllipsis:r.match(/^â¦/)?"â¦":"",followingEllipsis:r.match(/â¦$/)?"â¦":""};for(var f in a)a.hasOwnProperty(f)&&(a[f]=e.txt.htmlEscape(a[f]));return a.invisible=n.invisibleTagAttrs,i("<span class='tco-ellipsis'>#{precedingEllipsis}<span #{invisible}>&nbsp;</span></span><span #{invisible}>#{beforeDisplayUrl}</span><span class='js-display-url'>#{displayUrlSansEllipses}</span><span #{invisible}>#{afterDisplayUrl}</span><span class='tco-ellipsis'><span #{invisible}>&nbsp;</span>#{followingEllipsis}</span>",a)}return r},e.txt.autoLinkEntities=function(t,n,r){r=g(r||{}),r.hashtagClass=r.hashtagClass||p,r.hashtagUrlBase=r.hashtagUrlBase||"https://twitter.com/#!/search?q=%23",r.cashtagClass=r.cashtagClass||d,r.cashtagUrlBase=r.cashtagUrlBase||"https://twitter.com/#!/search?q=%24",r.listClass=r.listClass||c,r.usernameClass=r.usernameClass||h,r.usernameUrlBase=r.usernameUrlBase||"https://twitter.com/",r.listUrlBase=r.listUrlBase||"https://twitter.com/",r.htmlAttrs=e.txt.extractHtmlAttrsFromOptions(r),r.invisibleTagAttrs=r.invisibleTagAttrs||"style='position:absolute;left:-9999px;'";var i,s,o;if(r.urlEntities){i={};for(s=0,o=r.urlEntities.length;s<o;s++)i[r.urlEntities[s].url]=r.urlEntities[s];r.urlEntities=i}var u="",a=0;n.sort(function(e,t){return e.indices[0]-t.indices[0]});var f=r.htmlEscapeNonEntities?e.txt.htmlEscape:function(e){return e};for(var s=0;s<n.length;s++){var l=n[s];u+=f(t.substring(a,l.indices[0])),l.url?u+=e.txt.linkToUrl(l,t,r):l.hashtag?u+=e.txt.linkToHashtag(l,t,r):l.screenName?u+=e.txt.linkToMentionAndList(l,t,r):l.cashtag&&(u+=e.txt.linkToCashtag(l,t,r)),a=l.indices[1]}return u+=f(t.substring(a,t.length)),u},e.txt.autoLinkWithJSON=function(t,n,r){if(n.user_mentions)for(var i=0;i<n.user_mentions.length;i++)n.user_mentions[i].screenName=n.user_mentions[i].screen_name;if(n.hashtags)for(var i=0;i<n.hashtags.length;i++)n.hashtags[i].hashtag=n.hashtags[i].text;if(n.symbols)for(var i=0;i<n.symbols.length;i++)n.symbols[i].cashtag=n.symbols[i].text;var s=[];for(var o in n)s=s.concat(n[o]);return e.txt.modifyIndicesFromUnicodeToUTF16(t,s),e.txt.autoLinkEntities(t,s,r)},e.txt.extractHtmlAttrsFromOptions=function(e){var t={};for(var n in e){var r=e[n];if(v[n])continue;m[n]&&(r=r?n:null);if(r==null)continue;t[n]=r}return t},e.txt.autoLink=function(t,n){var r=e.txt.extractEntitiesWithIndices(t,{extractUrlsWithoutProtocol:!1});return e.txt.autoLinkEntities(t,r,n)},e.txt.autoLinkUsernamesOrLists=function(t,n){var r=e.txt.extractMentionsOrListsWithIndices(t);return e.txt.autoLinkEntities(t,r,n)},e.txt.autoLinkHashtags=function(t,n){var r=e.txt.extractHashtagsWithIndices(t);return e.txt.autoLinkEntities(t,r,n)},e.txt.autoLinkCashtags=function(t,n){var r=e.txt.extractCashtagsWithIndices(t);return e.txt.autoLinkEntities(t,r,n)},e.txt.autoLinkUrlsCustom=function(t,n){var r=e.txt.extractUrlsWithIndices(t,{extractUrlsWithoutProtocol:!1});return e.txt.autoLinkEntities(t,r,n)},e.txt.removeOverlappingEntities=function(e){e.sort(function(e,t){return e.indices[0]-t.indices[0]});var t=e[0];for(var n=1;n<e.length;n++)t.indices[1]>e[n].indices[0]?(e.splice(n,1),n--):t=e[n]},e.txt.extractEntitiesWithIndices=function(t,n){var r=e.txt.extractUrlsWithIndices(t,n).concat(e.txt.extractMentionsOrListsWithIndices(t)).concat(e.txt.extractHashtagsWithIndices(t,{checkUrlOverlap:!1})).concat(e.txt.extractCashtagsWithIndices(t));return r.length==0?[]:(e.txt.removeOverlappingEntities(r),r)},e.txt.extractMentions=function(t){var n=[],r=e.txt.extractMentionsWithIndices(t);for(var i=0;i<r.length;i++){var s=r[i].screenName;n.push(s)}return n},e.txt.extractMentionsWithIndices=function(t){var n=[],r,i=e.txt.extractMentionsOrListsWithIndices(t);for(var s=0;s<i.length;s++)r=i[s],r.listSlug==""&&n.push({screenName:r.screenName,indices:r.indices});return n},e.txt.extractMentionsOrListsWithIndices=function(t){if(!t||!t.match(e.txt.regexen.atSigns))return[];var n=[],r;return t.replace(e.txt.regexen.validMentionOrList,function(t,r,i,s,o,u,a){var f=a.slice(u+t.length);if(!f.match(e.txt.regexen.endMentionMatch)){o=o||"";var l=u+r.length,c=l+s.length+o.length+1;n.push({screenName:s,listSlug:o,indices:[l,c]})}}),n},e.txt.extractReplies=function(t){if(!t)return null;var n=t.match(e.txt.regexen.validReply);return!n||RegExp.rightContext.match(e.txt.regexen.endMentionMatch)?null:n[1]},e.txt.extractUrls=function(t,n){var r=[],i=e.txt.extractUrlsWithIndices(t,n);for(var s=0;s<i.length;s++)r.push(i[s].url);return r},e.txt.extractUrlsWithIndices=function(t,n){n||(n={extractUrlsWithoutProtocol:!0});if(!t||(n.extractUrlsWithoutProtocol?!t.match(/\./):!t.match(/:/)))return[];var r=[];while(e.txt.regexen.extractUrl.exec(t)){var i=RegExp.$2,s=RegExp.$3,o=RegExp.$4,u=RegExp.$5,a=RegExp.$7,f=e.txt.regexen.extractUrl.lastIndex,l=f-s.length;if(!o){if(!n.extractUrlsWithoutProtocol||i.match(e.txt.regexen.invalidUrlWithoutProtocolPrecedingChars))continue;var c=null,h=0;u.replace(e.txt.regexen.validAsciiDomain,function(t){var n=u.indexOf(t,h);h=n+t.length,c={url:t,indices:[l+n,l+h]},(a||t.match(e.txt.regexen.validSpecialShortDomain)||!t.match(e.txt.regexen.invalidShortDomain))&&r.push(c)});if(c==null)continue;a&&(c.url=s.replace(u,c.url),c.indices[1]=f)}else s.match(e.txt.regexen.validTcoUrl)&&(s=RegExp.lastMatch,f=l+s.length),r.push({url:s,indices:[l,f]})}return r},e.txt.extractHashtags=function(t){var n=[],r=e.txt.extractHashtagsWithIndices(t);for(var i=0;i<r.length;i++)n.push(r[i].hashtag);return n},e.txt.extractHashtagsWithIndices=function(t,n){n||(n={checkUrlOverlap:!0});if(!t||!t.match(e.txt.regexen.hashSigns))return[];var r=[];t.replace(e.txt.regexen.validHashtag,function(t,n,i,s,o,u){var a=u.slice(o+t.length);if(a.match(e.txt.regexen.endHashtagMatch))return;var f=o+n.length,l=f+s.length+1;r.push({hashtag:s,indices:[f,l]})});if(n.checkUrlOverlap){var i=e.txt.extractUrlsWithIndices(t);if(i.length>0){var s=r.concat(i);e.txt.removeOverlappingEntities(s),r=[];for(var o=0;o<s.length;o++)s[o].hashtag&&r.push(s[o])}}return r},e.txt.extractCashtags=function(t){var n=[],r=e.txt.extractCashtagsWithIndices(t);for(var i=0;i<r.length;i++)n.push(r[i].cashtag);return n},e.txt.extractCashtagsWithIndices=function(t){if(!t||t.indexOf("$")==-1)return[];var n=[];return t.replace(e.txt.regexen.validCashtag,function(e,t,r,i,s,o){var u=s+t.length,a=u+i.length+1;n.push({cashtag:i,indices:[u,a]})}),n},e.txt.modifyIndicesFromUnicodeToUTF16=function(t,n){e.txt.convertUnicodeIndices(t,n,!1)},e.txt.modifyIndicesFromUTF16ToUnicode=function(t,n){e.txt.convertUnicodeIndices(t,n,!0)},e.txt.getUnicodeTextLength=function(t){return t.replace(e.txt.regexen.non_bmp_code_pairs," ").length},e.txt.convertUnicodeIndices=function(e,t,n){if(t.length==0)return;var r=0,i=0;t.sort(function(e,t){return e.indices[0]-t.indices[0]});var s=0,o=t[0];while(r<e.length){if(o.indices[0]==(n?r:i)){var u=o.indices[1]-o.indices[0];o.indices[0]=n?i:r,o.indices[1]=o.indices[0]+u,s++;if(s==t.length)break;o=t[s]}var a=e.charCodeAt(r);55296<=a&&a<=56319&&r<e.length-1&&(a=e.charCodeAt(r+1),56320<=a&&a<=57343&&r++),i++,r++}},e.txt.splitTags=function(e){var t=e.split("<"),n,r=[],i;for(var s=0;s<t.length;s+=1){i=t[s];if(!i)r.push("");else{n=i.split(">");for(var o=0;o<n.length;o+=1)r.push(n[o])}}return r},e.txt.hitHighlight=function(t,n,r){var i="em";n=n||[],r=r||{};if(n.length===0)return t;var s=r.tag||i,o=["<"+s+">","</"+s+">"],u=e.txt.splitTags(t),a,f,l="",c=0,h=u[0],p=0,d=0,v=!1,m=h,g=[],y,b,w,E,S;for(a=0;a<n.length;a+=1)for(f=0;f<n[a].length;f+=1)g.push(n[a][f]);for(y=0;y<g.length;y+=1){b=g[y],w=o[y%2],E=!1;while(h!=null&&b>=p+h.length)l+=m.slice(d),v&&b===p+m.length&&(l+=w,E=!0),u[c+1]&&(l+="<"+u[c+1]+">"),p+=m.length,d=0,c+=2,h=u[c],m=h,v=!1;!E&&h!=null?(S=b-p,l+=m.slice(d,S)+w,d=S,y%2===0?v=!0:v=!1):E||(E=!0,l+=w)}if(h!=null){d<m.length&&(l+=m.slice(d));for(y=c+1;y<u.length;y+=1)l+=y%2===0?u[y]:"<"+u[y]+">"}return l};var y=140,b=[o(65534),o(65279),o(65535),o(8234),o(8235),o(8236),o(8237),o(8238)];e.txt.getTweetLength=function(t,n){n||(n={short_url_length:22,short_url_length_https:23});var r=e.txt.getUnicodeTextLength(t),i=e.txt.extractUrlsWithIndices(t);e.txt.modifyIndicesFromUTF16ToUnicode(t,i);for(var s=0;s<i.length;s++)r+=i[s].indices[0]-i[s].indices[1],i[s].url.toLowerCase().match(e.txt.regexen.urlHasHttps)?r+=n.short_url_length_https:r+=n.short_url_length;return r},e.txt.isInvalidTweet=function(t){if(!t)return"empty";if(e.txt.getTweetLength(t)>y)return"too_long";for(var n=0;n<b.length;n++)if(t.indexOf(b[n])>=0)return"invalid_characters";return!1},e.txt.isValidTweetText=function(t){return!e.txt.isInvalidTweet(t)},e.txt.isValidUsername=function(t){if(!t)return!1;var n=e.txt.extractMentions(t);return n.length===1&&n[0]===t.slice(1)};var w=r(/^#{validMentionOrList}$/);e.txt.isValidList=function(e){var t=e.match(w);return!!t&&t[1]==""&&!!t[4]},e.txt.isValidHashtag=function(t){if(!t)return!1;var n=e.txt.extractHashtags(t);return n.length===1&&n[0]===t.slice(1)},e.txt.isValidUrl=function(t,n,r){n==null&&(n=!0),r==null&&(r=!0);if(!t)return!1;var i=t.match(e.txt.regexen.validateUrlUnencoded);if(!i||i[0]!==t)return!1;var s=i[1],o=i[2],u=i[3],a=i[4],f=i[5];return(!r||E(s,e.txt.regexen.validateUrlScheme)&&s.match(/^https?$/i))&&E(u,e.txt.regexen.validateUrlPath)&&E(a,e.txt.regexen.validateUrlQuery,!0)&&E(f,e.txt.regexen.validateUrlFragment,!0)?n&&E(o,e.txt.regexen.validateUrlUnicodeAuthority)||!n&&E(o,e.txt.regexen.validateUrlAuthority):!1},typeof module!="undefined"&&module.exports&&(module.exports=e.txt),typeof n=="function"&&n.amd&&n("twitter-text/twitter-text",[],e.txt);if(typeof window!="undefined")if(window.twttr)for(var S in e)window.twttr[S]=e[S];else window.twttr=e}(),n("twitter-text",["twitter-text/twitter-text"],function(e){return e}),n("massrel-js-backbone-2/TwitterStatusModel",["require","massrel-js","./StatusModel","twitter-text","lodash"],function(e){var t=e("massrel-js"),n=e("./StatusModel"),r=e("twitter-text"),i=e("lodash"),s={thumb:"_normal",small:"_normal",medium:"_bigger",large:"_reasonably_small",huge:""},o=["network","sourceNetwork","sourceName","massrel"],u=["original_referer"],a={video:!0,animated_gif:!0},f="ddd MMM DD HH:mm:ss ZZ YYYY";return n.extend({defaults:i.extend(i.result(n.prototype,"defaults"),{original_referer:t.intents.original_referer,relativeDateFormat:"short"}),parse:function(e){e=n.prototype.parse.apply(this,arguments);if(e.retweeted_status){var t=e;e=e.retweeted_status,e.original_status=t,e.raw=t.raw,delete e.original_status.retweeted_status,delete e.original_status.raw,e.retweet=!0,e.retweeted_by_user=e.original_status.user,i.extend(e,i.pick(e.original_status,o)),e.klout=this.kloutData(e)}e.extended_entities&&e.extended_entities.media&&e.extended_entities.media.length>0&&i.each(e.entities.media,function(t,n){var r=i.find(e.extended_entities.media,{id:t.id});r&&a[r.type]===!0&&(e.entities.media[n]=r)});var s=[];e.entities&&(e.entities.urls&&e.entities.urls.length>0&&(s=s.concat(e.entities.urls)),e.entities.media&&e.entities.media.length>0&&(s=s.concat(e.entities.media))),e.formattedText=r.autoLink(e.text,{usernameIncludeSymbol:!0,urlEntities:s});var u=e.geo||e.geo_hint;return u&&(e.coordinates=u.coordinates),e},constructor:function(){n.apply(this,arguments),this.generateIntentUrls(),this.generateAvatarUrl(),this.on("change:original_referer",i.bind(this.generateIntentUrls,this)),this.on("change:avatar_resolution",i.bind(this.generateAvatarUrl,this))},generateAvatarUrl:function(){var e=this.get("avatar_resolution"),t=this.get("user"),n=s[e];if(n){var r=t.profile_image_url_https.replace("_normal",n);t.profile_image_url_https=r}},generateIntentUrls:function(){var e=i.pick(this.toJSON(),u),n=this.get("id_str");this.set("replyUrl",t.intents.reply(n,e)),this.set("retweetUrl",t.intents.retweet(n,e)),this.set("favUrl",t.intents.favorite(n,e))},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("created_at"),f))}})}),n("massrel-js-backbone-2/FacebookStatusModel",["require","./StatusModel","twitter-text","lodash"],function(e){var t=e("./StatusModel"),n=e("twitter-text"),r=e("lodash");return t.extend({parse:function(e){e=t.prototype.parse.apply(this,arguments);var n="https://www.facebook.com/",i=e.facebook_id.split("_"),s=e.type;r.contains(["photo","video","link","post"],s)?n+=[i[0],"posts",i[1]].join("/"):e.kind==="comment"?i.length===2?n+=i[0]+"?comment_id="+i[1]:(n+=[i[0],"posts",i[1]].join("/"),i[2]&&(n+="?comment_id="+i[2])):n+=e.facebook_id,e.permalink=n,e.action_available={comment:!0,share:!1,like:!1},e.kind==="comment"&&(e.action_available.comment=!1),e.share_text&&e.story&&(e.formattedStory=this.autoLink(e.story)),e.originalStatus=r.extend({},e),typeof e.originalStatus.id=="string"&&(e.originalStatus.id=e.originalStatus.id.replace("facebook:",""));if(e.message||e.name)e.formattedText=this.autoLink(e.message||e.name);return e.hide_app_cards&&e.fbapp_id&&e.application&&e.fbapp_id===e.application.id&&(e.mediaHtml=""),e.author?e.author.is_page>0?e.action_available.like=!0:e.action_available.like=!1:e.from&&e.from.broadcast_name&&(e.author={name:e.from.broadcast_name,is_page:!0},e.action_available.like=!0),e},autoLink:function(e){var t=n.extractUrlsWithIndices(e).concat(n.extractHashtagsWithIndices(e,{checkUrlOverlap:!1}));return n.removeOverlappingEntities(t),n.autoLinkEntities(e,t,{hashtagClass:"facebook-hashtag",urlClass:"facebook-url",hashtagUrlBase:"https://www.facebook.com/hashtag/",targetBlank:!0})},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("created_time")))}})}),n("massrel-js-backbone-2/InstagramStatusModel",["require","./StatusModel","twitter-text"],function(e){var t=e("./StatusModel"),n=e("twitter-text");return t.extend({parse:function(e){e=t.prototype.parse.apply(this,arguments),e.user.profile_picture&&(e.user.profile_picture=this.embedlyImageProxyUrl(e.user.profile_picture),e.caption&&e.caption.from.profile_picture&&(e.caption.from.profile_picture=this.embedlyImageProxyUrl(e.caption.from.profile_picture)));if(e.caption){var r=e.caption.text,i=String.fromCharCode(133)+"#",s=this.getHashtagRuns(r);r=_.reduce(s,function(e,t){var n=t.replace(/#/g,i).slice(1);return e.replace(t,n)},r);var o=n.extractUrlsWithIndices(r),u=n.extractMentionsWithIndices(r),a=n.extractHashtagsWithIndices(r,{checkUrlOverlap:!1}),f=o.concat(a).concat(u);n.removeOverlappingEntities(f);var l={hashtagUrlBase:"//instagram.com/explore/tags/",usernameUrlBase:"//instagram.com/"},c=n.autoLinkEntities(r,f,l);e.caption.text=c}return e.location&&_.isNumber(e.location.latitude)&&_.isNumber(e.location.longitude)&&(e.coordinates=[e.location.latitude,e.location.longitude]),e.place=e.location,delete e.location,e},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("created_time"),"X"))},getHashtagRuns:function(e){var t=/(?:#|^|\s)((?:#[^#\s]+){2,})(?:#|$|\s)/gi,n=[],r=t.exec(e);while(r)t.lastIndex=r.index+1,n.push(r[1]),r=t.exec(e);return _.sortBy(n,"length").reverse()}})}),n("massrel-js-backbone-2/GoogleStatusModel",["require","./StatusModel","twitter-text"],function(e){var t=e("./StatusModel"),n=e("twitter-text");return t.extend({parse:function(e){return e=t.prototype.parse.apply(this,arguments),e.title&&(e.title=n.autoLinkUrlsCustom(e.title)),e.place=e.location,delete e.location,e.formattedText=e.title,e.object&&e.object.content&&(e.formattedText=e.object.content),e},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("published")))}})}),n("massrel-js-backbone-2/GetglueStatusModel",["require","./StatusModel","twitter-text","lodash"],function(e){var t=e("./StatusModel"),n=e("twitter-text"),r=e("lodash"),i={thumb:"tiny_",small:"tiny_",medium:"",large:"large_",huge:"large_"},s=/\/[a-z_]*tile\./;return t.extend({defaults:r.extend(r.result(t.prototype,"defaults"),{relativeDateFormat:"short"}),parse:function(e){return e=t.prototype.parse.apply(this,arguments),e.actor&&e.actor.image&&(e.actor.image=this.embedlyImageProxyUrl(e.actor.image)),e.canonical_link=e.link,r.isUndefined(e.inReplyTo)||(e.canonical_link=e.inReplyTo.link),e.body=n.autoLinkUrlsCustom(e.body),e},initialize:function(){t.prototype.initialize.apply(this,arguments),this.generateAvatarUrl()},generateAvatarUrl:function(){var e=this.get("actor"),t=this.get("avatar_resolution"),n=i[t];if(n){var r=e.image.replace(s,"/"+n+"tile.");e.image=r}},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("publishTime")))}})}),n("massrel-js-backbone-2/RssStatusModel",["./StatusModel","twitter-text"],function(e,t){return e.extend({parse:function(n){return n=e.prototype.parse.apply(this,arguments),n.description&&(n.raw_description=n.description,n.description=t.autoLinkUrlsCustom(n.description)),n},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("pub_date")))}})}),n("massrel-js-backbone-2/YoutubeStatusModel",["./StatusModel","twitter-text","./MediaCollection","./MediaModel","lodash","moment"],function(e,t,n,r,i,s){return e.extend({defaults:i.extend(i.result(e.prototype,"defaults"),{relativeDurationFormat:"display",formattedDuration:"",relativeDateFormat:"short"}),initialize:function(){e.prototype.initialize.apply(this,arguments),this.on("change:relativeDurationFormat",i.bind(this.generateFormattedDurations,this)),this.generateFormattedDurations()},parse:function(t){return t=e.prototype.parse.apply(this,arguments),t.title=t.snippet.title,t.description=t.snippet.description,t.link="//youtu.be/"+t.youtube_video_id,t.channelTitle=t.snippet.channelTitle,t},generateFormattedDates:function(){this.set("formattedDate",this.formattedDates(this.get("snippet").publishedAt))},generateFormattedDurations:function(){var e=this.computeDuration(this.get("contentDetails").duration),t=this.get("relativeDurationFormat");i.isFunction(t)?this.set("formattedDuration",t(e)):this[t+"Duration"]&&this.set("formattedDuration",this[t+"Duration"](e))},computeDuration:function(e){var t=s.duration(e);return{hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),totalSeconds:t.asSeconds()}},displayDuration:function(e){function t(e){return e<10?"0"+e:e}var n=":"+t(e.seconds);return e.hours?n=e.hours+":"+t(e.minutes)+n:n=e.minutes+n,n},secondsDuration:function(e){return e.totalSeconds}})}),n("massrel-js-backbone-2/statusModelFactory",["./StatusModel","./TwitterStatusModel","./FacebookStatusModel","./InstagramStatusModel","./GoogleStatusModel","./GetglueStatusModel","./RssStatusModel","./YoutubeStatusModel"],function(e,t,n,r,i,s,o,u){var a=function(t,n,r){var i;return a.detectSource(t),typeof r=="undefined"&&(r=a.constructors),r[t.sourceName]!==undefined?i=r[t.sourceName]:i=e,new i(t,n)};return a.constructors={twitter:t,facebook:n,instagram:r,google:i,getglue:s,rss:o,youtube:u},a.detectSource=function(e){return e.sourceNetwork={facebook:!1,twitter:!1,getglue:!1,google:!1,instagram:!1,rss:!1,youtube:!1,message:!1},typeof e.sourceNetwork[e.network]!="undefined"&&(e.sourceNetwork[e.network]=!0,e.sourceName=e.network),e.network==="google_plus"&&(e.sourceNetwork.google=!0,e.sourceName="google"),e.network==="youtube"&&(e.sourceNetwork.youtube=!0,e.sourceName="youtube"),e.network==="massrelevance"&&(e.sourceNetwork.message=!0,e.sourceName="message"),e},a}),n("massrel-js-backbone-2/mediaCollectionFactory",["q","./MediaCollection","media-meta"],function(e,t,n){var r=function(r,i){var s=e.defer(),o=n.promise(r.toJSON(),i);return o.done(function(e){s.resolve(new t(e))},function(){s.reject()}),s.promise};return r}),n("massrel-js-backbone-2/StreamPoller",["require","lodash","q","./backbone","./statusModelFactory","./mediaCollectionFactory","massrel-js"],function(e){var t=e("lodash"),n=e("q"),r=e("./backbone"),i=e("./statusModelFactory"),s=e("./mediaCollectionFactory"),o=e("massrel-js"),u=o.protocol==="https";return r.Model.extend({defaults:{embed_media:!1,avatar_resolution:"small",total:0,media_config:{secure:u,autoplay_video:!1,loop_video:!1}},initialize:function(){var e=this;e.filters=[],e.asyncFilters=[],e.queue=new r.Collection,e.moreQueue=new r.Collection;var n=e.toJSON();e.stream=new o.Stream(n.stream_name),e.poller=e.stream.poller(n),e.poller.data(function(t){var n=e.get("total")+t.length;e.set("total",n),n===0&&e.trigger("no-data"),t.length===0&&e.trigger("no-new-data")}),e.poller.batch(t.bind(e.handleBatch,e))},start:function(){var e=this;return this.get("stream_name")&&e.poller.start(),e},handleBatch:function(e){var t=this;t.createModels(e).done(function(e){t.queue.add(e,{at:0}),t.trigger("loaded-batch",e.length)})},createModels:function(e){var r=this,o=n.defer(),u=r.get("embed_media"),a=r.get("avatar_resolution"),f=r.get("media_config"),l=[],c=[];t.each(e,function(e,t){if(e.in_reply_to){var n=i(e.in_reply_to);l.push(n)}var r=i(e);l.push(r),e.in_reply_to&&(n.set("reply",r),r.set("in_reply_to",n))}),t.each(l,function(e,t){a&&e.set("avatar_resolution",a);if(u){var n=s(e,f);n.then(function(t){e.set("media",t)}).fail(function(){}),c.push(n)}});if(u)n.allSettled(c).done(function(){var e=r.applyFilters(l);r.applyAsyncFilters(e).then(function(e){o.resolve(e)})});else{var h=r.applyFilters(l);r.applyAsyncFilters(h).then(function(e){o.resolve(e)})}return o.promise},stop:function(){var e=this;return e.poller.stop(),e},filter:function(e){var t=this;return t.filters.push(e),t.queue.remove(t.queue.reject(e)),t.moreQueue.remove(t.moreQueue.reject(e)),t},asyncFilter:function(e){var n=this;n.asyncFilters.push(e);var r=t.clone(n.queue.models),i=t.clone(n.moreQueue.models);return n.applyAsyncFilters(n.queue.models).then(function(e){var i=t.difference(r,e);n.queue.remove(i)}),n.applyAsyncFilters(n.moreQueue.models).then(function(e){var r=t.difference(i,e);n.moreQueue.remove(r)}),n},applyFilters:function(e){var n=this;return t.each(n.filters,function(n){e=t.filter(e,n)}),e},applyAsyncFilters:function(e){var r=n.defer(),i=function(e){r.resolve(e)};if(this.asyncFilters.length){var s=n(e);t.each(this.asyncFilters,function(e){s=s.then(e)}),s.then(i)}else r.resolve(e);return r.promise},more:function(){var e=this;return e.trigger("loading-more"),e.poller.more(t.bind(e.loadedMore,e)),e},loadedMore:function(e){var t=this;e.length===0?t.trigger("end-of-data"):t.createModels(e).done(function(e){t.moreQueue.add(e),t.trigger("loaded-more",e.length)})}})}),n("massrel-js-backbone-2/Filters",["require","./backbone","q","jquery","lodash"],function(e){function s(e){var t=r("head"),i=n.defer(),s=r("<img/>");return s.on("load",function(){s.remove(),i.resolve()}).on("error",function(){s.remove(),i.reject()}),t.append(s),s.attr("src",e),i.promise}function o(e,t){var r=[],o=[],u=n.defer();return i.each(e,function(e){var u=n.defer();r.push(u.promise);var a=e.get("media");if(a&&a.length>0){var f=a.at(0),l=f.get("photo_urls"),c=[];i.each(l,function(e){c.push(s(e.url))}),n.all(c).then(function(){o.push(e),u.resolve()},function(){u.resolve()})}else t&&t.includeText&&o.push(e),u.resolve()}),n.allSettled(r).then(function(){u.resolve(i.intersection(e,o))}),u.promise}function u(e){return o(e,{includeText:!0})}function a(e){return String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.get("formattedText")&&e.get("formattedText").trim().length>0?!0:e.get("network")==="instagram"&&e.get("caption")&&e.get("caption").text&&e.get("caption").text.trim().length>0?!0:e.get("network")==="rss"&&(e.get("title")&&e.get("title").trim().length>0||e.get("description")&&e.get("description").trim().length>0)?!0:!1}var t=e("./backbone"),n=e("q"),r=e("jquery"),i=e("lodash");return{sync:{hasTextStatus:a},async:{hasValidImages:o,hasValidImagesOrText:u}}}),n("massrel-js-backbone-2/ComparePoller",["./backbone","massrel-js"],function(e,t){return e.Model.extend({defaults:function(){return{streams:[],frequency:20}},initialize:function(){var e=this,n=e.toJSON();e.compare=new t.Compare(n.streams),e.poller=e.compare.poller(n)},start:function(){var e=this;this.get("streams")&&this.get("streams").length>0&&(e.set("loading",!0),e.poller.data(function(t){e.set("data",t),e.set("loading",!1)}),e.poller.start())},stop:function(){this.poller.stop()}})}),n("massrel-js-backbone-2/MetaPoller",["require","./backbone","massrel-js"],function(e){var t=e("./backbone"),n=e("massrel-js");return t.Model.extend({defaults:function(){return{stream_name:"",networks:1,disregard:"",frequency:20,loading:!1,activity:{},count:{},networks:{}}},initialize:function(){var e=this,t=e.toJSON();e.stream=new n.Stream(t.stream_name),e.poller=e.stream.metaPoller(t)},start:function(){var e=this;this.get("stream_name")&&(e.set("loading",!0),e.poller.data(function(t){e.set(t),e.set("loading",!1)}),e.poller.start())},stop:function(){var e=this;e.poller.stop()}})}),n("massrel-js-backbone-2/TopThingsPoller",["require","./backbone","massrel-js","lodash"],function(e){var t=e("./backbone"),n=e("massrel-js"),r=e("lodash");return t.Model.extend({defaults:function(){return{stream_name:"",networks:1,frequency:20,resolution:"1h",start:"-1h",finish:"",thing:"",limit:50,loading:!1,data:{}}},start:function(){this.stop();if(this.get("stream_name")){var e=r.pick(this.toJSON(),["thing","resolution","start","finish","limit","stream_name"]);this.stream=new n.Stream(e.stream_name),this.poller=this.stream.topThingsPoller(e),this.set("loading",!0),this.poller.data(r.bind(function(e){this.set("data",e),this.set("loading",!1)},this)),this.poller.start()}},stop:function(){this.poller&&this.poller.stop()}})}),n("massrel-js-backbone-2/main",["require","./StreamPoller","./Filters","./ComparePoller","./MetaPoller","./TopThingsPoller","./statusModelFactory","./StatusModel","./TwitterStatusModel","./FacebookStatusModel","./GoogleStatusModel","./GetglueStatusModel","./InstagramStatusModel","./RssStatusModel","./mediaCollectionFactory","./MediaCollection","./MediaModel"],function(e){var t=e("./StreamPoller"),n=e("./Filters"),r=e("./ComparePoller"),i=e("./MetaPoller"),s=e("./TopThingsPoller"),o=e("./statusModelFactory"),u=e("./StatusModel"),a=e("./TwitterStatusModel"),f=e("./FacebookStatusModel"),l=e("./GoogleStatusModel"),c=e("./GetglueStatusModel"),h=e("./InstagramStatusModel"),p=e("./RssStatusModel"),d=e("./mediaCollectionFactory"),v=e("./MediaCollection"),m=e("./MediaModel");return{StreamPoller:t,ComparePoller:r,MetaPoller:i,TopThingsPoller:s,statusModelFactory:o,StatusModel:u,TwitterStatusModel:a,FacebookStatusModel:f,GoogleStatusModel:l,GetglueStatusModel:c,InstagramStatusModel:h,RssStatusModel:p,mediaCollectionFactory:d,MediaCollection:v,MediaModel:m,Filters:n}}),n("massrel-js-backbone-2",["massrel-js-backbone-2/main"],function(e){return e}),n("massrel-js-backbone/lib/backbone",["require","backbone-amd"],function(e){var t=e("backbone-amd");return(window["massrel-js-backbone"]||window).Backbone||t}),n("massrel-js-backbone/lib/util",["require","q","lodash","moment"],function(e){var t=e("q"),n=e("lodash"),r=e("moment"),i=function(e){return e.toISOString()},s=function(e){return e.format("LLL")},o=function(e){return e.fromNow()},u=function(e){var t=function(t,n){return r().subtract(t,n).isBefore(e)},n=function(t,n){return r().diff(e,t)+n},i;return t(1,"second")?i="now":t(1,"minute")?i=n("seconds","s"):t(1,"hour")?i=n("minutes","m"):t(1,"day")?i=n("hours","h"):t(1,"week")?i=n("days","d"):t(1,"month")?i=n("weeks","w"):i=e.format("M/D/YY"),i},a=function(e,t){if(!n.isPlainObject(e))return e;var r={};return n.each(e,function(e,i){var s=a(e,t);n.isPlainObject(s)&&n.size(s)!==0?(t=n.isUndefined(t)?"_":""+t,n.each(s,function(e,s){var o=i+t+s;n.has(r,o)||(r[o]=e)})):r[i]=s}),r},f=function(e){return n.isFunction(Object.freeze)&&Object.freeze(e),e},l={facebook:!0,twitter:!0},c=function(e,t,r){if(!n.has(l,e))throw new TypeError("Unsupported avatar network: "+e);return r=n.isNumber(r)?Math.max(0,r):73,"//api.massrelevance.com/avatar/"+e+"?"+"screen_name="+encodeURIComponent(t)+"&"+"width="+r+"&"+"height="+r},h=function(e){return e?e.textContent||e.innerText||"":""},p=function(e,r){if(!n.isString(e))throw new TypeError("`url` must be a string");if(!/^(?:https?:)?\/\//.test(e))throw new TypeError("`url` must be a HTTP(S)/protocol-relative URL");var i=t.defer(),s=r||new Image;return s.onload=function(){i.resolve(s)},s.onerror=function(){i.reject(new Error("Image failed to load"))},s.src=e,i.promise},d=function(e,t,r){var i=(e||"").replace(/\r\n|\r/g,"\n");if(n.isNumber(t)){if(!n.isFinite(t))throw new TypeError("`condenseTo` must be finite");if(Math.round(t)!==t)throw new TypeError("`condenseTo` must be an integer");if(t<0)throw new TypeError("`condenseTo` must be >= 0");var s="";for(var o=0;o<t;o++)s+="\n";i=i.replace(new RegExp("\\n{"+(t+1)+",}","g"),s)}return n.isString(r)&&(i=i.replace(/\n/g,r)),i},v=function(e){return((e||"")+"").replace(/^https?:/i,"")},m=function(e,t){var n=0,r=0;for(var i=e.length;r<i;r++){var s=e[r];if(n+s.length>t)break;n+=s.length}return r},g=/(\s+)/g,y=function(e,t){e=e||"";if(!n.isNumber(t)||t<0)throw new TypeError("`maxLength` must be a positive number");if(e.length<=t)return[e,""];var r=(e||"").split(g),i=m(r,t);return[Array.prototype.slice.call(r,0,i).join(""),Array.prototype.slice.call(r,i).join("")]},b=function(e,t){e=e||"";if(!n.isNumber(t)||t<0)throw new TypeError("`maxLength` must be a positive number");var r=document.createElement("div");r.innerHTML=e;if(h(r).length<=t)return[e,""];var i=[],s=[];for(var o=0,u=r.childNodes.length;o<u;o++){var a=r.childNodes[o];if(a.nodeType===Node.TEXT_NODE){var f=a.nodeValue.split(g);Array.prototype.push.apply(i,f),Array.prototype.push.apply(s,f)}else i.push(h(a)),s.push(a.outerHTML)}var l=m(i,t);return[Array.prototype.slice.call(s,0,l).join(""),Array.prototype.slice.call(s,l).join("")]},w=function(e,t,n){e=""+e;if(e.length>=t)return e;n=n||"0";while(e.length<t)e=n+e;return e.slice(-t)},E=function(e){return e=e||{},n(e).pick(function(e){return n.isString(e)||n.isNumber(e)}).mapValues(encodeURIComponent).map(function(e,t){return t+"="+e}).join("&")},S=function(e,t){return t||!String.prototype.trim?e.replace(/^\s+|\s+$/g,""):e.trim()},x=function(e,t){return e=e.replace(/^(&nbsp;|<\s*br\s*\/?>|\s)+|(&nbsp;|<\s*br\s*\/?>|\s)+$/gi,""),S(e,t)};return{calculateISODate:i,calculateFullDate:s,calculateShortDate:u,calculateDisplayDate:o,flattenObject:a,freeze:f,getAvatarProxyURL:c,getNodeText:h,loadImage:p,normalizeLineBreaks:d,protocolRelativize:v,splitTextToLength:y,splitHTMLToLength:b,padLeft:w,paramaterize:E,trim:S,trimHTML:x}}),n("massrel-js-backbone/lib/MediaModel",["require","./backbone","lodash","./util"],function(e){var t=e("./backbone"),n=e("lodash"),r=e("./util"),i={vine:!1,twitter:!1,facebook:!1,google:!1,getglue:!1,youtube:!1,instagram:!1,vimeo:!1,tumblr:!1},s={YouTube:"youtube",Vine:"vine",Twitter:"twitter",Facebook:"facebook",GetGlue:"getglue","Google+":"google",Instagram:"instagram",Vimeo:"vimeo",Tumblr:"tumblr"},o={youtube:"icon-youtube-logo",facebook:"icon-facebook-logo",twitter:"icon-twitter-logo",vine:"icon-vine-logo",instagram:"icon-instagram-logo",tumblr:"icon-tumblr-logo",google:"icon-google-plus-logo"},u=t.Model.extend({defaults:function(){return{type:"",html:"",url:"",link:"",width:0,height:0,provider_name:"",provider_url:"",provider:{},title:"",description:"",thumbnail_url:"",thumbnail_width:0,thumbnail_height:0,author_name:"",author_url:"",formatted_author_name:"",provider_icon_class:"",load_video_html:!1,loop_video:!1,load_gif:!1,autoplay:!1,sizes:r.freeze([])}},constructor:function(e,r){var i=n.extend({},r,{parse:!0});t.Model.call(this,e,i)},initialize:function(){this.set("provider_name",this._getProviderName(this.get("provider_name"))),this.set("provider",this._getProviderObject(this.get("provider_name"))),this.on({"change:provider change:provider_name change:author_name":this._updateFormattedAuthorName,"change:provider":this._updateProviderIconClass}),this._updateFormattedAuthorName(),this._updateProviderIconClass()},size:function(){return u.calculateSize(this.attributes)},resize:function(){var e={width:0,height:0};if(arguments.length===1)e.width=e.height=arguments[0];else{if(arguments.length!==2)throw new Error("Either both `width`, `height` arguments, or a single `size` argument, are required!");e.width=arguments[0],e.height=arguments[1]}var t=u.calculateSize(e),r=null,i=n.findLast(this.get("sizes"),function(e){return r=e,u.calculateSize(e)>=t})||r;return this.set(i),n.clone(i)},validate:function(e){var t={error:this._validateError,link:this._validateLink,photo:this._validatePhoto,rich:this._validateRich,video:this._validateVideo};if(!n.isString(e.type))return new Error("`type` must be a string (got: "+e.type+")");if(!n.has(t,e.type))return new Error("Invalid `type` value: "+e.type);var r;if(e.provider_url){r=this._validateURL("provider_url",e);if(r)return r}if(e.author_url){r=this._validateURL("author_url",e);if(r)return r}if(e.thumbnail_url){r=this._validateURL("thumbnail_url",e);if(r)return r}return this._validateIntegers(["width","height","thumbnail_width","thumbnail_height"],e)||t[e.type].call(this,e)},_validateIntegers:function(e,t){for(var r=e.length-1;r>=0;r--){var i=e[r],s=t[i];if(!n.isNumber(s)||s<0||!n.isFinite(s)||Math.round(s)!==s)return new Error("`"+i+"` must be an integer (got: "+s+")")}},_validateURL:function(e,t){if(!n.isString(t[e]))return new Error("`"+e+"` must be a string");if(!t[e])return new Error("`"+e+"` must not be empty");if(!/^(?:https?:)?\/\//i.test(t[e]))return new Error("`"+e+"` must be a HTTP(S) or protocol-relative URL")},_validateError:n.noop,_validateLink:n.noop,_validatePhoto:function(e){return this._validateURL("url",e)},_validateRich:function(e){if(!n.isString(e.html))return new Error("`html` must be a string");if(!e.html)return new Error("`html` must not be empty")},_validateVideo:function(e){return n.isString(e.html)?e.html?this._validateURL("url",e):new Error("`html` must not be empty"):new Error("`html` must be a string")},parse:function(e){var t=r.flattenObject(n.omit(e,["version","cache_age"])),i=n.map(t.sizes||[],function(e){return u.pickSizeAttributes(e)});return i.push(u.pickSizeAttributes(t)),i=n(i).sortBy(function(e){return-u.calculateSize(e)}).map(r.freeze).value(),t.sizes=r.freeze(i),t},_getProviderName:function(e){return s[e]||e},_getProviderObject:function(e){e=s[e]||e;var t=n.extend({},i);return n.has(t,e)&&(t[e]=!0),t},_getProviderIconClass:function(){return o[this.get("provider_name")]||""},_updateFormattedAuthorName:function(){var e="",t=this.get("provider");if(t.twitter||t.instagram||t.tumblr)e="@";this.set("formatted_author_name",e+this.get("author_name"))},_updateProviderIconClass:function(){this.set("provider_icon_class",this._getProviderIconClass())}},{calculateSize:function(e){return e.width&&e.height?e.width*e.height:e.thumbnail_url?e.thumbnail_width*e.thumbnail_height:0},pickSizeAttributes:n.partialRight(n.pick,["html","url","width","height","thumbnail_url","thumbnail_width","thumbnail_height"])});return u}),n("twemoji/twemoji.amd",[],function(){var e=function(){function i(e){return document.createTextNode(e)}function s(e,t){return"".concat(t.base,t.size,"/",e,t.ext)}function o(e,t){var r=e.childNodes,i=r.length,s,u;while(i--)s=r[i],u=s.nodeType,u===3?t.push(s):u===1&&!n.test(s.nodeName)&&o(s,t);return t}function u(e,t){return v(t==="ï¸"?e.slice(0,-1):e.length===3&&e.charAt(1)==="ï¸"?e.charAt(0)+e.charAt(2):e)}function a(n,r){var s=o(n,[]),a=s.length,f,l,c,h,p,d,v,m,g,y,b;while(a--){f=document.createDocumentFragment(),l=s[a],c=l.nodeValue,p=0;while(h=t.exec(c))d=h.index,d!==p&&f.appendChild(i(c.slice(p,d))),m=h[0],g=h[1],y=h[2],p=d+m.length,y!=="ï¸"&&(b=r.callback(u(g,y),r,y),b&&(v=new Image,v.onerror=e.onerror,v.className=r.className,v.setAttribute("draggable","false"),v.alt=m,v.src=b)),f.appendChild(v||i(m)),v=null;0<p&&(p<c.length&&f.appendChild(i(c.slice(p))),l.parentNode.replaceChild(f,l))}return n}function f(e,t){return p(e,function(e,n,r){var i;return r!=="ï¸"&&(i=t.callback(u(n,r),t,r),i&&(e="<img ".concat('class="',t.className,'" ','draggable="false" ','alt="',e,'" ','src="',i,'"',">"))),e})}function l(e){return typeof e=="number"?e+"x"+e:e}function c(e){var t=typeof e=="string"?parseInt(e,16):e;return t<65536?r(t):(t-=65536,r(55296+(t>>10),56320+(t&1023)))}function h(t,n){if(!n||typeof n=="function")n={callback:n};return(typeof t=="string"?f:a)(t,{callback:n.callback||s,base:typeof n.base=="string"?n.base:e.base,ext:n.ext||e.ext,size:n.folder||l(n.size||e.size),className:n.className||e.className})}function p(e,n){return String(e).replace(t,n)}function d(e){t.lastIndex=0;var n=t.test(e);return t.lastIndex=0,n}function v(e,t){var n=[],r=0,i=0,s=0;while(s<e.length)r=e.charCodeAt(s++),i?(n.push((65536+(i-55296<<10)+(r-56320)).toString(16)),i=0):55296<=r&&r<=56319?i=r:n.push(r.toString(16));return n.join(t||"-")}var e={base:(location.protocol==="https:"?"https:":"http:")+"//twemoji.maxcdn.com/",ext:".png",size:"36x36",className:"emoji",convert:{fromCodePoint:c,toCodePoint:v},onerror:function(){this.parentNode&&this.parentNode.replaceChild(i(this.alt),this)},parse:h,replace:p,test:d},t=/((?:\ud83c\udde8\ud83c\uddf3|\ud83c\uddfa\ud83c\uddf8|\ud83c\uddf7\ud83c\uddfa|\ud83c\uddf0\ud83c\uddf7|\ud83c\uddef\ud83c\uddf5|\ud83c\uddee\ud83c\uddf9|\ud83c\uddec\ud83c\udde7|\ud83c\uddeb\ud83c\uddf7|\ud83c\uddea\ud83c\uddf8|\ud83c\udde9\ud83c\uddea|\u0039\ufe0f?\u20e3|\u0038\ufe0f?\u20e3|\u0037\ufe0f?\u20e3|\u0036\ufe0f?\u20e3|\u0035\ufe0f?\u20e3|\u0034\ufe0f?\u20e3|\u0033\ufe0f?\u20e3|\u0032\ufe0f?\u20e3|\u0031\ufe0f?\u20e3|\u0030\ufe0f?\u20e3|\u0023\ufe0f?\u20e3|\ud83d\udeb3|\ud83d\udeb1|\ud83d\udeb0|\ud83d\udeaf|\ud83d\udeae|\ud83d\udea6|\ud83d\udea3|\ud83d\udea1|\ud83d\udea0|\ud83d\ude9f|\ud83d\ude9e|\ud83d\ude9d|\ud83d\ude9c|\ud83d\ude9b|\ud83d\ude98|\ud83d\ude96|\ud83d\ude94|\ud83d\ude90|\ud83d\ude8e|\ud83d\ude8d|\ud83d\ude8b|\ud83d\ude8a|\ud83d\ude88|\ud83d\ude86|\ud83d\ude82|\ud83d\ude81|\ud83d\ude36|\ud83d\ude34|\ud83d\ude2f|\ud83d\ude2e|\ud83d\ude2c|\ud83d\ude27|\ud83d\ude26|\ud83d\ude1f|\ud83d\ude1b|\ud83d\ude19|\ud83d\ude17|\ud83d\ude15|\ud83d\ude11|\ud83d\ude10|\ud83d\ude0e|\ud83d\ude08|\ud83d\ude07|\ud83d\ude00|\ud83d\udd67|\ud83d\udd66|\ud83d\udd65|\ud83d\udd64|\ud83d\udd63|\ud83d\udd62|\ud83d\udd61|\ud83d\udd60|\ud83d\udd5f|\ud83d\udd5e|\ud83d\udd5d|\ud83d\udd5c|\ud83d\udd2d|\ud83d\udd2c|\ud83d\udd15|\ud83d\udd09|\ud83d\udd08|\ud83d\udd07|\ud83d\udd06|\ud83d\udd05|\ud83d\udd04|\ud83d\udd02|\ud83d\udd01|\ud83d\udd00|\ud83d\udcf5|\ud83d\udcef|\ud83d\udced|\ud83d\udcec|\ud83d\udcb7|\ud83d\udcb6|\ud83d\udcad|\ud83d\udc6d|\ud83d\udc6c|\ud83d\udc65|\ud83d\udc2a|\ud83d\udc16|\ud83d\udc15|\ud83d\udc13|\ud83d\udc10|\ud83d\udc0f|\ud83d\udc0b|\ud83d\udc0a|\ud83d\udc09|\ud83d\udc08|\ud83d\udc07|\ud83d\udc06|\ud83d\udc05|\ud83d\udc04|\ud83d\udc03|\ud83d\udc02|\ud83d\udc01|\ud83d\udc00|\ud83c\udfe4|\ud83c\udfc9|\ud83c\udfc7|\ud83c\udf7c|\ud83c\udf50|\ud83c\udf4b|\ud83c\udf33|\ud83c\udf32|\ud83c\udf1e|\ud83c\udf1d|\ud83c\udf1c|\ud83c\udf1a|\ud83c\udf18|\ud83c\udccf|\ud83c\udd70|\ud83c\udd71|\ud83c\udd7e|\ud83c\udd8e|\ud83c\udd91|\ud83c\udd92|\ud83c\udd93|\ud83c\udd94|\ud83c\udd95|\ud83c\udd96|\ud83c\udd97|\ud83c\udd98|\ud83c\udd99|\ud83c\udd9a|\ud83d\udc77|\ud83d\udec5|\ud83d\udec4|\ud83d\udec3|\ud83d\udec2|\ud83d\udec1|\ud83d\udebf|\ud83d\udeb8|\ud83d\udeb7|\ud83d\udeb5|\ud83c\ude01|\ud83c\ude02|\ud83c\ude32|\ud83c\ude33|\ud83c\ude34|\ud83c\ude35|\ud83c\ude36|\ud83c\ude37|\ud83c\ude38|\ud83c\ude39|\ud83c\ude3a|\ud83c\ude50|\ud83c\ude51|\ud83c\udf00|\ud83c\udf01|\ud83c\udf02|\ud83c\udf03|\ud83c\udf04|\ud83c\udf05|\ud83c\udf06|\ud83c\udf07|\ud83c\udf08|\ud83c\udf09|\ud83c\udf0a|\ud83c\udf0b|\ud83c\udf0c|\ud83c\udf0f|\ud83c\udf11|\ud83c\udf13|\ud83c\udf14|\ud83c\udf15|\ud83c\udf19|\ud83c\udf1b|\ud83c\udf1f|\ud83c\udf20|\ud83c\udf30|\ud83c\udf31|\ud83c\udf34|\ud83c\udf35|\ud83c\udf37|\ud83c\udf38|\ud83c\udf39|\ud83c\udf3a|\ud83c\udf3b|\ud83c\udf3c|\ud83c\udf3d|\ud83c\udf3e|\ud83c\udf3f|\ud83c\udf40|\ud83c\udf41|\ud83c\udf42|\ud83c\udf43|\ud83c\udf44|\ud83c\udf45|\ud83c\udf46|\ud83c\udf47|\ud83c\udf48|\ud83c\udf49|\ud83c\udf4a|\ud83c\udf4c|\ud83c\udf4d|\ud83c\udf4e|\ud83c\udf4f|\ud83c\udf51|\ud83c\udf52|\ud83c\udf53|\ud83c\udf54|\ud83c\udf55|\ud83c\udf56|\ud83c\udf57|\ud83c\udf58|\ud83c\udf59|\ud83c\udf5a|\ud83c\udf5b|\ud83c\udf5c|\ud83c\udf5d|\ud83c\udf5e|\ud83c\udf5f|\ud83c\udf60|\ud83c\udf61|\ud83c\udf62|\ud83c\udf63|\ud83c\udf64|\ud83c\udf65|\ud83c\udf66|\ud83c\udf67|\ud83c\udf68|\ud83c\udf69|\ud83c\udf6a|\ud83c\udf6b|\ud83c\udf6c|\ud83c\udf6d|\ud83c\udf6e|\ud83c\udf6f|\ud83c\udf70|\ud83c\udf71|\ud83c\udf72|\ud83c\udf73|\ud83c\udf74|\ud83c\udf75|\ud83c\udf76|\ud83c\udf77|\ud83c\udf78|\ud83c\udf79|\ud83c\udf7a|\ud83c\udf7b|\ud83c\udf80|\ud83c\udf81|\ud83c\udf82|\ud83c\udf83|\ud83c\udf84|\ud83c\udf85|\ud83c\udf86|\ud83c\udf87|\ud83c\udf88|\ud83c\udf89|\ud83c\udf8a|\ud83c\udf8b|\ud83c\udf8c|\ud83c\udf8d|\ud83c\udf8e|\ud83c\udf8f|\ud83c\udf90|\ud83c\udf91|\ud83c\udf92|\ud83c\udf93|\ud83c\udfa0|\ud83c\udfa1|\ud83c\udfa2|\ud83c\udfa3|\ud83c\udfa4|\ud83c\udfa5|\ud83c\udfa6|\ud83c\udfa7|\ud83c\udfa8|\ud83c\udfa9|\ud83c\udfaa|\ud83c\udfab|\ud83c\udfac|\ud83c\udfad|\ud83c\udfae|\ud83c\udfaf|\ud83c\udfb0|\ud83c\udfb1|\ud83c\udfb2|\ud83c\udfb3|\ud83c\udfb4|\ud83c\udfb5|\ud83c\udfb6|\ud83c\udfb7|\ud83c\udfb8|\ud83c\udfb9|\ud83c\udfba|\ud83c\udfbb|\ud83c\udfbc|\ud83c\udfbd|\ud83c\udfbe|\ud83c\udfbf|\ud83c\udfc0|\ud83c\udfc1|\ud83c\udfc2|\ud83c\udfc3|\ud83c\udfc4|\ud83c\udfc6|\ud83c\udfc8|\ud83c\udfca|\ud83c\udfe0|\ud83c\udfe1|\ud83c\udfe2|\ud83c\udfe3|\ud83c\udfe5|\ud83c\udfe6|\ud83c\udfe7|\ud83c\udfe8|\ud83c\udfe9|\ud83c\udfea|\ud83c\udfeb|\ud83c\udfec|\ud83c\udfed|\ud83c\udfee|\ud83c\udfef|\ud83c\udff0|\ud83d\udc0c|\ud83d\udc0d|\ud83d\udc0e|\ud83d\udc11|\ud83d\udc12|\ud83d\udc14|\ud83d\udc17|\ud83d\udc18|\ud83d\udc19|\ud83d\udc1a|\ud83d\udc1b|\ud83d\udc1c|\ud83d\udc1d|\ud83d\udc1e|\ud83d\udc1f|\ud83d\udc20|\ud83d\udc21|\ud83d\udc22|\ud83d\udc23|\ud83d\udc24|\ud83d\udc25|\ud83d\udc26|\ud83d\udc27|\ud83d\udc28|\ud83d\udc29|\ud83d\udc2b|\ud83d\udc2c|\ud83d\udc2d|\ud83d\udc2e|\ud83d\udc2f|\ud83d\udc30|\ud83d\udc31|\ud83d\udc32|\ud83d\udc33|\ud83d\udc34|\ud83d\udc35|\ud83d\udc36|\ud83d\udc37|\ud83d\udc38|\ud83d\udc39|\ud83d\udc3a|\ud83d\udc3b|\ud83d\udc3c|\ud83d\udc3d|\ud83d\udc3e|\ud83d\udc40|\ud83d\udc42|\ud83d\udc43|\ud83d\udc44|\ud83d\udc45|\ud83d\udc46|\ud83d\udc47|\ud83d\udc48|\ud83d\udc49|\ud83d\udc4a|\ud83d\udc4b|\ud83d\udc4c|\ud83d\udc4d|\ud83d\udc4e|\ud83d\udc4f|\ud83d\udc50|\ud83d\udc51|\ud83d\udc52|\ud83d\udc53|\ud83d\udc54|\ud83d\udc55|\ud83d\udc56|\ud83d\udc57|\ud83d\udc58|\ud83d\udc59|\ud83d\udc5a|\ud83d\udc5b|\ud83d\udc5c|\ud83d\udc5d|\ud83d\udc5e|\ud83d\udc5f|\ud83d\udc60|\ud83d\udc61|\ud83d\udc62|\ud83d\udc63|\ud83d\udc64|\ud83d\udc66|\ud83d\udc67|\ud83d\udc68|\ud83d\udc69|\ud83d\udc6a|\ud83d\udc6b|\ud83d\udc6e|\ud83d\udc6f|\ud83d\udc70|\ud83d\udc71|\ud83d\udc72|\ud83d\udc73|\ud83d\udc74|\ud83d\udc75|\ud83d\udc76|\ud83d\udeb4|\ud83d\udc78|\ud83d\udc79|\ud83d\udc7a|\ud83d\udc7b|\ud83d\udc7c|\ud83d\udc7d|\ud83d\udc7e|\ud83d\udc7f|\ud83d\udc80|\ud83d\udc81|\ud83d\udc82|\ud83d\udc83|\ud83d\udc84|\ud83d\udc85|\ud83d\udc86|\ud83d\udc87|\ud83d\udc88|\ud83d\udc89|\ud83d\udc8a|\ud83d\udc8b|\ud83d\udc8c|\ud83d\udc8d|\ud83d\udc8e|\ud83d\udc8f|\ud83d\udc90|\ud83d\udc91|\ud83d\udc92|\ud83d\udc93|\ud83d\udc94|\ud83d\udc95|\ud83d\udc96|\ud83d\udc97|\ud83d\udc98|\ud83d\udc99|\ud83d\udc9a|\ud83d\udc9b|\ud83d\udc9c|\ud83d\udc9d|\ud83d\udc9e|\ud83d\udc9f|\ud83d\udca0|\ud83d\udca1|\ud83d\udca2|\ud83d\udca3|\ud83d\udca4|\ud83d\udca5|\ud83d\udca6|\ud83d\udca7|\ud83d\udca8|\ud83d\udca9|\ud83d\udcaa|\ud83d\udcab|\ud83d\udcac|\ud83d\udcae|\ud83d\udcaf|\ud83d\udcb0|\ud83d\udcb1|\ud83d\udcb2|\ud83d\udcb3|\ud83d\udcb4|\ud83d\udcb5|\ud83d\udcb8|\ud83d\udcb9|\ud83d\udcba|\ud83d\udcbb|\ud83d\udcbc|\ud83d\udcbd|\ud83d\udcbe|\ud83d\udcbf|\ud83d\udcc0|\ud83d\udcc1|\ud83d\udcc2|\ud83d\udcc3|\ud83d\udcc4|\ud83d\udcc5|\ud83d\udcc6|\ud83d\udcc7|\ud83d\udcc8|\ud83d\udcc9|\ud83d\udcca|\ud83d\udccb|\ud83d\udccc|\ud83d\udccd|\ud83d\udcce|\ud83d\udccf|\ud83d\udcd0|\ud83d\udcd1|\ud83d\udcd2|\ud83d\udcd3|\ud83d\udcd4|\ud83d\udcd5|\ud83d\udcd6|\ud83d\udcd7|\ud83d\udcd8|\ud83d\udcd9|\ud83d\udcda|\ud83d\udcdb|\ud83d\udcdc|\ud83d\udcdd|\ud83d\udcde|\ud83d\udcdf|\ud83d\udce0|\ud83d\udce1|\ud83d\udce2|\ud83d\udce3|\ud83d\udce4|\ud83d\udce5|\ud83d\udce6|\ud83d\udce7|\ud83d\udce8|\ud83d\udce9|\ud83d\udcea|\ud83d\udceb|\ud83d\udcee|\ud83d\udcf0|\ud83d\udcf1|\ud83d\udcf2|\ud83d\udcf3|\ud83d\udcf4|\ud83d\udcf6|\ud83d\udcf7|\ud83d\udcf9|\ud83d\udcfa|\ud83d\udcfb|\ud83d\udcfc|\ud83d\udd03|\ud83d\udd0a|\ud83d\udd0b|\ud83d\udd0c|\ud83d\udd0d|\ud83d\udd0e|\ud83d\udd0f|\ud83d\udd10|\ud83d\udd11|\ud83d\udd12|\ud83d\udd13|\ud83d\udd14|\ud83d\udd16|\ud83d\udd17|\ud83d\udd18|\ud83d\udd19|\ud83d\udd1a|\ud83d\udd1b|\ud83d\udd1c|\ud83d\udd1d|\ud83d\udd1e|\ud83d\udd1f|\ud83d\udd20|\ud83d\udd21|\ud83d\udd22|\ud83d\udd23|\ud83d\udd24|\ud83d\udd25|\ud83d\udd26|\ud83d\udd27|\ud83d\udd28|\ud83d\udd29|\ud83d\udd2a|\ud83d\udd2b|\ud83d\udd2e|\ud83d\udd2f|\ud83d\udd30|\ud83d\udd31|\ud83d\udd32|\ud83d\udd33|\ud83d\udd34|\ud83d\udd35|\ud83d\udd36|\ud83d\udd37|\ud83d\udd38|\ud83d\udd39|\ud83d\udd3a|\ud83d\udd3b|\ud83d\udd3c|\ud83d\udd3d|\ud83d\udd50|\ud83d\udd51|\ud83d\udd52|\ud83d\udd53|\ud83d\udd54|\ud83d\udd55|\ud83d\udd56|\ud83d\udd57|\ud83d\udd58|\ud83d\udd59|\ud83d\udd5a|\ud83d\udd5b|\ud83d\uddfb|\ud83d\uddfc|\ud83d\uddfd|\ud83d\uddfe|\ud83d\uddff|\ud83d\ude01|\ud83d\ude02|\ud83d\ude03|\ud83d\ude04|\ud83d\ude05|\ud83d\ude06|\ud83d\ude09|\ud83d\ude0a|\ud83d\ude0b|\ud83d\ude0c|\ud83d\ude0d|\ud83d\ude0f|\ud83d\ude12|\ud83d\ude13|\ud83d\ude14|\ud83d\ude16|\ud83d\ude18|\ud83d\ude1a|\ud83d\ude1c|\ud83d\ude1d|\ud83d\ude1e|\ud83d\ude20|\ud83d\ude21|\ud83d\ude22|\ud83d\ude23|\ud83d\ude24|\ud83d\ude25|\ud83d\ude28|\ud83d\ude29|\ud83d\ude2a|\ud83d\ude2b|\ud83d\ude2d|\ud83d\ude30|\ud83d\ude31|\ud83d\ude32|\ud83d\ude33|\ud83d\ude35|\ud83d\ude37|\ud83d\ude38|\ud83d\ude39|\ud83d\ude3a|\ud83d\ude3b|\ud83d\ude3c|\ud83d\ude3d|\ud83d\ude3e|\ud83d\ude3f|\ud83d\ude40|\ud83d\ude45|\ud83d\ude46|\ud83d\ude47|\ud83d\ude48|\ud83d\ude49|\ud83d\ude4a|\ud83d\ude4b|\ud83d\ude4c|\ud83d\ude4d|\ud83d\ude4e|\ud83d\ude4f|\ud83d\ude80|\ud83d\ude83|\ud83d\ude84|\ud83d\ude85|\ud83d\ude87|\ud83d\ude89|\ud83d\ude8c|\ud83d\ude8f|\ud83d\ude91|\ud83d\ude92|\ud83d\ude93|\ud83d\ude95|\ud83d\ude97|\ud83d\ude99|\ud83d\ude9a|\ud83d\udea2|\ud83d\udea4|\ud83d\udea5|\ud83d\udea7|\ud83d\udea8|\ud83d\udea9|\ud83d\udeaa|\ud83d\udeab|\ud83d\udeac|\ud83d\udead|\ud83d\udeb2|\ud83d\udeb6|\ud83d\udeb9|\ud83d\udeba|\ud83d\udebb|\ud83d\udebc|\ud83d\udebd|\ud83d\udebe|\ud83d\udec0|\ud83c\udde6|\ud83c\udde7|\ud83c\udde8|\ud83c\udde9|\ud83c\uddea|\ud83c\uddeb|\ud83c\uddec|\ud83c\udded|\ud83c\uddee|\ud83c\uddef|\ud83c\uddf0|\ud83c\uddf1|\ud83c\uddf2|\ud83c\uddf3|\ud83c\uddf4|\ud83c\uddf5|\ud83c\uddf6|\ud83c\uddf7|\ud83c\uddf8|\ud83c\uddf9|\ud83c\uddfa|\ud83c\uddfb|\ud83c\uddfc|\ud83c\uddfd|\ud83c\uddfe|\ud83c\uddff|\ud83c\udf0d|\ud83c\udf0e|\ud83c\udf10|\ud83c\udf12|\ud83c\udf16|\ud83c\udf17|\ue50a|\u3030|\u27b0|\u2797|\u2796|\u2795|\u2755|\u2754|\u2753|\u274e|\u274c|\u2728|\u270b|\u270a|\u2705|\u26ce|\u23f3|\u23f0|\u23ec|\u23eb|\u23ea|\u23e9|\u2122|\u27bf|\u00a9|\u00ae)|(?:(?:\ud83c\udc04|\ud83c\udd7f|\ud83c\ude1a|\ud83c\ude2f|\u3299|\u303d|\u2b55|\u2b50|\u2b1c|\u2b1b|\u2b07|\u2b06|\u2b05|\u2935|\u2934|\u27a1|\u2764|\u2757|\u2747|\u2744|\u2734|\u2733|\u2716|\u2714|\u2712|\u270f|\u270c|\u2709|\u2708|\u2702|\u26fd|\u26fa|\u26f5|\u26f3|\u26f2|\u26ea|\u26d4|\u26c5|\u26c4|\u26be|\u26bd|\u26ab|\u26aa|\u26a1|\u26a0|\u2693|\u267f|\u267b|\u3297|\u2666|\u2665|\u2663|\u2660|\u2653|\u2652|\u2651|\u2650|\u264f|\u264e|\u264d|\u264c|\u264b|\u264a|\u2649|\u2648|\u263a|\u261d|\u2615|\u2614|\u2611|\u260e|\u2601|\u2600|\u25fe|\u25fd|\u25fc|\u25fb|\u25c0|\u25b6|\u25ab|\u25aa|\u24c2|\u231b|\u231a|\u21aa|\u21a9|\u2199|\u2198|\u2197|\u2196|\u2195|\u2194|\u2139|\u2049|\u203c|\u2668)([\uFE0E\uFE0F]?)))/g,n=/IFRAME|NOFRAMES|NOSCRIPT|SCRIPT|STYLE|TEXTAREA/,r=String.fromCharCode;return e}();return e}),n("twemoji",["twemoji/twemoji.amd"],function(e){return e}),n("massrel-js-backbone/lib/MediaCollection",["require","./backbone","lodash","./MediaModel","./util"],function(e){var t=e("./backbone"),n=e("lodash"),r=e("./MediaModel"),i=e("./util"),s=t.Collection.extend({model:r,initialize:function(){this.on("reset",this.sort)},comparator:function(e,t){var r=e.get("type"),i=t.get("type");if(r!==i){var o=9999999,u=o;n.has(s.MEDIA_TYPE_SORT_VALUES,r)&&(u=s.MEDIA_TYPE_SORT_VALUES[r]);var a=o;return n.has(s.MEDIA_TYPE_SORT_VALUES,i)&&(a=s.MEDIA_TYPE_SORT_VALUES[i]),u-a}return t.size()-e.size()}},{MEDIA_TYPE_SORT_VALUES:i.freeze({video:0,photo:1,link:2,rich:3})});return s}),n("massrel-js-backbone/lib/embedly",["require","q","lodash","./util","massrel-js"],function(e){var t=e("q"),n=e("lodash"),r=e("./util"),i=e("massrel-js"),s=window.location.protocol==="https:",o="embedly.massrelevance.com",u="d1gbi9ec0ujnws.cloudfront.net",a="//"+(s?u:o)+"/1/",f=function(e,r){var o;if(n.isArray(r))o=n(r).each(function(e){if(!n.isString(e))throw new TypeError("array values must be strings (got: "+e+")")}).sortBy().map(encodeURIComponent).join(",");else{if(!n.isString(r))throw new TypeError("`urls` must be either a string or an array (got: "+r+")");o=encodeURIComponent(r),r=[r]}var u=t.defer();if(o){var f="?"+["key=fd577f7497bf11e0b95d4040d3dc5c07","secure="+s,"maxwidth=1000","urls="+o].join("&");i.helpers.request_factory(a+e+f,null,"__embedly_jsonp__",null,function(e){for(var t=0;t<e.length;t++)e[t].link=r[t];u.resolve(e)},function(e){u.reject(new Error(e))})}else u.resolve([]);return u.promise},l=/^(https?:)?\/\/i\.embed\.ly\/\d+\/image/i,c=function(e){return l.test(e)||(e="//i.embed.ly/1/image?key=fd577f7497bf11e0b95d4040d3dc5c07&url="+encodeURIComponent(e)),e},h="//cdn.embedly.com/widgets/media.html?",p={url:"",image:"",video:"",video_secure:"true",type:"video/mp4",schema:"instagram"},d=function(e){e=n.extend({},p,e);var t=h+r.paramaterize(e);return'<iframe src="'+t+'" scrolling="no" frameborder="0"></iframe>'};return{embed:n.partial(f,"oembed"),widget:d,proxyImageURL:c}}),n("massrel-js-backbone/lib/StatusModel",["require","./backbone","q","lodash","moment","twemoji","placeholder-image-generator","./MediaCollection","./MediaModel","./embedly","./util"],function(e){var t=e("./backbone"),n=e("q"),r=e("lodash"),i=e("moment"),s=e("twemoji"),o=e("placeholder-image-generator"),u=e("./MediaCollection"),a=e("./MediaModel"),f=e("./embedly"),l=e("./util"),c="media-fetch",h="error:media-fetch",p=function(e){throw new Error("Method `"+e+"` is not implemented")},d=function(e){var t=s.parse(e,{size:"72x72"});return t.replace(/\bclass="\s*emoji\s*"/g,'class="status-emoji"')},v={thumbnail_url:o(),thumbnail_width:480,thumbnail_height:360},m={"Facebook:rich":!0},g=t.Model.extend({idAttribute:"entity_id",network:null,defaults:{additional_classes:"",raw_status:null,has_fetched_media:!1,is_fetching_media:!1,formatted_permalink:"",formatted_date_format:"display",formatted_date:"",formatted_date_iso:"",formatted_date_full:"",formatted_date_short:"",formatted_date_display:"",formatted_avatar_url_format:"medium",formatted_avatar_url:"",formatted_avatar_url_thumb:"",formatted_avatar_url_small:"",formatted_avatar_url_medium:"",formatted_avatar_url_large:"",formatted_avatar_url_huge:"",formatted_profile_url:"",formatted_text_max_length:140,formatted_text:"",formatted_text_rest:"",formatted_text_full:"",formatted_text_pretty:"",formatted_text_rest_pretty:"",formatted_text_full_pretty:"",formatted_name:"",formatted_name_pretty:"",formatted_klout_score:null,formatted_klout_permalink:null,formatted_place:null,media:null},constructor:function(e,n){var i=r.extend({},n,{parse:!0});t.Model.call(this,e,i)},initialize:function(){this.set("media",new u,{silent:!0}),this.on({"change:formatted_avatar_url_format":this._updateFormattedAvatarURL,"change:formatted_date_format":this._updateFormattedDate,"change:formatted_text_max_length":this._updateFormattedTexts}),this._generateFormattedAvatarURLs(),this._generateFormattedDates(),this._generateFormattedPermalink(),this._generateFormattedProfileURL(),this._updateFormattedAvatarURL(),this._updateFormattedDate(),this._updateFormattedName(),this._updateFormattedPlace(),this._updateFormattedTexts()},parse:function(e){var t=l.flattenObject(e);return t.raw_status=r.cloneDeep(e),t},_splitText:l.splitTextToLength,_getMediaFetchURLs:function(){p("_getMediaFetchURLs")},_getMediaExisting:function(){p("_getMediaExisting")},fetchMedia:function(){if(this.get("is_fetching_media"))return this;if(this.get("has_fetched_media"))return this.trigger(c),this;this.set("is_fetching_media",!0),this.set("has_fetched_media",!1);var e=this._getMediaFetchURLs(),t=this._getMediaExisting(),i=n.defer();e&&e.length>0?i=f.embed(e):(i.resolve([]),i=i.promise);var s=this;return i.then(function(e){s.set("is_fetching_media",!1),s.set("has_fetched_media",!0);var n=r(e).reject(function(e){return m[e.provider_name+":"+e.type]}).map(function(e){return!e.thumbnail_url&&e.provider_name==="YouTube"&&(e.thumbnail_url=o({width:480,height:360,template:"youtube"})),r.extend({},v,e)}).map(function(e){return new a(e)}).concat(t).reject(function(e){return e.get("type")==="error"}).value();s.get("media").reset(n),s.trigger(c)}).fail(function(e){s.set("is_fetching_media",!1),s.set("has_fetched_media",!1),s.trigger(h,s,null,{error:e})}).done(),this},_prettifyText:function(){p("_prettifyText")},_getPermalink:function(){p("_getPermalink")},getPermalink:function(){return this._getPermalink()},_getCreateDate:function(){p("_getCreateDate")},getCreateDate:function(){return this._getCreateDate()},_getText:function(){p("_getText")},getText:function(){return this._getText()},_getPlace:function(){p("_getPlace")},getPlace:function(){return this._getPlace()},_getAvatarURL:function(){p("_getAvatarURL")},getAvatarURL:function(e){var t=1e4;if(e<0||e>t)e=t;else if(!r.isNumber(e)||r.isNaN(e))e=g.AVATAR_SIZES.medium;return this._getAvatarURL(e)},_getProfileURL:function(){p("_getProfileURL")},getProfileURL:function(){return this._getProfileURL()},_getName:function(){p("_getName")},getName:function(){return this._getName()},_updateFormattedDate:function(){var e=this.get("formatted_date_format"),t,n=this.get("formatted_date_iso");return r.isFunction(e)?t=e.call(null,i(n)):this.has("formatted_date_"+e)?t=this.get("formatted_date_"+e):t=i(n).format(e),this.set("formatted_date",t),this},updateFormattedDates:function(){return this._generateFormattedDates(),this._updateFormattedDate(),this},_updateFormattedPlace:function(){return this.set("formatted_place",this.getPlace()),this},_updateFormattedAvatarURL:function(){var e=this.get("formatted_avatar_url_format"),t;if(r.isFunction(e))t=e.call(null);else{if(!this.has("formatted_avatar_url_"+e))throw new TypeError("Invalid avatar format value: "+e);t=this.get("formatted_avatar_url_"+e)}return this.set("formatted_avatar_url",t),this},_updateFormattedTexts:function(){var e=this.getText(),t=this.get("formatted_text_max_length"),n=this._splitText(e,t),i=r.compose(d,r.bind(this._prettifyText,this));return this.set({formatted_text:n[0],formatted_text_rest:n[1],formatted_text_full:e,formatted_text_pretty:i(n[0]),formatted_text_rest_pretty:i(n[1]),formatted_text_full_pretty:i(e)}),this},_updateFormattedName:function(){var e=this.getName();return this.set({formatted_name:e,formatted_name_pretty:d(e)}),this},_generateFormattedAvatarURLs:function(){var e={};return r.each(g.AVATAR_SIZES,function(t,n){e["formatted_avatar_url_"+n]=this.getAvatarURL(t)},this),this.set(e),this},_generateFormattedProfileURL:function(){return this.set("formatted_profile_url",this.getProfileURL()),this},_generateFormattedPermalink:function(){return this.set("formatted_permalink",this.getPermalink()),this},_generateFormattedDates:function(){var e=this.getCreateDate();if(!e||!e.isValid())e=i();var t=l.calculateISODate(e),n=l.calculateFullDate(e),r=l.calculateShortDate(e),s=l.calculateDisplayDate(e);return this.set({formatted_date_iso:t,formatted_date_full:n,formatted_date_short:r,formatted_date_display:s}),this}},{AVATAR_SIZES:l.freeze({thumb:24,small:48,medium:73,large:128,huge:1e4}),AUTOLINK_DEFAULTS:l.freeze({usernameIncludeSymbol:!0,suppressDataScreenName:!0,targetBlank:!0,symbolTag:"s",textWithSymbolTag:"span",urlClass:"status-pretty-link status-url ",hashtagClass:"status-pretty-link status-hashtag ",usernameClass:"status-pretty-link status-username ",listClass:"status-pretty-link status-list ",cashtagClass:"status-pretty-link status-cashtag "})});return g}),n("massrel-js-backbone/lib/FacebookStatusModel",["require","lodash","moment","twitter-text","./MediaModel","./StatusModel","./embedly","./util"],function(e){var t=e("lodash"),n=e("moment"),r=e("twitter-text"),i=e("./MediaModel"),s=e("./StatusModel"),o=e("./embedly"),u=e("./util"),a=s.extend({network:"facebook",defaults:t.extend({},s.prototype.defaults,{intent_can_comment:!1,intent_can_like:!1,intent_can_share:!1,intent_url_comment:"",intent_url_like:"",intent_url_share:"",actions:[],actions_has_comment:!1,actions_has_like:!1,intent_app_id:"508524932504444"}),initialize:function(){s.prototype.initialize.apply(this,arguments),this.on("change:type change:kind",this._generateIntentAbilities),this.on("change:actions",this._generateAvailableActions),this._generateAvailableActions(),this._generateIntentAbilities(),this._generateIntentURLs()},getType:function(){return this.get("type")||this.get("kind")},_getMediaFetchURLs:function(){var e=this.getType(),n=r.extractUrlsWithIndices(this.getText()),i=t.pluck(n,"url");return e==="link"&&i.push(this.get("link")),t.uniq(i)},_parseMediaPhoto:function(){var e=t.sortBy(this.get("images"),function(e){return-(e.width*e.height)});if(e.length===0)return null;var n=e[0],r=e[e.length-1],s=u.protocolRelativize(r.source);return new i({type:"photo",url:u.protocolRelativize(n.source),link:this.get("formatted_permalink"),width:n.width,height:n.height,thumbnail_url:s,thumbnail_width:r.width,thumbnail_height:r.height,provider_name:"Facebook",author_name:this.get("from_name"),author_url:a.getAuthorURLById(this.get("from_id")),sizes:t.map(e.slice(1),function(e){return{url:u.protocolRelativize(e.source),width:e.width,height:e.height,thumbnail_url:s,thumbnail_width:r.width,thumbnail_height:r.height}})})},_parseMediaPicture:function(){return this.has("picture")&&this.getType()!=="video"?new i({type:"photo",url:a.upgradePictureURL(this.get("picture")),link:this.get("formatted_permalink"),width:0,height:0,thumbnail_url:this.get("picture"),thumbnail_width:0,thumbnail_height:0,provider_name:"Facebook",author_name:this.get("from_name"),author_url:a.getAuthorURLById(this.get("from_id"))}):null},_parseMediaVideo:function(){var e=t.sortBy(this.get("format"),function(e){return-(e.width*e.height)});if(e.length===0)return null;var n=e[0],r=e[e.length-1],s=u.protocolRelativize(n.picture);return new i({type:"link",url:this.get("link"),link:this.get("formatted_permalink"),width:n.width,height:n.height,thumbnail_url:s,thumbnail_width:n.width,thumbnail_height:n.height,provider_name:"Facebook",author_name:this.get("from_name"),author_url:a.getAuthorURLById(this.get("from_id")),sizes:t.map(e.slice(1),function(e){return{width:e.width,height:e.height,thumbnail_url:s,thumbnail_width:r.width,thumbnail_height:r.height}})})},_getMediaExisting:function(){var e=this.getType(),n=[];return e==="photo"?n.push(this._parseMediaPhoto()):e==="video"&&n.push(this._parseMediaVideo()),n.push(this._parseMediaPicture()),t.compact(n)},_prettifyText:function(e){var n=r.extractUrlsWithIndices(e),i=r.extractHashtagsWithIndices(e,{checkUrlOverlap:!1}),o=n.concat(i);r.removeOverlappingEntities(o);var a=t.extend({},s.AUTOLINK_DEFAULTS,{urlClass:s.AUTOLINK_DEFAULTS.urlClass+"status-url-facebook",hashtagClass:s.AUTOLINK_DEFAULTS.hashtagClass+"status-hashtag-facebook",hashtagUrlBase:"//www.facebook.com/hashtag/"}),f=r.autoLinkEntities(e,o,a);return u.normalizeLineBreaks(u.trimHTML(f),2,"<br />")},_getCreateDate:function(){return n(this.get("created_time"),n.ISO_8601)},_getPlace:function(){if(this.has("place_id")){var e=this.get("place_location_city")+", "+(this.get("place_location_state")||this.get("place_location_country")),t=this.get("place_location_city")?{name:e}:null;return{type:"Feature",properties:t,geometry:{type:"Point",coordinates:[this.get("place_location_longitude"),this.get("place_location_latitude")]}}}return null},_getAvatarURL:function(e){var t=this.get("from_id");return u.getAvatarProxyURL("facebook",t,e)},_getProfileURL:function(){return"//www.facebook.com/"+this.get("from_id")},_getText:function(){var e;if(this.has("share_text")&&this.has("story"))e=this.get("story");else if(this.has("message")||this.has("name"))e=this.get("message")||this.get("name");return e||""},_getName:function(){return this.get("from_name")},_getPermalink:function(){var e=this.get("facebook_id");e.indexOf("_")<0&&(e=this.get("from_id")+"_"+this.get("facebook_id"));var n=e.split("_"),r={link:!0,photo:!0,post:!0,status:!0,video:!0},i="//www.facebook.com/",s=this.getType();return t.has(r,s)?i+=n[0]+"/posts/"+n[1]:s==="comment"&&(n.length===2?i+=n[0]+"?comment_id="+n[1]:(i+=n[0]+"/posts/"+n[1],n[2]&&(i+="?comment_id="+n[2]))),i},_generateIntentAbilities:function(){return this.set({intent_can_comment:this.getType()!=="comment"||this.get("actions_has_comment"),intent_can_like:this.get("author_is_page")==="1"||this.get("actions_has_like"),intent_can_share:!0}),this},_generateIntentURLs:function(){return this.set({intent_url_comment:this.get("formatted_permalink")+"/comments",intent_url_like:this.get("formatted_permalink")+"/likes",intent_url_share:this.get("formatted_permalink")+"/share"}),this},_generateAvailableActions:function(){var e={Comment:"comment",Like:"like"},n=this;t.each(e,function(e){n.set("actions_has_"+e,!1)}),this.get("actions")&&t.each(this.get("actions"),function(t){var r=e[t.name];r&&n.set("actions_has_"+r,!0)})}},{upgradePictureURL:function(e){e=t.isString(e)?e:"",e=e.replace(/_[anst]\./,"_n.");var n=/\/safe_image\.php\?.*url=([^&]+)(?:&|$)/g.exec(e);return n&&(e=o.proxyImageURL(decodeURIComponent(n[1]))),e},getAuthorURLById:function(e){return"//facebook.com/"+e}});return a}),n("massrel-js-backbone/lib/GooglePlusStatusModel",["require","lodash","moment","./MediaModel","./StatusModel","./util"],function(e){var t=e("lodash"),n=e("moment"),r=e("./MediaModel"),i=e("./StatusModel"),s=e("./util"),o=t.template('<a href=<%- url %> target="_blank" rel="nofollow" class="<%- classes %>"><s><%- symbol %></s><span><%- text %></span></a>'),u=function(e){var t=n().diff(e,"hours");return t<24?e.format("LT"):t<48?"Yesterday "+e.format("LT"):e.format("ll")},a=i.extend({network:"google_plus",defaults:t.extend({},i.prototype.defaults,{formatted_date_format:u}),_getMediaFetchURLs:function(){var e=t.map(this.get("object_attachments"),function(e){return e.embed&&e.embed.url?e.embed.url:null});return t.compact(e)},_parseMediaAlbum:function(e){return t.map(e.thumbnails,function(e){var t=s.protocolRelativize(e.image.url);return new r({type:"photo",url:s.protocolRelativize(a.changeURLSizeHint(e.image.url,a.LARGE_PHOTO_SIZE,a.LARGE_PHOTO_SIZE)),link:this.get("formatted_permalink"),width:a.LARGE_PHOTO_SIZE,height:a.LARGE_PHOTO_SIZE,thumbnail_url:t,thumbnail_width:e.image.width,thumbnail_height:e.image.height,description:e.description||"",provider_name:"Google+",author_name:this.get("formatted_name"),author_url:this.get("formatted_profile_url"),sizes:[{url:t,width:e.image.width,height:e.image.height,thumbnail_url:t,thumbnail_width:e.image.width,thumbnail_height:e.image.height}]})},this)},_parseMediaArticle:function(e){var n={type:"link",url:e.url,link:this.get("formatted_permalink"),title:e.displayName||"",description:e.content||"",provider_name:"Google+",author_name:this.get("formatted_name"),author_url:this.get("formatted_profile_url")};return e.fullImage&&t.extend(n,{thumbnail_url:e.fullImage.url,thumbnail_width:e.fullImage.width||e.image.width||0,thumbnail_height:e.fullImage.height||e.image.height||0}),new r(n)},_parseMediaPhoto:function(e){var t=s.protocolRelativize(e.image.url);return new r({type:"photo",url:e.fullImage.url,link:this.get("formatted_permalink"),width:e.fullImage.width,height:e.fullImage.height,thumbnail_url:t,thumbnail_width:e.image.width,thumbnail_height:e.image.height,title:e.displayName||"",description:e.content||"",provider_name:"Google+",author_name:this.get("formatted_name"),author_url:this.get("formatted_profile_url"),sizes:[{url:t,width:Math.round(e.fullImage.width/2),height:Math.round(e.fullImage.height/2),thumbnail_url:t,thumbnail_width:e.image.width,thumbnail_height:e.image.height}]})},_parseMediaVideo:function(e){return!e.embed&&e.image?new r({type:"photo",url:s.protocolRelativize(a.changeURLSizeHint(e.image.url,a.LARGE_PHOTO_SIZE,a.LARGE_PHOTO_SIZE)),link:this.get("formatted_permalink"),width:e.image.width,height:e.image.height,provider_name:"Google+",author_name:this.get("formatted_name"),author_url:this.get("formatted_profile_url"),thumbnail_url:s.protocolRelativize(e.image.url),thumbnail_width:e.image.width,thumbnail_height:e.image.height,title:e.displayName||"",description:e.content||""}):null},_getMediaExisting:function(){var e=t.map(this.get("object_attachments"),function(e){var n=e.objectType,r=t.noop;return n==="album"?r=this._parseMediaAlbum:n==="article"?r=this._parseMediaArticle:n!=="event"&&(n==="photo"?r=this._parseMediaPhoto:n==="video"?r=this._parseMediaVideo:window.console&&window.console.warn&&window.console.warn("Unrecognized Google+ attachment type: "+n,e,this.toJSON())),r.call(this,e)},this);return t(e).flatten(!0).compact().value()},_prettifyText:function(e){var n=document.createElement("div");return n.innerHTML=e,t.each(n.querySelectorAll(".ot-hashtag"),function(e){var t=document.createElement("div");t.innerHTML=o({url:e.href,classes:i.AUTOLINK_DEFAULTS.hashtagClass+"status-hashtag-google-plus",symbol:"#",text:s.getNodeText(e).slice(1)}),e.parentNode.replaceChild(t.firstChild,e)}),t.each(n.querySelectorAll(".proflinkWrapper"),function(e){var t=e.querySelector(".proflink"),n=document.createElement("div");n.innerHTML=o({url:t.href,classes:i.AUTOLINK_DEFAULTS.usernameClass+"status-username-google-plus",symbol:"+",text:s.getNodeText(t)}),e.parentNode.replaceChild(n.firstChild,e)}),t.each(n.querySelectorAll("a"),function(e){s.trim(e.className)===""&&(e.className=i.AUTOLINK_DEFAULTS.urlClass+"status-url-google-plus",e.target="_blank")}),s.trimHTML(n.innerHTML)},_getName:function(){return this.get("actor_displayName")},_getPermalink:function(){return s.protocolRelativize(this.get("url"))},_getCreateDate:function(){return n(this.get("published"),n.ISO_8601)},_getText:function(){return this.has("object_content")?this.get("object_content"):s.normalizeLineBreaks(this.get("title"),null,"<br />")},_getPlace:function(){if(this.has("location_kind")){var e=parseFloat(this.get("location_position_latitude")),n=parseFloat(this.get("location_position_longitude"));if(t.isNaN(e)||t.isNaN(n))return null;var r=this.get("location_address_formatted")||"",i=r?{name:r}:null;return{type:"Feature",properties:i,geometry:{type:"Point",coordinates:[n,e]}}}return null},_getAvatarURL:function(e){var t=this.get("actor_image_url");return s.protocolRelativize(t.replace(/\bsz\=\d+/,"sz="+Math.min(9999,e)))},_getProfileURL:function(){return s.protocolRelativize(this.get("actor_url"))},_splitText:s.splitHTMLToLength},{LARGE_PHOTO_SIZE:2560,changeURLSizeHint:function(e,n,r){var i="/";return t.isNumber(n)&&t.isNumber(r)&&(i="/w"+n+"-h"+r+"/"),(e||"").replace(/\/w\d+-h\d+(?:-[a-z])*\//gi,i)},formatDate:u});return a}),n("massrel-js-backbone/lib/InstagramStatusModel",["require","lodash","moment","twitter-text","./MediaModel","./StatusModel","./embedly","./util"],function(e){var t=e("lodash"),n=e("moment"),r=e("twitter-text"),i=e("./MediaModel"),s=e("./StatusModel"),o=e("./embedly"),u=e("./util"),a=s.extend({network:"instagram",_getMediaFetchURLs:function(){var e=[];return this.get("type")==="video"&&e.push(this.get("link")),e},_getMediaExisting:function(){var e=this.get("raw_status"),n=t(e.images).values().sortBy(function(e){return-(e.width*e.height)}).value();if(n.length===0)return null;var r=n[0],s=n[n.length-1],u=o.proxyImageURL(r.url),a=o.proxyImageURL(s.url);return[new i({type:"photo",url:u,link:this.get("formatted_permalink"),width:r.width,height:r.height,thumbnail_url:a,thumbnail_width:s.width,thumbnail_height:s.height,provider_name:"Instagram",author_name:this.get("user_username"),author_url:"//instagram.com/"+this.get("user_username"),sizes:t.map(n.slice(1),function(e){return{url:o.proxyImageURL(e.url),width:e.width,height:e.height,thumbnail_url:a,thumbnail_width:s.width,thumbnail_height:s.height}})})]},_prettifyText:function(e){var n=String.fromCharCode(133)+"#",i=a.getHashtagRuns(e);e=t.reduce(i,function(e,t){var r=t.replace(/#/g,n).slice(1);return e.replace(t,r)},e);var o=r.extractUrlsWithIndices(e),f=r.extractMentionsWithIndices(e),l=r.extractHashtagsWithIndices(e,{checkUrlOverlap:!1}),c=o.concat(l).concat(f);r.removeOverlappingEntities(c);var h=t.extend({},s.AUTOLINK_DEFAULTS,{urlClass:s.AUTOLINK_DEFAULTS.urlClass+"status-url-instagram",hashtagClass:s.AUTOLINK_DEFAULTS.hashtagClass+"status-hashtag-instagram",usernameClass:s.AUTOLINK_DEFAULTS.usernameClass+"status-username-instagram",hashtagUrlBase:"//instagram.com/explore/tags/",usernameUrlBase:"//instagram.com/"}),p=r.autoLinkEntities(e,c,h);return u.normalizeLineBreaks(u.trimHTML(p),2,"<br />")},_getName:function(){return this.get("user_full_name")||this.get("user_username")},_getPermalink:function(){return u.protocolRelativize(this.get("link"))},_getCreateDate:function(){return n(this.get("created_time"),"X")},_getText:function(){return this.get("caption_text")||""},_getPlace:function(){if(this.has("location_latitude")){var e=this.get("location_name")?{name:this.get("location_name")}:null;return{type:"Feature",properties:e,geometry:{type:"Point",coordinates:[this.get("location_longitude"),this.get("location_latitude")]}}}return null},_getAvatarURL:function(){return o.proxyImageURL(this.get("user_profile_picture"))},_getProfileURL:function(){return"//instagram.com/"+this.get("user_username")}},{getHashtagRuns:function(e){var n=/(?:#|^|\s)((?:#[^#\s]+){2,})(?:#|$|\s)/gi,r=[],i=n.exec(e);while(i)n.lastIndex=i.index+1,r.push(i[1]),i=n.exec(e);return t.sortBy(r,"length").reverse()}});return a}),n("massrel-js-backbone/lib/RSSStatusModel",["require","lodash","moment","twitter-text","./StatusModel","./MediaModel","./util"],function(e){var t=e("lodash"),n=e("moment"),r=e("twitter-text"),i=e("./StatusModel"),s=e("./MediaModel"),o=e("./util"),u=["ddd MMM DD HH:mm:ss UTC YYYY",n.ISO_8601],a=i.extend({network:"rss",_getMediaFetchURLs:function(){var e=this.get("links").slice();return e.push(this.getPermalink()),t.uniq(e)},_getMediaExisting:function(){var e=this,n=t.map(this.get("raw_status").media,function(t){return new s({type:"photo",url:t.url,link:e.get("formatted_permalink"),height:t.height,width:t.width})});return n},_prettifyText:function(e){var n=r.extractUrlsWithIndices(e);r.removeOverlappingEntities(n);var s=t.extend({},i.AUTOLINK_DEFAULTS,{urlClass:i.AUTOLINK_DEFAULTS.urlClass+"status-url-rss"}),u=r.autoLinkEntities(e,n,s);return o.normalizeLineBreaks(o.trim(u),2,"<br />")},_getPermalink:function(){return/^(?:https?:)?\/\//i.test(this.get("guid"))?this.get("guid"):this.get("link")},_getCreateDate:function(){var e=this.get("pub_date"),t=n(e,u);return t.isValid()||(t=n(e)),t},_getText:function(){var e=this.get("description")||this.get("title")||"";if(/</g.test(e)&&/>/.test(e)){var t=document.createElement("div");t.innerHTML=e,e=o.getNodeText(t)}return e},_getName:function(){return this.get("author")},_getPlace:t.constant(null),_getAvatarURL:t.constant(""),_getProfileURL:t.constant("")});return a}),n("massrel-js-backbone/lib/TwitterStatusModel",["require","lodash","massrel-js","moment","twitter-text","./StatusModel","./MediaModel","./util","./embedly"],function(e){var t=e("lodash"),n=e("massrel-js"),r=e("moment"),i=e("twitter-text"),s=e("./StatusModel"),o=e("./MediaModel"),u=e("./util"),a=e("./embedly"),f="ddd MMM DD HH:mm:ss ZZ YYYY",l=/https?:\/\/video.twimg.com\/ext_tw_video\/.*?\/pu\/vid\/(.*?)x(.*?)\/.*?.mp4/,c=s.extend({network:"twitter",defaults:t.extend({},s.prototype.defaults,{intent_original_referer:"@spredfast",intent_url_favorite:"",intent_url_reply:"",intent_url_retweet:"",intent_url_user:"",formatted_date_format:"short",is_retweet:!1}),initialize:function(){s.prototype.initialize.apply(this,arguments),this.on("change:intent_original_referer",this._generateIntentURLs),this._generateIntentURLs()},parse:function(e){var n=t.cloneDeep(e);if(e.retweeted_status){var r=t.cloneDeep(e.retweeted_status),i=t.omit(e,"retweeted_status");t(i).each(function(e,n){t.has(r,n)||(r[n]=e,delete i[n])}),r.retweeting_status=i,r.is_retweet=!0,e=r}var o=s.prototype.parse.call(this,e);return o.raw_status=n,o},_getPlace:function(){if(this.has("geo_type")){var e=this.get("place_full_name"),n=e?{name:e}:null;return{type:"Feature",properties:n,geometry:{type:"Point",coordinates:t.cloneDeep(this.get("coordinates_coordinates"))}}}return this.get("user_location")?{type:"Feature",properties:{name:this.get("user_location")},geometry:null}:null},_getCreateDate:function(){return r(this.get("created_at"),f)},_getText:function(){return this.get("text")},_getMediaFetchURLs:function(){return t.pluck(this.get("entities_urls"),"expanded_url")},_parseMediaPhoto:function(e){var n=t(e.sizes).map(function(e,n){return t.extend({},e,{name:n})}).sortBy(function(e){return-(e.w*e.h)}).value();if(n.length===0)return null;var r=n[0],i=n[n.length-1],s=u.protocolRelativize(e.media_url);return new o({type:"photo",url:s+":"+r.name,link:this.get("formatted_permalink"),width:r.w,height:r.h,thumbnail_url:s+":"+i.name,thumbnail_width:i.w,thumbnail_height:i.h,provider_name:"Twitter",author_name:this.get("user_screen_name"),author_url:"//twitter.com/"+this.get("user_screen_name"),sizes:t.map(n.slice(1),function(e){return{url:s+":"+e.name,width:e.w,height:e.h,thumbnail_url:s+":"+i.name,thumbnail_width:i.w,thumbnail_height:i.h}})})},_parseMediaVideo:function(e){var n=t(e.sizes).map(function(e,n){return t.extend({},e,{name:n})}).sortBy(function(e){return-(e.w*e.h)}).value();if(n.length===0)return null;var r=n[0],i=u.protocolRelativize(e.media_url),s=t(e.video_info.variants).filter(function(e){return e.content_type==="video/mp4"}).map(function(e){var t=r.w,n=r.h,i=l.exec(e.url);return i&&(t=parseInt(i[1],10),n=parseInt(i[2],10)),{url:e.url,w:t,h:n}}).sortBy(function(e){return e.h*e.w}).reverse().value();if(s.length===0)return null;var f=s[0],c={video:f.url,image:i+":"+r.name,url:this.get("formatted_permalink")};return e.type==="animated_gif"&&(c.loop="1"),new o({type:"video",url:f.url,link:this.get("formatted_permalink"),html:a.widget(c),width:f.w,height:f.h,thumbnail_url:i+":"+r.name,thumbnail_width:r.w,thumbnail_height:r.h,provider_name:"Twitter",author_name:this.get("user_screen_name"),author_url:"//twitter.com/"+this.get("user_screen_name"),sizes:t.map(s.slice(1),function(e){return{url:e.url,html:a.widget(t.extend({},c,{video:e.url})),width:e.w,height:e.h}})})},_getMediaExisting:function(){var e=this.get("extended_entities_media");if(!e||e.length===0)e=this.get("entities_media")||[];var n=t.map(e,function(e){var t=null;return e.type==="photo"?t=this._parseMediaPhoto(e):e.type==="video"||e.type==="animated_gif"?t=this._parseMediaVideo(e):window.console&&window.console.warn&&window.console.warn("Unrecognized Twitter media entity type: "+e.type,e,this.toJSON()),t},this);return t.compact(n)},_prettifyText:function(e){var n=this.get("entities_urls")||[],r=this.get("entities_media")||[],o=t.extend({},s.AUTOLINK_DEFAULTS,{urlClass:s.AUTOLINK_DEFAULTS.urlClass+"status-url-twitter",hashtagClass:s.AUTOLINK_DEFAULTS.hashtagClass+"status-hashtag-twitter",usernameClass:s.AUTOLINK_DEFAULTS.usernameClass+"status-username-twitter",listClass:s.AUTOLINK_DEFAULTS.listClass+"status-list-twitter",cashtagClass:s.AUTOLINK_DEFAULTS.cashtagClass+"status-cashtag-twitter",urlEntities:n.concat(r)}),a=i.autoLink(e,o);return u.normalizeLineBreaks(u.trimHTML(a),null,"<br />")},_getName:function(){return this.get("user_name")},_getPermalink:function(){return"//twitter.com/"+this.get("user_screen_name")+"/status/"+this.get("id_str")},_getAvatarURL:function(e){var t=this.get("user_screen_name");return u.getAvatarProxyURL("twitter",t,e)},_getProfileURL:function(){return"//www.twitter.com/"+this.get("user_screen_name")},_generateIntentURLs:function(){var e=this.get("id_str"),r=this.get("user_screen_name"),i={original_referer:this.get("intent_original_referer")},s=u.protocolRelativize;return this.set({intent_url_favorite:s(n.intents.favorite(e,t.clone(i))),intent_url_reply:s(n.intents.reply(e,t.clone(i))),intent_url_retweet:s(n.intents.retweet(e,t.clone(i))),intent_url_user:s(n.intents.user(r,t.clone(i)))}),this}});return c}),n("massrel-js-backbone/lib/YouTubeVideoStatusModel",["require","lodash","moment","twitter-text","./StatusModel","./MediaModel","./util"],function(e){var t=e("lodash"),n=e("moment"),r=e("twitter-text"),i=e("./StatusModel"),s=e("./MediaModel"),o=e("./util"),u=i.extend({network:"youtube",defaults:t.extend({},i.prototype.defaults,{formatted_date_format:"short",duration:null,duration_pretty:""}),initialize:function(){i.prototype.initialize.apply(this,arguments),this.on("change:contentDetails_duration",this._parseDuration),this._parseDuration()},parse:function(e){var n=t.cloneDeep(e),r=t.cloneDeep(n);r.title=e.snippet.title;var s=i.prototype.parse.call(this,r);return s.raw_status=n,s},_getMediaFetchURLs:function(){return["//youtu.be/"+this.get("youtube_video_id")]},_getMediaExisting:function(){var e=t(this.get("raw_status").snippet.thumbnails).map(function(e){return{url:e.url,width:e.width,height:e.height}}).sortBy(function(e){return-s.calculateSize(e)}).value(),n=e.shift(),r=e[e.length-1];return[new s({type:"photo",url:n.url,link:this.get("formatted_permalink"),width:n.width,height:n.height,thumbnail_url:r.url,thumbnail_width:r.width,thumbnail_height:r.height,provider_name:"YouTube",sizes:e})]},_prettifyText:function(e){var n=r.extractUrlsWithIndices(e);r.removeOverlappingEntities(n);var s=t.extend({},i.AUTOLINK_DEFAULTS,{urlClass:i.AUTOLINK_DEFAULTS.urlClass+"status-url-youtube"}),u=r.autoLinkEntities(e,n,s);return o.normalizeLineBreaks(o.trim(u),2,"<br />")},_getPermalink:function(){return"//youtu.be/"+this.get("youtube_video_id")},_getCreateDate:function(){var e=this.get("snippet_publishedAt"),t=n(e,n.ISO_8601);return t},_getText:function(){return this.get("snippet_description")},_getName:function(){return this.get("snippet_channelTitle")},_getPlace:t.constant(null),_getAvatarURL:t.constant(""),_getProfileURL:function(){return"//youtube.com/channel/"+this.get("snippet_channelId")},_parseDuration:function(){var e=n.duration(this.get("contentDetails_duration"));this.set("duration",e);var t=":"+o.padLeft(e.get("seconds"),2);e.get("hours")?t=e.get("hours")+":"+o.padLeft(e.get("minutes"),2)+t:t=e.get("minutes")+t,this.set("duration_pretty",t)}});return u}),n("massrel-js-backbone/lib/createStatus",["require","lodash","./FacebookStatusModel","./GooglePlusStatusModel","./InstagramStatusModel","./RSSStatusModel","./TwitterStatusModel","./YouTubeVideoStatusModel"],function(e){var t=e("lodash"),n=e("./FacebookStatusModel"),r=e("./GooglePlusStatusModel"),i=e("./InstagramStatusModel"),s=e("./RSSStatusModel"),o=e("./TwitterStatusModel"),u=e("./YouTubeVideoStatusModel"),a=t.reduce([n,r,i,s,o,u],function(e,t){return e[t.prototype.network]=t,e},{});return function(e){if(!(e&&e.network&&t.has(a,e.network))){var n=new TypeError("No constructor found for the given data");throw n.data=e,n}var r=a[e.network];return new r(e)}}),n("massrel-js-backbone/lib/StreamPoller",["require","./backbone","q","lodash","./createStatus","massrel-js"],function(e){var t=e("./backbone"),n=e("q"),r=e("lodash"),i=e("./createStatus"),s=e("massrel-js"),o=t.Model.extend({defaults:{stream_name:"",polling:!1},initialize:function(){this._processors=[],this.poller=this._createPoller(),this.on("change:stream_name",this._updatePoller)},start:function(){return this.get("stream_name")&&(this.poller.start(),this.set("polling",!0)),this},stop:function(){return this.poller.stop(),this.set("polling",!1),this},more:function(){return this.trigger("more:loading"),this.poller.more(r.bind(this._handleMore,this)),this},process:function(e){if(!r.isFunction(e))throw new TypeError("`processorFunction` must be a function");return this._processors.push(e),this},_createPoller:function(){var e=new s.Stream(this.get("stream_name")),t=e.poller(this.toJSON());return t.data(r.once(r.bind(this._handleEmpty,this))),t.data(r.bind(this._handleBatch,this)),t},_updatePoller:function(){var e=this.get("polling");return this.poller.stop(),this.poller=this._createPoller(),this.trigger("poller:update"),e&&this.poller.start(),this},_processStatuses:function(e){var t=this,s=r(e).map(function(e){try{var n=i(e);return t.trigger("status:pre-process",n),n}catch(r){t.trigger("error:invalid-status",r)}}).compact().map(function(e){var i=r.map(t._processors,function(t){var r=n.defer();return t.call(null,e,r),r.promise}),s=n.defer();return i.length!==0?n.all(i).then(function(){t.trigger("status",e),s.resolve(e)}).fail(function(n){t.trigger("status:rejected",e,n),s.reject(n)}).done():(t.trigger("status",e),s.resolve(e)),s.promise}).value(),o=n.defer();return n.allSettled(s).done(function(e){var t=r(e).filter(function(e){return e.state==="fulfilled"}).pluck("value").value();o.resolve(t)}),o.promise},_handleData:function(e,t){this.trigger(t.raw,e);if(!e||e.length===0)this.trigger(t.empty);else{var n=this;this._processStatuses(e).done(function(e){n.trigger(t.processed,e)})}return this},_handleBatch:function(e){return this._handleData(e,{raw:"raw:batch",empty:"batch:empty",processed:"batch"}),this},_handleMore:function(e){return this._handleData(e,{raw:"raw:more",empty:"more:end",processed:"more"}),this},_handleEmpty:function(e){return(!e||e.length===0)&&this.trigger("empty"),this}});return o}),n("massrel-js-backbone/lib/ComparePoller",["require","./backbone"],function(e){var t=e("./backbone"),n="massrel-js";return t.Model.extend({defaults:function(){return{streams:[],frequency:20}},initialize:function(){var e=this.toJSON();this.compare=new n.Compare(e.streams),this.poller=this.compare.poller(e)},start:function(){var e=this;this.get("streams")&&this.get("streams").length>0&&(e.set("loading",!0),e.poller.data(function(t){e.set("data",t),e.set("loading",!1)}),e.poller.start())},stop:function(){this.poller.stop()}})}),n("massrel-js-backbone/lib/MetaPoller",["require","./backbone","massrel-js"],function(e){var t=e("./backbone"),n=e("massrel-js");return t.Model.extend({defaults:function(){return{stream_name:"",disregard:"",frequency:20,loading:!1,activity:{},count:{},networks:{}}},initialize:function(){var e=this,t=e.toJSON();e.stream=new n.Stream(t.stream_name),e.poller=e.stream.metaPoller(t)},start:function(){var e=this;this.get("stream_name")&&(e.set("loading",!0),e.poller.data(function(t){e.set(t),e.set("loading",!1)}),e.poller.start())},stop:function(){var e=this;e.poller.stop()}})}),n("massrel-js-backbone/lib/TopThingsPoller",["require","./backbone","lodash","massrel-js"],function(e){var t=e("./backbone"),n=e("lodash"),r=e("massrel-js");return t.Model.extend({defaults:function(){return{stream_name:"",networks:1,frequency:20,resolution:"1h",start:"-1h",finish:"",thing:"",limit:50,loading:!1,data:{}}},start:function(){this.stop();if(this.get("stream_name")){var e=n.pick(this.toJSON(),["thing","resolution","start","finish","limit","stream_name"]);this.stream=new r.Stream(e.stream_name),this.poller=this.stream.topThingsPoller(e),this.set("loading",!0),this.poller.data(n.bind(function(e){this.set("data",e),this.set("loading",!1)},this)),this.poller.start()}},stop:function(){this.poller&&this.poller.stop()}})}),n("massrel-js-backbone/lib/processors",["require","./util"],function(e){var t=e("./util"),n=function(e,n,r,i){e.once("media-fetch",function(){var s=e.get("media").at(0);s&&s.get("type")==="photo"?t.loadImage(s.get("url"),i).then(function(){n.resolve()}).fail(function(e){n.reject(e)}).done():r?n.resolve():n.reject(new Error("No media or non-photo as first media item"))}),e.fetchMedia()},r=function(e){return function(r,i){var s=r.get("additional_classes");s+=" status-style-"+e,r.set("additional_classes",t.trim(s).replace(/\s+/g," ")),i.resolve()}},i=function(e){return function(r,i){var s=r.get("additional_classes"),o;e?o=new RegExp("(^|\\s+)status-style-"+e+"\\b","g"):o=/(^|\s+)status-style-[A-Za-z0-9-]+\b/g,s=s.replace(o,""),r.set("additional_classes",t.trim(s).replace(/\s+/g," ")),i.resolve()}},s=function(e,t){e.once("media-fetch",function(){e.get("media").each(function(e){e.set("autoplay",!0)})}),t.resolve()},o=function(e,t){e.once("media-fetch error:media-fetch",function(){t.resolve()}),e.fetchMedia()},u=function(e,n,r){e.once("media-fetch",function(){var i=e.get("media").at(0);if(i){var s;i.get("type")==="photo"?s=i.get("url"):i.get("thumbnail_url")&&(s=i.get("thumbnail_url")),t.loadImage(s,r).fin(function(){n.resolve()}).done()}else n.resolve()}),e.fetchMedia()},a=function(e,t){e.once("media-fetch",function(){e.get("media").each(function(e){e.set("loop_video",!0)})}),t.resolve()},f=function(e,t){e.once("media-fetch",function(){e.get("media").length>0?t.resolve():t.reject(new Error("Status has no media."))}),e.fetchMedia()},l=function(e,t){var n=e.getText()||"";n.replace(/^\s+|\s+$/g,"")?t.resolve():t.reject(new Error("Status has no non-whitespace text"))},c=function(e,t,r){return n(e,t,!1,r)},h=function(e,t,r){return n(e,t,!0,r)};return{addStyleClass:r,autoplayMedia:s,fetchMedia:o,loopVideoMedia:a,preloadImage:u,removeStyleClass:i,rejectIfNoMedia:f,rejectIfNoText:l,allowOnlyValidPhoto:c,rejectIfInvalidPhoto:h}}),n("massrel-js-backbone/main",["require","./lib/StreamPoller","./lib/ComparePoller","./lib/MetaPoller","./lib/TopThingsPoller","./lib/StatusModel","./lib/TwitterStatusModel","./lib/FacebookStatusModel","./lib/GooglePlusStatusModel","./lib/InstagramStatusModel","./lib/RSSStatusModel","./lib/processors","./lib/MediaCollection","./lib/MediaModel","./lib/createStatus","massrel-js"],function(e){var t=e("./lib/StreamPoller"),n=e("./lib/ComparePoller"),r=e("./lib/MetaPoller"),i=e("./lib/TopThingsPoller"),s=e("./lib/StatusModel"),o=e("./lib/TwitterStatusModel"),u=e("./lib/FacebookStatusModel"),a=e("./lib/GooglePlusStatusModel"),f=e("./lib/InstagramStatusModel"),l=e("./lib/RSSStatusModel"),c=e("./lib/processors"),h=e("./lib/MediaCollection"),p=e("./lib/MediaModel"),d=e("./lib/createStatus"),v=e("massrel-js");return{ComparePoller:n,MetaPoller:r,StreamPoller:t,TopThingsPoller:i,StatusModel:s,FacebookStatusModel:u,GooglePlusStatusModel:a,InstagramStatusModel:f,RSSStatusModel:l,TwitterStatusModel:o,MediaCollection:h,MediaModel:p,processors:c,createStatus:d,massrel:v}}),n("massrel-js-backbone",["massrel-js-backbone/main"],function(e){return e}),n("js/mediaTest",[],function(){var e=function(e){function n(e){var t=e.get("type");return t.photo&&!t.video}function r(e){return e.get("type").video}function i(e){var t=e.get("type");return t.photo||t.video}var t;return e==="photos"?t=n:e==="videos"?t=r:e==="both"&&(t=i),function(e){return e&&t(e)}};return e}),t.config({map:{"*":{underscore:"js/lodash",jquery:"js/jquery",lodash:"js/lodash"}}}),n("js/index",["require","lodash","jquery","massrel-js-backbone-2","massrel-js-backbone","./mediaTest"],function(e){var t=e("lodash"),n=e("jquery"),r=e("massrel-js-backbone-2"),i=e("massrel-js-backbone"),s=e("./mediaTest"),o=function(){n(".toggle-status > .icon-chevron-down").on("click",function(){n("#modal .attribution").fadeIn()}),n(".toggle-status > .icon-chevron-up").on("click",function(){n("#modal .attribution").fadeOut()})},u=function(e,n){var r=[],s,o;return t.forEach(e,function(e,t){var u=i.createStatus(e.get("raw"));r.push(u),e.cid===n.cid&&(s=u,o=t),u.fetchMedia()}),s||(s=i.createStatus(n.get("raw")),r.push(s),o=r.length-1,r.fetchMedia()),{index:o,queue:r}};return{ready:function(e){var r=MR.ENV,i=MR.templateConfig.settings,s=e.modalStatus,o=e["retail-modal"];r.instance.on("#template:showModal",function(e){var n=e.payload.queue,a=e.payload.model,f=o.model,l=o.View;if(i.modal.modalType==="retail"){var c=u(n,a);o.model.set("startIndex",c.index||0),o.model.get("queue").set(c.queue)}else f=a,l=s.viewFactory(a);MR.modal.open({data:{model:f,View:l},fallback:t.bind(r.instance.trigger,r.instance,"#modal:show")})});var a=n("<style></style>").appendTo("head"),f=100/i.gridWidth;a.text(".grid-cell { width: "+f+"%; }")},render:function(e){var i=n("#media-grid"),u=MR.templateConfig.settings,a,f=e.mediaFirstStatus,l=u.gridWidth*u.gridHeight,c=0,h=!0,p=0,d;n("#mr-logo").css("display")==="none"&&(i.css({bottom:"0"}),n(".footer").css({height:"0"}));var v=function(){var e=d[p];p=(p+1)%d.length;if(!e)return;var t=Math.floor(Math.random()*l),r=f.viewFactory(e),i=(new r({model:e})).render();i.$el.addClass("grid-cell"),i.$el.hide();var s=n("#media-grid > .grid > .grid-body > .grid-cell").eq(t);s.fadeOut(function(){s.replaceWith(i.$el),i.$el.fadeIn(),i.$el.on("click",function(){MR.ENV.instance.trigger("#template:showModal",{model:e,view:r,queue:d})})})},m=function(){var e=parseInt(u.cell_delay,10);setInterval(function(){d.length&&v()},e*1e3)},g=function(e){var r=s(u.media_type);e=t.filter(e,function(e){return e.get("media").find(function(e){return e.get("photo_urls")&&e.get("photo_urls").medium&&r(e)})});if(h){if(e.length>l){var i=t.last(e,l);e=i.concat(t.first(e,e.length-l).reverse())}d=e}else d=d.concat(e),d.length>l*2&&(p<d.length-l*2&&(p=0),d=d.slice(d.length-l*2));t.each(e||[],function(e){e.set("mediaFilter",function(e){return r(e)}),c<l&&(p+=1,t.defer(function(){var t=f.viewFactory(e),r=(new t({model:e})).render();r.$el.addClass("grid-cell"),n("#media-grid > .grid > .grid-body").append(r.$el),r.$el.on("click",function(){MR.ENV.instance.trigger("#template:showModal",{model:e,view:t,queue:d})}),MR.resize()}),c+=1)}),h&&u.replace_content&&m(),h=!1,MR.resize()},y=function(e){var t=a.queue.slice(0,e);a.queue.reset(),g(t,!0),c<l&&a.more()},b=function(){var e=a.moreQueue.slice(0,a.moreQueue.length-1);g(e,!1),c<l&&a.more()};a=new r.StreamPoller({stream_name:u.streamName,embed_media:!0,limit:u.gridWidth*u.gridHeight*2,frequency:30,page_links:!0,avatar_resolution:"small",media_config:{autoplay_video:!0,loop_video:!1}}),a.on("loaded-more",b),a.on("loaded-batch",y);var w=function(){n("#noNewContent").show()};a.on("no-data",w),a.start(),n(window).resize(t.throttle(function(){MR.resize()},50)),MR.resize(),MR.ENV.instance.on("#modal:open",function(){t.delay(o,250)}),n("html").hasClass("lt-ie10")&&MR.ENV.instance.on("#modal:close",function(){n("#modal iframe")[0]&&(n("#modal iframe")[0].src=" ")})},modal:{ready:function(){},render:function(){MR.ENV.instance.on("#modal:open",function(){t.delay(o,250)}),MR.ENV.instance.trigger("#modal:show",MR.modal.getData()),MR.ENV.instance.on("#modal:close",function(){n("html").hasClass("lt-ie10")&&n("#modal iframe")[0]&&(n("#modal iframe")[0].src=" "),MR.modal.close()})}}}}),t(["js/index"]),window.MRT.require=t,window.MRT.define=n,window.MRT.requirejs=e}();